// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See http://js.arcgis.com/3.15/esri/copyright.txt and http://www.arcgis.com/apps/webappbuilder/copyright.txt for details.
//>>built
require({cache:{"dojo/promise/all":function(){define(["../_base/array","../Deferred","../when"],function(r,l,d){var q=r.some;return function(k){var m,p;k instanceof Array?p=k:k&&"object"===typeof k&&(m=k);var h,e=[];if(m){p=[];for(var c in m)Object.hasOwnProperty.call(m,c)&&(e.push(c),p.push(m[c]));h={}}else p&&(h=[]);if(!p||!p.length)return(new l).resolve(h);var b=new l;b.promise.always(function(){h=e=null});var a=p.length;q(p,function(c,u){m||e.push(u);d(c,function(c){b.isFulfilled()||(h[e[u]]=
c,0===--a&&b.resolve(h))},b.reject);return b.isFulfilled()});return b.promise}})},"dojo/cookie":function(){define(["./_base/kernel","./regexp"],function(r,l){r.cookie=function(d,q,k){var m=document.cookie,p;if(1==arguments.length)p=(p=m.match(new RegExp("(?:^|; )"+l.escapeString(d)+"\x3d([^;]*)")))?decodeURIComponent(p[1]):void 0;else{k=k||{};m=k.expires;if("number"==typeof m){var h=new Date;h.setTime(h.getTime()+864E5*m);m=k.expires=h}m&&m.toUTCString&&(k.expires=m.toUTCString());q=encodeURIComponent(q);
var m=d+"\x3d"+q,e;for(e in k)m+="; "+e,h=k[e],!0!==h&&(m+="\x3d"+h);document.cookie=m}return p};r.cookie.isSupported=function(){"cookieEnabled"in navigator||(this("__djCookieTest__","CookiesAllowed"),navigator.cookieEnabled="CookiesAllowed"==this("__djCookieTest__"),navigator.cookieEnabled&&this("__djCookieTest__","",{expires:-1}));return navigator.cookieEnabled};return r.cookie})},"dojo/regexp":function(){define(["./_base/kernel","./_base/lang"],function(r,l){var d={};l.setObject("dojo.regexp",
d);d.escapeString=function(d,k){return d.replace(/([\.$?*|{}\(\)\[\]\\\/\+\-^])/g,function(d){return k&&-1!=k.indexOf(d)?d:"\\"+d})};d.buildGroupRE=function(l,k,m){if(!(l instanceof Array))return k(l);for(var p=[],h=0;h<l.length;h++)p.push(k(l[h]));return d.group(p.join("|"),m)};d.group=function(d,k){return"("+(k?"?:":"")+d+")"};return d})},"dojo/request/script":function(){define("module ./watch ./util ../_base/kernel ../_base/array ../_base/lang ../on ../dom ../dom-construct ../has ../_base/window".split(" "),
function(r,l,d,q,k,m,p,h,e,c,b){function a(a,b){a.canDelete&&f._remove(a.id,b.options.frameDoc,!0)}function g(a){y&&y.length&&(k.forEach(y,function(a){f._remove(a.id,a.frameDoc);a.frameDoc=null}),y=[]);return a.options.jsonp?!a.data:!0}function u(a){return!!this.scriptLoaded}function n(a){return(a=a.options.checkString)&&eval("typeof("+a+') !\x3d\x3d "undefined"')}function t(a,b){if(this.canDelete){var c=this.response.options;y.push({id:this.id,frameDoc:c.ioArgs?c.ioArgs.frameDoc:c.frameDoc});c.ioArgs&&
(c.ioArgs.frameDoc=null);c.frameDoc=null}b?this.reject(b):this.resolve(a)}function f(b,c,e){var h=d.parseArgs(b,d.deepCopy({},c));b=h.url;c=h.options;var k=d.deferred(h,a,g,c.jsonp?null:c.checkString?n:u,t);m.mixin(k,{id:v+x++,canDelete:!1});c.jsonp&&((new RegExp("[?\x26]"+c.jsonp+"\x3d")).test(b)||(b+=(~b.indexOf("?")?"\x26":"?")+c.jsonp+"\x3d"+(c.frameDoc?"parent.":"")+v+"_callbacks."+k.id),k.canDelete=!0,A[k.id]=function(a){h.data=a;k.handleResponse(h)});d.notify&&d.notify.emit("send",h,k.promise.cancel);
if(!c.canAttach||c.canAttach(k)){var q=f._attach(k.id,b,c.frameDoc,function(a){if(!(a instanceof Error)){var b=Error("Error loading "+(a.target?a.target.src:"script"));b.source=a;a=b}k.reject(a);f._remove(k.id,c.frameDoc,!0)});if(!c.jsonp&&!c.checkString)var y=p(q,w,function(a){if("load"===a.type||z.test(q.readyState))y.remove(),k.scriptLoaded=a})}l(k);return e?k:k.promise}c.add("script-readystatechange",function(a,b){return"undefined"!==typeof b.createElement("script").onreadystatechange&&("undefined"===
typeof a.opera||"[object Opera]"!==a.opera.toString())});var v=r.id.replace(/[\/\.\-]/g,"_"),x=0,w=c("script-readystatechange")?"readystatechange":"load",z=/complete|loaded/,A=q.global[v+"_callbacks"]={},y=[];f.get=f;f._attach=function(a,c,f,g){f=f||b.doc;var n=f.createElement("script");if(g)p.once(n,"error",g);n.type="text/javascript";try{n.src=c}catch(G){g&&g(n)}n.id=a;n.async=!0;n.charset="utf-8";return f.getElementsByTagName("head")[0].appendChild(n)};f._remove=function(a,b,c){e.destroy(h.byId(a,
b));A[a]&&(c?A[a]=function(){delete A[a]}:delete A[a])};f._callbacksProperty=v+"_callbacks";return f})},"jimu/utils":function(){define("dojo/_base/lang dojo/_base/array dojo/_base/html dojo/_base/sniff dojo/_base/config dojo/io-query dojo/query dojo/NodeList-traverse dojo/Deferred dojo/promise/all dojo/on dojo/json dojo/cookie dojo/number dojo/date/locale dojo/i18n!dojo/cldr/nls/number dojox/encoding/base64 esri/lang esri/arcgis/utils esri/dijit/PopupTemplate esri/SpatialReference esri/geometry/Extent esri/geometry/Multipoint esri/geometry/Polyline esri/geometry/Polygon esri/geometry/webMercatorUtils esri/tasks/GeometryService esri/tasks/ProjectParameters esri/tasks/FeatureSet esri/symbols/PictureMarkerSymbol esri/urlUtils esri/request esri/tasks/query esri/tasks/QueryTask esri/graphicsUtils jimu/portalUrlUtils ./shared/utils".split(" "),
function(r,l,d,q,k,m,p,h,e,c,b,a,g,u,n,t,f,v,x,w,z,A,y,B,C,E,D,F,G,J,N,M,L,K,W,R,ba){function O(a,b){a=a||"";for(var c=0,f=[{test:window.File&&window.FileReader&&window.FileList&&window.Blob||!H.file.isEnabledFlash(),failure:[a+"libs/polyfills/fileAPI/FileAPI.js"],callback:function(){c++;c===f.length&&b()}}],g=0;g<f.length;g++)testLoad(f[g])}function Q(a,b){var c=a.match(/url\([^)]+\)/gi),f,g;if(null===c||""===b)return a;for(f=0;f<c.length;f++)if(g=c[f].match(/(url\(["|']?)(.*)((?:['|"]?)\))/i),4<=
g.length){var n=g[2];/^data:image\/.*;/.test(n)||(b.endWith("/")||(b+="/"),a=a.replace(g[1]+n+g[3],g[1]+b+n+g[3]))}return a}function U(a,b){var c=Array.isArray(b),f=c&&[]||{};c?(a=a||[],f=f.concat(a),b.forEach(function(b,c){"undefined"===typeof a[c]?f[c]=b:"object"===typeof b?f[c]=U(a[c],b):-1===a.indexOf(b)&&f.push(b)})):(a&&"object"===typeof a&&Object.keys(a).forEach(function(b){f[b]=a[b]}),Object.keys(b).forEach(function(c){f[c]="object"===typeof b[c]&&b[c]?a[c]?U(a[c],b[c]):b[c]:b[c]}));return f}
function ia(a,b){var c=a.map(function(a){return a.id});l.forEach(b,function(b){0>c.indexOf(b)&&a.push({id:b,widgets:[]})},this);var f=[];a=l.filter(a,function(a){return 0>b.indexOf(a.id)?(f.push(a),!1):!0},this);if(0===a.length)return[];var g=a[a.length-1];l.forEach(f,function(a){g.widgets=g.widgets.concat(a.widgets)},this);return a=a.sort(function(a,c){return b.indexOf(a.id)-b.indexOf(c.id)})}function Y(a,b,c){function f(a,b){return r.isArray(a[b.key])?a[b.key][b.index]:a[b.key]}b=function(a){var b=
[];a.split("_").forEach(function(a){var c=!1,f;"--"===a.slice(a.length-2)&&(c=!0,a=a.slice(0,a.length-2));f=a.search(/\[[0-9]+\]/);-1===f&&(f=a.length);b.push({key:a.slice(0,f),index:Number(a.slice(f+1,-1)),deleteFlag:c})});return b}(b);for(var g=1;g<b.length-1;g++)if(a=f(a,b[g]),!a)return;if(b[b.length-1].deleteFlag)!0===c&&(r.isArray(a[b[b.length-1].key])?delete a[b[b.length-1].key][b[b.length-1].index]:delete a[b[b.length-1].key]);else if(r.isArray(a[b[b.length-1].key])){if(void 0===c)return a[b[b.length-
1].key][b[b.length-1].index];a[b[b.length-1].key][b[b.length-1].index]=c}else{if(void 0===c)return a[b[b.length-1].key];a[b[b.length-1].key]=c}}function ca(a,b,c){function f(c){c=H.template.getSearchRange(b,c,"]");var f=b.slice(c.firstPos,c.lastPos);return-1!==c.firstPos?(f=b.slice(c.firstPos+f.indexOf("[")+1,c.lastPos-1),c=b.slice(c.lastPos+1),(f=H.getConfigElementById(a,f))?{object:f,key:"section_"+c,state:"isSection"}:{state:"deleted"}):{state:"isNotSection"}}var g=a,n=b=b.replace(/\//g,"_"),e=
f("groups\\[.+\\]");if("deleted"!==e.state&&("isSection"===e.state&&(g=e.object,n=e.key),e=f("widgets\\[.+\\]"),"delete"!==e.state))return"isSection"===e.state&&(g=e.object,n=e.key),Y(g,n,c)}var H={},ea={geometryService:"http://utility.arcgisonline.com/arcgis/rest/services/Geometry/GeometryServer"};r.mixin(H,ba);window.atob||(window.atob=function(a){a=f.decode(a);for(var b="",c=0,g=a.length;c<g;c++)b+=String.fromCharCode(a[c]);return b});window.btob||(window.btob=function(a){for(var b=[],c=0,g=a.length;c<
g;c++)b.push(String.charCodeAt(a[c]));return f.encode(b)});var va="unload",la=[];require.on("error",function(a){l.forEach(la,function(b){a.info[0]&&-1<a.info[0].indexOf(b.resKey)&&b.def.reject(a);for(var c in a.info)-1<c.indexOf(b.resKey)&&b.def.reject(a)})});H.checkError=function(a,b){la.push({resKey:a,def:b})};H.replacePlaceHolder=function(b,c){var f=a.stringify(b),g=f.match(/\$\{(\w)+\}/g),n;if(null===g)return b;for(n=0;n<g.length;n++){var e=g[n].match(/(\w)+/g)[0];c[e]&&(f=f.replace(g[n],c[e]))}return a.parse(f)};
H.changeUnit=function(a){var b=Math.abs(a),c;a=Math.floor(b);c=Math.floor(60*(b-a));b=(60*(60*(b-a)-c)).toFixed(2);return a+"\u00b0"+(10>c?"0"+c:c)+"'"+(10>b?"0"+b:b)+'"'};H.formatTime=function(a){var b=a/1E3;a=Math.floor(b/60);b=Number(b-60*a).toFixed(1);return(10>a?"0"+a:a)+":"+(10>b?"0"+b:b)};H.parseTime=function(a){var b=/(\d{2,})\:(\d{2})\.(\d{1})/;if(!b.test(a))return console.log("wrong time format."),-1;a=a.match(b);return 1E3*(60*parseInt(a[1],10)+parseInt(a[2],10)+parseInt(a[3],10)/10)};
H.preloadImg=function(a,b){var c=[],c="string"===typeof a?[a]:a;l.forEach(c,function(a){(new Image).src=b?b+a:a})};var ma=null;H.getImagesSize=function(a){var c=new e;if(!a||0!==a.indexOf("http"))return c.reject(),c;null===ma&&(ma=d.create("img",{id:"__test-image-size",style:{position:"absolute",left:"-9999px",top:"-9999px"}},document.body));var f=b(ma,"load",function(){clearTimeout(g);g=null;f.remove();var a=d.getContentBox(ma);1===a.w&&1===a.h||0===a.w||0===a.h?c.reject():c.resolve([a.w,a.h])},
{}),g=setTimeout(function(){clearTimeout(g);g=null;c.reject()},5E3);d.setAttr(ma,"src",a);return c};H.getPositionStyle=function(a){var b={};if(!a)return b;a=r.clone(a);if(window.isRTL){var c;"undefined"!==typeof a.left&&"undefined"!==typeof a.right?(c=a.left,a.left=a.right,a.right=c):"undefined"!==typeof a.left?(a.right=a.left,delete a.left):"undefined"!==typeof a.right&&(a.left=a.right,delete a.right);"undefined"!==typeof a.paddingLeft&&"undefined"!==typeof a.paddingRight?(c=a.paddingLeft,a.paddingLeft=
a.paddingRight,a.paddingRight=c):"undefined"!==typeof a.paddingLeft?(a.paddingRight=a.paddingLeft,delete a.paddingLeft):"undefined"!==typeof a.paddingRight&&(a.paddingLeft=a.paddingRight,delete a.paddingRight)}c="left top right bottom width height padding paddingLeft paddingRight paddingTop paddingBottom".split(" ");for(var f=0;f<c.length;f++){var g=c[f];"number"===typeof a[g]?b[g]=a[g]+"px":"undefined"!==typeof a[g]?b[g]=a[g]:"padding"===g.substr(0,7)?b[g]=0:b[g]="auto"}b.zIndex="undefined"===typeof a.zIndex?
"auto":a.zIndex;return b};H.isEqual=function(a,b){function c(a,b){var n;if(null===a&&null===b||"undefined"===typeof a&&"undefined"===typeof b)return!0;if(null===a&&null!==b||null===b&&null!==a||"undefined"===typeof a&&"undefined"!==typeof b||"undefined"===typeof b&&"undefined"!==typeof a)return!1;if(isNaN(a)&&isNaN(b)&&"number"===typeof a&&"number"===typeof b||a===b)return!0;if("function"===typeof a&&"function"===typeof b||a instanceof Date&&b instanceof Date||a instanceof RegExp&&b instanceof RegExp||
a instanceof String&&b instanceof String||a instanceof Number&&b instanceof Number)return a.toString()===b.toString();if(-1<f.indexOf(a)||-1<g.indexOf(b))return!1;if(null!==b){for(n in b)if(b.hasOwnProperty(n)!==a.hasOwnProperty(n)||typeof b[n]!==typeof a[n])return!1;for(n in a){if(b.hasOwnProperty(n)!==a.hasOwnProperty(n)||typeof b[n]!==typeof a[n])return!1;switch(typeof a[n]){case "object":case "function":f.push(a);g.push(b);if(!c(a[n],b[n]))return!1;f.pop();g.pop();break;default:if(isNaN(a[n])&&
isNaN(b[n])&&"number"===typeof a[n]&&"number"===typeof b[n])return!0;if(a[n]!==b[n])return!1}}}return!0}var f,g;f=[];g=[];return c(a,b)?!0:!1};H.file={loadFileAPI:function(){var a=new e;if("unload"===va){var b=window.isBuilder?"stemapp/":"";window.FileAPI={debug:!1,flash:!0,staticPath:b+"libs/polyfills/fileAPI/",flashUrl:b+"libs/polyfills/fileAPI/FileAPI.flash.swf",flashImageUrl:b+"libs/polyfills/fileAPI/FileAPI.flash.image.swf"};O(b,r.hitch(this,function(){va="loaded";a.resolve()}));va="loading"}else"loaded"===
va&&a.resolve();return a},supportHTML5:function(){return window.File&&window.FileReader&&window.FileList&&window.Blob?!0:!1},supportFileAPI:function(){return q("safari")&&6>q("safari")?!1:window.FileAPI&&window.FileAPI.readAsDataURL?!0:!1},isEnabledFlash:function(){var a=null;if(document.all)try{a=new ActiveXObject("ShockwaveFlash.ShockwaveFlash")}catch(ka){a=null}else navigator.plugins&&0<navigator.plugins.length&&(a=navigator.plugins["Shockwave Flash"]);return!!a},containSeparator:function(a){return 0<=
a.indexOf("/")?!0:0<=a.indexOf("\\")?!0:!1},getNameFromPath:function(a){var b="",b=0<=a.indexOf("/")?"/":"\\";a=a.split(b);return 0<a.length?a[a.length-1]:null},getFolderFromPath:function(a){return a.substr(0,a.length-H.file.getNameFromPath(a).length)},readFile:function(a,b,c,f){if(this.supportHTML5()){var g=a.target.files[0];g&&(g.type.match(b)?g.size>=c?f({errCode:"exceed"}):(a=new FileReader,a.onload=function(a){f(null,g.name,a.target.result)},a.readAsDataURL(g)):f({errCode:"invalidType"}))}else if(this.supportFileAPI()){var n=
window.FileAPI.getFiles(a);n[0].type.match(b)?n[0].size>=c?f({errCode:"exceed"}):window.FileAPI.readAsDataURL(n[0],function(a){a&&a.result?f(null,n[0].name,a.result):f({errCode:"readError"})}):f({errCode:"invalidType"})}}};H.getUriInfo=function(a){var b,c={};b=a.indexOf("/");a.substring(0,b);b=a.substring(0,a.lastIndexOf("/")+1);c.folderUrl=require(H.getRequireConfig()).toUrl(b);c.amdFolder=b;c.url=c.folderUrl;if(/^http(s)?:\/\//.test(a)||/^\/\//.test(a))c.isRemote=!0;return c};H.widgetJson=function(){return{addManifest2WidgetJson:function(a,
b){r.mixin(a,b.properties);a.name=b.name;a.label||(a.label=b.label);a.manifest=b;a.isRemote=b.isRemote;a.isRemote&&(a.itemId=b.itemId);b.featureActions&&(a.featureActions=b.featureActions);a.icon||(a.icon=b.icon);a.thumbnail||(a.thumbnail=b.thumbnail);a.folderUrl=b.folderUrl;a.amdFolder=b.amdFolder},removeManifestFromWidgetJson:function(a){if(a.manifest){for(var b in a.manifest.properties)a[b]=void 0;a.name=void 0;a.label=void 0;a.featureActions=void 0;a.manifest=void 0}}}}();H.getRequireConfig=function(){if(jimuConfig){var a=
[];jimuConfig.widgetsPackage&&(a=a.concat(jimuConfig.widgetsPackage));jimuConfig.themesPackage&&(a=a.concat(jimuConfig.themesPackage));jimuConfig.configsPackage&&(a=a.concat(jimuConfig.configsPackage));return{packages:a}}return{}};H.getTypeByGeometryType=function(a){var b="",c="esriGeometryLine esriGeometryCircularArc esriGeometryEllipticArc esriGeometryBezier3Curve esriGeometryPath esriGeometryPolyline".split(" "),f=["esriGeometryRing","esriGeometryPolygon","esriGeometryEnvelope"];0<=["esriGeometryPoint",
"esriGeometryMultipoint"].indexOf(a)?b="point":0<=c.indexOf(a)?b="polyline":0<=f.indexOf(a)&&(b="polygon");return b};H.getSymbolTypeByGeometryType=function(a){var b=null;a=H.getTypeByGeometryType(a);"point"===a?b="marker":"polyline"===a?b="line":"polygon"===a&&(b="fill");return b};H.getServices=function(){return ea};H.getArcGISDefaultGeometryService=function(){return new D(ea.geometryService)};H.restoreToDefaultWebMapExtent=function(a,b,c){var f=new e;if(!a||"esri.Map"!==a.declaredClass)return setTimeout(function(){f.reject("Invalid map.")},
0),f;b=b&&b.itemInfo;if(!b)return setTimeout(function(){f.reject("Invalid itemInfo")},0),f;b=b.item&&b.item.extent;if(!b)return setTimeout(function(){f.reject("Invalid itemInfo.item.extent")}),f;var g=new z({wkid:4326}),g=new A(b[0][0],b[0][1],b[1][0],b[1][1],g);if(4326===parseInt(a.spatialReference.wkid,10))return a.setExtent(g);if(a.spatialReference.isWebMercator())return g=E.geographicToWebMercator(g),a.setExtent(g);b=new F;b.geometries=[g];b.outSR=a.spatialReference;g=esriConfig&&esriConfig.defaults&&
esriConfig.defaults.geometryService;g&&"esri.tasks.GeometryService"===g.declaredClass||(c&&"string"===typeof c&&r.trim(c)?(c=r.trim(c),g=new D(c)):g=H.getArcGISDefaultGeometryService());g.project(b).then(function(b){if(b=b&&b[0])return a.setExtent(b);f.reject("Invalid projected geometry.");return f},function(a){console.error(a);f.reject(a);return f});return f};H.getAncestorWindow=function(){for(var a=window;a&&a.parent&&a!==a.parent;)a=a.parent;return a};H.getAncestorDom=function(a,b,c){if(a&&1===
a.nodeType&&b&&"function"===typeof b){var f=100,g=document.body;c&&("number"===typeof c?(c=parseInt(c,10),0<c&&(f=c)):1===c.nodeType&&(g=c));for(c=0;a.parentNode&&c<f&&d.isDescendant(a.parentNode,g);){if(b(a.parentNode))return a.parentNode;a=a.parentNode;c++}}return null};H.bindClickAndDblclickEvents=function(a,c,f,g){var n=null;if(a&&1===a.nodeType&&c&&"function"===typeof c&&f&&"function"===typeof f){var e=200;g&&"number"===typeof g&&(g=parseInt(g,10),0<g&&(e=g));var t=0,n=b(a,"click",function(a){t++;
1===t?setTimeout(function(){1===t&&(t=0,c(a))},e):2===t&&(t=0,f(a))})}return n};H.isScrollToBottom=function(a){var b=d.getContentBox(a);return 1>a.scrollHeight-(a.scrollTop+b.h)};H.getAllItemTypes=function(){var a=[],a=a.concat(["Web Map","Web Scene","CityEngine Web Scene"]).concat("Feature Service;Map Service;Image Service;KML;WMS;Feature Collection;Feature Collection Template;Geodata Service;Globe Service".split(";")).concat(["Geometry Service","Geocoding Service","Network Analysis Service","Geoprocessing Service"]).concat(["Web Mapping Application",
"Mobile Application","Code Attachment","Operations Dashboard Add In","Operation View"]).concat("Symbol Set;Color Set;Shapefile;CSV;Service Definition;Document Link;Microsoft Word;Microsoft PowerPoint;Microsoft Excel;PDF;Image;Visio Document".split(";"));return a=a.concat("Map Document;Map Package;Tile Package;ArcPad Package;Explorer Map;Globe Document;Scene Document;Published Map;Map Template;Windows Mobile Package".split(";")).concat(["Layer","Layer Package","Explorer Layer"]).concat(["Geoprocessing Package",
"Geoprocessing Sample","Locator Package","Rule Package"]).concat("Workflow Manager Package;Desktop Application;Desktop Application Template;Code Sample;Desktop Add In;Explorer Add In".split(";"))};H.getItemQueryStringByTypes=function(a){var b="",c=H.getAllItemTypes();if(a&&0<a.length&&0<a.length){var f="";l.forEach(a,function(b,c){f+=' type:"'+b+'" ';c!==a.length-1&&(f+=" OR ")});b=" ( "+f+" ) ";c=a.concat(c);c=l.filter(c,function(b){return l.every(a,function(a){return 0>a.toLowerCase().indexOf(b.toLowerCase())})});
l.forEach(c,function(a){b+=' -type:"'+a+'" '})}return b};H.getItemQueryStringByTypeKeywords=function(a){var b="";a&&0<a.length&&(b=' typekeywords:"'+a.join(",")+'" ');return b};H.isNotEmptyString=function(a,b){var c=a&&"string"===typeof a;return c?b?c&&r.trim(a):!0:!1};H.isValidNumber=function(a){return"number"===typeof a&&!isNaN(a)};H.isObject=function(a){return a&&"object"===typeof a};H.createWebMap=function(a,b,c,f){a=R.getStandardPortalUrl(a);a=R.getBaseItemUrl(a);x.arcgisUrl=a;return x.createMap(b,
c,f)};H.getRandomString=function(){var a=Math.random().toString();return a=a.slice(2,a.length)};H._getDomainsByServerName=function(a){var b=a.split("."),c=b.length;return l.map(b,r.hitch(this,function(a,f){var g=b.slice(f,c),n="",e=g.length-1;l.forEach(g,r.hitch(this,function(a,b){n+=a;b!==e&&(n+=".")}));return n}))};H.removeCookie=function(a,b){var c=this._getDomainsByServerName(window.location.hostname);l.forEach(c,r.hitch(this,function(c){g(a,null,{expires:-1,path:b});g(a,null,{expires:-1,path:b,
domain:c});g(a,null,{expires:-1,path:b,domain:"."+c})}))};H.isLocaleChanged=function(a,b){return!a.startWith(b)};H.hashToObject=function(b){b=b.replace("#","");b=m.queryToObject(b);for(var c in b)if(b.hasOwnProperty(c))try{b[c]=a.parse(b[c])}catch(ta){}return b};H.reCreateObject=function(a){function b(a){var f=[];a.forEach(function(a){Array.isArray(a)?f.push(b(a)):"object"===typeof a?f.push(c(a)):f.push(a)});return f}function c(a){var f={},g;for(g in a)a.hasOwnProperty(g)&&(null===a[g]?f[g]=null:
Array.isArray(a[g])?f[g]=b(a[g]):f[g]="object"===typeof a[g]?c(a[g]):a[g]);return f}return Array.isArray(a)?b(a):c(a)};H.setVerticalCenter=function(a){setTimeout(function(){var b=p(".jimu-vcenter-text",a),c,f;l.forEach(b,function(a){c=d.getContentBox(a).h;d.setStyle(a,{lineHeight:c+"px"})},this);b=p(".jimu-vcenter",a);l.forEach(b,function(a){c=d.getContentBox(a).h;f=d.getContentBox(p(a).parent()[0]).h;d.setStyle(a,{marginTop:(f-c)/2+"px"})},this)},10)};H.merge=U;H.loadStyleLink=function(a,c,f){var g=
new e,n,t=require(H.getRequireConfig()).toUrl(c);if(require.cache["url:"+t]){n=require.cache["url:"+t];var h=t.split("/").pop(),t=t.substr(0,t.length-h.length);n=Q(n,t);a=f?d.create("style",{id:a,type:"text/css"},d.byId(f),"before"):d.create("style",{id:a,type:"text/css"},document.getElementsByTagName("head")[0]);a.styleSheet&&!a.sheet?a.styleSheet.cssText=n:a.appendChild(d.toDom(n));g.resolve("load");return g}n=f?d.create("link",{id:a,rel:"stylesheet",type:"text/css",href:t+"?wab_dv\x3d"+window.deployVersion},
d.byId(f),"before"):d.create("link",{id:a,rel:"stylesheet",type:"text/css",href:t+"?wab_dv\x3d"+window.deployVersion},document.getElementsByTagName("head")[0]);b(n,"load",function(){g.resolve("load")});var u=setInterval(function(){var a;if(l.some(document.styleSheets,function(b){if(b.href&&b.href.substr(b.href.indexOf(c),b.href.length)===c)return a=b,!0}))try{!g.isFulfilled()&&(a.cssRules&&a.cssRules.length||a.rules&&a.rules.length)&&g.resolve("load"),clearInterval(u)}catch(ra){}},50);return g};H.changeLocation=
function(a){window.history.pushState&&window.history.pushState({path:a},"",a)};H.urlToObject=function(a){var b=null;-1===a.indexOf("#")?(b=N.urlToObject(a),b.hash=null):(a=a.split("#"),b=N.urlToObject(a[0]),b.hash=a[1]?-1<a[1].indexOf("\x3d")?m.queryToObject(a[1]):a[1]:null);return b};H.manifest=function(){function a(a){a.panels.forEach(function(a){a.uri="panels/"+a.name+"/Panel.js"});a.styles.forEach(function(a){a.uri="styles/"+a.name+"/style.css"});a.layouts.forEach(function(a){a.uri="layouts/"+
a.name+"/config.json";a.icon="layouts/"+a.name+"/icon.png";a.RTLIcon="layouts/"+a.name+"/icon_rtl.png"})}return{addManifestProperies:function(b){b.icon||(b.icon=b.folderUrl+"images/icon.png?wab_dv\x3d"+window.deployVersion);b.thumbnail||(b.thumbnail=b.folderUrl+"images/thumbnail.png");"theme"===b.category?a(b):("undefined"!==typeof b["2D"]&&(b.support2D=b["2D"]),"undefined"!==typeof b["3D"]&&(b.support3D=b["3D"]),"undefined"===typeof b["2D"]&&"undefined"===typeof b["3D"]&&(b.support2D=!0),delete b["2D"],
delete b["3D"],"undefined"===typeof b.properties&&(b.properties={}),ba.processWidgetProperties(b))},processManifestLabel:function(a,b){var c=b.split("-")[0];a.label=a.i18nLabels&&(a.i18nLabels[b]||a.i18nLabels[c]||a.i18nLabels.defaultLabel)||a.label||a.name;a.layouts&&l.forEach(a.layouts,function(c){var f="i18nLabels_layout_"+c.name;c.label=a[f]&&(a[f][b]||a[f].defaultLabel)||c.label||c.name});a.styles&&l.forEach(a.styles,function(c){var f="i18nLabels_style_"+c.name;c.label=a[f]&&(a[f][b]||a[f].defaultLabel)||
c.label||c.name})},addI18NLabel:function(a){var b=new e;if(a.i18nLabels)return b.resolve(a),b;a.i18nLabels={};if(a.properties&&!1===a.properties.hasLocale)return b.resolve(a),b;var c;c=a.isRemote?a.amdFolder+"nls/strings.js":a.amdFolder+"nls/strings";require(H.getRequireConfig(),["dojo/i18n!"+c],function(c){var f={};f[dojoConfig.locale]=c;ba.addI18NLabelToManifest(a,null,f);b.resolve(a)});return b}}}();H.getUniqueValues=function(a,b,c,f){return function(){var b=new e;f?b.resolve(f):b=M({url:a,content:{f:"json"},
handleAs:"json",callbackParamName:"callback"});return b}().then(function(f){return H._getUniqueValues(a,b,c,f).then(function(a){var c=[],c=H.getFieldInfoByFieldName(f.fields,b),g=null,n=0<=["esriFieldTypeOID","esriFieldTypeSmallInteger","esriFieldTypeInteger","esriFieldTypeSingle","esriFieldTypeDouble"].indexOf(c.type);c&&(n&&(a=l.map(a,function(a){a=parseFloat(a);isNaN(a)&&(a=null);return a})),c.domain&&c.domain.codedValues&&0<c.domain.codedValues.length?(g={},l.forEach(c.domain.codedValues,function(a){g[a.code]=
a.name})):f.typeIdField===b&&(g={},l.forEach(f.types,function(a){g[a.id]=a.name})));return c=l.map(a,function(a){var b=null,b=null===a||void 0===a?"\x3cNull\x3e":g&&g.hasOwnProperty(a)?g[a]:n?H.localizeNumber(a):a;return{value:a,label:b}})})})};H._getUniqueValues=function(a,b,c,f){var g=new e;a=a.replace(/\/*$/g,"");c||(c="1\x3d1");/\/ImageServer$/gi.test(a)?g=H._getUniqueValuesByQueryTask(a,b,c):(g=H.getFieldInfoByFieldName(f.fields,b),g=0<H._getCodedValuesOrTypesCount(g,f)?H._getUniqueValuesByQueryTask(a,
b,c):H._getUniqueValuesByGenerateRenderer(a,b,c));return g};H._getCodedValuesOrTypesCount=function(a,b){if(a){if(a.domain&&"codedValue"===a.domain.type&&a.domain.codedValues)return a.domain.codedValues.length;if(b.typeIdField===a.name&&b.types)return b.types.length}return 0};H._getUniqueValuesByQueryTask=function(a,b,c){var f=new L;f.where=c;f.returnDistinctValues=!0;f.returnGeometry=!1;f.outFields=[b];return(new K(a)).execute(f).then(function(a){var c=[];a.features&&0<a.features.length&&l.forEach(a.features,
function(a){a&&a.attributes&&c.push(a.attributes[b])});return c})};H._getUniqueValuesByGenerateRenderer=function(b,c,f){var g=new e;b=b.replace(/\/*$/g,"")+"/generateRenderer";c=a.stringify({type:"uniqueValueDef",uniqueValueFields:[c]});M({url:b,content:{classificationDef:c,f:"json",where:f},handleAs:"json",callbackParamName:"callback"}).then(r.hitch(this,function(a){var b=[];(a=a&&a.uniqueValueInfos)&&0<a.length&&(b=l.map(a,r.hitch(this,function(a){return a.value})));g.resolve(b)}),r.hitch(this,
function(a){g.reject(a)}));return g};H.isCodedValuesSupportFilter=function(a,b){var c=parseFloat(a.currentVersion);return b<=parseFloat(a.maxRecordCount)&&10.1<c};H.combineRadioCheckBoxWithLabel=function(a,b){var c=!1;if(a&&1===a.nodeType&&"input"===a.tagName.toLowerCase()){var f=a.getAttribute("type")||"",f=f.toLowerCase();if("radio"===f||"checkbox"===f)c=!0}f=!1;b&&1===b.nodeType&&"label"===b.tagName.toLowerCase()&&(f=!0);c&&f&&(c=a.getAttribute("id"),c||(c="input_"+H.getRandomString(),a.setAttribute("id",
c)),b.setAttribute("for",c),d.setStyle(b,"cursor","pointer"))};H.groupRadios=function(a,c){var f=[],g="radiogroup_"+H.getRandomString();l.forEach(a,function(a){a.name=g;c&&(a=b(a,"change",c),f.push(a))});return f};H.convertExtentToPolygon=function(a){var b=a.xmin,c=a.xmax,f=a.ymin,g=a.ymax;return new C({rings:[[[b,g],[c,g],[c,f],[b,f],[b,g]]],spatialReference:a.toJson()})};H.combineGeometries=function(a){function b(a){var b={points:[],spatialReference:a[0].spatialReference.toJson()};l.forEach(a,function(a){"point"===
a.type?b.points=b.points.concat([[a.x,a.y]]):"multipoint"===a.type&&(b.points=b.points.concat(a.points))});return new y(b)}function c(a){var b={paths:[],spatialReference:a[0].spatialReference.toJson()};l.forEach(a,function(a){b.paths=b.paths.concat(a.paths)});return new B(b)}function f(a){var b={rings:[],spatialReference:a[0].spatialReference.toJson()};l.forEach(a,function(a){"polygon"===a.type?b.rings=b.rings.concat(a.rings):"extent"===a.type&&(a=H.convertExtentToPolygon(a),b.rings=b.rings.concat(a.rings))});
return new C(b)}var g=null;if(a&&0<a.length)if(1===a.length)g=a[0];else{for(var n=null,e=null,t=null,h=null,u=0;u<a.length;u++){n=a[u];switch(n.type){case "point":case "multipoint":h="point";break;case "polyline":h="polyline";break;case "polygon":case "extent":h="polygon";break;default:return null}if(0===u)t=h;else if(t!==h)return null;if(u!==a.length-1&&(e=a[u+1],!n.spatialReference.equals(e.spatialReference)))return null}"point"===h?g=b(a):"polyline"===h?g=c(a):"polygon"===h&&(g=f(a))}return g};
H.combineGeometriesByGraphics=function(a){var b=null;a&&0<a.length&&(a=l.map(a,function(a){return a.geometry}),b=H.combineGeometries(a));return b};H.isFeaturelayerUrlSupportQuery=function(a,b){var c=!1,f=/\/featureserver\//gi.test(a),g=/\/mapserver\//gi.test(a);b=(b||"").toLowerCase();f?c=0<=b.indexOf("query"):g&&(c=0<=b.indexOf("data"));return c};H.isImageServiceSupportQuery=function(a){return 0<=(a||"").toLowerCase().indexOf("catalog")};H.isStringEndWith=function(a,b){return a.lastIndexOf(b)+b.length===
a.length};H.localizeNumber=function(a,b){var c=(a.toString().split(".")[1]||"").length,f="",f=b&&isFinite(b.places)&&b.places,f=0<f||0<c?"#,###,###,##0.0"+Array.prototype.join.call({length:0<f?f+1:c},"0"):"#,###,###,##0",c={locale:k.locale,pattern:f};r.mixin(c,b||{});try{return u.format(a,c)}catch(qa){return console.error(qa),a.toLocaleString()}};H.parseNumber=function(a,b){var c={locale:k.locale};r.mixin(c,b||{});try{return u.parse(a,c)}catch(ua){return console.error(ua),a}};H.localizeDate=function(a,
b){var c={locale:k.locale,fullYear:!0};r.mixin(c,b||{});try{return n.format(a,c)}catch(ua){return console.error(ua),"date"===c.selector?a.toLocaleDateString():"time"===c.selector?a.toLocaleTimeString():a.toLocaleString()}};H.localizeNumberByFieldInfo=function(a,b){var c=null,c=r.exists("format.places",b)&&b.format.places,c=H.localizeNumber(a,{places:c});return r.exists("format.digitSeparator",b)&&!b.format.digitSeparator?c.toString().replace(new RegExp("\\"+t.group,"g"),""):c};H.localizeDateByFieldInfo=
function(a,b){var c=null;try{var f={date:a instanceof Date?a.getTime():a},g=r.exists("format.dateFormat",b)?b.format.dateFormat:"longMonthDayYear",c=v.substitute(f,"${date}",{dateFormat:{properties:["date"],formatter:"DateFormat"+w.prototype._dateFormats[g]}})}catch(da){console.error(da),c=a}return c};H.fieldFormatter={getFormattedUrl:function(a){if(a&&"string"===typeof a){var b=a.indexOf("http:");-1===b&&(b=a.indexOf("https:"));if(-1<b&&-1===a.indexOf("href\x3d")){var c=a.indexOf(" ",b);-1===c&&
(c=a.length);var f=-1<a.indexOf("\r\n",b)?a.indexOf("\r\n",b):-1<a.indexOf("\n",b)?a.indexOf("\n",b):c,c=f<c?f:c,f=a.substring(b,c);a=a.substring(0,b)+'\x3cA href\x3d"'+f+'" target\x3d"_blank"\x3e'+f+"\x3c/A\x3e"+a.substring(c,a.length)}}return null===a?"":a},getFormattedNumber:function(a,b){if("number"===typeof a){var c=(a.toString().split(".")[1]||"").length;a=H.localizeNumberByFieldInfo(a,{format:{places:b&&"number"===typeof b.places?parseInt(b.places,10):c,digitSeparator:b&&b.digitSeparator}});
return'\x3cspan class\x3d"jimu-numeric-value"\x3e'+(a||"")+"\x3c/span\x3e"}return a},getFormattedDate:function(a,b){if("number"===typeof a||a instanceof Date)a=H.localizeDateByFieldInfo(a,{format:b});return a||""},getCodedValue:function(a,b){if(a&&a.codedValues){for(var c=0,f=a.codedValues.length;c<f;c++){var g=a.codedValues[c];if(v.isDefined(b)&&r.exists("code",g)&&b.toString()===g.code.toString())return g.name}return b}return b||null},getTypeName:function(a,b){for(var c=b.length,f=0;f<c;f++)if(a===
b[f].id)return b[f].name;return a}};H.addRelativePathInCss=Q;H.url={isAbsolute:function(a){return a?a.startWith("http")||a.startWith("/"):!1},removeQueryParamFromUrl:function(a,b){var c=N.urlToObject(a);c.query&&delete c.query[b];var f=c.path,g;for(g in c.query)f=f===c.path?f+"?"+g+"\x3d"+c.query[g]:f+"\x26"+g+"\x3d"+c.query[g];return f},addQueryParamToUrl:function(a,b,c){a=N.urlToObject(a);a.query||(a.query={});a.query[b]=c;b=a.path;for(var f in a.query)b=b===a.path?b+"?"+f+"\x3d"+a.query[f]:b+"\x26"+
f+"\x3d"+a.query[f];return b}};H.processUrlInWidgetConfig=function(a,b){if(a)return a.startWith("data:")||a.startWith("http")||a.startWith("/")?a:a.startWith("${appPath}")?a.replace("${appPath}",window.appInfo.appPath):b+a};H.processUrlInAppConfig=function(a){if(a)return a.startWith("data:")||a.startWith("http")||a.startWith("/")?a:window.appInfo.appPath+a};H.getLocationUrlWithoutHashAndQueryParams=function(){var a=window.location,b=a.protocol+"//"+a.host+a.pathname,a=N.urlToObject(a.href);a.query&&
a.query.apiurl&&(b=H.url.addQueryParamToUrl(b,"apiurl",a.query.apiurl));return b};H.getDefaultWebMapThumbnail=function(){return require.toUrl("jimu/images/webmap.png")};H.invertColor=function(a){a=a.substring(1);3===a.length&&(a=a.slice(0,1)+a.slice(0,1)+a.slice(1,1)+a.slice(1,1)+a.slice(2,1)+a.slice(2,1));a=parseInt(a,16);return 7829367<a?"#000000":"#ffffff"};H.mixinAppConfigPosition=function(a,b){var c=r.clone(a);if(!b)return c;b=r.clone(b);var f=c.widgetOnScreen,g=b.widgetOnScreen;g&&g.widgets&&
("[object Object]"===Object.prototype.toString.call(g.widgets)?l.forEach(f.widgets,function(a,b){var c;c=a.uri?a.uri:"ph_"+b;g.widgets[c]&&g.widgets[c].position&&(g.widgets[c].position.relativeTo||(g.widgets[c].position.relativeTo="map"),a.position=g.widgets[c].position)},this):l.forEach(g.widgets,function(a,b){a.position&&!a.position.relativeTo&&(a.position.relativeTo="map");f.widgets[b]&&a.position&&(f.widgets[b].position=a.position)}));if(g&&g.groups)if("[object Object]"===Object.prototype.toString.call(g.groups))l.forEach(f.groups,
function(a,b){var c;c=a.label?a.label:"g_"+b;g.groups[c]&&g.groups[c].panel&&g.groups[c].panel.position&&(g.groups[c].panel.position.relativeTo||(g.groups[c].panel.position.relativeTo="map"),a.panel.position=g.groups[c].panel.position)},this);else{var n;n=a.layoutDefinition?a.layoutDefinition.manager:"jimu/layoutManagers/AbsolutePositionLayoutManager";"jimu/layoutManagers/AbsolutePositionLayoutManager"===n?l.forEach(g.groups,function(a,b){a.panel&&a.panel.position&&!a.panel.position.relativeTo&&(a.panel.position.relativeTo=
"map");f.groups[b]&&a.panel&&a.panel.position&&(f.groups[b].panel.position=a.panel.position)}):"jimu/layoutManagers/GridLayoutManager"===n&&(f.groups=ia(f.groups,g.groups.map(function(a){return a.id})))}b.map&&b.map.position&&(c.map?c.map.position=b.map.position:c.map={position:b.map.position});b.widgetPool&&b.widgetPool.panel&&(b.widgetPool.panel.position&&!b.widgetPool.panel.position.relativeTo&&(b.widgetPool.panel.position.relativeTo="map"),c.widgetPool.panel.position=b.widgetPool.panel.position);
b.mobileLayout&&(c.mobileLayout=b.mobileLayout);return c};H.handleGridLayoutOnScreenGroupChange=ia;H.template={groupIdentification:"groups\\[.+\\]",widgetIdentification:"widgets\\[.+\\]",getSearchRange:function(a,b,c){var f=-1;b=a.search(new RegExp(b));0<=b&&(a=a.slice(b,a.length),a=a.indexOf(c),f=b+a+c.length);return{firstPos:b,lastPos:f}},setConfigValue:function(a,b,c){Y(a,b,c)},getConfigValue:function(a,b){return Y(a,b)},setConfigValueWithId:function(a,b,c){ca(a,b,c)},getConfigValueWithId:function(a,
b){return ca(a,b)},getKeyInfo:function(a){var b=this.getWidgetIdByKey(a);if(null!==b)return{type:"widget",id:b};a=this.getGroupIdByKey(a);return null!==a?{type:"group",id:a}:{type:"unknow",id:null}},getWidgetIdByKey:function(a){var b=H.template.getSearchRange(a,H.template.widgetIdentification,"]");if(-1===b.firstPos)a=null;else{var c=a.slice(b.firstPos,b.lastPos);a=a.slice(b.firstPos+c.indexOf("[")+1,b.lastPos-1)}return a},getGroupIdByKey:function(a){var b=H.template.getSearchRange(a,H.template.groupIdentification,
"]");if(-1===b.firstPos)a=null;else{var c=a.slice(b.firstPos,b.lastPos);a=a.slice(b.firstPos+c.indexOf("[")+1,b.lastPos-1)}return a},getConfigedWidgetsByTemplateConfig:function(a){var b=[],c=H.template.widgetIdentification+"_config",f;l.forEach(a.configurationSettings,function(a){l.forEach(a.fields,function(a){a.fieldName&&(f=H.template.getSearchRange(a.fieldName,c,"]"),0<=f.firstPos&&(a=H.template.getWidgetIdByKey(a.fieldName),-1===b.indexOf(a)&&b.push(a)))},this)},this);return b},mergeTemplateAppConfigToAppConfig:function(a,
b,c){function f(a){var b=[];l.forEach(a,function(a){a&&b.push(a)},this);return b}var g=a.widgetOnScreen,n=a.portalUrl;b.values.webmap&&(a.map.itemId=b.values.webmap);c&&(a.map.mapOptions&&H.deleteMapOptions(a.map.mapOptions),a.map.portalUrl=n,b.values.app_title||(b.values.app_title=c.title),b.values.app_subtitle||(b.values.app_subtitle=c.snippet));for(var e in b.values)"webmap"!==e&&H.template.setConfigValueWithId(a,e,b.values[e]);a.widgetPool.widgets=f(a.widgetPool.widgets);g.widgets=f(g.widgets);
if(a.widgetPool.groups)for(b=0;b<a.widgetPool.groups.length;b++)a.widgetPool.groups[b].widgets=f(a.widgetPool.groups[b].widgets);if(g.groups)for(b=0;b<g.groups.length;b++)g.groups[b].widgets=f(g.groups[b].widgets);return a}};H.deleteMapOptions=function(a){a&&(delete a.extent,delete a.lods,delete a.center,delete a.scale,delete a.zoom,delete a.maxScale,delete a.maxZoom,delete a.minScale,delete a.minZoom)};H.graphicsExtent=function(a,b){var c=null;try{0<a.length&&(c=W.graphicsExtent(a))&&"number"===
typeof b&&0<b&&(c=c.expand(b))}catch(ua){console.error(ua)}return c};H.sanitizeHTML=function(a){return html_sanitize(a,function(a){return a},function(a){return a})};H.stripHTML=function(a){return a?-1<a.indexOf("\x3c")&&-1<a.indexOf("\x3e")?a.replace(/<(?:.|\s)*?>/g,""):a:a};H.encodeHTML=function(a){return String(a).replace(/&/g,"\x26amp;").replace(/</g,"\x26lt;").replace(/>/g,"\x26gt;").replace(/"/g,"\x26quot;").replace(/'/g,"\x26#39;")};H.removeSuffixSlashes=function(a){return a.replace(/\/*$/g,
"")};H.getBestDisplayAttributes=function(a,b){var c={},f=null,g;for(g in a)f=H.getBestDisplayValue(g,a,b),c[g]=f;return c};H.getBestDisplayValue=function(a,b,c){var f="",g=null;r.isArrayLike(c)?g=H.getFieldInfoByFieldName(c,a):"object"===typeof c&&c.name===a&&(g=c);g&&(f=b[a],"esriFieldTypeDate"===g.type?f&&(a=new Date(parseInt(f,10)),f=H._tryLocaleDate(a)):"number"===typeof f&&(g.domain&&"codedValue"===g.domain.type?l.some(g.domain.codedValues,function(a){if(a.code===f)return f=a.name,!0}):f=H._tryLocaleNumber(f)));
if(null===f||void 0===f)f="";return f};H.getDefaultPortalFieldInfo=function(a){var b=a.name,b={fieldName:b,label:a.alias||b,tooltip:"",visible:!1,format:null,stringFieldOption:"textbox"};switch(a.type){case "esriFieldTypeSmallInteger":case "esriFieldTypeInteger":b.format={places:0,digitSeparator:!0};break;case "esriFieldTypeSingle":case "esriFieldTypeDouble":b.format={places:2,digitSeparator:!0};break;case "esriFieldTypeDate":b.format={dateFormat:"longMonthDayYear"}}return b};H._tryLocaleNumber=function(a){var b=
H.localizeNumber(a);if(null===b||void 0===b)b=a;return b};H._tryLocaleDate=function(a){var b=H.localizeDate(a);b||(b=a.toLocaleDateString());return b};H.getFieldInfoByFieldName=function(a,b){var c=null;a&&0<a.length&&l.some(a,r.hitch(this,function(a){return a.name===b?(c=a,!0):!1}));return c};H.containsNonLatinCharacter=function(a){for(var b=0;b<a.length;b++)if(255<a.charCodeAt(b))return!0;return!1};H.has=function(a){var b=q(a);if(b)return b;if("ie"===a.toLowerCase()){a=0;var c=/MSIE (\d+\.\d+);/.test(navigator.userAgent),
f=!!navigator.userAgent.match(/Trident\/7.0/),g=navigator.userAgent.indexOf("rv:11.0");c&&(a=Number(RegExp.$1));-1!==navigator.appVersion.indexOf("MSIE 10")&&(a=10);f&&-1!==g&&(a=11);return 11===a&&11||b}if("edge"===a.toLowerCase())return navigator.userAgent.split("Edge/")[1]||b};H.detectUserAgent=function(){var a={},b={},c=navigator.userAgent,f=navigator.platform,g=c.match(/Web[kK]it[\/]{0,1}([\d.]+)/),n=c.match(/(Android);?[\s\/]+([\d.]+)?/),e=!!c.match(/\(Macintosh\; Intel /),t=c.match(/(iPad).*OS\s([\d_]+)/),
h=c.match(/(iPod)(.*OS\s([\d_]+))?/),u=!t&&c.match(/(iPhone\sOS)\s([\d_]+)/),d=c.match(/(webOS|hpwOS)[\s\/]([\d.]+)/),f=/Win\d{2}|Windows/.test(f),v=c.match(/Windows Phone ([\d.]+)/),x=d&&c.match(/TouchPad/),w=c.match(/Kindle\/([\d.]+)/),p=c.match(/Silk\/([\d._]+)/),m=c.match(/(BlackBerry).*Version\/([\d.]+)/),k=c.match(/(BB10).*Version\/([\d.]+)/),l=c.match(/(RIM\sTablet\sOS)\s([\d.]+)/),z=c.match(/PlayBook/),q=c.match(/Chrome\/([\d.]+)/)||c.match(/CriOS\/([\d.]+)/),A=c.match(/Firefox\/([\d.]+)/),
y=c.match(/\((?:Mobile|Tablet); rv:([\d.]+)\).*Firefox\/[\d.]+/),B=c.match(/MSIE\s([\d.]+)/)||c.match(/Trident\/[\d](?=[^\?]+).*rv:([0-9.].)/),C=!q&&c.match(/(iPhone|iPod|iPad).*AppleWebKit(?!.*Safari)/),D=C||c.match(/Version\/([\d.]+)([^S](Safari)|[^M]*(Mobile)[^S]*(Safari))/);b.webkit=!!g;b.webkit&&(b.version=g[1]);n&&(a.android=!0,a.version=n[2]);u&&!h&&(a.ios=a.iphone=!0,a.version=u[2].replace(/_/g,"."));t&&(a.ios=a.ipad=!0,a.version=t[2].replace(/_/g,"."));h&&(a.ios=a.ipod=!0,a.version=h[3]?
h[3].replace(/_/g,"."):null);v&&(a.wp=!0,a.version=v[1]);d&&(a.webos=!0,a.version=d[2]);x&&(a.touchpad=!0);m&&(a.blackberry=!0,a.version=m[2]);k&&(a.bb10=!0,a.version=k[2]);l&&(a.rimtabletos=!0,a.version=l[2]);z&&(b.playbook=!0);w&&(a.kindle=!0,a.version=w[1]);p&&(b.silk=!0,b.version=p[1]);!p&&a.android&&c.match(/Kindle Fire/)&&(b.silk=!0);q&&(b.chrome=!0,b.version=q[1]);A&&(b.firefox=!0,b.version=A[1]);y&&(a.firefoxos=!0,a.version=y[1]);B&&(b.ie=!0,b.version=B[1]);D&&(e||a.ios||f)&&(b.safari=!0,
a.ios||(b.version=D[1]));C&&(b.webview=!0);a.tablet=!!(t||z||n&&!c.match(/Mobile/)||A&&c.match(/Tablet/)||B&&!c.match(/Phone/)&&c.match(/Touch/));a.phone=!(a.tablet||a.ipod||!(n||u||d||m||k||q&&c.match(/Android/)||q&&c.match(/CriOS\/([\d.]+)/)||A&&c.match(/Mobile/)||B&&c.match(/Touch/)));return{os:a,browser:b}};H.isMobileUa=function(){var a=H.detectUserAgent();return!0===a.os.phone||!0===a.os.tablet?!0:!1};H.inMobileSize=function(){var a=d.getMarginBox(document.body);if(a.w<=window.jimuConfig.breakPoints[0]||
a.h<=window.jimuConfig.breakPoints[0])return d.addClass(window.jimuConfig.layoutId,"jimu-ismobile"),!0;d.removeClass(window.jimuConfig.layoutId,"jimu-ismobile");return!1};H.getObjectIdField=function(a){if(a.objectIdField)return a.objectIdField;a=a.fields;for(var b=0;b<a.length;b++){var c=a[b];if("esriFieldTypeOID"===c.type)return c.name}return null};H.isNeedHttpsButNot=function(){var a=navigator.geolocation,b=window.hasOwnProperty("isSecureContext");return(b&&window.isSecureContext||!b&&"https:"===
window.location.protocol)&&a?!1:!0};H.toFeatureSet=function(a){var b=new G;"[object Object]"===Object.prototype.toString.call(a)&&(a=[a]);b.features=a;if(0<a.length){var c;l.some(a,function(a){if(a.geometry)return c=a,!0});if(c){a=c.getLayer();var f={};a&&(b.displayFieldName=a.displayField,l.forEach(a.fields,r.hitch(this,function(a){var b=a.name;f[b]=a.alias||b})),b.fieldAliases=f);b.geometryType=c.geometry.type;b.spatialReference=c.geometry.spatialReference}}return b};H.showValidationErrorTipForFormDijit=
function(a){try{!a.validate()&&a.domNode&&a.focusNode&&(a.focusNode.focus(),setTimeout(r.hitch(this,function(){a.focusNode.blur()}),100))}catch(ka){console.error(ka)}};H.getFeatureLayerDefinition=function(a){var b=null,c=a.graphics;a.graphics=[];var f=a.toJson();a.graphics=c;f&&(b=f.layerDefinition);return b};H.simulateClickEvent=function(a){if(q("safari")){var b=document.createEvent("MouseEvents");b.initEvent("click",!0,!0);a.dispatchEvent(b)}else a.click()};H.getFeatureSetByLayerAndFeatures=function(a,
b){var c=new G;c.fields=r.clone(a.fields);c.features=b;c.geometryType=a.geometryType;c.fieldAliases={};l.forEach(c.fields,r.hitch(this,function(a){var b=a.name;c.fieldAliases[b]=a.alias||b}));return c};H.featureAction=function(){return{zoomTo:function(a,b,c){c||(c={});c.hasOwnProperty("extentFactor")||(c.extentFactor=1.2);if(a&&b&&0<b.length){var f=l.every(b,function(a){return a&&a.spatialReference&&a.type});if(l.every(b,function(a){return a&&a.geometry&&a.geometry.spatialReference&&a.geometry.type})||
f)f&&(b=l.map(b,function(a){return{geometry:a}})),1===b.length&&"point"===b[0].type?(c=15,c=-1<a.getMaxZoom()?a.getMaxZoom():.1,a.centerAndZoom(b[0].geometry,c)):(b=W.graphicsExtent(b),a.setExtent(b.expand(c.extentFactor)))}},flash:function(a,b){function c(a,b){l.forEach(g,function(c,f){c.setSymbol(b?a:e[f]||t)})}function f(a){return function(){setTimeout(function(){c(h,!0);g[0]&&b&&b.redraw();setTimeout(function(){c(null,!1);g[0]&&b&&b.redraw();a()},200)},200)}}if(l.every(a||[],function(a){return a&&
a.geometry})){var g=a,n=g[0],e=l.map(g,function(a){return a.symbol}),t=n.symbol||r.getObject("renderer.symbol",!1,b),h=null;b&&"esriGeometryPoint"===b.geometryType?h=new J(require.toUrl("jimu")+"/images/flash.gif",20,20):(h=r.clone(t))&&(h.outline?h.outline.setColor("#ffc500"):h.setColor("#ffc500"));n&&t&&h&&b&&("esriGeometryPoint"===b.geometryType?(c(h,!0),b.redraw(),setTimeout(function(){c(null,!1);b.redraw()},2E3)):f(f(f(function(){})))())}},panTo:function(a,b){if(l.every(b||[],function(a){return a&&
a.geometry})){var c;0<b.length?c=W.graphicsExtent(b).getCenter():(c=b[0].geometry,c="polyline"===c.type||"polygon"===c.type?c.getExtent().getCenter():"extent"===c.type?c.getCenter():"multipoint"===c.type?1<c.points.length?c.getExtent().getCenter():c.getPoint(0):c);a.centerAt(c)}},showPopup:function(a,b){if(l.every(b||[],function(a){return a&&a.geometry})){var c=a.infoWindow;c.setFeatures(b);var f=b[0];"point"===f.geometry.type?c.show(f.geometry,{closetFirst:!0}):c.show(f.geometry.getExtent().getCenter(),
{closetFirst:!0})}}}}();H.isInConfigOrPreviewWindow=function(){var a=!1;try{a=!window.isBuilder&&window.parent&&window.parent!==window&&window.parent.isBuilder}catch(ka){console.log(ka),a=!1}return!!a};H.getAppHref=function(){var a="";return a=H.isInConfigOrPreviewWindow()?window.parent.location.href:window.location.href};H.getAppIdFromUrl=function(){var a=!0,b=H.getAppHref();if(-1!==b.indexOf("id\x3d")||-1!==b.indexOf("appid\x3d")||-1!==b.indexOf("apps"))a=!1;if(!0===a)return b;a=this.urlToObject(window.location.href);
if(a.query&&(a.query.id||a.query.appid))return a.query.id||a.query.appid;if(window.appInfo){if(window.appInfo.id)return window.appInfo.id;if(window.appInfo.appPath){if(a=window.appInfo.appPath.split("/"),a.length&&2<a.length)return a[a.length-2]}else console.error("CAN NOT getAppIdFromUrl")}};H.getEditorContentHeight=function(a,b,c){var f=new e;this._content=a;this._dom=b;this._domParam=c;var g=setTimeout(r.hitch(this,function(){clearTimeout(g);g=null;var a=0,b=this._domParam.contentWidth;try{var c=
document.createElement("div");c.setAttribute("id","fakeContent");d.setStyle(c,"background-size","contain");c.innerHTML=this._content;this._dom.appendChild(c);if(c){var n=p("img",c);n&&n.length&&n.style({maxWidth:b-20+"px"});d.setStyle(c,"position","absolute");d.setStyle(c,"width",b+"px");d.setStyle(c,"left","-99999px");d.setStyle(c,"top","-99999px");d.setStyle(c,"visibility","hidden");var e=d.getContentBox(c);e.h&&(a=e.h,a+=this._domParam.contentMarginTop+this._domParam.footerHeight+8)}}catch(oa){console.error("can't getEditorContentHeight"+
oa),a=200}f.resolve(a)}),1500);return f};H.getBase64Data=function(a){var b=new e;if(a&&a.startWith("data:image"))b.resolve(a);else try{M({url:a,handleAs:"arraybuffer"}).then(function(a){var c=new FileReader;c.onloadend=function(){b.resolve(c.result)};c.onerror=function(){b.resolve(null)};c.readAsDataURL(new Blob([a],{type:"image/png"}))},function(){b.resolve(null)})}catch(ta){console.warn(ta),b.resolve(null)}return b};H.getEditorTextColor=function(a,b){return{name:"dijit.editor.plugins.EditorTextColor",
custom:{recordUID:H.getColorRecordName(a),forceAttr:b}}};H.getEditorBackgroundColor=function(a){return{name:"dijit.editor.plugins.EditorBackgroundColor",custom:{recordUID:H.getColorRecordName(a)}}};H.getColorRecordName=function(a){return"wab_cr_"+(a||"")};H.b64toBlob=function(a,b,c){b=b||"";c=c||512;a=window.atob(a.replace(/^data:image\/(png|jpg|jpeg|gif);base64,/,""));for(var f=[],g=0;g<a.length;g+=c){for(var n=a.slice(g,g+c),e=Array(n.length),t=0;t<n.length;t++)e[t]=n.charCodeAt(t);n=new Uint8Array(e);
f.push(n)}return new Blob(f,{type:b})};H.subtractionArray=function(a,b){for(var c=a.length-1;0<=c;c--)for(var f=a[c],g=b.length-1;0<=g;g--)if(f===b[g]){a.splice(c,1);b.splice(g,1);break}return a};H.resourcesUrlToBlob=function(a){return M({url:a,handleAs:"blob"})};H.processItemResourceOfAppConfig=function(a,b){function f(a){for(var b in a)if("object"===typeof a[b])if(Array.isArray(a[b]))for(var c=a,n=b,e=0;e<c[n].length;e++)"string"===typeof c[n][e]?g(c,n,e):"object"===typeof c[n][e]&&f(c[n][e]);else f(a[b]);
else"string"===typeof a[b]&&g(a,b)}function g(a,c,f){"number"===typeof f?b.test(a[c][f])&&(t=b.func({obj:a,key:c,i:f}),"function"===typeof t.then?e.push(t):n.push(t)):b.test(a[c])&&(t=b.func({obj:a,key:c}),"function"===typeof t.then?e.push(t):n.push(t))}var n=[],e=[],t;f(a);return 0<e.length?c(e).then(function(b){0<n.length&&(b=b.concat(n));return{appConfig:a,result:b}}):{appConfig:a,result:n}};H.isEsriDomain=function(a){return/^https?:\/\/(?:[\w\-\_]+\.)+(?:esri|arcgis)\.com/.test(a)};H.uniqueArray=
function(a){for(var b=[],c=0;c<a.length;c++)-1===b.indexOf(a[c])&&b.push(a[c]);return b};H.isNotEmptyObject=function(a,b){return b?H.isObject(a)&&0<Object.keys(a).length&&Array.isArray(a):H.isObject(a)&&0<Object.keys(a).length};H.getMinOfArray=function(a){return Number(Math.min.apply(Math,a))};H.getDataSchemaFromLayerDefinition=function(a){var b=a.fields.filter(function(a){return"esriFieldTypeOID"===a.type}),b=0<b.length?b[0]:null;return{geometryType:a.geometryType,fields:a.fields,displayField:a.displayField,
objectIdField:b,typeIdField:a.typeIdField}};return H})},"dojo/NodeList-traverse":function(){define(["./query","./_base/lang","./_base/array"],function(r,l,d){var q=r.NodeList;l.extend(q,{_buildArrayFromCallback:function(d){for(var m=[],p=0;p<this.length;p++){var h=d.call(this[p],this[p],m);h&&(m=m.concat(h))}return m},_getUniqueAsNodeList:function(k){for(var m=[],p=0,h;h=k[p];p++)1==h.nodeType&&-1==d.indexOf(m,h)&&m.push(h);return this._wrap(m,null,this._NodeListCtor)},_getUniqueNodeListWithParent:function(d,
m){var p=this._getUniqueAsNodeList(d),p=m?r._filterResult(p,m):p;return p._stash(this)},_getRelatedUniqueNodes:function(d,m){return this._getUniqueNodeListWithParent(this._buildArrayFromCallback(m),d)},children:function(d){return this._getRelatedUniqueNodes(d,function(d,p){return l._toArray(d.childNodes)})},closest:function(d,m){return this._getRelatedUniqueNodes(null,function(p,h){do if(r._filterResult([p],d,m).length)return p;while(p!=m&&(p=p.parentNode)&&1==p.nodeType);return null})},parent:function(d){return this._getRelatedUniqueNodes(d,
function(d,p){return d.parentNode})},parents:function(d){return this._getRelatedUniqueNodes(d,function(d,p){for(var h=[];d.parentNode;)d=d.parentNode,h.push(d);return h})},siblings:function(d){return this._getRelatedUniqueNodes(d,function(d,p){for(var h=[],e=d.parentNode&&d.parentNode.childNodes,c=0;c<e.length;c++)e[c]!=d&&h.push(e[c]);return h})},next:function(d){return this._getRelatedUniqueNodes(d,function(d,p){for(var h=d.nextSibling;h&&1!=h.nodeType;)h=h.nextSibling;return h})},nextAll:function(d){return this._getRelatedUniqueNodes(d,
function(d,p){for(var h=[],e=d;e=e.nextSibling;)1==e.nodeType&&h.push(e);return h})},prev:function(d){return this._getRelatedUniqueNodes(d,function(d,p){for(var h=d.previousSibling;h&&1!=h.nodeType;)h=h.previousSibling;return h})},prevAll:function(d){return this._getRelatedUniqueNodes(d,function(d,p){for(var h=[],e=d;e=e.previousSibling;)1==e.nodeType&&h.push(e);return h})},andSelf:function(){return this.concat(this._parent)},first:function(){return this._wrap(this[0]&&[this[0]]||[],this)},last:function(){return this._wrap(this.length?
[this[this.length-1]]:[],this)},even:function(){return this.filter(function(d,m){return 0!=m%2})},odd:function(){return this.filter(function(d,m){return 0==m%2})}});return q})},"dojo/number":function(){define(["./_base/lang","./i18n","./i18n!./cldr/nls/number","./string","./regexp"],function(r,l,d,q,k){var m={};r.setObject("dojo.number",m);m.format=function(h,e){e=r.mixin({},e||{});var c=l.normalizeLocale(e.locale),c=l.getLocalization("dojo.cldr","number",c);e.customs=c;c=e.pattern||c[(e.type||"decimal")+
"Format"];return isNaN(h)||Infinity==Math.abs(h)?null:m._applyPattern(h,c,e)};m._numberPatternRE=/[#0,]*[#0](?:\.0*#*)?/;m._applyPattern=function(h,e,c){c=c||{};var b=c.customs.group,a=c.customs.decimal;e=e.split(";");var g=e[0];e=e[0>h?1:0]||"-"+g;if(-1!=e.indexOf("%"))h*=100;else if(-1!=e.indexOf("\u2030"))h*=1E3;else if(-1!=e.indexOf("\u00a4"))b=c.customs.currencyGroup||b,a=c.customs.currencyDecimal||a,e=e.replace(/([\s\xa0]*)(\u00a4{1,3})([\s\xa0]*)/,function(a,b,f,g){return(a=c[["symbol","currency",
"displayName"][f.length-1]]||c.currency||"")?b+a+g:""});else if(-1!=e.indexOf("E"))throw Error("exponential notation not supported");var u=m._numberPatternRE,g=g.match(u);if(!g)throw Error("unable to find a number expression in pattern: "+e);!1===c.fractional&&(c.places=0);return e.replace(u,m._formatAbsolute(h,g[0],{decimal:a,group:b,places:c.places,round:c.round}))};m.round=function(h,e,c){c=10/(c||10);return(c*+h).toFixed(e)/c};if(0==(.9).toFixed()){var p=m.round;m.round=function(h,e,c){var b=
Math.pow(10,-e||0),a=Math.abs(h);if(!h||a>=b)b=0;else if(a/=b,.5>a||.95<=a)b=0;return p(h,e,c)+(0<h?b:-b)}}m._formatAbsolute=function(h,e,c){c=c||{};!0===c.places&&(c.places=0);Infinity===c.places&&(c.places=6);e=e.split(".");var b="string"==typeof c.places&&c.places.indexOf(","),a=c.places;b?a=c.places.substring(b+1):0<=a||(a=(e[1]||[]).length);0>c.round||(h=m.round(h,a,c.round));h=String(Math.abs(h)).split(".");var g=h[1]||"";e[1]||c.places?(b&&(c.places=c.places.substring(0,b)),b=void 0!==c.places?
c.places:e[1]&&e[1].lastIndexOf("0")+1,b>g.length&&(h[1]=q.pad(g,b,"0",!0)),a<g.length&&(h[1]=g.substr(0,a))):h[1]&&h.pop();a=e[0].replace(",","");b=a.indexOf("0");-1!=b&&(b=a.length-b,b>h[0].length&&(h[0]=q.pad(h[0],b)),-1==a.indexOf("#")&&(h[0]=h[0].substr(h[0].length-b)));var a=e[0].lastIndexOf(","),u,n;-1!=a&&(u=e[0].length-a-1,e=e[0].substr(0,a),a=e.lastIndexOf(","),-1!=a&&(n=e.length-a-1));e=[];for(a=h[0];a;)b=a.length-u,e.push(0<b?a.substr(b):a),a=0<b?a.slice(0,b):"",n&&(u=n,n=void 0);h[0]=
e.reverse().join(c.group||",");return h.join(c.decimal||".")};m.regexp=function(h){return m._parseInfo(h).regexp};m._parseInfo=function(h){h=h||{};var e=l.normalizeLocale(h.locale),e=l.getLocalization("dojo.cldr","number",e),c=h.pattern||e[(h.type||"decimal")+"Format"],b=e.group,a=e.decimal,g=1;if(-1!=c.indexOf("%"))g/=100;else if(-1!=c.indexOf("\u2030"))g/=1E3;else{var u=-1!=c.indexOf("\u00a4");u&&(b=e.currencyGroup||b,a=e.currencyDecimal||a)}e=c.split(";");1==e.length&&e.push("-"+e[0]);e=k.buildGroupRE(e,
function(c){c="(?:"+k.escapeString(c,".")+")";return c.replace(m._numberPatternRE,function(c){var f={signed:!1,separator:h.strict?b:[b,""],fractional:h.fractional,decimal:a,exponent:!1};c=c.split(".");var n=h.places;1==c.length&&1!=g&&(c[1]="###");1==c.length||0===n?f.fractional=!1:(void 0===n&&(n=h.pattern?c[1].lastIndexOf("0")+1:Infinity),n&&void 0==h.fractional&&(f.fractional=!0),!h.places&&n<c[1].length&&(n+=","+c[1].length),f.places=n);c=c[0].split(",");1<c.length&&(f.groupSize=c.pop().length,
1<c.length&&(f.groupSize2=c.pop().length));return"("+m._realNumberRegexp(f)+")"})},!0);u&&(e=e.replace(/([\s\xa0]*)(\u00a4{1,3})([\s\xa0]*)/g,function(a,b,c,g){a=k.escapeString(h[["symbol","currency","displayName"][c.length-1]]||h.currency||"");if(!a)return"";b=b?"[\\s\\xa0]":"";g=g?"[\\s\\xa0]":"";return h.strict?b+a+g:(b&&(b+="*"),g&&(g+="*"),"(?:"+b+a+g+")?")}));return{regexp:e.replace(/[\xa0 ]/g,"[\\s\\xa0]"),group:b,decimal:a,factor:g}};m.parse=function(h,e){var c=m._parseInfo(e),b=(new RegExp("^"+
c.regexp+"$")).exec(h);if(!b)return NaN;var a=b[1];if(!b[1]){if(!b[2])return NaN;a=b[2];c.factor*=-1}a=a.replace(new RegExp("["+c.group+"\\s\\xa0]","g"),"").replace(c.decimal,".");return a*c.factor};m._realNumberRegexp=function(h){h=h||{};"places"in h||(h.places=Infinity);"string"!=typeof h.decimal&&(h.decimal=".");"fractional"in h&&!/^0/.test(h.places)||(h.fractional=[!0,!1]);"exponent"in h||(h.exponent=[!0,!1]);"eSigned"in h||(h.eSigned=[!0,!1]);var e=m._integerRegexp(h),c=k.buildGroupRE(h.fractional,
function(a){var b="";a&&0!==h.places&&(b="\\"+h.decimal,b=Infinity==h.places?"(?:"+b+"\\d+)?":b+("\\d{"+h.places+"}"));return b},!0),b=k.buildGroupRE(h.exponent,function(a){return a?"([eE]"+m._integerRegexp({signed:h.eSigned})+")":""}),e=e+c;c&&(e="(?:(?:"+e+")|(?:"+c+"))");return e+b};m._integerRegexp=function(h){h=h||{};"signed"in h||(h.signed=[!0,!1]);"separator"in h?"groupSize"in h||(h.groupSize=3):h.separator="";var e=k.buildGroupRE(h.signed,function(b){return b?"[-+]":""},!0),c=k.buildGroupRE(h.separator,
function(b){if(!b)return"(?:\\d+)";b=k.escapeString(b);" "==b?b="\\s":"\u00a0"==b&&(b="\\s\\xa0");var a=h.groupSize,c=h.groupSize2;return c?(b="(?:0|[1-9]\\d{0,"+(c-1)+"}(?:["+b+"]\\d{"+c+"})*["+b+"]\\d{"+a+"})",0<a-c?"(?:"+b+"|(?:0|[1-9]\\d{0,"+(a-1)+"}))":b):"(?:0|[1-9]\\d{0,"+(a-1)+"}(?:["+b+"]\\d{"+a+"})*)"},!0);return e+c};return m})},"dojo/i18n":function(){define("./_base/kernel require ./has ./_base/array ./_base/config ./_base/lang ./_base/xhr ./json module".split(" "),function(r,l,d,q,k,
m,p,h,e){d.add("dojo-preload-i18n-Api",1);p=r.i18n={};var c=/(^.*(^|\/)nls)(\/|$)([^\/]*)\/?([^\/]*)/,b=function(a,b,c,f){var g=[c+f];b=b.split("-");for(var n="",e=0;e<b.length;e++)if(n+=(n?"-":"")+b[e],!a||a[n])g.push(c+n+"/"+f),g.specificity=n;return g},a={},g=function(a,b,c){c=c?c.toLowerCase():r.locale;a=a.replace(/\./g,"/");b=b.replace(/\./g,"/");return/root/i.test(c)?a+"/nls/"+b:a+"/nls/"+c+"/"+b},u=r.getL10nName=function(a,b,c){return a=e.id+"!"+g(a,b,c)},n=function(c,f,g,n,e,t){c([f],function(h){var u=
m.clone(h.root||h.ROOT),d=b(!h._v1x&&h,e,g,n);c(d,function(){for(var b=1;b<d.length;b++)u=m.mixin(m.clone(u),arguments[b]);a[f+"/"+e]=u;u.$locale=d.specificity;t()})})},t=function(a){var b=k.extraLocale||[],b=m.isArray(b)?b:[b];b.push(a);return b},f=function(b,f,g){var e=c.exec(b),u=e[1]+"/",v=e[5]||e[4],p=u+v,k=(e=e[5]&&e[4])||r.locale||"",l=p+"/"+k,e=e?[k]:t(k),y=e.length,B=function(){--y||g(m.delegate(a[l]))},k=b.split("*"),C="preload"==k[1];if(d("dojo-preload-i18n-Api")){if(C&&(a[b]||(a[b]=1,
z(k[2],h.parse(k[3]),1,f)),g(1)),(k=C)||(x&&w.push([b,f,g]),k=x&&!a[l]),k)return}else if(C){g(1);return}q.forEach(e,function(b){var c=p+"/"+b;d("dojo-preload-i18n-Api")&&A(c);a[c]?B():n(f,p,u,v,b,B)})};d("dojo-preload-i18n-Api");var v=p.normalizeLocale=function(a){a=a?a.toLowerCase():r.locale;return"root"==a?"ROOT":a},x=0,w=[],z=p._preloadLocalizations=function(b,c,g,n){function e(a,b){n([a],b)}function t(a,b){for(var c=a.split("-");c.length;){if(b(c.join("-")))return;c.pop()}b("ROOT")}function h(){for(--x;!x&&
w.length;)f.apply(null,w.shift())}function u(f){f=v(f);t(f,function(g){if(0<=q.indexOf(c,g)){var u=b.replace(/\./g,"/")+"_"+g;x++;e(u,function(b){for(var c in b){var e=b[c],u=c.match(/(.+)\/([^\/]+)$/),d;if(u&&(d=u[2],u=u[1]+"/",e._localized)){var v;if("ROOT"===g){var w=v=e._localized;delete e._localized;w.root=e;a[l.toAbsMid(c)]=w}else v=e._localized,a[l.toAbsMid(u+d+"/"+g)]=e;g!==f&&function(b,c,g,e){var u=[],d=[];t(f,function(a){e[a]&&(u.push(l.toAbsMid(b+a+"/"+c)),d.push(l.toAbsMid(b+c+"/"+a)))});
u.length?(x++,n(u,function(){for(var n=u.length-1;0<=n;n--)g=m.mixin(m.clone(g),arguments[n]),a[d[n]]=g;a[l.toAbsMid(b+c+"/"+f)]=m.clone(g);h()})):a[l.toAbsMid(b+c+"/"+f)]=g}(u,d,e,v)}}h()});return!0}return!1})}n=n||l;u();q.forEach(r.config.extraLocale,u)},A=function(){},A=function(b){for(var c,f=b.split("/"),g=r.global[f[0]],n=1;g&&n<f.length-1;g=g[f[n++]]);g&&((c=g[f[n]])||(c=g[f[n].replace(/-/g,"_")]),c&&(a[b]=c));return c};p.getLocalization=function(a,b,c){var n;a=g(a,b,c);f(a,l,function(a){n=
a});return n};return m.mixin(p,{dynamic:!0,normalize:function(a,b){return/^\./.test(a)?b(a):a},load:f,cache:a,getL10nName:u})})},"dojo/string":function(){define(["./_base/kernel","./_base/lang"],function(r,l){var d=/[&<>'"\/]/g,q={"\x26":"\x26amp;","\x3c":"\x26lt;","\x3e":"\x26gt;",'"':"\x26quot;","'":"\x26#x27;","/":"\x26#x2F;"},k={};l.setObject("dojo.string",k);k.escape=function(m){return m?m.replace(d,function(d){return q[d]}):""};k.rep=function(d,p){if(0>=p||!d)return"";for(var h=[];;){p&1&&h.push(d);
if(!(p>>=1))break;d+=d}return h.join("")};k.pad=function(d,p,h,e){h||(h="0");d=String(d);p=k.rep(h,Math.ceil((p-d.length)/h.length));return e?d+p:p+d};k.substitute=function(d,p,h,e){e=e||r.global;h=h?l.hitch(e,h):function(c){return c};return d.replace(/\$\{([^\s\:\}]*)(?:\:([^\s\:\}]+))?\}/g,function(c,b,a){if(""==b)return"$";c=l.getObject(b,!1,p);a&&(c=l.getObject(a,!1,e).call(e,c,b));a=h(c,b);if("undefined"===typeof a)throw Error('string.substitute could not find key "'+b+'" in template');return a.toString()})};
k.trim=String.prototype.trim?l.trim:function(d){d=d.replace(/^\s+/,"");for(var p=d.length-1;0<=p;p--)if(/\S/.test(d.charAt(p))){d=d.substring(0,p+1);break}return d};return k})},"dojo/date/locale":function(){define("../_base/lang ../_base/array ../date ../cldr/supplemental ../i18n ../regexp ../string ../i18n!../cldr/nls/gregorian module".split(" "),function(r,l,d,q,k,m,p,h,e){function c(a,b,c,n){return n.replace(/([a-z])\1*/ig,function(f){var e,t,h=f.charAt(0);f=f.length;var u=["abbr","wide","narrow"];
switch(h){case "G":e=b[4>f?"eraAbbr":"eraNames"][0>a.getFullYear()?0:1];break;case "y":e=a.getFullYear();switch(f){case 1:break;case 2:if(!c.fullYear){e=String(e);e=e.substr(e.length-2);break}default:t=!0}break;case "Q":case "q":e=Math.ceil((a.getMonth()+1)/3);t=!0;break;case "M":case "L":e=a.getMonth();3>f?(e+=1,t=!0):(h=["months","L"==h?"standAlone":"format",u[f-3]].join("-"),e=b[h][e]);break;case "w":e=g._getWeekOfYear(a,0);t=!0;break;case "d":e=a.getDate();t=!0;break;case "D":e=g._getDayOfYear(a);
t=!0;break;case "e":case "c":if(e=a.getDay(),2>f){e=(e-q.getFirstDayOfWeek(c.locale)+8)%7;break}case "E":e=a.getDay();3>f?(e+=1,t=!0):(h=["days","c"==h?"standAlone":"format",u[f-3]].join("-"),e=b[h][e]);break;case "a":h=12>a.getHours()?"am":"pm";e=c[h]||b["dayPeriods-format-wide-"+h];break;case "h":case "H":case "K":case "k":t=a.getHours();switch(h){case "h":e=t%12||12;break;case "H":e=t;break;case "K":e=t%12;break;case "k":e=t||24}t=!0;break;case "m":e=a.getMinutes();t=!0;break;case "s":e=a.getSeconds();
t=!0;break;case "S":e=Math.round(a.getMilliseconds()*Math.pow(10,f-3));t=!0;break;case "v":case "z":if(e=g._getZone(a,!0,c))break;f=4;case "Z":h=g._getZone(a,!1,c);h=[0>=h?"+":"-",p.pad(Math.floor(Math.abs(h)/60),2),p.pad(Math.abs(h)%60,2)];4==f&&(h.splice(0,0,"GMT"),h.splice(3,0,":"));e=h.join("");break;default:throw Error("dojo.date.locale.format: invalid pattern char: "+n);}t&&(e=p.pad(e,f));return e})}function b(a,b,c,g){var f=function(a){return a};b=b||f;c=c||f;g=g||f;var n=a.match(/(''|[^'])+/g),
e="'"==a.charAt(0);l.forEach(n,function(a,f){a?(n[f]=(e?c:b)(a.replace(/''/g,"'")),e=!e):n[f]=""});return g(n.join(""))}function a(a,b,c,g){g=m.escapeString(g);c.strict||(g=g.replace(" a"," ?a"));return g.replace(/([a-z])\1*/ig,function(f){var g;g=f.charAt(0);var n=f.length,e="",t="";c.strict?(1<n&&(e="0{"+(n-1)+"}"),2<n&&(t="0{"+(n-2)+"}")):(e="0?",t="0{0,2}");switch(g){case "y":g="\\d{2,4}";break;case "M":case "L":2<n?(g=b["months-"+("L"==g?"standAlone":"format")+"-"+u[n-3]].slice(0).join("|"),
c.strict||(g=g.replace(/\./g,""),g="(?:"+g+")\\.?")):g="1[0-2]|"+e+"[1-9]";break;case "D":g="[12][0-9][0-9]|3[0-5][0-9]|36[0-6]|"+e+"[1-9][0-9]|"+t+"[1-9]";break;case "d":g="3[01]|[12]\\d|"+e+"[1-9]";break;case "w":g="[1-4][0-9]|5[0-3]|"+e+"[1-9]";break;case "E":case "e":case "c":g=".+?";break;case "h":g="1[0-2]|"+e+"[1-9]";break;case "k":g="1[01]|"+e+"\\d";break;case "H":g="1\\d|2[0-3]|"+e+"\\d";break;case "K":g="1\\d|2[0-4]|"+e+"[1-9]";break;case "m":case "s":g="[0-5]\\d";break;case "S":g="\\d{"+
n+"}";break;case "a":n=c.am||b["dayPeriods-format-wide-am"];e=c.pm||b["dayPeriods-format-wide-pm"];g=n+"|"+e;c.strict||(n!=n.toLowerCase()&&(g+="|"+n.toLowerCase()),e!=e.toLowerCase()&&(g+="|"+e.toLowerCase()),-1!=g.indexOf(".")&&(g+="|"+g.replace(/\./g,"")));g=g.replace(/\./g,"\\.");break;default:g=".*"}a&&a.push(f);return"("+g+")"}).replace(/[\xa0 ]/g,"[\\s\\xa0]")}var g={};r.setObject(e.id.replace(/\//g,"."),g);g._getZone=function(a,b,c){return b?d.getTimezoneName(a):a.getTimezoneOffset()};g.format=
function(a,n){n=n||{};var f=k.normalizeLocale(n.locale),e=n.formatLength||"short",f=g._getGregorianBundle(f),t=[],h=r.hitch(this,c,a,f,n);if("year"==n.selector)return b(f["dateFormatItem-yyyy"]||"yyyy",h);var u;"date"!=n.selector&&(u=n.timePattern||f["timeFormat-"+e])&&t.push(b(u,h));"time"!=n.selector&&(u=n.datePattern||f["dateFormat-"+e])&&t.push(b(u,h));return 1==t.length?t[0]:f["dateTimeFormat-"+e].replace(/\'/g,"").replace(/\{(\d+)\}/g,function(a,b){return t[b]})};g.regexp=function(a){return g._parseInfo(a).regexp};
g._parseInfo=function(c){c=c||{};var f=k.normalizeLocale(c.locale),f=g._getGregorianBundle(f),n=c.formatLength||"short",e=c.datePattern||f["dateFormat-"+n],t=c.timePattern||f["timeFormat-"+n],n="date"==c.selector?e:"time"==c.selector?t:f["dateTimeFormat-"+n].replace(/\{(\d+)\}/g,function(a,b){return[t,e][b]}),h=[];return{regexp:b(n,r.hitch(this,a,h,f,c)),tokens:h,bundle:f}};g.parse=function(a,b){var c=/[\u200E\u200F\u202A\u202E]/g,f=g._parseInfo(b),n=f.tokens,e=f.bundle,c=(new RegExp("^"+f.regexp.replace(c,
"")+"$",f.strict?"":"i")).exec(a&&a.replace(c,""));if(!c)return null;var t=["abbr","wide","narrow"],h=[1970,0,1,0,0,0,0],u="",c=l.every(c,function(a,c){if(!c)return!0;var f=n[c-1],g=f.length,f=f.charAt(0);switch(f){case "y":if(2!=g&&b.strict)h[0]=a;else if(100>a)a=Number(a),f=""+(new Date).getFullYear(),g=100*f.substring(0,2),f=Math.min(Number(f.substring(2,4))+20,99),h[0]=a<f?g+a:g-100+a;else{if(b.strict)return!1;h[0]=a}break;case "M":case "L":if(2<g){if(g=e["months-"+("L"==f?"standAlone":"format")+
"-"+t[g-3]].concat(),b.strict||(a=a.replace(".","").toLowerCase(),g=l.map(g,function(a){return a.replace(".","").toLowerCase()})),a=l.indexOf(g,a),-1==a)return!1}else a--;h[1]=a;break;case "E":case "e":case "c":g=e["days-"+("c"==f?"standAlone":"format")+"-"+t[g-3]].concat();b.strict||(a=a.toLowerCase(),g=l.map(g,function(a){return a.toLowerCase()}));a=l.indexOf(g,a);if(-1==a)return!1;break;case "D":h[1]=0;case "d":h[2]=a;break;case "a":g=b.am||e["dayPeriods-format-wide-am"];f=b.pm||e["dayPeriods-format-wide-pm"];
if(!b.strict){var d=/\./g;a=a.replace(d,"").toLowerCase();g=g.replace(d,"").toLowerCase();f=f.replace(d,"").toLowerCase()}if(b.strict&&a!=g&&a!=f)return!1;u=a==f?"p":a==g?"a":"";break;case "K":24==a&&(a=0);case "h":case "H":case "k":if(23<a)return!1;h[3]=a;break;case "m":h[4]=a;break;case "s":h[5]=a;break;case "S":h[6]=a}return!0}),f=+h[3];"p"===u&&12>f?h[3]=f+12:"a"===u&&12==f&&(h[3]=0);f=new Date(h[0],h[1],h[2],h[3],h[4],h[5],h[6]);b.strict&&f.setFullYear(h[0]);var v=n.join(""),p=-1!=v.indexOf("d"),
v=-1!=v.indexOf("M");if(!c||v&&f.getMonth()>h[1]||p&&f.getDate()>h[2])return null;if(v&&f.getMonth()<h[1]||p&&f.getDate()<h[2])f=d.add(f,"hour",1);return f};var u=["abbr","wide","narrow"],n=[],t={};g.addCustomFormats=function(a,b){n.push({pkg:a,name:b});t={}};g._getGregorianBundle=function(a){if(t[a])return t[a];var b={};l.forEach(n,function(c){c=k.getLocalization(c.pkg,c.name,a);b=r.mixin(b,c)},this);return t[a]=b};g.addCustomFormats(e.id.replace(/\/date\/locale$/,".cldr"),"gregorian");g.getNames=
function(a,b,c,n){var f;n=g._getGregorianBundle(n);a=[a,c,b];"standAlone"==c&&(c=a.join("-"),f=n[c],1==f[0]&&(f=void 0));a[1]="format";return(f||n[a.join("-")]).concat()};g.isWeekend=function(a,b){var c=q.getWeekend(b),f=(a||new Date).getDay();c.end<c.start&&(c.end+=7,f<c.start&&(f+=7));return f>=c.start&&f<=c.end};g._getDayOfYear=function(a){return d.difference(new Date(a.getFullYear(),0,1,a.getHours()),a)+1};g._getWeekOfYear=function(a,b){1==arguments.length&&(b=0);var c=(new Date(a.getFullYear(),
0,1)).getDay(),f=(c-b+7)%7,f=Math.floor((g._getDayOfYear(a)+f-1)/7);c==b&&f++;return f};return g})},"dojo/date":function(){define(["./has","./_base/lang"],function(r,l){var d={getDaysInMonth:function(l){var k=l.getMonth();return 1==k&&d.isLeapYear(l)?29:[31,28,31,30,31,30,31,31,30,31,30,31][k]},isLeapYear:function(d){d=d.getFullYear();return!(d%400)||!(d%4)&&!!(d%100)},getTimezoneName:function(d){var k=d.toString(),m="",p=k.indexOf("(");if(-1<p)m=k.substring(++p,k.indexOf(")"));else if(p=/([A-Z\/]+) \d{4}$/,
k=k.match(p))m=k[1];else if(k=d.toLocaleString(),p=/ ([A-Z\/]+)$/,k=k.match(p))m=k[1];return"AM"==m||"PM"==m?"":m},compare:function(d,k,m){d=new Date(+d);k=new Date(+(k||new Date));"date"==m?(d.setHours(0,0,0,0),k.setHours(0,0,0,0)):"time"==m&&(d.setFullYear(0,0,0),k.setFullYear(0,0,0));return d>k?1:d<k?-1:0},add:function(d,k,m){var p=new Date(+d),h=!1,e="Date";switch(k){case "day":break;case "weekday":var c;(k=m%5)?c=parseInt(m/5):(k=0<m?5:-5,c=0<m?(m-5)/5:(m+5)/5);var b=d.getDay(),a=0;6==b&&0<m?
a=1:0==b&&0>m&&(a=-1);b+=k;if(0==b||6==b)a=0<m?2:-2;m=7*c+k+a;break;case "year":e="FullYear";h=!0;break;case "week":m*=7;break;case "quarter":m*=3;case "month":h=!0;e="Month";break;default:e="UTC"+k.charAt(0).toUpperCase()+k.substring(1)+"s"}if(e)p["set"+e](p["get"+e]()+m);h&&p.getDate()<d.getDate()&&p.setDate(0);return p},difference:function(l,k,m){k=k||new Date;m=m||"day";var p=k.getFullYear()-l.getFullYear(),h=1;switch(m){case "quarter":l=l.getMonth();k=k.getMonth();h=Math.floor(k/3)+1+4*p-(Math.floor(l/
3)+1);break;case "weekday":p=Math.round(d.difference(l,k,"day"));m=parseInt(d.difference(l,k,"week"));if(0==p%7)p=5*m;else{var h=0,e=l.getDay(),c=k.getDay();m=parseInt(p/7);k=p%7;l=new Date(l);l.setDate(l.getDate()+7*m);l=l.getDay();if(0<p)switch(!0){case 6==e:h=-1;break;case 0==e:h=0;break;case 6==c:h=-1;break;case 0==c:h=-2;break;case 5<l+k:h=-2}else if(0>p)switch(!0){case 6==e:h=0;break;case 0==e:h=1;break;case 6==c:h=2;break;case 0==c:h=1;break;case 0>l+k:h=2}p=p+h-2*m}h=p;break;case "year":h=
p;break;case "month":h=k.getMonth()-l.getMonth()+12*p;break;case "week":h=parseInt(d.difference(l,k,"day")/7);break;case "day":h/=24;case "hour":h/=60;case "minute":h/=60;case "second":h/=1E3;case "millisecond":h*=k.getTime()-l.getTime()}return Math.round(h)}};l.mixin(l.getObject("dojo.date",!0),d);return d})},"dojo/cldr/supplemental":function(){define(["../_base/lang","../i18n"],function(r,l){var d={};r.setObject("dojo.cldr.supplemental",d);d.getFirstDayOfWeek=function(l){l={bd:5,mv:5,ae:6,af:6,
bh:6,dj:6,dz:6,eg:6,iq:6,ir:6,jo:6,kw:6,ly:6,ma:6,om:6,qa:6,sa:6,sd:6,sy:6,ye:6,ag:0,ar:0,as:0,au:0,br:0,bs:0,bt:0,bw:0,by:0,bz:0,ca:0,cn:0,co:0,dm:0,"do":0,et:0,gt:0,gu:0,hk:0,hn:0,id:0,ie:0,il:0,"in":0,jm:0,jp:0,ke:0,kh:0,kr:0,la:0,mh:0,mm:0,mo:0,mt:0,mx:0,mz:0,ni:0,np:0,nz:0,pa:0,pe:0,ph:0,pk:0,pr:0,py:0,sg:0,sv:0,th:0,tn:0,tt:0,tw:0,um:0,us:0,ve:0,vi:0,ws:0,za:0,zw:0}[d._region(l)];return void 0===l?1:l};d._region=function(d){d=l.normalizeLocale(d);d=d.split("-");var k=d[1];k?4==k.length&&(k=
d[2]):k={aa:"et",ab:"ge",af:"za",ak:"gh",am:"et",ar:"eg",as:"in",av:"ru",ay:"bo",az:"az",ba:"ru",be:"by",bg:"bg",bi:"vu",bm:"ml",bn:"bd",bo:"cn",br:"fr",bs:"ba",ca:"es",ce:"ru",ch:"gu",co:"fr",cr:"ca",cs:"cz",cv:"ru",cy:"gb",da:"dk",de:"de",dv:"mv",dz:"bt",ee:"gh",el:"gr",en:"us",es:"es",et:"ee",eu:"es",fa:"ir",ff:"sn",fi:"fi",fj:"fj",fo:"fo",fr:"fr",fy:"nl",ga:"ie",gd:"gb",gl:"es",gn:"py",gu:"in",gv:"gb",ha:"ng",he:"il",hi:"in",ho:"pg",hr:"hr",ht:"ht",hu:"hu",hy:"am",ia:"fr",id:"id",ig:"ng",ii:"cn",
ik:"us","in":"id",is:"is",it:"it",iu:"ca",iw:"il",ja:"jp",ji:"ua",jv:"id",jw:"id",ka:"ge",kg:"cd",ki:"ke",kj:"na",kk:"kz",kl:"gl",km:"kh",kn:"in",ko:"kr",ks:"in",ku:"tr",kv:"ru",kw:"gb",ky:"kg",la:"va",lb:"lu",lg:"ug",li:"nl",ln:"cd",lo:"la",lt:"lt",lu:"cd",lv:"lv",mg:"mg",mh:"mh",mi:"nz",mk:"mk",ml:"in",mn:"mn",mo:"ro",mr:"in",ms:"my",mt:"mt",my:"mm",na:"nr",nb:"no",nd:"zw",ne:"np",ng:"na",nl:"nl",nn:"no",no:"no",nr:"za",nv:"us",ny:"mw",oc:"fr",om:"et",or:"in",os:"ge",pa:"in",pl:"pl",ps:"af",pt:"br",
qu:"pe",rm:"ch",rn:"bi",ro:"ro",ru:"ru",rw:"rw",sa:"in",sd:"in",se:"no",sg:"cf",si:"lk",sk:"sk",sl:"si",sm:"ws",sn:"zw",so:"so",sq:"al",sr:"rs",ss:"za",st:"za",su:"id",sv:"se",sw:"tz",ta:"in",te:"in",tg:"tj",th:"th",ti:"et",tk:"tm",tl:"ph",tn:"za",to:"to",tr:"tr",ts:"za",tt:"ru",ty:"pf",ug:"cn",uk:"ua",ur:"pk",uz:"uz",ve:"za",vi:"vn",wa:"be",wo:"sn",xh:"za",yi:"il",yo:"ng",za:"cn",zh:"cn",zu:"za",ace:"id",ady:"ru",agq:"cm",alt:"ru",amo:"ng",asa:"tz",ast:"es",awa:"in",bal:"pk",ban:"id",bas:"cm",bax:"cm",
bbc:"id",bem:"zm",bez:"tz",bfq:"in",bft:"pk",bfy:"in",bhb:"in",bho:"in",bik:"ph",bin:"ng",bjj:"in",bku:"ph",bqv:"ci",bra:"in",brx:"in",bss:"cm",btv:"pk",bua:"ru",buc:"yt",bug:"id",bya:"id",byn:"er",cch:"ng",ccp:"in",ceb:"ph",cgg:"ug",chk:"fm",chm:"ru",chp:"ca",chr:"us",cja:"kh",cjm:"vn",ckb:"iq",crk:"ca",csb:"pl",dar:"ru",dav:"ke",den:"ca",dgr:"ca",dje:"ne",doi:"in",dsb:"de",dua:"cm",dyo:"sn",dyu:"bf",ebu:"ke",efi:"ng",ewo:"cm",fan:"gq",fil:"ph",fon:"bj",fur:"it",gaa:"gh",gag:"md",gbm:"in",gcr:"gf",
gez:"et",gil:"ki",gon:"in",gor:"id",grt:"in",gsw:"ch",guz:"ke",gwi:"ca",haw:"us",hil:"ph",hne:"in",hnn:"ph",hoc:"in",hoj:"in",ibb:"ng",ilo:"ph",inh:"ru",jgo:"cm",jmc:"tz",kaa:"uz",kab:"dz",kaj:"ng",kam:"ke",kbd:"ru",kcg:"ng",kde:"tz",kdt:"th",kea:"cv",ken:"cm",kfo:"ci",kfr:"in",kha:"in",khb:"cn",khq:"ml",kht:"in",kkj:"cm",kln:"ke",kmb:"ao",koi:"ru",kok:"in",kos:"fm",kpe:"lr",krc:"ru",kri:"sl",krl:"ru",kru:"in",ksb:"tz",ksf:"cm",ksh:"de",kum:"ru",lag:"tz",lah:"pk",lbe:"ru",lcp:"cn",lep:"in",lez:"ru",
lif:"np",lis:"cn",lki:"ir",lmn:"in",lol:"cd",lua:"cd",luo:"ke",luy:"ke",lwl:"th",mad:"id",mag:"in",mai:"in",mak:"id",man:"gn",mas:"ke",mdf:"ru",mdh:"ph",mdr:"id",men:"sl",mer:"ke",mfe:"mu",mgh:"mz",mgo:"cm",min:"id",mni:"in",mnk:"gm",mnw:"mm",mos:"bf",mua:"cm",mwr:"in",myv:"ru",nap:"it",naq:"na",nds:"de","new":"np",niu:"nu",nmg:"cm",nnh:"cm",nod:"th",nso:"za",nus:"sd",nym:"tz",nyn:"ug",pag:"ph",pam:"ph",pap:"bq",pau:"pw",pon:"fm",prd:"ir",raj:"in",rcf:"re",rej:"id",rjs:"np",rkt:"in",rof:"tz",rwk:"tz",
saf:"gh",sah:"ru",saq:"ke",sas:"id",sat:"in",saz:"in",sbp:"tz",scn:"it",sco:"gb",sdh:"ir",seh:"mz",ses:"ml",shi:"ma",shn:"mm",sid:"et",sma:"se",smj:"se",smn:"fi",sms:"fi",snk:"ml",srn:"sr",srr:"sn",ssy:"er",suk:"tz",sus:"gn",swb:"yt",swc:"cd",syl:"bd",syr:"sy",tbw:"ph",tcy:"in",tdd:"cn",tem:"sl",teo:"ug",tet:"tl",tig:"er",tiv:"ng",tkl:"tk",tmh:"ne",tpi:"pg",trv:"tw",tsg:"ph",tts:"th",tum:"mw",tvl:"tv",twq:"ne",tyv:"ru",tzm:"ma",udm:"ru",uli:"fm",umb:"ao",unr:"in",unx:"in",vai:"lr",vun:"tz",wae:"ch",
wal:"et",war:"ph",xog:"ug",xsr:"np",yao:"mz",yap:"fm",yav:"cm",zza:"tr"}[d[0]];return k};d.getWeekend=function(l){var k=d._region(l);l={"in":0,af:4,dz:4,ir:4,om:4,sa:4,ye:4,ae:5,bh:5,eg:5,il:5,iq:5,jo:5,kw:5,ly:5,ma:5,qa:5,sd:5,sy:5,tn:5}[k];k={af:5,dz:5,ir:5,om:5,sa:5,ye:5,ae:6,bh:5,eg:6,il:6,iq:6,jo:6,kw:6,ly:6,ma:6,qa:6,sd:6,sy:6,tn:6}[k];void 0===l&&(l=6);void 0===k&&(k=0);return{start:l,end:k}};return d})},"dojox/encoding/base64":function(){define(["dojo/_base/lang"],function(r){r=r.getObject("dojox.encoding.base64",
!0);r.encode=function(l){for(var d=[],q=l.length,k=q%3,q=q-k,m=0;m<q;){var p=l[m++]<<16|l[m++]<<8|l[m++];d.push("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(p>>>18&63));d.push("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(p>>>12&63));d.push("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(p>>>6&63));d.push("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(p&63))}switch(k){case 2:p=l[m++]<<16|
l[m++]<<8;d.push("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(p>>>18&63));d.push("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(p>>>12&63));d.push("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(p>>>6&63));d.push("\x3d");break;case 1:p=l[m++]<<16,d.push("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(p>>>18&63)),d.push("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(p>>>
12&63)),d.push("\x3d"),d.push("\x3d")}return d.join("")};r.decode=function(l){l=l.split("");for(var d=[],q=l.length;"\x3d"==l[--q];);for(var k=0;k<q;){var m="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".indexOf(l[k++])<<18;k<=q&&(m|="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".indexOf(l[k++])<<12);k<=q&&(m|="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".indexOf(l[k++])<<6);k<=q&&(m|="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".indexOf(l[k++]));
d.push(m>>>16&255);d.push(m>>>8&255);d.push(m&255)}for(;0==d[d.length-1];)d.pop();return d};return r})},"esri/lang":function(){define("dojo/_base/array dojo/_base/json dojo/_base/kernel dojo/_base/lang dojo/date dojo/has dojo/number dojo/date/locale ./kernel".split(" "),function(r,l,d,q,k,m,p,h,e){function c(a){return void 0!==a&&null!==a}function b(a){return c(a)?a:""}function a(a,f,g){var n=g.match(/([^\(]+)(\([^\)]+\))?/i),e=q.trim(n[1]);g=f[a];var n=l.fromJson((n[2]?q.trim(n[2]):"()").replace(/^\(/,
"({").replace(/\)$/,"})")),t=n.utcOffset;if(-1===r.indexOf(u,e))e=q.getObject(e),q.isFunction(e)&&(g=e(g,a,f,n));else if("number"===typeof g||"string"===typeof g&&g&&!isNaN(Number(g)))switch(g=Number(g),e){case "NumberFormat":return p.format(g,n);case "DateString":a=new Date(g);if(n.local||n.systemLocale)return n.systemLocale?a.toLocaleDateString()+(n.hideTime?"":" "+a.toLocaleTimeString()):a.toDateString()+(n.hideTime?"":" "+a.toTimeString());a=a.toUTCString();n.hideTime&&(a=a.replace(/\s+\d\d\:\d\d\:\d\d\s+(utc|gmt)/i,
""));return a;case "DateFormat":return a=new Date(g),c(t)&&(a=k.add(a,"minute",a.getTimezoneOffset()-t)),h.format(a,n)}return b(g)}function g(a,b){var c;if(b)for(c in a)a.hasOwnProperty(c)&&(void 0===a[c]?delete a[c]:a[c]instanceof Object&&g(a[c],!0));else for(c in a)a.hasOwnProperty(c)&&void 0===a[c]&&delete a[c];return a}var u=["NumberFormat","DateString","DateFormat"],n=/<\/?[^>]+>/g;return{valueOf:function(a,b){for(var c in a)if(a[c]==b)return c;return null},stripTags:function(a){if(a){var b=
typeof a;if("string"===b)a=a.replace(n,"");else if("object"===b)for(var c in a)(b=a[c])&&"string"===typeof b&&(b=b.replace(n,"")),a[c]=b}return a},substitute:function(g,f,n){var e,t,h;c(n)&&(q.isObject(n)?(e=n.first,t=n.dateFormat,h=n.numberFormat):e=n);if(f&&"${*}"!==f)return q.replace(f,q.hitch({obj:g},function(c,f){var g=f.split(":");return 1<g.length?(f=g[0],g.shift(),a(f,this.obj,g.join(":"))):t&&-1!==r.indexOf(t.properties||"",f)?a(f,this.obj,t.formatter||"DateString"):h&&-1!==r.indexOf(h.properties||
"",f)?a(f,this.obj,h.formatter||"NumberFormat"):b(this.obj[f])}),/\$\{([^\}]+)\}/g);f=[];for(var u in g)if(n=g[u],t&&-1!==r.indexOf(t.properties||"",u)?n=a(u,g,t.formatter||"DateString"):h&&-1!==r.indexOf(h.properties||"",u)&&(n=a(u,g,h.formatter||"NumberFormat")),f.push(u+" \x3d "+b(n)+"\x3cbr/\x3e"),e)break;return f.join("")},filter:function(a,b,c){b=[q.isString(a)?a.split(""):a,c||d.global,q.isString(b)?new Function("item","index","array",b):b];c={};var f;a=b[0];for(f in a)b[2].call(b[f],a[f],
f,a)&&(c[f]=a[f]);return c},startsWith:function(a,b,c){c=c||0;return a.indexOf(b,c)===c},endsWith:function(a,b,c){if("number"!==typeof c||!isFinite(c)||Math.floor(c)!==c||c>a.length)c=a.length;c-=b.length;a=a.indexOf(b,c);return-1!==a&&a===c},isDefined:c,fixJson:g}})},"esri/kernel":function(){define(["dojo/_base/kernel","dojo/_base/config","dojo/has"],function(r,l,d){r=function(){return this}();var q=r.location,k=q.pathname;d=q.protocol;q={version:"3.21",_appBaseUrl:d+"//"+q.host+k.substring(0,k.lastIndexOf(k.split("/")[k.split("/").length-
1]))};l.noGlobals||(r.esri=q);(q.dijit=q.dijit||{})._arcgisUrl=("http:"===d||"https:"===d?d:"http:")+"//www.arcgis.com/sharing/rest";return q})},"esri/arcgis/utils":function(){define("require dojo/_base/lang dojo/_base/array dojo/_base/connect dojo/_base/Deferred dojo/_base/json dojo/_base/url dojo/on dojo/DeferredList dojo/dom-construct dojo/sniff ../kernel ../config ../Color ../lang ../request ../SpatialReference ../map ../urlUtils ../geometry/ScreenPoint ../geometry/Extent ../geometry/webMercatorUtils ../symbols/jsonUtils ../renderers/jsonUtils ../dijit/PopupTemplate ../dijit/Popup ../tasks/query ../tasks/GeometryService ../layers/ArcGISTiledMapServiceLayer ../layers/FeatureLayer dojo/i18n!../nls/jsapi".split(" "),
function(r,l,d,q,k,m,p,h,e,c,b,a,g,u,n,t,f,v,x,w,z,A,y,B,C,E,D,F,G,J,N){function M(a){return t({url:ha.arcgisUrl+"/"+a.itemId+"/data",content:{f:"json"},callbackParamName:"callback"},{disableIdentityLookup:!0,_preLookup:!0})}function L(a,b){var c={f:"json"};b&&(c.token=b);return t({url:a,content:c,callbackParamName:"callback"},{disableIdentityLookup:!0})}function K(a){!a.layerDefinition||a.layerDefinition.drawingInfo&&a.layerDefinition.drawingInfo.labelingInfo||(a.showLabels=!1);a.itemProperties.layerDefinition&&
(a.layerDefinition?(a.layerDefinition.drawingInfo||(a.layerDefinition.drawingInfo=a.itemProperties.layerDefinition.drawingInfo),n.isDefined(a.layerDefinition.definitionExpression)||(a.layerDefinition.definitionExpression=a.itemProperties.layerDefinition.definitionExpression),n.isDefined(a.layerDefinition.minScale)||(a.layerDefinition.minScale=a.itemProperties.layerDefinition.minScale),n.isDefined(a.layerDefinition.maxScale)||(a.layerDefinition.maxScale=a.itemProperties.layerDefinition.maxScale)):
a.layerDefinition=a.itemProperties.layerDefinition);!a.itemProperties.popupInfo||a.popupInfo||a.disablePopup||(a.popupInfo=a.itemProperties.popupInfo);n.isDefined(a.itemProperties.showLabels)&&!n.isDefined(a.showLabels)&&(a.showLabels=a.itemProperties.showLabels);n.isDefined(a.itemProperties.showLegend)&&!n.isDefined(a.showLegend)&&(a.showLegend=a.itemProperties.showLegend);n.isDefined(a.itemProperties.refreshInterval)&&!n.isDefined(a.refreshInterval)&&(a.refreshInterval=a.itemProperties.refreshInterval)}
function W(a){K(a);a.itemProperties.layerDefinition&&a.layerDefinition&&(!n.isDefined(a.layerDefinition.maximumTrackPoints)&&n.isDefined(a.itemProperties.layerDefinition.maximumTrackPoints)&&(a.layerDefinition.maximumTrackPoints=a.itemProperties.layerDefinition.maximumTrackPoints),!a.layerDefinition.definitionGeometry&&a.itemProperties.layerDefinition.definitionGeometry&&(a.layerDefinition.definitionGeometry=a.itemProperties.layerDefinition.definitionGeometry));a.itemProperties.purgeOptions&&!a.purgeOptions&&
(a.purgeOptions=a.itemProperties.purgeOptions)}function R(a,b){var c=new k,f=a.itemData,g=[],t=[];d.forEach(f.operationalLayers,function(a){if(a.itemId&&!a.type){var b=a.url.toLowerCase();-1<b.indexOf("/featureserver")||-1<b.indexOf("/mapserver/")?(t.push(a),g.push(M(a))):-1<b.indexOf("/mapserver")&&-1===b.indexOf("/mapserver/")&&(!a.layers||!n.isDefined(a.minScale)&&!n.isDefined(a.maxScale))?(t.push(a),g.push(M(a))):-1<b.indexOf("/imageserver")&&!n.isDefined(a.minScale)&&!n.isDefined(a.maxScale)?
(t.push(a),g.push(M(a))):-1<b.indexOf("/streamserver")&&(t.push(a),g.push(M(a)))}});f.baseMap&&f.baseMap.baseMapLayers&&d.forEach(f.baseMap.baseMapLayers,function(a){a.itemId&&"VectorTileLayer"!==a.layerType&&(t.push(a),g.push(M(a)))});if(0<g.length){var h={};(new e(g)).addCallback(function(b){d.forEach(t,function(a,c){var f=b[c][1];if(f&&!(f instanceof Error)&&(h[a.itemId]=f,!a.type)){var g=a.url.toLowerCase();(-1<g.indexOf("/featureserver")||-1<g.indexOf("/mapserver/"))&&f.layers?d.forEach(f.layers,
function(b){var c="/featureserver/"+b.id;(c=g.match(c+"$")==c)||(c="/mapserver/"+b.id,c=g.match(c+"$")==c);c&&(a.itemProperties=b,K(a))}):-1<g.indexOf("/streamserver")?(a.itemProperties=f,W(a)):-1<g.indexOf("/mapserver")?(f.layers&&!a.layers&&(a.layers=f.layers),n.isDefined(f.minScale)&&!n.isDefined(a.minScale)&&(a.minScale=f.minScale),n.isDefined(f.maxScale)&&!n.isDefined(a.maxScale)&&(a.maxScale=f.maxScale),n.isDefined(f.refreshInterval)&&!n.isDefined(a.refreshInterval)&&(a.refreshInterval=f.refreshInterval),
f.visibleLayers&&!a.visibleLayers&&(a.visibleLayers=f.visibleLayers)):-1<g.indexOf("/imageserver")&&(n.isDefined(f.minScale)&&!n.isDefined(a.minScale)&&(a.minScale=f.minScale),n.isDefined(f.maxScale)&&!n.isDefined(a.maxScale)&&(a.maxScale=f.maxScale),n.isDefined(f.refreshInterval)&&!n.isDefined(a.refreshInterval)&&(a.refreshInterval=f.refreshInterval),!f.popupInfo||a.popupInfo||a.disablePopup||(a.popupInfo=f.popupInfo),f.renderingRule&&!a.renderingRule&&(a.renderingRule=f.renderingRule,f.renderingRule.functionName&&
(a.renderingRule.rasterFunction=f.renderingRule.functionName)),f.bandIds&&!a.bandIds&&(a.bandIds=f.bandIds),f.mosaicRule&&!a.mosaicRule&&(a.mosaicRule=f.mosaicRule),f.format&&!a.format&&(a.format=f.format),n.isDefined(f.compressionQuality)&&!n.isDefined(a.compressionQuality)&&(a.compressionQuality=f.compressionQuality),!f.layerDefinition||!f.layerDefinition.definitionExpression||n.isDefined(a.layerDefinition)&&n.isDefined(a.layerDefinition.definitionExpression)||(a.layerDefinition=a.layerDefinition||
{},a.layerDefinition.definitionExpression=f.layerDefinition.definitionExpression))}});a.relatedItemsData=h;c.callback(a)})}else c.callback(a);return c}function ba(b,c){var f=new k,g=b.itemData,n=g.baseMap.baseMapLayers[0];if("BingMapsAerial"===n.type||"BingMapsRoad"===n.type||"BingMapsHybrid"===n.type)if(n.portalUrl&&a.id)delete c.bingMapsKey,a.id.checkSignInStatus(x.urlToObject(ha.arcgisUrl).path).then(l.hitch(null,function(a,b,c,f,g){L(n.portalUrl,g.token).then(l.hitch(null,Q,a,b,c,f),l.hitch(null,
U,a,b,c,f))},b,c,g,f),l.hitch(null,function(a,b,c,f,g){L(n.portalUrl).then(l.hitch(null,Q,a,b,c,f),l.hitch(null,U,a,b,c,f))},b,c,g,f));else if(c.bingMapsKey){var e=new Pa({bingMapsKey:c.bingMapsKey,mapStyle:Pa.MAP_STYLE_AERIAL});q.connect(e,"onLoad",l.hitch(this,function(){f.callback([b,c])}));q.connect(e,"onError",function(a){delete c.bingMapsKey;b.itemData=ia(g);n=b.itemData.baseMap.baseMapLayers[0];n.errors=[];n.errors.push({message:"The owner of the application has not provided a valid Bing Key for the Bing Map it includes. Switching to Esri layers."});
f.callback([b,c])})}else b.itemData=ia(g),n=b.itemData.baseMap.baseMapLayers[0],n.errors=[],n.errors.push({message:"The owner of the application has not provided a Bing Key for the Bing Map it includes. Switching to Esri layers."}),f.callback([b,c]);else f.callback([b,c]);return f}function O(a){var b=new k,c,f;a=a.itemData;var g=a.baseMap&&a.baseMap.baseMapLayers;if(ab&&!ab.supported())for(a=0;a<g.length;a++){var n=g[a];if(!n.isReference){"VectorTileLayer"===n.layerType&&(c=n.itemId,f=a);break}}c?
S(c,!1).addBoth(function(a){var c=/^https?:\/\/basemaps(dev)?\.arcgis\.com\/arcgis\/rest\/services\/World_Basemap\/VectorTileServer/i;a&&a.item&&c.test(a.item.url)&&(g[f]={id:"FB_"+n.id,layerType:"ArcGISTiledMapServiceLayer",opacity:"opacity"in n?n.opacity:1,visibility:"visibility"in n?n.visibility:!0,url:"https://services.arcgisonline.com/arcgis/rest/services/World_Street_Map/MapServer"});b.resolve()}):b.resolve();return b}function Q(a,b,c,f,g){g.bingKey?(b.bingMapsKey=g.bingKey,g=new Pa({bingMapsKey:b.bingMapsKey,
mapStyle:Pa.MAP_STYLE_AERIAL}),q.connect(g,"onLoad",l.hitch(this,function(){f.callback([a,b])})),q.connect(g,"onError",function(g){delete b.bingMapsKey;a.itemData=ia(c);g=a.itemData.baseMap.baseMapLayers[0];g.errors=[];g.errors.push({message:"The owner of the map has not provided a valid Bing Key for the Bing Map it includes. Switching to Esri layers."});f.callback([a,b])})):U(a,b,c,f)}function U(a,b,c,f){delete b.bingMapsKey;a.itemData=ia(c);c=a.itemData.baseMap.baseMapLayers[0];c.errors=[];c.errors.push({message:"The owner of the map has not provided a Bing Key for the Bing Map it includes. Switching to Esri layers."});
f.callback([a,b])}function ia(a){a.baseMap="BingMapsAerial"===a.baseMap.baseMapLayers[0].type?{title:"Imagery",baseMapLayers:[{id:"World_Imagery_2017",visibility:!0,opacity:1,url:"https://services.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer"}]}:"BingMapsRoad"===a.baseMap.baseMapLayers[0].type?{title:"Streets",baseMapLayers:[{id:"World_Street_Map_8421",opacity:1,visibility:!0,url:"https://services.arcgisonline.com/ArcGIS/rest/services/World_Street_Map/MapServer"}]}:{title:"Imagery with Labels",
baseMapLayers:[{id:"World_Imagery_6611",opacity:1,visibility:!0,url:"https://services.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer"},{id:"World_Boundaries_and_Places_1145",isReference:!0,opacity:1,visibility:!0,url:"https://services.arcgisonline.com/ArcGIS/rest/services/Reference/World_Boundaries_and_Places/MapServer"}]};return a}function Y(a,b,c,f){var g=a.dynamicLayerInfos||a.layerInfos,e=b.layers;if(e&&g)if(f.usePopupManager){var t;d.forEach(g,function(a){var b=a.id;if(!a.subLayerIds)for(a=
0;a<e.length;a++){var f=e[a];if(f.id===b&&f.popupInfo){t||(t={});t[b]={infoTemplate:new c(f.popupInfo),layerUrl:f.layerUrl};break}}});t&&a.setInfoTemplates(t)}else{var h=[],u=[],x=[],v=[],w=[],p=[];d.forEach(g,function(b){var c=b.id;if(!b.subLayerIds&&-1!==d.indexOf(a.visibleLayers,c))for(b=0;b<e.length;b++){var f=e[b];if(f.id===c){u.push(c);h.push(f.popupInfo);x.push(f.layerUrl||"");f.layerDefinition&&f.layerDefinition.definitionExpression?v.push(f.layerDefinition.definitionExpression):v.push("");
w.push(n.isDefined(f.minScale)?f.minScale:null);p.push(n.isDefined(f.maxScale)?f.maxScale:null);break}}});h.length&&(a.__popups=h,a.__popupIds=u,a.__popupUrls=x,a.__popupWhereClauses=v,a.__popupMinScales=w,a.__popupMaxScales=p,a.__resourceInfo=b.resourceInfo)}}function ca(a){if(!a)return!1;var b=(new p(ha.arcgisUrl)).authority;return-1!==a.indexOf(".arcgis.com/")||-1!==a.indexOf(b)}function H(a){return a?-1!==a.indexOf("/services.arcgisonline.com/")||-1!==a.indexOf("/server.arcgisonline.com/"):!1}
function ea(a){"https:"===location.protocol&&(ca(a)||H(a))&&(a=a.replace("http:","https:"));return a}function va(a,b,c){var f=[],g;a.displayLevels||(f=d.map(a.resourceInfo.tileInfo.lods,function(a){return a.level}));a.exclusionAreas&&(g=l.clone(a.exclusionAreas),g=d.map(g,function(a){a.geometry=new z(a.geometry);return a}));f=new G(ea(a.url),{resourceInfo:a.resourceInfo,opacity:a.opacity,visible:a.visibility,displayLevels:a.displayLevels||f,id:a.id,minScale:a.minScale,maxScale:a.maxScale,refreshInterval:a.refreshInterval,
exclusionAreas:g});c.ignorePopups||Y(f,a,b,c);return f}function la(a,b){if(!a||!b||0===b.length)return[];var c=","+b+",",f=[],g,n=",";for(g=0;g<a.length;g++)if(null!==a[g].subLayerIds){if(-1===c.indexOf(","+a[g].id+",")||-1<n.indexOf(","+a[g].id+","))n+=a[g].subLayerIds.toString()+","}else-1<c.indexOf(","+a[g].id+",")&&-1===n.indexOf(","+a[g].id+",")&&f.push(a[g].id);return f}function ma(a,b,c){var f=new Va;f.format="png24";a.resourceInfo&&a.resourceInfo.supportedImageFormatTypes&&-1<a.resourceInfo.supportedImageFormatTypes.indexOf("PNG32")&&
(f.format="png32");var f=new I(ea(a.url),{resourceInfo:a.resourceInfo,opacity:a.opacity,visible:a.visibility,id:a.id,imageParameters:f,minScale:a.minScale,maxScale:a.maxScale,refreshInterval:a.refreshInterval}),g=a.visibleLayers;if(!a.visibleLayers){var n="";d.forEach(f.layerInfos,function(a){a.defaultVisibility&&(n+=(0<n.length?",":"")+a.id)});g=n}if(a.layers&&0<a.layers.length){var e=[],t=[],h,u=[],x,v;d.forEach(a.layers,function(b){b.layerDefinition&&b.layerDefinition.definitionExpression&&(e[b.id]=
b.layerDefinition.definitionExpression);if(b.layerDefinition&&b.layerDefinition.source){h=null;v=b.layerDefinition.source;if("mapLayer"===v.type){var c=d.filter(a.resourceInfo.layers,function(a){return a.id===v.mapLayerId});c.length&&(h=l.mixin(c[0],b))}else h=l.mixin({},b);h&&(h.source=v,delete h.popupInfo,h=new Z(h),a.visibleLayers&&(c="string"==typeof a.visibleLayers?a.visibleLayers.split(","):a.visibleLayers,-1<d.indexOf(c,b.id)?h.defaultVisibility=!0:h.defaultVisibility=!1),t.push(h))}b.layerDefinition&&
b.layerDefinition.source&&b.layerDefinition.drawingInfo&&(x=new Wa(b.layerDefinition.drawingInfo),u[b.id]=x)},this);0<e.length&&f.setLayerDefinitions(e);0<t.length?(f.setDynamicLayerInfos(t,!0),0<u.length&&f.setLayerDrawingOptions(u,!0)):(g=la(f.layerInfos,g),f.setVisibleLayers(g))}else g=la(f.layerInfos,g),f.setVisibleLayers(g);c.ignorePopups||Y(f,a,b,c);return f}function sa(a,b,c){var f=new rb;f.bandIds=a.bandIds;null!=a.format&&(f.format=a.format,null!=a.compressionQuality&&(f.compressionQuality=
a.compressionQuality));if(a.renderingRule&&a.renderingRule.rasterFunction){var g=new sb(a.renderingRule);f.renderingRule=g}a.mosaicRule&&(g=new tb(a.mosaicRule),f.mosaicRule=g);n.isDefined(a.noData)&&(f.noData=a.noData);n.isDefined(a.noDataInterpretation)&&(f.noDataInterpretation=a.noDataInterpretation);n.isDefined(a.interpolation)&&(f.interpolation=a.interpolation);g=a.layerType?"ArcGISImageServiceVectorLayer"===a.layerType:!1;n.isDefined(a.layerType)||(g=a.resourceInfo.hasMultidimensions&&("esriImageServiceDataTypeVector-UV"===
a.resourceInfo.serviceDataType||"esriImageServiceDataTypeVector-MagDir"===a.resourceInfo.serviceDataType));f={resourceInfo:a.resourceInfo,opacity:a.opacity,visible:a.visibility,id:a.id,imageServiceParameters:f,minScale:a.minScale,maxScale:a.maxScale,refreshInterval:a.refreshInterval};f=g?new ja(ea(a.url),f):new ga(ea(a.url),f);a.layerDefinition&&(a.layerDefinition.drawingInfo&&a.layerDefinition.drawingInfo.renderer&&(g=B.fromJson(a.layerDefinition.drawingInfo.renderer),f.setRenderer(g)),a.layerDefinition.definitionExpression&&
f.setDefinitionExpression(a.layerDefinition.definitionExpression,!0));!c.ignorePopups&&a.popupInfo&&f.setInfoTemplate(new b(a.popupInfo));return f}function ka(a,b,c){var g=[102113,102100,3857],e=c||new f(b[0].layerObject.fullExtent.spatialReference),t=new f(a.resourceInfo.fullExtent.spatialReference);return e.wkt==t.wkt&&(e.wkid==t.wkid||n.isDefined(e.latestWkid)&&e.latestWkid==t.wkid||n.isDefined(t.latestWkid)&&e.wkid==t.latestWkid||n.isDefined(e.latestWkid)&&e.latestWkid==t.latestWkid)||e.wkid&&
t.wkid&&d.some(g,function(a){return a===t.wkid})&&d.some(g,function(a){return a===e.wkid})?!0:!1}function ta(a,b,c){if(!b[0].layerObject.tileInfo)return!1;a=a.resourceInfo.tileInfo;b=b[0].layerObject.tileInfo;c=c.width>c.height?c.width:c.height;for(var f=!1,g=!1,n=0;n<a.lods.length;n++){for(var e=a.lods[n].scale/a.dpi,t=0;t<b.lods.length;t++){var h=b.lods[t].scale/b.dpi;if(Math.abs(h-e)/h<1/c)if(f){g=!0;break}else f=!0}if(g)break}return g||f&&(1===a.lods.length||1===b.lods.length)?!0:!1}function ua(b,
c,g,e,t,u){var v,w,p=g._clazz;if("OpenStreetMap"===b.type)v=new jb({id:b.id,opacity:b.opacity,visible:null!==b.visibility&&void 0!==b.visibility?b.visibility:!0});else if("WFS"===b.type)e={customParameters:b.wfsInfo.customParameters,geometryType:b.layerDefinition.geometryType,id:b.id,labelingInfo:b.layerDefinition.drawingInfo.labelingInfo,maxFeatures:b.wfsInfo.maxFeatures,mode:b.mode,name:b.wfsInfo.name,showLabels:!0,swapXY:b.wfsInfo.swapXY,title:b.title,url:b.url,version:b.wfsInfo.version,visible:b.visibility,
wkid:b.layerDefinition.spatialReference.wkid},v=new ub,v.fromJson(e,function(){n.isDefined(b.opacity)&&v.setOpacity(b.opacity);n.isDefined(b.visibility)&&v.setVisibility(b.visibility);(b.minScale||b.maxScale)&&v.setScaleRange(b.minScale,b.maxScale);v.renderer=B.fromJson(b.layerDefinition.drawingInfo.renderer);!g.ignorePopups&&b.popupInfo&&v.setInfoTemplate(new p(b.popupInfo));v.emit("fromJsonComplete")});else if("WMS"===b.type){var k=[],A=[];d.forEach(b.layers,function(a){A.push(new Qa({name:a.name,
title:a.title,legendURL:a.legendURL,queryable:a.queryable,showPopup:a.showPopup}));k.push(a.name)},this);b.visibleLayers&&(k=b.visibleLayers);e=new z(b.extent[0][0],b.extent[0][1],b.extent[1][0],b.extent[1][1],new f({wkid:4326}));e={customLayerParameters:b.customLayerParameters,customParameters:b.customParameters,extent:e,layerInfos:A,version:b.version,maxWidth:b.maxWidth,maxHeight:b.maxHeight,featureInfoFormat:b.featureInfoFormat,getFeatureInfoURL:b.featureInfoUrl,getMapURL:b.mapUrl,spatialReferences:b.spatialReferences,
title:b.title,copyright:b.copyright,minScale:b.minScale||0,maxScale:b.maxScale||0,format:b.format};v=new vb(b.url,{id:b.id,visibleLayers:k,format:"png",transparent:b.firstLayer?!1:!0,opacity:b.opacity,visible:null!==b.visibility?b.visibility:!0,resourceInfo:e,refreshInterval:b.refreshInterval});v.spatialReference.wkid=e.spatialReferences[0]}else if("KML"===b.type){w=b.url;if(a.id){var D=a.id.findCredential(x.urlToObject(ha.arcgisUrl).path);D&&(c=ha.arcgisUrl.substring(ha.arcgisUrl.indexOf("//")+2,
ha.arcgisUrl.indexOf("/",ha.arcgisUrl.indexOf("//")+3)),t=c.split("."),t=t[t.length-2]+"."+t[t.length-1],u=w.indexOf(t),-1<u&&(w="https://"+c+w.substring(u+t.length),w+="?token\x3d"+D.token))}v=new wb(w,{id:b.id,visible:null!==b.visibility?b.visibility:!0,outSR:e,refreshInterval:b.refreshInterval});q.connect(v,"onLoad",function(){(b.opacity||0===b.opacity)&&v.setOpacity(b.opacity);n.isDefined(b.minScale)&&n.isDefined(b.maxScale)&&v.setScaleRange(b.minScale,b.maxScale);b.visibleFolders&&d.forEach(v.folders,
function(a){-1<d.indexOf(b.visibleFolders,a.id)?v.setFolderVisibility(a,!0):v.setFolderVisibility(a,!1)},this)})}else if("WebTiledLayer"===b.type){if(v=new ob(b.templateUrl,{id:b.id,visible:null!==b.visibility?b.visibility:!0,opacity:b.opacity,copyright:b.copyright,fullExtent:b.fullExtent&&new z(b.fullExtent),initialExtent:b.fullExtent&&new z(b.fullExtent),subDomains:b.subDomains,tileInfo:b.tileInfo?new kb(b.tileInfo):null,refreshInterval:b.refreshInterval,wmtsInfo:b.wmtsInfo}),n.isDefined(b.minScale)||
n.isDefined(b.maxScale))v.loaded?v.setScaleRange(b.minScale,b.maxScale):q.connect(v,"onLoad",function(){v.setScaleRange(b.minScale,b.maxScale)})}else if("GeoRSS"===b.type)v=new P(b.url,{id:b.id,opacity:b.opacity,outSpatialReference:e,refreshInterval:b.refreshInterval}),q.connect(v,"onLoad",function(){!1===b.visibility&&v.hide();n.isDefined(b.minScale)&&n.isDefined(b.maxScale)&&v.setScaleRange(b.minScale,b.maxScale);var a=v.getFeatureLayers();d.forEach(a,function(c){b.pointSymbol&&"esriGeometryPoint"===
c.geometryType?(c.renderer.symbol=y.fromJson(b.pointSymbol),1===a.length&&(v.pointSymbol=y.fromJson(b.pointSymbol))):b.lineSymbol&&"esriGeometryPolyline"===c.geometryType?(c.renderer.symbol=y.fromJson(b.lineSymbol),1===a.length&&(v.polylineSymbol=y.fromJson(b.lineSymbol))):b.polygonSymbol&&"esriGeometryPolygon"===c.geometryType&&(c.renderer.symbol=y.fromJson(b.polygonSymbol),1===a.length&&(v.polygonSymbol=y.fromJson(b.polygonSymbol)))})});else if("CSV"==b.type&&b.url)e={layerDefinition:b.layerDefinition,
columnDelimiter:b.columnDelimiter,id:b.id?b.id:null,visible:null!==b.visibility?b.visibility:!0,opacity:b.opacity,refreshInterval:b.refreshInterval},b.locationInfo&&(e.latitudeFieldName=b.locationInfo.latitudeFieldName,e.longitudeFieldName=b.locationInfo.longitudeFieldName),g.ignorePopups||(e.infoTemplate=new C(b.popupInfo?b.popupInfo:na.generateDefaultPopupInfo(b))),v=new X(b.url,e);else if("VectorTileLayer"===b.layerType&&b.styleUrl)v=new ab(b.styleUrl,{id:b.id,minScale:b.minScale,maxScale:b.maxScale,
opacity:b.opacity,visible:b.visibility});else if(b.layerDefinition&&!b.url)e=m.fromJson(m.toJson(b)),delete e.id,delete e.opacity,delete e.visibility,v=new J(e,{id:b.id,opacity:b.opacity,visible:b.visibility,outFields:["*"],autoGeneralize:!0}),!g.ignorePopups&&e.popupInfo&&v.setInfoTemplate(new p(e.popupInfo)),Ea(v);else if("BingMapsAerial"===b.type||"BingMapsRoad"===b.type||"BingMapsHybrid"===b.type)g.bingMapsKey?(e=Pa.MAP_STYLE_AERIAL_WITH_LABELS,"BingMapsAerial"===b.type?e=Pa.MAP_STYLE_AERIAL:
"BingMapsRoad"===b.type&&(e=Pa.MAP_STYLE_ROAD),v=new Pa({bingMapsKey:g.bingMapsKey,mapStyle:e,opacity:b.opacity,id:b.id}),q.connect(v,"onError",l.hitch(this,function(a){a.errors=a.errors||[];a.errors.push({message:"This application does not have a valid Bing Key for the Bing layer that is included in this map. [type:"+a.type+"]"})},b))):(b.errors=b.errors||[],b.errors.push({message:"This application does not provide a Bing Key for the Bing layer that is included in this map. [type:"+b.type+"]"}));
else if(b.resourceInfo&&b.resourceInfo.mapName)v=!0===b.resourceInfo.singleFusedMapCache&&(b.baseMapLayer||ka(b,c,e)&&ta(b,t,u))?va(b,p,g):ma(b,p,g);else if(b.resourceInfo&&b.resourceInfo.pixelSizeX)v=!0===b.resourceInfo.singleFusedMapCache&&(b.baseMapLayer||ka(b,c,e)&&ta(b,t,u))?va(b,p,g):sa(b,p,g);else if(b.resourceInfo&&"Feature Layer"===b.resourceInfo.type){b.capabilities&&(b.resourceInfo.capabilities=b.capabilities);var E;!1===g.editable?E=!1:g.privileges&&-1===d.indexOf(g.privileges,"features:user:edit")&&
a.id&&a.id.findCredential(b.url)&&(E=!1);v=new J(ea(b.url),{resourceInfo:b.resourceInfo,opacity:b.opacity,visible:b.visibility,id:b.id,mode:b.mode===J.MODE_SELECTION?J.MODE_SELECTION:J.MODE_AUTO,editable:E,outFields:["*"],autoGeneralize:!0,refreshInterval:b.refreshInterval});!g.ignorePopups&&b.popupInfo&&v.setInfoTemplate(new p(b.popupInfo));b.layerDefinition&&(b.layerDefinition.drawingInfo&&b.layerDefinition.drawingInfo.renderer&&(e=B.fromJson(b.layerDefinition.drawingInfo.renderer),e.isMaxInclusive=
!0,v.setRenderer(e)),b.layerDefinition.drawingInfo&&b.layerDefinition.drawingInfo.labelingInfo&&(e=d.map(b.layerDefinition.drawingInfo.labelingInfo,function(a){return new xb(a)}),v.setLabelingInfo(e)),b.layerDefinition.definitionExpression&&v.setDefinitionExpression(b.layerDefinition.definitionExpression),n.isDefined(b.layerDefinition.minScale)&&v.setMinScale(b.layerDefinition.minScale),n.isDefined(b.layerDefinition.maxScale)&&v.setMaxScale(b.layerDefinition.maxScale));Ea(v)}else b.resourceInfo&&
b.resourceInfo.streamUrls&&(e={resourceInfo:b.resourceInfo,opacity:b.opacity,visible:b.visibility,id:b.id},b.layerDefinition&&(D=b.layerDefinition.drawingInfo,b.layerDefinition.definitionGeometry&&(w=w||{},w.geometry=b.layerDefinition.definitionGeometry),n.isDefined(b.layerDefinition.definitionExpression)&&(w=w||{},w.where=b.layerDefinition.definitionExpression),n.isDefined(b.layerDefinition.maximumTrackPoints)&&(e.maximumTrackPoints=b.layerDefinition.maximumTrackPoints)),w&&(e.filter=w),b.purgeOptions&&
(e.purgeOptions=b.purgeOptions),v=new lb(ea(b.url),e),D&&D.renderer&&(e=D.renderer,v.setRenderer(B.fromJson(e))),!g.ignorePopups&&b.popupInfo&&v.setInfoTemplate(new p(b.popupInfo)),b.layerDefinition&&(n.isDefined(b.layerDefinition.minScale)&&v.setMinScale(b.layerDefinition.minScale),n.isDefined(b.layerDefinition.maxScale)&&v.setMaxScale(b.layerDefinition.maxScale)),h.once(v,"error",function(a){b.errors.push({message:"Error loading stream layer. Check websocket url"})}));v&&(v.arcgisProps={title:b.title},
b.baseMapLayer&&(b.isReference?(v.attr("data-reference",!0),v._basemapGalleryLayerType="reference"):v._basemapGalleryLayerType="basemap"));return v}function qa(a,b,c,f,g){d.forEach(a,function(n){n.layerObject=ua(n,a,b,c,f,g)});var n=d.filter(a,function(a){return!a.isReference}),e=d.filter(a,function(a){return!!a.isReference});return a=n.concat(e)}function da(a){var b=null;a=a[0];a.url&&!a.type?a.resourceInfo.spatialReference&&(b=new f,a.resourceInfo.spatialReference.wkid&&(b.wkid=a.resourceInfo.spatialReference.wkid),
a.resourceInfo.spatialReference.wkt&&(b.wkt=a.resourceInfo.spatialReference.wkt)):a.type&&(-1<a.type.indexOf("BingMaps")||"OpenStreetMap"==a.type?b=new f({wkid:102100}):"WMS"==a.type&&(b=new f({wkid:a.spatialReferences[0]})));return b}function Aa(a,b,c,f,g,n,e,t){d.forEach(b,function(b){b.url&&!b.type&&(b.resourceInfo=a[b.deferredsPos][1],delete b.deferredsPos)});n=n||da(b);b=qa(b,c,n,e,t);g.callback(b);return g}function Ea(a){!window.CanvasRenderingContext2D&&a.renderer&&"esri.renderer.HeatmapRenderer"===
a.renderer.declaredClass&&a.setRenderer(B.fromJson({type:"simple",symbol:{color:[77,77,77,255],size:6,angle:0,xoffset:0,yoffset:0,type:"esriSMS",style:"esriSMSCircle",outline:{color:[255,255,255,255],width:.75,type:"esriSLS",style:"esriSLSSolid"}}}))}function za(a,b){var c=ea(a);return t({url:c,content:{f:"json"},callbackParamName:"callback",error:function(a,f){a.message=a.message?a.message+(" [url:"+c+"]"):"[url:"+c+"]";b.push(a);g.defaults.io.errorHandler(a,f)}})}function ra(a){var b=ha.arcgisUrl+
"/"+a.itemId+"/data";return t({url:b,content:{f:"json"},callbackParamName:"callback",error:function(c,f){c.message=c.message?c.message+(" [url:"+b+"]"):"[url:"+b+"]";a.errors=a.errors||[];a.errors.push(c);g.defaults.io.errorHandler(c,f)}})}function oa(a,b,c){var f=new k;if(!(c.featureCollection&&c.featureCollection.layers||c.layers))return console.log("Invalid Feature Collection item data [item id: "+a.itemId+"]: ",c),a.errors=a.errors||[],a.errors.push({message:"Invalid Feature Collection item data. [item id: "+
a.itemId+"]"}),f.errback(),f;c.layers&&(c.featureCollection={layers:c.layers},delete c.layers,n.isDefined(c.showLegend)&&(c.featureCollection.showLegend=c.showLegend,delete c.showLegend));Fa(a,c.featureCollection,b).then(function(b){c.featureCollection=b;a.featureCollection&&a.featureCollection.layers?d.forEach(c.featureCollection.layers,function(b,c){var f=a.featureCollection.layers[c];f.popupInfo||f.layerDefinition?f.layerDefinition?(n.isDefined(f.layerDefinition.minScale)&&n.isDefined(f.layerDefinition.maxScale)&&
(f.layerDefinition.minScale!==b.layerDefinition.minScale||f.layerDefinition.maxScale!==b.layerDefinition.maxScale)&&(delete b.layerDefinition.minScale,delete b.layerDefinition.maxScale),f.layerDefinition.drawingInfo&&m.toJson(f.layerDefinition.drawingInfo)!==m.toJson(b.layerDefinition.drawingInfo)&&delete b.layerDefinition.drawingInfo,f.layerDefinition.showLegend!==b.layerDefinition.showLegend&&delete b.layerDefinition.showLegend,f.layerDefinition=l.mixin(f.layerDefinition,b.layerDefinition)):f.layerDefinition=
b.layerDefinition:(f.popupInfo=b.popupInfo,f.layerDefinition=b.layerDefinition);f.featureSet=b.featureSet;f.nextObjectId=b.nextObjectId}):(a.featureCollection=a.featureCollection||{},a.featureCollection=l.mixin(a.featureCollection,c.featureCollection));f.callback(a)});return f}function Fa(a,b,c){var f=new k;r(["./csv"],function(g){var t=[];d.forEach(b.layers,function(a){a.featureSet&&a.featureSet.features&&a.featureSet.features.length&&a.featureSet.features[0].geometry&&a.featureSet.features[0].geometry.spatialReference&&
(a.deferredsPos=t.length,t.push(g.projectFeatureCollection(a,c,a.featureSet.features[0].geometry.spatialReference)))});(new e(t)).addCallback(function(){d.forEach(b.layers,function(b){n.isDefined(b.deferredsPos)&&(t[b.deferredsPos].results&&t[b.deferredsPos].results.length?b=t[b.deferredsPos].results[0]:(console.log("Errors projecting feature collection. ["+a.title+" - "+b.layerDefinition.name+"]"),b.errors=b.errors||[],b.errors.push({message:"Errors projecting feature collection. ["+a.title+" - "+
b.layerDefinition.name+"]"})),delete b.deferredsPos)});f.callback(b)})});return f}function Ma(a,b,c,f,g){var n=new k,t=new k,u=[],v;d.forEach(a.operationalLayers,function(a){a.itemId&&"Feature Collection"==a.type&&u.push(ra(a).then(l.hitch(null,oa,a,c)))});0===u.length?Ja(a,b,c,f,t,g):(v=new e(u),v.addCallback(function(n){Ja(a,b,c,f,t,g)}));t.then(function(a){u=[];d.forEach(a,function(a){var b;a=a.layerObject;a instanceof J&&!a.loaded&&!a.loadError?(b=new k,h.once(a,"load, error",function(){b.callback(a)}),
u.push(b)):a&&"esri.layers.WFSLayer"===a.declaredClass&&!a.loadError&&(b=new k,h.once(a,"fromJsonComplete, error",function(c){b.callback(a)}),u.push(b))});if(u.length){var b=new k;v=new e(u);v.addCallback(function(){b.callback(a)});return b.promise}return a}).then(function(a){var b=[];d.forEach(a,function(a){var c=a.layerObject;c instanceof J?c.loaded&&c.labelingInfo&&(a.showLabels||c._collection)&&b.push(c):c&&"esri.layers.WFSLayer"===c.declaredClass&&c.loaded&&c.labelingInfo&&b.push(c)});b.length?
r(["../layers/LabelLayer"],function(c){var f=new c;d.forEach(b,function(a){f.addFeatureLayer(a)});a.push({layerObject:f});n.callback(a)}):n.callback(a)});return n}function Ja(a,b,c,f,g,n){var t=[],h=[],u=[];d.forEach(a.operationalLayers,function(a,b){if(a.featureCollection&&a.featureCollection.layers){var c=a.featureCollection.layers.length;d.forEach(a.featureCollection.layers,function(f,g){var n=!0;a.visibleLayers&&-1==d.indexOf(a.visibleLayers,g)&&(n=!1);f.visibility=a.visibility&&n;f.opacity=a.opacity;
f.id=(a.id||"operational"+b)+"_"+g;a.title&&(f.title=1!==c&&f.layerDefinition.name&&a.title!==f.layerDefinition.name?a.title+" - "+f.layerDefinition.name:a.title);u.push(f)},this)}else u.push(a)});d.forEach(a.baseMap.baseMapLayers,function(a,b){a.baseMapLayer=!0;a.id=a.id||"base"+b;t.push(a)});d.forEach(u,function(a,b){a.id=a.id||"operational"+b;t.push(a)});d.forEach(t,function(a){a.url&&!a.type&&(a.deferredsPos=h.length,a.errors=a.errors||[],h.push(za(a.url,a.errors)))});0===h.length?(c=c||da(t),
t=qa(t,b,c,f,n),g.callback(t)):(new e(h)).addCallback(function(a){Aa(a,t,b,h,g,c,f,n)});return g}function Ga(a,b,c,f){var g=a.minScale,n=a.maxScale;if(10.1>=c.version&&b)for(a=b.length-1;0<=a;a--){if(b[a].id==f)if(0==g&&0<b[a].minScale?g=b[a].minScale:0<g&&0==b[a].minScale?g=c.minScale:0<g&&0<b[a].minScale&&(g=Math.min(g,b[a].minScale)),n=Math.max(c.maxScale||0,b[a].maxScale||0),c.setScaleRange(g,n),-1<b[a].parentLayerId)f=b[a].parentLayerId;else break}else 10.1<c.version&&(d.forEach(a.layerInfos,
function(a){a.id==f&&(0==g&&0<a.minScale?g=a.minScale:0<g&&0==a.minScale||0<g&&0<a.minScale&&(g=Math.min(g,a.minScale)),n=Math.max(n||0,a.maxScale||0))}),c.setScaleRange(g,n))}function Ca(a,b,c,f){var g=a.url,e=a.__popupIds,t=a.__popupUrls,h=a.__popupWhereClauses,u=a.__popupMinScales,v=a.__popupMaxScales,x=a.__resourceInfo,w=[];d.forEach(a.__popups,function(f,p){if(f){var m,k=[];d.forEach(f.fieldInfos,function(a){"shape"!==a.fieldName.toLowerCase()&&k.push(a.fieldName)});if(a.dynamicLayerInfos&&0<
a.dynamicLayerInfos.length){var l=d.filter(a.dynamicLayerInfos,function(a){return e[p]==a.id})[0].source;m=new J(g+"/dynamicLayer",{id:a.id+"_"+e[p],source:l,outFields:k,mode:J.MODE_SELECTION,infoTemplate:f&&new c(f),drawMode:!1,visible:a.visible,autoGeneralize:!0});var z=function(c,f){0<h[c].length&&f.setDefinitionExpression(h[c]);if(n.isDefined(u[c])||n.isDefined(v[c]))if(n.isDefined(a.minScale)||n.isDefined(a.maxScale)){var g=a.minScale,t=a.maxScale;0==g&&0<u[c]?g=u[c]:0<g&&0==u[c]||0<g&&0<u[c]&&
(g=Math.min(g,u[c]));t=Math.max(t||0,v[c]||0);f.setScaleRange(g,t)}else f.setScaleRange(u[c],v[c]);else Ga(a,b||x.layers,f,e[c])};m.loaded?z(p,m):q.connect(m,"onLoad",function(a){z(p,m)})}else{var A=null,y=g+"/"+e[p];if(t[p].length)y=t[p];else if(b)for(l=0;l<b.length;l++)if(b[l].id===e[p]){A=b[l];break}m=new J(ea(y),{id:a.id+"_"+e[p],outFields:k,mode:J.MODE_SELECTION,infoTemplate:f&&new c(f),drawMode:!1,visible:a.visible,resourceInfo:A,autoGeneralize:!0});m.loaded?(0<h[p].length&&m.setDefinitionExpression(h[p]),
Ga(a,b||x.layers,m,e[p])):q.connect(m,"onLoad",function(c){0<h[p].length&&m.setDefinitionExpression(h[p]);Ga(a,b||x.layers,c,e[p])})}w.push(m)}});0<w.length&&(q.connect(a,"onVisibilityChange",l.hitch(this,function(a,b){d.forEach(a,function(a){b?a.show():a.hide()})},w)),q.connect(f,"onLayerRemove",l.hitch(this,function(a,b,c){a.id===c.id&&d.forEach(b,function(a){f.removeLayer(a)})},a,w)));delete a.__popups;delete a.__popupIds;delete a.__popupUrls;delete a.__popupWhereClauses;delete a.__popupMinScales;
delete a.__popupMaxScales;delete a.__resourceInfo;return w}function Ta(a){return t({url:ea(a.url+"/layers"),content:{f:"json"},callbackParamName:"callback",error:function(){}})}function $a(a,b,c){var f=[];d.forEach(a,function(a){var b=a.__popups;b&&1<b.length&&10<=a.version&&(a.__deferredsPos=f.length,f.push(Ta(a)))});var g=[];0<f.length?(new e(f)).addCallback(function(f){d.forEach(a,function(a){a.__popups&&0<a.__popups.length&&(a.__deferredsPos||0===a.__deferredsPos?(g=g.concat(Ca(a,f[a.__deferredsPos][1].layers,
c,b)),delete a.__deferredsPos):g=g.concat(Ca(a,null,c,b)))});b.addLayers(g)}):(d.forEach(a,function(a){a.__popups&&0<a.__popups.length&&(g=g.concat(Ca(a,null,c,b)))}),b.addLayers(g))}function gb(a){d.forEach(a,function(a){var b=a.layer;b.toJson&&(a=b.toJson(),a.featureSet&&b.name&&-1<b.name.indexOf("Text")&&d.forEach(a.featureSet.features,function(a,c){if(a.attributes.TEXT){var f=b.graphics[c];f.symbol.setText(a.attributes.TEXT);a.symbol.horizontalAlignment&&(f.symbol.align=a.symbol.horizontalAlignment);
f.setSymbol(f.symbol);f.setAttributes(a.attributes)}},this))})}function Ua(a){var b=6;d.forEach(a,function(a){if(a=a.renderer)"esri.renderer.SimpleRenderer"===a.declaredClass?((a=a.symbol)&&a.xoffset&&(b=Math.max(b,Math.abs(a.xoffset))),a&&a.yoffset&&(b=Math.max(b,Math.abs(a.yoffset)))):"esri.renderer.UniqueValueRenderer"!==a.declaredClass&&"esri.renderer.ClassBreaksRenderer"!==a.declaredClass||d.forEach(a.infos,function(a){(a=a.symbol)&&a.xoffset&&(b=Math.max(b,Math.abs(a.xoffset)));a&&a.yoffset&&
(b=Math.max(b,Math.abs(a.yoffset)))})});return b}function Ha(a){var b=this,c=b.infoWindow,f=a.graphic;if(b.loaded){c.hide();c.clearFeatures();var g=[];d.forEach(b.graphicsLayerIds,function(a){(a=b.getLayer(a))&&a instanceof J&&a.loaded&&a.visible&&(a.clearSelection(),a.infoTemplate&&!a.suspended&&g.push(a))});d.forEach(b.layerIds,function(a){(a=b.getLayer(a))&&-1!==a.declaredClass.indexOf("ArcGISImageServiceLayer")&&a.loaded&&a.visible&&a.infoTemplate&&g.push(a)});f=f&&f.getInfoTemplate()?f:null;
if(g.length||f){var n=Ua(g),e=a.screenPoint,t=b.toMap(new w(e.x-n,e.y+n)),n=b.toMap(new w(e.x+n,e.y-n)),t=new z(t.x,t.y,n.x,n.y,b.spatialReference),h=new D;h.geometry=t;h.timeExtent=b.timeExtent;var u=!0,t=d.map(g,function(b){var c;-1!==b.declaredClass.indexOf("ArcGISImageServiceLayer")?(h.geometry=a.mapPoint,u=!1,c=b.queryVisibleRasters(h,{rasterAttributeTableFieldPrefix:"Raster.",returnDomainValues:!0}),c.addCallback(function(){return b.getVisibleRasters()})):(c=b.selectFeatures(h),c.addCallback(function(){return b.getSelectedFeatures()}));
return c});f&&(n=new k,n.callback([f]),t.splice(0,0,n));if(!d.some(t,function(a){return-1===a.fired})){var v=f?1:0;d.forEach(g,function(a){v=-1!==a.declaredClass.indexOf("ArcGISImageServiceLayer")?v+a.getVisibleRasters().length:v+a.getSelectedFeatures().length});if(!v)return}c.setFeatures(t);c.show(a.mapPoint,{closestFirst:u})}}}function T(a,b){var f=b.mapOptions||{},g;f.infoWindow||(g=new E({visibleWhenEmpty:!1},c.create("div")),f.infoWindow=g);n.isDefined(f.showInfoWindowOnClick)||b.usePopupManager||
(f.showInfoWindowOnClick=!1);f=new v(a,f);q.connect(f,"onLayersAddResult",gb);return f}function xa(a,b,c,f,g,n){var e,t,h,u;f.map?(e=f.map,t=f.clickEventHandle,h=f.clickEventListener,u=f.errors):(e=T(f,g),g.ignorePopups||g.disableClickBehavior||g.usePopupManager||(t=q.connect(e,"onClick",Ha),h=Ha));e.addLayers(a);g.ignorePopups||g.usePopupManager||$a(a,e,g._clazz);var v=u||[];d.forEach(b,function(a){a.errors&&(v=v.concat(a.errors))},this);e.loaded?n.callback({map:e,itemInfo:c,errors:v,clickEventHandle:t,
clickEventListener:h}):q.connect(e,"onLoad",function(){n.callback({map:e,itemInfo:c,errors:v,clickEventHandle:t,clickEventListener:h})})}function Ba(a,b,c,f,g){var n=[];d.forEach(g,function(a){l.isArray(a.layerObject)?d.forEach(a.layerObject,function(a){n.push(a)}):n.push(a.layerObject)});if("BingMapsAerial"===g[0].type||"BingMapsRoad"===g[0].type||"BingMapsHybrid"===g[0].type)var e=setInterval(function(){if(g[0].layerObject&&g[0].layerObject.loaded)clearInterval(e),fa(a,b,c,f,g,n);else if(g[0].errors){clearInterval(e);
var t="";g[0].errors&&g[0].errors.length&&(t=" ("+g[0].errors[0].message+")");f.errback(Error(N.arcgis.utils.baseLayerError+t))}},10);else if(!n[0]&&g[0].baseMapLayer){var t="";g[0].errors&&g[0].errors.length&&(t=" ("+g[0].errors[0].message+")");f.errback(Error(N.arcgis.utils.baseLayerError+t))}else fa(a,b,c,f,g,n)}function fa(a,b,c,e,t,h){try{var v=c.mapOptions||{};c.mapOptions=v;var x=a.item,w=a.itemData;!v.backgroundColor&&w.background&&w.background.color&&null!=w.background.color[0]&&(v.backgroundColor=
u.toDojoColor(w.background.color));h=d.filter(h,n.isDefined);if(x)if(x.extent&&x.extent.length)if(v.extent)xa(h,t,a,b,c,e);else{var p=new z(x.extent[0][0],x.extent[0][1],x.extent[1][0],x.extent[1][1],new f({wkid:4326})),m=h[0].spatialReference;4326===m.wkid?(v.extent=p,xa(h,t,a,b,c,e)):102100===m.wkid||102113===m.wkid||3857===m.wkid?(p.xmin=Math.max(p.xmin,-180),p.xmax=Math.min(p.xmax,180),p.ymin=Math.max(p.ymin,-89.99),p.ymax=Math.min(p.ymax,89.99),v.extent=A.geographicToWebMercator(p),xa(h,t,a,
b,c,e)):c.geometryServiceURL||g.defaults.geometryService?(c.geometryServiceURL?new F(c.geometryServiceURL):g.defaults.geometryService).project([p],m,function(f){f=f[0];v.extent=v.extent||f;xa(h,t,a,b,c,e)},function(){xa(h,t,a,b,c,e)}):e.errback(Error(N.arcgis.utils.geometryServiceError))}else xa(h,t,a,b,c,e);else xa(h,t,a,b,c,e)}catch(qb){e.errback(qb)}}function Xa(a){var b=[];d.forEach(a.operationalLayers,function(a){a.featureCollection?b.push({featureCollection:a.featureCollection,visibility:a.visibility,
title:a.title}):a.layerObject&&b.push({layer:a.layerObject,visibility:a.visibility,title:a.title})});return b}function Na(a){var b=[],c=a.baseMap.baseMapLayers;a.operationalLayers&&(c=c.concat(a.operationalLayers));d.forEach(c,function(a){var c={};if(a.featureCollection&&"CSV"!==a.type)!0===a.featureCollection.showLegend&&d.forEach(a.featureCollection.layers,function(f){if(!1!==f.showLegend){var g=f.layerObject.renderer;c={layer:f.layerObject,title:a.title,defaultSymbol:g&&g.defaultSymbol&&g.defaultLabel?
!0:!1};1<a.featureCollection.layers.length&&(c.title+=" - "+f.layerDefinition.name);b.push(c)}});else if(a.baseMapLayer&&!0===a.showLegend&&a.layerObject||!a.baseMapLayer&&!1!==a.showLegend&&a.layerObject&&!(a.layerObject instanceof J&&a.layerObject.mode===J.MODE_SELECTION)){var f=a.layerObject.renderer,g=a.layerObject.declaredClass,f=!f||f&&f.defaultSymbol&&f.defaultLabel?!0:!1;if(10.1>a.layerObject.version&&("esri.layers.ArcGISDynamicMapServiceLayer"===g||"esri.layers.ArcGISTiledMapServiceLayer"===
g)||"esri.layers.ArcGISImageServiceLayer"===g)f=!0;c={layer:a.layerObject,title:a.title,defaultSymbol:f};a.layers&&(g=d.map(d.filter(a.layers,function(a){return!1===a.showLegend}),function(a){return a.id}),g.length&&(c.hideLayers=g));b.push(c)}});return b}function aa(a,b){function c(a,b){d.forEach(a,function(a,c){switch(a){case "../layers/ArcGISDynamicMapServiceLayer":I=b[c];break;case "../layers/ArcGISImageServiceLayer":ga=b[c];break;case "../layers/ArcGISImageServiceVectorLayer":ja=b[c];break;case "./csv":na=
b[c];break;case "../layers/CSVLayer":X=b[c];break;case "../layers/DynamicLayerInfo":Z=b[c];break;case "../layers/GeoRSSLayer":P=b[c];break;case "../layers/ImageParameters":Va=b[c];break;case "../layers/ImageServiceParameters":rb=b[c];break;case "../layers/KMLLayer":wb=b[c];break;case "../layers/LabelClass":xb=b[c];break;case "../layers/LayerDrawingOptions":Wa=b[c];break;case "../layers/MosaicRule":tb=b[c];break;case "../layers/OpenStreetMapLayer":jb=b[c];break;case "../layers/RasterFunction":sb=b[c];
break;case "../layers/StreamLayer":lb=b[c];break;case "../layers/TileInfo":kb=b[c];break;case "../layers/VectorTileLayer":ab=b[c];break;case "../virtualearth/VETiledLayer":Pa=b[c];break;case "../layers/WebTiledLayer":ob=b[c];break;case "../layers/WFSLayer":ub=b[c];break;case "../layers/WMSLayer":vb=b[c];break;case "../layers/WMSLayerInfo":Qa=b[c]}})}var f=new k,g=a.itemData,n=[];g.baseMap&&g.baseMap.baseMapLayers&&(n=n.concat(g.baseMap.baseMapLayers));g.operationalLayers&&(n=n.concat(g.operationalLayers));
for(var g=d.map(n,function(a){return a&&a.layerType}),e=[],t=[],n=!1,h=0;h<g.length;h++){switch(g[h]){case "ArcGISFeatureLayer":-1===d.indexOf(e,"../layers/LabelClass")&&e.push("../layers/LabelClass");break;case "ArcGISImageServiceLayer":case "ArcGISTiledImageServiceLayer":-1===d.indexOf(e,"../layers/ArcGISImageServiceLayer")&&(e.push("../layers/ArcGISImageServiceLayer"),t.push("../layers/ImageServiceParameters"),t.push("../layers/MosaicRule"),t.push("../layers/RasterFunction"));break;case "ArcGISImageServiceVectorLayer":-1===
d.indexOf(e,"../layers/ArcGISImageServiceVectorLayer")&&(e.push("../layers/ArcGISImageServiceVectorLayer"),t.push("../layers/ImageServiceParameters"),t.push("../layers/MosaicRule"),t.push("../layers/RasterFunction"));break;case "ArcGISMapServiceLayer":case "ArcGISTiledMapServiceLayer":-1===d.indexOf(e,"../layers/ArcGISDynamicMapServiceLayer")&&(e.push("../layers/ArcGISDynamicMapServiceLayer"),t.push("../layers/DynamicLayerInfo"),t.push("../layers/ImageParameters"),t.push("../layers/LayerDrawingOptions"));
break;case "ArcGISStreamLayer":-1===d.indexOf(e,"../layers/StreamLayer")&&e.push("../layers/StreamLayer");break;case "BingMapsAerial":case "BingMapsHybrid":case "BingMapsRoad":-1===d.indexOf(e,"../virtualearth/VETiledLayer")&&e.push("../virtualearth/VETiledLayer");break;case "CSV":-1===d.indexOf(e,"../layers/CSVLayer")&&(e.push("../layers/CSVLayer"),t.push("./csv"));break;case "GeoRSS":-1===d.indexOf(e,"../layers/GeoRSSLayer")&&e.push("../layers/GeoRSSLayer");break;case "KML":-1===d.indexOf(e,"../layers/KMLLayer")&&
e.push("../layers/KMLLayer");break;case "OpenStreetMap":-1===d.indexOf(e,"../layers/OpenStreetMapLayer")&&e.push("../layers/OpenStreetMapLayer");break;case "VectorTileLayer":-1===d.indexOf(e,"../layers/VectorTileLayer")&&e.push("../layers/VectorTileLayer");break;case "WebTiledLayer":-1===d.indexOf(e,"../layers/WebTiledLayer")&&(e.push("../layers/WebTiledLayer"),t.push("../layers/TileInfo"));break;case "WFS":-1===d.indexOf(e,"../layers/WFSLayer")&&e.push("../layers/WFSLayer");break;case "WMS":-1===
d.indexOf(e,"../layers/WMSLayer")&&(e.push("../layers/WMSLayer"),t.push("../layers/WMSLayerInfo"));break;default:n=!0}if(n)break}n&&(e=bb,t=Ob);e.length?r(e,function(){c(e,arguments);t.length?r(t,function(){c(t,arguments);f.resolve()}):f.resolve()}):f.resolve();return f}function cb(a,b,c,f){var g=f.itemData;g.baseMap&&g.baseMap.baseMapLayers&&g.baseMap.baseMapLayers.length&&(g.baseMap.baseMapLayers[0].firstLayer=!0);var n=b.layerMixins,e=n&&n.length;if(e){var t=function(a){for(var b=0;b<e;b++){var c=
n[b];if(c.mixin)if(c.hasOwnProperty("id")){if(a.id===c.id){l.mixin(a,c.mixin);break}}else if(a.url===c.url){l.mixin(a,c.mixin);break}}};d.forEach(g.baseMap&&g.baseMap.baseMapLayers,t);d.forEach(g.operationalLayers,t)}aa(f,b).then(function(){return O(f,b)}).then(function(){return ba(f,b)}).then(function(b){var f=b[0],g=b[1];if(f.itemData.operationalLayers&&0!==f.itemData.operationalLayers.length){var n=new k,e=f.itemData.baseMap.baseMapLayers.slice(),t=d.filter(f.itemData.baseMap.baseMapLayers,function(a){return!a.isReference});
b={item:f.item,itemData:{baseMap:{baseMapLayers:t}}};f.itemData.baseMap.baseMapLayers=d.filter(f.itemData.baseMap.baseMapLayers,function(a){return a.isReference});R(b,g).addCallback(function(b){Ma(b.itemData,g).addCallback(l.hitch(null,Ba,b,a,g,n))});n.then(function(a){R(f,g).addCallback(function(b){Ma(b.itemData,g,a.map.spatialReference,t,a.map).addCallback(function(f){b.itemData.baseMap.baseMapLayers=e;Ba(b,a,g,c,f)})})},l.hitch(c,c.errback))}else R(f,g).addCallback(function(b){Ma(b.itemData,g).addCallback(l.hitch(null,
Ba,b,a,g,c))})})}function S(a,b){"undefined"===typeof b&&(b=!0);ha._arcgisUrl&&0<ha._arcgisUrl.length&&(ha.arcgisUrl=ha._arcgisUrl);var c=ha.arcgisUrl+"/"+a,f={},g=new k;t({url:c,content:{f:"json"},callbackParamName:"callback",load:function(a){f.item=a;b?t({url:c+"/data",content:{f:"json"},callbackParamName:"callback",load:function(a){f.itemData=a;g.callback(f)},error:function(a){g.errback(a)}}):g.callback(f)},error:function(a){g.errback(a)}});return g}var ha,I,ga,ja,na,X,Z,P,Va,rb,wb,xb,Wa,tb,jb,
sb,lb,kb,ab,Pa,ob,ub,vb,Qa,bb="../layers/ArcGISDynamicMapServiceLayer ../layers/ArcGISImageServiceLayer ../layers/ArcGISImageServiceVectorLayer ../layers/CSVLayer ../layers/GeoRSSLayer ../layers/KMLLayer ../layers/LabelClass ../layers/OpenStreetMapLayer ../layers/StreamLayer ../layers/VectorTileLayer ../virtualearth/VETiledLayer ../layers/WebTiledLayer ../layers/WFSLayer ../layers/WMSLayer".split(" "),Ob="./csv ../layers/DynamicLayerInfo ../layers/ImageParameters ../layers/ImageServiceParameters ../layers/LayerDrawingOptions ../layers/MosaicRule ../layers/RasterFunction ../layers/TileInfo ../layers/WMSLayerInfo".split(" ");
ha={arcgisUrl:x.getProtocolForWebResource()+"//www.arcgis.com/sharing/rest/content/items",getItem:S,createMap:function(a,b,c){var f=new k;c=c||{};var g=c.infoTemplateClass;c._clazz=g&&(l.isObject(g)?g:l.getObject(g))||C;l.isString(a)?S(a).addCallback(l.hitch(null,cb,b,c,f)).addErrback(l.hitch(f,f.errback)):cb(b,c,f,a);return f},getLayerList:function(a){return a&&a.itemInfo&&a.itemInfo.itemData?Xa(a.itemInfo.itemData):[]},getLegendLayers:function(a){return a&&a.itemInfo&&a.itemInfo.itemData?Na(a.itemInfo.itemData):
[]},_arcgisUrl:null,_getItemProps:R,_getItemData:M,_getBingKey:L,_portalUrlResponse:Q,_portalUrlFailure:U,_processFSItemProperties:K,_processSSItemProperties:W,_getLayers:Ma,_preBuildLayerObjects:Aa,_buildLayerObjects:qa,_preCreateMap:Ba,_getMapSR:da,_createMap:xa,_addSelectionLayers:$a,_createSelectionFeatureLayers:Ca,_getServiceInfo:za,_getFeatureCollectionItem:ra,_mergeFeatureCollectionItem:oa,_projectFeatureCollection:Fa,_getLayersInfo:Ta,_initLayer:ua,_loadAsCached:va,_loadAsDynamic:ma,_processPopups:Y,
_onLayersAddResult:gb,_sameSpatialReferenceAsBasemap:ka,_sameTilingSchemeAsBasemap:ta,_showPopup:Ha,_calculateClickTolerance:Ua,_getVisibleFeatureLayers:la,_updateLayerScaleInfo:Ga,_checkUrl:ea,_isHostedService:ca,_isAgolService:H,_getLegendLayers:Na};l.setObject("arcgis.utils",ha,a);return ha})},"dojo/_base/url":function(){define(["./kernel"],function(r){var l=/^(([^:/?#]+):)?(\/\/([^/?#]*))?([^?#]*)(\?([^#]*))?(#(.*))?$/,d=/^((([^\[:]+):)?([^@]+)@)?(\[([^\]]+)\]|([^\[:]*))(:([0-9]+))?$/,q=function(){for(var k=
arguments,m=[k[0]],p=1;p<k.length;p++)if(k[p]){var h=new q(k[p]+""),m=new q(m[0]+"");if(""==h.path&&!h.scheme&&!h.authority&&!h.query)null!=h.fragment&&(m.fragment=h.fragment),h=m;else if(!h.scheme&&(h.scheme=m.scheme,!h.authority&&(h.authority=m.authority,"/"!=h.path.charAt(0)))){for(var m=(m.path.substring(0,m.path.lastIndexOf("/")+1)+h.path).split("/"),e=0;e<m.length;e++)"."==m[e]?e==m.length-1?m[e]="":(m.splice(e,1),e--):0<e&&(1!=e||""!=m[0])&&".."==m[e]&&".."!=m[e-1]&&(e==m.length-1?(m.splice(e,
1),m[e-1]=""):(m.splice(e-1,2),e-=2));h.path=m.join("/")}m=[];h.scheme&&m.push(h.scheme,":");h.authority&&m.push("//",h.authority);m.push(h.path);h.query&&m.push("?",h.query);h.fragment&&m.push("#",h.fragment)}this.uri=m.join("");k=this.uri.match(l);this.scheme=k[2]||(k[1]?"":null);this.authority=k[4]||(k[3]?"":null);this.path=k[5];this.query=k[7]||(k[6]?"":null);this.fragment=k[9]||(k[8]?"":null);null!=this.authority&&(k=this.authority.match(d),this.user=k[3]||null,this.password=k[4]||null,this.host=
k[6]||k[7],this.port=k[9]||null)};q.prototype.toString=function(){return this.uri};return r._Url=q})},"dojo/DeferredList":function(){define(["./_base/kernel","./_base/Deferred","./_base/array"],function(r,l,d){r.DeferredList=function(q,k,m,p,h){var e=[];l.call(this);var c=this;0!==q.length||k||this.resolve([0,[]]);var b=0;d.forEach(q,function(a,g){function h(a,t){e[g]=[a,t];b++;b===q.length&&c.resolve(e)}a.then(function(a){k?c.resolve([g,a]):h(!0,a)},function(a){m?c.reject(a):h(!1,a);if(p)return null;
throw a;})})};r.DeferredList.prototype=new l;r.DeferredList.prototype.gatherResults=function(l){l=new r.DeferredList(l,!1,!0,!1);l.addCallback(function(k){var m=[];d.forEach(k,function(d){m.push(d[1])});return m});return l};return r.DeferredList})},"esri/config":function(){define(["dojo/_base/config","dojo/topic","dojo/has","./kernel"],function(r,l,d,q){d=function(){return this}();q={defaults:{screenDPI:96,geometryService:null,kmlService:null,map:{width:400,height:400,layerNamePrefix:"layer",graphicsLayerNamePrefix:"graphicsLayer",
slider:{left:"30px",top:"30px",width:null,height:"200px"},sliderLabel:{tick:5,labels:null,style:"width:2em; font-family:Verdana; font-size:75%;"},sliderChangeImmediate:!0,zoomSymbol:{color:[0,0,0,64],outline:{color:[255,0,0,255],width:1.25,style:"esriSLSSolid"},style:"esriSFSSolid"},zoomDuration:500,zoomRate:25,panDuration:350,panRate:25,logoLink:"http://www.esri.com"},autoSpatialIndexing:d.Worker&&!1,io:{errorHandler:function(d,m){l.publish("esri.Error",[d])},proxyUrl:null,alwaysUseProxy:!1,useCors:"with-credentials",
corsEnabledServers:"server.arcgisonline.com services.arcgisonline.com www.arcgis.com js.arcgis.com jsdev.arcgis.com jsqa.arcgis.com tiles.arcgis.com tiles1.arcgis.com tiles2.arcgis.com tiles3.arcgis.com tiles4.arcgis.com basemaps.arcgis.com basemapsbeta.arcgis.com elevation3d.arcgis.com services.arcgis.com services1.arcgis.com services2.arcgis.com services3.arcgis.com services4.arcgis.com services5.arcgis.com services6.arcgis.com services7.arcgis.com static.arcgis.com utility.arcgis.com utility.arcgisonline.com geocode.arcgis.com geoenrich.arcgis.com qaext.arcgis.com staticqa.arcgis.com tilesqa.arcgis.com servicesqa.arcgis.com servicesqa1.arcgis.com servicesqa2.arcgis.com servicesqa3.arcgis.com geocodeqa.arcgis.com geoenrichqa.arcgis.com dev.arcgis.com devext.arcgis.com localvtiles.arcgis.com staticdev.arcgis.com tilesdevext.arcgis.com elevation3ddev.arcgis.com servicesdev.arcgis.com servicesdev1.arcgis.com servicesdev2.arcgis.com servicesdev3.arcgis.com geocodedev.arcgis.com geoenrichdev.arcgis.com basemapsdev.arcgis.com basemapsbetadev.arcgis.com".split(" "),
corsDetection:d.cordova?!1:!0,corsDetectionTimeout:15,corsStatus:{},webTierAuthServers:[],proxyRules:[],postLength:2E3,timeout:6E4,useWorkers:"on-request",maxRequestWorkers:5,httpsDomains:"arcgis.com arcgisonline.com esrikr.com premiumservices.blackbridge.com esripremium.accuweather.com gbm.digitalglobe.com firstlook.digitalglobe.com msi.digitalglobe.com".split(" ")},workers:{loaderConfig:{has:{},paths:{},map:{},packages:[]}}}};r.noGlobals||(d.esriConfig=q);return q})},"esri/Color":function(){define(["dojo/_base/declare",
"dojo/_base/Color","dojo/has","./kernel"],function(r,l,d,q){r=r([l],{declaredClass:"esri.Color"});r.toJsonColor=function(d){return d&&[d.r,d.g,d.b,1<d.a?d.a:Math.round(255*d.a)]};r.toDojoColor=function(d){return d&&new l([d[0],d[1],d[2],d[3]/255])};q="named blendColors fromRgb fromHex fromArray fromString".split(" ");for(d=0;d<q.length;d++)r[q[d]]=l[q[d]];return r})},"esri/request":function(){define("require dojo/_base/array dojo/_base/config dojo/_base/Deferred dojo/_base/lang dojo/_base/url dojo/_base/xhr dojo/io/script dojo/io/iframe dojo/dom-construct dojo/io-query ./kernel ./config ./sniff ./lang ./urlUtils ./deferredUtils".split(" "),
function(r,l,d,q,k,m,p,h,e,c,b,a,g,u,n,t,f){function v(a){a=new m(a);return(a.host+(a.port?":"+a.port:"")).toLowerCase()}function x(a){return this._xhr?this._xhr.getResponseHeader(a):null}function w(f,g,v,x){var w=!1,m=!1,z;n.isDefined(g)&&(k.isObject(g)?(w=!!g.useProxy,m=!!g.usePost,z=g.crossOrigin):w=!!g);f=k.mixin({},f);f._ssl&&(f.url=f.url.replace(/^http:/i,"https:"));10>u("ie")&&!J.test(f.url)&&(f.url=encodeURI(f.url));g=f.content;var A=f.url,y=v&&f.form,B=D;z=n.isDefined(z)?z:B.useCors;f.load=
function(a){var b;a&&(a.error?(b=k.mixin(Error(),a.error),b.log=!!d.isDebug):"error"===a.status&&(b=k.mixin(Error(),a),b.log=!!d.isDebug),b&&(f.failOk=!b.log,n.isDefined(b.httpCode)||(b.httpCode=b.code)));return b||a};f.error=function(a,b){b&&b.xhr&&b.xhr.abort();a instanceof Error||(a=k.mixin(Error(),a));a.log=!!d.isDebug;B.errorHandler(a,b);return a};f._token&&(f.content=f.content||{},f.content.token=f._token);var C=0,r;g&&A&&(r=b.objectToQuery(g),C=r.length+A.length+1,u("esri-url-encodes-apostrophe")&&
(C=r.replace(/'/g,"%27").length+A.length+1));f.timeout=n.isDefined(f.timeout)?f.timeout:B.timeout;f.handleAs=f.handleAs||"json";try{var F,M,N=z&&t.canUseXhr(f.url)&&!/https?:\/\/[^\/]+\/[^\/]+\/admin\/?(\/.*)?$/i.test(f.url),W=t.hasSameOrigin(f.url,window.location.href)||N,L=m||v||C>B.postLength?!0:!1,K=W||-1===f.handleAs.indexOf("json")||!f.callbackParamName||v?!1:!0,ka=t.getProxyRule(f.url)||B.alwaysUseProxy||w||(!K||L)&&!W?!0:!1;v&&!u("esri-file-upload")&&!ka&&N&&(ka=!0);if(ka)if(F=t.getProxyUrl(A,
z),M=F.path,F._xo&&(N=!0),!L&&M.length+1+C>B.postLength&&(L=!0),f.url=M+"?"+A,L)f.content=k.mixin(F.query||{},g);else{var ta=b.objectToQuery(k.mixin(F.query||{},g));ta&&(f.url+="?"+ta);f.content=null}if(K&&!L)return!n.isDefined(f.isAsync)&&4>u("ff")&&(f.isAsync=!0),h.get(E?E(f):f);var ua=f.headers;!N||ua&&ua.hasOwnProperty("X-Requested-With")||(ua=f.headers=ua||{},ua["X-Requested-With"]=null);if(v){var qa=f.callbackParamName||"callback.html",da=f.callbackElementName||"textarea",Aa,Ea,za,ra,oa=y.elements?
y.elements.length:0,Fa;if(g=f.content)for(Aa in g.token&&-1<A.toLowerCase().indexOf("/sharing/servers/")&&(A+=(-1===A.indexOf("?")?"?":"\x26")+"token\x3d"+g.token,f.url=ka?M+"?"+A:A,delete g.token),g)if(za=g[Aa],n.isDefined(za)){Ea=null;for(ra=0;ra<oa;ra++)if(Fa=y.elements[ra],Fa.name===Aa){Ea=Fa;break}Ea?Ea.value=za:x?y.append(Aa,za):y.appendChild(c.create("input",{type:"hidden",name:Aa,value:za}))}if(u("esri-file-upload"))l.forEach(y.elements,function(a){a.name===qa&&y.removeChild(a)}),f.contentType=
!1,f.postData=x?y:new FormData(y),delete f.form;else{y.enctype="multipart/form-data";9>u("ie")&&(y.encoding="multipart/form-data");y.method="post";l.some(y.elements,function(a){return a.name===qa})||y.appendChild(c.create("input",{type:"hidden",name:qa,value:da}));if(-1!==A.toLowerCase().indexOf("addattachment")||-1!==A.toLowerCase().indexOf("updateattachment"))A+=(-1===A.indexOf("?")?"?":"\x26")+qa+"\x3d"+da,f.url=ka?M+"?"+A:A;delete f.content}}if(N&&!f.hasOwnProperty("withCredentials")&&"with-credentials"===
D.useCors){x=ka?M:A;var Ma=t.canUseXhr(x,!0),Ja=-1<Ma?D.corsEnabledServers[Ma]:null;if(Ja&&Ja.hasOwnProperty("withCredentials"))Ja.withCredentials&&(f.withCredentials=!0);else if(a.id){var Ga=a.id.findServerInfo(x);Ga&&Ga.webTierAuth&&(f.withCredentials=!0)}}f=E?E(f):f;if(L){if(v&&!u("esri-file-upload"))return e.send(f);!ka&&u("safari")&&(f.url+=(-1===f.url.indexOf("?")?"?":"\x26")+"_ts\x3d"+(new Date).getTime()+G++);return p.post(f)}return p.get(f)}catch(Ca){return v=new q,v.errback(f.error(Ca)),
v}}function z(a){var b=D.corsStatus,c=t.canUseXhr(a,!0);-1<c&&D.corsEnabledServers.splice(c,1);var f=new q;f.reject({log:!!d.isDebug});b[v(a)]=f.promise;return c}function A(a){var b=D.corsStatus;try{var c=v(a);if(D.corsDetection&&D.useCors&&u("esri-cors")&&a&&-1!==a.toLowerCase().indexOf("/rest/services")&&!t.hasSameOrigin(a,window.location.href)&&!t.canUseXhr(a)){if(b[c])return b[c];var f=new q;b[c]=f.promise;p.get({url:a.substring(0,a.toLowerCase().indexOf("/rest/")+6)+"info",content:{f:"json"},
failOk:!0,handleAs:"json",headers:{"X-Requested-With":null},timeout:1E3*D.corsDetectionTimeout}).then(function(b){b?(t.canUseXhr(a)||D.corsEnabledServers.push(c),f.resolve()):f.reject()},function(a){f.reject()});return f.promise}}catch(R){console.log("esri._detectCors: an unknown error occurred while detecting CORS support")}return N}function y(b,c,f,g){function e(b){b._pendingDfd=w(f,g,E,B);if(!b._pendingDfd){b.ioArgs=b._pendingDfd&&b._pendingDfd.ioArgs;var c=Error("Deferred object is missing");
c.log=!!d.isDebug;b.errback(c);b._pendingDfd=null;return b}b._pendingDfd.addCallback(function(a){b.ioArgs=b._pendingDfd&&b._pendingDfd.ioArgs;g.returnFullResponse&&(a={data:a,_xhr:b.ioArgs&&b.ioArgs.xhr,getHeader:x});b.callback(a);b._pendingDfd=null}).addErrback(function(c){var e,t,h;c&&(e=c.code,t=c.subcode,h=(h=c.messageCode)&&h.toUpperCase());if(c&&403==e&&(4==t||c.message&&-1<c.message.toLowerCase().indexOf("ssl")&&-1===c.message.toLowerCase().indexOf("permission"))){if(!f._ssl){f._ssl=f._sslFromServer=
!0;y(b,!0,f,g);return}}else if(c&&415==c.status){if(z(f.url),!f._err415){f._err415=1;y(b,!0,f,g);return}}else if(a.id&&-1!==l.indexOf(a.id._errorCodes,e)&&!a.id._isPublic(f.url)&&!m&&(403!=e||-1===l.indexOf(F,h)&&(!n.isDefined(t)||2==t&&f._token))){b._pendingDfd=a.id.getCredential(f.url,{token:f._token,error:c});b._pendingDfd.addCallback(function(a){f._token=a.token;f._credential=a;f._ssl=f._sslFromServer||a.ssl;y(b,!0,f,g)}).addErrback(function(a){b.errback(a);b._pendingDfd=null});return}b.ioArgs=
b._pendingDfd&&b._pendingDfd.ioArgs;b.errback(c);b._pendingDfd=null})}var h=f.form,m=g.disableIdentityLookup,k=g._preLookup,q=!1;if(u("esri-workers")&&!1!==D.useWorkers)if(!0===g.useWorkers||!0===D.useWorkers)q=!0;else if(g.workerOptions){var A=g.workerOptions;if(A.callback||A.worker&&A.worker.worker instanceof Worker)q=!0}var B=h&&u("esri-file-upload")&&h instanceof FormData,E=h&&(h.elements?l.some(h.elements,function(a){return"file"===a.type}):B),G=-1!==f.url.toLowerCase().indexOf("token\x3d")||
f.content&&f.content.token||E&&l.some(h.elements,function(a){return"token"===a.name})?1:0;if(!c){b.addCallback(function(b){if((/\/sharing\/rest\/accounts\/self/i.test(f.url)||/\/sharing\/rest\/portals\/self/i.test(f.url))&&!G&&!f._token&&b.user&&b.user.username){D.webTierAuthServers.push(v(f.url));b=D.corsEnabledServers;var c=t.canUseXhr(f.url,!0),g={host:v(f.url),withCredentials:!0};if(-1===c)b.push(g);else{var n=b[c];"object"===typeof n?n.withCredentials=!0:b.splice(c,1,g)}}if(b=f._credential)if(c=
(c=a.id.findServerInfo(b.server))&&c.owningSystemUrl)c=c.replace(/\/?$/,"/sharing"),(b=a.id.findCredential(c,b.userId))&&-1===a.id._getIdenticalSvcIdx(c,b)&&b.resources.splice(0,0,c)});b.addBoth(function(a){delete f._credential;!a||u("ie")&&a.nodeType||(a._ssl=f._ssl)});var M=f.load,J=f.error;M&&b.addCallback(function(a){var c=b._pendingDfd,c=c&&c.ioArgs;return M.call(c&&c.args,a,c)});J&&b.addErrback(function(a){var c=b._pendingDfd,c=c&&c.ioArgs;return J.call(c&&c.args,a,c)})}!a.id||G||f._token||
a.id._isPublic(f.url)||m&&!k||!(c=a.id.findCredential(f.url))||(f._token=c.token,f._ssl=c.ssl);q?g.workerOptions&&g.workerOptions.worker?(C||(C=p),p=g.workerOptions.worker,e(b)):r(["./workers/RequestClient"],function(a){C||(C=p);if(g.workerOptions){var c=g.workerOptions;p=a.getClient(c.callback,c.cbFunction)}else p=a.getClient();e(b)}):(C&&(p=C,C=null),e(b));return b}function B(a,b){a.url=t.fixUrl(a.url);b=b||{};var c=new q(f._dfdCanceller);A(a.url).always(function(){y(c,!1,a,b)});return c}var C=
null,E,D=g.defaults.io,F=["COM_0056","COM_0057"],G=0,J=/%[0-9A-F]{2}/i,N=function(){var a=new q;a.resolve();return a.promise}();B._makeRequest=w;B._processRequest=y;B._disableCors=z;B._detectCors=A;B.setRequestPreCallback=function(a){E=a};return B})},"dojo/io/script":function(){define("../_base/connect ../_base/kernel ../_base/lang ../sniff ../_base/window ../_base/xhr ../dom ../dom-construct ../request/script ../aspect".split(" "),function(r,l,d,q,k,m,p,h,e,c){l.deprecated("dojo/io/script","Use dojo/request/script.",
"2.0");var b={get:function(a){var g,h=this._makeScriptDeferred(a,function(a){g&&g.cancel()}),n=h.ioArgs;m._ioAddQueryToUrl(n);m._ioNotifyStart(h);g=e.get(n.url,{timeout:a.timeout,jsonp:n.jsonp,checkString:a.checkString,ioArgs:n,frameDoc:a.frameDoc,canAttach:function(a){n.requestId=a.id;n.scriptId=a.scriptId;n.canDelete=a.canDelete;return b._canAttach(n)}},!0);c.around(g,"isValid",function(a){return function(c){b._validCheck(h);return a.call(this,c)}});g.then(function(){h.resolve(h)}).otherwise(function(a){h.ioArgs.error=
a;h.reject(a)});return h},attach:e._attach,remove:e._remove,_makeScriptDeferred:function(a,c){var g=m._ioSetArgs(a,c||this._deferredCancel,this._deferredOk,this._deferredError),n=g.ioArgs;n.id=l._scopeName+"IoScript"+(a.callbackSuffix||this._counter++);n.canDelete=!1;n.jsonp=a.callbackParamName||a.jsonp;n.jsonp&&(n.query=n.query||"",0<n.query.length&&(n.query+="\x26"),n.query+=n.jsonp+"\x3d"+(a.frameDoc?"parent.":"")+l._scopeName+".io.script.jsonp_"+n.id+"._jsonpCallback",n.frameDoc=a.frameDoc,n.canDelete=
!0,g._jsonpCallback=this._jsonpCallback,this["jsonp_"+n.id]=g);g.addBoth(function(a){n.canDelete&&(a instanceof Error?b["jsonp_"+n.id]._jsonpCallback=function(){delete b["jsonp_"+n.id];if(n.requestId)l.global[e._callbacksProperty][n.requestId]()}:b._addDeadScript(n))});return g},_deferredCancel:function(a){a.canceled=!0},_deferredOk:function(a){a=a.ioArgs;return a.json||a.scriptLoaded||a},_deferredError:function(a,b){console.log("dojo.io.script error",a);return a},_deadScripts:[],_counter:1,_addDeadScript:function(a){b._deadScripts.push({id:a.id,
frameDoc:a.frameDoc});a.frameDoc=null},_validCheck:function(a){if((a=b._deadScripts)&&0<a.length){for(var c=0;c<a.length;c++)b.remove(a[c].id,a[c].frameDoc),delete b["jsonp_"+a[c].id],a[c].frameDoc=null;b._deadScripts=[]}return!0},_ioCheck:function(a){a=a.ioArgs;return a.json||a.scriptLoaded&&!a.args.checkString?!0:(a=a.args.checkString)&&eval("typeof("+a+") !\x3d 'undefined'")},_resHandle:function(a){b._ioCheck(a)?a.callback(a):a.errback(Error("inconceivable dojo.io.script._resHandle error"))},_canAttach:function(){return!0},
_jsonpCallback:function(a){this.ioArgs.json=a;if(this.ioArgs.requestId)l.global[e._callbacksProperty][this.ioArgs.requestId](a)}};d.setObject("dojo.io.script",b);return b})},"dojo/io/iframe":function(){define("../_base/config ../_base/json ../_base/kernel ../_base/lang ../_base/xhr ../sniff ../_base/window ../dom ../dom-construct ../query require ../aspect ../request/iframe".split(" "),function(r,l,d,q,k,m,p,h,e,c,b,a,g){d.deprecated("dojo/io/iframe","Use dojo/request/iframe.","2.0");m=g._iframeName;
m=m.substring(0,m.lastIndexOf("_"));var u=q.delegate(g,{create:function(){return u._frame=g.create.apply(g,arguments)},get:null,post:null,send:function(b){var c,f=k._ioSetArgs(b,function(a){c&&c.cancel()},function(a){var b=null;a=a.ioArgs;try{var f=a.handleAs;"xml"===f||"html"===f?b=c.response.data:(b=c.response.text,"json"===f?b=l.fromJson(b):"javascript"===f&&(b=d.eval(b)))}catch(C){b=C}return b},function(a,b){b.ioArgs._hasError=!0;return a}),n=f.ioArgs,e="GET",u=h.byId(b.form);b.method&&"POST"===
b.method.toUpperCase()&&u&&(e="POST");b={method:e,handleAs:"json"===b.handleAs||"javascript"===b.handleAs?"text":b.handleAs,form:b.form,query:u?null:b.content,data:u?b.content:null,timeout:b.timeout,ioArgs:n};b.method&&(b.method=b.method.toUpperCase());if(r.ioPublish&&d.publish&&!1!==n.args.ioPublish)var p=a.after(g,"_notifyStart",function(a){a.options.ioArgs===n&&(p.remove(),k._ioNotifyStart(f))},!0);c=g(n.url,b,!0);n._callNext=c._callNext;c.then(function(){f.resolve(f)}).otherwise(function(a){f.ioArgs.error=
a;f.reject(a)});return f},_iframeOnload:p.global[m+"_onload"]});q.setObject("dojo.io.iframe",u);return u})},"dojo/request/iframe":function(){define("module require ./watch ./util ./handlers ../_base/lang ../io-query ../query ../has ../dom ../dom-construct ../_base/window ../NodeList-dom".split(" "),function(r,l,d,q,k,m,p,h,e,c,b,a){function g(a){return!this.isFulfilled()}function u(a){return!!this._finished}function n(a,b){if(!b)try{var c=a.options,g=f.doc(f._frame),n=c.handleAs;if("html"!==n){if("xml"===
n)if("html"===g.documentElement.tagName.toLowerCase()){h("a",g.documentElement).orphan();var e=g.documentElement.innerText||g.documentElement.textContent,e=e.replace(/>\s+</g,"\x3e\x3c");a.text=m.trim(e)}else a.data=g;else a.text=g.getElementsByTagName("textarea")[0].value;k(a)}else a.data=g}catch(D){b=D}b?this.reject(b):this._finished?this.resolve(a):this.reject(Error("Invalid dojo/request/iframe request state"))}function t(a){this._callNext()}function f(a,b,c){var e=q.parseArgs(a,q.deepCreate(w,
b),!0);a=e.url;b=e.options;if("GET"!==b.method&&"POST"!==b.method)throw Error(b.method+" not supported by dojo/request/iframe");f._frame||(f._frame=f.create(f._iframeName,x+"();"));a=q.deferred(e,null,g,u,n,t);a._callNext=function(){this._calledNext||(this._calledNext=!0,f._currentDfd=null,f._fireNextRequest())};a._legacy=c;f._dfdQueue.push(a);f._fireNextRequest();d(a);return c?a:a.promise}var v=r.id.replace(/[\/\.\-]/g,"_"),x=v+"_onload";a.global[x]||(a.global[x]=function(){var a=f._currentDfd;if(a){var g=
c.byId(a.response.options.form)||a._tmpForm;if(g){for(var n=a._contentToClean,e=0;e<n.length;e++)for(var t=n[e],h=0;h<g.childNodes.length;h++){var u=g.childNodes[h];if(u.name===t){b.destroy(u);break}}a._originalAction&&g.setAttribute("action",a._originalAction);a._originalMethod&&(g.setAttribute("method",a._originalMethod),g.method=a._originalMethod);a._originalTarget&&(g.setAttribute("target",a._originalTarget),g.target=a._originalTarget)}a._tmpForm&&(b.destroy(a._tmpForm),delete a._tmpForm);a._finished=
!0}else f._fireNextRequest()});var w={method:"POST"};f.create=function(c,f,g){if(a.global[c])return a.global[c];if(a.global.frames[c])return a.global.frames[c];g||(e("config-useXDomain")&&!e("config-dojoBlankHtmlUrl")&&console.warn("dojo/request/iframe: When using cross-domain Dojo builds, please save dojo/resources/blank.html to your domain and set dojoConfig.dojoBlankHtmlUrl to the path on your domain to blank.html"),g=e("config-dojoBlankHtmlUrl")||l.toUrl("dojo/resources/blank.html"));f=b.place('\x3ciframe id\x3d"'+
c+'" name\x3d"'+c+'" src\x3d"'+g+'" onload\x3d"'+f+'" style\x3d"position: absolute; left: 1px; top: 1px; height: 1px; width: 1px; visibility: hidden"\x3e',a.body());return a.global[c]=f};f.doc=function(b){if(b.contentDocument)return b.contentDocument;var c=b.name;if(c){var f=a.doc.getElementsByTagName("iframe");if(b.document&&f[c].contentWindow&&f[c].contentWindow.document)return f[c].contentWindow.document;if(a.doc.frames[c]&&a.doc.frames[c].document)return a.doc.frames[c].document}return null};
f.setSrc=function(b,c,f){b=a.global.frames[b.name];b.contentWindow&&(b=b.contentWindow);try{f?b.location.replace(c):b.location=c}catch(B){console.log("dojo/request/iframe.setSrc: ",B)}};f._iframeName=v+"_IoIframe";f._notifyStart=function(){};f._dfdQueue=[];f._currentDfd=null;f._fireNextRequest=function(){var g;try{if(!f._currentDfd&&f._dfdQueue.length){do g=f._currentDfd=f._dfdQueue.shift();while(g&&(g.canceled||g.isCanceled&&g.isCanceled())&&f._dfdQueue.length);if(!g||g.canceled||g.isCanceled&&g.isCanceled())f._currentDfd=
null;else{var n=g.response,e=n.options,t=g._contentToClean=[],h=c.byId(e.form),u=q.notify,d=e.data||null,x;g._legacy||"POST"!==e.method||h?"GET"===e.method&&h&&-1<n.url.indexOf("?")&&(x=n.url.slice(n.url.indexOf("?")+1),d=m.mixin(p.queryToObject(x),d)):h=g._tmpForm=b.create("form",{name:v+"_form",style:{position:"absolute",top:"-1000px",left:"-1000px"}},a.body());if(h){if(!g._legacy){var w=h;do w=w.parentNode;while(w&&w!==a.doc.documentElement);w||(h.style.position="absolute",h.style.left="-1000px",
h.style.top="-1000px",a.body().appendChild(h));h.name||(h.name=v+"_form")}if(d){var w=function(a,c){b.create("input",{type:"hidden",name:a,value:c},h);t.push(a)},k;for(k in d){var l=d[k];if(m.isArray(l)&&1<l.length)for(x=0;x<l.length;x++)w(k,l[x]);else h[k]?h[k].value=l:w(k,l)}}var r=h.getAttributeNode("action"),L=h.getAttributeNode("method"),K=h.getAttributeNode("target");n.url&&(g._originalAction=r?r.value:null,r?r.value=n.url:h.setAttribute("action",n.url));g._legacy?L&&L.value||(L?L.value=e.method:
h.setAttribute("method",e.method)):(g._originalMethod=L?L.value:null,L?L.value=e.method:h.setAttribute("method",e.method));g._originalTarget=K?K.value:null;K?K.value=f._iframeName:h.setAttribute("target",f._iframeName);h.target=f._iframeName;u&&u.emit("send",n,g.promise.cancel);f._notifyStart(n);h.submit()}else e="",n.options.data&&(e=n.options.data,"string"!==typeof e&&(e=p.objectToQuery(e))),w=n.url+(-1<n.url.indexOf("?")?"\x26":"?")+e,u&&u.emit("send",n,g.promise.cancel),f._notifyStart(n),f.setSrc(f._frame,
w,!0)}}}catch(W){g.reject(W)}};q.addCommonMethods(f,["GET","POST"]);return f})},"esri/sniff":function(){define(["dojo/_base/sniff","./kernel"],function(r,l){var d=function(){return this}(),q=r("ff"),k=r("ie"),m=void 0===k&&7<=r("trident"),p=r("edge"),h=r("webkit"),e=r("opera"),c=r("chrome"),b=r("safari"),a=navigator.userAgent,g;(g=a.match(/(iPhone|iPad|CPU)\s+OS\s+(\d+\_\d+)/i))&&r.add("esri-iphone",parseFloat(g[2].replace("_",".")));(g=a.match(/Android\s+(\d+\.\d+)/i))&&r.add("esri-android",parseFloat(g[1]));
(g=a.match(/Fennec\/(\d+\.\d+)/i))&&r.add("esri-fennec",parseFloat(g[1]));0<=a.indexOf("BlackBerry")&&0<=a.indexOf("WebKit")&&r.add("esri-blackberry",1);r.add("esri-touch",r("esri-iphone")||r("esri-android")||r("esri-blackberry")||6<=r("esri-fennec")||(q||h)&&document.createTouch?!0:!1);(g=a.match(/Android|webOS|iPhone|iPad|iPod|BlackBerry|Opera Mini|IEMobile/i))&&r.add("esri-mobile",g);r.add("esri-pointer",navigator.pointerEnabled||navigator.msPointerEnabled);l._getDOMAccessor=function(a){var b=
"";q?b="Moz":h?b="Webkit":k?b="ms":e&&(b="O");return b+a.charAt(0).toUpperCase()+a.substr(1)};r.add("esri-phonegap",!!d.cordova);r.add("esri-cors",r("esri-phonegap")||d.XMLHttpRequest&&"withCredentials"in new XMLHttpRequest);r.add("esri-file-upload",d.FormData&&d.FileList?!0:!1);r.add("esri-workers",d.Worker?!0:!1);r.add("esri-transforms",m||p||9<=k||3.5<=q||4<=c||3.1<=b||10.5<=e||3.2<=r("esri-iphone")||2.1<=r("esri-android"));r.add("esri-transitions",m||p||10<=k||4<=q||4<=c||3.1<=b||10.5<=e||3.2<=
r("esri-iphone")||2.1<=r("esri-android"));r.add("esri-transforms3d",m||p||10<=q||12<=c||4<=b||3.2<=r("esri-iphone")||3<=r("esri-android"));r.add("esri-url-encodes-apostrophe",function(){if(d.document)return!1;var a=d.document.createElement("a");a.href="?'";return-1<a.href.indexOf("?%27")});3>r("esri-android")&&(r.add("esri-transforms",!1,!1,!0),r.add("esri-transitions",!1,!1,!0),r.add("esri-transforms3d",!1,!1,!0));r.add("esri-will-change",r("esri-transforms")&&(52<=c||9.1<=b));l._css=function(a){var g=
r("esri-transforms3d");void 0!==a&&null!==a?g=a:g&&(c||b&&!r("esri-iphone"))&&(g=!1);var t=g?"translate3d(":"translate(",f=g?c?",-1px)":",0px)":")",u=g?"scale3d(":"scale(",d=g?",1)":")",w=g?"rotate3d(0,0,1,":"rotate(",p=g?"matrix3d(":"matrix(",m=g?",0,0,":",",l=g?",0,0,0,0,1,0,":",",B=g?",0,1)":")";return{names:{transition:h&&"-webkit-transition"||q&&"MozTransition"||e&&"OTransition"||k&&"msTransition"||"transition",transform:h&&"-webkit-transform"||q&&"MozTransform"||e&&"OTransform"||k&&"msTransform"||
"transform",transformName:h&&"-webkit-transform"||q&&"-moz-transform"||e&&"-o-transform"||k&&"-ms-transform"||"transform",origin:h&&"-webkit-transform-origin"||q&&"MozTransformOrigin"||e&&"OTransformOrigin"||k&&"msTransformOrigin"||"transformOrigin",endEvent:h&&"webkitTransitionEnd"||q&&"transitionend"||e&&"oTransitionEnd"||k&&"MSTransitionEnd"||"transitionend"},translate:function(a,b){return t+a+"px,"+b+"px"+f},scale:function(a){return u+a+","+a+d},rotate:function(a){return w+a+"deg)"},matrix:function(a){return p+
a.xx+","+a.xy+m+a.yx+","+a.yy+l+a.dx.toFixed(10)+(q?"px,":",")+a.dy.toFixed(10)+(q?"px":"")+B},getScaleFromMatrix:function(a){if(!a)return 1;a=a.toLowerCase();var b=-1<a.indexOf("matrix3d")?"matrix3d(":"matrix(";return Number(a.substring(b.length,a.indexOf(",")))}}};return r})},"esri/urlUtils":function(){define("dojo/_base/lang dojo/_base/array dojo/_base/url dojo/io-query ./kernel ./lang ./config ./sniff dojo/i18n!./nls/jsapi".split(" "),function(r,l,d,q,k,m,p,h,e){var c=function(){return this}(),
b={},a=p.defaults.io,g=/^[a-z][a-z0-9\+\-\.]*:/i,u=/^\s*http:/i,n=/^\s*https:/i;b.isHTTP=function(a){var b=c.location.protocol;return null==a?"http:"===b||"https:"===b:a?"https:"===b:"http:"===b};b.getProtocolForWebResource=function(a){return b.isHTTP()?c.location.protocol:a?"https:":"http:"};b.urlToObject=function(a){var b={},c=new d(a),g=a.indexOf("?");null===c.query?b={path:a,query:null}:(b.path=a.substring(0,g),b.query=q.queryToObject(c.query));c.fragment&&(b.hash=c.fragment,null===c.query&&(b.path=
b.path.substring(0,b.path.length-(c.fragment.length+1))));return b};b.getProxyUrl=function(g,f){var n=r.isString(g)?0===r.trim(g).toLowerCase().indexOf("https:"):g,h=a.proxyUrl,t,u,d=e.io.proxyNotSet;r.isString(g)&&(u=b.getProxyRule(g))&&(h=u.proxyUrl);if(!h)throw console.log(d),Error(d);n&&!1!==f&&0!==c.location.href.toLowerCase().indexOf("https:")&&(n=h,0!==n.toLowerCase().indexOf("http")&&(n=b.getAbsoluteUrl(n)),n=n.replace(/^http:/i,"https:"),b.canUseXhr(n)&&(h=n,t=1));h=b.urlToObject(h);h._xo=
t;return h};b.addProxy=function(c){var f=b.getProxyRule(c),g;f?g=b.urlToObject(f.proxyUrl):a.alwaysUseProxy&&(g=b.getProxyUrl());g&&(f=b.urlToObject(c),c=g.path+"?"+f.path,(g=q.objectToQuery(r.mixin(g.query||{},f.query)))&&(c+="?"+g));return c};b.addProxyRule=function(c){var f=c.urlPrefix=b.urlToObject(c.urlPrefix).path.replace(/([^\/])$/,"$1/").replace(/^https?:\/\//ig,"").toLowerCase(),g=a.proxyRules,e,n=g.length,h,t=n;for(e=0;e<n;e++)if(h=g[e].urlPrefix,0===f.indexOf(h)){if(f.length===h)return-1;
t=e;break}else 0===h.indexOf(f)&&(t=e+1);g.splice(t,0,c);return t};b.getProxyRule=function(c){var f=a.proxyRules,g=f.length,e=b.urlToObject(c).path.replace(/([^\/])$/,"$1/").replace(/^https?:\/\//ig,"").toLowerCase(),n;for(c=0;c<g;c++)if(0===e.indexOf(f[c].urlPrefix)){n=f[c];break}return n};b.hasSameOrigin=function(a,b,g){a=a.toLowerCase();b=b.toLowerCase();var f=c.location.href.toLowerCase();a=0===a.indexOf("http")?new d(a):f=new d(f);b=0===b.indexOf("http")?new d(b):r.isString(f)?new d(f):f;return(g||
a.scheme===b.scheme)&&a.host===b.host&&a.port===b.port};b.canUseXhr=function(c,f){var g=h("esri-phonegap")?!0:!1,e=b.hasSameOrigin,n=a.corsEnabledServers,t,u=-1;!g&&h("esri-cors")&&n&&n.length&&(g=l.some(n,function(a,b){var f=a&&"object"===typeof a?a.host:a;return f&&(t=0!==r.trim(f).toLowerCase().indexOf("http"),e(c,t?"http://"+f:f)||t&&e(c,"https://"+f))?(u=b,!0):!1}));return f?u:g};b.getAbsoluteUrl=function(a){var f=b.getProtocolForWebResource();return r.isString(a)&&!g.test(a)?0===a.indexOf("//")?
f+a:0===a.indexOf("/")?f+"//"+c.location.host+a:k._appBaseUrl+a:a};b.fixUrl=function(a){a=r.trim(a);a=b.getAbsoluteUrl(a);a=b.downgradeToHTTP(a);a=b.upgradeToHTTPS(a);return a=a.replace(/^(https?:\/\/)(arcgis\.com)/i,"$1www.$2")};b.normalize=function(a){return b.fixUrl(a)};b.downgradeToHTTP=function(a){return b.isHTTP(!1)&&n.test(a)&&b.hasSameOrigin(c.location.href,a,!0)&&!b.canUseXhr(a)?a.replace(n,"http:"):a};b.upgradeToHTTPS=function(a){var f=p.defaults.io.httpsDomains,g=b.isHTTP(!1),e=b.isHTTP(!0);
if(!u.test(a))return a;a=r.trim(a);var n=a.indexOf("/",7),n=-1===n?a:a.slice(0,n),n=n.toLowerCase().slice(7);if(g&&n===c.location.host)return a;g=!1;if(e&&n===c.location.host)g=!0;else if(f)for(e=0;e<f.length;e++){var h=f[e];if(n===h||m.endsWith(n,"."+h)){g=!0;break}}g&&(a=a.replace(u,"https:"));return a};return b})},"esri/deferredUtils":function(){define(["dojo/_base/lang","dojo/has","./kernel"],function(r,l,d){return{_dfdCanceller:function(d){d.canceled=!0;var k=d._pendingDfd;-1===d.fired&&k&&-1===
k.fired&&k.cancel();d._pendingDfd=null},_fixDfd:function(d){var k=d.then;d.then=function(d,p,h){if(d){var e=d;d=function(c){return c&&c._argsArray?e.apply(null,c):e(c)}}return k.call(this,d,p,h)};return d},_resDfd:function(d,k,m){var p=k.length;1===p?m?d.errback(k[0]):d.callback(k[0]):1<p?(k._argsArray=!0,d.callback(k)):d.callback()}}})},"esri/SpatialReference":function(){define("dojo/_base/declare dojo/_base/array dojo/_base/lang dojo/has ./kernel ./lang".split(" "),function(r,l,d,q,k,m){q=[-2.0037508342788905E7,
2.0037508342788905E7];k=[-2.0037508342787E7,2.0037508342787E7];return r(null,{declaredClass:"esri.SpatialReference",constructor:function(p){p&&(d.isObject(p)?d.mixin(this,p):d.isString(p)?this.wkt=p:this.wkid=p)},wkid:null,wkt:null,_info:{102113:{wkTemplate:'PROJCS["WGS_1984_Web_Mercator",GEOGCS["GCS_WGS_1984_Major_Auxiliary_Sphere",DATUM["D_WGS_1984_Major_Auxiliary_Sphere",SPHEROID["WGS_1984_Major_Auxiliary_Sphere",6378137.0,0.0]],PRIMEM["Greenwich",0.0],UNIT["Degree",0.0174532925199433]],PROJECTION["Mercator"],PARAMETER["False_Easting",0.0],PARAMETER["False_Northing",0.0],PARAMETER["Central_Meridian",${Central_Meridian}],PARAMETER["Standard_Parallel_1",0.0],UNIT["Meter",1.0]]',
valid:q,origin:k,dx:1E-5},102100:{wkTemplate:'PROJCS["WGS_1984_Web_Mercator_Auxiliary_Sphere",GEOGCS["GCS_WGS_1984",DATUM["D_WGS_1984",SPHEROID["WGS_1984",6378137.0,298.257223563]],PRIMEM["Greenwich",0.0],UNIT["Degree",0.0174532925199433]],PROJECTION["Mercator_Auxiliary_Sphere"],PARAMETER["False_Easting",0.0],PARAMETER["False_Northing",0.0],PARAMETER["Central_Meridian",${Central_Meridian}],PARAMETER["Standard_Parallel_1",0.0],PARAMETER["Auxiliary_Sphere_Type",0.0],UNIT["Meter",1.0]]',valid:q,origin:k,
dx:1E-5},3785:{wkTemplate:'PROJCS["WGS_1984_Web_Mercator",GEOGCS["GCS_WGS_1984_Major_Auxiliary_Sphere",DATUM["D_WGS_1984_Major_Auxiliary_Sphere",SPHEROID["WGS_1984_Major_Auxiliary_Sphere",6378137.0,0.0]],PRIMEM["Greenwich",0.0],UNIT["Degree",0.0174532925199433]],PROJECTION["Mercator"],PARAMETER["False_Easting",0.0],PARAMETER["False_Northing",0.0],PARAMETER["Central_Meridian",${Central_Meridian}],PARAMETER["Standard_Parallel_1",0.0],UNIT["Meter",1.0]]',valid:q,origin:k,dx:1E-5},3857:{wkTemplate:'PROJCS["WGS_1984_Web_Mercator_Auxiliary_Sphere",GEOGCS["GCS_WGS_1984",DATUM["D_WGS_1984",SPHEROID["WGS_1984",6378137.0,298.257223563]],PRIMEM["Greenwich",0.0],UNIT["Degree",0.0174532925199433]],PROJECTION["Mercator_Auxiliary_Sphere"],PARAMETER["False_Easting",0.0],PARAMETER["False_Northing",0.0],PARAMETER["Central_Meridian",${Central_Meridian}],PARAMETER["Standard_Parallel_1",0.0],PARAMETER["Auxiliary_Sphere_Type",0.0],UNIT["Meter",1.0]]',
valid:q,origin:k,dx:1E-5},4326:{wkTemplate:'GEOGCS["GCS_WGS_1984",DATUM["D_WGS_1984",SPHEROID["WGS_1984",6378137.0,298.257223563]],PRIMEM["Greenwich",${Central_Meridian}],UNIT["Degree",0.0174532925199433]]',altTemplate:'PROJCS["WGS_1984_Plate_Carree",GEOGCS["GCS_WGS_1984",DATUM["D_WGS_1984",SPHEROID["WGS_1984",6378137.0,298.257223563]],PRIMEM["Greenwich",0.0],UNIT["Degree",0.0174532925199433]],PROJECTION["Plate_Carree"],PARAMETER["False_Easting",0.0],PARAMETER["False_Northing",0.0],PARAMETER["Central_Meridian",${Central_Meridian}],UNIT["Degrees",111319.491]]',
valid:[-180,180],origin:[-180,180],dx:1E-5}},_isWebMercator:function(){return-1!==l.indexOf([102113,102100,3857,3785],this.wkid)},_isWrappable:function(){return-1!==l.indexOf([102113,102100,3857,3785,4326],this.wkid)},_getInfo:function(){return this.wkid?this._info[this.wkid]:null},_canProject:function(d){var h=!1;d&&(h=this.isWebMercator()&&4326===d.wkid||d.isWebMercator()&&4326===this.wkid);return h},isWebMercator:function(){return this._isWebMercator()},equals:function(d){var h=!1;d&&(this===d&&
(h=!0),this.wkid||d.wkid?h=this.wkid===d.wkid||this.isWebMercator()&&d.isWebMercator()||this.wkid===d.latestWkid||d.wkid===this.latestWkid:this.wkt&&d.wkt&&(h=this.wkt.toUpperCase()===d.wkt.toUpperCase()));return h},toJson:function(){var d=null,h=m.isDefined;h(this.wkid)?d={wkid:this.wkid}:h(this.wkt)&&(d={wkt:this.wkt});d&&h(this.latestWkid)&&(d.latestWkid=this.latestWkid);return d}})})},"esri/map":function(){define("require dojo/_base/kernel dojo/_base/declare dojo/_base/connect dojo/_base/lang dojo/_base/array dojo/_base/event dojo/on dojo/aspect dojo/dom dojo/dom-attr dojo/dom-class dojo/dom-construct dojo/dom-geometry dojo/dom-style dijit/a11yclick dijit/registry ./kernel ./config ./sniff ./lang ./_coremap ./MapNavigationManager dojo/i18n!./nls/jsapi".split(" "),
function(r,l,d,q,k,m,p,h,e,c,b,a,g,u,n,t,f,v,x,w,z,A,y,B){var C={up:"panUp",right:"panRight",down:"panDown",left:"panLeft"},E={upperRight:"panUpperRight",lowerRight:"panLowerRight",lowerLeft:"panLowerLeft",upperLeft:"panUpperLeft"},D=q.connect,F=q.disconnect,G=g.create,J=n.set,N=k.hitch,M=u.getMarginBox,L=l.deprecated,K=k.mixin,W=0;return d(A,{declaredClass:"esri.Map",constructor:function(a,b){b=b||{};K(this,{_slider:null,_navDiv:null,_mapParams:K({attributionWidth:.45,slider:!0,nav:!1,logo:!0,sliderStyle:"small",
sliderPosition:"top-left",sliderOrientation:"vertical",autoResize:!0},b)});K(this,{isMapNavigation:null!=b.isMapNavigation?b.isMapNavigation:!0,isDoubleClickZoom:null!=b.isDoubleClickZoom?b.isDoubleClickZoom:!0,isClickRecenter:null!=b.isClickRecenter?b.isClickRecenter:!0,isPan:null!=b.isPan?b.isPan:!0,isRubberBandZoom:null!=b.isRubberBandZoom?b.isRubberBandZoom:!0,isPinchZoom:null!=b.isPinchZoom?b.isPinchZoom:!0,isKeyboardNavigation:null!=b.isKeyboardNavigation?b.isKeyboardNavigation:!0,isScrollWheel:null!=
b.isScrollWheel?b.isScrollWheel:!0,isShiftDoubleClickZoom:!1,isScrollWheelZoom:!1,isPanArrows:!1,isZoomSlider:!1});k.isFunction(v._css)&&(v._css=v._css(this._mapParams.force3DTransforms),this.force3DTransforms=this._mapParams.force3DTransforms);var c=w("esri-transforms")&&w("esri-transitions");this.navigationMode=this._mapParams.navigationMode||c&&"css-transforms"||"classic";"css-transforms"!==this.navigationMode||c||(this.navigationMode="classic");this.fadeOnZoom=z.isDefined(this._mapParams.fadeOnZoom)?
this._mapParams.fadeOnZoom:"css-transforms"===this.navigationMode;"css-transforms"!==this.navigationMode&&(this.fadeOnZoom=!1);this.setMapCursor("default");this.smartNavigation=b&&b.smartNavigation;if(!(z.isDefined(this.smartNavigation)||!w("mac")||w("esri-touch")||w("esri-pointer")||3.5>=w("ff"))){var f=navigator.userAgent.match(/Mac\s+OS\s+X\s+([\d]+)(\.|\_)([\d]+)\D/i);f&&z.isDefined(f[1])&&z.isDefined(f[3])&&(c=parseInt(f[1],10),f=parseInt(f[3],10),this.smartNavigation=10<c||10===c&&6<=f)}this.showAttribution=
z.isDefined(this._mapParams.showAttribution)?this._mapParams.showAttribution:!0;this._onLoadHandler_connect=D(this,"onLoad",this,"_onLoadInitNavsHandler");var g=G("div",{"class":"esriControlsBR"+(this._mapParams.nav?" withPanArrows":"")},this.root);if(this.showAttribution)if(c=k.getObject("esri.dijit.Attribution",!1))this._initAttribution(c,g);else{var n=W++,u=this;this._rids&&this._rids.push(n);r(["./dijit/Attribution"],function(a){var b=u._rids?m.indexOf(u._rids,n):-1;-1!==b&&(u._rids.splice(b,
1),u._initAttribution(a,g))})}this._mapParams.logo&&(c={},6===w("ie")&&(c.filter="progid:DXImageTransform.Microsoft.AlphaImageLoader(enabled\x3d'true', sizingMethod\x3d'crop', src\x3d'"+r.toUrl("./images/map/logo-med.png")+"')"),this._ogol=G("div",{style:c,tabIndex:"0",title:"Esri"},g),this._setLogoSize(),this._onMapResizeLogo_connect=D(this,"onResize",this,"_setLogoSize"),this._ogol_connect=D(this._ogol,t,this,"_openLogoLink"));this.navigationManager=new y(this);b&&b.basemap&&(this._onLoadFix=!0,
this.setBasemap(b.basemap),this._onLoadFix=!1);if(this.autoResize=this._mapParams.autoResize)c=this._getEnclosingResizableWidget(this.container)||window,f=this.resize,this._rszSignal=h.pausable(c,"resize",f),this._oriSignal=h.pausable(window,"orientationchange",f),e.after(c,"resize",f,!0),this._startResizeTimer()},_startResizeTimer:function(){clearTimeout(this._persistentTimer);this._persistentTimer=setTimeout(this._timedResize,2*this.resizeDelay)},_getEnclosingResizableWidget:function(a){var b=f.getEnclosingWidget(a);
return b?b.resize?b:this._getEnclosingResizableWidget(a.parentNode):b},_setLogoSize:function(){this._ogol&&(25E4>this.root.clientWidth*this.root.clientHeight?(a.remove(this._ogol,"logo-med"),a.add(this._ogol,"logo-sm")):(a.remove(this._ogol,"logo-sm"),a.add(this._ogol,"logo-med")))},_initAttribution:function(b,c){var f=G("span",{"class":"esriAttribution"},c,"first");J(f,"maxWidth",Math.floor(this.width*this._mapParams.attributionWidth)+"px");this._connects.push(D(f,t,function(){a.contains(this,"esriAttributionOpen")?
a.remove(this,"esriAttributionOpen"):this.scrollWidth>this.clientWidth&&a.add(this,"esriAttributionOpen")}));this.attribution=new b({map:this},f)},_cleanUp:function(){this.disableMapNavigation();this.navigationManager.destroy();var a=this._slider;a&&a.destroy&&!a._destroyed&&a.destroy();var a=this._navDiv,b=this.attribution;a&&g.destroy(a);b&&b.destroy();this._connects.push(this._slider_connect,this._ogol_connect,this._rszSignal,this._oriSignal);m.forEach(this._connects,F);clearInterval(this._persistentTimer);
this.attribution=this.navigationManager=this._rids=this._connects=this._slider_connect=this._ogol_connect=this._rszSignal=this._oriSignal=this._persistentTimer=null;this.inherited("_cleanUp",arguments)},_isPanningOrZooming:function(){return this.__panning||this.__zooming},_canZoom:function(a){var b=this.getLevel();return!this.__tileInfo||!(b===this.getMinZoom()&&0>a||b===this.getMaxZoom()&&0<a)},_onLoadInitNavsHandler:function(){this._evalMapNavigation();this._createNav();if("small"===this._mapParams.sliderStyle||
!this._createSlider)this._createSimpleSlider();else if(this._mapParams.slider){var a=-1!==this._getSliderClass(!0).indexOf("Horizontal"),a=[a?"dijit.form.HorizontalSlider":"dijit.form.VerticalSlider",a?"dijit.form.HorizontalRule":"dijit.form.VerticalRule",a?"dijit.form.HorizontalRuleLabels":"dijit.form.VerticalRuleLabels"];if(m.some(a,function(a){return!k.getObject(a,!1)})){var a=m.map(a,function(a){return a.replace(/\./g,"/")}),b=W++,c=this;this._rids&&this._rids.push(b);r(a,function(){var a=c._rids?
m.indexOf(c._rids,b):-1;-1!==a&&(c._rids.splice(a,1),c._createSlider.apply(c,arguments))})}else a=m.map(a,function(a){return k.getObject(a,!1)}),this._createSlider.apply(this,a)}F(this._onLoadHandler_connect)},_createNav:function(){if(this._mapParams.nav){var b,c,f,g=a.add,n=this.id;this._navDiv=G("div",{id:n+"_navdiv"},this.root);g(this._navDiv,"navDiv");var e=this.width/2,h=this.height/2,t;for(f in C)c=C[f],b=G("div",{id:n+"_pan_"+f},this._navDiv),g(b,"fixedPan "+c),"up"===f||"down"===f?(t=parseInt(M(b).w,
10)/2,J(b,{left:e-t+"px",zIndex:30})):(t=parseInt(M(b).h,10)/2,J(b,{top:h-t+"px",zIndex:30})),this._connects.push(D(b,"onclick",N(this,this[c])));this._onMapResizeNavHandler_connect=D(this,"onResize",this,"_onMapResizeNavHandler");for(f in E)c=E[f],b=G("div",{id:n+"_pan_"+f,style:{zIndex:30}},this._navDiv),g(b,"fixedPan "+c),this._connects.push(D(b,"onclick",N(this,this[c])));this.isPanArrows=!0}},_onMapResizeNavHandler:function(a,b,f){a=this.id;b/=2;f/=2;var g=c.byId,n,e,h;for(n in C)e=g(a+"_pan_"+
n),"up"===n||"down"===n?(h=parseInt(M(e).w,10)/2,J(e,"left",b-h+"px")):(h=parseInt(M(e).h,10)/2,J(e,"top",f-h+"px"))},_createSimpleSlider:function(){if(this._mapParams.slider){var b=this._slider=G("div",{id:this.id+"_zoom_slider","class":this._getSliderClass(),style:{zIndex:30}}),f=G("div",{"class":"esriSimpleSliderIncrementButton",tabIndex:"0",role:"button"},b),g=G("div",{"class":"esriSimpleSliderDecrementButton",tabIndex:"0",role:"button"},b);this._addZoomButtonTooltips(f,g);this._incButton=f;this._decButton=
g;this._simpleSliderZoomHandler(null,null,null,this.getLevel());var n=B.widgets.zoomSlider;this._addZoomButtonIcon(f,"+",n.zoomIn);this._addZoomButtonIcon(g,"\x26minus;",n.zoomOut);8>w("ie")&&a.add(g,"dj_ie67Fix");this._connects.push(D(f,t,this,this._simpleSliderChangeHandler));this._connects.push(D(g,t,this,this._simpleSliderChangeHandler));(-1<this.getMaxZoom()||-1<this.getMinZoom())&&this._connects.push(D(this,"onZoomEnd",this,this._simpleSliderZoomHandler));10>w("ie")&&c.setSelectable(b,!1);this.root.appendChild(b);
this.isZoomSlider=!0}},_simpleSliderChangeHandler:function(a){p.stop(a);a=-1!==a.currentTarget.className.indexOf("IncrementButton")?!0:!1;this._extentUtil({numLevels:a?1:-1})},_simpleSliderZoomHandler:function(b,c,f,g){var n;b=this._incButton;c=this._decButton;-1<g&&g===this.getMaxZoom()?n=b:-1<g&&g===this.getMinZoom()&&(n=c);n?(a.add(n,"esriSimpleSliderDisabledButton"),a.remove(n===b?c:b,"esriSimpleSliderDisabledButton")):(a.remove(b,"esriSimpleSliderDisabledButton"),a.remove(c,"esriSimpleSliderDisabledButton"))},
_getSliderClass:function(a){a=a?"Large":"Simple";var b=this._mapParams.sliderOrientation,c=this._mapParams.sliderPosition||"",b=b&&"horizontal"===b.toLowerCase()?"esri"+a+"SliderHorizontal":"esri"+a+"SliderVertical";if(c)switch(c.toLowerCase()){case "top-left":c="esri"+a+"SliderTL";break;case "top-right":c="esri"+a+"SliderTR";break;case "bottom-left":c="esri"+a+"SliderBL";break;case "bottom-right":c="esri"+a+"SliderBR"}return"esri"+a+"Slider "+b+" "+c},_addZoomButtonIcon:function(a,b,c){g.create("span",
{"aria-hidden":"true",role:"presentation",innerHTML:b},a);g.create("span",{"class":"esriIconFallbackText",innerHTML:c},a)},_addZoomButtonTooltips:function(a,c){var f=B.widgets.zoomSlider;b.set(a,"title",f.zoomIn);b.set(c,"title",f.zoomOut)},_createSlider:function(a,b,c){if(this._mapParams.slider){var f=G("div",{id:this.id+"_zoom_slider"},this.root),g=x.defaults.map,n=this._getSliderClass(!0),e=-1!==n.indexOf("Horizontal"),h=this.getNumLevels();if(0<h){var t,u,d=this._mapParams.sliderLabels,v=!!d,
p=!1!==d;if(p){var k=e?"bottomDecoration":"rightDecoration";if(!d)for(d=[],g=0;g<h;g++)d[g]="";m.forEach([{"class":"esriLargeSliderTicks",container:k,count:h,dijitClass:b},{"class":v&&"esriLargeSliderLabels",container:k,count:h,labels:d,dijitClass:c}],function(a){var c=G("div"),g=a.dijitClass;delete a.dijitClass;f.appendChild(c);g===b?t=new g(a,c):u=new g(a,c)})}a=this._slider=new a({id:f.id,"class":n,minimum:this.getMinZoom(),maximum:this.getMaxZoom(),discreteValues:h,value:this.getLevel(),clickSelect:!0,
intermediateChanges:!0,style:"z-index:30;"},f);a.startup();p&&(t.startup(),u.startup());this._slider_connect=D(a,"onChange",this,"_onSliderChangeHandler");this._connects.push(D(this,"onExtentChange",this,"_onExtentChangeSliderHandler"));this._connects.push(D(a._movable,"onFirstMove",this,"_onSliderMoveStartHandler"))}else{a=this._slider=new a({id:f.id,"class":n,minimum:0,maximum:2,discreteValues:3,value:1,clickSelect:!0,intermediateChanges:g.sliderChangeImmediate,style:"height:50px; z-index:30;"},
f);c=a.domNode.firstChild.childNodes;for(g=1;3>=g;g++)J(c[g],"visibility","hidden");a.startup();this._slider_connect=D(a,"onChange",this,"_onDynSliderChangeHandler");this._connects.push(D(this,"onExtentChange",this,"_onExtentChangeDynSliderHandler"))}g=a.incrementButton;c=a.decrementButton;e?this._addZoomButtonTooltips(g,c):this._addZoomButtonTooltips(c,g);g.style.outline="none";c.style.outline="none";a.sliderHandle.style.outline="none";a._onKeyPress=function(){};if(e=a._movable){var l=e.onMouseDown;
e.onMouseDown=function(a){9>w("ie")&&1!==a.button||l.apply(this,arguments)}}this.isZoomSlider=!0}},_onSliderMoveStartHandler:function(){F(this._slider_connect);F(this._slidermovestop_connect);this._slider_connect=D(this._slider,"onChange",this,"_onSliderChangeDragHandler");this._slidermovestop_connect=D(this._slider._movable,"onMoveStop",this,"_onSliderMoveEndHandler")},_onSliderChangeDragHandler:function(a){this._extentUtil({targetLevel:a})},_onSliderMoveEndHandler:function(){F(this._slider_connect);
F(this._slidermovestop_connect)},_onSliderChangeHandler:function(a){this.setLevel(a)},_updateSliderValue:function(a,b){F(this._slider_connect);var c=this._slider,f=c._onChangeActive;c._onChangeActive=!1;c.set("value",a);c._onChangeActive=f;this._slider_connect=D(c,"onChange",this,b)},_onExtentChangeSliderHandler:function(a,b,c,f){F(this._slidermovestop_connect);this._updateSliderValue(f.level,"_onSliderChangeHandler")},_onDynSliderChangeHandler:function(a){this._extentUtil({numLevels:0<a?1:-1})},
_onExtentChangeDynSliderHandler:function(){this._updateSliderValue(1,"_onDynSliderChangeHandler")},_openLogoLink:function(a){window.open(x.defaults.map.logoLink,"_blank");p.stop(a)},enableMapNavigation:function(){this.isMapNavigation||(this.isMapNavigation=!0,this._evalMapNavigation())},disableMapNavigation:function(){this.isMapNavigation&&(this.isMapNavigation=!1,this._evalMapNavigation())},_evalMapNavigation:function(){this.isMapNavigation?this.navigationManager.enableNavigation():this.navigationManager.disableNavigation()},
_evalNavigationFeature:function(a){if(this.isMapNavigation&&this["is"+a])this.navigationManager["enable"+a]();else this.navigationManager["disable"+a]()},enableDoubleClickZoom:function(){this.isDoubleClickZoom||(this.isDoubleClickZoom=!0,this._evalNavigationFeature("DoubleClickZoom"))},disableDoubleClickZoom:function(){this.isDoubleClickZoom&&(this.isDoubleClickZoom=!1,this._evalNavigationFeature("DoubleClickZoom"))},enableShiftDoubleClickZoom:function(){this.isShiftDoubleClickZoom||(L(this.declaredClass+
": Map.(enable/disable)ShiftDoubleClickZoom deprecated. Shift-Double-Click zoom behavior will not be supported.",null,"v2.0"),this.navigationManager.enableShiftDoubleClickZoom(),this.isShiftDoubleClickZoom=!0)},disableShiftDoubleClickZoom:function(){this.isShiftDoubleClickZoom&&(L(this.declaredClass+": Map.(enable/disable)ShiftDoubleClickZoom deprecated. Shift-Double-Click zoom behavior will not be supported.",null,"v2.0"),this.navigationManager.disableShiftDoubleClickZoom(),this.isShiftDoubleClickZoom=
!1)},enableClickRecenter:function(){this.isClickRecenter||(this.isClickRecenter=!0,this._evalNavigationFeature("ClickRecenter"))},disableClickRecenter:function(){this.isClickRecenter&&(this.isClickRecenter=!1,this._evalNavigationFeature("ClickRecenter"))},enablePan:function(){this.isPan||(this.isPan=!0,this._evalNavigationFeature("Pan"))},disablePan:function(){this.isPan&&(this.isPan=!1,this._evalNavigationFeature("Pan"))},enableRubberBandZoom:function(){this.isRubberBandZoom||(this.isRubberBandZoom=
!0,this._evalNavigationFeature("RubberBandZoom"))},disableRubberBandZoom:function(){this.isRubberBandZoom&&(this.isRubberBandZoom=!1,this._evalNavigationFeature("RubberBandZoom"))},enablePinchZoom:function(){this.isPinchZoom||(this.isPinchZoom=!0,this._evalNavigationFeature("PinchZoom"))},disablePinchZoom:function(){this.isPinchZoom&&(this.isPinchZoom=!1,this._evalNavigationFeature("PinchZoom"))},enableKeyboardNavigation:function(){this.isKeyboardNavigation||(this.isKeyboardNavigation=!0,this._evalNavigationFeature("KeyboardNavigation"))},
disableKeyboardNavigation:function(){this.isKeyboardNavigation&&(this.isKeyboardNavigation=!1,this._evalNavigationFeature("KeyboardNavigation"))},enableScrollWheel:function(){this.isScrollWheel||(this.isScrollWheel=!0,this._evalNavigationFeature("ScrollWheel"))},disableScrollWheel:function(){this.isScrollWheel&&(this.isScrollWheel=!1,this._evalNavigationFeature("ScrollWheel"))},enableScrollWheelZoom:function(){this.isScrollWheelZoom||(this.navigationManager.enableScrollWheelZoom(),this.isScrollWheelZoom=
!0)},disableScrollWheelZoom:function(){this.isScrollWheelZoom&&(this.navigationManager.disableScrollWheelZoom(),this.isScrollWheelZoom=!1)},enableScrollWheelPan:function(){this.isScrollWheelPan||this.navigationManager.enableScrollWheelPan()},disableScrollWheelPan:function(){this.isScrollWheelPan&&this.navigationManager.disableScrollWheelPan()},showPanArrows:function(){this._navDiv&&(this._navDiv.style.display="block",this.isPanArrows=!0)},hidePanArrows:function(){this._navDiv&&(this._navDiv.style.display=
"none",this.isPanArrows=!1)},showZoomSlider:function(){this._slider&&(J(this._slider.domNode||this._slider,"visibility","inherit"),this.isZoomSlider=!0)},hideZoomSlider:function(){this._slider&&(J(this._slider.domNode||this._slider,"visibility","hidden"),this.isZoomSlider=!1)}})})},"dijit/a11yclick":function(){define(["dojo/keys","dojo/mouse","dojo/on","dojo/touch"],function(r,l,d,q){function k(h){if((h.keyCode===r.ENTER||h.keyCode===r.SPACE)&&!/input|button|textarea/i.test(h.target.nodeName))for(h=
h.target;h;h=h.parentNode)if(h.dojoClick)return!0}var m;d(document,"keydown",function(h){k(h)?(m=h.target,h.preventDefault()):m=null});d(document,"keyup",function(h){k(h)&&h.target==m&&(m=null,d.emit(h.target,"click",{cancelable:!0,bubbles:!0,ctrlKey:h.ctrlKey,shiftKey:h.shiftKey,metaKey:h.metaKey,altKey:h.altKey,_origType:h.type}))});var p=function(h,e){h.dojoClick=!0;return d(h,"click",e)};p.click=p;p.press=function(h,e){var c=d(h,q.press,function(a){("mousedown"!=a.type||l.isLeft(a))&&e(a)}),b=
d(h,"keydown",function(a){a.keyCode!==r.ENTER&&a.keyCode!==r.SPACE||e(a)});return{remove:function(){c.remove();b.remove()}}};p.release=function(h,e){var c=d(h,q.release,function(a){("mouseup"!=a.type||l.isLeft(a))&&e(a)}),b=d(h,"keyup",function(a){a.keyCode!==r.ENTER&&a.keyCode!==r.SPACE||e(a)});return{remove:function(){c.remove();b.remove()}}};p.move=q.move;return p})},"dojo/touch":function(){define("./_base/kernel ./aspect ./dom ./dom-class ./_base/lang ./on ./has ./mouse ./domReady ./_base/window".split(" "),
function(r,l,d,q,k,m,p,h,e,c){function b(a,b,c){return n&&c?function(a,b){return m(a,c,b)}:f?function(c,f){var g=m(c,b,function(a){f.call(this,a);D=(new Date).getTime()}),n=m(c,a,function(a){(!D||(new Date).getTime()>D+1E3)&&f.call(this,a)});return{remove:function(){g.remove();n.remove()}}}:function(b,c){return m(b,a,c)}}function a(a){do if(void 0!==a.dojoClick)return a;while(a=a.parentNode)}function g(b,f,g){if(!h.isRight(b)){var n=a(b.target);if(x=!b.target.disabled&&n&&n.dojoClick)if(z=(w="useTarget"==
x)?n:b.target,w&&b.preventDefault(),A=b.changedTouches?b.changedTouches[0].pageX-c.global.pageXOffset:b.clientX,y=b.changedTouches?b.changedTouches[0].pageY-c.global.pageYOffset:b.clientY,B=("object"==typeof x?x.x:"number"==typeof x?x:0)||4,C=("object"==typeof x?x.y:"number"==typeof x?x:0)||4,!v){b=function(a){c.doc.addEventListener(a,function(b){var c=b.target;x&&!b._dojo_click&&(new Date).getTime()<=E+1E3&&("INPUT"!=c.tagName||!q.contains(c,"dijitOffScreen"))&&(b.stopPropagation(),b.stopImmediatePropagation&&
b.stopImmediatePropagation(),"click"==a&&("INPUT"!=c.tagName||"radio"==c.type&&(q.contains(c,"dijitCheckBoxInput")||q.contains(c,"mblRadioButton"))||"checkbox"==c.type&&(q.contains(c,"dijitCheckBoxInput")||q.contains(c,"mblCheckBox")))&&"TEXTAREA"!=c.tagName&&"AUDIO"!=c.tagName&&"VIDEO"!=c.tagName&&b.preventDefault())},!0)};var e=function(a){x=w?d.isDescendant(c.doc.elementFromPoint(a.changedTouches?a.changedTouches[0].pageX-c.global.pageXOffset:a.clientX,a.changedTouches?a.changedTouches[0].pageY-
c.global.pageYOffset:a.clientY),z):x&&(a.changedTouches?a.changedTouches[0].target:a.target)==z&&Math.abs((a.changedTouches?a.changedTouches[0].pageX-c.global.pageXOffset:a.clientX)-A)<=B&&Math.abs((a.changedTouches?a.changedTouches[0].pageY-c.global.pageYOffset:a.clientY)-y)<=C};v=!0;c.doc.addEventListener(f,function(a){h.isRight(a)||(e(a),w&&a.preventDefault())},!0);c.doc.addEventListener(g,function(a){if(!h.isRight(a)&&(e(a),x)){var b=function(b){var c=document.createEvent("MouseEvents");c._dojo_click=
!0;c.initMouseEvent(b,!0,!0,a.view,a.detail,f.screenX,f.screenY,f.clientX,f.clientY,a.ctrlKey,a.altKey,a.shiftKey,a.metaKey,0,null);return c};E=(new Date).getTime();var c=w?z:a.target;"LABEL"===c.tagName&&(c=d.byId(c.getAttribute("for"))||c);var f=a.changedTouches?a.changedTouches[0]:a,g=b("mousedown"),n=b("mouseup"),t=b("click");setTimeout(function(){m.emit(c,"mousedown",g);m.emit(c,"mouseup",n);m.emit(c,"click",t);E=(new Date).getTime()},0)}},!0);b("click");b("mousedown");b("mouseup")}}}var u=5>
p("ios"),n=p("pointer-events")||p("MSPointer"),t=function(){var a={},b;for(b in{down:1,move:1,up:1,cancel:1,over:1,out:1})a[b]=p("MSPointer")?"MSPointer"+b.charAt(0).toUpperCase()+b.slice(1):"pointer"+b;return a}(),f=p("touch-events"),v,x,w=!1,z,A,y,B,C,E,D,F;p("touch")&&(n?e(function(){c.doc.addEventListener(t.down,function(a){g(a,t.move,t.up)},!0)}):e(function(){function a(a){var b=k.delegate(a,{bubbles:!0});6<=p("ios")&&(b.touches=a.touches,b.altKey=a.altKey,b.changedTouches=a.changedTouches,b.ctrlKey=
a.ctrlKey,b.metaKey=a.metaKey,b.shiftKey=a.shiftKey,b.targetTouches=a.targetTouches);return b}F=c.body();c.doc.addEventListener("touchstart",function(a){D=(new Date).getTime();var b=F;F=a.target;m.emit(b,"dojotouchout",{relatedTarget:F,bubbles:!0});m.emit(F,"dojotouchover",{relatedTarget:b,bubbles:!0});g(a,"touchmove","touchend")},!0);m(c.doc,"touchmove",function(b){D=(new Date).getTime();var f=c.doc.elementFromPoint(b.pageX-(u?0:c.global.pageXOffset),b.pageY-(u?0:c.global.pageYOffset));f&&(F!==f&&
(m.emit(F,"dojotouchout",{relatedTarget:f,bubbles:!0}),m.emit(f,"dojotouchover",{relatedTarget:F,bubbles:!0}),F=f),m.emit(f,"dojotouchmove",a(b))||b.preventDefault())});m(c.doc,"touchend",function(b){D=(new Date).getTime();var f=c.doc.elementFromPoint(b.pageX-(u?0:c.global.pageXOffset),b.pageY-(u?0:c.global.pageYOffset))||c.body();m.emit(f,"dojotouchend",a(b))})}));l={press:b("mousedown","touchstart",t.down),move:b("mousemove","dojotouchmove",t.move),release:b("mouseup","dojotouchend",t.up),cancel:b(h.leave,
"touchcancel",n?t.cancel:null),over:b("mouseover","dojotouchover",t.over),out:b("mouseout","dojotouchout",t.out),enter:h._eventHandler(b("mouseover","dojotouchover",t.over)),leave:h._eventHandler(b("mouseout","dojotouchout",t.out))};return r.touch=l})},"dijit/registry":function(){define(["dojo/_base/array","dojo/_base/window","./main"],function(r,l,d){var q={},k={},m={length:0,add:function(d){if(k[d.id])throw Error("Tried to register widget with id\x3d\x3d"+d.id+" but that id is already registered");
k[d.id]=d;this.length++},remove:function(d){k[d]&&(delete k[d],this.length--)},byId:function(d){return"string"==typeof d?k[d]:d},byNode:function(d){return k[d.getAttribute("widgetId")]},toArray:function(){var d=[],h;for(h in k)d.push(k[h]);return d},getUniqueId:function(p){var h;do h=p+"_"+(p in q?++q[p]:q[p]=0);while(k[h]);return"dijit"==d._scopeName?h:d._scopeName+"_"+h},findWidgets:function(d,h){function e(b){for(b=b.firstChild;b;b=b.nextSibling)if(1==b.nodeType){var a=b.getAttribute("widgetId");
a?(a=k[a])&&c.push(a):b!==h&&e(b)}}var c=[];e(d);return c},_destroyAll:function(){d._curFocus=null;d._prevFocus=null;d._activeStack=[];r.forEach(m.findWidgets(l.body()),function(d){d._destroyed||(d.destroyRecursive?d.destroyRecursive():d.destroy&&d.destroy())})},getEnclosingWidget:function(d){for(;d;){var h=1==d.nodeType&&d.getAttribute("widgetId");if(h)return k[h];d=d.parentNode}return null},_hash:k};return d.registry=m})},"dijit/main":function(){define(["dojo/_base/kernel"],function(r){return r.dijit})},
"esri/_coremap":function(){define("require module dojo/_base/kernel dojo/_base/declare dojo/_base/connect dojo/_base/Deferred dojo/_base/lang dojo/_base/array dojo/_base/event dojo/_base/unload dojo/dom dojo/dom-attr dojo/dom-class dojo/dom-construct dojo/dom-geometry dojo/dom-style dojo/sniff dijit/registry dojox/gfx/matrix ./kernel ./config ./basemaps ./lang ./Evented ./fx ./deferredUtils ./tileUtils ./urlUtils ./PluginTarget ./Color ./arcade/Dictionary ./geometry/Point ./geometry/ScreenPoint ./geometry/Extent ./geometry/Rect ./geometry/mathUtils ./geometry/scaleUtils ./geometry/screenUtils ./geometry/webMercatorUtils ./layers/GraphicsLayer ./layers/TileInfo ./layers/LOD ./layers/ArcGISTiledMapServiceLayer ./layers/MapImageLayer ./layers/OpenStreetMapLayer ./layers/VectorTileLayer ./dijit/Popup ./plugins/popupManager dojo/uacss".split(" "),
function(r,l,d,q,k,m,p,h,e,c,b,a,g,u,n,t,f,v,x,w,z,A,y,B,C,E,D,F,G,J,N,M,L,K,W,R,ba,O,Q,U,ia,Y,ca,H,ea,va,la){function ma(a,b){var c=a.lods;c.sort(function(a,b){return a.scale>b.scale?-1:a.scale<b.scale?1:0});var f=[],c=h.filter(c,function(a){if(-1===Ea(f,a.scale))return f.push(a.scale),!0}),g=b.lods=[],n;h.forEach(c,function(a,b){n=g[b]=new Y(a);n.level=b});b.tileInfo=new ia(za(a,{lods:g}))}var sa,ka=O.toMapPoint,ta=O.toScreenPoint,ua=k.connect,qa=k.disconnect,da=p.hitch,Aa=t.set,Ea=h.indexOf,za=
p.mixin,ra=0,oa=z.defaults.map,Fa=oa.layerNamePrefix,Ma=oa.graphicsLayerNamePrefix,Ja=new RegExp("^"+Fa+"(\\d+)$"),Ga=new RegExp("^"+Ma+"(\\d+)$"),Ca=function(){};return q([B,G],{declaredClass:"esri._CoreMap",resizeDelay:300,invalidExtent:"Map does not have a valid extent.",invalidGeometry:"Geometry (wkid: ${geometry}) cannot be converted to spatial reference of the map (wkid: ${map})",unknownBasemap:'Unable to find basemap definition for: "${basemapName}". Try one of these: ${list}',invalidBasemap:'Unable to add basemap: "${basemapName}".',
unknownLayerType:'Unknown basemap layer type: "${type}" found in basemap definition for: "${basemapName}".',visible:!0,_eventMap:{"basemap-change":!0,"extent-change":["extent","delta","levelChange","lod"],"layer-add":["layer"],"layer-add-result":["layer","error"],"layer-remove":["layer"],"layer-reorder":["layer","index"],"layer-resume":["layer"],"layer-suspend":["layer"],"layers-add-result":["layers"],"layers-removed":!0,"layers-reordered":["layerIds"],load:["map"],pan:["extent","delta"],"pan-end":["extent",
"delta"],"pan-start":["extent","screenPoint"],reposition:["x","y"],resize:["extent","width","height"],scale:["matrix","immediate"],"time-extent-change":["timeExtent"],"before-unload":["map"],unload:["map"],"update-end":["error"],"update-start":!0,zoom:["extent","zoomFactor","anchor"],"zoom-end":["extent","zoomFactor","anchor","level"],"zoom-start":["extent","zoomFactor","anchor","level"],click:!0,"dbl-click":!0,"key-down":!0,"key-up":!0,"mouse-down":!0,"mouse-drag":!0,"mouse-drag-end":!0,"mouse-drag-start":!0,
"mouse-move":!0,"mouse-out":!0,"mouse-over":!0,"mouse-up":!0,"mouse-wheel":!0,"basic-tap":!0,"double-tap":!0,"pinch-end":!0,"pinch-move":!0,"pinch-start":!0,"processed-double-tap":!0,"processed-tap":!0,"swipe-end":!0,"swipe-move":!0,"swipe-start":!0,tap:!0,"two-finger-tap":!0},constructor:function(f,e){var h=this;this.registerConnectEvents();za(this,{_internalLayerIds:[],_layers:[],_layerDivs:[],_layerSize:0,_connects:[],_zoomAnimDiv:null,_zoomAnim:null,_layersDiv:null,_firstLayerId:null,_delta:null,
_cursor:null,_ratioW:1,_ratioH:1,_params:null,_minResolution:0,_maxResolution:0,cursor:null,layerIds:[],graphicsLayerIds:[],graphics:null,_labels:null,loaded:!1,__panning:!1,__zooming:!1,__container:null,root:null,__LOD:null,__tileInfo:null,__visibleRect:null,__visibleDelta:null,_rids:[]});var t=this.container=b.byId(f),d=this.id=a.get(t,"id")||v.getUniqueId(this.declaredClass);g.add(t,"map");var x=n.getContentBox(t),w=g.add,p=u.create;this.position=new L(0,0);this._reposition();var m=this.width=
0<x.w?x.w:oa.width,k=this.height=0<x.h?x.h:oa.height,l=this.root=p("div",{id:d+"_root",style:{width:m+"px",height:k+"px",direction:"ltr"}});w(l,"esriMapContainer");x=this.__container=p("div",{id:d+"_container"},l);Aa(x,"position","absolute");w(x,"esriMapContainer");t.appendChild(l);t=this._params=za({slider:!0,nav:!1,zoom:-1,minZoom:-1,maxZoom:-1,scale:-1,minScale:0,maxScale:0,showInfoWindowOnClick:!0,displayGraphicsOnPan:!0,wrapAround180:!0,fitExtent:!1,optimizePanAnimation:!0},e||{});this.wrapAround180=
t.wrapAround180;this.optimizePanAnimation=t.optimizePanAnimation;this.setBackgroundColor(t.backgroundColor);y.isDefined(t.resizeDelay)&&(this.resizeDelay=t.resizeDelay);t.lods&&(ma({rows:512,cols:512,dpi:96,format:"JPEG",compressionQuality:75,origin:{x:-180,y:90},spatialReference:{wkid:4326},lods:t.lods},t),this.__tileInfo=t.tileInfo);this.extent=t.extent;this._extentUtil({mapCenter:t.center,targetLevel:t.zoom,targetScale:t.scale});this.__visibleRect=new W(0,0,m,k);this.__visibleDelta=new W(0,0,m,
k);d=this._layersDiv=p("div",{id:d+"_layers"});w(d,"esriMapLayers");x.appendChild(d);this._zoomAnimDiv=p("div",{style:{position:"absolute"}});t.infoWindow?this.infoWindow=t.infoWindow:(w=this.infoWindow=new la(t.popupOptions,p("div")),w.startup(),w._ootb=!0,Aa(w.domNode,"zIndex",40));t.showLabels&&(r(["./layers/LabelLayer"],function(a){sa=a;h._createLabelLayer()}),this.on("load",function(){h._createLabelLayer()}));this.addPlugin(this._getAbsMid("./plugins/popupManager"),{enabled:t.showInfoWindowOnClick});
this._zoomStartHandler=da(this,this._zoomStartHandler);this._zoomingHandler=da(this,this._zoomingHandler);this._zoomEndHandler=da(this,this._zoomEndHandler);this._panningHandler=da(this,this._panningHandler);this._panEndHandler=da(this,this._panEndHandler);this._endTranslate=da(this,this._endTranslate);this._timedResize=da(this,this._timedResize);this._execResize=da(this,this._execResize);this._processLabelLayers=da(this,this._processLabelLayers);this._updateLabelLayers=da(this,this._updateLabelLayers);
this.resize=da(this,this.resize);c.addOnWindowUnload(this,this.destroy)},_getAbsMid:function(a){return r.toAbsMid?r.toAbsMid(a):l.id.replace(/\/[^\/]*$/ig,"/")+a},_cleanUp:function(){var a=this.infoWindow;a&&(a._ootb&&a.destroy?a.destroy():a.unsetMap(this),delete this.infoWindow);qa(this._tsTimeExtentChange_connect);this.removePlugin("./plugins/popupManager");u.destroy(this.root);this.root=null},_addLayer:function(a,b,c){if(a.id){var f=a.id.match(a instanceof U?Ga:Ja);f&&f[1]&&(f=Number(f[1]),ra<=
f&&(ra=f+1))}var g=a.id||(a instanceof U?Ma:Fa)+ra++;a.id=g;this._layers[g]=a;var n,e;if(b===this.layerIds||b===this.graphicsLayerIds)n=this._layerSize,this._layerSize++;a._isRefLayer="top"===c;c=!y.isDefined(c)||0>c||c>b.length||"top"===c?b.length:c;0===n&&(this._firstLayerId=g);if(!a._isRefLayer)for(;(e=this.getLayer(b[c-1]))&&e._isRefLayer;)c--;b.splice(c,0,g);var h=da(this,this._addLayerHandler),t=this;c=this._connects;f=function(){a.loaded?t._onLoadFix?(t._onLoadFix=!1,setTimeout(function(){h(a)},
0)):h(a):(t["_"+g+"_addtoken_load"]=ua(a,"onLoad",t,"_addLayerHandler"),t["_"+g+"_addtoken_err"]=ua(a,"onError",t,function(c){h(a,c,b)}))};this.loaded||0===n||a.loaded&&-1===Ea(this.graphicsLayerIds,g)?f():c.push(ua(this,"onLoad",f));return a},_addLayerHandler:function(a,b,c){var f=this.id,g=a.id,n=Ea(a instanceof U?this.graphicsLayerIds:this.layerIds,g),e=n,h=!1,t=this._params;qa(this["_"+g+"_addtoken_load"]);qa(this["_"+g+"_addtoken_err"]);if(b)delete this._layers[g],-1!==n&&(c.splice(n,1),this.onLayerAddResult(a,
b));else{-1===n&&(n=Ea(this._internalLayerIds,g),e=20+n,h=!0);if(g===this._firstLayerId){b=a.spatialReference;c=this.extent&&this.extent.spatialReference;!c||c.equals(b)||!a.tileInfo&&a.url||(c=null);c=this.spatialReference=c||b;this.wrapAround180=this.wrapAround180&&c&&c._isWrappable()?!0:!1;a.tileInfo&&(this.__tileInfo?(b=this.__tileInfo.lods,this.__tileInfo=za({},a.tileInfo),this.__tileInfo.lods=b):(ma(za({},a.tileInfo),t),this.__tileInfo=t.tileInfo));if(this.wrapAround180){b=this.__tileInfo;c=
c._getInfo();if(!b||Math.abs(c.origin[0]-b.origin.x)>c.dx)this.wrapAround180=!1;this.wrapAround180&&b&&D._addFrameInfo(b,c)}t.units=a.units;if((b=this.__tileInfo&&this.__tileInfo.lods)&&b.length){c=t.minScale;var n=t.maxScale,u=-1,d=-1,v=!1,x=!1,w;for(w=0;w<b.length;w++)0<c&&!v&&c>=b[w].scale&&(u=b[w].level,v=!0),0<n&&!x&&n>=b[w].scale&&(d=0<w?b[w-1].level:-1,x=!0);-1===t.minZoom&&(t.minZoom=0===c?b[0].level:u);-1===t.maxZoom&&(t.maxZoom=0===n?b[b.length-1].level:d);for(w=0;w<b.length;w++)t.minZoom===
b[w].level&&(t.minScale=b[w].scale,this._minResolution=b[w].resolution),t.maxZoom===b[w].level&&(t.maxScale=b[w].scale,this._maxResolution=b[w].resolution)}else t.minZoom=t.maxZoom=t.zoom=-1}a instanceof U?(this._gc||(this._gc=new U._GraphicsContainer,this._gc._setMap(this,this._layersDiv).id=f+"_gc"),e=a._setMap(this,this._gc._surface),e.id=f+"_"+g,this._layerDivs[g]=e,this._reorderLayers(this.graphicsLayerIds)):(e=a._setMap(this,this._layersDiv,e,this.__LOD),e.id=f+"_"+g,this._layerDivs[g]=e,this._reorderLayers(this.layerIds),
h||-1===a.declaredClass.indexOf("VETiledLayer")||this._onBingLayerAdd(a));g===this._firstLayerId&&(this.graphics=new U({id:f+"_graphics",displayOnPan:t.displayGraphicsOnPan}),this._addLayer(this.graphics,this._internalLayerIds,20));if(a===this.graphics){c=this._layers[this._firstLayerId];f=t.zoom;e=t.scale;b=t.center;c=c.initialExtent||c.fullExtent;this._firstLayerId=null;this.extent&&(this.extent=this._convertGeometry(this,this.extent));!this.extent&&c&&(b&&(b=this._convertGeometry(c,b)),b&&(c=c.centerAt(b),
b=null));if(b=this.extent||c&&new K(c.toJson()))-1<f?b=this.__getExtentForLevel(f,null,b).extent:0<e&&(b=ba.getExtentForScale(this,e,b));if(!b){console.log("Map: "+this.invalidExtent);return}t=this._fixExtent(b,t.fitExtent);this.extent=t.extent;this.__LOD=t.lod;this.__setExtent(this.extent);this.loaded=!0;this.attr("data-loaded","");this.infoWindow.setMap(this);this.onLoad(this)}h||(this.onLayerAdd(a),this.onLayerAddResult(a));qa(this[g+"_addLayerHandler_connect"])}},_convertGeometry:function(a,b){var c=
a&&a.spatialReference,f=b&&b.spatialReference;c&&f&&!c.equals(f)&&(c._canProject(f)?c.isWebMercator()?b=Q.geographicToWebMercator(b):4326===c.wkid&&(b=Q.webMercatorToGeographic(b,!0)):(console.log("Map: "+y.substitute({geometry:f.wkid||f.wkt,map:c.wkid||c.wkt},this.invalidGeometry)),b=null));return b},_reorderLayers:function(a){var b=this.onLayerReorder,c=u.place,g=this._layerDivs,n=this._layers,e=this._gc?this._gc._surface.getEventSource():null;if(a===this.graphicsLayerIds)h.forEach(a,function(a,
f){var h=g[a];h&&(c(h.getEventSource(),e,f),b(n[a],f))});else{var t=this.graphics,d=t?t.id:null,v=this._layersDiv,x;h.forEach(a,function(a,f){x=g[a];a!==d&&x&&(c(x,v,f),b(n[a],f))});this._mapImageLyr&&this._placeMapImageLyr();e&&(e=9>f("ie")?e.parentNode:e,c(e,e.parentNode,a.length))}this.onLayersReordered([].concat(a))},_zoomStartHandler:function(){this.__zoomStart(this._zoomAnimDiv.startingExtent,this._zoomAnimDiv.anchor)},_zoomingHandler:function(a){var b=parseFloat(a.left),c=parseFloat(a.top);
a=new K(b,c-parseFloat(a.height),b+parseFloat(a.width),c,this.spatialReference);b=this.extent.getWidth()/a.getWidth();this.__zoom(a,b,this._zoomAnimDiv.anchor)},_zoomEndHandler:function(){var a=this._zoomAnimDiv,b=a.extent,c=this.extent.getWidth()/b.getWidth(),f=a.anchor,g=a.newLod,n=a.levelChange;a.extent=a.anchor=a.levelChange=a.startingExtent=a.newLod=this._delta=this._zoomAnim=null;this.__zoomEnd(b,c,f,g,n)},_panningHandler:function(a){if(isNaN(parseFloat(a.left))||isNaN(parseFloat(a.top))){var b=
Math.round,c=this._panAnim.node;a.left=-1*(this._delta.x-b(this.width/2))+"px";a.top=-1*(this._delta.y-b(this.height/2))+"px";t.set(c,"left",a.left);t.set(c,"top",a.top)}a=new L(parseFloat(a.left),parseFloat(a.top));b=this.toMap(a);this.onPan(this.extent.offset(this.extent.xmin-b.x,this.extent.ymax-b.y),a)},_panEndHandler:function(a){this.__panning=!1;var b=Math.round;a=new L(-b(parseFloat(a.style.left)),-b(parseFloat(a.style.top)));var b=a.x,c=a.y,f=this.__visibleRect,g=this.__visibleDelta;f.x+=
-b;f.y+=-c;g.x+=-b;g.y+=-c;Aa(this._zoomAnimDiv,{left:"0px",top:"0px"});var f=this.extent,g=this._ratioW,n=this._ratioH,f=new K(f.xmin+b/g,f.ymin-c/n,f.xmax+b/g,f.ymax-c/n,this.spatialReference);a.setX(-a.x);a.setY(-a.y);this._delta=this._panAnim=null;this._updateExtent(f);this.onPanEnd(f,a);this._fireExtChg([f,a,!1,this.__LOD])},_fixExtent:function(a,b){for(var c=this._reshapeExtent(a),f=1.25;!0===b&&(c.extent.getWidth()<a.getWidth()||c.extent.getHeight()<a.getHeight())&&0<c.lod.level&&3>=f;)c=this._reshapeExtent(a.expand(f)),
f+=.25;return c},_getFrameWidth:function(){var a=-1,b=this.spatialReference._getInfo();this.__LOD?(b=this.__LOD._frameInfo)&&(a=b[3]):b&&(a=Math.round(2*b.valid[1]/(this.extent.getWidth()/this.width)));return a},_fixAspectRatio:function(a){var b=a.getWidth(),c=a.getHeight(),f=b/c,g=this.width/this.height,n=0,e=0;this.width>this.height?b>c?g>f?n=c*g-b:e=b/g-c:n=c*g-b:this.width<this.height?b<c?g>f?n=c*g-b:e=b/g-c:e=b/g-c:b<c?n=c-b:b>c&&(e=b/g-c);n&&(a.xmin-=n/2,a.xmax+=n/2);e&&(a.ymin-=e/2,a.ymax+=
e/2);return a},_reshapeExtent:function(a){a=this._fixAspectRatio(a);return this._getAdjustedExtent(a)},_getAdjustedExtent:function(a){if(this.__tileInfo)return D.getCandidateTileInfo(this,this.__tileInfo,a);var b=ba.getScale(this,a),c=this.getMinScale(),f=this.getMaxScale();!c||b<=c?!f||b>=f||(a=ba.getExtentForScale(this,f,a)):a=ba.getExtentForScale(this,c,a);return{extent:a}},_onBingLayerAdd:function(a){this["__"+a.id+"_vis_connect"]=k.connect(a,"onVisibilityChange",this,"_toggleBingLogo");this._toggleBingLogo(a.visible)},
_onBingLayerRemove:function(a){k.disconnect(this["__"+a.id+"_vis_connect"]);delete this["__"+a.id+"_vis_connect"];var b=h.some(this.layerIds,function(b){return(a=this._layers[b])&&a.visible&&-1!==a.declaredClass.indexOf("VETiledLayer")},this);this._toggleBingLogo(b)},_toggleBingLogo:function(a){a&&!this._bingLogo?(a={left:this._mapParams&&this._mapParams.nav?"25px":""},6===f("ie")&&(a.filter="progid:DXImageTransform.Microsoft.AlphaImageLoader(enabled\x3d'true', sizingMethod\x3d'crop', src\x3d'"+r.toUrl("./images/map/bing-logo-lg.png")+
"')"),a=this._bingLogo=u.create("div",{style:a},this.root),g.add(a,"bingLogo-lg")):!a&&this._bingLogo&&(u.destroy(this._bingLogo),delete this._bingLogo)},__panStart:function(a,b){var c=this._zoomAnim,f=this._panAnim;if(c&&c._active)c.stop(),c._fire("onEnd",[c.node]);else if(f&&f._active){f.stop();this._panAnim=null;var f=f.curve.getValue(f._getStep()),c=Math.round(parseFloat(f.left)),f=Math.round(parseFloat(f.top)),g=this.navigationManager._dragOrigin;this.__pan(c,f);g&&(g.x-=c,g.y-=f);return}this.__panning=
!0;this.onPanStart(this.extent,new L(a,b))},__pan:function(a,b){var c=this.extent,f=this._ratioW,g=this._ratioH;this.onPan(new K(c.xmin-a/f,c.ymin+b/g,c.xmax-a/f,c.ymax+b/g,this.spatialReference),new L(a,b))},__panEnd:function(a,b){var c=this.__visibleRect,f=this.__visibleDelta;c.x+=a;c.y+=b;f.x+=a;f.y+=b;var c=new L(a,b),f=this.extent,g=this._ratioW,n=this._ratioH,f=new K(f.xmin-a/g,f.ymin+b/n,f.xmax-a/g,f.ymax+b/n,this.spatialReference);this.__panning=!1;this._updateExtent(f);this.onPanEnd(f,c);
this._fireExtChg([f,c,!1,this.__LOD])},__zoomStart:function(a,b){this.__zooming=!0;this.onZoomStart(a,1,b,this.__LOD?this.__LOD.level:null)},__zoom:function(a,b,c){this.onZoom(a,b,c)},__zoomEnd:function(a,b,c,f,g){Aa(this._layersDiv,{left:"0px",top:"0px"});this._delta=new L(0,0);this.__visibleRect.x=this.__visibleRect.y=0;a=new K(a);this.__LOD=f;this._ratioW=this.width/a.getWidth();this._ratioH=this.height/a.getHeight();var n=this._delta;this._delta=null;this.__zooming=!1;this._updateExtent(a,g);
this.onZoomEnd(a,b,c,f?f.level:null);this._fireExtChg([a,n,g,f])},_extentUtil:function(a,b,c,f,g){var n=new m,e,h,t,u,d,v,x,w,k,l,q=this.width,z=this.height,A,B,D;a&&(e=a.numLevels,h=a.targetLevel,A=y.isDefined(h),t=a.factor,u=a.mapAnchor,d=a.screenAnchor,v=a.mapCenter,B=a.levelOrFactor,x=a.targetScale,w=y.isDefined(x)&&0<x);b&&(k=b.dx,l=b.dy,v=b.mapCenter);p.isArray(v)&&(v=new M(v));var C=this._panAnim;b=(a=this._stopAnim())?a.divExtent:this.extent;var E=this.__tileInfo,G=this._params;if(!this.loaded){if(c)b&&
(c=this._convertGeometry(b,c)),c&&(this.extent=c,G.zoom=G.scale=-1,G.center=null);else if(v||A||w){if(v)if(b){if(v=this._convertGeometry(b,v))this.extent=b.centerAt(v),G.center=null}else G.center=v;A&&-1<h?(G.zoom=h,G.scale=-1):w&&(G.scale=x,G.zoom=-1)}n.resolve();return n}if(v&&(v=this._convertGeometry(this,v),!v)||u&&(u=this._convertGeometry(this,u),!u)||c&&(c=this._convertGeometry(this,c),!c))return n.reject(),n;C&&u&&d&&(u=ka(this.extent,q,z,d));a&&u&&d&&(u=ka(a.divExtent,q,z,d));A&&(E?(e=this.getMinZoom(),
A=this.getMaxZoom(),h<e?h=e:h>A&&(h=A),e=h-(a?a.level:this.getLevel())):(e=0<h?-1:1,D=B?h:null));if(!c)if(y.isDefined(e))E?(q=a?a.level:this.getLevel(),q=this.__getExtentForLevel(q+e,v,b).extent):(q=(a?a.end:this.extent).expand(D||(0<e?.5*e:2*-e)),D&&v&&(q=q.centerAt(v))),q&&(v?c=q:(k=u||b.getCenter(),z=q.getWidth(),l=q.getHeight(),q=k.x>=b.xmin&&k.x<=b.xmax?(k.x-b.xmin)/b.getWidth():.5,c=k.y>=b.ymin&&k.y<=b.ymax?(k.y-b.ymin)/b.getHeight():.5,q=k.x-q*z,k=k.y-c*l,c=new K(q,k,q+z,k+l,this.spatialReference)));
else if(w)c=ba.getExtentForScale(this,x,b);else if(y.isDefined(t))c=b.expand(t);else if(k||l)a?(c=a.end,u=c.getCenter(),D=ta(c,q,z,u),D.x+=k,D.y+=l,D=ka(c,q,z,D),c=c.offset(D.x-u.x,D.y-u.y)):(k=new L(q/2+k,z/2+l),k=ka(b,q,z,k),z=b.getWidth(),l=b.getHeight(),q=k.x-z/2,k=k.y-l/2,c=new K(q,k,q+z,k+l,this.spatialReference));c||(v?(b=a?a.end:b,z=b.getWidth(),l=b.getHeight(),q=v.x-z/2,k=v.y-l/2,c=new K(q,k,q+z,k+l,this.spatialReference)):a&&(c=a.end));c?(this._extentDfd&&-1===this._extentDfd.fired&&(this._extentDfd.then(null,
Ca),this._extentDfd.reject()),this._extentDfd=n,this.__setExtent(c,null,d,f,a,g)):n.reject();return n},__setExtent:function(a,b,c,f,g,n){try{if(this._firstLayerId)this.extent=a;else{var e=!0,h=this.spatialReference,t=g?g.divExtent:this.extent,u=this._fixExtent(a,f||!1);a=u.extent;var d=a.getWidth(),v=a.getHeight(),x=Math.round;if(t)var w=x(1E6*t.getWidth()),p=x(1E6*d),m=x(1E6*t.getHeight()),k=x(1E6*v),e=w!==p||m!==k;var l,q,z=g&&g.rect,A=g&&g.divExtent;if(oa.zoomDuration&&e&&t){A=A||new K(t);z=z||
{left:t.xmin,top:t.ymax,width:t.getWidth(),height:t.getHeight()};q={left:a.xmin,top:a.ymax,width:d,height:v};var y=new M(a.xmin,a.ymax,h),B=new M(a.xmin,a.ymin,h),D=new M(this.extent.xmin,this.extent.ymax,h),E=new M(this.extent.xmin,this.extent.ymin,h);(l=R.getLineIntersection(D,y,E,B,h))||g||(e=!1)}this._ratioW=this.width/d;this._ratioH=this.height/v;var G=this._zoomAnimDiv;if(e)if(Aa(this._layersDiv,{left:"0px",top:"0px"}),b=new L(0,0),this.__visibleRect.x=this.__visibleRect.y=0,z&&q){this._delta=
b;G.id="_zAD";G.startingExtent=A;G.extent=a;G.levelChange=e;G.newLod=u.lod;G.anchor=c?c:!l&&g?g.anchor:ta(this.extent,this.width,this.height,l);var r=this.extent.getWidth()/a.getWidth();1024<(1>r?1/r:r)?(this.__zoomStart(A,G.anchor),this.__zoom(A,1,G.anchor),this._fireOnScale(1,G.anchor,!0),this.__zoomEnd(a,r,G.anchor,u.lod,e)):(this._zoomAnim=C.resize({node:G,start:z,end:q,duration:oa.zoomDuration,rate:oa.zoomRate,beforeBegin:g?null:this._zoomStartHandler,onAnimate:this._zoomingHandler,onEnd:this._zoomEndHandler}).play(),
this._fireOnScale(r,G.anchor,n))}else this._updateExtent(a,e,n),this._fireExtChg([this.extent,b,e,this.__LOD=u.lod]);else if(!this.__panning)if(!1===this.loaded||n)this._updateExtent(a,e,n),this._fireExtChg([this.extent,b,e,this.__LOD=u.lod]);else{this.__panning=!0;z=(new W(0,0,this.width,this.height,this.spatialReference)).getCenter();z.x=x(z.x);z.y=x(z.y);var F=this._delta=this.toScreen(a.getCenter()),J=Math.abs(z.x-F.x),N=Math.abs(z.y-F.y);this.optimizePanAnimation&&(J>2*this.width||N>2*this.height)?
(this.__panStart(0,0),this.__pan(0,0),this.__visibleRect.x=this.__visibleRect.y=this.__visibleDelta.x=this.__visibleDelta.y=0,this.__panning=!1,this._delta=null,this._updateExtent(a,!1,n),this.onPanEnd(this.extent,new L(0,0)),this._fireExtChg([this.extent,new L(0,0),!0,this.__LOD])):(this.onPanStart(this.extent,new L(0,0)),this._panAnim=C.slideTo({node:G,left:z.x-F.x,top:z.y-F.y,duration:oa.panDuration,rate:oa.panRate,onAnimate:this._panningHandler,onEnd:this._panEndHandler}),this._panAnim.play())}}}catch(lb){console.log(lb.stack),
console.error(lb)}},_fireOnScale:function(a,b,c){if("css-transforms"===this.navigationMode){var f=this.__visibleDelta;this.onScale(x.scaleAt(a,{x:-1*(this.width/2-(b.x-f.x)),y:-1*(this.height/2-(b.y-f.y))}),c)}},_stopAnim:function(){var a=this._zoomAnim,b=this._panAnim;if(a&&a._active){a.stop();var b=a.curve.getValue(a._getStep()),c=parseFloat(b.left),f=parseFloat(b.top),a=a.node;return{anchor:a.anchor,start:a.startingExtent,end:a.extent,level:a.newLod&&a.newLod.level,rect:b,divExtent:new K(c,f-parseFloat(b.height),
c+parseFloat(b.width),f,this.spatialReference)}}b&&b._active&&(b.stop(),b._fire("onEnd",[b.node]))},__getExtentForLevel:function(a,b,c){var f=this.__tileInfo,f=f&&f.lods;a=y.isDefined(a)?a:0;c=c||this.extent;b=b||c&&c.getCenter();if(f){if(b){c=this.getMinZoom();var g=this.getMaxZoom();a>g&&(a=g);a<c&&(a=c);a=f[a];f=this.width*a.resolution/2;c=this.height*a.resolution/2;return{extent:new K(b.x-f,b.y-c,b.x+f,b.y+c,b.spatialReference),lod:a}}}else if(c)return{extent:c.expand(!a||1>a?1:a).centerAt(b)};
console.log("Map: "+this.invalidExtent)},_jobs:0,_incr:function(){1===++this._jobs&&(this.updating=!0,this.attr("data-updating",""),this.onUpdateStart())},_decr:function(){var a=--this._jobs;a?0>a&&(this._jobs=0):(this.updating=!1,this.attr("data-updating"),this.onUpdateEnd())},_fireEvent:function(a,b){this[a]&&this[a].apply(this,b)},_updateExtent:function(a,b,c){this.extent=a;a=this.spatialReference;this._viewInfo={view:new N({viewingMode:"map",scale:this.getScale()}),sr:a};(b||c)&&this._setClipRect();
this._calcGeographicExtent()},_calcGeographicExtent:function(){var a=this.spatialReference;a&&(a.isWebMercator()?this.geographicExtent=Q.webMercatorToGeographic(this._getAvailExtent(),!0):4326===a.wkid&&(this.geographicExtent=new K(this._getAvailExtent().toJson())))},_fireExtChg:function(a){this.attr("data-zoom",this.getZoom());this.attr("data-scale",this.getScale());this._fireEvent("onExtentChange",a);if(a=this._extentDfd)delete this._extentDfd,a.resolve()},attr:function(a,b){var c=this.container;
c&&(null==b?c.removeAttribute(a):c.setAttribute(a,b));return this},onUpdateStart:function(){},onUpdateEnd:function(){},onLoad:function(){this._setClipRect();this._calcGeographicExtent()},onBeforeUnload:function(){},onUnload:function(){},onExtentChange:function(a,b,c){},onTimeExtentChange:function(){},onLayerAdd:function(){},onLayerAddResult:function(){},onLayersAddResult:function(){},onLayerRemove:function(){},onLayersRemoved:function(){},onLayerReorder:function(){},onLayersReordered:function(){},
onLayerSuspend:function(){},onLayerResume:function(){},onPanStart:function(){},onPan:function(){},onPanEnd:function(){},onScale:function(){},onZoomStart:function(){},onZoom:function(){},onZoomEnd:function(){},onResize:function(){this._setClipRect()},onReposition:function(){},destroy:function(){this._destroyed||(this.onBeforeUnload(this),this.removeAllLayers(),this._cleanUp(),clearTimeout(this._resizeT),this._gc&&this._gc._cleanUp(),this._destroyed=!0,this.onUnload(this))},setCursor:function(a){Aa(this.__container,
"cursor",this.cursor=a)},setMapCursor:function(a){this.setCursor(this._cursor=a)},resetMapCursor:function(){this.setCursor(this._cursor)},setBackgroundColor:function(a){a&&!a.declaredClass&&(a=new J(a));this.backgroundColor=a||null;var b="";a&&(b=9>f("ie")?a.toHex():"rgba("+a.toRgba().join(",")+")");t.set(this.root,{backgroundColor:b})},setInfoWindow:function(a){var b=this.infoWindow;b&&b.unsetMap(this);this.infoWindow=a;this.loaded&&a&&a.setMap(this)},setInfoWindowOnClick:function(a){this._params.showInfoWindowOnClick=
a;this.popupManager&&this.popupManager.set("enabled",a)},getInfoWindowAnchor:function(a){return this.infoWindow&&this.infoWindow._getAnchor&&this.infoWindow._getAnchor(a)||"upperright"},toScreen:function(a,b){return ta(this.extent,this.width,this.height,a,b)},toMap:function(a){return ka(this.extent,this.width,this.height,a)},addLayer:function(a,b){a&&!this.getLayer(a.id)&&this._addLayer(a,a instanceof U?this.graphicsLayerIds:this.layerIds,b);return a},addLayers:function(a){var b=[],c=a.length,f,g,
n=a.length;f=k.connect(this,"onLayerAddResult",function(g,n){-1!==h.indexOf(a,g)&&(c--,b.push({layer:g,success:!n,error:n}),c||(k.disconnect(f),this.onLayersAddResult(b)))});for(g=0;g<n;g++)this.addLayer(a[g]);return this},removeLayer:function(a,b){var c=a.id,f=a instanceof U?this.graphicsLayerIds:this.layerIds,g=Ea(f,c);0<=g&&(f.splice(g,1),a instanceof U?(qa(this["_gl_"+a.id+"_click_connect"]),a.loaded&&a._unsetMap(this,this._gc._surface)):a.loaded&&(a._unsetMap(this,this._layersDiv),-1!==a.declaredClass.indexOf("VETiledLayer")&&
this._onBingLayerRemove(a)),delete this._layers[c],delete this._layerDivs[c],b||this._reorderLayers(f),this.onLayerRemove(a))},removeAllLayers:function(){var a=this.layerIds,b;for(b=a.length-1;0<=b;b--)this.removeLayer(this._layers[a[b]],1);a=this.graphicsLayerIds;for(b=a.length-1;0<=b;b--)this.removeLayer(this._layers[a[b]],1);this.onLayersRemoved()},reorderLayer:function(a,b){p.isString(a)&&(d.deprecated(this.declaredClass+": Map.reorderLayer(/*String*/ id, /*Number*/ index) deprecated. Use Map.reorderLayer(/*Layer*/ layer, /*Number*/ index).",
null,"v2.0"),a=this.getLayer(a));var c=a.id,f,g=a instanceof U?this.graphicsLayerIds:this.layerIds;0>b?b=0:b>=g.length&&(b=g.length-1);f=Ea(g,c);-1!==f&&f!==b&&(g.splice(f,1),g.splice(b,0,c),this._reorderLayers(g))},getLayer:function(a){return this._layers[a]},setExtent:function(a,b){a=new K(a.toJson());var c=a.getWidth(),f=a.getHeight();return 0===c&&0===f?this.centerAt(new M({x:a.xmin,y:a.ymin,spatialReference:a.spatialReference&&a.spatialReference.toJson()})):this._extentUtil(null,null,a,b)},centerAt:function(a){return this._extentUtil(null,
{mapCenter:a})},centerAndZoom:function(a,b){return this._extentUtil({targetLevel:b,mapCenter:a,levelOrFactor:!0})},getScale:function(){return this.__LOD?this.__LOD.scale:ba.getScale(this)},getResolution:function(){return this.__LOD?this.__LOD.resolution:this.extent?this.extent.getWidth()/this.width:0},getResolutionInMeters:function(){return this.getResolution()*ba.getUnitValueForSR(this.spatialReference)},getMinResolution:function(){return this._minResolution},getMaxResolution:function(){return this._maxResolution},
getMinScale:function(){return this._params.minScale},getMaxScale:function(){return this._params.maxScale},_getViewInfo:function(){return this._viewInfo},setScale:function(a){return this._extentUtil({targetScale:a})},getLayersVisibleAtScale:function(a){var b=[];(a=a||this.getScale())&&h.forEach(this.layerIds.concat(this.graphicsLayerIds),function(c){c=this.getLayer(c);c.isVisibleAtScale(a)&&b.push(c)},this);return b},getNumLevels:function(){var a=this.getMinZoom(),b=this.getMaxZoom();return a===b&&
0>a?0:b-a+1},getLevel:function(){return this.__LOD?this.__LOD.level:-1},setLevel:function(a){if(-1<a)return this._extentUtil({targetLevel:a})},getZoom:function(){return this.getLevel()},setZoom:function(a){return this.setLevel(a)},getMinZoom:function(){return this._params.minZoom},getMaxZoom:function(){return this._params.maxZoom},setBasemap:function(a){var b;p.isObject(a)?(b=a,a=b.title):b=A&&A[a];if(b){this._basemapDfd&&-1===this._basemapDfd.fired&&this._basemapDfd.cancel();var c=[],f=[],g=0;h.forEach(b.baseMapLayers||
b.layers,function(b){var n,e={id:b.id,displayLevels:b.displayLevels,opacity:y.isDefined(b.opacity)?b.opacity:null,visible:y.isDefined(b.visibility)?b.visibility:null};if(b.type)switch(b.type){case "OpenStreetMap":n=new ea(e);break;case "VectorTile":n=F.normalize(b.url);n=new va(n,e);break;default:console.log("Map.setBasemap: "+y.substitute({basemapName:a,type:b.type},this.unknownLayerType))}else n=F.normalize(b.url),n=new ca(n,e);n&&(c.push(n),f.push(b),b.isReference||g++)},this);if(c.length&&g){var n=
{basemapName:a,infos:f,layers:c};if(this.loaded){var e=this,t=new m(E._dfdCanceller),u=function(a){t._pendingLayers--;a=h.indexOf(n.layers,this);-1<a&&(a=t._layerEvents[a])&&(k.disconnect(a[0]),k.disconnect(a[1]));0>=t._pendingLayers&&(delete t._layerEvents,delete e._basemapDfd,0>t.fired&&t.callback(n))};this._basemapDfd=t;t._pendingLayers=0;t._layerEvents={};h.forEach(c,function(a,b){a&&(t._pendingLayers++,a.loaded?u(a):t._layerEvents[b]=[k.connect(a,"onLoad",a,u),k.connect(a,"onError",a,u)])});
t.addCallback(da(this,this._basemapLoaded))}else this._basemapLoaded(n)}else console.log("Map.setBasemap: "+y.substitute({basemapName:a},this.invalidBasemap))}else{b=[];for(var d in A)b.push(d);console.log("Map.setBasemap: "+y.substitute({basemapName:a,list:b.join(",")},this.unknownBasemap))}},_basemapLoaded:function(a){var b=a.layers,c=a.infos,f=0,g=!0,n;this.loaded&&(h.forEach(b,function(a,b){a.loaded&&(c[b].isReference||f++)}),g=f);g&&(this.basemapLayerIds&&(n={basemapName:this._basemap,infos:A&&
A[this._basemap]&&A[this._basemap].baseMapLayers},n.basemapName||(h.forEach(this.basemapLayerIds,function(a){if(this.getLayer(a)instanceof ea)return n.basemapName="osm",n.infos=A&&A.osm&&A.osm.baseMapLayers,!1},this),n.basemapName||(n=null))),this._removeBasemap(),this._basemap=a.basemapName,this.basemapLayerIds=this._addBasemap(b,c),this.attr("data-basemap",this.getBasemap()),this.emit("basemap-change",{current:a,previous:n}))},_addBasemap:function(a,b){var c=[],f=[],g=0;h.forEach(a,function(a,n){b[n].isReference?
c.push(a):(this.addLayer(a,g++),f.push(a.id))},this);c.length&&h.forEach(c,function(a){a.attr("data-reference",!0);this.addLayer(a,"top");f.push(a.id)},this);return f},_removeBasemap:function(){var a=this.basemapLayerIds,b;a&&a.length&&h.forEach(a,function(a){(b=this.getLayer(a))&&this.removeLayer(b)},this)},getBasemap:function(){return this._basemap||""},translate:function(a,b){a=a||0;b=b||0;if(!this._txTimer){this._tx=this._ty=0;var c=this.toScreen(this.extent.getCenter());this.__panStart(c.x,c.y)}this._tx+=
a;this._ty+=b;this.__pan(this._tx,this._ty);clearTimeout(this._txTimer);this._txTimer=setTimeout(this._endTranslate,150)},_endTranslate:function(){clearTimeout(this._txTimer);this._txTimer=null;var a=this._tx,b=this._ty;this._tx=this._ty=0;this.__panEnd(a,b)},setTimeExtent:function(a){a=(this.timeExtent=a)?new a.constructor(a.toJson()):null;this.onTimeExtentChange(a)},setTimeSlider:function(a){this.timeSlider&&(qa(this._tsTimeExtentChange_connect),this.timeSlider=this._tsTimeExtentChange_connect=
null);a&&(this.timeSlider=a,this.setTimeExtent(a.getCurrentTimeExtent()),this._tsTimeExtentChange_connect=ua(a,"onTimeExtentChange",this,"setTimeExtent"))},setVisibility:function(a){if(this.visible!==a){this.visible=a;a||(this._display=this.container.style.display);this.container.style.display=a?this._display:"none";if(this.autoResize){var b=a?"resume":"pause";this._rszSignal[b]();this._oriSignal[b]()}a&&this.resize()}return this},resize:function(a){clearTimeout(this._resizeT);this._destroyed||(!0===
a?this._execResize():this._resizeT=setTimeout(this._execResize,this.resizeDelay))},_timedResize:function(){this._resizeT||this._execResize()},_execResize:function(){clearTimeout(this._resizeT);this._resizeT=null;this.reposition();this._resize();this.autoResize&&this._startResizeTimer()},_resize:function(){var a=this.width,b=this.height,c=t.get(this.container,"display"),f=n.getContentBox(this.container);if(!("none"===c||0>=f.w||0>=f.h||a===f.w&&b===f.h)){if(c=this._zoomAnim||this._panAnim)c.stop(),
c._fire("onEnd",[c.node]);Aa(this.root,{width:(this.width=f.w)+"px",height:(this.height=f.h)+"px"});f=this.width;c=this.height;this.attribution&&this.attribution.domNode&&t.set(this.attribution.domNode,"maxWidth",Math.floor(f*this._mapParams.attributionWidth)+"px");this.__visibleRect.update(this.__visibleRect.x,this.__visibleRect.y,f,c);this.__visibleDelta.update(this.__visibleDelta.x,this.__visibleDelta.y,f,c);var g=new W(this.extent),a=(new W(g.x,g.y,f/a*g.width,c/b*g.height,this.spatialReference)).getExtent();
this.onResize(a,f,c);this._extentUtil(null,null,a,null,!0)}},reposition:function(){var a=this.position,b=a.x,c=a.y;this._reposition();a=this.position;if(b!==a.x||c!==a.y)this.onReposition(a.x,a.y)},_reposition:function(){var a=n.position(this.container,!0),b=n.getPadBorderExtents(this.container);this.position.update(a.x+b.l,a.y+b.t)},_setClipRect:function(){delete this._clip;var a=7>=f("ie")||void 0===f("ie")&&7<=f("trident")?"rect(auto,auto,auto,auto)":"auto";if(this.wrapAround180){var b=this.width,
c=this.height,g=this._getFrameWidth(),n=b-g;0<n&&(a=n/2,a="rect(0px,"+(a+g)+"px,"+c+"px,"+a+"px)",c=this.extent.getWidth(),b=g/b*c,this._clip=[(c-b)/2,b])}Aa(this.__container,"clip",a)},_getAvailExtent:function(){var a=this.extent,b=this._clip;if(b){if(!a._clip){var c=new W(a);c.width=b[1];c.x+=b[0];a._clip=c.getExtent()}return a._clip}return a},_fixedPan:function(a,b){return this._extentUtil(null,{dx:a,dy:b})},panUp:function(){return this._fixedPan(0,-.75*this.height)},panUpperRight:function(){return this._fixedPan(.75*
this.width,-.75*this.height)},panRight:function(){return this._fixedPan(.75*this.width,0)},panLowerRight:function(){return this._fixedPan(.75*this.width,.75*this.height)},panDown:function(){return this._fixedPan(0,.75*this.height)},panLowerLeft:function(){return this._fixedPan(-.75*this.width,.75*this.height)},panLeft:function(){return this._fixedPan(-.75*this.width,0)},panUpperLeft:function(){return this._fixedPan(-.75*this.width,-.75*this.height)},enableSnapping:function(a){a=a||{};if("esri.SnappingManager"===
a.declaredClass)this.snappingManager=a;else{var b=ra++,c=this;this._rids&&this._rids.push(b);r(["./SnappingManager"],function(f){var g=c._rids?h.indexOf(c._rids,b):-1;-1!==g&&(c._rids.splice(g,1),c.snappingManager=new f(p.mixin({map:c},a)))})}return this.snappingManager},disableSnapping:function(){this.snappingManager&&this.snappingManager.destroy();this.snappingManager=null},_createLabelLayer:function(){!this._labels&&sa&&this.loaded&&(this._labels=new sa({id:"_internal_LabelLayer"}),this._labels._setMap(this,
this._gc._surface),this._processLabelLayers(),this.on("layers-reordered",this._processLabelLayers))},_processLabelLayers:function(){null==this._labelProcessor&&(this._labelProcessor=setTimeout(this._updateLabelLayers,0))},_updateLabelLayers:function(){this._labelProcessor=null;this._labels&&(this._labels.removeAllFeatureLayers(),h.forEach(this.graphicsLayerIds,function(a){a=this.getLayer(a);"function"===typeof a.applyEdits?this._labels.addFeatureLayer(a):"esri.layers.WFSLayer"===a.declaredClass&&
this._labels.addFeatureLayer(a)},this))},_getMapImageLyr:function(){this.loaded&&!this._mapImageLyr&&(this._mapImageLyr=new H,this._mapImageLyr._setMap(this,this._layersDiv),this._placeMapImageLyr());return this._mapImageLyr},_placeMapImageLyr:function(){for(var a=this.layerIds,b=this._layerDivs,c=!1,f,g,n=a.length-1;0<=n;n--)if(f=a[n],g=this.getLayer(f),f=b[f],g&&f&&!g._isReference){u.place(this._mapImageLyr._div,f,"after");c=!0;break}c||u.place(this._mapImageLyr._div,this._layersDiv,"first")}})})},
"dojox/gfx/matrix":function(){define(["./_base","dojo/_base/lang"],function(r,l){var d=r.matrix={},q={};d._degToRad=function(d){return q[d]||(q[d]=Math.PI*d/180)};d._radToDeg=function(d){return d/Math.PI*180};d.Matrix2D=function(k){if(k)if("number"==typeof k)this.xx=this.yy=k;else if(k instanceof Array){if(0<k.length){for(var m=d.normalize(k[0]),p=1;p<k.length;++p){var h=m,e=d.normalize(k[p]),m=new d.Matrix2D;m.xx=h.xx*e.xx+h.xy*e.yx;m.xy=h.xx*e.xy+h.xy*e.yy;m.yx=h.yx*e.xx+h.yy*e.yx;m.yy=h.yx*e.xy+
h.yy*e.yy;m.dx=h.xx*e.dx+h.xy*e.dy+h.dx;m.dy=h.yx*e.dx+h.yy*e.dy+h.dy}l.mixin(this,m)}}else l.mixin(this,k)};l.extend(d.Matrix2D,{xx:1,xy:0,yx:0,yy:1,dx:0,dy:0});l.mixin(d,{identity:new d.Matrix2D,flipX:new d.Matrix2D({xx:-1}),flipY:new d.Matrix2D({yy:-1}),flipXY:new d.Matrix2D({xx:-1,yy:-1}),translate:function(k,m){return 1<arguments.length?new d.Matrix2D({dx:k,dy:m}):new d.Matrix2D({dx:k.x,dy:k.y})},scale:function(k,m){return 1<arguments.length?new d.Matrix2D({xx:k,yy:m}):"number"==typeof k?new d.Matrix2D({xx:k,
yy:k}):new d.Matrix2D({xx:k.x,yy:k.y})},rotate:function(k){var m=Math.cos(k);k=Math.sin(k);return new d.Matrix2D({xx:m,xy:-k,yx:k,yy:m})},rotateg:function(k){return d.rotate(d._degToRad(k))},skewX:function(k){return new d.Matrix2D({xy:Math.tan(k)})},skewXg:function(k){return d.skewX(d._degToRad(k))},skewY:function(k){return new d.Matrix2D({yx:Math.tan(k)})},skewYg:function(k){return d.skewY(d._degToRad(k))},reflect:function(k,m){1==arguments.length&&(m=k.y,k=k.x);var p=k*k,h=m*m,e=p+h,c=2*k*m/e;return new d.Matrix2D({xx:2*
p/e-1,xy:c,yx:c,yy:2*h/e-1})},project:function(k,m){1==arguments.length&&(m=k.y,k=k.x);var p=k*k,h=m*m,e=p+h,c=k*m/e;return new d.Matrix2D({xx:p/e,xy:c,yx:c,yy:h/e})},normalize:function(k){return k instanceof d.Matrix2D?k:new d.Matrix2D(k)},isIdentity:function(d){return 1==d.xx&&0==d.xy&&0==d.yx&&1==d.yy&&0==d.dx&&0==d.dy},clone:function(k){var m=new d.Matrix2D,p;for(p in k)"number"==typeof k[p]&&"number"==typeof m[p]&&m[p]!=k[p]&&(m[p]=k[p]);return m},invert:function(k){k=d.normalize(k);var m=k.xx*
k.yy-k.xy*k.yx;return k=new d.Matrix2D({xx:k.yy/m,xy:-k.xy/m,yx:-k.yx/m,yy:k.xx/m,dx:(k.xy*k.dy-k.yy*k.dx)/m,dy:(k.yx*k.dx-k.xx*k.dy)/m})},_multiplyPoint:function(d,m,p){return{x:d.xx*m+d.xy*p+d.dx,y:d.yx*m+d.yy*p+d.dy}},multiplyPoint:function(k,m,p){k=d.normalize(k);return"number"==typeof m&&"number"==typeof p?d._multiplyPoint(k,m,p):d._multiplyPoint(k,m.x,m.y)},multiplyRectangle:function(k,m){var p=d.normalize(k);m=m||{x:0,y:0,width:0,height:0};if(d.isIdentity(p))return{x:m.x,y:m.y,width:m.width,
height:m.height};var h=d.multiplyPoint(p,m.x,m.y),e=d.multiplyPoint(p,m.x,m.y+m.height),c=d.multiplyPoint(p,m.x+m.width,m.y),p=d.multiplyPoint(p,m.x+m.width,m.y+m.height),b=Math.min(h.x,e.x,c.x,p.x),a=Math.min(h.y,e.y,c.y,p.y);return{x:b,y:a,width:Math.max(h.x,e.x,c.x,p.x)-b,height:Math.max(h.y,e.y,c.y,p.y)-a}},multiply:function(k){for(var m=d.normalize(k),p=1;p<arguments.length;++p){var h=m,e=d.normalize(arguments[p]),m=new d.Matrix2D;m.xx=h.xx*e.xx+h.xy*e.yx;m.xy=h.xx*e.xy+h.xy*e.yy;m.yx=h.yx*e.xx+
h.yy*e.yx;m.yy=h.yx*e.xy+h.yy*e.yy;m.dx=h.xx*e.dx+h.xy*e.dy+h.dx;m.dy=h.yx*e.dx+h.yy*e.dy+h.dy}return m},_sandwich:function(k,m,p){return d.multiply(d.translate(m,p),k,d.translate(-m,-p))},scaleAt:function(k,m,p,h){switch(arguments.length){case 4:return d._sandwich(d.scale(k,m),p,h);case 3:return"number"==typeof p?d._sandwich(d.scale(k),m,p):d._sandwich(d.scale(k,m),p.x,p.y)}return d._sandwich(d.scale(k),m.x,m.y)},rotateAt:function(k,m,p){return 2<arguments.length?d._sandwich(d.rotate(k),m,p):d._sandwich(d.rotate(k),
m.x,m.y)},rotategAt:function(k,m,p){return 2<arguments.length?d._sandwich(d.rotateg(k),m,p):d._sandwich(d.rotateg(k),m.x,m.y)},skewXAt:function(k,m,p){return 2<arguments.length?d._sandwich(d.skewX(k),m,p):d._sandwich(d.skewX(k),m.x,m.y)},skewXgAt:function(k,m,p){return 2<arguments.length?d._sandwich(d.skewXg(k),m,p):d._sandwich(d.skewXg(k),m.x,m.y)},skewYAt:function(k,m,p){return 2<arguments.length?d._sandwich(d.skewY(k),m,p):d._sandwich(d.skewY(k),m.x,m.y)},skewYgAt:function(k,m,p){return 2<arguments.length?
d._sandwich(d.skewYg(k),m,p):d._sandwich(d.skewYg(k),m.x,m.y)}});r.Matrix2D=d.Matrix2D;return d})},"dojox/gfx/_base":function(){define("dojo/_base/kernel dojo/_base/lang dojo/_base/Color dojo/_base/sniff dojo/_base/window dojo/_base/array dojo/dom dojo/dom-construct dojo/dom-geometry".split(" "),function(r,l,d,q,k,m,p,h,e){var c=l.getObject("dojox.gfx",!0),b=c._base={};c._hasClass=function(a,b){var c=a.getAttribute("className");return c&&0<=(" "+c+" ").indexOf(" "+b+" ")};c._addClass=function(a,b){var c=
a.getAttribute("className")||"";(!c||0>(" "+c+" ").indexOf(" "+b+" "))&&a.setAttribute("className",c+(c?" ":"")+b)};c._removeClass=function(a,b){var c=a.getAttribute("className");c&&a.setAttribute("className",c.replace(new RegExp("(^|\\s+)"+b+"(\\s+|$)"),"$1$2"))};b._getFontMeasurements=function(){var a={"1em":0,"1ex":0,"100%":0,"12pt":0,"16px":0,"xx-small":0,"x-small":0,small:0,medium:0,large:0,"x-large":0,"xx-large":0},b,c;q("ie")&&(c=k.doc.documentElement.style.fontSize||"",c||(k.doc.documentElement.style.fontSize=
"100%"));var g=h.create("div",{style:{position:"absolute",left:"0",top:"-100px",width:"30px",height:"1000em",borderWidth:"0",margin:"0",padding:"0",outline:"none",lineHeight:"1",overflow:"hidden"}},k.body());for(b in a)g.style.fontSize=b,a[b]=16*Math.round(12*g.offsetHeight/16)/12/1E3;q("ie")&&(k.doc.documentElement.style.fontSize=c);k.body().removeChild(g);return a};var a=null;b._getCachedFontMeasurements=function(c){if(c||!a)a=b._getFontMeasurements();return a};var g=null,u={};b._getTextBox=function(a,
b,c){var f,n,t=arguments.length,d;g||(g=h.create("div",{style:{position:"absolute",top:"-10000px",left:"0",visibility:"hidden"}},k.body()));f=g;f.className="";n=f.style;n.borderWidth="0";n.margin="0";n.padding="0";n.outline="0";if(1<t&&b)for(d in b)d in u||(n[d]=b[d]);2<t&&c&&(f.className=c);f.innerHTML=a;f.getBoundingClientRect?(n=f.getBoundingClientRect(),n={l:n.left,t:n.top,w:n.width||n.right-n.left,h:n.height||n.bottom-n.top}):n=e.getMarginBox(f);f.innerHTML="";return n};b._computeTextLocation=
function(a,b,c,g){var f={};switch(a.align){case "end":f.x=a.x-b;break;case "middle":f.x=a.x-b/2;break;default:f.x=a.x}f.y=a.y-c*(g?.75:1);return f};b._computeTextBoundingBox=function(a){if(!c._base._isRendered(a))return{x:0,y:0,width:0,height:0};var f;f=a.getShape();var g=a.getFont()||c.defaultFont;a=a.getTextWidth();g=c.normalizedLength(g.size);f=b._computeTextLocation(f,a,g,!0);return{x:f.x,y:f.y,width:a,height:g}};b._isRendered=function(a){for(a=a.parent;a&&a.getParent;)a=a.parent;return null!==
a};var n=0;b._getUniqueId=function(){var a;do a=r._scopeName+"xUnique"+ ++n;while(p.byId(a));return a};var t=q("pointer-events")?"touchAction":q("MSPointer")?"msTouchAction":null;b._fixMsTouchAction=t?function(a){a.rawNode.style[t]="none"}:function(){};l.mixin(c,{defaultPath:{type:"path",path:""},defaultPolyline:{type:"polyline",points:[]},defaultRect:{type:"rect",x:0,y:0,width:100,height:100,r:0},defaultEllipse:{type:"ellipse",cx:0,cy:0,rx:200,ry:100},defaultCircle:{type:"circle",cx:0,cy:0,r:100},
defaultLine:{type:"line",x1:0,y1:0,x2:100,y2:100},defaultImage:{type:"image",x:0,y:0,width:0,height:0,src:""},defaultText:{type:"text",x:0,y:0,text:"",align:"start",decoration:"none",rotated:!1,kerning:!0},defaultTextPath:{type:"textpath",text:"",align:"start",decoration:"none",rotated:!1,kerning:!0},defaultStroke:{type:"stroke",color:"black",style:"solid",width:1,cap:"butt",join:4},defaultLinearGradient:{type:"linear",x1:0,y1:0,x2:100,y2:100,colors:[{offset:0,color:"black"},{offset:1,color:"white"}]},
defaultRadialGradient:{type:"radial",cx:0,cy:0,r:100,colors:[{offset:0,color:"black"},{offset:1,color:"white"}]},defaultPattern:{type:"pattern",x:0,y:0,width:0,height:0,src:""},defaultFont:{type:"font",style:"normal",variant:"normal",weight:"normal",size:"10pt",family:"serif"},getDefault:function(){var a={};return function(b){var f=a[b];if(f)return new f;f=a[b]=new Function;f.prototype=c["default"+b];return new f}}(),normalizeColor:function(a){return a instanceof d?a:new d(a)},normalizeParameters:function(a,
b){var c;if(b){var f={};for(c in a)c in b&&!(c in f)&&(a[c]=b[c])}return a},makeParameters:function(a,b){var c=null;if(!b)return l.delegate(a);var f={};for(c in a)c in f||(f[c]=l.clone(c in b?b[c]:a[c]));return f},formatNumber:function(a,b){var c=a.toString();if(0<=c.indexOf("e"))c=a.toFixed(4);else{var f=c.indexOf(".");0<=f&&5<c.length-f&&(c=a.toFixed(4))}return 0>a?c:b?" "+c:c},makeFontString:function(a){return a.style+" "+a.variant+" "+a.weight+" "+a.size+" "+a.family},splitFontString:function(a){var b=
c.getDefault("Font");a=a.split(/\s+/);if(!(5>a.length)){b.style=a[0];b.variant=a[1];b.weight=a[2];var f=a[3].indexOf("/");b.size=0>f?a[3]:a[3].substring(0,f);var g=4;0>f&&("/"==a[4]?g=6:"/"==a[4].charAt(0)&&(g=5));g<a.length&&(b.family=a.slice(g).join(" "))}return b},cm_in_pt:72/2.54,mm_in_pt:7.2/2.54,px_in_pt:function(){return c._base._getCachedFontMeasurements()["12pt"]/12},pt2px:function(a){return a*c.px_in_pt()},px2pt:function(a){return a/c.px_in_pt()},normalizedLength:function(a){if(0===a.length)return 0;
if(2<a.length){var b=c.px_in_pt(),f=parseFloat(a);switch(a.slice(-2)){case "px":return f;case "pt":return f*b;case "in":return 72*f*b;case "pc":return 12*f*b;case "mm":return f*c.mm_in_pt*b;case "cm":return f*c.cm_in_pt*b}}return parseFloat(a)},pathVmlRegExp:/([A-Za-z]+)|(\d+(\.\d+)?)|(\.\d+)|(-\d+(\.\d+)?)|(-\.\d+)/g,pathSvgRegExp:/([A-DF-Za-df-z])|([-+]?\d*[.]?\d+(?:[eE][-+]?\d+)?)/g,equalSources:function(a,b){return a&&b&&a===b},switchTo:function(a){var b="string"==typeof a?c[a]:a;b&&(m.forEach("Group Rect Ellipse Circle Line Polyline Image Text Path TextPath EsriPath Surface createSurface fixTarget".split(" "),
function(a){c[a]=b[a]}),"string"==typeof a?c.renderer=a:m.some(["svg","vml","canvas","canvasWithEvents","silverlight"],function(a){return c.renderer=c[a]&&c[a].Surface===c.Surface?a:null}))}});return c})},"esri/basemaps":function(){define(["require","dojo/has","./kernel","dojo/i18n!./nls/jsapi"],function(r,l,d,q){return{streets:{title:q.basemaps.streets,thumbnailUrl:r.toUrl("./images/basemap/streets.jpg"),itemId:"d8855ee4d3d74413babfb0f41203b168",baseMapLayers:[{url:"https://services.arcgisonline.com/ArcGIS/rest/services/World_Street_Map/MapServer"}]},
satellite:{title:q.basemaps.satellite,thumbnailUrl:r.toUrl("./images/basemap/satellite.jpg"),itemId:"86de95d4e0244cba80f0fa2c9403a7b2",baseMapLayers:[{url:"https://services.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer"}]},hybrid:{title:q.basemaps.hybrid,thumbnailUrl:r.toUrl("./images/basemap/hybrid.jpg"),itemId:"413fd05bbd7342f5991d5ec96f4f8b18",baseMapLayers:[{url:"https://services.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer"},{url:"https://services.arcgisonline.com/ArcGIS/rest/services/Reference/World_Boundaries_and_Places/MapServer",
isReference:!0}]},terrain:{title:q.basemaps.terrain,thumbnailUrl:r.toUrl("./images/basemap/terrain.jpg"),itemId:"aab054ab883c4a4094c72e949566ad40",baseMapLayers:[{url:"https://services.arcgisonline.com/ArcGIS/rest/services/World_Terrain_Base/MapServer"},{url:"https://services.arcgisonline.com/ArcGIS/rest/services/Reference/World_Reference_Overlay/MapServer",isReference:!0}]},topo:{title:q.basemaps.topo,thumbnailUrl:r.toUrl("./images/basemap/topo.jpg"),itemId:"6e03e8c26aad4b9c92a87c1063ddb0e3",baseMapLayers:[{url:"https://services.arcgisonline.com/ArcGIS/rest/services/World_Topo_Map/MapServer"}]},
gray:{title:q.basemaps.gray,thumbnailUrl:r.toUrl("./images/basemap/gray.jpg"),itemId:"8b3b470883a744aeb60e5fff0a319ce7",baseMapLayers:[{url:"https://services.arcgisonline.com/ArcGIS/rest/services/Canvas/World_Light_Gray_Base/MapServer"},{url:"https://services.arcgisonline.com/ArcGIS/rest/services/Canvas/World_Light_Gray_Reference/MapServer",isReference:!0}]},"dark-gray":{title:q.basemaps["dark-gray"],thumbnailUrl:r.toUrl("./images/basemap/dark-gray.jpg"),itemId:"da65bacab5bd4defb576f839b6b28098",
baseMapLayers:[{url:"https://services.arcgisonline.com/ArcGIS/rest/services/Canvas/World_Dark_Gray_Base/MapServer"},{url:"https://services.arcgisonline.com/ArcGIS/rest/services/Canvas/World_Dark_Gray_Reference/MapServer",isReference:!0}]},oceans:{title:q.basemaps.oceans,thumbnailUrl:r.toUrl("./images/basemap/oceans.jpg"),itemId:"48b8cec7ebf04b5fbdcaf70d09daff21",baseMapLayers:[{url:"https://services.arcgisonline.com/arcgis/rest/services/Ocean/World_Ocean_Base/MapServer"},{url:"https://services.arcgisonline.com/arcgis/rest/services/Ocean/World_Ocean_Reference/MapServer",
isReference:!0}]},"national-geographic":{title:q.basemaps["national-geographic"],thumbnailUrl:r.toUrl("./images/basemap/national-geographic.jpg"),itemId:"509e2d6b034246d692a461724ae2d62c",baseMapLayers:[{url:"https://services.arcgisonline.com/ArcGIS/rest/services/NatGeo_World_Map/MapServer"}]},osm:{title:q.basemaps.osm,thumbnailUrl:r.toUrl("./images/basemap/osm.jpg"),itemId:"5d2bfa736f8448b3a1708e1f6be23eed",baseMapLayers:[{type:"OpenStreetMap"}]},"dark-gray-vector":{title:q.basemaps["dark-gray"],
thumbnailUrl:r.toUrl("./images/basemap/dark-gray.jpg"),itemId:"850db44b9eb845d3bd42b19e8aa7a024",baseMapLayers:[{url:"https://www.arcgis.com/sharing/rest/content/items/5ad3948260a147a993ef4865e3fad476/resources/styles/root.json",type:"VectorTile"}]},"gray-vector":{title:q.basemaps.gray,thumbnailUrl:r.toUrl("./images/basemap/gray.jpg"),itemId:"0e02e6f86d02455091796eaae811d9b5",baseMapLayers:[{url:"https://www.arcgis.com/sharing/rest/content/items/5dd75c1a544b46c3af01ba5736bfdfa0/resources/styles/root.json",
type:"VectorTile"}]},"streets-vector":{title:q.basemaps.streets,thumbnailUrl:r.toUrl("./images/basemap/streets.jpg"),itemId:"4e1133c28ac04cca97693cf336cd49ad",baseMapLayers:[{url:"https://www.arcgis.com/sharing/rest/content/items/a60a37a27cc140ddad15f919cd5a69f2/resources/styles/root.json",type:"VectorTile"}]},"topo-vector":{title:q.basemaps.topo,thumbnailUrl:r.toUrl("./images/basemap/topo.jpg"),itemId:"6f65bc1351b7411588a8cb43fe23dad7",baseMapLayers:[{url:"https://www.arcgis.com/sharing/rest/content/items/86d5ed4b6dc741de9dad5f0fbe09ae95/resources/styles/root.json",
type:"VectorTile"}]},"streets-night-vector":{title:q.basemaps["streets-night-vector"],thumbnailUrl:r.toUrl("./images/basemap/streets-night.jpg"),itemId:"bf79e422e9454565ae0cbe9553cf6471",baseMapLayers:[{url:"https://www.arcgis.com/sharing/rest/content/items/92c551c9f07b4147846aae273e822714/resources/styles/root.json",type:"VectorTile"}]},"streets-relief-vector":{title:q.basemaps["streets-relief-vector"],thumbnailUrl:r.toUrl("./images/basemap/streets-relief.jpg"),itemId:"2e063e709e3446459f8538ed6743f879",
baseMapLayers:[{url:"https://www.arcgis.com/sharing/rest/content/items/78c0a9ab4fbf4198a8b951848aab19d8/resources/styles/root.json",type:"VectorTile"}]},"streets-navigation-vector":{title:q.basemaps["streets-navigation-vector"],thumbnailUrl:r.toUrl("./images/basemap/streets-navigation.jpg"),itemId:"dcbbba0edf094eaa81af19298b9c6247",baseMapLayers:[{url:"https://www.arcgis.com/sharing/rest/content/items/e19e9330bf08490ca8353d76b5e2e658/resources/styles/root.json",type:"VectorTile"}]}}})},"esri/Evented":function(){define("dojo/_base/declare dojo/_base/lang dojo/aspect dojo/Evented dojo/has ./kernel".split(" "),
function(r,l,d,q,k,m){return r([q],{declaredClass:"esri.Evented",registerConnectEvents:function(){var d=this.constructor,h=this.constructor._meta.parents,e=[{}],c={},b,a,g=function(a,b){l.isArray(a)||(a=[a]);for(var c=0;c<a.length;c++){var f=a[c];f._meta&&f._meta.parents&&g(f._meta.parents,b);f.prototype._eventMap&&b.push(l.mixin({},f.prototype._eventMap))}return b};if(!d._onMap){g(h,e);e.push(this._eventMap);h=l.mixin.apply(this,e);for(b in this)/^on\w/.test(b)&&l.isFunction(this[b])&&(e=this._hyphenLower(b).toLowerCase(),
h[e]||(c[e]={method:b}));for(a in h)b=this._onCamelCase(a),c[a]={method:b,argKeys:h[a]};d._onMap=c;return d._onMap}},on:function(p,h){if(-1<p.indexOf(",")){for(var e=p.split(/\s*,\s*/),c=e.length,b=[];c--;)b.push(this.on(e[c],h));b.remove=function(){for(var a=0;a<b.length;a++)b[a].remove()};return b}var e=this.constructor._onMap||this.registerConnectEvents(),c="string"==typeof p&&p.toLowerCase(),a=this._onCamelCase(c),g=e&&e[c];return(a=g&&g.method||this[a]&&l.isFunction(this[a])&&a)?g&&l.isArray(g.argKeys)?
(e=this._onArr2Obj(h,e[c].argKeys),d.after(this,a,e,!0)):d.after(this,a,function(a){a=a||{};a.target||(a.target=this);h.call(this,a)},!0):this.inherited(arguments)},emit:function(d,h){var e,c,b,a,g=d.toLowerCase();a=this._onCamelCase(d);var u=this.constructor._onMap||this.registerConnectEvents();a=(b=u&&u[g]&&u[g].method||l.isFunction(this[a])&&a)&&this[b];b&&u&&u[g]&&this._onObj2Arr(function(){c=Array.prototype.slice.call(arguments)},u[g].argKeys)(h);h=h||{};h.target||(h.target=this);a&&(e=c&&c.length?
c:[h],e=a.apply(this,e));this.inherited(arguments,[d,h]);return e},_onObj2Arr:function(d,h){if(h){var e=this;return function(c){var b,a=[],g=h.length;for(b=0;b<g;b++)a[b]=c[h[b]];d.apply(e,a)}}return d},_onArr2Obj:function(d,h){if(h){var e=this;return function(){var c,b={},a=arguments.length;for(c=0;c<a;c++)b[h[c]]=arguments[c];b.target||(b.target=e);d.call(e,b)}}return d},_hyphenLower:function(d){return d.replace(/^on/,"").replace(/[A-Z](?=[a-z])/g,function(h,e){return(e?"-":"")+h.toLowerCase()})},
_onCamelCase:function(d){return"on"+d.substr(0,1).toUpperCase()+d.substr(1).replace(/\-([a-z])/g,function(h,e){return e.toUpperCase()})}})})},"esri/fx":function(){define("dojo/_base/connect dojo/_base/fx dojo/_base/lang dojo/dom dojo/dom-geometry dojo/dom-style dojo/fx dojo/has ./kernel".split(" "),function(r,l,d,q,k,m,p,h,e){return{animateRange:function(c){var b=c.range;return new l.Animation(d.mixin({curve:new l._Line(b.start,b.end)},c))},resize:function(c){var b=c.node=q.byId(c.node),a=c.start,
g=c.end;a||(a=k.getMarginBox(b),b=k.getPadBorderExtents(b),a=c.start={left:a.l+b.l,top:a.t+b.t,width:a.w-b.w,height:a.h-b.h});g||(g=c.anchor?c.anchor:{x:a.left,y:a.top},b=c.size,g=c.end={left:a.left-(b.width-a.width)*(g.x-a.left)/a.width,top:a.top-(b.height-a.height)*(g.y-a.top)/a.height,width:b.width,height:b.height});return l.animateProperty(d.mixin({properties:{left:{start:a.left,end:g.left},top:{start:a.top,end:g.top},width:{start:a.width,end:g.width},height:{start:a.height,end:g.height}}},c))},
slideTo:function(c){var b=c.node=q.byId(c.node),a=m.getComputedStyle,g=null,e=null,n=function(){return function(){var c="absolute"==b.style.position?"absolute":"relative";g="absolute"==c?b.offsetTop:parseInt(a(b).top)||0;e="absolute"==c?b.offsetLeft:parseInt(a(b).left)||0;"absolute"!=c&&"relative"!=c&&(c=k.position(b,!0),g=c.y,e=c.x,b.style.position="absolute",b.style.top=g+"px",b.style.left=e+"px")}}();n();c=l.animateProperty(d.mixin({properties:{top:{start:g,end:c.top||0},left:{start:e,end:c.left||
0}}},c));r.connect(c,"beforeBegin",c,n);return c},flash:function(c){c=d.mixin({end:"#f00",duration:500,count:1},c);c.duration/=2*c.count;var b=q.byId(c.node),a=c.start;a||(a=m.getComputedStyle(b).backgroundColor);var g=c.end,e=[],n=c.count,b={node:b,duration:c.duration};for(c=0;c<n;c++)e.push(l.animateProperty(d.mixin({properties:{backgroundColor:{start:a,end:g}}},b))),e.push(l.animateProperty(d.mixin({properties:{backgroundColor:{start:g,end:a}}},b)));return p.chain(e)}}})},"dojo/fx":function(){define("./_base/lang ./Evented ./_base/kernel ./_base/array ./aspect ./_base/fx ./dom ./dom-style ./dom-geometry ./ready require".split(" "),
function(r,l,d,q,k,m,p,h,e,c,b){d.isAsync||c(0,function(){b(["./fx/Toggler"])});d=d.fx={};c={_fire:function(a,b){this[a]&&this[a].apply(this,b||[]);return this}};var a=function(a){this._index=-1;this._animations=a||[];this._current=this._onAnimateCtx=this._onEndCtx=null;this.duration=0;q.forEach(this._animations,function(a){a&&("undefined"!=typeof a.duration&&(this.duration+=a.duration),a.delay&&(this.duration+=a.delay))},this)};a.prototype=new l;r.extend(a,{_onAnimate:function(){this._fire("onAnimate",
arguments)},_onEnd:function(){this._onAnimateCtx.remove();this._onEndCtx.remove();this._onAnimateCtx=this._onEndCtx=null;this._index+1==this._animations.length?this._fire("onEnd"):(this._current=this._animations[++this._index],this._onAnimateCtx=k.after(this._current,"onAnimate",r.hitch(this,"_onAnimate"),!0),this._onEndCtx=k.after(this._current,"onEnd",r.hitch(this,"_onEnd"),!0),this._current.play(0,!0))},play:function(a,b){this._current||(this._current=this._animations[this._index=0]);if(!b&&"playing"==
this._current.status())return this;var c=k.after(this._current,"beforeBegin",r.hitch(this,function(){this._fire("beforeBegin")}),!0),f=k.after(this._current,"onBegin",r.hitch(this,function(a){this._fire("onBegin",arguments)}),!0),g=k.after(this._current,"onPlay",r.hitch(this,function(a){this._fire("onPlay",arguments);c.remove();f.remove();g.remove()}));this._onAnimateCtx&&this._onAnimateCtx.remove();this._onAnimateCtx=k.after(this._current,"onAnimate",r.hitch(this,"_onAnimate"),!0);this._onEndCtx&&
this._onEndCtx.remove();this._onEndCtx=k.after(this._current,"onEnd",r.hitch(this,"_onEnd"),!0);this._current.play.apply(this._current,arguments);return this},pause:function(){if(this._current){var a=k.after(this._current,"onPause",r.hitch(this,function(b){this._fire("onPause",arguments);a.remove()}),!0);this._current.pause()}return this},gotoPercent:function(a,b){this.pause();var c=this.duration*a;this._current=null;q.some(this._animations,function(a,b){if(c<=a.duration)return this._current=a,this._index=
b,!0;c-=a.duration;return!1},this);this._current&&this._current.gotoPercent(c/this._current.duration);b&&this.play();return this},stop:function(a){if(this._current){if(a){for(;this._index+1<this._animations.length;++this._index)this._animations[this._index].stop(!0);this._current=this._animations[this._index]}var b=k.after(this._current,"onStop",r.hitch(this,function(a){this._fire("onStop",arguments);b.remove()}),!0);this._current.stop()}return this},status:function(){return this._current?this._current.status():
"stopped"},destroy:function(){this.stop();this._onAnimateCtx&&this._onAnimateCtx.remove();this._onEndCtx&&this._onEndCtx.remove()}});r.extend(a,c);d.chain=function(b){return new a(r.isArray(b)?b:Array.prototype.slice.call(b,0))};var g=function(a){this._animations=a||[];this._connects=[];this.duration=this._finished=0;q.forEach(a,function(a){var b=a.duration;a.delay&&(b+=a.delay);this.duration<b&&(this.duration=b);this._connects.push(k.after(a,"onEnd",r.hitch(this,"_onEnd"),!0))},this);this._pseudoAnimation=
new m.Animation({curve:[0,1],duration:this.duration});var b=this;q.forEach("beforeBegin onBegin onPlay onAnimate onPause onStop onEnd".split(" "),function(a){b._connects.push(k.after(b._pseudoAnimation,a,function(){b._fire(a,arguments)},!0))})};r.extend(g,{_doAction:function(a,b){q.forEach(this._animations,function(c){c[a].apply(c,b)});return this},_onEnd:function(){++this._finished>this._animations.length&&this._fire("onEnd")},_call:function(a,b){var c=this._pseudoAnimation;c[a].apply(c,b)},play:function(a,
b){this._finished=0;this._doAction("play",arguments);this._call("play",arguments);return this},pause:function(){this._doAction("pause",arguments);this._call("pause",arguments);return this},gotoPercent:function(a,b){var c=this.duration*a;q.forEach(this._animations,function(a){a.gotoPercent(a.duration<c?1:c/a.duration,b)});this._call("gotoPercent",arguments);return this},stop:function(a){this._doAction("stop",arguments);this._call("stop",arguments);return this},status:function(){return this._pseudoAnimation.status()},
destroy:function(){this.stop();q.forEach(this._connects,function(a){a.remove()})}});r.extend(g,c);d.combine=function(a){return new g(r.isArray(a)?a:Array.prototype.slice.call(a,0))};d.wipeIn=function(a){var b=a.node=p.byId(a.node),c=b.style,f;a=m.animateProperty(r.mixin({properties:{height:{start:function(){f=c.overflow;c.overflow="hidden";if("hidden"==c.visibility||"none"==c.display)return c.height="1px",c.display="",c.visibility="",1;var a=h.get(b,"height");return Math.max(a,1)},end:function(){return b.scrollHeight}}}},
a));var g=function(){c.height="auto";c.overflow=f};k.after(a,"onStop",g,!0);k.after(a,"onEnd",g,!0);return a};d.wipeOut=function(a){var b=(a.node=p.byId(a.node)).style,c;a=m.animateProperty(r.mixin({properties:{height:{end:1}}},a));k.after(a,"beforeBegin",function(){c=b.overflow;b.overflow="hidden";b.display=""},!0);var f=function(){b.overflow=c;b.height="auto";b.display="none"};k.after(a,"onStop",f,!0);k.after(a,"onEnd",f,!0);return a};d.slideTo=function(a){var b=null,c=null,f=function(a){return function(){var f=
h.getComputedStyle(a),g=f.position;b="absolute"==g?a.offsetTop:parseInt(f.top)||0;c="absolute"==g?a.offsetLeft:parseInt(f.left)||0;"absolute"!=g&&"relative"!=g&&(f=e.position(a,!0),b=f.y,c=f.x,a.style.position="absolute",a.style.top=b+"px",a.style.left=c+"px")}}(a.node=p.byId(a.node));f();a=m.animateProperty(r.mixin({properties:{top:a.top||0,left:a.left||0}},a));k.after(a,"beforeBegin",f,!0);return a};return d})},"esri/tileUtils":function(){define(["dojo/_base/array","dojo/has","./kernel","./geometry/Point",
"./geometry/Extent"],function(r,l,d,q,k){return{_addFrameInfo:function(d,p){var h,e,c=2*p.origin[1],b=p.origin[0],a=d.origin.x,g=d.width,u;r.forEach(d.lods,function(n){h=Math.round(c/n.resolution);e=Math.ceil(h/g);u=Math.floor((b-a)/(g*n.resolution));n._frameInfo||(n._frameInfo=[e,u,u+e-1,h])})},getContainingTileCoords:function(d,p,h){var e=d.origin;h=h.resolution;return{row:Math.floor((e.y-p.y)/(d.height*h)),col:Math.floor((p.x-e.x)/(d.width*h))}},getCandidateTileInfo:function(d,p,h){var e;e=d.width;
for(var c=d.height,b=h.xmax-h.xmin,a=h.ymax-h.ymin,g=d.__tileInfo===p,u=g?d.getMinZoom():-1,g=g?d.getMaxZoom():-1,n=-1,t=p.lods,f=Math.abs,v,x,w,g=-1<g?g:t.length-1,u=-1<u?u:0;u<=g;u++)if(x=t[u])if(w=b>a?f(a-c*x.resolution):f(b-e*x.resolution),0>n||w<=n)v=x,n=w;else break;e=v;v=e.resolution;c=(h.xmin+h.xmax)/2;b=(h.ymin+h.ymax)/2;a=d.width/2*v;v*=d.height/2;c=new k(c-a,b-v,c+a,b+v,h.spatialReference);h=new q(c.xmin,c.ymax,h.spatialReference);g=e.resolution;a=p.width;b=p.height;p=p.origin;d=d.__visibleDelta;
v=Math.floor;t=a*g;f=b*g;g=v((p.y-h.y)/f);n=v((h.x-p.x)/t);u=p.y-g*f;p=v(Math.abs((h.x-(p.x+n*t))*a/t))+d.x;d=v(Math.abs((h.y-u)*b/f))+d.y;return{tile:{point:h,coords:{row:g,col:n},offsets:{x:p,y:d}},lod:e,extent:c}},getTileExtent:function(d,p,h,e){var c=d.origin;p=d.lods[p].resolution;var b=d.width,a=d.height;return new k(e*p*b+c.x,c.y-(h+1)*p*a,(e+1)*p*b+c.x,c.y-h*p*a,d.spatialReference)}}})},"esri/geometry/Point":function(){define("dojo/_base/declare dojo/_base/lang dojo/has ../kernel ../lang ../SpatialReference ./Geometry ../srUtils".split(" "),
function(r,l,d,q,k,m,p,h){function e(a,b){89.99999<b?b=89.99999:-89.99999>b&&(b=-89.99999);var c=.017453292519943*b;return[111319.49079327169*a,3189068.5*Math.log((1+Math.sin(c))/(1-Math.sin(c)))]}function c(a,b,c){a=a/6378137*57.29577951308232;return c?[a,57.29577951308232*(1.5707963267948966-2*Math.atan(Math.exp(-1*b/6378137)))]:[a-360*Math.floor((a+180)/360),57.29577951308232*(1.5707963267948966-2*Math.atan(Math.exp(-1*b/6378137)))]}var b={type:"point",x:0,y:0};r=r(p,{declaredClass:"esri.geometry.Point",
constructor:function(a,c,e){l.mixin(this,b);l.isArray(a)?(this.x=a[0],this.y=a[1],this.spatialReference=c):l.isObject(a)?(l.mixin(this,a),k.isDefined(this.latitude)&&(this.y=this.latitude),k.isDefined(this.longitude)&&(this.x=this.longitude),this.spatialReference&&(this.spatialReference=h.createSpatialReference(this.spatialReference))):(this.x=a,this.y=c,this.spatialReference=e);this.verifySR()},offset:function(a,b){return new this.constructor(this.x+a,this.y+b,this.spatialReference)},setX:function(a){this.x=
a;this.clearCache();return this},setY:function(a){this.y=a;this.clearCache();return this},setLongitude:function(a){var b=this.spatialReference;b&&(b._isWebMercator()?this.setX(e(a,this.y)[0]):4326===b.wkid&&this.setX(a));return this},setLatitude:function(a){var b=this.spatialReference;b&&(b._isWebMercator()?this.setY(e(this.x,a)[1]):4326===b.wkid&&this.setY(a));return this},getLongitude:function(){var a=this.spatialReference,b;a&&(a._isWebMercator()?b=c(this.x,this.y)[0]:4326===a.wkid&&(b=this.x));
return b},getLatitude:function(){var a=this.spatialReference,b;a&&(a._isWebMercator()?b=c(this.x,this.y)[1]:4326===a.wkid&&(b=this.y));return b},update:function(a,b){this.x=a;this.y=b;this.clearCache();return this},normalize:function(){var a=this.x,b=this.spatialReference;if(b){var c=b._getInfo();c&&(a=this._normalizeX(a,c))}return new this.constructor(a,this.y,b)},_normalizeX:function(a,b){var c=b.valid[0],g=b.valid[1],e=2*g;a>g?(c=Math.ceil(Math.abs(a-g)/e),a-=c*e):a<c&&(c=Math.ceil(Math.abs(a-
c)/e),a+=c*e);return a},toJson:function(){var a={x:this.x,y:this.y},b=this.spatialReference;b&&(a.spatialReference=b.toJson());return a}});r.lngLatToXY=e;r.xyToLngLat=c;r.defaultProps=b;r.metersPerDegree=6378137*Math.PI/180;return r})},"esri/geometry/Geometry":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/has","../kernel","../SpatialReference"],function(r,l,d,q,k){return r(null,{declaredClass:"esri.geometry.Geometry",spatialReference:null,type:null,cache:void 0,setSpatialReference:function(d){this.spatialReference=
d;return this},verifySR:function(){this.spatialReference||this.setSpatialReference(new k(4326))},getExtent:function(){return null},clearCache:function(){this.cache=void 0},getCacheValue:function(d){return this.cache&&this.cache[d]},setCacheValue:function(d,p){this.cache||(this.cache={});this.cache[d]=p}})})},"esri/srUtils":function(){define(["./SpatialReference","./ImageSpatialReference","./kernel","./sniff","dojo/_base/lang"],function(r,l,d,q,k){function m(d){var h=!1;d&&(d.ics||d.icsid)&&(h=!0);
return h}return{isICS:m,createSpatialReference:function(d){var h=null;d&&(h=m(d)?new l(d):new r(d));return h}}})},"esri/ImageSpatialReference":function(){define("dojo/_base/declare dojo/_base/lang dojo/has ./kernel ./lang ./SpatialReference".split(" "),function(r,l,d,q,k,m){return r(m,{declaredClass:"esri.ImageSpatialReference",constructor:function(d){d&&l.isObject(d)&&l.mixin(this,d)},icsid:null,icsns:null,ics:null,_isWebMercator:function(){return!1},_isWrappable:function(){return!1},equals:function(d){var h=
!1;if(d)if(this.icsid&&d.icsid){if(h=this.icsid===d.icsid,this.icsns||d.icsns)h=h&&this.icsns===d.icsns}else this.ics&&d.ics&&(h=this.ics===d.ics);return h},toJson:function(d){var h=null,e=k.isDefined;d=e(d)?d:!0;e(this.icsid)?(h={icsid:this.icsid},e(this.icsns)&&(h.icsns=this.icsns)):e(this.ics)&&(h={ics:this.ics});e(this.url)&&e(h)&&d&&(h.url=this.url);return h}})})},"esri/geometry/Extent":function(){define("dojo/_base/declare dojo/_base/array dojo/_base/lang dojo/has ../kernel ../lang ../SpatialReference ./Geometry ./Point ./webMercatorUtils ./mathUtils ../srUtils".split(" "),
function(r,l,d,q,k,m,p,h,e,c,b,a){var g={type:"extent",xmin:0,ymin:0,xmax:0,ymax:0},u=r(h,{declaredClass:"esri.geometry.Extent",constructor:function(b,c,f,e,h){d.mixin(this,g);d.isObject(b)?(d.mixin(this,b),this.spatialReference&&(this.spatialReference=a.createSpatialReference(this.spatialReference))):this.update(b,c,f,e,h);this.verifySR()},getWidth:function(){return Math.abs(this.xmax-this.xmin)},getHeight:function(){return Math.abs(this.ymax-this.ymin)},getCenter:function(){return new e((this.xmin+
this.xmax)/2,(this.ymin+this.ymax)/2,this.spatialReference)},centerAt:function(a){var b=this.getCenter(),c=a.x-b.x;a=a.y-b.y;return new u(this.xmin+c,this.ymin+a,this.xmax+c,this.ymax+a,this.spatialReference)},update:function(a,b,c,g,e){this.xmin=a;this.ymin=b;this.xmax=c;this.ymax=g;this.spatialReference=e;this.clearCache();return this},offset:function(a,b){return new u(this.xmin+a,this.ymin+b,this.xmax+a,this.ymax+b,this.spatialReference)},expand:function(a){var b=(1-a)/2;a=this.getWidth()*b;b*=
this.getHeight();return new u(this.xmin+a,this.ymin+b,this.xmax-a,this.ymax-b,this.spatialReference)},intersects:function(a){if(!a)return!1;var b=a.type,f=this.spatialReference,g=a.spatialReference;f&&g&&!f.equals(g)&&f._canProject(g)&&(a=f.isWebMercator()?c.geographicToWebMercator(a):c.webMercatorToGeographic(a,!0));switch(b){case "point":return this.contains(a);case "multipoint":return this._intersectsMultipoint(a);case "extent":return this._intersectsExtent(a);case "polygon":return this._intersectsPolygon(a);
case "polyline":return this._intersectsPolyline(a)}},normalize:function(){var a=this._normalize(!1,!0);d.isArray(a)||(a=[a]);return a},shiftCentralMeridian:function(){return this._normalize(!0)},bisect:function(){var a=this.spatialReference,b=a&&a._getInfo(),c=[],g=0;if(b&&this._isOutOfBounds(b)){var e=this,g=e.xmin,h=e.ymin,d=e.ymax,m=b.valid[0],k=b.valid[1];e.getWidth()>2*k&&(e=e.getCenter(),e=new u(e.x-k,h,e.x+k,d,new p(a.toJson())));var g=e.xmin-g,l=this._normalizeX(e.xmin,b),b=this._normalizeX(e.xmax,
b);l.frameId===b.frameId?c.push(new u(l.x,h,b.x,d,new p(a.toJson()))):c.push(new u(l.x,h,k,d,new p(a.toJson())),new u(m,h,b.x,d,new p(a.toJson())))}else c.push(this.getExtent());return{extents:c,marginLeft:g}},_intersectsMultipoint:function(a){var b=a.points.length,c;for(c=0;c<b;c++)if(this.contains(a.getPoint(c)))return!0;return!1},_intersectsExtent:function(a){var b,c,g,e,n=!1;this.xmin<=a.xmin?(b=a.xmin,this.xmax<b?n=!0:g=Math.min(this.xmax,a.xmax)-b):(b=this.xmin,a.xmax<b?n=!0:g=Math.min(this.xmax,
a.xmax)-b);this.ymin<=a.ymin?(c=a.ymin,this.ymax<c?n=!0:e=Math.min(this.ymax,a.ymax)-c):(c=this.ymin,a.ymax<c?n=!0:e=Math.min(this.ymax,a.ymax)-c);return n?null:new u(b,c,b+g,c+e,this.spatialReference)},_intersectsPolygon:function(a){var b=[this.xmin,this.ymax],c=[this.xmax,this.ymax],g=[this.xmin,this.ymin],n=[this.xmax,this.ymin],h=[b,c,g,n],b=[[g,b],[b,c],[c,n],[n,g]],g=a.rings,n=g.length,d,u=new e(0,0,this.spatialReference);d=h.length;for(c=0;c<d;c++)if(u.update(h[c][0],h[c][1]),a.contains(u))return!0;
u.setSpatialReference(a.spatialReference);for(var p,k,c=0;c<n;c++)if(h=g[c],d=h.length){p=h[0];u.update(p[0],p[1]);if(this.contains(u))return!0;for(a=1;a<d;a++){k=h[a];u.update(k[0],k[1]);if(this.contains(u)||this._intersectsLine([p,k],b))return!0;p=k}}return!1},_intersectsPolyline:function(a){var b=[[[this.xmin,this.ymin],[this.xmin,this.ymax]],[[this.xmin,this.ymax],[this.xmax,this.ymax]],[[this.xmax,this.ymax],[this.xmax,this.ymin]],[[this.xmax,this.ymin],[this.xmin,this.ymin]]],c,g=a.paths,n=
g.length,h,d,u,p,k=new e(0,0,a.spatialReference);for(a=0;a<n;a++)if(h=g[a],d=h.length){u=h[0];k.update(u[0],u[1]);if(this.contains(k))return!0;for(c=1;c<d;c++){p=h[c];k.update(p[0],p[1]);if(this.contains(k)||this._intersectsLine([u,p],b))return!0;u=p}}return!1},_intersectsLine:function(a,c){var f=b._getLineIntersection2,g,e=c.length;for(g=0;g<e;g++)if(f(a,c[g]))return!0;return!1},contains:function(a){if(!a)return!1;var b=a.type;if("point"===b){var c=this.spatialReference,g=a.spatialReference,b=a.x;
a=a.y;c&&g&&!c.equals(g)&&c._canProject(g)&&(a=c.isWebMercator()?e.lngLatToXY(b,a):e.xyToLngLat(b,a,!0),b=a[0],a=a[1]);return b>=this.xmin&&b<=this.xmax&&a>=this.ymin&&a<=this.ymax}return"extent"===b?this._containsExtent(a):!1},_containsExtent:function(a){var b=a.xmin,c=a.ymin,g=a.xmax,n=a.ymax,h=a.spatialReference;a=new e(b,c,h);b=new e(b,n,h);n=new e(g,n,h);c=new e(g,c,h);return this.contains(a)&&this.contains(b)&&this.contains(n)&&this.contains(c)?!0:!1},union:function(a){return new u(Math.min(this.xmin,
a.xmin),Math.min(this.ymin,a.ymin),Math.max(this.xmax,a.xmax),Math.max(this.ymax,a.ymax),this.spatialReference)},getExtent:function(){var a=this.spatialReference;return new u(this.xmin,this.ymin,this.xmax,this.ymax,a&&new p(a.toJson()))},_shiftCM:function(a){var b=this.getCacheValue("_shifted");if(!b){var b=new u(this.toJson()),f=b.spatialReference;if(a=a||f._getInfo()){var g=this._getCM(a);if(g){var e=f._isWebMercator()?c.webMercatorToGeographic(g):g;b.xmin-=g.x;b.xmax-=g.x;f._isWebMercator()||(e.x=
this._normalizeX(e.x,a).x);b.setSpatialReference(new p(m.substitute({Central_Meridian:e.x},4326===f.wkid?a.altTemplate:a.wkTemplate)))}}this.setCacheValue("_shifted",b)}return b},_getCM:function(a){var b;this._isOutOfBounds(a)&&(b=this.getCenter());return b},_isOutOfBounds:function(a){var b=a.valid[0];a=a.valid[1];var c=this.xmin,g=this.xmax;return!(c>=b&&c<=a&&g>=b&&g<=a)},_normalize:function(a,b,c){var f=new u(this.toJson()),g=f.spatialReference;if(g&&(c=c||g._getInfo())){var e=l.map(this._getParts(c),
function(a){return a.extent});return 2<e.length?a?this._shiftCM(c):f.update(c.valid[0],f.ymin,c.valid[1],f.ymax,g):2===e.length?a?this._shiftCM(c):b?e:{rings:l.map(e,function(a){return[[a.xmin,a.ymin],[a.xmin,a.ymax],[a.xmax,a.ymax],[a.xmax,a.ymin],[a.xmin,a.ymin]]}),spatialReference:g}:e[0]||f}return f},_getParts:function(a){var b=this.getCacheValue("_parts");if(!b){var b=[],c=this.xmin,g=this.xmax,e=this.ymin,n=this.ymax,h=this.spatialReference,d=this.getWidth(),p=c,k=g,m=0,l=0,q,r;a=a||h._getInfo();
q=a.valid[0];r=a.valid[1];l=this._normalizeX(c,a);c=l.x;m=l.frameId;l=this._normalizeX(g,a);g=l.x;l=l.frameId;a=c===g&&0<d;if(d>2*r){d=new u(p<k?c:g,e,r,n,h);c=new u(q,e,p<k?g:c,n,h);r=new u(0,e,r,n,h);e=new u(q,e,0,n,h);h=[];q=[];d.contains(r)&&h.push(m);d.contains(e)&&q.push(m);c.contains(r)&&h.push(l);c.contains(e)&&q.push(l);for(n=m+1;n<l;n++)h.push(n),q.push(n);b.push({extent:d,frameIds:[m]},{extent:c,frameIds:[l]},{extent:r,frameIds:h},{extent:e,frameIds:q})}else c>g||a?b.push({extent:new u(c,
e,r,n,h),frameIds:[m]},{extent:new u(q,e,g,n,h),frameIds:[l]}):b.push({extent:new u(c,e,g,n,h),frameIds:[m]});this.setCacheValue("_parts",b)}return b},_normalizeX:function(a,b){var c=0,g=b.valid[0],e=b.valid[1],n=2*e;a>e?(c=Math.ceil(Math.abs(a-e)/n),a-=c*n):a<g&&(c=Math.ceil(Math.abs(a-g)/n),a+=c*n,c=-c);return{x:a,frameId:c}},toJson:function(){var a={xmin:this.xmin,ymin:this.ymin,xmax:this.xmax,ymax:this.ymax},b=this.spatialReference;b&&(a.spatialReference=b.toJson());return a}});u.defaultProps=
g;return u})},"esri/geometry/webMercatorUtils":function(){define("dojo/_base/array dojo/_base/lang dojo/has ../kernel ../SpatialReference ./Point".split(" "),function(r,l,d,q,k,m){function p(e,c,b,a){if("point"===e.type){var g=c(e.x,e.y,a);return new e.constructor(g[0],g[1],new k(b))}if("extent"===e.type){var g=c(e.xmin,e.ymin,a),h=c(e.xmax,e.ymax,a);return new e.constructor(g[0],g[1],h[0],h[1],new k(b))}if("polyline"===e.type||"polygon"===e.type){var g="polyline"===e.type,n=[],d;r.forEach(g?e.paths:
e.rings,function(b){n.push(d=[]);r.forEach(b,function(b){d.push(c(b[0],b[1],a))})});return g?new e.constructor({paths:n,spatialReference:new k(b)}):new e.constructor({rings:n,spatialReference:new k(b)})}if("multipoint"===e.type){var f=[];r.forEach(e.points,function(b){f.push(c(b[0],b[1],a))});return new e.constructor({points:f,spatialReference:new k(b)})}}function h(e,c){var b=e&&(null!=e.wkid?e:e.spatialReference),a=c&&(null!=c.wkid?c:c.spatialReference);return b&&a?a.equals(b)?!0:a._canProject(b):
!1}return{canProject:h,project:function(e,c){var b=e&&e.spatialReference,a=c&&(null!=c.wkid?c:c.spatialReference);b&&a?b.equals(a)?e=new e.constructor(e.toJson()):h(b,a)?a.isWebMercator()?e=p(e,m.lngLatToXY,{wkid:102100}):4326===a.wkid&&(e=p(e,m.xyToLngLat,{wkid:4326})):e=null:e=null;return e},lngLatToXY:m.lngLatToXY,xyToLngLat:m.xyToLngLat,metersPerDegree:m.metersPerDegree,geographicToWebMercator:function(e){return p(e,m.lngLatToXY,{wkid:102100})},webMercatorToGeographic:function(e,c){return p(e,
m.xyToLngLat,{wkid:4326},c)}}})},"esri/geometry/mathUtils":function(){define(["dojo/_base/lang","dojo/has","../kernel","./Point"],function(r,l,d,q){function k(h,e,c){return h instanceof q?new q(h.x+c*(e.x-h.x),h.y+c*(e.y-h.y)):[h[0]+c*(e[0]-h[0]),h[1]+c*(e[1]-h[1])]}function m(h,e){return 1E-8>Math.abs(h-e)}function p(h,e,c,b){var a,g=m(h[0],e[0])?1E10:(h[1]-e[1])/(h[0]-e[0]),d=m(c[0],b[0])?1E10:(c[1]-b[1])/(c[0]-b[0]),n=h[1]-g*h[0],t=c[1]-d*c[0];if(m(g,d)){if(m(n,t)){if(m(h[0],e[0]))if(Math.min(h[1],
e[1])<Math.max(c[1],b[1])||Math.max(h[1],e[1])>Math.min(c[1],b[1]))h=(h[1]+e[1]+c[1]+b[1]-Math.min(h[1],e[1],c[1],b[1])-Math.max(h[1],e[1],c[1],b[1]))/2,a=(h-n)/g;else return null;else if(Math.min(h[0],e[0])<Math.max(c[0],b[0])||Math.max(h[0],e[0])>Math.min(c[0],b[0]))a=(h[0]+e[0]+c[0]+b[0]-Math.min(h[0],e[0],c[0],b[0])-Math.max(h[0],e[0],c[0],b[0]))/2,h=g*a+n;else return null;return[a,h]}return null}m(g,1E10)?(a=h[0],h=d*a+t):m(d,1E10)?(a=c[0],h=g*a+n):(a=-(n-t)/(g-d),h=h[1]===e[1]?h[1]:c[1]===b[1]?
c[1]:g*a+n);return[a,h]}return{getLength:function(h,e){var c=e.x-h.x,b=e.y-h.y;return Math.sqrt(c*c+b*b)},_getLength:function(h,e){var c=e[0]-h[0],b=e[1]-h[1];return Math.sqrt(c*c+b*b)},getPointOnLine:k,getMidpoint:function(h,e){return k(h,e,.5)},_equals:m,_getLineIntersection:p,getLineIntersection:function(h,e,c,b,a){(h=p([h.x,h.y],[e.x,e.y],[c.x,c.y],[b.x,b.y]))&&(h=new q(h[0],h[1],a));return h},_getLineIntersection2:function(h,e){var c=h[0],b=h[1],a=e[0],g=e[1],d=c[0],c=c[1],n=b[0],b=b[1],t=a[0],
f=a[1],a=g[0]-t,t=d-t,v=n-d,g=g[1]-f,f=c-f,x=b-c,w=g*v-a*x;if(0===w)return!1;a=(a*f-g*t)/w;t=(v*f-x*t)/w;return 0<=a&&1>=a&&0<=t&&1>=t?[d+a*(n-d),c+a*(b-c)]:!1},_pointLineDistance:function(h,e){var c=e[0],b=e[1],a=c[0],g=c[1],c=h[0],d=h[1],n=b[0]-a,t=b[1]-g,f=c-a,v=d-g,b=Math.sqrt,x=Math.pow,w=b(x(n,2)+x(t,2)),f=(f*n+v*t)/(w*w),g=g+f*t;return b(x(c-(a+f*n),2)+x(d-g,2))}}})},"esri/PluginTarget":function(){define("require dojo/aspect dojo/_base/array dojo/_base/lang dojo/Deferred dojo/when".split(" "),
function(r,l,d,q,k,m){function p(){l.after(this.constructor._meta,"ctor",this._pluginsHandler,!0);this._plugins={}}p.prototype={addPlugin:function(h,e){var c=this,b=this._plugins,a=new k;try{r([h],function(g){h in b?a.resolve({id:b[h].declaredId||h.replace(/\//g,".")}):(b[h]=g,m(g.add(c,e),function(){var b={id:g.declaredId||h.replace(/\//g,".")};c.emit("plugin-add",b);a.resolve(b)},function(b){a.reject(b)}))})}catch(g){a.reject(g)}return a.promise},removePlugin:function(h){if(h in this._plugins){var e=
this._plugins[h];e.remove(this);delete this._plugins[h];this.emit("plugin-remove",{id:e.declaredId||h.replace(/\//g,".")})}},_pluginsHandler:function(){var h=this;d.some(arguments,function(e){if(e&&e.plugins&&e.plugins instanceof Array){e=e.plugins;var c,b,a;for(a=0;a<e.length;a++)c=e[a],b=c instanceof Object?c.id:c,h.addPlugin(b,c.options);return!0}})}};return p})},"esri/arcade/Dictionary":function(){define(["require","exports","./languageUtils","../geometry/Geometry","./ImmutableArray"],function(r,
l,d,q,k){return function(){function m(d){this.attributes=null;this.plain=!1;this.immutable=!0;this.attributes=d instanceof m?d.attributes:void 0===d?{}:null===d?{}:d}m.prototype.field=function(d){var h=d.toLowerCase();d=this.attributes[d];if(void 0!==d)return d;for(var e in this.attributes)if(e.toLowerCase()===h)return this.attributes[e];throw Error("Field not Found");};m.prototype.setField=function(d,h){if(this.immutable)throw Error("Dictionary is Immutable");var e=d.toLowerCase();if(void 0===this.attributes[d])for(var c in this.attributes)if(c.toLowerCase()===
e){this.attributes[c]=h;return}this.attributes[d]=h};m.prototype.hasField=function(d){var h=d.toLowerCase();if(void 0!==this.attributes[d])return!0;for(var e in this.attributes)if(e.toLowerCase()===h)return!0;return!1};m.prototype.keys=function(){var d=[],h;for(h in this.attributes)d.push(h);return d=d.sort()};m.prototype.castToText=function(){var p="",h;for(h in this.attributes){""!==p&&(p+=",");var e=this.attributes[h];null==e?e="null":d.isBoolean(e)||d.isNumber(e)||d.isString(e)?p+=JSON.stringify(h)+
":"+JSON.stringify(e):e instanceof q?p+=JSON.stringify(h)+":"+d.toStringExplicit(e):e instanceof k?p+=JSON.stringify(h)+":"+d.toStringExplicit(e):e instanceof Array?p+=JSON.stringify(h)+":"+d.toStringExplicit(e):e instanceof Date?p+=JSON.stringify(h)+":"+JSON.stringify(e):null!==e&&"object"===typeof e&&void 0!==e.castToText&&(p+=JSON.stringify(h)+":"+e.castToText())}return"{"+p+"}"};return m}()})},"esri/arcade/languageUtils":function(){define("require exports ../geometry/Geometry ../moment dojo/number ./ImmutableArray ../kernel ./ImmutablePointArray ./ImmutablePathArray dojo/_base/array ../geometry/Point ../geometry/Polyline ../geometry/Polygon ../geometry/Extent ../geometry/Multipoint ./FunctionWrapper".split(" "),
function(r,l,d,q,k,m,p,h,e,c,b,a,g,u,n,t){function f(a,b,c){if(""===b||null===b||void 0===b||b===c||b===c)return a;do a=a.replace(b,c);while(-1!==a.indexOf(b));return a}function v(a){return a instanceof W||a instanceof t||a instanceof R}function x(a){return"string"===typeof a||a instanceof String}function w(a){return"boolean"===typeof a}function z(a){return"number"===typeof a}function A(a){return a instanceof Array}function y(a){return a instanceof Date}function B(a,b){if(!1===isNaN(a)){if(void 0===
b||null===b||""===b)return a.toString();b=f(b,"\u2030","");b=f(b,"\u00a4","");return k.format(a,{pattern:b})}return a.toString()}function C(a,b){var c=q(a);return void 0===b||null===b||""===b?c.format():c.format(E(b))}function E(a){return a.replace(/(LTS)|L|l/g,function(a){return"["+a+"]"})}function D(a,b,c){switch(c){case "\x3e":return a>b;case "\x3c":return a<b;case "\x3e\x3d":return a>=b;case "\x3c\x3d":return a<=b}return!1}function F(a,c){if(a===c||null===a&&c===l.voidOperation||null===c&&a===
l.voidOperation)return!0;if(y(a)&&y(c))return a.getTime()===c.getTime();if(a instanceof e||a instanceof h)return a.equalityTest(c);if(a instanceof b&&c instanceof b){var f=void 0,g=void 0;l.isVersion4?(f=a.cache._arcadeCacheId,g=c.cache._arcadeCacheId):(f=a.getCacheValue("_arcadeCacheId"),g=c.getCacheValue("_arcadeCacheId"));if(void 0!==f&&null!==f)return f===g}return void 0!==a&&void 0!==c&&null!==a&&null!==c&&"object"===typeof a&&"object"===typeof c&&(a._arcadeCacheId===c._arcadeCacheId&&void 0!==
a._arcadeCacheId&&null!==a._arcadeCacheId||a._underlyingGraphic===c._underlyingGraphic&&void 0!==a._underlyingGraphic&&null!==a._underlyingGraphic)?!0:!1}function G(a,b){if(x(a))return a;if(null===a)return"";if(z(a))return B(a,b);if(w(a))return a.toString();if(y(a))return C(a,b);if(a instanceof d)return JSON.stringify(a.toJson());if(A(a)){for(var c=[],f=0;f<a.length;f++)c[f]=N(a[f]);return"["+c.join(",")+"]"}if(a instanceof m){c=[];for(f=0;f<a.length();f++)c[f]=N(a.get(f));return"["+c.join(",")+"]"}return null!==
a&&"object"===typeof a&&void 0!==a.castToText?a.castToText():v(a)?"object, Function":""}function J(a,b){if(x(a))return a;if(null===a)return"";if(z(a))return B(a,b);if(w(a))return a.toString();if(y(a))return C(a,b);if(a instanceof d)return JSON.stringify(a.toJson());if(A(a)){for(var c=[],f=0;f<a.length;f++)c[f]=N(a[f]);return"["+c.join(",")+"]"}if(a instanceof m){c=[];for(f=0;f<a.length();f++)c[f]=N(a.get(f));return"["+c.join(",")+"]"}return null!==a&&"object"===typeof a&&void 0!==a.castToText?a.castToText():
v(a)?"object, Function":""}function N(a){if(null!==a){if(w(a)||z(a)||x(a))return JSON.stringify(a);if(a instanceof d||a instanceof m||a instanceof Array)return J(a);if(a instanceof Date)return JSON.stringify(C(a,""));if(null!==a&&"object"===typeof a&&void 0!==a.castToText)return a.castToText()}return"null"}function M(a,b){return z(a)?a:null===a||""===a?0:y(a)?NaN:w(a)?a?1:0:A(a)||""===a||void 0===a?NaN:void 0!==b&&x(a)?(b=f(b,"\u2030",""),b=f(b,"\u00a4",""),k.parse(a,{pattern:b})):a===l.voidOperation?
0:Number(a)}function L(a,b){var f;c.some(b.fields,function(b){b.name===a&&(f=b.domain);return!!f});return f}Object.defineProperty(l,"__esModule",{value:!0});r=function(){return function(a){this.value=a}}();var K=function(){return function(a){this.value=a}}(),W=function(){return function(a){this.fn=a}}(),R=function(){return function(a){this.fn=a}}();l.NativeFunction=W;l.ImplicitResult=K;l.ReturnResult=r;l.SizzleFunction=R;l.isVersion4=0===p.version.indexOf("4.");l.voidOperation={type:"VOID"};l.breakResult=
{type:"BREAK"};l.continueResult={type:"CONTINUE"};l.multiReplace=f;l.isFunctionParameter=v;l.isSimpleType=function(a){return x(a)||z(a)||y(a)||w(a)||null===a||a===l.voidOperation||"number"===typeof a?!0:!1};l.defaultUndefined=function(a,b){return void 0===a?b:a};l.isString=x;l.isBoolean=w;l.isNumber=z;l.isArray=A;l.isFeatureCursor=function(a){return a&&void 0!==a.isFeatureCursor};l.isImmutableArray=function(a){return a instanceof m};l.isDate=y;l.pcCheck=function(a,b,c){if(a.length<b||a.length>c)throw Error("Function called with wrong number of Parameters");
};l.generateUUID=function(){var a=(new Date).getTime();return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(b){var c=(a+16*Math.random())%16|0;a=Math.floor(a/16);return("x"===b?c:c&3|8).toString(16)})};l.formatNumber=B;l.formatDate=C;l.standardiseDateFormat=E;l.greaterThanLessThan=function(a,b,c){if(null===a){if(null===b||b===l.voidOperation)return D(null,null,c);if(z(b))return D(0,b,c);if(x(b)||w(b))return D(0,M(b),c);if(y(b))return D(0,b.getTime(),c)}if(a===l.voidOperation){if(null===
b||b===l.voidOperation)return D(null,null,c);if(z(b))return D(0,b,c);if(x(b)||w(b))return D(0,M(b),c);if(y(b))return D(0,b.getTime(),c)}else if(z(a)){if(z(b))return D(a,b,c);if(w(b))return D(a,M(b),c);if(null===b||b===l.voidOperation)return D(a,0,c);if(x(b))return D(a,M(b),c);if(y(b))return D(a,b.getTime(),c)}else if(x(a)){if(x(b))return D(G(a),G(b),c);if(y(b))return D(M(a),b.getTime(),c);if(z(b))return D(M(a),b,c);if(null===b||b===l.voidOperation)return D(M(a),0,c);if(w(b))return D(M(a),M(b),c)}else if(y(a)){if(y(b))return D(a,
b,c);if(null===b||b===l.voidOperation)return D(a.getTime(),0,c);if(z(b))return D(a.getTime(),b,c);if(w(b)||x(b))return D(a.getTime(),M(b),c)}else if(w(a)){if(w(b))return D(a,b,c);if(z(b))return D(M(a),M(b),c);if(y(b))return D(M(a),b.getTime(),c);if(null===b||b===l.voidOperation)return D(M(a),0,c);if(x(b))return D(M(a),M(b),c)}return!F(a,b)||"\x3c\x3d"!==c&&"\x3e\x3d"!==c?!1:!0};l.equalityTest=F;l.toString=G;l.toNumberArray=function(a){var b=[];if(!1===A(a))return null;if(a instanceof m){for(var c=
0;c<a.length();c++)b[c]=M(a.get(c));return b}for(c=0;c<a.length;c++)b[c]=M(a[c]);return b};l.toStringExplicit=J;l.toNumber=M;l.toDate=function(a,b){if(y(a))return a;if(x(a)){var c=q(a,[void 0===b||null===b||""===b?q.ISO_8601:b]);if(c.isValid())return c.toDate()}return null};l.toDateM=function(a,b){if(y(a))return q(a);if(x(a)){var c=q(a,[void 0===b||null===b||""===b?q.ISO_8601:b]);if(c.isValid())return c}return null};l.toBoolean=function(a){if(w(a))return a;if(x(a)){if(a=a.toLowerCase(),"true"===a)return!0}else if(z(a))return 0===
a||isNaN(a)?!1:!0;return!1};l.fixSpatialReference=function(a,b){if(null===a||void 0===a)return null;if(null===a.spatialReference||void 0===a.spatialReference)a.spatialReference=b;return a};l.fixNullGeometry=function(c){return null===c?null:c instanceof b?"NaN"===c.x||null===c.x||isNaN(c.x)?null:c:c instanceof g?0===c.rings.length?null:c:c instanceof a?0===c.paths.length?null:c:c instanceof n?0===c.points.length?null:c:c instanceof u?"NaN"===c.xmin||null===c.xmin||isNaN(c.xmin)?null:c:null};l.getDomainValue=
function(a,b){if(!a||!a.domain)return null;var c=null;b="string"===a.field.type||"esriFieldTypeString"===a.field.type?G(b):M(b);for(var f=0;f<a.domain.codedValues.length;f++){var g=a.domain.codedValues[f];g.code===b&&(c=g)}return null===c?null:c.name};l.getDomainCode=function(a,b){if(!a||!a.domain)return null;var c=null;b=G(b);for(var f=0;f<a.domain.codedValues.length;f++){var g=a.domain.codedValues[f];g.name===b&&(c=g)}return null===c?null:c.code};l.getDomain=function(a,b,f,g){void 0===f&&(f=null);
if(!b||!b.fields)return null;for(var e=null,n=0;n<b.fields.length;n++){var h=b.fields[n];h.name.toLowerCase()===a.toString().toLowerCase()&&(e=h)}if(null===e)return null;var d,t;g||(g=f&&b.typeIdField&&f._field(b.typeIdField));null!=g&&c.some(b.types,function(a){return a.id===g?((d=a.domains&&a.domains[e.name])&&"inherited"===d.type&&(d=L(e.name,b),t=!0),!0):!1});t||d||(d=L(a,b));return{field:e,domain:d}}})},"esri/moment":function(){define(["require","exports","./plugins/moment!"],function(r,l,d){return d})},
"esri/plugins/moment":function(){define(["require","exports","dojo/_base/kernel","moment/moment"],function(r,l,d,q){Object.defineProperty(l,"__esModule",{value:!0});var k={ar:1,"ar-dz":1,"ar-kw":1,"ar-ly":1,"ar-ma":1,"ar-sa":1,"ar-tn":1,bs:1,cs:1,da:1,de:1,"de-at":1,"de-ch":1,el:1,"en-au":1,"en-ca":1,"en-gb":1,"en-ie":1,"en-nz":1,es:1,"es-do":1,et:1,fi:1,fr:1,"fr-ca":1,"fr-ch":1,he:1,hi:1,hr:1,id:1,it:1,ja:1,ko:1,lt:1,lv:1,nb:1,nl:1,"nl-be":1,pl:1,pt:1,"pt-br":1,ro:1,ru:1,sr:1,"sr-cyrl":1,sv:1,th:1,
tr:1,vi:1,"zh-cn":1,"zh-hk":1,"zh-tw":1};l.load=function(m,p,h){m=d.locale;var e=m in k;if(!e){var c=m.split("-");1<c.length&&c[0]in k&&(m=c[0],e=!0)}e?p(["moment/locale/"+m],function(){h(q)}):h(q)}})},"moment/moment":function(){(function(r,l){"object"===typeof exports&&"undefined"!==typeof module?module.exports=l():"function"===typeof define&&define.amd?define(l):r.moment=l()})(this,function(){function r(){return Tb.apply(null,arguments)}function l(a){return a instanceof Array||"[object Array]"===
Object.prototype.toString.call(a)}function d(a){return null!=a&&"[object Object]"===Object.prototype.toString.call(a)}function q(a){return void 0===a}function k(a){return"number"===typeof a||"[object Number]"===Object.prototype.toString.call(a)}function m(a){return a instanceof Date||"[object Date]"===Object.prototype.toString.call(a)}function p(a,b){var c=[],f;for(f=0;f<a.length;++f)c.push(b(a[f],f));return c}function h(a,b){return Object.prototype.hasOwnProperty.call(a,b)}function e(a,b){for(var c in b)h(b,
c)&&(a[c]=b[c]);h(b,"toString")&&(a.toString=b.toString);h(b,"valueOf")&&(a.valueOf=b.valueOf);return a}function c(a,b,c,f){return Na(a,b,c,f,!0).utc()}function b(a){null==a._pf&&(a._pf={empty:!1,unusedTokens:[],unusedInput:[],overflow:-2,charsLeftOver:0,nullInput:!1,invalidMonth:null,invalidFormat:!1,userInvalidated:!1,iso:!1,parsedDateParts:[],meridiem:null,rfc2822:!1,weekdayMismatch:!1});return a._pf}function a(a){if(null==a._isValid){var c=b(a),f=ec.call(c.parsedDateParts,function(a){return null!=
a}),f=!isNaN(a._d.getTime())&&0>c.overflow&&!c.empty&&!c.invalidMonth&&!c.invalidWeekday&&!c.nullInput&&!c.invalidFormat&&!c.userInvalidated&&(!c.meridiem||c.meridiem&&f);a._strict&&(f=f&&0===c.charsLeftOver&&0===c.unusedTokens.length&&void 0===c.bigHour);if(null!=Object.isFrozen&&Object.isFrozen(a))return f;a._isValid=f}return a._isValid}function g(a){var f=c(NaN);null!=a?e(b(f),a):b(f).userInvalidated=!0;return f}function u(a,c){var f,g,e;q(c._isAMomentObject)||(a._isAMomentObject=c._isAMomentObject);
q(c._i)||(a._i=c._i);q(c._f)||(a._f=c._f);q(c._l)||(a._l=c._l);q(c._strict)||(a._strict=c._strict);q(c._tzm)||(a._tzm=c._tzm);q(c._isUTC)||(a._isUTC=c._isUTC);q(c._offset)||(a._offset=c._offset);q(c._pf)||(a._pf=b(c));q(c._locale)||(a._locale=c._locale);if(0<Kb.length)for(f=0;f<Kb.length;f++)g=Kb[f],e=c[g],q(e)||(a[g]=e);return a}function n(a){u(this,a);this._d=new Date(null!=a._d?a._d.getTime():NaN);this.isValid()||(this._d=new Date(NaN));!1===Lb&&(Lb=!0,r.updateOffset(this),Lb=!1)}function t(a){return a instanceof
n||null!=a&&null!=a._isAMomentObject}function f(a){return 0>a?Math.ceil(a)||0:Math.floor(a)}function v(a){a=+a;var b=0;0!==a&&isFinite(a)&&(b=f(a));return b}function x(a,b,c){var f=Math.min(a.length,b.length),g=Math.abs(a.length-b.length),e=0,n;for(n=0;n<f;n++)(c&&a[n]!==b[n]||!c&&v(a[n])!==v(b[n]))&&e++;return e+g}function w(a){!1===r.suppressDeprecationWarnings&&"undefined"!==typeof console&&console.warn&&console.warn("Deprecation warning: "+a)}function z(a,b){var c=!0;return e(function(){null!=
r.deprecationHandler&&r.deprecationHandler(null,a);if(c){for(var f=[],g,e=0;e<arguments.length;e++){g="";if("object"===typeof arguments[e]){g+="\n["+e+"] ";for(var n in arguments[0])g+=n+": "+arguments[0][n]+", ";g=g.slice(0,-2)}else g=arguments[e];f.push(g)}w(a+"\nArguments: "+Array.prototype.slice.call(f).join("")+"\n"+Error().stack);c=!1}return b.apply(this,arguments)},b)}function A(a,b){null!=r.deprecationHandler&&r.deprecationHandler(a,b);Ub[a]||(w(b),Ub[a]=!0)}function y(a){return a instanceof
Function||"[object Function]"===Object.prototype.toString.call(a)}function B(a,b){var c=e({},a),f;for(f in b)h(b,f)&&(d(a[f])&&d(b[f])?(c[f]={},e(c[f],a[f]),e(c[f],b[f])):null!=b[f]?c[f]=b[f]:delete c[f]);for(f in a)h(a,f)&&!h(b,f)&&d(a[f])&&(c[f]=e({},c[f]));return c}function C(a){null!=a&&this.set(a)}function E(a,b){var c=a.toLowerCase();pb[c]=pb[c+"s"]=pb[b]=a}function D(a){return"string"===typeof a?pb[a]||pb[a.toLowerCase()]:void 0}function F(a){var b={},c,f;for(f in a)h(a,f)&&(c=D(f))&&(b[c]=
a[f]);return b}function G(a){var b=[],c;for(c in a)b.push({unit:c,priority:La[c]});b.sort(function(a,b){return a.priority-b.priority});return b}function J(a,b){return function(c){if(null!=c){if(this.isValid())this._d["set"+(this._isUTC?"UTC":"")+a](c);r.updateOffset(this,b);return this}return N(this,a)}}function N(a,b){return a.isValid()?a._d["get"+(a._isUTC?"UTC":"")+b]():NaN}function M(a,b,c){var f=""+Math.abs(a);return(0<=a?c?"+":"":"-")+Math.pow(10,Math.max(0,b-f.length)).toString().substr(1)+
f}function L(a,b,c,f){var g=f;"string"===typeof f&&(g=function(){return this[f]()});a&&(nb[a]=g);b&&(nb[b[0]]=function(){return M(g.apply(this,arguments),b[1],b[2])});c&&(nb[c]=function(){return this.localeData().ordinal(g.apply(this,arguments),a)})}function K(a){return a.match(/\[[\s\S]/)?a.replace(/^\[|\]$/g,""):a.replace(/\\/g,"")}function W(a){var b=a.match(Vb),c,f;c=0;for(f=b.length;c<f;c++)b[c]=nb[b[c]]?nb[b[c]]:K(b[c]);return function(c){var g="",e;for(e=0;e<f;e++)g+=y(b[e])?b[e].call(c,a):
b[e];return g}}function R(a,b){if(!a.isValid())return a.localeData().invalidDate();b=ba(b,a.localeData());qb[b]=qb[b]||W(b);return qb[b](a)}function ba(a,b){function c(a){return b.longDateFormat(a)||a}var f=5;for(Cb.lastIndex=0;0<=f&&Cb.test(a);)a=a.replace(Cb,c),Cb.lastIndex=0,--f;return a}function O(a,b,c){Pb[a]=y(b)?b:function(a,f){return a&&c?c:b}}function Q(a,b){return h(Pb,a)?Pb[a](b._strict,b._locale):new RegExp(U(a))}function U(a){return ia(a.replace("\\","").replace(/\\(\[)|\\(\])|\[([^\]\[]*)\]|\\(.)/g,
function(a,b,c,f,g){return b||c||f||g}))}function ia(a){return a.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$\x26")}function Y(a,b){var c,f=b;"string"===typeof a&&(a=[a]);k(b)&&(f=function(a,c){c[b]=v(a)});for(c=0;c<a.length;c++)Qb[a[c]]=f}function ca(a,b){Y(a,function(a,c,f,g){f._w=f._w||{};b(a,f._w,f,g)})}function H(a,b){return(new Date(Date.UTC(a,b+1,0))).getUTCDate()}function ea(a,b){var c;if(!a.isValid())return a;if("string"===typeof b)if(/^\d+$/.test(b))b=v(b);else if(b=a.localeData().monthsParse(b),
!k(b))return a;c=Math.min(a.date(),H(a.year(),b));a._d["set"+(a._isUTC?"UTC":"")+"Month"](b,c);return a}function va(a){return null!=a?(ea(this,a),r.updateOffset(this,!0),this):N(this,"Month")}function la(){function a(a,b){return b.length-a.length}var b=[],f=[],g=[],e,n;for(e=0;12>e;e++)n=c([2E3,e]),b.push(this.monthsShort(n,"")),f.push(this.months(n,"")),g.push(this.months(n,"")),g.push(this.monthsShort(n,""));b.sort(a);f.sort(a);g.sort(a);for(e=0;12>e;e++)b[e]=ia(b[e]),f[e]=ia(f[e]);for(e=0;24>e;e++)g[e]=
ia(g[e]);this._monthsShortRegex=this._monthsRegex=new RegExp("^("+g.join("|")+")","i");this._monthsStrictRegex=new RegExp("^("+f.join("|")+")","i");this._monthsShortStrictRegex=new RegExp("^("+b.join("|")+")","i")}function ma(a){return 0===a%4&&0!==a%100||0===a%400}function sa(a,b,c,f,g,e,n){b=new Date(a,b,c,f,g,e,n);100>a&&0<=a&&isFinite(b.getFullYear())&&b.setFullYear(a);return b}function ka(a){var b=new Date(Date.UTC.apply(null,arguments));100>a&&0<=a&&isFinite(b.getUTCFullYear())&&b.setUTCFullYear(a);
return b}function ta(a,b,c){c=7+b-c;return-((7+ka(a,0,c).getUTCDay()-b)%7)+c-1}function ua(a,b,c,f,g){c=(7+c-f)%7;f=ta(a,f,g);f=1+7*(b-1)+c+f;0>=f?(b=a-1,a=(ma(b)?366:365)+f):f>(ma(a)?366:365)?(b=a+1,a=f-(ma(a)?366:365)):(b=a,a=f);return{year:b,dayOfYear:a}}function qa(a,b,c){var f=ta(a.year(),b,c),f=Math.floor((a.dayOfYear()-f-1)/7)+1;1>f?(a=a.year()-1,b=f+da(a,b,c)):f>da(a.year(),b,c)?(b=f-da(a.year(),b,c),a=a.year()+1):(a=a.year(),b=f);return{week:b,year:a}}function da(a,b,c){var f=ta(a,b,c);b=
ta(a+1,b,c);return((ma(a)?366:365)-f+b)/7}function Aa(a,b,f){var g,e;a=a.toLocaleLowerCase();if(!this._weekdaysParse)for(this._weekdaysParse=[],this._shortWeekdaysParse=[],this._minWeekdaysParse=[],g=0;7>g;++g)e=c([2E3,1]).day(g),this._minWeekdaysParse[g]=this.weekdaysMin(e,"").toLocaleLowerCase(),this._shortWeekdaysParse[g]=this.weekdaysShort(e,"").toLocaleLowerCase(),this._weekdaysParse[g]=this.weekdays(e,"").toLocaleLowerCase();if(f)b="dddd"===b?Ka.call(this._weekdaysParse,a):"ddd"===b?Ka.call(this._shortWeekdaysParse,
a):Ka.call(this._minWeekdaysParse,a);else if("dddd"===b){b=Ka.call(this._weekdaysParse,a);if(-1!==b)return b;b=Ka.call(this._shortWeekdaysParse,a);if(-1!==b)return b;b=Ka.call(this._minWeekdaysParse,a)}else if("ddd"===b){b=Ka.call(this._shortWeekdaysParse,a);if(-1!==b)return b;b=Ka.call(this._weekdaysParse,a);if(-1!==b)return b;b=Ka.call(this._minWeekdaysParse,a)}else{b=Ka.call(this._minWeekdaysParse,a);if(-1!==b)return b;b=Ka.call(this._weekdaysParse,a);if(-1!==b)return b;b=Ka.call(this._shortWeekdaysParse,
a)}return-1!==b?b:null}function Ea(){function a(a,b){return b.length-a.length}var b=[],f=[],g=[],e=[],n,h,d,t;for(n=0;7>n;n++)h=c([2E3,1]).day(n),d=this.weekdaysMin(h,""),t=this.weekdaysShort(h,""),h=this.weekdays(h,""),b.push(d),f.push(t),g.push(h),e.push(d),e.push(t),e.push(h);b.sort(a);f.sort(a);g.sort(a);e.sort(a);for(n=0;7>n;n++)f[n]=ia(f[n]),g[n]=ia(g[n]),e[n]=ia(e[n]);this._weekdaysMinRegex=this._weekdaysShortRegex=this._weekdaysRegex=new RegExp("^("+e.join("|")+")","i");this._weekdaysStrictRegex=
new RegExp("^("+g.join("|")+")","i");this._weekdaysShortStrictRegex=new RegExp("^("+f.join("|")+")","i");this._weekdaysMinStrictRegex=new RegExp("^("+b.join("|")+")","i")}function za(){return this.hours()%12||12}function ra(a,b){L(a,0,0,function(){return this.localeData().meridiem(this.hours(),this.minutes(),b)})}function oa(a,b){return b._meridiemParse}function Fa(a){return a?a.toLowerCase().replace("_","-"):a}function Ma(a){var b=null;if(!Da[a]&&"undefined"!==typeof module&&module&&module.exports)try{b=
Gb._abbr,require("./locale/"+a),Ja(b)}catch(Pc){}return Da[a]}function Ja(a,b){var c;a&&(c=q(b)?Ca(a):Ga(a,b))&&(Gb=c);return Gb._abbr}function Ga(a,b){if(null!==b){var c=$b;b.abbr=a;if(null!=Da[a])A("defineLocaleOverride","use moment.updateLocale(localeName, config) to change an existing locale. moment.defineLocale(localeName, config) should only be used for creating a new locale See http://momentjs.com/guides/#/warnings/define-locale/ for more info."),c=Da[a]._config;else if(null!=b.parentLocale)if(null!=
Da[b.parentLocale])c=Da[b.parentLocale]._config;else return yb[b.parentLocale]||(yb[b.parentLocale]=[]),yb[b.parentLocale].push({name:a,config:b}),null;Da[a]=new C(B(c,b));yb[a]&&yb[a].forEach(function(a){Ga(a.name,a.config)});Ja(a);return Da[a]}delete Da[a];return null}function Ca(a){var b;a&&a._locale&&a._locale._abbr&&(a=a._locale._abbr);if(!a)return Gb;if(!l(a)){if(b=Ma(a))return b;a=[a]}a:{b=0;for(var c,f,g,e;b<a.length;){e=Fa(a[b]).split("-");c=e.length;for(f=(f=Fa(a[b+1]))?f.split("-"):null;0<
c;){if(g=Ma(e.slice(0,c).join("-"))){a=g;break a}if(f&&f.length>=c&&x(e,f,!0)>=c-1)break;c--}b++}a=null}return a}function Ta(a){var c;(c=a._a)&&-2===b(a).overflow&&(c=0>c[db]||11<c[db]?db:1>c[Ya]||c[Ya]>H(c[Ra],c[db])?Ya:0>c[Ia]||24<c[Ia]||24===c[Ia]&&(0!==c[Sa]||0!==c[eb]||0!==c[mb])?Ia:0>c[Sa]||59<c[Sa]?Sa:0>c[eb]||59<c[eb]?eb:0>c[mb]||999<c[mb]?mb:-1,b(a)._overflowDayOfYear&&(c<Ra||c>Ya)&&(c=Ya),b(a)._overflowWeeks&&-1===c&&(c=gc),b(a)._overflowWeekday&&-1===c&&(c=hc),b(a).overflow=c);return a}
function $a(a){var c,f;c=a._i;var g=ic.exec(c)||jc.exec(c),e,n,h,d;if(g){b(a).iso=!0;c=0;for(f=Hb.length;c<f;c++)if(Hb[c][1].exec(g[1])){n=Hb[c][0];e=!1!==Hb[c][2];break}if(null==n)a._isValid=!1;else{if(g[3]){c=0;for(f=Rb.length;c<f;c++)if(Rb[c][1].exec(g[3])){h=(g[2]||" ")+Rb[c][0];break}if(null==h){a._isValid=!1;return}}if(e||null==h){if(g[4])if(kc.exec(g[4]))d="Z";else{a._isValid=!1;return}a._f=n+(h||"")+(d||"");xa(a)}else a._isValid=!1}}else a._isValid=!1}function gb(a){var c,f,g,e,n={" GMT":" +0000",
" EDT":" -0400"," EST":" -0500"," CDT":" -0500"," CST":" -0600"," MDT":" -0600"," MST":" -0700"," PDT":" -0700"," PST":" -0800"},h;c=a._i.replace(/\([^\)]*\)|[\n\t]/g," ").replace(/(\s\s+)/g," ").replace(/^\s|\s$/g,"");if(c=lc.exec(c)){f=c[1]?"ddd"+(5===c[1].length?", ":" "):"";g="D MMM "+(10<c[2].length?"YYYY ":"YY ");e="HH:mm"+(c[4]?":ss":"");if(c[1]){var d="Sun Mon Tue Wed Thu Fri Sat".split(" ")[(new Date(c[2])).getDay()];if(c[1].substr(0,3)!==d){b(a).weekdayMismatch=!0;a._isValid=!1;return}}switch(c[5].length){case 2:0===
h?n=" +0000":(h="YXWVUTSRQPONZABCDEFGHIKLM".indexOf(c[5][1].toUpperCase())-12,n=(0>h?" -":" +")+(""+h).replace(/^-?/,"0").match(/..$/)[0]+"00");break;case 4:n=n[c[5]];break;default:n=n[" GMT"]}c[5]=n;a._i=c.splice(1).join("");a._f=f+g+e+" ZZ";xa(a);b(a).rfc2822=!0}else a._isValid=!1}function Ua(a){var b=mc.exec(a._i);null!==b?a._d=new Date(+b[1]):($a(a),!1===a._isValid&&(delete a._isValid,gb(a),!1===a._isValid&&(delete a._isValid,r.createFromInputFallback(a))))}function Ha(a,b,c){return null!=a?a:
null!=b?b:c}function T(a){var c,f=[],g;if(!a._d){g=new Date(r.now());g=a._useUTC?[g.getUTCFullYear(),g.getUTCMonth(),g.getUTCDate()]:[g.getFullYear(),g.getMonth(),g.getDate()];if(a._w&&null==a._a[Ya]&&null==a._a[db]){var e,n,h,d,t,u;e=a._w;if(null!=e.GG||null!=e.W||null!=e.E){if(t=1,u=4,n=Ha(e.GG,a._a[Ra],qa(aa(),1,4).year),h=Ha(e.W,1),d=Ha(e.E,1),1>d||7<d)c=!0}else if(t=a._locale._week.dow,u=a._locale._week.doy,h=qa(aa(),t,u),n=Ha(e.gg,a._a[Ra],h.year),h=Ha(e.w,h.week),null!=e.d){if(d=e.d,0>d||6<
d)c=!0}else if(null!=e.e){if(d=e.e+t,0>e.e||6<e.e)c=!0}else d=t;1>h||h>da(n,t,u)?b(a)._overflowWeeks=!0:null!=c?b(a)._overflowWeekday=!0:(c=ua(n,h,d,t,u),a._a[Ra]=c.year,a._dayOfYear=c.dayOfYear)}if(null!=a._dayOfYear){c=Ha(a._a[Ra],g[Ra]);if(a._dayOfYear>(ma(c)?366:365)||0===a._dayOfYear)b(a)._overflowDayOfYear=!0;c=ka(c,0,a._dayOfYear);a._a[db]=c.getUTCMonth();a._a[Ya]=c.getUTCDate()}for(c=0;3>c&&null==a._a[c];++c)a._a[c]=f[c]=g[c];for(;7>c;c++)a._a[c]=f[c]=null==a._a[c]?2===c?1:0:a._a[c];24===
a._a[Ia]&&0===a._a[Sa]&&0===a._a[eb]&&0===a._a[mb]&&(a._nextDay=!0,a._a[Ia]=0);a._d=(a._useUTC?ka:sa).apply(null,f);null!=a._tzm&&a._d.setUTCMinutes(a._d.getUTCMinutes()-a._tzm);a._nextDay&&(a._a[Ia]=24)}}function xa(a){if(a._f===r.ISO_8601)$a(a);else if(a._f===r.RFC_2822)gb(a);else{a._a=[];b(a).empty=!0;var c=""+a._i,f,g,e,n,d,t=c.length,u=0;e=ba(a._f,a._locale).match(Vb)||[];for(f=0;f<e.length;f++){n=e[f];if(g=(c.match(Q(n,a))||[])[0])d=c.substr(0,c.indexOf(g)),0<d.length&&b(a).unusedInput.push(d),
c=c.slice(c.indexOf(g)+g.length),u+=g.length;if(nb[n]){if(g?b(a).empty=!1:b(a).unusedTokens.push(n),d=a,null!=g&&h(Qb,n))Qb[n](g,d._a,d,n)}else a._strict&&!g&&b(a).unusedTokens.push(n)}b(a).charsLeftOver=t-u;0<c.length&&b(a).unusedInput.push(c);12>=a._a[Ia]&&!0===b(a).bigHour&&0<a._a[Ia]&&(b(a).bigHour=void 0);b(a).parsedDateParts=a._a.slice(0);b(a).meridiem=a._meridiem;c=a._a;f=Ia;t=a._locale;e=a._a[Ia];u=a._meridiem;null!=u&&(null!=t.meridiemHour?e=t.meridiemHour(e,u):null!=t.isPM&&((t=t.isPM(u))&&
12>e&&(e+=12),t||12!==e||(e=0)));c[f]=e;T(a);Ta(a)}}function Ba(a){if(!a._d){var b=F(a._i);a._a=p([b.year,b.month,b.day||b.date,b.hour,b.minute,b.second,b.millisecond],function(a){return a&&parseInt(a,10)});T(a)}}function fa(c){var f=c._i,h=c._f;c._locale=c._locale||Ca(c._l);if(null===f||void 0===h&&""===f)return g({nullInput:!0});"string"===typeof f&&(c._i=f=c._locale.preparse(f));if(t(f))return new n(Ta(f));if(m(f))c._d=f;else if(l(h)){var d,v,x;if(0===c._f.length)b(c).invalidFormat=!0,c._d=new Date(NaN);
else{for(f=0;f<c._f.length;f++)if(h=0,d=u({},c),null!=c._useUTC&&(d._useUTC=c._useUTC),d._f=c._f[f],xa(d),a(d)&&(h+=b(d).charsLeftOver,h+=10*b(d).unusedTokens.length,b(d).score=h,null==x||h<x))x=h,v=d;e(c,v||d)}}else h?xa(c):Xa(c);a(c)||(c._d=null);return c}function Xa(a){var b=a._i;q(b)?a._d=new Date(r.now()):m(b)?a._d=new Date(b.valueOf()):"string"===typeof b?Ua(a):l(b)?(a._a=p(b.slice(0),function(a){return parseInt(a,10)}),T(a)):d(b)?Ba(a):k(b)?a._d=new Date(b):r.createFromInputFallback(a)}function Na(a,
b,c,f,g){var e={};if(!0===c||!1===c)f=c,c=void 0;var h;if(h=d(a))a:{h=a;for(var t in h){h=!1;break a}h=!0}if(h||l(a)&&0===a.length)a=void 0;e._isAMomentObject=!0;e._useUTC=e._isUTC=g;e._l=c;e._i=a;e._f=b;e._strict=f;a=new n(Ta(fa(e)));a._nextDay&&(a.add(1,"d"),a._nextDay=void 0);return a}function aa(a,b,c,f){return Na(a,b,c,f,!1)}function cb(a,b){var c,f;1===b.length&&l(b[0])&&(b=b[0]);if(!b.length)return aa();c=b[0];for(f=1;f<b.length;++f)if(!b[f].isValid()||b[f][a](c))c=b[f];return c}function S(a){for(var b in a)if(-1===
zb.indexOf(b)||null!=a[b]&&isNaN(a[b]))return!1;b=!1;for(var c=0;c<zb.length;++c)if(a[zb[c]]){if(b)return!1;parseFloat(a[zb[c]])!==v(a[zb[c]])&&(b=!0)}return!0}function ha(a){a=F(a);var b=a.year||0,c=a.quarter||0,f=a.month||0,g=a.week||0,e=a.day||0,n=a.hour||0,h=a.minute||0,d=a.second||0,t=a.millisecond||0;this._isValid=S(a);this._milliseconds=+t+1E3*d+6E4*h+36E5*n;this._days=+e+7*g;this._months=+f+3*c+12*b;this._data={};this._locale=Ca();this._bubble()}function I(a){return a instanceof ha}function ga(a){return 0>
a?-1*Math.round(-1*a):Math.round(a)}function ja(a,b){L(a,0,0,function(){var a=this.utcOffset(),c="+";0>a&&(a=-a,c="-");return c+M(~~(a/60),2)+b+M(~~a%60,2)})}function na(a,b){var c=(b||"").match(a);if(null===c)return null;var c=((c[c.length-1]||[])+"").match(nc)||["-",0,0],f=+(60*c[1])+v(c[2]);return 0===f?0:"+"===c[0]?f:-f}function X(a,b){var c,f;return b._isUTC?(c=b.clone(),f=(t(a)||m(a)?a.valueOf():aa(a).valueOf())-c.valueOf(),c._d.setTime(c._d.valueOf()+f),r.updateOffset(c,!1),c):aa(a).local()}
function Z(){return this.isValid()?this._isUTC&&0===this._offset:!1}function P(a,b){var c=a,f=null;I(a)?c={ms:a._milliseconds,d:a._days,M:a._months}:k(a)?(c={},b?c[b]=a:c.milliseconds=a):(f=oc.exec(a))?(c="-"===f[1]?-1:1,c={y:0,d:v(f[Ya])*c,h:v(f[Ia])*c,m:v(f[Sa])*c,s:v(f[eb])*c,ms:v(ga(1E3*f[mb]))*c}):(f=pc.exec(a))?(c="-"===f[1]?-1:1,c={y:Va(f[2],c),M:Va(f[3],c),w:Va(f[4],c),d:Va(f[5],c),h:Va(f[6],c),m:Va(f[7],c),s:Va(f[8],c)}):null==c?c={}:"object"===typeof c&&("from"in c||"to"in c)&&(f=aa(c.from),
c=aa(c.to),f.isValid()&&c.isValid()?(c=X(c,f),f.isBefore(c)?c=rb(f,c):(c=rb(c,f),c.milliseconds=-c.milliseconds,c.months=-c.months),f=c):f={milliseconds:0,months:0},c={},c.ms=f.milliseconds,c.M=f.months);c=new ha(c);I(a)&&h(a,"_locale")&&(c._locale=a._locale);return c}function Va(a,b){var c=a&&parseFloat(a.replace(",","."));return(isNaN(c)?0:c)*b}function rb(a,b){var c={milliseconds:0,months:0};c.months=b.month()-a.month()+12*(b.year()-a.year());a.clone().add(c.months,"M").isAfter(b)&&--c.months;
c.milliseconds=+b-+a.clone().add(c.months,"M");return c}function wb(a,b){return function(c,f){var g;null===f||isNaN(+f)||(A(b,"moment()."+b+"(period, number) is deprecated. Please use moment()."+b+"(number, period). See http://momentjs.com/guides/#/warnings/add-inverted-param/ for more info."),g=c,c=f,f=g);g=P("string"===typeof c?+c:c,f);xb(this,g,a);return this}}function xb(a,b,c,f){var g=b._milliseconds,e=ga(b._days);b=ga(b._months);if(a.isValid()){f=null==f?!0:f;g&&a._d.setTime(a._d.valueOf()+
g*c);if(e&&(g=N(a,"Date")+e*c,a.isValid()))a._d["set"+(a._isUTC?"UTC":"")+"Date"](g);b&&ea(a,N(a,"Month")+b*c);f&&r.updateOffset(a,e||b)}}function Wa(a){if(void 0===a)return this._locale._abbr;a=Ca(a);null!=a&&(this._locale=a);return this}function tb(){return this._locale}function jb(a,b){L(0,[a,a.length],0,b)}function sb(a,b,c,f,g){var e;if(null==a)return qa(this,f,g).year;e=da(a,f,g);b>e&&(b=e);a=ua(a,b,c,f,g);a=ka(a.year,0,a.dayOfYear);this.year(a.getUTCFullYear());this.month(a.getUTCMonth());
this.date(a.getUTCDate());return this}function lb(a,b){b[mb]=v(1E3*("0."+a))}function kb(a){return a}function ab(a,b,f,g){var e=Ca();b=c().set(g,b);return e[f](b,a)}function Pa(a,b,c){k(a)&&(b=a,a=void 0);a=a||"";if(null!=b)return ab(a,b,c,"month");var f=[];for(b=0;12>b;b++)f[b]=ab(a,b,c,"month");return f}function ob(a,b,c,f){"boolean"!==typeof a&&(c=b=a,a=!1);k(b)&&(c=b,b=void 0);b=b||"";var g=Ca();a=a?g._week.dow:0;if(null!=c)return ab(b,(c+a)%7,f,"day");g=[];for(c=0;7>c;c++)g[c]=ab(b,(c+a)%7,f,
"day");return g}function ub(a,b,c,f){b=P(b,c);a._milliseconds+=f*b._milliseconds;a._days+=f*b._days;a._months+=f*b._months;return a._bubble()}function vb(a){return 0>a?Math.floor(a):Math.ceil(a)}function Qa(a){return function(){return this.as(a)}}function bb(a){return function(){return this.isValid()?this._data[a]:NaN}}function Ob(a,b,c,f,g){return g.relativeTime(b||1,!!c,a,f)}function Bb(){if(!this.isValid())return this.localeData().invalidDate();var a=Sb(this._milliseconds)/1E3,b=Sb(this._days),
c=Sb(this._months),g,e;g=f(a/60);e=f(g/60);a%=60;g%=60;var n=f(c/12),c=c%12,h=this.asSeconds();return h?(0>h?"-":"")+"P"+(n?n+"Y":"")+(c?c+"M":"")+(b?b+"D":"")+(e||g||a?"T":"")+(e?e+"H":"")+(g?g+"M":"")+(a?a+"S":""):"P0D"}var Tb,ec=Array.prototype.some?Array.prototype.some:function(a){for(var b=Object(this),c=b.length>>>0,f=0;f<c;f++)if(f in b&&a.call(this,b[f],f,b))return!0;return!1},Kb=r.momentProperties=[],Lb=!1,Ub={};r.suppressDeprecationWarnings=!1;r.deprecationHandler=null;var fc=Object.keys?
Object.keys:function(a){var b,c=[];for(b in a)h(a,b)&&c.push(b);return c},pb={},La={},Vb=/(\[[^\[]*\])|(\\)?([Hh]mm(ss)?|Mo|MM?M?M?|Do|DDDo|DD?D?D?|ddd?d?|do?|w[o|w]?|W[o|W]?|Qo?|YYYYYY|YYYYY|YYYY|YY|gg(ggg?)?|GG(GGG?)?|e|E|a|A|hh?|HH?|kk?|mm?|ss?|S{1,9}|x|X|zz?|ZZ?|.)/g,Cb=/(\[[^\[]*\])|(\\)?(LTS|LT|LL?L?L?|l{1,4})/g,qb={},nb={},Wb=/\d/,Oa=/\d\d/,Xb=/\d{3}/,Mb=/\d{4}/,Fb=/[+-]?\d{6}/,ya=/\d\d?/,Zb=/\d\d\d\d?/,Yb=/\d\d\d\d\d\d?/,Db=/\d{1,3}/,Nb=/\d{1,4}/,Eb=/[+-]?\d{1,6}/,qc=/\d+/,Ib=/[+-]?\d+/,rc=
/Z|[+-]\d\d:?\d\d/gi,Jb=/Z|[+-]\d\d(?::?\d\d)?/gi,Ab=/[0-9]*['a-z\u00A0-\u05FF\u0700-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]+|[\u0600-\u06FF\/]+(\s*?[\u0600-\u06FF]+){1,2}/i,Pb={},Qb={},Ra=0,db=1,Ya=2,Ia=3,Sa=4,eb=5,mb=6,gc=7,hc=8,Ka=Array.prototype.indexOf?Array.prototype.indexOf:function(a){var b;for(b=0;b<this.length;++b)if(this[b]===a)return b;return-1};L("M",["MM",2],"Mo",function(){return this.month()+1});L("MMM",0,0,function(a){return this.localeData().monthsShort(this,a)});L("MMMM",0,0,function(a){return this.localeData().months(this,
a)});E("month","M");La.month=8;O("M",ya);O("MM",ya,Oa);O("MMM",function(a,b){return b.monthsShortRegex(a)});O("MMMM",function(a,b){return b.monthsRegex(a)});Y(["M","MM"],function(a,b){b[db]=v(a)-1});Y(["MMM","MMMM"],function(a,c,f,g){g=f._locale.monthsParse(a,g,f._strict);null!=g?c[db]=g:b(f).invalidMonth=a});var ac=/D[oD]?(\[[^\[\]]*\]|\s)+MMMM?/;L("Y",0,0,function(){var a=this.year();return 9999>=a?""+a:"+"+a});L(0,["YY",2],0,function(){return this.year()%100});L(0,["YYYY",4],0,"year");L(0,["YYYYY",
5],0,"year");L(0,["YYYYYY",6,!0],0,"year");E("year","y");La.year=1;O("Y",Ib);O("YY",ya,Oa);O("YYYY",Nb,Mb);O("YYYYY",Eb,Fb);O("YYYYYY",Eb,Fb);Y(["YYYYY","YYYYYY"],Ra);Y("YYYY",function(a,b){b[Ra]=2===a.length?r.parseTwoDigitYear(a):v(a)});Y("YY",function(a,b){b[Ra]=r.parseTwoDigitYear(a)});Y("Y",function(a,b){b[Ra]=parseInt(a,10)});r.parseTwoDigitYear=function(a){return v(a)+(68<v(a)?1900:2E3)};var bc=J("FullYear",!0);L("w",["ww",2],"wo","week");L("W",["WW",2],"Wo","isoWeek");E("week","w");E("isoWeek",
"W");La.week=5;La.isoWeek=5;O("w",ya);O("ww",ya,Oa);O("W",ya);O("WW",ya,Oa);ca(["w","ww","W","WW"],function(a,b,c,f){b[f.substr(0,1)]=v(a)});L("d",0,"do","day");L("dd",0,0,function(a){return this.localeData().weekdaysMin(this,a)});L("ddd",0,0,function(a){return this.localeData().weekdaysShort(this,a)});L("dddd",0,0,function(a){return this.localeData().weekdays(this,a)});L("e",0,0,"weekday");L("E",0,0,"isoWeekday");E("day","d");E("weekday","e");E("isoWeekday","E");La.day=11;La.weekday=11;La.isoWeekday=
11;O("d",ya);O("e",ya);O("E",ya);O("dd",function(a,b){return b.weekdaysMinRegex(a)});O("ddd",function(a,b){return b.weekdaysShortRegex(a)});O("dddd",function(a,b){return b.weekdaysRegex(a)});ca(["dd","ddd","dddd"],function(a,c,f,g){g=f._locale.weekdaysParse(a,g,f._strict);null!=g?c.d=g:b(f).invalidWeekday=a});ca(["d","e","E"],function(a,b,c,f){b[f]=v(a)});L("H",["HH",2],0,"hour");L("h",["hh",2],0,za);L("k",["kk",2],0,function(){return this.hours()||24});L("hmm",0,0,function(){return""+za.apply(this)+
M(this.minutes(),2)});L("hmmss",0,0,function(){return""+za.apply(this)+M(this.minutes(),2)+M(this.seconds(),2)});L("Hmm",0,0,function(){return""+this.hours()+M(this.minutes(),2)});L("Hmmss",0,0,function(){return""+this.hours()+M(this.minutes(),2)+M(this.seconds(),2)});ra("a",!0);ra("A",!1);E("hour","h");La.hour=13;O("a",oa);O("A",oa);O("H",ya);O("h",ya);O("k",ya);O("HH",ya,Oa);O("hh",ya,Oa);O("kk",ya,Oa);O("hmm",Zb);O("hmmss",Yb);O("Hmm",Zb);O("Hmmss",Yb);Y(["H","HH"],Ia);Y(["k","kk"],function(a,
b,c){a=v(a);b[Ia]=24===a?0:a});Y(["a","A"],function(a,b,c){c._isPm=c._locale.isPM(a);c._meridiem=a});Y(["h","hh"],function(a,c,f){c[Ia]=v(a);b(f).bigHour=!0});Y("hmm",function(a,c,f){var g=a.length-2;c[Ia]=v(a.substr(0,g));c[Sa]=v(a.substr(g));b(f).bigHour=!0});Y("hmmss",function(a,c,f){var g=a.length-4,e=a.length-2;c[Ia]=v(a.substr(0,g));c[Sa]=v(a.substr(g,2));c[eb]=v(a.substr(e));b(f).bigHour=!0});Y("Hmm",function(a,b,c){c=a.length-2;b[Ia]=v(a.substr(0,c));b[Sa]=v(a.substr(c))});Y("Hmmss",function(a,
b,c){c=a.length-4;var f=a.length-2;b[Ia]=v(a.substr(0,c));b[Sa]=v(a.substr(c,2));b[eb]=v(a.substr(f))});var sc=J("Hours",!0),$b={calendar:{sameDay:"[Today at] LT",nextDay:"[Tomorrow at] LT",nextWeek:"dddd [at] LT",lastDay:"[Yesterday at] LT",lastWeek:"[Last] dddd [at] LT",sameElse:"L"},longDateFormat:{LTS:"h:mm:ss A",LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D, YYYY",LLL:"MMMM D, YYYY h:mm A",LLLL:"dddd, MMMM D, YYYY h:mm A"},invalidDate:"Invalid date",ordinal:"%d",dayOfMonthOrdinalParse:/\d{1,2}/,relativeTime:{future:"in %s",
past:"%s ago",s:"a few seconds",ss:"%d seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",M:"a month",MM:"%d months",y:"a year",yy:"%d years"},months:"January February March April May June July August September October November December".split(" "),monthsShort:"Jan Feb Mar Apr May Jun Jul Aug Sep Oct Nov Dec".split(" "),week:{dow:0,doy:6},weekdays:"Sunday Monday Tuesday Wednesday Thursday Friday Saturday".split(" "),weekdaysMin:"Su Mo Tu We Th Fr Sa".split(" "),
weekdaysShort:"Sun Mon Tue Wed Thu Fri Sat".split(" "),meridiemParse:/[ap]\.?m?\.?/i},Da={},yb={},Gb,ic=/^\s*((?:[+-]\d{6}|\d{4})-(?:\d\d-\d\d|W\d\d-\d|W\d\d|\d\d\d|\d\d))(?:(T| )(\d\d(?::\d\d(?::\d\d(?:[.,]\d+)?)?)?)([\+\-]\d\d(?::?\d\d)?|\s*Z)?)?$/,jc=/^\s*((?:[+-]\d{6}|\d{4})(?:\d\d\d\d|W\d\d\d|W\d\d|\d\d\d|\d\d))(?:(T| )(\d\d(?:\d\d(?:\d\d(?:[.,]\d+)?)?)?)([\+\-]\d\d(?::?\d\d)?|\s*Z)?)?$/,kc=/Z|[+-]\d\d(?::?\d\d)?/,Hb=[["YYYYYY-MM-DD",/[+-]\d{6}-\d\d-\d\d/],["YYYY-MM-DD",/\d{4}-\d\d-\d\d/],["GGGG-[W]WW-E",
/\d{4}-W\d\d-\d/],["GGGG-[W]WW",/\d{4}-W\d\d/,!1],["YYYY-DDD",/\d{4}-\d{3}/],["YYYY-MM",/\d{4}-\d\d/,!1],["YYYYYYMMDD",/[+-]\d{10}/],["YYYYMMDD",/\d{8}/],["GGGG[W]WWE",/\d{4}W\d{3}/],["GGGG[W]WW",/\d{4}W\d{2}/,!1],["YYYYDDD",/\d{7}/]],Rb=[["HH:mm:ss.SSSS",/\d\d:\d\d:\d\d\.\d+/],["HH:mm:ss,SSSS",/\d\d:\d\d:\d\d,\d+/],["HH:mm:ss",/\d\d:\d\d:\d\d/],["HH:mm",/\d\d:\d\d/],["HHmmss.SSSS",/\d\d\d\d\d\d\.\d+/],["HHmmss,SSSS",/\d\d\d\d\d\d,\d+/],["HHmmss",/\d\d\d\d\d\d/],["HHmm",/\d\d\d\d/],["HH",/\d\d/]],
mc=/^\/?Date\((\-?\d+)/i,lc=/^((?:Mon|Tue|Wed|Thu|Fri|Sat|Sun),?\s)?(\d?\d\s(?:Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)\s(?:\d\d)?\d\d\s)(\d\d:\d\d)(\:\d\d)?(\s(?:UT|GMT|[ECMP][SD]T|[A-IK-Za-ik-z]|[+-]\d{4}))$/;r.createFromInputFallback=z("value provided is not in a recognized RFC2822 or ISO format. moment construction falls back to js Date(), which is not reliable across all browsers and versions. Non RFC2822/ISO date formats are discouraged and will be removed in an upcoming major release. Please refer to http://momentjs.com/guides/#/warnings/js-date/ for more info.",
function(a){a._d=new Date(a._i+(a._useUTC?" UTC":""))});r.ISO_8601=function(){};r.RFC_2822=function(){};var tc=z("moment().min is deprecated, use moment.max instead. http://momentjs.com/guides/#/warnings/min-max/",function(){var a=aa.apply(null,arguments);return this.isValid()&&a.isValid()?a<this?this:a:g()}),uc=z("moment().max is deprecated, use moment.min instead. http://momentjs.com/guides/#/warnings/min-max/",function(){var a=aa.apply(null,arguments);return this.isValid()&&a.isValid()?a>this?
this:a:g()}),zb="year quarter month week day hour minute second millisecond".split(" ");ja("Z",":");ja("ZZ","");O("Z",Jb);O("ZZ",Jb);Y(["Z","ZZ"],function(a,b,c){c._useUTC=!0;c._tzm=na(Jb,a)});var nc=/([\+\-]|\d\d)/gi;r.updateOffset=function(){};var oc=/^(\-)?(?:(\d*)[. ])?(\d+)\:(\d+)(?:\:(\d+)(\.\d*)?)?$/,pc=/^(-)?P(?:(-?[0-9,.]*)Y)?(?:(-?[0-9,.]*)M)?(?:(-?[0-9,.]*)W)?(?:(-?[0-9,.]*)D)?(?:T(?:(-?[0-9,.]*)H)?(?:(-?[0-9,.]*)M)?(?:(-?[0-9,.]*)S)?)?$/;P.fn=ha.prototype;P.invalid=function(){return P(NaN)};
var vc=wb(1,"add"),wc=wb(-1,"subtract");r.defaultFormat="YYYY-MM-DDTHH:mm:ssZ";r.defaultFormatUtc="YYYY-MM-DDTHH:mm:ss[Z]";var cc=z("moment().lang() is deprecated. Instead, use moment().localeData() to get the language configuration. Use moment().locale() to change languages.",function(a){return void 0===a?this.localeData():this.locale(a)});L(0,["gg",2],0,function(){return this.weekYear()%100});L(0,["GG",2],0,function(){return this.isoWeekYear()%100});jb("gggg","weekYear");jb("ggggg","weekYear");
jb("GGGG","isoWeekYear");jb("GGGGG","isoWeekYear");E("weekYear","gg");E("isoWeekYear","GG");La.weekYear=1;La.isoWeekYear=1;O("G",Ib);O("g",Ib);O("GG",ya,Oa);O("gg",ya,Oa);O("GGGG",Nb,Mb);O("gggg",Nb,Mb);O("GGGGG",Eb,Fb);O("ggggg",Eb,Fb);ca(["gggg","ggggg","GGGG","GGGGG"],function(a,b,c,f){b[f.substr(0,2)]=v(a)});ca(["gg","GG"],function(a,b,c,f){b[f]=r.parseTwoDigitYear(a)});L("Q",0,"Qo","quarter");E("quarter","Q");La.quarter=7;O("Q",Wb);Y("Q",function(a,b){b[db]=3*(v(a)-1)});L("D",["DD",2],"Do","date");
E("date","D");La.date=9;O("D",ya);O("DD",ya,Oa);O("Do",function(a,b){return a?b._dayOfMonthOrdinalParse||b._ordinalParse:b._dayOfMonthOrdinalParseLenient});Y(["D","DD"],Ya);Y("Do",function(a,b){b[Ya]=v(a.match(ya)[0],10)});var dc=J("Date",!0);L("DDD",["DDDD",3],"DDDo","dayOfYear");E("dayOfYear","DDD");La.dayOfYear=4;O("DDD",Db);O("DDDD",Xb);Y(["DDD","DDDD"],function(a,b,c){c._dayOfYear=v(a)});L("m",["mm",2],0,"minute");E("minute","m");La.minute=14;O("m",ya);O("mm",ya,Oa);Y(["m","mm"],Sa);var xc=J("Minutes",
!1);L("s",["ss",2],0,"second");E("second","s");La.second=15;O("s",ya);O("ss",ya,Oa);Y(["s","ss"],eb);var yc=J("Seconds",!1);L("S",0,0,function(){return~~(this.millisecond()/100)});L(0,["SS",2],0,function(){return~~(this.millisecond()/10)});L(0,["SSS",3],0,"millisecond");L(0,["SSSS",4],0,function(){return 10*this.millisecond()});L(0,["SSSSS",5],0,function(){return 100*this.millisecond()});L(0,["SSSSSS",6],0,function(){return 1E3*this.millisecond()});L(0,["SSSSSSS",7],0,function(){return 1E4*this.millisecond()});
L(0,["SSSSSSSS",8],0,function(){return 1E5*this.millisecond()});L(0,["SSSSSSSSS",9],0,function(){return 1E6*this.millisecond()});E("millisecond","ms");La.millisecond=16;O("S",Db,Wb);O("SS",Db,Oa);O("SSS",Db,Xb);var hb;for(hb="SSSS";9>=hb.length;hb+="S")O(hb,qc);for(hb="S";9>=hb.length;hb+="S")Y(hb,lb);var zc=J("Milliseconds",!1);L("z",0,0,"zoneAbbr");L("zz",0,0,"zoneName");var V=n.prototype;V.add=vc;V.calendar=function(a,b){var c=a||aa(),f=X(c,this).startOf("day"),f=r.calendarFormat(this,f)||"sameElse",
g=b&&(y(b[f])?b[f].call(this,c):b[f]);return this.format(g||this.localeData().calendar(f,this,aa(c)))};V.clone=function(){return new n(this)};V.diff=function(a,b,c){var g;if(!this.isValid())return NaN;a=X(a,this);if(!a.isValid())return NaN;g=6E4*(a.utcOffset()-this.utcOffset());b=D(b);if("year"===b||"month"===b||"quarter"===b){g=12*(a.year()-this.year())+(a.month()-this.month());var e=this.clone().add(g,"months"),n;0>a-e?(n=this.clone().add(g-1,"months"),a=(a-e)/(e-n)):(n=this.clone().add(g+1,"months"),
a=(a-e)/(n-e));a=-(g+a)||0;"quarter"===b?a/=3:"year"===b&&(a/=12)}else a=this-a,a="second"===b?a/1E3:"minute"===b?a/6E4:"hour"===b?a/36E5:"day"===b?(a-g)/864E5:"week"===b?(a-g)/6048E5:a;return c?a:f(a)};V.endOf=function(a){a=D(a);if(void 0===a||"millisecond"===a)return this;"date"===a&&(a="day");return this.startOf(a).add(1,"isoWeek"===a?"week":a).subtract(1,"ms")};V.format=function(a){a||(a=this.isUtc()?r.defaultFormatUtc:r.defaultFormat);a=R(this,a);return this.localeData().postformat(a)};V.from=
function(a,b){return this.isValid()&&(t(a)&&a.isValid()||aa(a).isValid())?P({to:this,from:a}).locale(this.locale()).humanize(!b):this.localeData().invalidDate()};V.fromNow=function(a){return this.from(aa(),a)};V.to=function(a,b){return this.isValid()&&(t(a)&&a.isValid()||aa(a).isValid())?P({from:this,to:a}).locale(this.locale()).humanize(!b):this.localeData().invalidDate()};V.toNow=function(a){return this.to(aa(),a)};V.get=function(a){a=D(a);return y(this[a])?this[a]():this};V.invalidAt=function(){return b(this).overflow};
V.isAfter=function(a,b){var c=t(a)?a:aa(a);if(!this.isValid()||!c.isValid())return!1;b=D(q(b)?"millisecond":b);return"millisecond"===b?this.valueOf()>c.valueOf():c.valueOf()<this.clone().startOf(b).valueOf()};V.isBefore=function(a,b){var c=t(a)?a:aa(a);if(!this.isValid()||!c.isValid())return!1;b=D(q(b)?"millisecond":b);return"millisecond"===b?this.valueOf()<c.valueOf():this.clone().endOf(b).valueOf()<c.valueOf()};V.isBetween=function(a,b,c,f){f=f||"()";return("("===f[0]?this.isAfter(a,c):!this.isBefore(a,
c))&&(")"===f[1]?this.isBefore(b,c):!this.isAfter(b,c))};V.isSame=function(a,b){var c=t(a)?a:aa(a);if(!this.isValid()||!c.isValid())return!1;b=D(b||"millisecond");if("millisecond"===b)return this.valueOf()===c.valueOf();c=c.valueOf();return this.clone().startOf(b).valueOf()<=c&&c<=this.clone().endOf(b).valueOf()};V.isSameOrAfter=function(a,b){return this.isSame(a,b)||this.isAfter(a,b)};V.isSameOrBefore=function(a,b){return this.isSame(a,b)||this.isBefore(a,b)};V.isValid=function(){return a(this)};
V.lang=cc;V.locale=Wa;V.localeData=tb;V.max=uc;V.min=tc;V.parsingFlags=function(){return e({},b(this))};V.set=function(a,b){if("object"===typeof a){a=F(a);for(var c=G(a),f=0;f<c.length;f++)this[c[f].unit](a[c[f].unit])}else if(a=D(a),y(this[a]))return this[a](b);return this};V.startOf=function(a){a=D(a);switch(a){case "year":this.month(0);case "quarter":case "month":this.date(1);case "week":case "isoWeek":case "day":case "date":this.hours(0);case "hour":this.minutes(0);case "minute":this.seconds(0);
case "second":this.milliseconds(0)}"week"===a&&this.weekday(0);"isoWeek"===a&&this.isoWeekday(1);"quarter"===a&&this.month(3*Math.floor(this.month()/3));return this};V.subtract=wc;V.toArray=function(){return[this.year(),this.month(),this.date(),this.hour(),this.minute(),this.second(),this.millisecond()]};V.toObject=function(){return{years:this.year(),months:this.month(),date:this.date(),hours:this.hours(),minutes:this.minutes(),seconds:this.seconds(),milliseconds:this.milliseconds()}};V.toDate=function(){return new Date(this.valueOf())};
V.toISOString=function(){if(!this.isValid())return null;var a=this.clone().utc();return 0>a.year()||9999<a.year()?R(a,"YYYYYY-MM-DD[T]HH:mm:ss.SSS[Z]"):y(Date.prototype.toISOString)?this.toDate().toISOString():R(a,"YYYY-MM-DD[T]HH:mm:ss.SSS[Z]")};V.inspect=function(){if(!this.isValid())return"moment.invalid(/* "+this._i+" */)";var a="moment",b="";this.isLocal()||(a=0===this.utcOffset()?"moment.utc":"moment.parseZone",b="Z");var a="["+a+'("]',c=0<=this.year()&&9999>=this.year()?"YYYY":"YYYYYY";return this.format(a+
c+"-MM-DD[T]HH:mm:ss.SSS"+(b+'[")]'))};V.toJSON=function(){return this.isValid()?this.toISOString():null};V.toString=function(){return this.clone().locale("en").format("ddd MMM DD YYYY HH:mm:ss [GMT]ZZ")};V.unix=function(){return Math.floor(this.valueOf()/1E3)};V.valueOf=function(){return this._d.valueOf()-6E4*(this._offset||0)};V.creationData=function(){return{input:this._i,format:this._f,locale:this._locale,isUTC:this._isUTC,strict:this._strict}};V.year=bc;V.isLeapYear=function(){return ma(this.year())};
V.weekYear=function(a){return sb.call(this,a,this.week(),this.weekday(),this.localeData()._week.dow,this.localeData()._week.doy)};V.isoWeekYear=function(a){return sb.call(this,a,this.isoWeek(),this.isoWeekday(),1,4)};V.quarter=V.quarters=function(a){return null==a?Math.ceil((this.month()+1)/3):this.month(3*(a-1)+this.month()%3)};V.month=va;V.daysInMonth=function(){return H(this.year(),this.month())};V.week=V.weeks=function(a){var b=this.localeData().week(this);return null==a?b:this.add(7*(a-b),"d")};
V.isoWeek=V.isoWeeks=function(a){var b=qa(this,1,4).week;return null==a?b:this.add(7*(a-b),"d")};V.weeksInYear=function(){var a=this.localeData()._week;return da(this.year(),a.dow,a.doy)};V.isoWeeksInYear=function(){return da(this.year(),1,4)};V.date=dc;V.day=V.days=function(a){if(!this.isValid())return null!=a?this:NaN;var b=this._isUTC?this._d.getUTCDay():this._d.getDay();if(null!=a){var c=this.localeData();"string"===typeof a&&(isNaN(a)?(a=c.weekdaysParse(a),a="number"===typeof a?a:null):a=parseInt(a,
10));return this.add(a-b,"d")}return b};V.weekday=function(a){if(!this.isValid())return null!=a?this:NaN;var b=(this.day()+7-this.localeData()._week.dow)%7;return null==a?b:this.add(a-b,"d")};V.isoWeekday=function(a){if(!this.isValid())return null!=a?this:NaN;if(null!=a){var b=this.localeData();a="string"===typeof a?b.weekdaysParse(a)%7||7:isNaN(a)?null:a;return this.day(this.day()%7?a:a-7)}return this.day()||7};V.dayOfYear=function(a){var b=Math.round((this.clone().startOf("day")-this.clone().startOf("year"))/
864E5)+1;return null==a?b:this.add(a-b,"d")};V.hour=V.hours=sc;V.minute=V.minutes=xc;V.second=V.seconds=yc;V.millisecond=V.milliseconds=zc;V.utcOffset=function(a,b,c){var f=this._offset||0,g;if(!this.isValid())return null!=a?this:NaN;if(null!=a){if("string"===typeof a){if(a=na(Jb,a),null===a)return this}else 16>Math.abs(a)&&!c&&(a*=60);!this._isUTC&&b&&(g=15*-Math.round(this._d.getTimezoneOffset()/15));this._offset=a;this._isUTC=!0;null!=g&&this.add(g,"m");f!==a&&(!b||this._changeInProgress?xb(this,
P(a-f,"m"),1,!1):this._changeInProgress||(this._changeInProgress=!0,r.updateOffset(this,!0),this._changeInProgress=null));return this}return this._isUTC?f:15*-Math.round(this._d.getTimezoneOffset()/15)};V.utc=function(a){return this.utcOffset(0,a)};V.local=function(a){this._isUTC&&(this.utcOffset(0,a),this._isUTC=!1,a&&this.subtract(15*-Math.round(this._d.getTimezoneOffset()/15),"m"));return this};V.parseZone=function(){if(null!=this._tzm)this.utcOffset(this._tzm,!1,!0);else if("string"===typeof this._i){var a=
na(rc,this._i);null!=a?this.utcOffset(a):this.utcOffset(0,!0)}return this};V.hasAlignedHourOffset=function(a){if(!this.isValid())return!1;a=a?aa(a).utcOffset():0;return 0===(this.utcOffset()-a)%60};V.isDST=function(){return this.utcOffset()>this.clone().month(0).utcOffset()||this.utcOffset()>this.clone().month(5).utcOffset()};V.isLocal=function(){return this.isValid()?!this._isUTC:!1};V.isUtcOffset=function(){return this.isValid()?this._isUTC:!1};V.isUtc=Z;V.isUTC=Z;V.zoneAbbr=function(){return this._isUTC?
"UTC":""};V.zoneName=function(){return this._isUTC?"Coordinated Universal Time":""};V.dates=z("dates accessor is deprecated. Use date instead.",dc);V.months=z("months accessor is deprecated. Use month instead",va);V.years=z("years accessor is deprecated. Use year instead",bc);V.zone=z("moment().zone is deprecated, use moment().utcOffset instead. http://momentjs.com/guides/#/warnings/zone/",function(a,b){return null!=a?("string"!==typeof a&&(a=-a),this.utcOffset(a,b),this):-this.utcOffset()});V.isDSTShifted=
z("isDSTShifted is deprecated. See http://momentjs.com/guides/#/warnings/dst-shifted/ for more information",function(){if(!q(this._isDSTShifted))return this._isDSTShifted;var a={};u(a,this);a=fa(a);if(a._a){var b=a._isUTC?c(a._a):aa(a._a);this._isDSTShifted=this.isValid()&&0<x(a._a,b.toArray())}else this._isDSTShifted=!1;return this._isDSTShifted});var wa=C.prototype;wa.calendar=function(a,b,c){a=this._calendar[a]||this._calendar.sameElse;return y(a)?a.call(b,c):a};wa.longDateFormat=function(a){var b=
this._longDateFormat[a],c=this._longDateFormat[a.toUpperCase()];if(b||!c)return b;this._longDateFormat[a]=c.replace(/MMMM|MM|DD|dddd/g,function(a){return a.slice(1)});return this._longDateFormat[a]};wa.invalidDate=function(){return this._invalidDate};wa.ordinal=function(a){return this._ordinal.replace("%d",a)};wa.preparse=kb;wa.postformat=kb;wa.relativeTime=function(a,b,c,f){var g=this._relativeTime[c];return y(g)?g(a,b,c,f):g.replace(/%d/i,a)};wa.pastFuture=function(a,b){var c=this._relativeTime[0<
a?"future":"past"];return y(c)?c(b):c.replace(/%s/i,b)};wa.set=function(a){var b,c;for(c in a)b=a[c],y(b)?this[c]=b:this["_"+c]=b;this._config=a;this._dayOfMonthOrdinalParseLenient=new RegExp((this._dayOfMonthOrdinalParse.source||this._ordinalParse.source)+"|"+/\d{1,2}/.source)};wa.months=function(a,b){return a?l(this._months)?this._months[a.month()]:this._months[(this._months.isFormat||ac).test(b)?"format":"standalone"][a.month()]:l(this._months)?this._months:this._months.standalone};wa.monthsShort=
function(a,b){return a?l(this._monthsShort)?this._monthsShort[a.month()]:this._monthsShort[ac.test(b)?"format":"standalone"][a.month()]:l(this._monthsShort)?this._monthsShort:this._monthsShort.standalone};wa.monthsParse=function(a,b,f){var g,e;if(this._monthsParseExact){a:{a=a.toLocaleLowerCase();if(!this._monthsParse)for(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[],g=0;12>g;++g)e=c([2E3,g]),this._shortMonthsParse[g]=this.monthsShort(e,"").toLocaleLowerCase(),this._longMonthsParse[g]=
this.months(e,"").toLocaleLowerCase();if(f)b="MMM"===b?Ka.call(this._shortMonthsParse,a):Ka.call(this._longMonthsParse,a);else if("MMM"===b){b=Ka.call(this._shortMonthsParse,a);if(-1!==b)break a;b=Ka.call(this._longMonthsParse,a)}else{b=Ka.call(this._longMonthsParse,a);if(-1!==b)break a;b=Ka.call(this._shortMonthsParse,a)}b=-1!==b?b:null}return b}this._monthsParse||(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[]);for(g=0;12>g;g++)if(e=c([2E3,g]),f&&!this._longMonthsParse[g]&&
(this._longMonthsParse[g]=new RegExp("^"+this.months(e,"").replace(".","")+"$","i"),this._shortMonthsParse[g]=new RegExp("^"+this.monthsShort(e,"").replace(".","")+"$","i")),f||this._monthsParse[g]||(e="^"+this.months(e,"")+"|^"+this.monthsShort(e,""),this._monthsParse[g]=new RegExp(e.replace(".",""),"i")),f&&"MMMM"===b&&this._longMonthsParse[g].test(a)||f&&"MMM"===b&&this._shortMonthsParse[g].test(a)||!f&&this._monthsParse[g].test(a))return g};wa.monthsRegex=function(a){if(this._monthsParseExact)return h(this,
"_monthsRegex")||la.call(this),a?this._monthsStrictRegex:this._monthsRegex;h(this,"_monthsRegex")||(this._monthsRegex=Ab);return this._monthsStrictRegex&&a?this._monthsStrictRegex:this._monthsRegex};wa.monthsShortRegex=function(a){if(this._monthsParseExact)return h(this,"_monthsRegex")||la.call(this),a?this._monthsShortStrictRegex:this._monthsShortRegex;h(this,"_monthsShortRegex")||(this._monthsShortRegex=Ab);return this._monthsShortStrictRegex&&a?this._monthsShortStrictRegex:this._monthsShortRegex};
wa.week=function(a){return qa(a,this._week.dow,this._week.doy).week};wa.firstDayOfYear=function(){return this._week.doy};wa.firstDayOfWeek=function(){return this._week.dow};wa.weekdays=function(a,b){return a?l(this._weekdays)?this._weekdays[a.day()]:this._weekdays[this._weekdays.isFormat.test(b)?"format":"standalone"][a.day()]:l(this._weekdays)?this._weekdays:this._weekdays.standalone};wa.weekdaysMin=function(a){return a?this._weekdaysMin[a.day()]:this._weekdaysMin};wa.weekdaysShort=function(a){return a?
this._weekdaysShort[a.day()]:this._weekdaysShort};wa.weekdaysParse=function(a,b,f){var g,e;if(this._weekdaysParseExact)return Aa.call(this,a,b,f);this._weekdaysParse||(this._weekdaysParse=[],this._minWeekdaysParse=[],this._shortWeekdaysParse=[],this._fullWeekdaysParse=[]);for(g=0;7>g;g++)if(e=c([2E3,1]).day(g),f&&!this._fullWeekdaysParse[g]&&(this._fullWeekdaysParse[g]=new RegExp("^"+this.weekdays(e,"").replace(".",".?")+"$","i"),this._shortWeekdaysParse[g]=new RegExp("^"+this.weekdaysShort(e,"").replace(".",
".?")+"$","i"),this._minWeekdaysParse[g]=new RegExp("^"+this.weekdaysMin(e,"").replace(".",".?")+"$","i")),this._weekdaysParse[g]||(e="^"+this.weekdays(e,"")+"|^"+this.weekdaysShort(e,"")+"|^"+this.weekdaysMin(e,""),this._weekdaysParse[g]=new RegExp(e.replace(".",""),"i")),f&&"dddd"===b&&this._fullWeekdaysParse[g].test(a)||f&&"ddd"===b&&this._shortWeekdaysParse[g].test(a)||f&&"dd"===b&&this._minWeekdaysParse[g].test(a)||!f&&this._weekdaysParse[g].test(a))return g};wa.weekdaysRegex=function(a){if(this._weekdaysParseExact)return h(this,
"_weekdaysRegex")||Ea.call(this),a?this._weekdaysStrictRegex:this._weekdaysRegex;h(this,"_weekdaysRegex")||(this._weekdaysRegex=Ab);return this._weekdaysStrictRegex&&a?this._weekdaysStrictRegex:this._weekdaysRegex};wa.weekdaysShortRegex=function(a){if(this._weekdaysParseExact)return h(this,"_weekdaysRegex")||Ea.call(this),a?this._weekdaysShortStrictRegex:this._weekdaysShortRegex;h(this,"_weekdaysShortRegex")||(this._weekdaysShortRegex=Ab);return this._weekdaysShortStrictRegex&&a?this._weekdaysShortStrictRegex:
this._weekdaysShortRegex};wa.weekdaysMinRegex=function(a){if(this._weekdaysParseExact)return h(this,"_weekdaysRegex")||Ea.call(this),a?this._weekdaysMinStrictRegex:this._weekdaysMinRegex;h(this,"_weekdaysMinRegex")||(this._weekdaysMinRegex=Ab);return this._weekdaysMinStrictRegex&&a?this._weekdaysMinStrictRegex:this._weekdaysMinRegex};wa.isPM=function(a){return"p"===(a+"").toLowerCase().charAt(0)};wa.meridiem=function(a,b,c){return 11<a?c?"pm":"PM":c?"am":"AM"};Ja("en",{dayOfMonthOrdinalParse:/\d{1,2}(th|st|nd|rd)/,
ordinal:function(a){var b=a%10,b=1===v(a%100/10)?"th":1===b?"st":2===b?"nd":3===b?"rd":"th";return a+b}});r.lang=z("moment.lang is deprecated. Use moment.locale instead.",Ja);r.langData=z("moment.langData is deprecated. Use moment.localeData instead.",Ca);var fb=Math.abs,Ac=Qa("ms"),Bc=Qa("s"),Cc=Qa("m"),Dc=Qa("h"),Ec=Qa("d"),Fc=Qa("w"),Gc=Qa("M"),Hc=Qa("y"),Ic=bb("milliseconds"),Jc=bb("seconds"),Kc=bb("minutes"),Lc=bb("hours"),Mc=bb("days"),Nc=bb("months"),Oc=bb("years"),ib=Math.round,Za={ss:44,
s:45,m:45,h:22,d:26,M:11},Sb=Math.abs,pa=ha.prototype;pa.isValid=function(){return this._isValid};pa.abs=function(){var a=this._data;this._milliseconds=fb(this._milliseconds);this._days=fb(this._days);this._months=fb(this._months);a.milliseconds=fb(a.milliseconds);a.seconds=fb(a.seconds);a.minutes=fb(a.minutes);a.hours=fb(a.hours);a.months=fb(a.months);a.years=fb(a.years);return this};pa.add=function(a,b){return ub(this,a,b,1)};pa.subtract=function(a,b){return ub(this,a,b,-1)};pa.as=function(a){if(!this.isValid())return NaN;
var b,c=this._milliseconds;a=D(a);if("month"===a||"year"===a)return b=this._days+c/864E5,b=this._months+4800*b/146097,"month"===a?b:b/12;b=this._days+Math.round(146097*this._months/4800);switch(a){case "week":return b/7+c/6048E5;case "day":return b+c/864E5;case "hour":return 24*b+c/36E5;case "minute":return 1440*b+c/6E4;case "second":return 86400*b+c/1E3;case "millisecond":return Math.floor(864E5*b)+c;default:throw Error("Unknown unit "+a);}};pa.asMilliseconds=Ac;pa.asSeconds=Bc;pa.asMinutes=Cc;pa.asHours=
Dc;pa.asDays=Ec;pa.asWeeks=Fc;pa.asMonths=Gc;pa.asYears=Hc;pa.valueOf=function(){return this.isValid()?this._milliseconds+864E5*this._days+this._months%12*2592E6+31536E6*v(this._months/12):NaN};pa._bubble=function(){var a=this._milliseconds,b=this._days,c=this._months,g=this._data;0<=a&&0<=b&&0<=c||0>=a&&0>=b&&0>=c||(a+=864E5*vb(146097*c/4800+b),c=b=0);g.milliseconds=a%1E3;a=f(a/1E3);g.seconds=a%60;a=f(a/60);g.minutes=a%60;a=f(a/60);g.hours=a%24;b+=f(a/24);a=f(4800*b/146097);c+=a;b-=vb(146097*a/4800);
a=f(c/12);g.days=b;g.months=c%12;g.years=a;return this};pa.get=function(a){a=D(a);return this.isValid()?this[a+"s"]():NaN};pa.milliseconds=Ic;pa.seconds=Jc;pa.minutes=Kc;pa.hours=Lc;pa.days=Mc;pa.weeks=function(){return f(this.days()/7)};pa.months=Nc;pa.years=Oc;pa.humanize=function(a){if(!this.isValid())return this.localeData().invalidDate();var b=this.localeData(),c;c=!a;var f=P(this).abs(),g=ib(f.as("s")),e=ib(f.as("m")),n=ib(f.as("h")),h=ib(f.as("d")),d=ib(f.as("M")),f=ib(f.as("y")),g=g<=Za.ss&&
["s",g]||g<Za.s&&["ss",g]||1>=e&&["m"]||e<Za.m&&["mm",e]||1>=n&&["h"]||n<Za.h&&["hh",n]||1>=h&&["d"]||h<Za.d&&["dd",h]||1>=d&&["M"]||d<Za.M&&["MM",d]||1>=f&&["y"]||["yy",f];g[2]=c;g[3]=0<+this;g[4]=b;c=Ob.apply(null,g);a&&(c=b.pastFuture(+this,c));return b.postformat(c)};pa.toISOString=Bb;pa.toString=Bb;pa.toJSON=Bb;pa.locale=Wa;pa.localeData=tb;pa.toIsoString=z("toIsoString() is deprecated. Please use toISOString() instead (notice the capitals)",Bb);pa.lang=cc;L("X",0,0,"unix");L("x",0,0,"valueOf");
O("x",Ib);O("X",/[+-]?\d+(\.\d{1,3})?/);Y("X",function(a,b,c){c._d=new Date(1E3*parseFloat(a,10))});Y("x",function(a,b,c){c._d=new Date(v(a))});r.version="2.18.1";Tb=aa;r.fn=V;r.min=function(){var a=[].slice.call(arguments,0);return cb("isBefore",a)};r.max=function(){var a=[].slice.call(arguments,0);return cb("isAfter",a)};r.now=function(){return Date.now?Date.now():+new Date};r.utc=c;r.unix=function(a){return aa(1E3*a)};r.months=function(a,b){return Pa(a,b,"months")};r.isDate=m;r.locale=Ja;r.invalid=
g;r.duration=P;r.isMoment=t;r.weekdays=function(a,b,c){return ob(a,b,c,"weekdays")};r.parseZone=function(){return aa.apply(null,arguments).parseZone()};r.localeData=Ca;r.isDuration=I;r.monthsShort=function(a,b){return Pa(a,b,"monthsShort")};r.weekdaysMin=function(a,b,c){return ob(a,b,c,"weekdaysMin")};r.defineLocale=Ga;r.updateLocale=function(a,b){if(null!=b){var c;c=$b;null!=Da[a]&&(c=Da[a]._config);b=B(c,b);c=new C(b);c.parentLocale=Da[a];Da[a]=c;Ja(a)}else null!=Da[a]&&(null!=Da[a].parentLocale?
Da[a]=Da[a].parentLocale:null!=Da[a]&&delete Da[a]);return Da[a]};r.locales=function(){return fc(Da)};r.weekdaysShort=function(a,b,c){return ob(a,b,c,"weekdaysShort")};r.normalizeUnits=D;r.relativeTimeRounding=function(a){return void 0===a?ib:"function"===typeof a?(ib=a,!0):!1};r.relativeTimeThreshold=function(a,b){if(void 0===Za[a])return!1;if(void 0===b)return Za[a];Za[a]=b;"s"===a&&(Za.ss=b-1);return!0};r.calendarFormat=function(a,b){var c=a.diff(b,"days",!0);return-6>c?"sameElse":-1>c?"lastWeek":
0>c?"lastDay":1>c?"sameDay":2>c?"nextDay":7>c?"nextWeek":"sameElse"};r.prototype=V;return r})},"esri/arcade/ImmutableArray":function(){define(["require","exports"],function(r,l){return function(){function d(d){void 0===d&&(d=[]);this._elements=d}d.prototype.length=function(){return this._elements.length};d.prototype.get=function(d){return this._elements[d]};d.prototype.toArray=function(){for(var d=[],k=0;k<this.length();k++)d.push(this.get(k));return d};return d}()})},"esri/arcade/ImmutablePointArray":function(){define("require exports ../core/tsSupport/extendsHelper ./ImmutableArray ../geometry/Point ../kernel".split(" "),
function(r,l,d,q,k,m){var p=0===m.version.indexOf("4.");return function(h){function e(c,b,a,g,e,n){c=h.call(this,c)||this;c._lazyPt=[];c._hasZ=!1;c._hasM=!1;c._spRef=b;c._hasZ=a;c._hasM=g;c._cacheId=e;c._partId=n;return c}d(e,h);e.prototype.get=function(c){if(void 0===this._lazyPt[c]){var b=this._elements[c];if(void 0===b)return;var a=this._hasZ,g=this._hasM,e=null,e=a&&!g?new k(b[0],b[1],b[2],void 0,this._spRef):g&&a?new k(b[0],b[1],void 0,b[2],this._spRef):a&&g?new k(b[0],b[1],b[2],b[3],this._spRef):
new k(b[0],b[1],this._spRef);p?e.cache._arcadeCacheId=this._cacheId.toString()+"-"+this._partId.toString()+"-"+c.toString():e.setCacheValue("_arcadeCacheId",this._cacheId.toString()+"-"+this._partId.toString()+"-"+c.toString());this._lazyPt[c]=e}return this._lazyPt[c]};e.prototype.equalityTest=function(c){return c===this?!0:null===c||!1===c instanceof e?!1:c.getUniqueHash()===this.getUniqueHash()};e.prototype.getUniqueHash=function(){return this._cacheId.toString()+"-"+this._partId.toString()};return e}(q)})},
"esri/core/tsSupport/extendsHelper":function(){define([],function(){return function(r,l){function d(){this.constructor=r}for(var q in l)l.hasOwnProperty(q)&&(r[q]=l[q]);r.prototype=null===l?Object.create(l):(d.prototype=l.prototype,new d)}})},"esri/arcade/ImmutablePathArray":function(){define(["require","exports","../core/tsSupport/extendsHelper","./ImmutableArray","./ImmutablePointArray"],function(r,l,d,q,k){return function(m){function p(h,e,c,b,a){h=m.call(this,h)||this;h._lazyPath=[];h._hasZ=!1;
h._hasM=!1;h._hasZ=c;h._hasM=b;h._spRef=e;h._cacheId=a;return h}d(p,m);p.prototype.get=function(h){if(void 0===this._lazyPath[h]){var e=this._elements[h];if(void 0===e)return;this._lazyPath[h]=new k(e,this._spRef,this._hasZ,this._hasM,this._cacheId,h)}return this._lazyPath[h]};p.prototype.equalityTest=function(h){return h===this?!0:null===h||!1===h instanceof p?!1:h.getUniqueHash()===this.getUniqueHash()};p.prototype.getUniqueHash=function(){return this._cacheId.toString()};return p}(q)})},"esri/geometry/Polyline":function(){define("dojo/_base/declare dojo/_base/array dojo/_base/lang dojo/has ../kernel ../lang ../SpatialReference ./Geometry ./Point ./Extent ../srUtils".split(" "),
function(r,l,d,q,k,m,p,h,e,c,b){var a={type:"polyline",paths:null};r=r(h,{declaredClass:"esri.geometry.Polyline",constructor:function(c){d.mixin(this,a);this.paths=[];this._path=0;c&&(d.isArray(c)?this.paths=d.isArray(c[0][0])?c:[c]:c.paths?d.mixin(this,c):this.spatialReference=c,this.spatialReference&&(this.spatialReference=b.createSpatialReference(this.spatialReference)));this.verifySR()},addPath:function(a){this.clearCache();this._path=this.paths.length;this.paths[this._path]=[];d.isArray(a[0])?
l.forEach(a,this._addPointArr,this):l.forEach(a,this._addPoint,this);return this},_addPointArr:function(a){this.paths[this._path].push(a)},_addPoint:function(a){this.paths[this._path].push([a.x,a.y])},_insertPoints:function(a,b){this.clearCache();this._path=b;this.paths[this._path]||(this.paths[this._path]=[]);l.forEach(a,this._addPoint,this)},_validateInputs:function(a,b){return null!==a&&void 0!==a&&(0>a||a>=this.paths.length)||null!==b&&void 0!==a&&(0>b||b>=this.paths[a].length)?!1:!0},getPoint:function(a,
b){if(this._validateInputs(a,b))return new e(this.paths[a][b],this.spatialReference)},setPoint:function(a,b,c){if(this._validateInputs(a,b))return this.clearCache(),this.paths[a][b]=[c.x,c.y],this},insertPoint:function(a,b,c){if(this._validateInputs(a)&&m.isDefined(b)&&0<=b&&b<=this.paths[a].length)return this.clearCache(),this.paths[a].splice(b,0,[c.x,c.y]),this},removePath:function(a){if(this._validateInputs(a,null)){this.clearCache();a=this.paths.splice(a,1)[0];var b,c=a.length,g=this.spatialReference;
for(b=0;b<c;b++)a[b]=new e(a[b],g);return a}},removePoint:function(a,b){if(this._validateInputs(a,b))return this.clearCache(),new e(this.paths[a].splice(b,1)[0],this.spatialReference)},getExtent:function(){var a;a=this.getCacheValue("_extent");var b=this.getCacheValue("_partwise");if(a)return a=new c(a),a._partwise=b,a;a=this.paths;var e=a.length;if(e&&a[0].length){var h,f,d,x,w,p,k,m,l=x=a[0][0][0],q=w=a[0][0][1],E=Math.min,D=Math.max,r=this.spatialReference,b=[],G,J,N,M;for(p=0;p<e;p++){h=a[p];
G=J=h[0]&&h[0][0];N=M=h[0]&&h[0][1];m=h.length;for(k=0;k<m;k++)f=h[k],d=f[0],f=f[1],l=E(l,d),q=E(q,f),x=D(x,d),w=D(w,f),G=E(G,d),N=E(N,f),J=D(J,d),M=D(M,f);b.push(new c({xmin:G,ymin:N,xmax:J,ymax:M,spatialReference:r?r.toJson():null}))}a={xmin:l,ymin:q,xmax:x,ymax:w,spatialReference:r?r.toJson():null};b=1<b.length?b:null;this.setCacheValue("_extent",a);this.setCacheValue("_partwise",b);a=new c(a);a._partwise=b;return a}},toJson:function(){var a={paths:d.clone(this.paths)},b=this.spatialReference;
b&&(a.spatialReference=b.toJson());return a}});r.defaultProps=a;return r})},"esri/geometry/Polygon":function(){define("dojo/_base/declare dojo/_base/array dojo/_base/lang dojo/has ../kernel ../lang ../SpatialReference ./Geometry ./Point ./Extent ./mathUtils ../srUtils".split(" "),function(r,l,d,q,k,m,p,h,e,c,b,a){var g={type:"polygon",rings:null},u=r(h,{declaredClass:"esri.geometry.Polygon",constructor:function(b){d.mixin(this,g);this.rings=[];this._ring=0;b&&(d.isArray(b)?this.rings=d.isArray(b[0][0])?
b:[b]:b.rings?d.mixin(this,b):this.spatialReference=b,this.spatialReference&&(this.spatialReference=a.createSpatialReference(this.spatialReference)));this.verifySR()},addRing:function(a){this.clearCache();this._ring=this.rings.length;this.rings[this._ring]=[];d.isArray(a[0])?l.forEach(a,this._addPointArr,this):l.forEach(a,this._addPoint,this);return this},_addPointArr:function(a){this.rings[this._ring].push(a)},_addPoint:function(a){this.rings[this._ring].push([a.x,a.y])},_insertPoints:function(a,
b){this.clearCache();this._ring=b;this.rings[this._ring]||(this.rings[this._ring]=[]);l.forEach(a,this._addPoint,this)},_validateInputs:function(a,b){return null!==a&&void 0!==a&&(0>a||a>=this.rings.length)||null!==b&&void 0!==a&&(0>b||b>=this.rings[a].length)?!1:!0},getPoint:function(a,b){if(this._validateInputs(a,b))return new e(this.rings[a][b],this.spatialReference)},setPoint:function(a,b,c){if(this._validateInputs(a,b))return this.clearCache(),this.rings[a][b]=[c.x,c.y],this},insertPoint:function(a,
b,c){if(this._validateInputs(a)&&m.isDefined(b)&&0<=b&&b<=this.rings[a].length)return this.clearCache(),this.rings[a].splice(b,0,[c.x,c.y]),this},removeRing:function(a){if(this._validateInputs(a,null)){this.clearCache();a=this.rings.splice(a,1)[0];var b,c=a.length,g=this.spatialReference;for(b=0;b<c;b++)a[b]=new e(a[b],g);return a}},removePoint:function(a,b){if(this._validateInputs(a,b))return this.clearCache(),new e(this.rings[a].splice(b,1)[0],this.spatialReference)},getExtent:function(){var a;
a=this.getCacheValue("_extent");var b=this.getCacheValue("_partwise");if(a)return a=new c(a),a._partwise=b,a;a=this.rings;var f=a.length;if(f&&a[0].length){var g,e,h,d,u,p,k,m,l=d=a[0][0][0],q=u=a[0][0][1],r=Math.min,G=Math.max,J=this.spatialReference,b=[],N,M,L,K;for(p=0;p<f;p++){g=a[p];N=M=g[0]&&g[0][0];L=K=g[0]&&g[0][1];m=g.length;for(k=0;k<m;k++)e=g[k],h=e[0],e=e[1],l=r(l,h),q=r(q,e),d=G(d,h),u=G(u,e),N=r(N,h),L=r(L,e),M=G(M,h),K=G(K,e);b.push(new c({xmin:N,ymin:L,xmax:M,ymax:K,spatialReference:J?
J.toJson():null}))}a={xmin:l,ymin:q,xmax:d,ymax:u,spatialReference:J?J.toJson():null};b=1<b.length?b:null;this.setCacheValue("_extent",a);this.setCacheValue("_partwise",b);a=new c(a);a._partwise=b;return a}},contains:function(a){var b=this.rings,c,g=!1,n,h,d,u,p,k,m=b.length;c=this.spatialReference;n=a.spatialReference;var l=a.x;a=a.y;c&&n&&!c.equals(n)&&c._canProject(n)&&(a=c.isWebMercator()?e.lngLatToXY(l,a):e.xyToLngLat(l,a,!0),l=a[0],a=a[1]);for(k=0;k<m;k++)for(c=b[k],d=c.length,p=u=0;p<d;p++)u++,
u===d&&(u=0),n=c[p],h=c[u],(n[1]<a&&h[1]>=a||h[1]<a&&n[1]>=a)&&n[0]+(a-n[1])/(h[1]-n[1])*(h[0]-n[0])<l&&(g=!g);return g},getCentroid:function(){var a=this.getCacheValue("_centroid");if(void 0!==a)return a;var a=this.rings,b,c,g,h,d=[],u,p,k=Infinity,m=-Infinity,q=Infinity,E=-Infinity;l.forEach(a,function(a){b=c=g=0;l.forEach(a,function(f,e){e<a.length-1&&(u=a[e+1],p=f[0]*u[1]-u[0]*f[1],b+=(f[0]+u[0])*p,c+=(f[1]+u[1])*p,g+=p,f[0]<k&&(k=f[0]),f[0]>m&&(m=f[0]),f[1]<q&&(q=f[1]),f[1]>E&&(E=f[1]))});0<
g&&(g*=-1);g&&d.push([b,c,g/2])});d.sort(function(a,b){return a[2]-b[2]});b=c=void 0;d[0]&&(h=6*d[0][2],b=d[0][0]/h,c=d[0][1]/h,b<k||b>m||c<q||c>E)&&(b=c=void 0);if(void 0===b||void 0===c)if(a=a[0]&&a[0].length?this._getLineCentroid(a[0]):null)b=a.x,c=a.y;a=isNaN(b)||isNaN(c)?null:new e(b,c,this.spatialReference);this.setCacheValue("_centroid",a);return a},_getLineCentroid:function(a){var c,f=0,g=0,e=0,n,h,d={x:0,y:0},u={x:0,y:0},p,k=a.length,m;for(p=0;p<k-1;p++)n=a[p],h=a[p+1],n&&h&&(d.x=n[0],d.y=
n[1],u.x=h[0],u.y=h[1],c=b.getLength(d,u),0<c&&(f+=c,n=b.getMidpoint(n,h),g+=c*n[0],e+=c*n[1]));0<f?m={x:g/f,y:e/f}:a[0]&&(m={x:a[0][0],y:a[0][1]});return m},isClockwise:function(a){var b=0,c,g=a.length,e=d.isArray(a[0])?function(a,b){return a[0]*b[1]-b[0]*a[1]}:function(a,b){return a.x*b.y-b.x*a.y};for(c=0;c<g;c++)b+=e(a[c],a[(c+1)%g]);return 0>=b/2},isSelfIntersecting:function(a){a=a||this;var c,f,g,e,n,h,d,u=a.rings.length,p;for(g=0;g<u;g++){for(c=0;c<a.rings[g].length-1;c++)for(n=[[a.rings[g][c][0],
a.rings[g][c][1]],[a.rings[g][c+1][0],a.rings[g][c+1][1]]],f=g+1;f<u;f++)for(e=0;e<a.rings[f].length-1;e++)if(h=[[a.rings[f][e][0],a.rings[f][e][1]],[a.rings[f][e+1][0],a.rings[f][e+1][1]]],(d=b._getLineIntersection2(n,h))&&!(d[0]===n[0][0]&&d[1]===n[0][1]||d[0]===h[0][0]&&d[1]===h[0][1]||d[0]===n[1][0]&&d[1]===n[1][1]||d[0]===h[1][0]&&d[1]===h[1][1]))return!0;e=a.rings[g].length;if(!(4>=e))for(c=0;c<e-3;c++)for(p=e-1,0===c&&(p=e-2),n=[[a.rings[g][c][0],a.rings[g][c][1]],[a.rings[g][c+1][0],a.rings[g][c+
1][1]]],f=c+2;f<p;f++)if(h=[[a.rings[g][f][0],a.rings[g][f][1]],[a.rings[g][f+1][0],a.rings[g][f+1][1]]],(d=b._getLineIntersection2(n,h))&&!(d[0]===n[0][0]&&d[1]===n[0][1]||d[0]===h[0][0]&&d[1]===h[0][1]||d[0]===n[1][0]&&d[1]===n[1][1]||d[0]===h[1][0]&&d[1]===h[1][1]))return!0}return!1},toJson:function(){var a={rings:d.clone(this.rings)},b=this.spatialReference;b&&(a.spatialReference=b.toJson());return a}});u.defaultProps=g;u.createEllipse=function(a){var b=a.center.x,c=a.center.y,g=a.longAxis,e=
a.shortAxis,n=a.numberOfPoints,h=a.map,d,p,k;a=[];var m=2*Math.PI/n;for(p=0;p<n;p++)d=Math.cos(p*m),k=Math.sin(p*m),d=h.toMap({x:g*d+b,y:e*k+c}),a.push(d);a.push(a[0]);b=new u(h.spatialReference);b.addRing(a);return b};u.createCircle=function(a){return u.createEllipse({center:a.center,longAxis:a.r,shortAxis:a.r,numberOfPoints:a.numberOfPoints,map:a.map})};u.fromExtent=function(a){var b=a.normalize();a=a.spatialReference;return new u({rings:l.map(b,function(a){return[[a.xmin,a.ymin],[a.xmin,a.ymax],
[a.xmax,a.ymax],[a.xmax,a.ymin],[a.xmin,a.ymin]]}),spatialReference:a?a.toJson():null})};return u})},"esri/geometry/Multipoint":function(){define("dojo/_base/declare dojo/_base/lang dojo/has ../kernel ../SpatialReference ./Geometry ./Point ./Extent ../srUtils".split(" "),function(r,l,d,q,k,m,p,h,e){var c={type:"multipoint",points:null};r=r(m,{declaredClass:"esri.geometry.Multipoint",constructor:function(b){l.mixin(this,c);this.points=[];b&&(b.points?l.mixin(this,b):this.spatialReference=b,this.spatialReference&&
(this.spatialReference=e.createSpatialReference(this.spatialReference)));this.verifySR()},addPoint:function(b){this.clearCache();l.isArray(b)?this.points.push(b):this.points.push([b.x,b.y]);return this},removePoint:function(b){if(this._validateInputs(b))return this.clearCache(),new p(this.points.splice(b,1)[0],this.spatialReference)},getExtent:function(){var b=this.getCacheValue("_extent");if(b)return new h(b);var b=this.points,a=b.length;if(a){var c=b[0],e,n,d=e=c[0],f=n=c[1],v=Math.min,p=Math.max,
k=this.spatialReference,m,l;for(l=0;l<a;l++)c=b[l],m=c[0],c=c[1],d=v(d,m),f=v(f,c),e=p(e,m),n=p(n,c);b={xmin:d,ymin:f,xmax:e,ymax:n,spatialReference:k?k.toJson():null};this.setCacheValue("_extent",b);return new h(b)}},_validateInputs:function(b){return null===b||0>b||b>=this.points.length?!1:!0},getPoint:function(b){if(this._validateInputs(b))return b=this.points[b],new p(b[0],b[1],this.spatialReference)},setPoint:function(b,a){if(this._validateInputs(b))return this.clearCache(),this.points[b]=[a.x,
a.y],this},toJson:function(){var b={points:l.clone(this.points)},a=this.spatialReference;a&&(b.spatialReference=a.toJson());return b}});r.defaultProps=c;return r})},"esri/arcade/FunctionWrapper":function(){define(["require","exports"],function(r,l){return function(){return function(d,l){this.context=this.definition=null;this.definition=d;this.context=l}}()})},"esri/geometry/ScreenPoint":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/has","../kernel","./Point"],function(r,l,d,q,k){return r(k,
{declaredClass:"esri.geometry.ScreenPoint",verifySR:function(){}})})},"esri/geometry/Rect":function(){define("dojo/_base/declare dojo/_base/lang dojo/has dojox/gfx/_base ../kernel ../SpatialReference ./Geometry ./Point ./Extent ../srUtils".split(" "),function(r,l,d,q,k,m,p,h,e,c){var b=r(p,{declaredClass:"esri.geometry.Rect",constructor:function(a,b,e,n,h){l.mixin(this,q.defaultRect);l.isObject(a)&&"extent"===a.type&&(b=a.ymax,e=a.getWidth(),n=a.getHeight(),h=a.spatialReference,a=a.xmin);l.isObject(a)?
(l.mixin(this,a),this.spatialReference&&(this.spatialReference=c.createSpatialReference(this.spatialReference))):(this.x=a,this.y=b,this.width=e,this.height=n,this.spatialReference=h);this.verifySR()},getCenter:function(){return new h(this.x+this.width/2,this.y+this.height/2,this.spatialReference)},offset:function(a,c){return new b(this.x+a,this.y+c,this.width,this.height,this.spatialReference)},intersects:function(a){return a.x+a.width<=this.x||a.y+a.height<=this.y||a.y>=this.y+this.height||a.x>=
this.x+this.width?!1:!0},getExtent:function(){return new e(parseFloat(this.x),parseFloat(this.y)-parseFloat(this.height),parseFloat(this.x)+parseFloat(this.width),parseFloat(this.y),this.spatialReference)},update:function(a,b,c,e,h){this.x=a;this.y=b;this.width=c;this.height=e;this.spatialReference=h;this.clearCache();return this}});return b})},"esri/geometry/scaleUtils":function(){define("dojo/_base/lang dojo/has ../kernel ../config ../lang ../WKIDUnitConversion".split(" "),function(r,l,d,q,k,m){var p=
6370997*Math.PI/180,h=q.defaults,e={getUnitValueForSR:function(c){return this.getUnitValue(c)||p},getUnitValue:function(c){var b,a,g;c&&("object"===typeof c?(b=c.wkid,a=c.wkt):"number"===typeof c?b=c:"string"===typeof c&&(a=c));b?g=m.values[m[b]]:a&&-1!==a.search(/^PROJCS/i)&&(c=/UNIT\[([^\]]+)\]\]$/i.exec(a))&&c[1]&&(g=parseFloat(c[1].split(",")[1]));return g},getScale:function(c,b,a){var g,d,n;1<arguments.length&&k.isDefined(b)&&!b.declaredClass?(g=c,d=b,b=null,n=e.getUnitValue(a)):(g=b||c.extent,
d=c.width,n=e.getUnitValue(g&&g.spatialReference));return g&&d?g.getWidth()/d*(n||p)*39.37*h.screenDPI:0},getExtentForScale:function(c,b,a){a=a||c.extent;var g;g=e.getUnitValue(c.spatialReference);return a.expand(b*c.width/(39.37*(g||p)*h.screenDPI)/a.getWidth())}};return e})},"esri/WKIDUnitConversion":function(){define(["dojo/has","./kernel"],function(r,l){var d,q={values:[1,.3048,.3048006096012192,.3047972654,.9143917962,.201166195164,.9143984146160287,.3047994715386762,20.11676512155263,20.11678249437587,
.9143985307444408,.91439523,.3047997101815088,20.116756,5E4,15E4],2066:5,2136:12,2155:2,2157:0,2158:0,2159:12,2160:12,2204:2,2219:0,2220:0,2254:2,2255:2,2256:1,2265:1,2266:1,2267:2,2268:2,2269:1,2270:1,2271:2,2272:2,2273:1,2294:0,2295:0,2314:3,2899:2,2900:2,2901:1,2909:1,2910:1,2911:2,2912:2,2913:1,2914:1,2992:1,2993:0,2994:1,3080:1,3089:2,3090:0,3091:2,3102:2,3141:0,3142:0,3167:13,3359:2,3360:0,3361:1,3362:0,3363:2,3364:0,3365:2,3366:3,3404:2,3405:0,3406:0,3407:3,3439:0,3440:0,3479:1,3480:0,3481:1,
3482:0,3483:1,3484:0,3485:2,3486:0,3487:2,3488:0,3489:0,3490:2,3491:0,3492:2,3493:0,3494:2,3495:0,3496:2,3497:0,3498:2,3499:0,3500:2,3501:0,3502:2,3503:0,3504:2,3505:0,3506:2,3507:0,3508:2,3509:0,3510:2,3511:0,3512:2,3513:0,3514:0,3515:2,3516:0,3517:2,3518:0,3519:2,3520:0,3521:2,3522:0,3523:2,3524:0,3525:2,3526:0,3527:2,3528:0,3529:2,3530:0,3531:2,3532:0,3533:2,3534:0,3535:2,3536:0,3537:2,3538:0,3539:2,3540:0,3541:2,3542:0,3543:2,3544:0,3545:2,3546:0,3547:2,3548:0,3549:2,3550:0,3551:2,3552:0,3553:2,
3582:2,3583:0,3584:2,3585:0,3586:2,3587:0,3588:1,3589:0,3590:1,3591:0,3592:0,3593:1,3598:2,3599:0,3600:2,3605:1,3606:0,3607:0,3608:2,3609:0,3610:2,3611:0,3612:2,3613:0,3614:2,3615:0,3616:2,3617:0,3618:2,3619:0,3620:2,3621:0,3622:2,3623:0,3624:2,3625:0,3626:2,3627:0,3628:2,3629:0,3630:2,3631:0,3632:2,3633:0,3634:1,3635:0,3636:1,3640:2,3641:0,3642:2,3643:0,3644:1,3645:0,3646:1,3647:0,3648:1,3649:0,3650:2,3651:0,3652:2,3653:0,3654:2,3655:0,3656:1,3657:0,3658:2,3659:0,3660:2,3661:0,3662:2,3663:0,3664:2,
3668:2,3669:0,3670:2,3671:0,3672:2,3673:0,3674:2,3675:0,3676:1,3677:2,3678:0,3679:1,3680:2,3681:0,3682:1,3683:2,3684:0,3685:0,3686:2,3687:0,3688:2,3689:0,3690:2,3691:0,3692:2,3696:2,3697:0,3698:2,3699:0,3700:2,3793:0,3794:0,3812:0,3854:0,3857:0,3920:0,3978:0,3979:0,3991:2,3992:2,4026:0,4037:0,4038:0,4071:0,4082:0,4083:0,4087:0,4088:0,4217:2,4414:0,4415:0,4417:0,4434:0,4437:0,4438:2,4439:2,4462:0,4467:0,4471:0,4474:0,4559:0,4647:0,4822:0,4826:0,4839:0,5018:0,5048:0,5167:0,5168:0,5221:0,5223:0,5234:0,
5235:0,5243:0,5247:0,5266:0,5316:0,5320:0,5321:0,5325:0,5337:0,5361:0,5362:0,5367:0,5382:0,5383:0,5396:0,5456:0,5457:0,5469:0,5472:4,5490:0,5513:0,5514:0,5523:0,5559:0,5588:1,5589:3,5596:0,5627:0,5629:0,5641:0,5643:0,5644:0,5646:2,5654:2,5655:2,5659:0,5700:0,5825:0,5836:0,5837:0,5839:0,5842:0,5844:0,5858:0,5879:0,5880:0,5887:0,5890:0,6128:1,6129:1,6141:1,6204:0,6210:0,6211:0,6307:0,6312:0,6316:0,6362:0,6391:1,6405:1,6406:0,6407:1,6408:0,6409:1,6410:0,6411:2,6412:0,6413:2,6414:0,6415:0,6416:2,6417:0,
6418:2,6419:0,6420:2,6421:0,6422:2,6423:0,6424:2,6425:0,6426:2,6427:0,6428:2,6429:0,6430:2,6431:0,6432:2,6433:0,6434:2,6435:0,6436:2,6437:0,6438:2,6439:0,6440:0,6441:2,6442:0,6443:2,6444:0,6445:2,6446:0,6447:2,6448:0,6449:2,6450:0,6451:2,6452:0,6453:2,6454:0,6455:2,6456:0,6457:2,6458:0,6459:2,6460:0,6461:2,6462:0,6463:2,6464:0,6465:2,6466:0,6467:2,6468:0,6469:2,6470:0,6471:2,6472:0,6473:2,6474:0,6475:2,6476:0,6477:2,6478:0,6479:2,6484:2,6485:0,6486:2,6487:0,6488:2,6489:0,6490:2,6491:0,6492:2,6493:0,
6494:1,6495:0,6496:1,6497:0,6498:0,6499:1,6500:0,6501:2,6502:0,6503:2,6504:0,6505:2,6506:0,6507:2,6508:0,6509:0,6510:2,6515:1,6516:0,6518:0,6519:2,6520:0,6521:2,6522:0,6523:2,6524:0,6525:2,6526:0,6527:2,6528:0,6529:2,6530:0,6531:2,6532:0,6533:2,6534:0,6535:2,6536:0,6537:2,6538:0,6539:2,6540:0,6541:2,6542:0,6543:2,6544:0,6545:1,6546:0,6547:1,6548:0,6549:2,6550:0,6551:2,6552:0,6553:2,6554:0,6555:2,6556:0,6557:1,6558:0,6559:1,6560:0,6561:1,6562:0,6563:2,6564:0,6565:2,6566:0,6567:0,6568:2,6569:0,6570:1,
6571:0,6572:2,6573:0,6574:2,6575:0,6576:2,6577:0,6578:2,6582:2,6583:0,6584:2,6585:0,6586:2,6587:0,6588:2,6589:0,6590:2,6591:0,6592:0,6593:2,6594:0,6595:2,6596:0,6597:2,6598:0,6599:2,6600:0,6601:2,6602:0,6603:2,6605:2,6606:0,6607:2,6608:0,6609:2,6610:0,6611:0,6612:2,6613:0,6614:2,6615:0,6616:2,6617:0,6618:2,6633:2,6646:0,6703:0,6784:0,6785:1,6786:0,6787:1,6788:0,6789:1,6790:0,6791:1,6792:0,6793:1,6794:0,6795:1,6796:0,6797:1,6798:0,6799:1,6800:0,6801:1,6802:0,6803:1,6804:0,6805:1,6806:0,6807:1,6808:0,
6809:1,6810:0,6811:1,6812:0,6813:1,6814:0,6815:1,6816:0,6817:1,6818:0,6819:1,6820:0,6821:1,6822:0,6823:1,6824:0,6825:1,6826:0,6827:1,6828:0,6829:1,6830:0,6831:1,6832:0,6833:1,6834:0,6835:1,6836:0,6837:1,6838:0,6839:1,6840:0,6841:1,6842:0,6843:1,6844:0,6845:1,6846:0,6847:1,6848:0,6849:1,6850:0,6851:1,6852:0,6853:1,6854:0,6855:1,6856:0,6857:1,6858:0,6859:1,6860:0,6861:1,6862:0,6863:1,6867:0,6868:1,6870:0,6875:0,6876:0,6879:0,6880:2,6884:0,6885:1,6886:0,6887:1,6915:0,6922:0,6923:2,6924:0,6925:2,6962:0,
6984:0,6991:0,7128:2,7131:0,7132:2,7257:0,7258:2,7259:0,7260:2,7261:0,7262:2,7263:0,7264:2,7265:0,7266:2,7267:0,7268:2,7269:0,7270:2,7271:0,7272:2,7273:0,7274:2,7275:0,7276:2,7277:0,7278:2,7279:0,7280:2,7281:0,7282:2,7283:0,7284:2,7285:0,7286:2,7287:0,7288:2,7289:0,7290:2,7291:0,7292:2,7293:0,7294:2,7295:0,7296:2,7297:0,7298:2,7299:0,7300:2,7301:0,7302:2,7303:0,7304:2,7305:0,7306:2,7307:0,7308:2,7309:0,7310:2,7311:0,7312:2,7313:0,7314:2,7315:0,7316:2,7317:0,7318:2,7319:0,7320:2,7321:0,7322:2,7323:0,
7324:2,7325:0,7326:2,7327:0,7328:2,7329:0,7330:2,7331:0,7332:2,7333:0,7334:2,7335:0,7336:2,7337:0,7338:2,7339:0,7340:2,7341:0,7342:2,7343:0,7344:2,7345:0,7346:2,7347:0,7348:2,7349:0,7350:2,7351:0,7352:2,7353:0,7354:2,7355:0,7356:2,7357:0,7358:2,7359:0,7360:2,7361:0,7362:2,7363:0,7364:2,7365:0,7366:2,7367:0,7368:2,7369:0,7370:2,20499:0,20538:0,20539:0,20790:0,20791:0,21291:0,21292:0,21500:0,21817:0,21818:0,22032:0,22033:0,22091:0,22092:0,22332:0,22391:0,22392:0,22700:0,22770:0,22780:0,22832:0,23090:0,
23095:0,23239:0,23240:0,23433:0,23700:0,24047:0,24048:0,24100:3,24200:0,24305:0,24306:0,24382:10,24383:0,24500:0,24547:0,24548:0,24571:9,24600:0,25E3:0,25231:0,25884:0,25932:0,26237:0,26331:0,26332:0,26432:0,26591:0,26592:0,26632:0,26692:0,27120:0,27200:0,27291:6,27292:6,27429:0,27492:0,27493:0,27500:0,27700:0,28232:0,28600:0,28991:0,28992:0,29100:0,29101:0,29220:0,29221:0,29333:0,29635:0,29636:0,29701:0,29738:0,29739:0,29849:0,29850:0,29871:8,29872:7,29873:0,30200:5,30339:0,30340:0,30591:0,30592:0,
30791:0,30792:0,30800:0,31028:0,31121:0,31154:0,31170:0,31171:0,31370:0,31528:0,31529:0,31600:0,31700:0,31838:0,31839:0,31900:0,31901:0,32061:0,32062:0,32098:0,32099:2,32100:0,32104:0,32161:0,32766:0,53034:0,53048:0,53049:0,54034:0,65061:2,65062:2,65161:0,65163:0,102041:2,102064:11,102068:14,102069:15,102118:2,102119:1,102120:2,102121:2,102217:2,102218:0,102219:2,102220:2,102378:1,102379:1,102380:0,102381:1,102589:2,102599:2,102600:2,102604:2,102647:0,102704:2,102705:2,102706:0,102761:2,102762:0,
102763:2,102764:0,102765:0,102766:2,102962:0,102963:0,102970:1,102974:2,102993:0,102994:0,102995:2,102996:2,103015:0,103016:2,103017:0,103018:2,103025:0,103026:0,103027:2,103028:2,103035:0,103036:0,103037:2,103038:2,103039:0,103040:0,103041:2,103042:2,103043:0,103044:0,103045:2,103046:2,103047:0,103048:0,103049:2,103050:2,103051:0,103052:2,103053:0,103054:2,103055:0,103056:2,103057:0,103058:0,103059:2,103060:2,103061:0,103062:0,103063:2,103064:2,103069:2,103070:0,103071:0,103072:2,103073:2,103086:0,
103087:0,103088:2,103089:2,103094:1,103095:0,103096:2,103103:0,103104:2,103105:0,103106:2,103121:0,103122:2,103123:0,103124:0,103125:1,103126:1,103127:0,103128:0,103129:2,103130:2,103131:0,103132:0,103133:2,103134:2,103135:0,103136:0,103137:1,103138:1,103139:0,103140:2,103141:0,103142:2,103143:0,103144:2,103145:0,103146:1,103147:0,103148:0,103149:2,103150:2,103151:0,103152:2,103172:0,103173:2,103174:0,103175:0,103176:2,103177:2,103178:0,103179:0,103180:2,103181:2,103182:0,103183:0,103184:2,103185:2,
103228:0,103229:0,103230:2,103231:2,103250:0,103251:2,103252:0,103253:2,103260:0,103261:0,103262:2,103263:2,103270:0,103271:0,103272:2,103273:2,103274:0,103275:0,103276:2,103277:2,103278:0,103279:0,103280:2,103281:2,103282:0,103283:0,103284:2,103285:2,103286:0,103287:2,103288:0,103289:2,103290:0,103291:2,103292:0,103293:0,103294:2,103295:2,103296:0,103297:0,103298:2,103299:2,103376:2,103377:0,103378:0,103379:2,103380:2,103393:0,103394:0,103395:2,103396:2,103472:0,103473:1,103474:0,103475:2,103482:0,
103483:2,103484:0,103485:2,103500:0,103501:2,103502:0,103503:0,103504:1,103505:1,103506:0,103507:0,103508:2,103509:2,103510:0,103511:0,103512:2,103513:2,103514:0,103515:2,103516:0,103517:2,103518:0,103519:2,103520:0,103521:1,103522:0,103523:0,103524:2,103525:2,103526:0,103527:2,103561:2,103562:2,103563:0,103564:0,103565:2,103566:2,103567:0,103568:0,103569:2,103570:2,103584:0,103585:2,103695:2};for(d=2E3;2045>=d;d++)q[d]=0;for(d=2056;2065>=d;d++)q[d]=0;for(d=2067;2135>=d;d++)q[d]=0;for(d=2137;2154>=
d;d++)q[d]=0;for(d=2161;2170>=d;d++)q[d]=0;for(d=2172;2193>=d;d++)q[d]=0;for(d=2195;2198>=d;d++)q[d]=0;for(d=2200;2203>=d;d++)q[d]=0;for(d=2205;2217>=d;d++)q[d]=0;for(d=2222;2224>=d;d++)q[d]=1;for(d=2225;2250>=d;d++)q[d]=2;for(d=2251;2253>=d;d++)q[d]=1;for(d=2257;2264>=d;d++)q[d]=2;for(d=2274;2279>=d;d++)q[d]=2;for(d=2280;2282>=d;d++)q[d]=1;for(d=2283;2289>=d;d++)q[d]=2;for(d=2290;2292>=d;d++)q[d]=0;for(d=2308;2313>=d;d++)q[d]=0;for(d=2315;2491>=d;d++)q[d]=0;for(d=2494;2866>=d;d++)q[d]=0;for(d=2867;2869>=
d;d++)q[d]=1;for(d=2870;2888>=d;d++)q[d]=2;for(d=2891;2895>=d;d++)q[d]=2;for(d=2896;2898>=d;d++)q[d]=1;for(d=2902;2908>=d;d++)q[d]=2;for(d=2915;2920>=d;d++)q[d]=2;for(d=2921;2923>=d;d++)q[d]=1;for(d=2924;2930>=d;d++)q[d]=2;for(d=2931;2962>=d;d++)q[d]=0;for(d=2964;2968>=d;d++)q[d]=2;for(d=2969;2973>=d;d++)q[d]=0;for(d=2975;2991>=d;d++)q[d]=0;for(d=2995;3051>=d;d++)q[d]=0;for(d=3054;3079>=d;d++)q[d]=0;for(d=3081;3088>=d;d++)q[d]=0;for(d=3092;3101>=d;d++)q[d]=0;for(d=3106;3138>=d;d++)q[d]=0;for(d=3146;3151>=
d;d++)q[d]=0;for(d=3153;3166>=d;d++)q[d]=0;for(d=3168;3172>=d;d++)q[d]=0;for(d=3174;3203>=d;d++)q[d]=0;for(d=3294;3358>=d;d++)q[d]=0;for(d=3367;3403>=d;d++)q[d]=0;for(d=3408;3416>=d;d++)q[d]=0;for(d=3417;3438>=d;d++)q[d]=2;for(d=3441;3446>=d;d++)q[d]=2;for(d=3447;3450>=d;d++)q[d]=0;for(d=3451;3459>=d;d++)q[d]=2;for(d=3460;3478>=d;d++)q[d]=0;for(d=3554;3559>=d;d++)q[d]=0;for(d=3560;3570>=d;d++)q[d]=2;for(d=3571;3581>=d;d++)q[d]=0;for(d=3594;3597>=d;d++)q[d]=0;for(d=3601;3604>=d;d++)q[d]=0;for(d=3637;3639>=
d;d++)q[d]=0;for(d=3665;3667>=d;d++)q[d]=0;for(d=3693;3695>=d;d++)q[d]=0;for(d=3701;3727>=d;d++)q[d]=0;for(d=3728;3739>=d;d++)q[d]=2;for(d=3740;3751>=d;d++)q[d]=0;for(d=3753;3760>=d;d++)q[d]=2;for(d=3761;3773>=d;d++)q[d]=0;for(d=3775;3777>=d;d++)q[d]=0;for(d=3779;3781>=d;d++)q[d]=0;for(d=3783;3785>=d;d++)q[d]=0;for(d=3788;3791>=d;d++)q[d]=0;for(d=3797;3802>=d;d++)q[d]=0;for(d=3814;3816>=d;d++)q[d]=0;for(d=3825;3829>=d;d++)q[d]=0;for(d=3832;3841>=d;d++)q[d]=0;for(d=3844;3852>=d;d++)q[d]=0;for(d=3873;3885>=
d;d++)q[d]=0;for(d=3890;3893>=d;d++)q[d]=0;for(d=3907;3912>=d;d++)q[d]=0;for(d=3942;3950>=d;d++)q[d]=0;for(d=3968;3970>=d;d++)q[d]=0;for(d=3973;3976>=d;d++)q[d]=0;for(d=3986;3989>=d;d++)q[d]=0;for(d=3994;3997>=d;d++)q[d]=0;for(d=4048;4051>=d;d++)q[d]=0;for(d=4056;4063>=d;d++)q[d]=0;for(d=4093;4096>=d;d++)q[d]=0;for(d=4390;4398>=d;d++)q[d]=0;for(d=4399;4413>=d;d++)q[d]=2;for(d=4418;4433>=d;d++)q[d]=2;for(d=4455;4457>=d;d++)q[d]=2;for(d=4484;4489>=d;d++)q[d]=0;for(d=4491;4554>=d;d++)q[d]=0;for(d=4568;4589>=
d;d++)q[d]=0;for(d=4652;4656>=d;d++)q[d]=0;for(d=4766;4800>=d;d++)q[d]=0;for(d=5014;5016>=d;d++)q[d]=0;for(d=5069;5072>=d;d++)q[d]=0;for(d=5105;5130>=d;d++)q[d]=0;for(d=5173;5188>=d;d++)q[d]=0;for(d=5253;5259>=d;d++)q[d]=0;for(d=5269;5275>=d;d++)q[d]=0;for(d=5292;5311>=d;d++)q[d]=0;for(d=5329;5331>=d;d++)q[d]=0;for(d=5343;5349>=d;d++)q[d]=0;for(d=5355;5357>=d;d++)q[d]=0;for(d=5387;5389>=d;d++)q[d]=0;for(d=5459;5463>=d;d++)q[d]=0;for(d=5479;5482>=d;d++)q[d]=0;for(d=5518;5520>=d;d++)q[d]=0;for(d=5530;5539>=
d;d++)q[d]=0;for(d=5550;5552>=d;d++)q[d]=0;for(d=5562;5583>=d;d++)q[d]=0;for(d=5623;5625>=d;d++)q[d]=2;for(d=5631;5639>=d;d++)q[d]=0;for(d=5649;5653>=d;d++)q[d]=0;for(d=5663;5680>=d;d++)q[d]=0;for(d=5682;5685>=d;d++)q[d]=0;for(d=5875;5877>=d;d++)q[d]=0;for(d=5921;5940>=d;d++)q[d]=0;for(d=6050;6125>=d;d++)q[d]=0;for(d=6244;6275>=d;d++)q[d]=0;for(d=6328;6348>=d;d++)q[d]=0;for(d=6350;6356>=d;d++)q[d]=0;for(d=6366;6372>=d;d++)q[d]=0;for(d=6381;6387>=d;d++)q[d]=0;for(d=6393;6404>=d;d++)q[d]=0;for(d=6480;6483>=
d;d++)q[d]=0;for(d=6511;6514>=d;d++)q[d]=0;for(d=6579;6581>=d;d++)q[d]=0;for(d=6619;6624>=d;d++)q[d]=0;for(d=6625;6627>=d;d++)q[d]=2;for(d=6628;6632>=d;d++)q[d]=0;for(d=6634;6637>=d;d++)q[d]=0;for(d=6669;6692>=d;d++)q[d]=0;for(d=6707;6709>=d;d++)q[d]=0;for(d=6720;6723>=d;d++)q[d]=0;for(d=6732;6738>=d;d++)q[d]=0;for(d=6931;6933>=d;d++)q[d]=0;for(d=6956;6959>=d;d++)q[d]=0;for(d=7005;7007>=d;d++)q[d]=0;for(d=7057;7070>=d;d++)q[d]=2;for(d=7074;7082>=d;d++)q[d]=0;for(d=7109;7118>=d;d++)q[d]=0;for(d=7119;7127>=
d;d++)q[d]=1;for(d=7374;7376>=d;d++)q[d]=0;for(d=7528;7586>=d;d++)q[d]=0;for(d=7587;7645>=d;d++)q[d]=2;for(d=7845;7859>=d;d++)q[d]=0;for(d=20002;20032>=d;d++)q[d]=0;for(d=20062;20092>=d;d++)q[d]=0;for(d=20135;20138>=d;d++)q[d]=0;for(d=20248;20258>=d;d++)q[d]=0;for(d=20348;20358>=d;d++)q[d]=0;for(d=20436;20440>=d;d++)q[d]=0;for(d=20822;20824>=d;d++)q[d]=0;for(d=20934;20936>=d;d++)q[d]=0;for(d=21035;21037>=d;d++)q[d]=0;for(d=21095;21097>=d;d++)q[d]=0;for(d=21148;21150>=d;d++)q[d]=0;for(d=21413;21423>=
d;d++)q[d]=0;for(d=21473;21483>=d;d++)q[d]=0;for(d=21780;21782>=d;d++)q[d]=0;for(d=21891;21894>=d;d++)q[d]=0;for(d=21896;21899>=d;d++)q[d]=0;for(d=22171;22177>=d;d++)q[d]=0;for(d=22181;22187>=d;d++)q[d]=0;for(d=22191;22197>=d;d++)q[d]=0;for(d=22234;22236>=d;d++)q[d]=0;for(d=22521;22525>=d;d++)q[d]=0;for(d=22991;22994>=d;d++)q[d]=0;for(d=23028;23038>=d;d++)q[d]=0;for(d=23830;23853>=d;d++)q[d]=0;for(d=23866;23872>=d;d++)q[d]=0;for(d=23877;23884>=d;d++)q[d]=0;for(d=23886;23894>=d;d++)q[d]=0;for(d=23946;23948>=
d;d++)q[d]=0;for(d=24311;24313>=d;d++)q[d]=0;for(d=24342;24347>=d;d++)q[d]=0;for(d=24370;24374>=d;d++)q[d]=10;for(d=24375;24381>=d;d++)q[d]=0;for(d=24718;24721>=d;d++)q[d]=0;for(d=24817;24821>=d;d++)q[d]=0;for(d=24877;24882>=d;d++)q[d]=0;for(d=24891;24893>=d;d++)q[d]=0;for(d=25391;25395>=d;d++)q[d]=0;for(d=25828;25838>=d;d++)q[d]=0;for(d=26191;26195>=d;d++)q[d]=0;for(d=26391;26393>=d;d++)q[d]=0;for(d=26701;26722>=d;d++)q[d]=0;for(d=26729;26799>=d;d++)q[d]=2;for(d=26801;26803>=d;d++)q[d]=2;for(d=26811;26813>=
d;d++)q[d]=2;for(d=26847;26870>=d;d++)q[d]=2;for(d=26891;26899>=d;d++)q[d]=0;for(d=26901;26923>=d;d++)q[d]=0;for(d=26929;26946>=d;d++)q[d]=0;for(d=26948;26998>=d;d++)q[d]=0;for(d=27037;27040>=d;d++)q[d]=0;for(d=27205;27232>=d;d++)q[d]=0;for(d=27258;27260>=d;d++)q[d]=0;for(d=27391;27398>=d;d++)q[d]=0;for(d=27561;27564>=d;d++)q[d]=0;for(d=27571;27574>=d;d++)q[d]=0;for(d=27581;27584>=d;d++)q[d]=0;for(d=27591;27594>=d;d++)q[d]=0;for(d=28191;28193>=d;d++)q[d]=0;for(d=28348;28358>=d;d++)q[d]=0;for(d=28402;28432>=
d;d++)q[d]=0;for(d=28462;28492>=d;d++)q[d]=0;for(d=29118;29122>=d;d++)q[d]=0;for(d=29168;29172>=d;d++)q[d]=0;for(d=29177;29185>=d;d++)q[d]=0;for(d=29187;29195>=d;d++)q[d]=0;for(d=29900;29903>=d;d++)q[d]=0;for(d=30161;30179>=d;d++)q[d]=0;for(d=30491;30494>=d;d++)q[d]=0;for(d=30729;30732>=d;d++)q[d]=0;for(d=31251;31259>=d;d++)q[d]=0;for(d=31265;31268>=d;d++)q[d]=0;for(d=31275;31279>=d;d++)q[d]=0;for(d=31281;31297>=d;d++)q[d]=0;for(d=31461;31469>=d;d++)q[d]=0;for(d=31491;31495>=d;d++)q[d]=0;for(d=31917;31922>=
d;d++)q[d]=0;for(d=31965;32E3>=d;d++)q[d]=0;for(d=32001;32003>=d;d++)q[d]=2;for(d=32005;32031>=d;d++)q[d]=2;for(d=32033;32060>=d;d++)q[d]=2;for(d=32064;32067>=d;d++)q[d]=2;for(d=32074;32077>=d;d++)q[d]=2;for(d=32081;32086>=d;d++)q[d]=0;for(d=32107;32130>=d;d++)q[d]=0;for(d=32133;32158>=d;d++)q[d]=0;for(d=32164;32167>=d;d++)q[d]=2;for(d=32180;32199>=d;d++)q[d]=0;for(d=32201;32260>=d;d++)q[d]=0;for(d=32301;32360>=d;d++)q[d]=0;for(d=32601;32662>=d;d++)q[d]=0;for(d=32664;32667>=d;d++)q[d]=2;for(d=32701;32761>=
d;d++)q[d]=0;for(d=53001;53004>=d;d++)q[d]=0;for(d=53008;53019>=d;d++)q[d]=0;for(d=53021;53032>=d;d++)q[d]=0;for(d=53042;53046>=d;d++)q[d]=0;for(d=53074;53080>=d;d++)q[d]=0;for(d=54001;54004>=d;d++)q[d]=0;for(d=54008;54019>=d;d++)q[d]=0;for(d=54021;54032>=d;d++)q[d]=0;for(d=54042;54046>=d;d++)q[d]=0;for(d=54048;54053>=d;d++)q[d]=0;for(d=54074;54080>=d;d++)q[d]=0;for(d=102001;102040>=d;d++)q[d]=0;for(d=102042;102063>=d;d++)q[d]=0;for(d=102065;102067>=d;d++)q[d]=0;for(d=102070;102117>=d;d++)q[d]=0;
for(d=102122;102216>=d;d++)q[d]=0;for(d=102221;102377>=d;d++)q[d]=0;for(d=102382;102388>=d;d++)q[d]=0;for(d=102389;102398>=d;d++)q[d]=2;for(d=102399;102444>=d;d++)q[d]=0;for(d=102445;102447>=d;d++)q[d]=2;for(d=102448;102458>=d;d++)q[d]=0;for(d=102459;102468>=d;d++)q[d]=2;for(d=102469;102496>=d;d++)q[d]=0;for(d=102500;102519>=d;d++)q[d]=1;for(d=102520;102524>=d;d++)q[d]=0;for(d=102525;102529>=d;d++)q[d]=2;for(d=102530;102561>=d;d++)q[d]=0;for(d=102570;102588>=d;d++)q[d]=0;for(d=102590;102598>=d;d++)q[d]=
0;for(d=102601;102603>=d;d++)q[d]=0;for(d=102605;102628>=d;d++)q[d]=0;for(d=102629;102646>=d;d++)q[d]=2;for(d=102648;102700>=d;d++)q[d]=2;for(d=102701;102703>=d;d++)q[d]=0;for(d=102707;102730>=d;d++)q[d]=2;for(d=102733;102758>=d;d++)q[d]=2;for(d=102767;102798>=d;d++)q[d]=0;for(d=102965;102969>=d;d++)q[d]=0;for(d=102971;102973>=d;d++)q[d]=0;for(d=102975;102989>=d;d++)q[d]=0;for(d=102990;102992>=d;d++)q[d]=1;for(d=102997;103002>=d;d++)q[d]=0;for(d=103003;103008>=d;d++)q[d]=2;for(d=103009;103011>=d;d++)q[d]=
0;for(d=103012;103014>=d;d++)q[d]=2;for(d=103019;103021>=d;d++)q[d]=0;for(d=103022;103024>=d;d++)q[d]=2;for(d=103029;103031>=d;d++)q[d]=0;for(d=103032;103034>=d;d++)q[d]=2;for(d=103065;103068>=d;d++)q[d]=0;for(d=103074;103076>=d;d++)q[d]=0;for(d=103077;103079>=d;d++)q[d]=1;for(d=103080;103082>=d;d++)q[d]=0;for(d=103083;103085>=d;d++)q[d]=2;for(d=103090;103093>=d;d++)q[d]=0;for(d=103097;103099>=d;d++)q[d]=0;for(d=103100;103102>=d;d++)q[d]=2;for(d=103107;103109>=d;d++)q[d]=0;for(d=103110;103112>=d;d++)q[d]=
2;for(d=103113;103116>=d;d++)q[d]=0;for(d=103117;103120>=d;d++)q[d]=2;for(d=103153;103157>=d;d++)q[d]=0;for(d=103158;103162>=d;d++)q[d]=2;for(d=103163;103165>=d;d++)q[d]=0;for(d=103166;103168>=d;d++)q[d]=1;for(d=103169;103171>=d;d++)q[d]=2;for(d=103186;103188>=d;d++)q[d]=0;for(d=103189;103191>=d;d++)q[d]=2;for(d=103192;103195>=d;d++)q[d]=0;for(d=103196;103199>=d;d++)q[d]=2;for(d=103200;103224>=d;d++)q[d]=0;for(d=103225;103227>=d;d++)q[d]=1;for(d=103232;103237>=d;d++)q[d]=0;for(d=103238;103243>=d;d++)q[d]=
2;for(d=103244;103246>=d;d++)q[d]=0;for(d=103247;103249>=d;d++)q[d]=2;for(d=103254;103256>=d;d++)q[d]=0;for(d=103257;103259>=d;d++)q[d]=2;for(d=103264;103266>=d;d++)q[d]=0;for(d=103267;103269>=d;d++)q[d]=2;for(d=103300;103375>=d;d++)q[d]=0;for(d=103381;103383>=d;d++)q[d]=0;for(d=103384;103386>=d;d++)q[d]=1;for(d=103387;103389>=d;d++)q[d]=0;for(d=103390;103392>=d;d++)q[d]=2;for(d=103397;103399>=d;d++)q[d]=0;for(d=103400;103471>=d;d++)q[d]=2;for(d=103476;103478>=d;d++)q[d]=0;for(d=103479;103481>=d;d++)q[d]=
2;for(d=103486;103488>=d;d++)q[d]=0;for(d=103489;103491>=d;d++)q[d]=2;for(d=103492;103495>=d;d++)q[d]=0;for(d=103496;103499>=d;d++)q[d]=2;for(d=103528;103543>=d;d++)q[d]=0;for(d=103544;103548>=d;d++)q[d]=2;for(d=103549;103551>=d;d++)q[d]=0;for(d=103552;103554>=d;d++)q[d]=1;for(d=103555;103557>=d;d++)q[d]=2;for(d=103558;103560>=d;d++)q[d]=0;for(d=103571;103573>=d;d++)q[d]=0;for(d=103574;103576>=d;d++)q[d]=2;for(d=103577;103580>=d;d++)q[d]=0;for(d=103581;103583>=d;d++)q[d]=2;for(d=103600;103694>=d;d++)q[d]=
0;for(d=103700;103793>=d;d++)q[d]=2;for(d=103794;103871>=d;d++)q[d]=0;for(d=103900;103971>=d;d++)q[d]=2;return q})},"esri/geometry/screenUtils":function(){define("dojo/_base/array dojo/_base/lang dojo/sniff ../kernel ./Point ./ScreenPoint ./Polyline ./Polygon ./Multipoint ./Extent".split(" "),function(r,l,d,q,k,m,p,h,e,c){var b=function(){return 9>d("ie")?function(a,b,c,e,h,f,d,p,k){var g=[],n=Math.round,t,u=d.length,v,m,x,w,l,q;for(t=0;t<u;t++)if(v=d[t],w=p?p(v[0][0],v[0][1],k):v[0],1<(x=v.length))for(l=
n((w[0]-a)*c+h),q=n((b-w[1])*e+f),w=p?p(v[1][0],v[1][1],k):v[1],m=n((w[0]-a)*c+h),w=n((b-w[1])*e+f),g.push("M",l+","+q,"L",m+","+w),m=2;m<x;m++)w=p?p(v[m][0],v[m][1],k):v[m],l=n((w[0]-a)*c+h),q=n((b-w[1])*e+f),g.push(l+","+q);else l=n((w[0]-a)*c+h),q=n((b-w[1])*e+f),g.push("M",l+","+q);return g}:function(a,b,c,e,h,f,d,p,k,m){var g=[],n,t,u,v,x,w,l=Math.round;n=0;for(u=d?d.length:0;n<u;n++){x=d[n];g.push("M");t=0;for(v=x?x.length:0;t<v;t++)w=p?p(x[t][0],x[t][1],k):x[t],g.push(l((w[0]-a)*c+h)+","+l((b-
w[1])*e+f));m||g.push("Z")}return g}}();return{toScreenPoint:function(a,b,c,e,h){var f=a.spatialReference,g=e.spatialReference,n=e.x;e=e.y;f&&g&&!f.equals(g)&&f._canProject(g)&&(f=f.isWebMercator()?k.lngLatToXY(n,e):k.xyToLngLat(n,e,!0),n=f[0],e=f[1]);n=(n-a.xmin)*(b/a.getWidth());e=(a.ymax-e)*(c/a.getHeight());h||(n=Math.round(n),e=Math.round(e));return new m(n,e)},toScreenGeometry:function(a,b,d,n){var g=a.xmin,f=a.ymax,u=b/a.getWidth(),m=d/a.getHeight(),w=r.forEach,l=Math.round;if(n instanceof
k)return new k(l((n.x-g)*u),l((f-n.y)*m));if(n instanceof e){a=new e;var q=a.points;w(n.points,function(a,b){q[b]=[l((a[0]-g)*u),l((f-a[1])*m)]});return a}if(n instanceof c)return new c(l((n.xmin-g)*u),l((f-n.ymin)*m),l((n.xmax-g)*u),l((f-n.ymax)*u));if(n instanceof p){a=new p;var y=a.paths,B;w(n.paths,function(a,b){B=y[b]=[];w(a,function(a,b){B[b]=[l((a[0]-g)*u),l((f-a[1])*m)]})});return a}if(n instanceof h){a=new h;var C=a.rings,E;w(n.rings,function(a,b){E=C[b]=[];w(a,function(a,b){E[b]=[l((a[0]-
g)*u),l((f-a[1])*m)]})});return a}},_toScreenPath:function(a,c,e,n,h,f){var g=n instanceof p,d=a.spatialReference,t=n.spatialReference,u,m;d&&t&&!d.equals(t)&&d._canProject(t)&&(d.isWebMercator()?u=k.lngLatToXY:(u=k.xyToLngLat,m=!0));return b(a.xmin,a.ymax,c/a.getWidth(),e/a.getHeight(),h,f,g?n.paths:n.rings,u,m,g)},toMapPoint:function(a,b,c,e){return new k(a.xmin+e.x/(b/a.getWidth()),a.ymax-e.y/(c/a.getHeight()),a.spatialReference)},toMapGeometry:function(a,b,d,n){var g=a.xmin,f=a.ymax,u=a.spatialReference,
m=b/a.getWidth(),w=d/a.getHeight(),l=r.forEach;if(n instanceof k)return new k(g+n.x/m,f-n.y/w,u);if(n instanceof e){a=new e(u);var q=a.points;l(n.points,function(a,b){q[b]=[g+a[0]/m,f-a[1]/w]});return a}if(n instanceof c)return new c(g+n.xmin/m,f-n.ymin/w,g+n.xmax/m,f-n.ymax/w,u);if(n instanceof p){a=new p(u);var y=a.paths,B;l(n.paths,function(a,b){B=y[b]=[];l(a,function(a,b){B[b]=[g+a[0]/m,f-a[1]/w]})});return a}if(n instanceof h){a=new h(u);var C=a.rings,E;l(n.rings,function(a,b){E=C[b]=[];l(a,
function(a,b){E[b]=[g+a[0]/m,f-a[1]/w]})});return a}}}})},"esri/layers/GraphicsLayer":function(){define("dojo/_base/declare dojo/_base/connect dojo/_base/lang dojo/_base/array dojo/_base/window dojo/dom-attr dojo/dom-construct dojo/dom-style dojo/dom dojox/gfx dojox/gfx/matrix ./gfxSniff!esri-svg?dojox/gfx/filters ./layer ../kernel ../lang ../sniff ../Color ../domUtils ../symbols/MarkerSymbol ../symbols/SimpleMarkerSymbol ../geometry/Point ../geometry/ScreenPoint ../geometry/Extent ../geometry/mathUtils ../geometry/screenUtils ../PluginTarget ./gfxSniff!esri-svg?dojox/gfx/svgext".split(" "),
function(r,l,d,q,k,m,p,h,e,c,b,a,g,u,n,t,f,v,x,w,z,A,y,B,C,E){var D,F=-1!==c.renderer.toLowerCase().indexOf("svg"),G=-1!==c.renderer.toLowerCase().indexOf("canvas"),J=9>t("ie"),N=9===t("ie");x=10===t("ie");var M=void 0===t("ie")&&7==t("trident"),L=x||M,K=t("esri-touch");x=r(null,{declaredClass:"esri.layers._GraphicsContainer",_setMap:function(a,b){var f,g=this._connects=[];this._map=a;this._useWillChange="css-transforms"===a.navigationMode&&F&&t("esri-will-change");G?(f=p.create("div",{style:"overflow: visible; position: absolute;"},
b),this._surface={getEventSource:function(){return f}},g.push(l.connect(f,"onmousedown",this,this._canvasDownHandler)),g.push(l.connect(f,"onmouseup",this,this._canvasUpHandler)),g.push(l.connect(f,"onclick",this,this._canvasClickHandler)),D.prototype._canvas=!0):(f=(this._surface=c.createSurface(b,a.width,a.height)).getEventSource(),this._useWillChange&&h.set(f,"will-change","transform"),h.set(f=J?f.parentNode:f,{overflow:"visible",position:"absolute"}));g.push(l.connect(a,"onResize",this,"_onResizeHandler"));
this._useWillChange&&(g.push(l.connect(a,"onPan",this,"_onPanHandler")),g.push(l.connect(a,"onPanEnd",this,"_onPanEndHandler")),g.push(l.connect(a,"onExtentChange",this,"_onExtentChangeHandler")));return f},_onPanHandler:function(a,b){var c=this._map.__visibleRect,f=c.x+b.x,c=c.y+b.y;this._panDx=f;this._panDy=c;h.set(this._surface.getEventSource(),u._css.names.transform,u._css.translate(f,c))},_onPanEndHandler:function(a,b){var c=this._map.__visibleRect,f=c.x,c=c.y;this._panDx=f;this._panDy=c;h.set(this._surface.getEventSource(),
u._css.names.transform,u._css.translate(f,c))},_onExtentChangeHandler:function(a,b,c,f){c&&(this._panDy=this._panDx=0,h.set(this._surface.getEventSource(),u._css.names.transform,u._css.translate(0,0)))},_getTransform:function(){return{dx:this._panDx||0,dy:this._panDy||0}},_onResizeHandler:function(a,b,c){a=this._surface.getEventSource();var f=this._map,g;J&&h.set(a=a.parentNode,{width:b+"px",height:c+"px",clip:"rect(0px "+b+"px "+c+"px 0px)"});m.set(a,"width",b);m.set(a,"height",c);this._surface.declaredClass||
q.forEach(a.childNodes,function(a){m.set(a,"width",b);m.set(a,"height",c)});f.loaded&&(f.graphics.suspended||(f.graphics._resized=!0),q.forEach(f.graphicsLayerIds,function(a){g=f.getLayer(a);g.suspended||(g._resized=!0,g._childLayer&&(g._childLayer._resized=!0));g._updateSVGFilters(null,null,b,c)}),f.graphics._updateSVGFilters(null,null,b,c),f._labels&&f._labels._updateSVGFilters(null,null,b,c))},_cleanUp:function(){q.forEach(this._connects,l.disconnect,l);this._map=this._surface=null},_processEvent:function(a){var b=
this._map;a.screenPoint=new A(a.pageX-b.position.x,a.pageY-b.position.y);a.mapPoint=b.toMap(a.screenPoint)},_canvasDownHandler:function(a){this._processEvent(a);this._downPt=a.screenPoint.x+","+a.screenPoint.y},_canvasUpHandler:function(a){this._processEvent(a);this._upPt=a.screenPoint.x+","+a.screenPoint.y},_tolerance:15,_isPrimaryMatch:function(a,b,c,f){if(!a.visible||!b)return!1;var g=b.getTransformedBoundingBox(),e;return g?(e=new y(g[0].x,g[0].y,g[2].x,g[2].y),delete e.spatialReference,K?e.intersects(c):
e.contains(f)):q.some(b.children||[],function(a){g=a.getTransformedBoundingBox();e=new y(g[0].x,g[0].y,g[2].x,g[2].y);delete e.spatialReference;return K?e.intersects(c):e.contains(f)})},_canvasClickHandler:function(a){if(this._downPt&&this._upPt&&this._downPt===this._upPt){this._processEvent(a);var b=this._map,c=q.map(b.graphicsLayerIds,function(a){return b.getLayer(a)});c.push(b.graphics);c.reverse();var c=q.filter(c,function(a){return a.loaded&&a._mouseEvents&&!a.suspended&&(!n.isDefined(a.opacity)||
0<a.opacity)}),f=a.screenPoint,g=this._tolerance,e=f.x-g,h=f.y+g,d=f.x+g,g=f.y-g,t=new y(e,g,d,h),e=b.toMap(new A(e,h)),d=b.toMap(new A(d,g)),h=e.spatialReference._getInfo(),u=new y(y.prototype._normalizeX(e.x,h).x,e.y,y.prototype._normalizeX(d.x,h).x,d.y,e.spatialReference),p;delete t.spatialReference;q.some(c,function(a){a=q.filter(a.graphics,function(a){return this._isPrimaryMatch(a,a.getDojoShape(),t,f)||!(!a._bgShape||!this._isPrimaryMatch(a,a._bgShape,t,f))},this);a.reverse();if(0<a.length){var b;
q.some(a,function(a){return a.geometry&&u.intersects(a.geometry)?(b=a,!0):!1});if(b)return p=b,!0}return!1},this);p&&(c=p.getLayer())&&(a.graphic=p,c.onClick(a))}}});D=r(g,{declaredClass:"esri.layers._GraphicsLayer",managedSuspension:!0,surfaceType:G?"canvas-2d":c.renderer,_eventMap:{"graphic-add":["graphic"],"graphic-remove":["graphic"],"renderer-change":["renderer"]},constructor:function(a,b){a&&(d.isString(a)||d.isObject(a)&&(a.layerDefinition||a.query))&&(a=b);this._params=d.mixin({displayOnPan:!0,
drawMode:!0,styling:!0},a||{});var c=this._params.dataAttributes;"string"===typeof c&&(c=[c]);this.styling=F?this._params.styling:!0;this.dataAttributes=c;this.infoTemplate=a&&a.infoTemplate;this.graphics=[];this._draw=d.hitch(this,this._draw);this._refresh=d.hitch(this,this._refresh);this.registerConnectEvents()},getNode:function(){return this._div&&this._div.getEventSource()},setDrawMode:function(a){this._params.drawMode=a},renderer:null,_setMap:function(a,b){this.inherited(arguments);this._map=
a;this._wrap=a.wrapAround180;this._srInfo=a.spatialReference._getInfo();this._svgFilters={};this._lineMarkers={};this._canvas?(b=c.createSurface(b.getEventSource(),a.width,a.height),h.set(b.rawNode,"position","absolute"),this._div=b.createGroup(),this._renderProto=this._div.constructor.prototype._render,this._div._render=d.hitch(this,this._canvasRender)):this._div=b.createGroup();this._bgGroup=this._div.createGroup();this._div.getEventSource().id=this.id+"_layer";this._initOpacity();return this._div},
_unsetMap:function(a,b){q.forEach(this.graphics,function(a){a._shape=null});this._canvas?(b=this._div.getParent(),b._parent={},p.destroy(b.rawNode),b.destroy()):(this._div.clear(),b.remove(this._div),p.destroy(this._div.getEventSource()));this._map=this._div=this._svgFilters=this._lineMarkers=null;clearTimeout(this._wakeTimer);this._wakeTimer=null;this._disableDrawConnectors();this.inherited(arguments)},_initOpacity:function(){var a=this.opacity;n.isDefined(a)&&1>a&&this.setOpacity(a,!0)},_onZoomStartHandler:function(){v.hide(this._div.getEventSource())},
_onExtentChangeHandler:function(a,b,c,f){clearTimeout(this._wakeTimer);this._wakeTimer=null;c?(a=this._map.__visibleRect,b=this._div,this._evalSDRenderer(),this._refresh(!0),this._updateTransform(b,a.x,a.y,!0),this._renderProto&&b.surface.pendingRender?this._dirty=!0:this.suspended||v.show(b.getEventSource())):this._resized&&(this._resized=!1,this._refresh(!1));if(0<this.graphics.length)this.onUpdate()},_canvasRender:function(){var a=this._div;this._dirty&&(delete this._dirty,this.suspended||v.show(a.getEventSource()));
return this._renderProto.apply(a,arguments)},_refresh:function(a){var b=this.graphics,c=b.length,f,g=this._draw;for(f=0;f<c;f++)g(b[f],a)},refresh:function(){this._refresh(!0)},redraw:function(){this._refresh(!0)},_getTransform:function(){var a={dx:0,dy:0};this._map&&(this._map._gc._useWillChange?a=this._map._gc._getTransform():this._div&&(a=this._div.getTransform()));return a},_onPanHandler:function(a,b){this._panDx=b.x;this._panDy=b.y;var c=this._map.__visibleRect;this._updateTransform(this._div,
c.x+b.x,c.y+b.y);M&&this._updateSVGMarkers()},_onPanEndUpdateHandler:function(a,b){var c=this._map.__visibleRect;this._params._child||b.x===this._panDx&&b.y===this._panDy?(this._updateSVGFilters(-c.x,-c.y),this._updateSVGMarkers()):this._updateTransform(this._div,c.x,c.y,!0);this._refresh(!1);if(this.graphics.length)this.onUpdate()},_onPanStartHandler:function(){v.hide(this._div.getEventSource())},_onPanEndHandler:function(){var a=this._map.__visibleRect,b=this._div;this._updateTransform(b,a.x,a.y,
!0);this._refresh(!1);this._renderProto&&b.surface.pendingRender?this._dirty=!0:v.show(b.getEventSource());if(this.graphics.length)this.onUpdate()},_updateTransform:function(a,c,f,g){this._map._gc._useWillChange||a.setTransform(b.translate({x:c,y:f}));g&&(this._updateSVGFilters(-c,-f),this._updateSVGMarkers())},onSuspend:function(){this.inherited(arguments);v.hide(this._div.getEventSource());clearTimeout(this._wakeTimer);this._wakeTimer=null;this._disableDrawConnectors()},onResume:function(a){this.inherited(arguments);
a.firstOccurrence&&this._evalSDRenderer();this._enableDrawConnectors();this._wakeTimer=this._wakeTimer||setTimeout(d.hitch(this,function(){this.suspended||this._map.__zooming||this._onExtentChangeHandler(null,null,!0)}),0)},_enableDrawConnectors:function(){var a=this._map,b=l.connect;this._disableDrawConnectors();this._params.displayOnPan?(this._params._child||(this._onPanHandler_connect=b(a,"onPan",this,"_onPanHandler")),this._onPanEndHandler_connect=b(a,"onPanEnd",this,"_onPanEndUpdateHandler")):
(this._onPanStartHandler_connect=b(a,"onPanStart",this,"_onPanStartHandler"),this._onPanEndHandler_connect=b(a,"onPanEnd",this,"_onPanEndHandler"));this._onZoomStartHandler_connect=b(a,"onZoomStart",this,"_onZoomStartHandler");this._onExtentChangeHandler_connect=b(a,"onExtentChange",this,"_onExtentChangeHandler")},_disableDrawConnectors:function(){var a=l.disconnect;a(this._onExtentChangeHandler_connect);a(this._onZoomStartHandler_connect);a(this._onPanHandler_connect);a(this._onPanStartHandler_connect);
a(this._onPanEndHandler_connect);this._onExtentChangeHandler_connect=this._onZoomStartHandler_connect=this._onPanHandler_connect=this._onPanStartHandler_connect=this._onPanEndHandler_connect=null},_updateExtent:function(a){var b=a.geometry;if(!b)a._extent=null;else if(!(a._extent=b.getExtent())){var c,f;if("esri.geometry.Point"===b.declaredClass)c=b.x,f=b.y;else if("esri.geometry.Multipoint"===b.declaredClass)c=b.points[0][0],f=b.points[0][1];else{a._extent=null;return}a._extent=new y(c,f,c,f,b.spatialReference)}},
_intersects:function(a,b,c){var f=a.spatialReference,g=b.spatialReference,e=f&&g&&!f.equals(g)&&f._canProject(g)&&4326===g.wkid;if(this._wrap&&!c){c=[];var f=a._getFrameWidth(),n=this._srInfo,h=a._clip?a._getAvailExtent():a.extent,d,t,u,p,v=[];d=b._partwise;e&&(h=a.geographicExtent,n=g._getInfo());a=h._getParts(n);if(d&&d.length)for(b=[],g=0,e=d.length;g<e;g++)b=b.concat(d[g]._getParts(n));else b=b._getParts(n);g=0;for(e=b.length;g<e;g++)for(u=b[g],n=0,h=a.length;n<h;n++)if(p=a[n],p.extent.intersects(u.extent))for(d=
0,t=u.frameIds.length;d<t;d++)c.push((p.frameIds[0]-u.frameIds[d])*f);g=0;for(e=c.length;g<e;g++)d=c[g],q.indexOf(c,d)===g&&v.push(d);return v.length?v:null}return(e?a.geographicExtent:a.extent).intersects(b)?[0]:null},_defaultMarker:{type:"simplemarkersymbol",style:"square",size:1,xoffset:0,yoffset:0,angle:0},_draw:function(a,b){if(this._params.drawMode&&this._map&&!this.suspended&&!this._map.__zooming&&!this._resized)try{var c=a._extent,f,g,e=!F||this.styling,n=F&&this.dataAttributes,h=a.getDojoShape(),
d;if(a.visible&&c&&(f=this._intersects(this._map,c,a.geometry._originOnly))&&(g=e?this._getSymbol(a):this._defaultMarker)){if(a._offsets&&a._offsets.join(",")===f.join(",")?d=!0:a._offsets=f,!h||b||!d){var t=a.geometry.type,c={graphic:a},u=a._bgShape,p=e&&!a.symbol?this._getRenderer(a):null,v=p&&p.backgroundFillSymbol;if("point"===t)this._isInvalidShape(g,h)&&this._removeShape(a),a._shape=this._drawPoint(this._div,a.geometry,g,a.getDojoShape(),f,p,a),e&&this._symbolizePoint(a.getDojoShape(),g,p,a);
else if("multipoint"===t)this._drawMarkers(a,g,f,p),e&&this._symbolizeMarkers(a,g,p);else{var m,t=g,k,w,x;e&&(t=(m="simplemarkersymbol"===g.type||"picturemarkersymbol"===g.type||"textsymbol"===g.type?g:null)?v:g);e&&t&&-1<t.type.indexOf("fillsymbol")&&(k=this._bgGroup,x=!(!k||!m));u&&!x&&this._removeBgShape(a);t&&(!x&&this._isInvalidShape(t,a._shape)&&this._removeShape(a,!1),w=this._drawShape(a,f,k||this._div,x?u:a.getDojoShape()),e&&this._symbolizeShape(w,t,p,t===v,a),a[x?"_bgShape":"_shape"]=w);
if(m){this._isInvalidShape(m,a._shape)&&this._removeShape(a,!1);var l=a.geometry.getCentroid();(w=l&&this._drawPoint(this._div,l,m,a._shape,f,p,a))&&this._symbolizePoint(w,m,p,a);a._shape=w}}G||(a._bgShape&&this._initNode(a,a._bgShape,a._bgShape!==u,c,n),a._shape&&this._initNode(a,a._shape,a._shape!==h,c,n));c.node=a.getNode();this.onGraphicDraw(c)}}else h&&this._removeShape(a)}catch(qa){this._errorHandler(qa,a)}},_initNode:function(a,b,c,f,g){if(b=b&&b.getNode())b.e_graphic=a,this._addDataAttrs(a,
g,b),c&&(f.node=b,this.onGraphicNodeAdd(f))},_removeShape:function(a,b,c){var f=a.getDojoShape(),g=f&&f.getNode();f&&!c&&(f.removeShape(),f.destroy());a._shape=a._offsets=null;!1!==b&&this._removeBgShape(a,c);if(g&&(g.e_graphic=null,!G))this.onGraphicNodeRemove({graphic:a,node:g})},_removeBgShape:function(a,b){var c=a._bgShape,f=c&&c.getNode();c&&!b&&(c.removeShape(),c.destroy());a._bgShape=null;if(f&&(f.e_graphic=null,!G))this.onGraphicNodeRemove({graphic:a,node:f})},_addDataAttrs:function(a,b,c){var f=
a.attributes,g,e=b?b.length:0,n=this._getRenderer(a);if(c&&f){for(g=0;g<e;g++)(c=b[g])&&a.attr("data-"+c,f[c]);!this.styling&&n&&(n.getBreakIndex?(b=n.getBreakIndex(a),a.attr("data-class-break",-1!==b?b:null)):n.getUniqueValueInfo&&(b=n.getUniqueValueInfo(a),a.attr("data-unique-value",b?b.value:null)))}},_drawShape:function(a,b,c,f){a=a.geometry;var g=a.type,e=this._map,n=e.extent,h=e.width,d=e.height,e=e.__visibleRect,t=[],u,p;u="extent"===g;if("rect"===g||u)t={x:0,y:0,spatialReference:a.spatialReference},
t.x=u?a.xmin:a.x,t.y=u?a.ymax:a.y,g=C.toScreenPoint(n,h,d,t),t.x=u?a.xmax:a.x+a.width,t.y=u?a.ymin:a.y+a.height,a=C.toScreenPoint(n,h,d,t),b={x:g.x-e.x+b[0],y:g.y-e.y,width:Math.abs(a.x-g.x),height:Math.abs(a.y-g.y)},0===b.width&&(b.width=1),0===b.height&&(b.height=1),f=this._drawRect(c,f,b);else if("polyline"===g||"polygon"===g){u=0;for(p=b.length;u<p;u++)t=t.concat(C._toScreenPath(n,h,d,a,-e.x+b[u],-e.y));f=this._drawPath(c,f,t);this._rendererLimits&&("polyline"===g?this._clipPolyline(f,a):this._clipPolygon(f,
a))}return f},_drawRect:function(a,b,c){return b?b.setShape(c):a.createRect(c)},_drawImage:function(a,b,c){return b?b.setShape(c):a.createImage(c)},_drawCircle:function(a,b,c){return b?b.setShape(c):a.createCircle(c)},_drawPath:function(){return J?function(a,b,f,g){f=g?f:f.join(" ");if(b)return b.setShape(f);b=a.createObject(g?c.Path:c.EsriPath,f);a._overrideSize(b.getEventSource());return b}:function(a,b,c,f){c=f?c:c.join(" ");return b?b.setShape(c):a.createPath(c)}}(),_drawText:function(a,b,c){return b?
b.setShape(c):a.createText(c)},_evalSDRenderer:function(a){var b=this._map,c=this.renderer,f,g=this._rndForScale;b&&b.loaded&&c&&c.getRendererInfo&&(f="zoom"===c.rangeType?c.getRendererInfoByZoom(b.getZoom()):c.getRendererInfoByScale(b.getScale()));this._rndForScale=f&&f.renderer;(b=this._getRenderer())&&b.prepareForViewChange();a||this._rndForScale==g||this.emit("renderer-change",{renderer:this._rndForScale})},_getRenderer:function(a){var b=this._rndForScale||this.renderer;a&&b&&b.getObservationRenderer&&
(b=b.getObservationRenderer(a));return b},_getSymbol:function(a){var b=this._getRenderer();return a.symbol||b&&b.getSymbol(a)},_getVariable:function(a,b,c){var f;a&&(f=(a=a.getVisualVariablesForType(b,c))&&a[0]);return f},_applyOpacity:function(a,b,c,g){b=b.getOpacity(g,{opacityInfo:c});null!=b&&(a=new f(a),a.a=b);return a},_symbolizeShape:function(a,b,c,f,g){var e=b.getStroke(),n=b.getFill(),h=b.type,t,u,p=-1!==h.indexOf("linesymbol"),v=-1!==h.indexOf("fillsymbol")?null:this._getVariable(c,"sizeInfo",
!1),m=this._getVariable(c,"colorInfo",!1),k=this._getVariable(c,"opacityInfo",!1),w=p?"none"!==b.style:b.outline&&"none"!==b.outline.style,x=p?null:this._getVariable(c,"sizeInfo","outline"),v=(v=f?x:x||v)?c.getSize(g,{sizeInfo:v,resolution:this._map.getResolutionInMeters(),scale:this._map.getScale()}):null;f&&(m=k=null);(m||k)&&"picturefillsymbol"!==h&&(p?(t=e&&e.color,m&&(t=c.getColor(g,{colorInfo:m})||t),t&&k&&(t=this._applyOpacity(t,c,k,g))):n&&n.toCss&&(u=n,m&&(u=c.getColor(g,{colorInfo:m})||
u),u&&k&&(u=this._applyOpacity(u,c,k,g))));a.setStroke(!w||null==v&&!t?e:d.mixin({},e,null!=v?{width:v}:null,t&&{color:t})).setFill(u||n);p&&this._applyLineMarker(a,b)},_smsToPath:function(){return J?function(a,b,c,f,g,e,n,h,d){switch(b){case a.STYLE_SQUARE:return["M",g+","+n,"L",e+","+n,e+","+h,g+","+h,"X","E"];case a.STYLE_CROSS:return["M",c+","+n,"L",c+","+h,"M",g+","+f,"L",e+","+f,"E"];case a.STYLE_X:return["M",g+","+n,"L",e+","+h,"M",g+","+h,"L",e+","+n,"E"];case a.STYLE_DIAMOND:return["M",c+
","+n,"L",e+","+f,c+","+h,g+","+f,"X","E"];case a.STYLE_TARGET:return["M",g+","+n,"L",e+","+n,e+","+h,g+","+h,g+","+n,"M",g-d+","+f,"L",g+","+f,"M",c+","+(n-d),"L",c+","+n,"M",e+d+","+f,"L",e+","+f,"M",c+","+(h+d),"L",c+","+h,"E"]}}:function(a,b,c,f,g,e,n,h,d){switch(b){case a.STYLE_SQUARE:return["M",g+","+n,e+","+n,e+","+h,g+","+h,"Z"];case a.STYLE_CROSS:return["M",c+","+n,c+","+h,"M",g+","+f,e+","+f];case a.STYLE_X:return["M",g+","+n,e+","+h,"M",g+","+h,e+","+n];case a.STYLE_DIAMOND:return["M",
c+","+n,e+","+f,c+","+h,g+","+f,"Z"];case a.STYLE_TARGET:return["M",g+","+n,e+","+n,e+","+h,g+","+h,g+","+n,"M",g-d+","+f,g+","+f,"M",c+","+(n-d),c+","+n,"M",e+d+","+f,e+","+f,"M",c+","+(h+d),c+","+h]}}}(),_pathStyles:{square:1,cross:1,x:1,diamond:1,target:1},_typeMaps:{picturemarkersymbol:"image",picturefillsymbol:"path",simplefillsymbol:"path",simplelinesymbol:"path",cartographiclinesymbol:"path",textsymbol:"text"},_isInvalidShape:function(a,b){var c=b&&b.shape&&b.shape.type,f=a&&a.type,g=a&&a.style;
"rect"===c&&(c="path");f&&(g=this._typeMaps[f]||g);this._pathStyles[g]&&(g="path");return"shieldlabelsymbol"===f?!0:!(!c||!g||c===g)},_reArialFont:/\s*(^|,)\s*arial\s*(,|$)\s*/i,_fallbackFont:"Arial",_drawPoint:function(a,c,f,g,e,n,h){var d=f.type,t=this._map,u=t.__visibleRect,p=C.toScreenPoint(t.extent,t.width,t.height,c).offset(-u.x+e[0],-u.y),u=p.x,v=p.y,m;c=[];var k,x=this._getVariable(n,"rotationInfo",!1),x=x?n.getRotationAngle(h,{rotationInfo:x}):null,l=this._getVariable(n,"sizeInfo",!1),t=
l?n.getSize(h,{sizeInfo:l,shape:f.style,resolution:t.getResolutionInMeters(),scale:t.getScale()}):null;x&&c.push(b.rotategAt(x,p));if(0!==f.xoffset||0!==f.yoffset)k=b.translate(f.xoffset,-f.yoffset),c.push(k);0!==f.angle&&c.push(b.rotategAt(f.angle,p));if("simplemarkersymbol"===d)switch(m=f.style,n=Math.round,t=null!=t?t:f.size,m){case w.STYLE_SQUARE:case w.STYLE_CROSS:case w.STYLE_X:case w.STYLE_DIAMOND:f=isNaN(t)?16:t/2;m=this._drawPath(a,g,this._smsToPath(w,m,u,v,n(u-f),n(u+f),n(v-f),n(v+f)));
break;case w.STYLE_TARGET:h=f._targetWidth/2;p=f._targetHeight/2;m=this._drawPath(a,g,this._smsToPath(w,m,u,v,n(u-h),n(u+h),n(v-p),n(v+p),f._spikeSize));break;case w.STYLE_PATH:m=this._drawPath(a,g,f.path,!0);f=m.getBoundingBox();a=this._getScaleMatrix(f,t);1===a.xx&&1===a.yy||c.push(b.scaleAt(a.xx,a.yy,p));c.push(b.translate(-(f.x+f.width/2)+u,-(f.y+f.height/2)+v));break;default:f=isNaN(t)?16:t/2,m=this._drawCircle(a,g,{cx:u,cy:v,r:f})}else if("shieldlabelsymbol"===d)m=f.width,p=f.height,g=a.createGroup(),
m=a.createImage({x:u-m/2,y:v-p/2,width:m,height:p,src:f.url}),g.add(m),null!=f.font&&(v+=.2*f.getHeight(),a=a.createText({type:"text",text:f.text,x:u,y:v,align:"middle",decoration:f.decoration,rotated:f.rotated,kerning:f.kerning}),a.setFont(f.font),a.setFill(f.color),g.add(a)),m=g;else if("picturemarkersymbol"===d){if(null==t?(m=f.width,p=f.height):(p=t,m=f.width/f.height*p,k&&(null!=k.dx&&(k.dx=k.dx/f.width*m),null!=k.dy&&(k.dy=k.dy/f.height*p))),m=this._drawImage(a,g,{x:u-m/2,y:v-p/2,width:m,height:p,
src:f.url}),F&&(a=m.getNode()))f=(f=this._getVariable(n,"opacityInfo",!1))?n.getOpacity(h,{opacityInfo:f}):null,null!=f?a.setAttribute("opacity",f):a.setAttribute("opacity",1)}else if("textsymbol"===d){if(n=f.font){m=null!=t;h=n.family&&!this._reArialFont.test(n.family);if(m||h)n=new n.constructor(n.toJson());m&&n.setSize(t);h&&n.setFamily(n.family+","+this._fallbackFont)}m=this._drawText(a,g,{type:"text",text:f.text,x:u,y:v,align:f.getSVGAlign(),decoration:f.decoration||n&&n.decoration,rotated:f.rotated,
kerning:f.kerning});n&&m.setFont(n);F&&(a=m.getNode(),u=f.getSVGBaseline(),v=f.getSVGBaselineShift(),a&&(a.setAttribute("dominant-baseline",u),v&&a.setAttribute("baseline-shift",v),this._applyHalo(m,f.haloColor,f.haloSize)))}m.setTransform(b.multiply(c));m._wrapOffsets=e;return m},_applyLineMarker:function(a,b){if(F&&!N){var c=a&&a.rawNode,f=b.color,g=b.marker;if(c&&f&&g&&"arrow"===g.style&&g.placement)if(c.getTotalLength&&0===c.getTotalLength())this._removeSVGMarkers(c);else{var e=-1!==g.placement.indexOf("begin"),
g=-1!==g.placement.indexOf("end");e||g?(c.removeAttribute("stroke-opacity"),c.setAttribute("opacity",f.a),e?this._applySVGMarker(c,f,"spear","start"):c.removeAttribute("marker-start"),g?this._applySVGMarker(c,f,"spear","end"):c.removeAttribute("marker-end")):this._removeSVGMarkers(c)}else c&&this._removeSVGMarkers(c)}},_lineMarkerInfo:{marker:{markerWidth:"6",markerHeight:"6",markerUnits:"strokeWidth",orient:"auto"},spear:{marker:{end:{viewBox:"0 0 25.4 23.43",refX:"20",refY:"12.76"},start:{viewBox:"-25.4 0 25.4 23.43",
refX:"-20",refY:"12.76"}},path:{common:{d:"M1.63 23.43 L5.37 16.6 L5.37 8.93 L1.63 2.09 L25.4 12.76 L1.63 23.43 Z","stroke-width":"0","fill-opacity":"1"},start:{transform:"matrix(-1, 0, 0, 1, 0, 0)"}}}},_applySVGMarker:function(a,b,c,f){var g=this._getSVGMarkerId(b,f);this._getSVGMarker(g)||this._createSVGMarker(b,g,c,f);a.setAttribute("marker-"+f,"url(#"+g+")")},_removeSVGMarkers:function(a){a.removeAttribute("marker-start");a.removeAttribute("marker-end");a.removeAttribute("opacity")},_getSVGMarkerId:function(a,
b){return"marker_"+this._map.id+"_"+a.r+"_"+a.g+"_"+a.b+"_"+b},_getSVGMarker:function(a){return this._lineMarkers[a]},_createSVGMarker:function(a,b,c,f){var g=this._lineMarkerInfo;c=g[c];var e=k.doc.createElementNS("http://www.w3.org/2000/svg","marker");e.setAttribute("id",b);this._setAttributes(e,g.marker);this._setAttributes(e,c.marker[f]);g=k.doc.createElementNS("http://www.w3.org/2000/svg","path");g.setAttribute("fill",a.toCss());this._setAttributes(g,c.path.common);this._setAttributes(g,c.path[f]);
e.appendChild(g);this._div.getParent().defNode.appendChild(e);return this._lineMarkers[b]=e},_setAttributes:function(a,b){for(var c in b)a.setAttribute(c,b[c])},_updateSVGMarkers:function(){if(F&&L){var a=this._lineMarkers,b;for(b in a){var c=a[b];c.setAttribute("id",b+"_temp");c.setAttribute("id",b)}}},_applyHalo:function(a,b,c){var f=b&&c?this._getHaloId(b,c):null;a.setFilter(b&&c?t("webkit")||t("ff")?this._getDilateFilter(b,c,f):this._getOffsetFilter(b,c,f):null)},_getDilateFilter:function(b,c,
f){var g=this._getSVGFilter(f);g||(g=this._createSVGFilter({id:f},[a.feMorphology({operator:"dilate",radius:c,result:"dilated"}),a.feFlood({"flood-color":b.toCss(!0)}),a.feComposite({in2:"dilated",operator:"in",result:"composite"}),a.feMerge("composite","SourceGraphic")]));return g},_getOffsetFilter:function(b,c,f){var g=this._getSVGFilter(f);if(!g){b=b.toCss(!0);var g=this._offsetPrimitives,e,n=g.length,h=[],d=[];for(e=0;e<n;e++){var t=g[e],u="offset"+t.dir,p="composite"+t.dir;d.push(p);h.push(a.feOffset({dx:t.dx*
c,dy:t.dy*c,"in":"SourceAlpha",result:u}),a.feFlood({"flood-color":b}),a.feComposite({in2:u,operator:"in",result:p}))}d.push("SourceGraphic");h.push(a.feMerge.apply(a.feMerge,d));g=this._createSVGFilter({id:f},h)}return g},_offsetPrimitives:[{dir:"L",dx:-1,dy:0},{dir:"TL",dx:-1,dy:-1},{dir:"T",dx:0,dy:-1},{dir:"TR",dx:1,dy:-1},{dir:"R",dx:1,dy:0},{dir:"BR",dx:1,dy:1},{dir:"B",dx:0,dy:1},{dir:"BL",dx:-1,dy:1}],_getHaloId:function(a,b){return"halo_"+this._map.id+"_"+this.id+"_"+a.r+"_"+a.g+"_"+a.b+
"_"+a.a+"_"+b},_getSVGFilter:function(a){return this._svgFilters[a]},_createSVGFilter:function(b,c){var f=a.createFilter(b,c),g=this._map,e=g.__visibleRect;f.x=-e.x;f.y=-e.y;f.width=g.width;f.height=g.height;return this._svgFilters[b.id]=f},_updateSVGFilters:function(a,b,c,f){var g=this._svgFilters,n,h,d;for(h in g)if(n=g[h]){if(d=e.byId(h))null!=a&&d.setAttribute("x",a),null!=b&&d.setAttribute("y",b),null!=c&&d.setAttribute("width",c),null!=f&&d.setAttribute("height",f);null!=a&&(n.x=a);null!=b&&
(n.y=b);null!=c&&(n.width=c);null!=f&&(n.height=f)}},_getScaleMatrix:function(a,b){var c=a.width/a.height,f=1,g=1;isNaN(b)||(1<c?(f=b/a.width,g=b/c/a.height):(g=b/a.height,f=b*c/a.width));return{xx:f,yy:g}},_symbolizePoint:function(a,b,c,f){var g=b.type,e=b.style;if("shieldlabelsymbol"!==g&&"picturemarkersymbol"!==g){var n=b.getStroke();b=b.getFill();var e=e===w.STYLE_X||e===w.STYLE_CROSS,h=n&&n.color,t=e?h:b;if(c){var u=this._getVariable(c,"colorInfo",!1),p=this._getVariable(c,"opacityInfo",!1);
u&&(t=c.getColor(f,{colorInfo:u})||t);t&&p&&(t=this._applyOpacity(t,c,p,f));t&&(e?t!==h&&(n=n?d.mixin({},n):{},n.color=t):t!==b&&(b=t))}"textsymbol"===g?a.setFill(b):"simplemarkersymbol"===g&&a.setFill(b).setStroke(n)}},_drawMarkers:function(a,b,c,f){var g=a.geometry,e=g.points,n=a.getDojoShape()||this._div.createGroup(),h,d,t=e.length,u=[],p=0,m,v=c?c.length:0;n.children[0]&&this._isInvalidShape(b,n.children[0])&&n.clear();for(d=0;d<t;d++)for(h=e[d],m=0;m<v;m++)u[0]=c[m],this._drawPoint(n,{x:h[0],
y:h[1],spatialReference:g.spatialReference},b,n.children[p++],u,f,a);b=n.children.length;if(t*c.length<b)for(d=b-1;d>=t*c.length;d--)n.children[d].removeShape();a._shape=n},_symbolizeMarkers:function(a,b,c){var f=a.getDojoShape().children,g,e=f.length;for(g=0;g<e;g++)this._symbolizePoint(f[g],b,c,a)},_errorHandler:function(a,b){a.message=b?"Unable to draw graphic (geometry:"+(b.geometry?b.geometry.declaredClass:null)+", symbol:"+(b.symbol?b.symbol.declaredClass:null)+"): "+a.message:"Unable to draw graphic (null): "+
a.message;this.inherited(arguments)},_rendererLimits:function(){var a,b,c;t("ff")?(a=16125,b=-32250,c=32250):J?(a=1E5,b=-1E5,c=1E5):t("chrome")&&6>t("chrome")&&(a=8150,b=-1E4,c=1E4);if(a)return{clipLimit:a,rangeMin:b,rangeMax:c,clipBBox:[-a,-a,a,a],clipSegments:[[[-a,-a],[a,-a]],[[a,-a],[a,a]],[[a,a],[-a,a]],[[-a,a],[-a,-a]]]}}(),_clipPolyline:function(a,b){var c=this._getCorners(a,b),f=c.br,g=this._rendererLimits,e=g.rangeMin,n=g.rangeMax,h=g.clipBBox,d=g.clipSegments,g=this._isPointWithinRange,
t=this._isPointWithinBBox,u=this._getClipperIntersection,p=this._getPlaneIndex;if(!g(c.tl,e,n)||!g(f,e,n)){J&&this._createSegments(a);var m=[];q.forEach(a.segments,function(a){a=a.args;var b=a.length,c=[],f;for(f=0;f<b;f+=2){var g=[a[f],a[f+1]],e=[a[f+2],a[f+3]],n=t(g,h),v=t(e,h);if(n^v){if(v=u([g,e],d))n?(f?c.push(v[1]):c.push(g,v[1]),m.push(c),c=[]):c.push(v[1],e)}else n?f?c.push(e):c.push(g,e):(v=p(g,h),n=p(e,h),-1!==v&&-1!==n&&v!==n&&(g=u([g,e],d,!0),0<g.length&&(g[v]||(v=g[v[0]]?v[0]:v[1]),g[n]||
(n=g[n[0]]?n[0]:n[1]),e=g[v],g=g[n],e&&c.push(e),g&&(c.push(g),m.push(c),c=[]))))}m.push(c)});a.setShape(this._getPathStringFromPaths(m))}},_clipPolygon:function(a,b){var c=this._getCorners(a,b),f=c.br,g=this._rendererLimits,e=g.clipLimit,n=g.rangeMin,h=g.rangeMax,t=g.clipBBox,u=g.clipSegments,g=this._isPointWithinRange,p=this._isPointWithinBBox,v=this._getClipperIntersection,m=this._getPlaneIndex,k=B._pointLineDistance;g(c.tl,n,h)&&g(f,n,h)||(J&&this._createSegments(a),c=q.filter(a.segments,function(a){return a.args&&
a.args.length}),c=q.map(c,function(a){var b=a.args,c=b.length,f=[];a=[];var g;for(g=0;g<c;g+=2){var n=[b[g],b[g+1]],h=[b[g+2],b[g+3]];if(g===c-2){f.push(n);break}var w=p(n,t),x=p(h,t);f.push(n);if(w^x){if(x=v([n,h],u))n=x[1],n[w?"inOut":"outIn"]=!0,f.push(n),a.push([w?"INOUT":"OUTIN",f.length-1,x[0]])}else if(!w){var w=m(n,t),l=m(h,t);-1!==w&&-1!==l&&w!==l&&(x=v([n,h],u,!0),0<x.length?(x[w]||(w=x[w[0]]?w[0]:w[1]),x[l]||(l=x[l[0]]?l[0]:l[1]),n=x[w],h=x[l],n&&(n.outIn=!0,f.push(n),a.push(["OUTIN",f.length-
1,w])),h&&(h.inOut=!0,f.push(h),a.push(["INOUT",f.length-1,l]))):d.isArray(w)&&d.isArray(l)&&(x=w.concat(l),x.sort(),"0123"===x.join("")&&(x=[],3===w[0]+w[1]?x.push([e,-e],[-e,e]):x.push([-e,-e],[e,e]),w=k(x[0],[n,h]),n=k(x[1],[n,h]),f.push(w<n?x[0]:x[1]))))}}var z=t[0],A=t[1],y=t[2],B=t[3];q.forEach(f,function(a){a[0]<z&&(a[1]>=A&&a[1]<=B?a[0]=z:(a[0]=z,a[1]=a[1]<A?A:B))});q.forEach(f,function(a){a[1]<A&&(a[0]>=z&&a[0]<=y?a[1]=A:(a[1]=A,a[0]=a[0]<z?z:y))});q.forEach(f,function(a){a[0]>y&&(a[1]>=
A&&a[1]<=B?a[0]=y:(a[0]=y,a[1]=a[1]<A?A:B))});q.forEach(f,function(a){a[1]>B&&(a[0]>=z&&a[0]<=y?a[1]=B:(a[1]=B,a[0]=a[0]<z?z:y))});b=0;c=a.length;if(0<c){do{h=a[b];g=a[(b+1)%c];if(h[2]===g[2]&&"INOUT"===h[0]&&"OUTIN"===g[0])if(n=h[1],g=g[1],n<g)for(n+=1;n<g;n++)f[n][2]=!0;else if(n>g){for(n+=1;n<f.length;n++)f[n][2]=!0;for(n=0;n<g;n++)f[n][2]=!0}b=(b+1)%c}while(0!==b)}c=f[0];b=f[f.length-1];c[2]&&(b[2]=!0,q.some(a,function(a){return 1===a[1]?(f.splice(f.length-1,0,d.clone(f[1])),!0):!1}));f=q.filter(f,
function(a){return a[2]?!1:!0});for(b=0;b<f.length-1;b++)c=f[b],(g=f[b+1])&&c[0]===g[0]&&c[1]===g[1]&&(g.outIn?c.outIn=!0:g.inOut&&(c.inOut=!0),f.splice(b+1,1));c=Math.abs;a=[];for(b=0;b<f.length-1;b++){h=f[b];n=h[0];h=h[1];w=c(n)===e;x=c(h)===e;g=f[b+1];l=g[0];g=g[1];var D=c(l)===e,E=c(g)===e;w&&E?a.push([b+1,[n,g]]):x&&D&&a.push([b+1,[l,h]])}for(b=a.length-1;0<=b;b--)g=a[b],n=f[g[0]-1],c=f[g[0]],n.outIn||n.inOut||c.outIn||c.inOut||f.splice(g[0],0,g[1]);c=f[0];b=f[f.length-1];c[0]===b[0]&&c[1]===
b[1]||f.push(c);return f}),a.setShape(this._getPathStringFromPaths(c)))},_getCorners:function(a,b){if(J){var c=this._map,f=b.getExtent(),g=f.spatialReference,e=c.toScreen(new z(f.xmin,f.ymax,g)),c=c.toScreen(new z(f.xmax,f.ymin,g));return{tl:e,br:c}}e=a.getTransformedBoundingBox();return{tl:e[0],br:e[2]}},_createSegments:function(a){a.shape.path=a.vmlPath;a.segmented=!1;a._confirmSegmented();var b=a.segments;1<b.length&&(a.segments=q.filter(b,function(a,b,c){b=c[b+1];return"M"===a.action&&b&&"L"===
b.action?(a.args=a.args.concat(b.args),!0):!1}))},_getPathStringFromPaths:function(a){J?(a=q.map(a,function(a){return"m "+q.map(a,function(a,b){return(1===b?"l ":"")+a.join(",")}).join(" ")}),a.push("e")):a=q.map(a,function(a){return"M "+q.map(a,function(a){return a.join(",")}).join(" ")});return a.join(" ")},_isPointWithinBBox:function(a,b){var c=b[1],f=b[2],g=b[3],e=a[0],n=a[1];return e>b[0]&&e<f&&n>c&&n<g?!0:!1},_isPointWithinRange:function(a,b,c){var f=a.x;a=a.y;return f<b||a<b||f>c||a>c?!1:!0},
_getClipperIntersection:function(a,b,c){var f,g=B._getLineIntersection2,e=Math.round,n={length:0};for(f=0;4>f;f++){var h=g(a,b[f]);if(h)if(h[0]=e(h[0]),h[1]=e(h[1]),c)n[f]=h,n.length++;else return[f,h]}return c?n:null},_getPlaneIndex:function(a,b){var c=a[0],f=a[1],g=b[0],e=b[1],n=b[2],h=b[3];return c<=g?f>=e&&f<=h?3:f<e?[0,3]:[2,3]:f<=e?c>=g&&c<=n?0:c<g?[3,0]:[1,0]:c>=n?f>=e&&f<=h?1:f<e?[0,1]:[2,1]:f>=h?c>=g&&c<=n?2:c<g?[3,2]:[1,2]:-1},onGraphicAdd:function(){},onGraphicRemove:function(){},onGraphicNodeAdd:function(){},
onGraphicNodeRemove:function(){},onGraphicDraw:function(){},onGraphicsClear:function(){},onRendererChange:function(){},onOpacityChange:function(){},setInfoTemplate:function(a){this.infoTemplate=a},add:function(a,b){if(a._graphicsLayer===this)return a;b||this.graphics.push(a);a._graphicsLayer=this;a._sourceLayer||(a._layer&&"esri.layers.GraphicsLayer"!==a._layer.declaredClass?a._sourceLayer=a._layer:"esri.layers.GraphicsLayer"!==this.declaredClass&&(a._sourceLayer=this));a._layer=this;this._updateExtent(a);
this._draw(a);if(!b)this.onGraphicAdd(a);return a},remove:function(a,b,c){if(!b&&!c){b=this.graphics;if(-1===(a=q.indexOf(b,a)))return null;a=b.splice(a,1)[0]}a.getDojoShape()&&this._removeShape(a,null,c);a._shape=a._graphicsLayer=null;this.onGraphicRemove(a);return a},clear:function(a,b){var c=this.graphics,f,g=!J;for(f=c.length-1;0<=f;f--)this.remove(c[f],null,g);this.graphics=[];this._destroyAllNodes();if(!b)this.onGraphicsClear()},_destroyAllNodes:function(){if(!J&&this._div){var a;this._childLayer&&
(a=this._childLayer.getNode())&&a.parentNode&&a.parentNode.removeChild(a);this._bgGroup.clear();this._div.clear();this._bgGroup=this._div.createGroup();a&&this._div.getEventSource().appendChild(a);this._initOpacity()}},clearNodes:function(){var a=this.graphics,b=a.length,c;for(c=0;c<b;c++)this._removeShape(a[c],!0,!0);this._destroyAllNodes()},_setIEOpacity:function(a,b){var c=a&&a.getNode();if(c){var f=a.strokeStyle,g=c.stroke;f&&g&&(g.opacity=f.color.a*b);f=a.fillStyle;g=c.fill;f&&g&&("tile"===g.type?
h.set(c,"opacity",b):g.opacity=f.a*b)}},setOpacity:function(a,b){if(b||this.opacity!=a){var c=this._div;c&&(J?(q.forEach(this.graphics,function(b){this._setIEOpacity(b._shape,a);this._setIEOpacity(b._bgShape,a)},this),c._esriIeOpacity=a,this._bgGroup._esriIeOpacity=a):this._canvas?h.set(c.getEventSource(),"opacity",a):c.getEventSource().setAttribute("opacity",a));this.opacity=a;if(!b)this.onOpacityChange(a)}},setRenderer:function(a){this.renderer=a;this._evalSDRenderer(!0);this.emit("renderer-change",
{renderer:this._rndForScale||a})}});r=r([D,E],{declaredClass:"esri.layers.GraphicsLayer",constructor:function(){this.enableMouseEvents=d.hitch(this,this.enableMouseEvents);this.disableMouseEvents=d.hitch(this,this.disableMouseEvents);this._processEvent=d.hitch(this,this._processEvent);this._initLayer()},_initLayer:function(){this.loaded=!0;this.onLoad(this)},_setMap:function(){var a=this.inherited("_setMap",arguments);this.enableMouseEvents();return a},_unsetMap:function(){this.disableMouseEvents();
this.inherited("_unsetMap",arguments)},_processEvent:function(a){var b=this._map,c=a.target,f;a.screenPoint=new A(a.pageX-b.position.x,a.pageY-b.position.y);for(a.mapPoint=b.toMap(a.screenPoint);c&&!(f=c.e_graphic);)c=c.parentNode;if(f)return a.graphic=f,a},_onMouseOverHandler:function(a){if(this._processEvent(a))this.onMouseOver(a)},_onMouseMoveHandler:function(a){if(this._processEvent(a))this.onMouseMove(a)},_onMouseDragHandler:function(a){if(this._processEvent(a))this.onMouseDrag(a)},_onMouseOutHandler:function(a){if(this._processEvent(a))this.onMouseOut(a)},
_onMouseDownHandler:function(a){this._downGr=this._downPt=null;this._processEvent(a)&&(l.disconnect(this._onmousemove_connect),l.disconnect(this._onmousedrag_connect),this._onmousedrag_connect=l.connect(this._div.getEventSource(),"onmousemove",this,"_onMouseDragHandler"),this._downGr=a.graphic,this._downPt=a.screenPoint.x+","+a.screenPoint.y,this.onMouseDown(a))},_onMouseUpHandler:function(a){this._upGr=this._upPt=null;this._processEvent(a)&&(l.disconnect(this._onmousedrag_connect),l.disconnect(this._onmousemove_connect),
this._onmousemove_connect=l.connect(this._div.getEventSource(),"onmousemove",this,"_onMouseMoveHandler"),this._upGr=a.graphic,this._upPt=a.screenPoint.x+","+a.screenPoint.y,this.onMouseUp(a))},_onClickHandler:function(a){if(this._processEvent(a)){var b=this._downGr,c=this._upGr;b&&c&&b===c&&this._downPt===this._upPt&&(J&&(u._ieGraphic=a.graphic),this.onClick(a))}},_onDblClickHandler:function(a){if(this._processEvent(a))this.onDblClick(a)},onMouseOver:function(){},onMouseMove:function(){},onMouseDrag:function(){},
onMouseOut:function(){},onMouseDown:function(){},onMouseUp:function(){},onClick:function(){},onDblClick:function(){},enableMouseEvents:function(){if(!this._mouseEvents){var a=l.connect,b=this._div.getEventSource();G||(this._onmouseover_connect=a(b,"onmouseover",this,"_onMouseOverHandler"),this._onmousemove_connect=a(b,"onmousemove",this,"_onMouseMoveHandler"),this._onmouseout_connect=a(b,"onmouseout",this,"_onMouseOutHandler"),this._onmousedown_connect=a(b,"onmousedown",this,"_onMouseDownHandler"),
this._onmouseup_connect=a(b,"onmouseup",this,"_onMouseUpHandler"),this._onclick_connect=a(b,"onclick",this,"_onClickHandler"),this._ondblclick_connect=a(b,"ondblclick",this,"_onDblClickHandler"));this._mouseEvents=!0}},disableMouseEvents:function(){if(this._mouseEvents){var a=l.disconnect;a(this._onmouseover_connect);a(this._onmousemove_connect);a(this._onmousedrag_connect);a(this._onmouseout_connect);a(this._onmousedown_connect);a(this._onmouseup_connect);a(this._onclick_connect);a(this._ondblclick_connect);
this._mouseEvents=!1}}});r._GraphicsContainer=x;r._GraphicsLayer=D;return r})},"dojox/gfx":function(){define(["dojo/_base/lang","./gfx/_base","./gfx/renderer!"],function(r,l,d){l.switchTo(d);return l})},"dojox/gfx/renderer":function(){define(["./_base","dojo/_base/lang","dojo/_base/sniff","dojo/_base/window","dojo/_base/config"],function(r,l,d,q,k){var m=null;d.add("vml",function(d,h,e){e.innerHTML='\x3cv:shape adj\x3d"1"/\x3e';d="adj"in e.firstChild;e.innerHTML="";return d});return{load:function(p,
h,e){function c(){h(["dojox/gfx/"+b],function(a){r.renderer=b;m=a;e(a)})}if(m&&"force"!=p)e(m);else{var b=k.forceGfxRenderer;p=!b&&(l.isString(k.gfxRenderer)?k.gfxRenderer:"svg,vml,canvas,silverlight").split(",");for(var a,g;!b&&p.length;)switch(p.shift()){case "svg":"SVGAngle"in q.global&&(b="svg");break;case "vml":d("vml")&&(b="vml");break;case "silverlight":try{d("ie")?(a=new ActiveXObject("AgControl.AgControl"),a.IsVersionSupported("1.0"))&&(g=!0):navigator.plugins["Silverlight Plug-In"]&&(g=
!0)}catch(u){g=!1}finally{a=null}g&&(b="silverlight");break;case "canvas":q.global.CanvasRenderingContext2D&&(b="canvas")}"canvas"===b&&!1!==k.canvasEvents&&(b="canvasWithEvents");k.isDebug&&console.log("gfx renderer \x3d "+b);"svg"==b&&"undefined"!=typeof window.svgweb?window.svgweb.addOnLoad(c):c()}}}})},"esri/layers/gfxSniff":function(){define(["dojo/has","dojox/gfx"],function(r,l){r.add("esri-svg",function(){return-1!==l.renderer.toLowerCase().indexOf("svg")});return r})},"esri/layers/layer":function(){define("dojo/_base/declare dojo/_base/config dojo/_base/connect dojo/_base/lang dojo/_base/Deferred dojo/_base/json dojo/has ../Evented ../kernel ../lang ../request ../deferredUtils ../urlUtils ../SpatialReference ../geometry/Extent".split(" "),
function(r,l,d,q,k,m,p,h,e,c,b,a,g,u,n){var t=r([h],{declaredClass:"esri.layers.Layer",_eventMap:{error:["error"],load:["layer"],"opacity-change":["opacity"],"update-end":["error"],"visibility-change":["visible"]},constructor:function(a,b){this._attrs={};a&&q.isString(a)?this._url=g.urlToObject(this.url=a):(this.url=this._url=null,(b=b||a)&&(b.layerDefinition||b.query)&&(b=null));this.spatialReference=new u(4326);this.initialExtent=new n(-180,-90,180,90,new u(4326));this._map=this._div=null;this.normalization=
!0;b&&(b.id&&(this.id=b.id),!1===b.visible&&(this.visible=!1),c.isDefined(b.opacity)&&(this.opacity=b.opacity),c.isDefined(b.minScale)&&this.setMinScale(b.minScale),c.isDefined(b.maxScale)&&this.setMaxScale(b.maxScale),this.attributionDataUrl=b.attributionDataUrl||"",this.hasAttributionData=!!this.attributionDataUrl,c.isDefined(b.showAttribution)&&(this.showAttribution=b.showAttribution),this.className=b.className,this.refreshInterval=b.refreshInterval||0);this._errorHandler=q.hitch(this,this._errorHandler);
this.refresh=q.hitch(this,this.refresh);if(this.managedSuspension){var f=this._setMap;this._setMap=function(a){var b=f.apply(this,arguments);this.evaluateSuspension();if(this.suspended&&!a.loaded)var c=d.connect(a,"onLoad",this,function(){d.disconnect(c);c=null;this.evaluateSuspension()});return b}}this.registerConnectEvents()},id:null,visible:!0,opacity:1,loaded:!1,loadError:null,minScale:0,maxScale:0,visibleAtMapScale:!1,suspended:!0,attributionDataUrl:"",hasAttributionData:!1,showAttribution:!0,
refreshInterval:0,_errorHandler:function(a){this.loaded||(this.loadError=a);this.onError(a)},_setMap:function(a,b,c,g){this._map=a;this._lyrZEHandle=d.connect(a,"onZoomEnd",this,this._processMapScale);if(a.loaded)this.visibleAtMapScale=this._isMapAtVisibleScale();else var f=d.connect(a,"onLoad",this,function(){d.disconnect(f);f=null;this._processMapScale()})},_unsetMap:function(a,b){d.disconnect(this._lyrZEHandle);this._toggleRT();this._map=this._lyrZEHandle=null;this._resumedOnce=void 0;this.suspended=
!0},_cleanUp:function(){this._map=this._div=null},_fireUpdateStart:function(){this.updating||(this.updating=!0,this.attr("data-updating",""),this._toggleRT(),this.onUpdateStart(),this._map&&this._map._incr())},_fireUpdateEnd:function(a,b){this.updating&&(this.updating=!1,this.attr("data-updating"),this._toggleRT(!0),this.onUpdateEnd(a,b),this._map&&this._map._decr())},_getToken:function(){var a=this._url,b=this.credential;return a&&a.query&&a.query.token||b&&b.token||void 0},_findCredential:function(){this.credential=
e.id&&this._url&&e.id.findCredential(this._url.path)},_useSSL:function(){var a=this._url,b=/^http:/i;this.url&&(this.url=this.url.replace(b,"https:"));a&&a.path&&(a.path=a.path.replace(b,"https:"))},refresh:function(){},show:function(){this.setVisibility(!0)},hide:function(){this.setVisibility(!1)},setMinScale:function(a){this.setScaleRange(a)},setMaxScale:function(a){this.setScaleRange(null,a)},setScaleRange:function(a,b){var f=c.isDefined(a),g=c.isDefined(b);this.loaded||(this._hasMin=this._hasMin||
f,this._hasMax=this._hasMax||g);var e=this.minScale,n=this.maxScale;this.minScale=(f?a:this.minScale)||0;this.maxScale=(g?b:this.maxScale)||0;if(e!==this.minScale||n!==this.maxScale)this.onScaleRangeChange(),this._processMapScale()},suspend:function(){this._suspended=!0;this.evaluateSuspension()},resume:function(){this._suspended=!1;this.evaluateSuspension()},canResume:function(){return this.loaded&&this._map&&this._map.loaded&&this.visible&&this.visibleAtMapScale&&!this._suspended},evaluateSuspension:function(){this.canResume()?
this.suspended&&this._resume():this.suspended||this._suspend()},_suspend:function(){this.suspended=!0;this.attr("data-suspended","");this._toggleRT();this.onSuspend();if(this._map)this._map.onLayerSuspend(this)},_resume:function(){this.suspended=!1;this.attr("data-suspended");var a=void 0===this._resumedOnce,b=this.className,c=this._attrs,g=this.getNode(),e;if(a){this._resumedOnce=!0;if(b&&g){var n=g.getAttribute("class")||"";(new RegExp("(^|\\s)"+b+"(\\s|$)","i")).test(n)||g.setAttribute("class",
n+((n?" ":"")+b))}if(c&&g)for(e in c)c.hasOwnProperty(e)&&g.setAttribute(e,c[e])}this._toggleRT(!0);this.onResume({firstOccurrence:a});if(this._map)this._map.onLayerResume(this)},_processMapScale:function(){var a=this.visibleAtMapScale;this.visibleAtMapScale=this._isMapAtVisibleScale();a!==this.visibleAtMapScale&&(this.onScaleVisibilityChange(),this.evaluateSuspension())},isVisibleAtScale:function(a){return a?t.prototype._isMapAtVisibleScale.apply(this,arguments):!1},_isMapAtVisibleScale:function(a,
b){if(!(a||this._map&&this._map.loaded))return!1;var c=this._map;a=a||c.getScale();var f=this.minScale,g=this.maxScale,e=!f,n=!g,h;b&&(h=c.width>c.height?c.width:c.height);e||(a<=f?e=!0:b&&(e=Math.abs(f-a)/f<1/h));n||(a>=g?n=!0:b&&(n=Math.abs(g-a)/g<1/h));return e&&n},getAttributionData:function(){var c=this.attributionDataUrl,g=new k(a._dfdCanceller);this.hasAttributionData&&c?(g._pendingDfd=b({url:c,content:{f:"json"},handleAs:"json",callbackParamName:"callback"}),g._pendingDfd.then(function(a){g.callback(a)},
function(a){g.errback(a)})):(c=Error("Layer does not have attribution data"),c.log=!!l.isDebug,g.errback(c));return g},getResourceInfo:function(){var a=this.resourceInfo;return q.isString(a)?m.fromJson(a):q.clone(a)},getMap:function(){return this._map},getNode:function(){return this._div},attr:function(a,b){var c=this.getNode();if("data-reference"===a&&11>p("ie"))return this;c&&(null==b?c.removeAttribute(a):c.setAttribute(a,b));this._attrs&&(null==b?delete this._attrs[a]:this._attrs[a]=b);return this},
setRefreshInterval:function(a){var b=this.refreshInterval;this.refreshInterval=a;this._toggleRT();a&&(this.updating||this.suspended||this._toggleRT(!0));if(b!==a)this.onRefreshIntervalChange();return this},_toggleRT:function(a){a&&this.refreshInterval?(clearTimeout(this._refreshT),this._refreshT=setTimeout(this.refresh,6E4*this.refreshInterval)):this._refreshT&&(clearTimeout(this._refreshT),this._refreshT=null)},setNormalization:function(a){this.normalization=a},setVisibility:function(a){this.visible!==
a&&(this.visible=a,this.onVisibilityChange(this.visible),this.evaluateSuspension());this.attr("data-hidden",a?null:"")},onLoad:function(){},onVisibilityChange:function(){},onScaleRangeChange:function(){},onScaleVisibilityChange:function(){},onSuspend:function(){},onResume:function(){},onUpdate:function(){},onUpdateStart:function(){},onUpdateEnd:function(){},onRefreshIntervalChange:function(){},onError:function(){}});return t})},"esri/domUtils":function(){define(["./kernel","dojo/_base/connect","dojo/_base/lang",
"dojo/dom-style","dojo/has"],function(r,l,d,q,k){var m={show:function(d){if(d=m.getNode(d))d.style.display="block"},getNode:function(d){return d&&d.domNode||d},hide:function(d){if(d=m.getNode(d))d.style.display="none"},toggle:function(d){if(d=m.getNode(d))d.style.display="none"===d.style.display?"block":"none"},documentBox:8>=k("ie")?{w:document.documentElement.clientWidth,h:document.documentElement.clientHeight}:{w:window.innerWidth,h:window.innerHeight},setScrollable:function(d){if(d=this.getNode(d)){var h=
0,e=0,c=0,b=0,a=0,g=0;return[l.connect(d,"ontouchstart",function(u){h=u.touches[0].screenX;e=u.touches[0].screenY;c=d.scrollWidth;b=d.scrollHeight;a=d.clientWidth;g=d.clientHeight}),l.connect(d,"ontouchmove",function(u){u.preventDefault();var n=d.firstChild;n instanceof Text&&(n=d.childNodes[1]);var t=n._currentX||0,f=n._currentY||0,t=t+(u.touches[0].screenX-h);0<t?t=0:0>t&&Math.abs(t)+a>c&&(t=-1*(c-a));n._currentX=t;f+=u.touches[0].screenY-e;0<f?f=0:0>f&&Math.abs(f)+g>b&&(f=-1*(b-g));n._currentY=
f;q.set(n,{"-webkit-transition-property":"-webkit-transform","-webkit-transform":"translate("+t+"px, "+f+"px)"});h=u.touches[0].screenX;e=u.touches[0].screenY})]}}};return m})},"esri/symbols/MarkerSymbol":function(){define("dojo/_base/declare dojo/_base/lang dojo/has dojox/gfx/_base ../kernel ./Symbol".split(" "),function(r,l,d,q,k,m){return r(m,{declaredClass:"esri.symbol.MarkerSymbol",angle:0,xoffset:0,yoffset:0,size:12,constructor:function(d){d&&l.isObject(d)&&(this.size="auto"===this.size?this.size:
q.pt2px(this.size),this.xoffset=q.pt2px(this.xoffset),this.yoffset=q.pt2px(this.yoffset),this.angle&&(this.angle*=-1))},setAngle:function(d){this.angle=d;return this},setSize:function(d){this.size=d;return this},setOffset:function(d,h){this.xoffset=d;this.yoffset=h;return this},toJson:function(){var d=q.px2pt(this.size),d=isNaN(d)?void 0:d,h=q.px2pt(this.xoffset),h=isNaN(h)?void 0:h,e=q.px2pt(this.yoffset),e=isNaN(e)?void 0:e;return l.mixin(this.inherited("toJson",arguments),{size:"auto"===this.size?
this.size:d,angle:this.angle&&-1*this.angle,xoffset:h,yoffset:e})}})})},"esri/symbols/Symbol":function(){define("dojo/_base/declare dojo/_base/lang dojo/has ../kernel ../lang ../Color".split(" "),function(r,l,d,q,k,m){return r(null,{declaredClass:"esri.symbol.Symbol",color:new m([0,0,0,1]),type:null,constructor:function(d){d&&l.isObject(d)&&(l.mixin(this,d),this.color&&k.isDefined(this.color[0])&&(this.color=m.toDojoColor(this.color)),(d=this.type)&&0===d.indexOf("esri")&&(this.type={esriSMS:"simplemarkersymbol",
esriPMS:"picturemarkersymbol",esriSLS:"simplelinesymbol",esriCLS:"cartographiclinesymbol",esriSFS:"simplefillsymbol",esriPFS:"picturefillsymbol",esriTS:"textsymbol",esriSHD:"shieldlabelsymbol"}[d]))},setColor:function(d){this.color=d;return this},toJson:function(){return{color:m.toJsonColor(this.color)}}})})},"esri/symbols/SimpleMarkerSymbol":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/Color dojo/has dojox/gfx/_base ../kernel ../lang ./MarkerSymbol ./SimpleLineSymbol".split(" "),
function(r,l,d,q,k,m,p,h,e){var c={STYLE_CIRCLE:"circle",STYLE_SQUARE:"square",STYLE_CROSS:"cross",STYLE_X:"x",STYLE_DIAMOND:"diamond",STYLE_PATH:"path",STYLE_TARGET:"target"},b={style:c.STYLE_CIRCLE,color:[255,255,255,.25],size:12,angle:0,xoffset:0,yoffset:0};r=r(h,{declaredClass:"esri.symbol.SimpleMarkerSymbol",type:"simplemarkersymbol",_styles:{circle:"esriSMSCircle",square:"esriSMSSquare",cross:"esriSMSCross",x:"esriSMSX",diamond:"esriSMSDiamond",path:"esriSMSPath"},constructor:function(a,g,h,
n){a?l.isString(a)?(this.style=a,g&&(this.size=g),h&&(this.outline=h),n&&(this.color=n)):(this.style=p.valueOf(this._styles,this.style),a.outline&&(this.outline=new e(a.outline))):(l.mixin(this,b),this.size=k.pt2px(this.size),this.outline=new e(this.outline),this.color=new d(this.color));this.style||(this.style=c.STYLE_CIRCLE)},setStyle:function(a){this.style=a;return this},setPath:function(a){this.path=a;this.setStyle(c.STYLE_PATH);return this},setOutline:function(a){this.outline=a;return this},
getStroke:function(){return this.outline&&this.outline.getStroke()},getFill:function(){return this.color},_setDim:function(a,b,c){this._targetWidth=a;this._targetHeight=b;this._spikeSize=c},getShapeDescriptors:function(){var a,g,e,n=this.style,h=(this.size||k.pt2px(b.size))/2,f=0-h,d=0+h,m=0-h,p=0+h;switch(n){case c.STYLE_CIRCLE:a={type:"circle",cx:0,cy:0,r:h};g=this.getFill();if(e=this.getStroke())e.style=e.style||"Solid";break;case c.STYLE_CROSS:a={type:"path",path:"M "+f+",0 L "+d+",0 M 0,"+m+
" L 0,"+p+" E"};g=null;e=this.getStroke();break;case c.STYLE_DIAMOND:a={type:"path",path:"M "+f+",0 L 0,"+m+" L "+d+",0 L 0,"+p+" L "+f+",0 Z"};g=this.getFill();e=this.getStroke();break;case c.STYLE_SQUARE:a={type:"path",path:"M "+f+","+p+" L "+f+","+m+" L "+d+","+m+" L "+d+","+p+" L "+f+","+p+" Z"};g=this.getFill();e=this.getStroke();break;case c.STYLE_X:a={type:"path",path:"M "+f+","+p+" L "+d+","+m+" M "+f+","+m+" L "+d+","+p+" E"};g=null;e=this.getStroke();break;case c.STYLE_PATH:a={type:"path",
path:this.path||""},g=this.getFill(),e=this.getStroke()}return{defaultShape:a,fill:g,stroke:e}},toJson:function(){var a=this.style,b=this.outline,c=l.mixin(this.inherited("toJson",arguments),{type:"esriSMS",style:this._styles[a]||"esriSMSCircle"});b&&(c.outline=b.toJson());"x"===a||"cross"===a?delete c.color:"target"===a&&(c.style="esriSMSSquare",delete c.color,0<this._targetHeight&&0<this._targetWidth&&(c.size=k.px2pt(Math.max(this._targetHeight,this._targetWidth))));c.path=this.path;return p.fixJson(c)}});
l.mixin(r,c);r.defaultProps=b;return r})},"esri/symbols/SimpleLineSymbol":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/Color dojo/has dojox/gfx/_base ../kernel ../lang ./LineSymbol".split(" "),function(r,l,d,q,k,m,p,h){var e={STYLE_SOLID:"solid",STYLE_DASH:"dash",STYLE_DOT:"dot",STYLE_DASHDOT:"dashdot",STYLE_DASHDOTDOT:"longdashdotdot",STYLE_NULL:"none",STYLE_SHORTDASH:"shortdash",STYLE_SHORTDOT:"shortdot",STYLE_SHORTDASHDOT:"shortdashdot",STYLE_SHORTDASHDOTDOT:"shortdashdotdot",
STYLE_LONGDASH:"longdash",STYLE_LONGDASHDOT:"longdashdot"},c={color:[0,0,0,1],style:e.STYLE_SOLID,width:1};r=r(h,{declaredClass:"esri.symbol.SimpleLineSymbol",type:"simplelinesymbol",marker:null,_styles:{solid:"esriSLSSolid",dash:"esriSLSDash",dot:"esriSLSDot",dashdot:"esriSLSDashDot",longdashdotdot:"esriSLSDashDotDot",none:"esriSLSNull",insideframe:"esriSLSInsideFrame",shortdash:"esriSLSShortDash",shortdot:"esriSLSShortDot",shortdashdot:"esriSLSShortDashDot",shortdashdotdot:"esriSLSShortDashDotDot",
longdash:"esriSLSLongDash",longdashdot:"esriSLSLongDashDot"},constructor:function(b,a,g){b?l.isString(b)?(this.style=b,a&&(this.color=a),g&&(this.width=g)):(this.style=p.valueOf(this._styles,b.style)||e.STYLE_SOLID,this.marker=b.marker):(l.mixin(this,c),this.color=new d(this.color),this.width=k.pt2px(this.width))},setStyle:function(b){this.style=b;return this},setMarker:function(b){this.marker=b},getStroke:function(){return this.style===e.STYLE_NULL||0===this.width?null:{color:this.color,style:this.style,
width:this.width}},getFill:function(){return null},getShapeDescriptors:function(){return{defaultShape:{type:"path",path:"M -15,0 L 15,0 E"},fill:null,stroke:this.getStroke()}},toJson:function(){return p.fixJson(l.mixin(this.inherited("toJson",arguments),{type:"esriSLS",style:this._styles[this.style],marker:this.marker&&l.clone(this.marker)}))}});l.mixin(r,e);r.defaultProps=c;return r})},"esri/symbols/LineSymbol":function(){define("dojo/_base/declare dojo/_base/lang dojo/has dojox/gfx/_base ../kernel ./Symbol".split(" "),
function(r,l,d,q,k,m){return r(m,{declaredClass:"esri.symbol.LineSymbol",constructor:function(d){l.isObject(d)?this.width=q.pt2px(this.width):this.width=12},setWidth:function(d){this.width=d;return this},toJson:function(){var d=q.px2pt(this.width),d=isNaN(d)?void 0:d;return l.mixin(this.inherited("toJson",arguments),{width:d})}})})},"esri/layers/TileInfo":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/has ../kernel ../lang ../SpatialReference ../geometry/Point ./LOD".split(" "),
function(r,l,d,q,k,m,p,h,e){return r(null,{declaredClass:"esri.layers.TileInfo",constructor:function(c){l.mixin(this,c);this.width=this.cols;this.height=this.rows;c=this.spatialReference;var b=this.origin;c&&(c=this.spatialReference=new p(c.toJson?c.toJson():c));b&&(this.origin=new h(b.toJson?b.toJson():b),!b.spatialReference&&c&&this.origin.setSpatialReference(new p(c.toJson())));this.lods=d.map(this.lods,function(a){return new e(a)})},toJson:function(){return m.fixJson({rows:this.rows,cols:this.cols,
dpi:this.dpi,format:this.format,compressionQuality:this.compressionQuality,origin:this.origin&&this.origin.toJson(),spatialReference:this.spatialReference&&this.spatialReference.toJson(),lods:this.lods&&d.map(this.lods,function(c){return c.toJson()})})}})})},"esri/layers/LOD":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/has","../kernel","../lang"],function(r,l,d,q,k){return r(null,{declaredClass:"esri.layers.LOD",constructor:function(d){l.mixin(this,d)},toJson:function(){return k.fixJson({level:this.level,
levelValue:this.levelValue,resolution:this.resolution,scale:this.scale})}})})},"esri/layers/ArcGISTiledMapServiceLayer":function(){define("dojo/_base/kernel dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/json dojo/has dojo/io-query ../kernel ../urlUtils ../SpatialReference ./TiledMapServiceLayer ./ArcGISMapServiceLayer ./TileInfo ./TimeInfo ./TileMap".split(" "),function(r,l,d,q,k,m,p,h,e,c,b,a,g,u,n){return l([b,a],{declaredClass:"esri.layers.ArcGISTiledMapServiceLayer",_agolAttrs:"Canvas/World_Dark_Gray_Base Canvas/World_Dark_Gray_Reference Canvas/World_Light_Gray_Base Canvas/World_Light_Gray_Reference Elevation/World_Hillshade Ocean/World_Ocean_Base Ocean/World_Ocean_Reference Ocean_Basemap Reference/World_Boundaries_and_Places Reference/World_Boundaries_and_Places_Alternate Reference/World_Transportation World_Imagery World_Street_Map World_Topo_Map".split(" "),
_isReference:!1,_referenceLayers:"Canvas/World_Dark_Gray_Reference Canvas/World_Light_Gray_Reference Ocean/World_Ocean_Reference Reference/World_Boundaries_and_Places Reference/World_Boundaries_and_Places_Alternate Reference/World_Reference_Overlay Reference/World_Transportation".split(" "),constructor:function(a,b){b&&(b.roundrobin&&(r.deprecated(this.declaredClass+" : Constructor option 'roundrobin' deprecated. Use option 'tileServers'."),b.tileServers=b.roundrobin),this._setTileServers(b.tileServers),
this._loadCallback=b.loadCallback);this._params=d.mixin({},this._url.query);this._initLayer=d.hitch(this,this._initLayer);var c=b&&b.resourceInfo;c?this._initLayer(c):(this._load=d.hitch(this,this._load),this._load())},_TILE_FORMATS:{PNG:"png",PNG8:"png",PNG24:"png",PNG32:"png",JPG:"jpg",JPEG:"jpg",GIF:"gif"},_setTileServers:function(a){if(a&&0<a.length){this.tileServers=a;var b,c=a.length;for(b=0;b<c;b++)a[b]=e.urlToObject(a[b]).path}},_initLayer:function(a,b){this.inherited(arguments);this.resourceInfo=
k.toJson(a);this.tileInfo=new g(a.tileInfo);!1!==this.resampling&&(a.capabilities&&-1<a.capabilities.indexOf("Tilemap")?(this.resampling=!0,this.tileMap=new n(this)):this.resampling=!!a.resampling);!this.spatialReference&&this.tileInfo.spatialReference&&(this.spatialReference=new c(this.tileInfo.spatialReference.toJson()));this.isPNG32="PNG24"===this.tileInfo.format||"PNG32"===this.tileInfo.format;a.timeInfo&&(this.timeInfo=new u(a.timeInfo));a.mensurationCapabilities&&(this.mensurationCapabilities=
a.mensurationCapabilities);var f=this._url.path,h=this._loadCallback,d=e.getProtocolForWebResource(!0),t=f.match(/^https?\:\/\/(server|services)\.arcgisonline\.com\/arcgis\/rest\/services\/([^\/]+(\/[^\/]+)*)\/mapserver/i),t=t&&t[2];if(!this.tileServers)if(a.tileServers)this._setTileServers(a.tileServers);else{var m=-1!==f.search(/^https?\:\/\/server\.arcgisonline\.com/i),p=-1!==f.search(/^https?\:\/\/services\.arcgisonline\.com/i);(m||p)&&this._setTileServers([f,f.replace(m?/server\.arcgisonline/i:
/services\.arcgisonline/i,m?"services.arcgisonline":"server.arcgisonline")])}if(t){t=t.toLowerCase();for(f=0;f<this._agolAttrs.length;f++)if(m=this._agolAttrs[f],m.toLowerCase()===t){this.hasAttributionData=!0;this.attributionDataUrl=this.attributionDataUrl||d+"//static.arcgis.com/attribution/"+m;break}for(f=0;f<this._referenceLayers.length;f++)if(m=this._referenceLayers[f],m.toLowerCase()===t){this._isReference=!0;break}}this.loaded=!0;this.onLoad(this);h&&(delete this._loadCallback,h(this))},getTileUrl:function(a,
b,c){var f=this.tileServers,g=this._getToken(),n=this._url.query;a=(f?f[b%f.length]:this._url.path)+"/tile/"+a+"/"+b+"/"+c;a=e.upgradeToHTTPS(a);this.resampling&&!this.tileMap&&(a+="?blankTile\x3dfalse");n&&(a=this.resampling&&!this.tileMap?a+("\x26"+p.objectToQuery(n)):a+("?"+p.objectToQuery(n)));!g||n&&n.token||(a+=(-1===a.indexOf("?")?"?":"\x26")+"token\x3d"+g);a=this.addTimestampToURL(a);return e.addProxy(a)}})})},"esri/layers/TiledMapServiceLayer":function(){define("dojo/_base/declare dojo/_base/connect dojo/_base/lang dojo/_base/array dojo/_base/url dojo/dom-construct dojo/dom-class dojo/dom-geometry dojo/dom-style dojo/dom dojox/collections/ArrayList dojox/gfx/matrix ../kernel ../config ../sniff ../domUtils ../tileUtils ../geometry/Point ../geometry/Rect ../geometry/Extent ./layer".split(" "),
function(r,l,d,q,k,m,p,h,e,c,b,a,g,u,n,t,f,v,x,w,z){return r(z,{declaredClass:"esri.layers.TiledMapServiceLayer",constructor:function(a,b){l.connect(this,"onLoad",this,"_initTiledLayer");this._lowestLevel=(this._displayLevels=b?b.displayLevels:null)?this._displayLevels[0]:0;this.resampling=b?b.resampling:void 0;this._resamplingTolerance=b?b.resamplingTolerance:null;this.exclusionAreas=b?b.exclusionAreas:null;var c=d.hitch;this._addImage=c(this,this._addImage);this._tileLoadHandler=c(this,this._tileLoadHandler);
this._tileErrorHandler=c(this,this._tileErrorHandler);this._popTile=c(this,this._popTile);this._cleanUpRemovedImages=c(this,this._cleanUpRemovedImages);this._fireOnUpdateEvent=c(this,this._fireOnUpdateEvent);this._transitionEnd=c(this,this._transitionEnd);this._tileMapCallback=c(this,this._tileMapCallback)},opacity:1,isPNG32:!1,_multiple:1,isResampling:!1,_initTiledLayer:function(){var a=this.tileInfo,b=a.lods;this.resampling=null!=this.resampling?this.resampling:!1;this._tileW=a.width;this._tileH=
a.height;var c=this.scales=[],g=this._displayLevels,e=-Infinity,h=Infinity,d=this.fullExtent,t=new v(d.xmin,d.ymax),d=new v(d.xmax,d.ymin),u=f.getContainingTileCoords,m,p,k,w=b.length;for(k=0;k<w;k++)p=b[k],m=u(a,t,p),p.startTileRow=0>m.row?0:m.row,p.startTileCol=0>m.col?0:m.col,m=u(a,d,p),p.endTileRow=m.row,p.endTileCol=m.col,g&&-1===q.indexOf(g,p.level)||(c[k]=p.scale,e=p.scale>e?p.scale:e,h=p.scale<h?p.scale:h);-Infinity===e||this._hasMin||this.setMinScale(e);Infinity===h||this._hasMax||this.setMaxScale(h);
this.setExclusionAreas(this.exclusionAreas);this._patchIE=6<=n("ie")&&7>n("ie")&&(this.isPNG32||"Mixed"===a.format)},isVisibleAtScale:function(a){return a?z.prototype._isMapAtVisibleScale.call(this,a,!0):!1},_isMapAtVisibleScale:function(a){var b=this.inherited(arguments,[a,!0]);if(b){var c;c=this._map;var b=this.scales,f=c.getScale(),g=!1,e=c.width>c.height?c.width:c.height;for(c=0;c<b.length;c++)if(Math.abs(b[c]-f)/b[c]<1/e){g=!0;break}b=g}return b},_setMap:function(a,b,c,n){this.inherited(arguments);
this._map=a;var h=this._div=m.create("div",null,b),d=a.__visibleDelta,t=l.connect,p=g._css.names,k={position:"absolute",width:a.width+"px",height:a.height+"px",overflow:"visible"},v=u.defaults.map.zoomDuration;"css-transforms"===a.navigationMode?(k[p.transform]=g._css.translate(-d.x,-d.y),e.set(h,k),delete k[p.transform],k[p.transition]=p.transformName+" "+v+"ms ease",e.set(this._active=m.create("div",null,h),k),this._active._remove=0,this._passives=[]):(k.left=-d.x+"px",k.top=-d.y+"px",e.set(h,k));
this._onResizeHandler_connect=t(a,"onResize",this,"_onResizeHandler");this._opacityChangeHandler_connect=t(this,"onOpacityChange",this,"_opacityChangeHandler");d=this.tileInfo;t=d.spatialReference;p=t._getInfo();(this._wrap=a.wrapAround180&&t._isWrappable()&&Math.abs(p.origin[0]-d.origin.x)<=p.dx)&&f._addFrameInfo(d,p);this.setExclusionAreas(this.exclusionAreas);this.evaluateSuspension();if(this.suspended&&!a.loaded)var w=l.connect(a,"onLoad",this,function(){l.disconnect(w);w=null;this.setExclusionAreas(this.exclusionAreas);
this.evaluateSuspension()});return h},_unsetMap:function(a,b){this.suspended||this._suspendImpl();m.destroy(this._div);this._map=this._div=null;var c=l.disconnect;c(this._onResizeHandler_connect);c(this._opacityChangeHandler_connect);this.inherited(arguments)},onSuspend:function(){this.inherited(arguments);this._suspendImpl()},_suspendImpl:function(){t.hide(this._div);clearTimeout(this._wakeTimer);this._wakeTimer=null;this._disableDrawConnectors();var a=this._tiles,b=this._tileIds,c=this._loadingList,
f,g,e=l.disconnect,n=m.destroy;c&&0<c.count&&(c.forEach(function(b){if(f=a[b])e(f._onload_connect),e(f._onerror_connect),e(f._onabort_connect),f._onload_connect=f._onerror_connect=f._onabort_connect=null}),c.clear(),this._fireUpdateEnd());this._removeList.clear();for(c=b.length-1;0<=c;c--)(f=(g=b[c])&&a[g])&&n(f);if("css-transforms"===this._map.navigationMode){b=this._active;g=this._passives;var h;this._noDom=0;for(c=g.length-1;0<=c;c--)h=g[c],h._endHandle&&e(h._endHandle),h._matrix=h._multiply=h._endHandle=
null,h._marked=h._remove=0,g.splice(c,1),n(h);b._matrix=b._multiply=null;b._marked=b._remove=0}this._tileIds=this._tiles=this._tileBounds=this._ct=this._loadingList=this._removeList=this._standby=null},onResume:function(){this.inherited(arguments);this._tileIds=[];this._tiles=[];this._tileBounds=[];this._ct=null;this._removeList=new b;this._loadingList=new b;t.show(this._div);this._enableDrawConnectors();this._wakeTimer=this._wakeTimer||setTimeout(d.hitch(this,function(){this.suspended||this._onExtentChangeHandler(this._map.extent,
null,!0,this._map.__LOD)}),0)},_enableDrawConnectors:function(){var a=this._map,b=l.connect;if("css-transforms"===a.navigationMode){if(this._onScaleHandler_connect=b(a,"onScale",this,this._onScaleHandler),n("esri-mobile")){this._standby=[];var c=this,f=function(){c._noDom=1};this._onPanStartHandler_connect=b(a,"onPanStart",f);this._onZoomStartHandler_connect=b(a,"onZoomStart",f)}}else this._onZoomHandler_connect=b(a,"onZoom",this,"_onZoomHandler");this._onPanHandler_connect=b(a,"onPan",this,"_onPanHandler");
this._onExtentChangeHandler_connect=b(a,"onExtentChange",this,"_onExtentChangeHandler")},_disableDrawConnectors:function(){var a=l.disconnect;a(this._onPanHandler_connect);a(this._onZoomHandler_connect);a(this._onScaleHandler_connect);a(this._onExtentChangeHandler_connect);a(this._onPanStartHandler_connect);a(this._onZoomStartHandler_connect);this._onPanHandler_connect=this._onZoomHandler_connect=this._onScaleHandler_connect=this._onExtentChangeHandler_connect=this._onPanStartHandler_connect=this._onZoomStartHandler_connect=
null},_onResizeHandler:function(a,b,c){a={width:b+"px",height:c+"px"};b=e.set;b(this._div,a);if("css-transforms"===this._map.navigationMode)for(this._active&&b(this._active,a),c=this._passives.length-1;0<=c;c--)b(this._passives[c],a)},_onExtentChangeHandler:function(b,c,n,d){c=this._map;var t=this._standby,u;clearTimeout(this._wakeTimer);this._wakeTimer=null;if(!c._isPanningOrZooming()){if("css-transforms"===c.navigationMode){if(n)for(d=this._passives.length-1;0<=d;d--)u=this._passives[d],e.set(u,
g._css.names.transition,"none"),u._marked?(this._passives.splice(d,1),u.parentNode&&u.parentNode.removeChild(u),m.destroy(u)):0<u.childNodes.length&&(u._multiply=u._multiply?a.multiply(u._matrix,u._multiply):u._matrix);this._noDom=0;if(t&&t.length)for(d=t.length-1;0<=d;d--)u=t[d],e.set(u,"visibility","inherit"),this._popTile(u),t.splice(d,1)}this._fireUpdateStart();this._rrIndex=0;d=f.getCandidateTileInfo(c,this.tileInfo,b);b=c.__visibleDelta;if(!this._ct||d.lod.level!==this._ct.lod.level||n){u=d&&
this._ct&&d.lod.level!==this._ct.lod.level;this._ct=d;var p=this._tiles,k=this._tileIds,v=this._tileBounds,w=this._removeList,l,q=k.length;this._cleanUpRemovedImages();for(d=0;d<q;d++)t=k[d],l=p[t],v[t]=k[d]=null,"css-transforms"===c.navigationMode&&u&&l.parentNode&&c.fadeOnZoom&&(l._fadeOut=u,l.parentNode._remove++),w.add(l);n&&(this._tileIds=[],this._tiles=[],this._tileBounds=[])}d=b.x;n=b.y;"css-transforms"===c.navigationMode?(t={},t[g._css.names.transform]=g._css.translate(d,n),e.set(this._div,
t)):e.set(this._div,{left:d+"px",top:n+"px"});this.__coords_dx=d;this.__coords_dy=n;this._updateImages(new x(0,0,b.width,b.height));0===this._loadingList.count?(this._cleanUpRemovedImages(),this.onUpdate(),this._fireUpdateEnd()):this._fireOnUpdate=!0;n=this._tileW;p=this._tileH;b=new x(-b.x,-b.y,b.width,b.height);for(d=this._tileIds.length-1;0<=d;d--)(t=this._tileIds[d])?(u=this._tiles[t],k=h.getMarginBox(u),k=new x(k.l,k.t,n,p),"css-transforms"===c.navigationMode&&(k.x=u._left,k.y=u._top),b.intersects(k)?
this._tileBounds[t]=k:(this._loadingList.contains(t)&&this._popTile(u),m.destroy(u),this._tileIds.splice(d,1),delete this._tileBounds[t],delete this._tiles[t])):(this._tileIds.splice(d,1),delete this._tileBounds[t],delete this._tiles[t])}},_onPanHandler:function(a,b){var c=this._map,f=c.__visibleDelta.offset(b.x,b.y);this.__coords_dx=this.__coords_dy=0;"css-transforms"===c.navigationMode?(c={},c[g._css.names.transform]=g._css.translate(f.x,f.y),e.set(this._div,c),n("esri-mobile")||this._updateImages({x:-f.x,
y:-f.y,width:f.width,height:f.height})):(e.set(this._div,{left:f.x+"px",top:f.y+"px"}),this._updateImages({x:-f.x,y:-f.y,width:f.width,height:f.height}));0<this._loadingList.count&&(this._fireUpdateStart(),this._fireOnUpdate=!0)},_onScaleHandler:function(b,c){var f,n={},h=g._css.names,d=this._map,t=u.defaults.map.zoomDuration;for(f=this._passives.length-1;0<=f;f--){var p=this._passives[f];0===p.childNodes.length?(this._passives.splice(f,1),m.destroy(p)):("none"===p.style[h.transition]&&e.set(p,h.transition,
h.transformName+" "+t+"ms ease"),e.set(p,h.transition,c?"none":h.transformName+" "+t+"ms ease"),p._matrix=b,n[h.transform]=g._css.matrix(p._multiply?a.multiply(b,p._multiply):b),e.set(p,n))}this._active&&0===this._active.childNodes.length||(e.set(this._active,h.transition,c?"none":h.transformName+" "+t+"ms ease"),this._active._matrix=b,n[h.transform]=g._css.matrix(this._active._matrix),e.set(this._active,n),this._passives.push(this._active),n={position:"absolute",width:d.width+"px",height:d.height+
"px",overflow:"visible"},n[h.transition]=h.transformName+" "+t+"ms ease",e.set(this._active=m.create("div",null,this._div),n),this._active._remove=0,d.fadeOnZoom&&m.place(this._active,this._div,"first"))},_onZoomHandler:function(a,b,c){a=h.getMarginBox(this._div);c=c.offset(-a.l,-a.t);this._previousScale&&1!==b||(this._previousScale=1);var f,g=this._tileW*b,d=this._tileH*b,t=this._tileBounds,u=this._tiles,m=this._previousScale,p=this._multiple,k=e.set,v,w;if((a=n("ie"))&&8>a)q.forEach(this._tileIds,
function(a){w="";f=t[a];v=u[a].style.margin.split(" ");q.forEach(v,function(a){""!==w&&(w+=" ");a=parseFloat(a);w+=a/m*b+"px"});k(u[a],{left:f.x-(g-f.width)*(c.x-f.x)/f.width+"px",top:f.y-(d-f.height)*(c.y-f.y)/f.height+"px",margin:1!==p&&-1===w.indexOf("NaN")?w:"",zoom:b})});else{var x=g*p,l=d*p,z,A;q.forEach(this._tileIds,function(a){w="";f=t[a];z=f.x-(g-f.width)*(c.x-f.x)/f.width;A=f.y-(d-f.height)*(c.y-f.y)/f.height;v=u[a].style.margin.split(" ");q.forEach(v,function(a){""!==w&&(w+=" ");a=parseFloat(a);
w+=a/m*b+"px"});k(u[a],{left:z+"px",top:A+"px",margin:1!==p&&-1===w.indexOf("NaN")?w:"",width:x+"px",height:l+"px"})})}this._previousScale=b},_updateImages:function(a){if(this._ct){var b,c=this._tileW,f=this._tileH,g=this._ct;b=g.lod;var g=g.tile,e=g.offsets,n=g.coords,h=n.row,n=n.col,d=b.level,t=this.opacity,u=this._tileIds,m=this._loadingList,p=this._addImage,k=this._map.id,v=this.id,w=a.x,x=a.y,l=b.startTileRow,z=b.endTileRow,A=b.startTileCol,r=b.endTileCol,ca=q.indexOf,H,ea,va=e.x-this.__coords_dx,
la=e.y-this.__coords_dy;ea=c-va+-a.x;var ma=f-la+-a.y;H=Math.ceil;ea=0<ea?ea%c:c-Math.abs(ea)%c;ma=0<ma?ma%f:f-Math.abs(ma)%f;w=0<w?Math.floor((w+va)/c):H((w-(c-va))/c);x=0<x?Math.floor((x+la)/f):H((x-(f-la))/f);la=w+H((a.width-ea)/c);a=x+H((a.height-ma)/f);var sa,ka,ta;this._wrap&&(sa=b._frameInfo,ka=sa[0],ta=sa[1],sa=sa[2]);for(ma=w;ma<=la;ma++)for(w=x;w<=a;w++)H=h+w,ea=n+ma,this._wrap&&(ea<ta?(ea%=ka,ea=ea<ta?ea+ka:ea):ea>sa&&(ea%=ka)),!this._isExcluded(d,H,ea)&&H>=l&&H<=z&&ea>=A&&ea<=r&&(b=k+
"_"+v+"_tile_"+d+"_"+w+"_"+ma,-1===ca(u,b)&&(m.add(b),u.push(b),p(d,w,H,ma,ea,b,c,f,t,g,e)))}},_cleanUpRemovedImages:function(){var a=this._removeList,b=m.destroy,c,f=g._css.names;a.forEach(function(a){a._fadeOut||(a.style.filter="",a.style.zoom=1,b(a))});if("css-transforms"===this._map.navigationMode)for(c=this._passives.length-1;0<=c;c--){var n=this._passives[c];0===n.childNodes.length?(this._passives.splice(c,1),b(n)):this._map.fadeOnZoom&&!n._marked&&n._remove===n.childNodes.length&&(n._marked=
1,2048>g._css.getScaleFromMatrix(e.get(n,f.transform))?(e.set(n,f.transition,"opacity 0.65s"),e.set(n,"opacity",0),l.disconnect(n._endHandle),n._endHandle=l.connect(n,f.endEvent,this._transitionEnd)):this._transitionEnd({propertyName:"opacity",target:n}))}a.clear()},_transitionEnd:function(a){var b=a.target;"opacity"===a.propertyName&&(l.disconnect(b._endHandle),b._endHandle=null,a=q.indexOf(this._passives,b),-1<a&&this._passives.splice(a,1),b.parentNode&&b.parentNode.removeChild(b),m.destroy(b))},
_addImage:function(a,b,c,f,n,h,t,u,k,v,w){if(this._patchIE)v=this._tiles[h]=m.create("div"),v.id=h,p.add(v,"layerTile"),e.set(v,{left:t*f-w.x+"px",top:u*b-w.y+"px",width:t+"px",height:u+"px",filter:"progid:DXImageTransform.Microsoft.AlphaImageLoader(src\x3d'"+this.getTileUrl(a,c,n)+"', sizingMethod\x3d'scale')"}),1>k&&e.set(v,"opacity",k),a=v.appendChild(m.create("div")),e.set(a,{opacity:0,width:t+"px",height:u+"px"}),this._div.appendChild(v),v=null,this._loadingList.remove(h),this._fireOnUpdateEvent();
else{v=this._tiles[h]=m.create("img");var x=l.connect;v.id=h;v._uid=a+"_"+c+"_"+n;v.alt="";p.add(v,"layerTile");f=t*f-w.x;w=u*b-w.y;b=this._map;var q=g._css.names;t={width:t+"px",height:u+"px",visibility:"hidden"};"css-transforms"===b.navigationMode?(t[q.transform]=g._css.translate(f,w),e.set(v,t),v._left=f,v._top=w):(t.left=f+"px",t.top=w+"px",e.set(v,t));1>k&&e.set(v,"opacity",k);v._onload_connect=x(v,"onload",this,"_tileLoadHandler");v._onerror_connect=x(v,"onerror",d.hitch(this,"_tileErrorHandler",
c,n));v._onabort_connect=x(v,"onabort",this,"_tileAbortHandler");if(this.tileMap)this.tileMap.getTile(a,c,n,h,this._tileMapCallback);else if(h=this.getTileUrl(a,c,n,v))this._failedRequests&&this._failedRequests[h]?(e.set(v,this._failedRequests[h].css),v.src=this._failedRequests[h].src,this._multiple=parseInt(this._failedRequests[h].css.width)/this._tileW,this.isResampling=1!==this._multiple):(this._multiple=1,this.isResampling=!1,v.src=h);"css-transforms"===b.navigationMode?this._active.appendChild(v):
this._div.appendChild(v);v=null}},_tileMapCallback:function(a,b){var f,g;this.suspended||(g=this._tiles[b.id]||c.byId(b.id),f=b.level+"_"+b.row+"_"+b.col,g&&g._uid===f?(this._multiple=2*(b.level-a.level)||1,this.isResampling=1!==this._multiple,f=this.tileMap.style(a,b),e.set(g,f),g.src=this.getTileUrl(a.level,a.row,a.col)):this._popTile(b))},getTileUrl:function(a,b,c){},_reCheckTS:/[\?\&]_ts=/ig,_reReplaceTS:/([\?\&]_ts=)[0-9]+/ig,addTimestampToURL:function(a){var b=this._refreshTS;b&&(a=this._reCheckTS.test(a)?
a.replace(this._reReplaceTS,"$$$1"+b):a+((-1===a.indexOf("?")?"?":"\x26")+"_ts\x3d"+b));return a},refresh:function(){this.suspended||(this._refreshTS=(new Date).getTime(),this._onExtentChangeHandler(this._map.extent,null,!0,this._map.__LOD))},_popTile:function(a){var b=l.disconnect;b(a._onload_connect);b(a._onerror_connect);b(a._onabort_connect);a._onload_connect=a._onerror_connect=a._onabort_connect=null;this._loadingList.remove(a.id);this._fireOnUpdateEvent()},_tileLoadHandler:function(a){a=a.currentTarget;
this._noDom?this._standby.push(a):(e.set(a,"visibility","inherit"),this._popTile(a))},_tileAbortHandler:function(a){a=a.currentTarget;this.onError(Error("Unable to load tile: "+a.src));e.set(a,"visibility","hidden");this._popTile(a)},_tileErrorHandler:function(a,b,c){c=c.currentTarget;var f,g,n=!0;if(this.tileMap||!this.resampling)n=!1;else if(f=new k(c.src),f=f.path.split("/"),f=parseInt(f[f.length-3]),g=this._ct.lod.level-f+1,this._multiple=Math.pow(2,g),f===this._lowestLevel||0===this._resamplingTolerance||
this._resamplingTolerance&&Math.log(this._multiple)/Math.LN2>this._resamplingTolerance)n=!1;n?(this.isResampling=!0,this._resample(c,a,b)):(this.onError(Error("Unable to load tile: "+c.src)),e.set(c,"visibility","hidden"),this._popTile(c))},_resample:function(a,b,c){var f=(new k(a.src)).path.split("/"),g=this._multiple,h=parseInt(f[f.length-3])-1,d=parseInt(b/g),t=parseInt(c/g),f=c%g,u=b%g,d=this.getTileUrl(h,d,t);b=this.getTileUrl(h+Math.log(g)/Math.LN2,b,c);g={width:this._tileW*g+"px",height:this._tileH*
g+"px",margin:"-"+this._tileW*u+"px 0 0 "+("-"+this._tileH*f+"px")};this._failedRequests||(this._failedRequests={});this._failedRequests[b]={src:d,css:g};e.set(a,g);n("chrome")&&a.setAttribute("src",null);a.src=d},_fireOnUpdateEvent:function(){0===this._loadingList.count&&(this._cleanUpRemovedImages(),this._fireOnUpdate&&(this._fireOnUpdate=!1,this.onUpdate(),this._fireUpdateEnd()))},setOpacity:function(a){if(this.opacity!=a)this.onOpacityChange(this.opacity=a)},onOpacityChange:function(){},_opacityChangeHandler:function(a){var b=
e.set,c,f,g;if("css-transforms"===this._map.navigationMode){if(this._active)for(g=this._active.childNodes,c=g.length-1;0<=c;c--)b(g[c],"opacity",a);for(c=this._passives.length-1;0<=c;c--)for(g=this._passives[c].childNodes,f=g.length-1;0<=f;f--)b(g[f],"opacity",a)}else for(g=this._div.childNodes,c=g.length-1;0<=c;c--)b(g[c],"opacity",a)},setExclusionAreas:function(a){this.exclusionAreas=a;if(this.loaded&&this._map&&this._map.loaded){var b=this._map.spatialReference,c=this.tileInfo,f=c.origin,g=c.lods,
e=g[0].level,n=g[g.length-1].level,h,d,t,u,m,p,k,x,l;if(this.exclusionAreas&&this.exclusionAreas.length)for(this._exclusionsPerZoom=[],d=0,t=a.length;d<t;d++){if(h=a[d],(l=h.geometry)&&"extent"===l.type&&l.xmin<=l.xmax&&l.ymin<=l.ymax){if(!b.equals(l.spatialReference))if(b._canProject(l.spatialReference))b.isWebMercator()?(x=v.lngLatToXY(l.xmin,l.ymin),l=v.lngLatToXY(l.xmax,l.ymax)):(x=v.xyToLngLat(l.xmin,l.ymin,!0),l=v.xyToLngLat(l.xmax,l.ymax,!0)),l=new w(x[0],x[1],l[0],l[1],b);else continue;k=
-1;if(h.minZoom&&-1!==h.minZoom)k=h.minZoom;else if(h.minScale&&-1!==h.minScale)for(u=0,m=g.length;u<m;u++)if(g[u].scale<=h.minScale){k=g[u].level;break}k=Math.max(k,e);x=-1;if(h.maxZoom&&-1!==h.maxZoom)x=h.maxZoom;else if(h.maxScale&&-1!==h.maxScale)for(u=0,m=g.length;u<m;u++)if(g[u].scale<h.maxScale){x=g[u-1].level;break}else if(g[u].scale===h.maxScale){x=g[u].level;break}x=-1===x?n:Math.min(x,n);for(h=k;h<=x;h++){u=0;for(m=g.length;u<m;u++)if(g[u].level===h){p=g[u];break}p&&(this._exclusionsPerZoom[h]||
(this._exclusionsPerZoom[h]=[]),u=1/p.resolution/c.rows,m=1/p.resolution/c.cols,this._exclusionsPerZoom[h].push({rowFrom:Math.floor((f.y-l.ymax)*u),rowTo:Math.ceil((f.y-l.ymin)*u),colFrom:Math.floor((l.xmin-f.x)*m),colTo:Math.ceil((l.xmax-f.x)*m)}))}}}else this._exclusionsPerZoom=null;this.suspended||this._onExtentChangeHandler(this._map.extent,null,!0,this._map.__LOD)}},_isExcluded:function(a,b,c){var f,g,e;if(!this._exclusionsPerZoom)return!1;f=this._exclusionsPerZoom[a];if(!f)return!1;g=0;for(e=
f.length;g<e;g++)if(a=f[g],b>=a.rowFrom&&b<a.rowTo&&c>=a.colFrom&&c<a.colTo)return!0;return!1}})})},"dojox/collections/ArrayList":function(){define(["dojo/_base/kernel","dojo/_base/array","./_base"],function(r,l,d){d.ArrayList=function(l){var k=[];l&&(k=k.concat(l));this.count=k.length;this.add=function(d){k.push(d);this.count=k.length};this.addRange=function(d){if(d.getIterator)for(d=d.getIterator();!d.atEnd();)this.add(d.get());else for(var m=0;m<d.length;m++)k.push(d[m]);this.count=k.length};this.clear=
function(){k.splice(0,k.length);this.count=0};this.clone=function(){return new d.ArrayList(k)};this.contains=function(d){for(var m=0;m<k.length;m++)if(k[m]==d)return!0;return!1};this.forEach=function(d,p){r.forEach(k,d,p)};this.getIterator=function(){return new d.Iterator(k)};this.indexOf=function(d){for(var m=0;m<k.length;m++)if(k[m]==d)return m;return-1};this.insert=function(d,p){k.splice(d,0,p);this.count=k.length};this.item=function(d){return k[d]};this.remove=function(d){d=this.indexOf(d);0<=
d&&k.splice(d,1);this.count=k.length};this.removeAt=function(d){k.splice(d,1);this.count=k.length};this.reverse=function(){k.reverse()};this.sort=function(d){d?k.sort(d):k.sort()};this.setByIndex=function(d,p){k[d]=p;this.count=k.length};this.toArray=function(){return[].concat(k)};this.toString=function(d){return k.join(d||",")}};return d.ArrayList})},"dojox/collections/_base":function(){define(["dojo/_base/kernel","dojo/_base/lang","dojo/_base/array"],function(r,l,d){r=l.getObject("dojox.collections",
!0);r.DictionaryEntry=function(d,k){this.key=d;this.value=k;this.valueOf=function(){return this.value};this.toString=function(){return String(this.value)}};r.Iterator=function(l){var k=0;this.element=l[k]||null;this.atEnd=function(){return k>=l.length};this.get=function(){return this.atEnd()?null:this.element=l[k++]};this.map=function(m,k){return d.map(l,m,k)};this.reset=function(){k=0;this.element=l[k]}};r.DictionaryIterator=function(l){var k=[],m={},p;for(p in l)m[p]||k.push(l[p]);var h=0;this.element=
k[h]||null;this.atEnd=function(){return h>=k.length};this.get=function(){return this.atEnd()?null:this.element=k[h++]};this.map=function(e,c){return d.map(k,e,c)};this.reset=function(){h=0;this.element=k[h]}};return r})},"esri/layers/ArcGISMapServiceLayer":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/has ../kernel ../lang ../request ../SpatialReference ../geometry/Extent ./LayerInfo".split(" "),function(r,l,d,q,k,m,p,h,e,c){return r(null,{declaredClass:"esri.layers.ArcGISMapServiceLayer",
infoTemplates:null,constructor:function(b,a){this.layerInfos=[];a&&(this.infoTemplates=a.infoTemplates||null);var c=this._params={},e=this._url.query?this._url.query.token:null;e&&(c.token=e)},setInfoTemplates:function(b){this.infoTemplates=b},_load:function(){p({url:this._url.path,content:l.mixin({f:"json"},this._params),callbackParamName:"callback",load:this._initLayer,error:this._errorHandler})},spatialReference:null,initialExtent:null,fullExtent:null,description:null,units:null,_initLayer:function(b,
a){try{this._findCredential();(this.credential&&this.credential.ssl||b&&b._ssl)&&this._useSSL();this.description=b.description;this.copyright=b.copyrightText;this.spatialReference=b.spatialReference&&new h(b.spatialReference);this.initialExtent=b.initialExtent&&new e(b.initialExtent);this.fullExtent=b.fullExtent&&new e(b.fullExtent);this.units=b.units;this.maxRecordCount=b.maxRecordCount;this.maxImageHeight=b.maxImageHeight;this.maxImageWidth=b.maxImageWidth;this.supportsDynamicLayers=b.supportsDynamicLayers;
var g=this.layerInfos=[],u=b.layers,n=this._defaultVisibleLayers=[];d.forEach(u,function(a,b){g[b]=new c(a);a.defaultVisibility&&n.push(a.id)});this.visibleLayers||(this.visibleLayers=n);this.version=b.currentVersion;this.version||(this.version="capabilities"in b||"tables"in b?10:"supportedImageFormatTypes"in b?9.31:9.3);this.capabilities=b.capabilities;m.isDefined(b.minScale)&&!this._hasMin&&this.setMinScale(b.minScale);m.isDefined(b.maxScale)&&!this._hasMax&&this.setMaxScale(b.maxScale)}catch(t){this._errorHandler(t)}}})})},
"esri/layers/LayerInfo":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/has","../kernel","../lang"],function(r,l,d,q,k){return r(null,{declaredClass:"esri.layers.LayerInfo",constructor:function(d){l.mixin(this,d)},toJson:function(){return k.fixJson({defaultVisibility:this.defaultVisibility,id:this.id,maxScale:this.maxScale,minScale:this.minScale,name:this.name,parentLayerId:this.parentLayerId,subLayerIds:this.subLayerIds})}})})},"esri/layers/TimeInfo":function(){define("dojo/_base/declare dojo/_base/lang dojo/has ../kernel ../TimeExtent ./TimeReference ./LayerTimeOptions".split(" "),
function(r,l,d,q,k,m,p){r=r(null,{declaredClass:"esri.layers.TimeInfo",constructor:function(h){null!==h&&(l.mixin(this,h),h.exportOptions&&(this.exportOptions=new p(h.exportOptions)),this.timeExtent=null,h.timeExtent&&2===h.timeExtent.length&&(this.timeExtent=new k(h.timeExtent)),this.timeReference=new m(h.timeReference))}});l.mixin(r,{UNIT_CENTURIES:"esriTimeUnitsCenturies",UNIT_DAYS:"esriTimeUnitsDays",UNIT_DECADES:"esriTimeUnitsDecades",UNIT_HOURS:"esriTimeUnitsHours",UNIT_MILLISECONDS:"esriTimeUnitsMilliseconds",
UNIT_MINUTES:"esriTimeUnitsMinutes",UNIT_MONTHS:"esriTimeUnitsMonths",UNIT_SECONDS:"esriTimeUnitsSeconds",UNIT_UNKNOWN:"esriTimeUnitsUnknown",UNIT_WEEKS:"esriTimeUnitsWeeks",UNIT_YEARS:"esriTimeUnitsYears"});return r})},"esri/TimeExtent":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/has","./kernel"],function(r,l,d,q){var k=r(null,{declaredClass:"esri.TimeExtent",constructor:function(d){if(1<arguments.length)this._create(arguments[0],arguments[1]);else if(d)if(l.isArray(d)){var m=
d[0],h=d[1];this.startTime=null===m||"null"===m?null:new Date(m);this.endTime=null===h||"null"===h?null:new Date(h)}else d instanceof Date&&this._create(d,null)},offset:function(d,p){var h=new k,e=this.startTime,c=this.endTime;e&&(h.startTime=this._getOffsettedDate(e,d,p));c&&(h.endTime=this._getOffsettedDate(c,d,p));return h},intersection:function(d){return this._intersection(this,d)},toJson:function(){var d=[],k=this.startTime;d.push(k?k.getTime():"null");k=this.endTime;d.push(k?k.getTime():"null");
return d},_create:function(d,k){this.startTime=d?new Date(d.getTime()):null;this.endTime=k?new Date(k.getTime()):null},_refData:{esriTimeUnitsMilliseconds:{getter:"getUTCMilliseconds",setter:"setUTCMilliseconds",multiplier:1},esriTimeUnitsSeconds:{getter:"getUTCSeconds",setter:"setUTCSeconds",multiplier:1},esriTimeUnitsMinutes:{getter:"getUTCMinutes",setter:"setUTCMinutes",multiplier:1},esriTimeUnitsHours:{getter:"getUTCHours",setter:"setUTCHours",multiplier:1},esriTimeUnitsDays:{getter:"getUTCDate",
setter:"setUTCDate",multiplier:1},esriTimeUnitsWeeks:{getter:"getUTCDate",setter:"setUTCDate",multiplier:7},esriTimeUnitsMonths:{getter:"getUTCMonth",setter:"setUTCMonth",multiplier:1},esriTimeUnitsYears:{getter:"getUTCFullYear",setter:"setUTCFullYear",multiplier:1},esriTimeUnitsDecades:{getter:"getUTCFullYear",setter:"setUTCFullYear",multiplier:10},esriTimeUnitsCenturies:{getter:"getUTCFullYear",setter:"setUTCFullYear",multiplier:100}},_intersection:function(d,p){if(d&&p){var h=d.startTime,e=d.endTime,
c=p.startTime,b=p.endTime,h=h?h.getTime():-Infinity,c=c?c.getTime():-Infinity,e=e?e.getTime():Infinity,b=b?b.getTime():Infinity,a,g;c>=h&&c<=e?a=c:h>=c&&h<=b&&(a=h);e>=c&&e<=b?g=e:b>=h&&b<=e&&(g=b);if(isNaN(a)||isNaN(g))return null;h=new k;h.startTime=-Infinity===a?null:new Date(a);h.endTime=Infinity===g?null:new Date(g);return h}return null},_getOffsettedDate:function(d,k,h){var e=this._refData;d=new Date(d.getTime());k&&h&&(e=e[h],d[e.setter](d[e.getter]()+k*e.multiplier));return d}});return k})},
"esri/layers/TimeReference":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/has","../kernel"],function(r,l,d,q){return r(null,{declaredClass:"esri.layers.TimeReference",constructor:function(d){d&&l.mixin(this,d)}})})},"esri/layers/LayerTimeOptions":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/has","../kernel","../lang"],function(r,l,d,q,k){return r(null,{declaredClass:"esri.layers.LayerTimeOptions",constructor:function(d){d&&l.mixin(this,d)},toJson:function(){return k.fixJson({timeDataCumulative:this.timeDataCumulative,
timeOffset:this.timeOffset,timeOffsetUnits:this.timeOffsetUnits,useTime:this.useTime})}})})},"esri/layers/TileMap":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/Deferred dojo/io-query ../request ../urlUtils ../sniff".split(" "),function(r,l,d,q,k,m,p,h){var e=h("esri-iphone");return r(null,{declaredClass:"esri.layers.TileMap",constructor:function(c){this.layer=c;this._tileMaps={}},getTile:function(c,b,a,g,e){c={id:g,level:c,row:b,col:a};b=this._getResamplingBudget();
0<b?this._process({tile:c,requestedTile:c,callback:e,resamplingBudget:b}):(e||this.callback).call(this,c,c)},statusOf:function(c,b,a){var g=this._getResamplingBudget();c={level:c,row:b,col:a};if(0===g)return 1;for(;0<=g;){b=this._tileToTileMap(c);if(!this._tileMaps[b.uid])return-1;b=this._tileMaps[b.uid];if(!b.promise.isFulfilled())return-1;if(this._isTileAvailable(c,b))return 1;c=this._parentTile(c);if(!c)break;g--}return 0},style:function(c,b){if(c.level!==b.level||c.row!==b.row||c.col!==b.col){for(var a=
this.layer.tileInfo,g=a.lods,h=a.cols,a=a.rows,n,d,f=g.length-1;!n||!d;)n||g[f].level!==c.level||(n=g[f]),d||g[f].level!==b.level||(d=g[f]),f--;n=Math.round(n.resolution/d.resolution);d=b.col%n*-1*h;g=b.row%n*-1*a;n={width:h*n+"px",height:a*n+"px",margin:g+"px 0 0 "+d+"px","will-change":"transform"};e&&(d=0===d?0:-1*d,g=0===g?0:-1*g,n.clip="rect("+g+"px,"+(d+h)+"px,"+(g+a)+"px,"+d+"px)");return n}},_process:function(c){var b=c.tile,a=this._tileToTileMap(b),g=this._parentTile(b);this._getTileMap(a).then(l.hitch(this,
function(e){a=e;this._isTileAvailable(b,a)?(c.callback||this.callback).call(this,b,c.requestedTile):0<c.resamplingBudget&&g?(c.resamplingBudget--,c.tile=g,this._process(c)):(c.callback||this.callback).call(this,c.requestedTile,c.requestedTile)}),l.hitch(this,function(){(c.callback||this.callback).call(this,c.requestedTile,c.requestedTile)}))},_getTileMap:function(c){var b,a,g,e,n=null;this._tileMaps[c.uid]?(c=this._tileMaps[c.uid],b=c.promise):(this._tileMaps[c.uid]=c,a=new q,m({url:this._getTileMapUrl(c.level,
c.row,c.col),handleAs:"json",callbackParamName:"callback",timeout:3E3,load:function(b){l.mixin(c,b);if(c.data&&0<c.data.length){e=c.data.length;if(1===e)n=c.data[0];else for(n=c.data[0],g=1;g<e;g++)if(c.data[g]!==n){n=null;break}null!==n&&(delete c.data,c.value=n)}a.resolve(c)},error:function(b){a.reject()}}),b=c.promise=a.promise);return b},_parentTile:function(c){var b=this.layer.tileInfo.lods,a,g,e=null;d.some(b,function(b,e){return c.level===b.level?(a=b,g=e,!0):!1});0<g&&(b=b[g-1],e={id:c.id,
level:b.level,row:Math.floor(c.row*a.resolution/b.resolution+.01),col:Math.floor(c.col*a.resolution/b.resolution+.01)});return e},_tileToTileMap:function(c){var b=8*Math.floor(c.row/8),a=8*Math.floor(c.col/8);return{uid:c.level+"_"+b+"_"+a,level:c.level,row:b,col:a}},_isTileAvailable:function(c,b){var a,g;b.valid?void 0!==b.value?a=b.value:(a=b.location.left,g=b.location.top,a=(c.row-g)*b.location.width+(c.col-a),a=a<b.data.length?b.data[a]:0):a=0;return a},_getTileMapUrl:function(c,b,a){var g=this.layer,
e=g.tileServers,n=g._getToken(),h=g._url.query;c=(e?e[b%e.length]:g._url.path)+"/tilemap/"+c+"/"+b+"/"+a+"/8/8";h&&(c+="?"+k.objectToQuery(h));!n||h&&h.token||(c+=(-1===c.indexOf("?")?"?":"\x26")+"token\x3d"+n);return c=g.addTimestampToURL(c)},_getResamplingBudget:function(){var c=this.layer,b=0;c.resampling&&(b=c._resamplingTolerance,null===b||void 0===b)&&(b=c.tileInfo.lods.length);return b}})})},"esri/layers/MapImageLayer":function(){define("dojo/_base/declare dojo/_base/connect dojo/_base/lang dojo/_base/array dojo/dom-construct dojo/dom-style ../kernel ../config ../sniff ../domUtils ../geometry/Point ../geometry/webMercatorUtils ./layer".split(" "),
function(r,l,d,q,k,m,p,h,e,c,b,a,g){var u=r([g],{declaredClass:"esri.layers.MapImageLayer","-chains-":{constructor:"manual"},constructor:function(a){this.inherited(arguments,[null,a]);this._mapImages=[];var b=d.hitch;this._panStart=b(this,this._panStart);this._pan=b(this,this._pan);this._extentChange=b(this,this._extentChange);this._zoom=b(this,this._zoom);this._zoomStart=b(this,this._zoomStart);this._scale=b(this,this._scale);this._resize=b(this,this._resize);l.connect(this,"onSuspend",this,this._onSuspend);
l.connect(this,"onResume",this,this._onResume);this.loaded=!0;this.onLoad(this)},opacity:1,addImage:function(a){var b=this._mapImages.push(a),b=b-1;a._idx=b;a._layer=this;this._div&&this._createImage(a,b)},removeImage:function(a){if(a){var b=a._idx,c=this._mapImages;if(c[b]===a){delete c[b];if(b=a._node)this._clearEvents(b),b.e_idx=b.e_bl=b.e_tr=b.e_l=b.e_t=b.e_w=b.e_h=null,b.parentNode&&(b.parentNode.removeChild(b),k.destroy(b));a._node=a._idx=a._layer=null}}},removeAllImages:function(){var a=this._mapImages,
b,c=a.length;for(b=0;b<c;b++){var g=a[b];g&&this.removeImage(g)}this._mapImages=[]},getImages:function(){var a=this._mapImages,b=[],c,g=a.length;for(c=0;c<g;c++)a[c]&&b.push(a[c]);return b},setOpacity:function(a){this.opacity!=a&&(this._opacityChanged(this.opacity=a),this.onOpacityChange())},onOpacityChange:function(){},_opacityChanged:function(a){var b=this._div,c,g;if(b)if(!e("ie")||8<e("ie"))m.set(b,"opacity",a);else for(g=b.childNodes,c=g.length,b=0;b<c;b++)m.set(g[b],"opacity",a)},_createImage:function(a,
b){var c=k.create("img");m.set(c,{position:"absolute"});1>a.opacity?m.set(c,"opacity",a.opacity):8>=e("ie")&&m.set(c,"opacity",this.opacity);!a.rotation||9>e("ie")||m.set(c,p._css.names.transform,p._css.rotate(360-a.rotation));a._node=c;c.e_idx=b;c.e_layer=this;c.e_load=l.connect(c,"onload",u.prototype._imageLoaded);c.e_error=l.connect(c,"onerror",u.prototype._imageError);c.e_abort=l.connect(c,"onabort",u.prototype._imageError);c.src=a.href},_imageLoaded:function(a,b){var c=b||a.target||a.currentTarget,
g=c.e_layer,e=g._mapImages[c.e_idx],n=g._map;n&&(n.__zooming||n.__panning||!g._sr)?g._standby.push(c):(g._clearEvents(c),e&&e._node===c&&n&&g._attach(e))},_imageError:function(a){a=a.target||a.currentTarget;var b=a.e_layer,c=b._mapImages[a.e_idx];b._clearEvents(a);c&&(c._node=null)},_clearEvents:function(a){var b=l.disconnect;b(a.e_load);b(a.e_error);b(a.e_abort);a.e_load=a.e_error=a.e_abort=a.e_layer=null},_attach:function(c){var g=c.extent,f=g.spatialReference,e=this._sr,n=this._div,h=c._node,d=
new b({x:g.xmin,y:g.ymin,spatialReference:f}),g=new b({x:g.xmax,y:g.ymax,spatialReference:f});e.equals(f)||(e.isWebMercator()&&4326===f.wkid?(d=a.geographicToWebMercator(d),g=a.geographicToWebMercator(g)):f.isWebMercator()&&4326===e.wkid&&(d=a.webMercatorToGeographic(d),g=a.webMercatorToGeographic(g)));h.e_bl=d;h.e_tr=g;c.visible&&(this._setPos(h,n._left,n._top),(this._active||n).appendChild(h))},_setPos:function(a,b,c){var f=a.e_bl,g=a.e_tr,e=this._map,f=e.toScreen(f),g=e.toScreen(g);b=f.x-b;c=g.y-
c;var h=Math.abs(g.x-f.x),f=Math.abs(f.y-g.y),g={width:h+"px",height:f+"px"},n=this._mapImages[a.e_idx];"css-transforms"===e.navigationMode?g[p._css.names.transform]=p._css.translate(b,c)+(n.rotation?" "+p._css.rotate(360-n.rotation):""):(g.left=b+"px",g.top=c+"px");m.set(a,g);a.e_l=b;a.e_t=c;a.e_w=h;a.e_h=f},managedSuspension:!0,_setMap:function(a,b){this.inherited(arguments);var f=this._div=k.create("div",null,b),g=p._css.names,h={position:"absolute"},n=a.__visibleDelta;if(!e("ie")||8<e("ie"))h.opacity=
this.opacity;"css-transforms"===a.navigationMode?(h[g.transform]=p._css.translate(n.x,n.y),m.set(f,h),f._left=n.x,f._top=n.y,h={position:"absolute",width:a.width+"px",height:a.height+"px",overflow:"visible"},this._active=k.create("div",null,f),m.set(this._active,h),this._passive=k.create("div",null,f),m.set(this._passive,h)):(f._left=0,f._top=0,m.set(f,h));this._standby=[];g=this._mapImages;n=g.length;for(h=0;h<n;h++){var d=g[h];d._node||this._createImage(d,d._idx)}c.hide(f);return f},_unsetMap:function(a,
b){this._disconnect();var c=this._div;if(c){var g=this._mapImages,e,h=g.length;for(e=0;e<h;e++){var n=g[e];if(n){var d=n._node;d&&(this._clearEvents(d),d.e_idx=d.e_bl=d.e_tr=d.e_l=d.e_t=d.e_w=d.e_h=null);n._node=null}}b.removeChild(c);k.destroy(c)}this._map=this._div=this._sr=this._active=this._passive=this._standby=null;this.inherited(arguments)},_onSuspend:function(){this._disconnect();c.hide(this._div)},_onResume:function(a){a.firstOccurrence&&(this._sr=this._map.spatialReference,this._processStandbyList());
a=this._map;var b=this._div,f=a.__visibleDelta;"css-transforms"===a.navigationMode&&(b._left=f.x,b._top=f.y,m.set(b,p._css.names.transform,p._css.translate(b._left,b._top)));this._redraw("css-transforms"===a.navigationMode);this._connect(a);c.show(b)},_connect:function(a){if(!this._connections){var b=l.connect,c="css-transforms"===a.navigationMode;this._connections=[b(a,"onPanStart",this._panStart),b(a,"onPan",this._pan),b(a,"onExtentChange",this._extentChange),c&&b(a,"onZoomStart",this._zoomStart),
c?b(a,"onScale",this._scale):b(a,"onZoom",this._zoom),c&&b(a,"onResize",this._resize)]}},_disconnect:function(){this._connections&&(q.forEach(this._connections,l.disconnect),this._connections=null)},_panStart:function(){this._panL=this._div._left;this._panT=this._div._top},_pan:function(a,b){var c=this._div;c._left=this._panL+b.x;c._top=this._panT+b.y;"css-transforms"===this._map.navigationMode?m.set(c,p._css.names.transform,p._css.translate(c._left,c._top)):m.set(c,{left:c._left+"px",top:c._top+
"px"})},_extentChange:function(a,b,c){c?this._redraw("css-transforms"===this._map.navigationMode):b&&this._pan(a,b);this._processStandbyList()},_processStandbyList:function(){var a,b=this._standby;if(b&&b.length)for(a=b.length-1;0<=a;a--)this._imageLoaded(null,b[a]),b.splice(a,1)},_redraw:function(a){if(a){a=this._passive;var b=p._css.names;m.set(a,b.transition,"none");this._moveImages(a,this._active);m.set(a,b.transform,"none")}a=this._active||this._div;var b=this._div._left,c=this._div._top,g,e=
a.childNodes.length,h;for(g=0;g<e;g++)h=a.childNodes[g],this._setPos(h,b,c)},_zoom:function(a,b,c){a=this._div;var f=a._left,g=a._top,e,h=a.childNodes.length,d;for(e=0;e<h;e++){d=a.childNodes[e];var n=d.e_w*b,u=d.e_h*b,t=(c.x-f-d.e_l)*(n-d.e_w)/d.e_w,k=(c.y-g-d.e_t)*(u-d.e_h)/d.e_h,t=isNaN(t)?0:t,k=isNaN(k)?0:k;m.set(d,{left:d.e_l-t+"px",top:d.e_t-k+"px",width:n+"px",height:u+"px"})}},_zoomStart:function(){this._moveImages(this._active,this._passive)},_moveImages:function(a,b){var c=a.childNodes,
g;g=c.length;if(0<g)for(--g;0<=g;g--)b.appendChild(c[g])},_scale:function(a,b){var c=p._css.names,g=this._passive;m.set(g,c.transition,b?"none":c.transformName+" "+h.defaults.map.zoomDuration+"ms ease");({})[c.transform]=p._css.matrix(a);m.set(g,c.transform,p._css.matrix(a))},_resize:function(a,b,c){m.set(this._active,{width:b+"px",height:c+"px"});m.set(this._passive,{width:b+"px",height:c+"px"})}});return u})},"esri/layers/OpenStreetMapLayer":function(){define("dojo/_base/declare dojo/_base/lang dojo/has ../kernel ../urlUtils ../SpatialReference ../geometry/Extent ./TiledMapServiceLayer ./TileInfo".split(" "),
function(r,l,d,q,k,m,p,h,e){return r(h,{declaredClass:"esri.layers.OpenStreetMapLayer",constructor:function(c){this.spatialReference=new m({wkid:102100});this.tileInfo=new e({rows:256,cols:256,dpi:96,format:"PNG8",compressionQuality:0,origin:{x:-2.0037508342787E7,y:2.0037508342787E7},spatialReference:{wkid:102100},lods:[{level:0,scale:5.91657527591555E8,resolution:156543.033928},{level:1,scale:2.95828763795777E8,resolution:78271.5169639999},{level:2,scale:1.47914381897889E8,resolution:39135.7584820001},
{level:3,scale:7.3957190948944E7,resolution:19567.8792409999},{level:4,scale:3.6978595474472E7,resolution:9783.93962049996},{level:5,scale:1.8489297737236E7,resolution:4891.96981024998},{level:6,scale:9244648.868618,resolution:2445.98490512499},{level:7,scale:4622324.434309,resolution:1222.99245256249},{level:8,scale:2311162.217155,resolution:611.49622628138},{level:9,scale:1155581.108577,resolution:305.748113140558},{level:10,scale:577790.554289,resolution:152.874056570411},{level:11,scale:288895.277144,
resolution:76.4370282850732},{level:12,scale:144447.638572,resolution:38.2185141425366},{level:13,scale:72223.819286,resolution:19.1092570712683},{level:14,scale:36111.909643,resolution:9.55462853563415},{level:15,scale:18055.954822,resolution:4.77731426794937},{level:16,scale:9027.977411,resolution:2.38865713397468},{level:17,scale:4513.988705,resolution:1.19432856685505},{level:18,scale:2256.994353,resolution:.597164283559817},{level:19,scale:1128.497176,resolution:.298582141647617}]});this.fullExtent=
new p({xmin:-2.003750834E7,ymin:-2.003750834E7,xmax:2.003750834E7,ymax:2.003750834E7,spatialReference:{wkid:102100}});this.initialExtent=new p({xmin:-2.003750834E7,ymin:-2.003750834E7,xmax:2.003750834E7,ymax:2.003750834E7,spatialReference:{wkid:102100}});this.tileServers=c&&c.tileServers||["//a.tile.openstreetmap.org","//b.tile.openstreetmap.org","//c.tile.openstreetmap.org"];this.serversLength=this.tileServers.length;this._displayLevels=c?c.displayLevels:null;this.copyright=c&&c.copyright||"Map data \u00a9 OpenStreetMap contributors, CC-BY-SA";
this.loaded=!0;this.onLoad(this);(c=c&&c.loadCallback)&&c(this)},getTileUrl:function(c,b,a){c=this.tileServers[b%this.serversLength]+"/"+c+"/"+a+"/"+b+".png";c=k.normalize(c);c=this.addTimestampToURL(c);return k.addProxy(c)}})})},"esri/layers/VectorTileLayer":function(){(function(){var r=function(){var d;try{d=window.WebGLRenderingContext}catch(e){d=!1}var l;try{for(var k=document.createElement("canvas"),m=["webgl","experimental-webgl","webkit-3d","moz-webgl"],p=null,h=0;h<m.length;++h){try{p=k.getContext(m[h])}catch(e){}if(p)break}l=
p}catch(e){l=!1}return d&&l?!0:!1}(),l=["dojo/_base/lang","dojo/has","dojo/Deferred","../sniff","./layer"];r&&l.push("./VectorTileLayerImpl");define(l,function(d,l,k,m,p,h){l=h?h:p.createSubclass({declaredClass:"esri.layers.VectorTileLayer",constructor:function(){var e=new k;e.reject(Error("esri.layers.VectorTileLayer is not supported"));e.promise.otherwise(d.hitch(this,function(c){this._errorHandler(c)}))}});l.ACCESS_TOKEN=null;l.supported=function(){return r};return l})})()},"esri/dijit/Popup":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/connect dojo/_base/kernel dojo/has dojo/window dojo/Stateful dojo/query dojo/dom dojo/dom-attr dojo/dom-class dojo/dom-construct dojo/dom-geometry dojo/dom-style dijit/registry ../kernel ../lang ../domUtils ../geometry/Polyline ../geometry/Polygon ../geometry/normalizeUtils ../InfoWindowBase ../PopupBase dojo/i18n!../nls/jsapi dojo/NodeList-dom require require".split(" "),
function(r,l,d,q,k,m,p,h,e,c,b,a,g,u,n,t,f,v,x,w,z,A,y,B,C){return r([y,B,h],{declaredClass:"esri.dijit.Popup",offsetX:3,offsetY:3,zoomFactor:4,marginLeft:25,marginTop:25,highlight:!0,pagingControls:!0,pagingInfo:!0,keepHighlightOnHide:!1,popupWindow:!0,titleInBody:!0,anchor:"auto",visibleWhenEmpty:!0,hideDelay:1E3,location:null,constructor:function(f,g){this.initialize();l.mixin(this,f);this.domNode=c.byId(g);var e=this._nls=l.mixin({},C.widgets.popup),h=this.domNode;a.add(h,"esriPopup");(this._isRTL=
!u.isBodyLtr())&&n.set(h,"direction","rtl");b.set(h,"innerHTML","\x3cdiv class\x3d'esriPopupWrapper' style\x3d'position: absolute;'\x3e\x3cdiv class\x3d'sizer'\x3e\x3cdiv class\x3d'titlePane'\x3e\x3cdiv class\x3d'spinner hidden' title\x3d'"+e.NLS_searching+"...'\x3e\x3c/div\x3e\x3cdiv class\x3d'title'\x3e\x3c/div\x3e\x3cdiv class\x3d'titleButton prev hidden' title\x3d'"+e.NLS_prevFeature+"'\x3e\x3c/div\x3e\x3cdiv class\x3d'titleButton next hidden' title\x3d'"+e.NLS_nextFeature+"'\x3e\x3c/div\x3e\x3cdiv class\x3d'titleButton maximize' title\x3d'"+
e.NLS_maximize+"'\x3e\x3c/div\x3e\x3cdiv class\x3d'titleButton close' title\x3d'"+e.NLS_close+"'\x3e\x3c/div\x3e\x3c/div\x3e\x3c/div\x3e\x3cdiv class\x3d'sizer content'\x3e\x3cdiv class\x3d'contentPane'\x3e\x3c/div\x3e\x3c/div\x3e\x3cdiv class\x3d'sizer'\x3e\x3cdiv class\x3d'actionsPane'\x3e\x3cdiv class\x3d'actionList hidden'\x3e\x3ca title\x3d"+e.NLS_zoomTo+" class\x3d'action zoomTo' href\x3d'javascript:void(0);'\x3e\x3cspan\x3e"+e.NLS_zoomTo+"\x3c/span\x3e\x3c/a\x3e\x3c/div\x3e\x3c/div\x3e\x3c/div\x3e\x3cdiv class\x3d'pointer hidden'\x3e\x3c/div\x3e\x3c/div\x3e\x3cdiv class\x3d'outerPointer hidden'\x3e\x3c/div\x3e");
this._sizers=k.query(".sizer",h);e=k.query(".titlePane",h)[0];c.setSelectable(e,!1);this._title=k.query(".title",e)[0];this._prevFeatureButton=k.query(".prev",e)[0];this._nextFeatureButton=k.query(".next",e)[0];this._maxButton=k.query(".maximize",e)[0];this._spinner=k.query(".spinner",e)[0];this._contentPane=k.query(".contentPane",h)[0];this._positioner=k.query(".esriPopupWrapper",h)[0];this._pointer=k.query(".pointer",h)[0];this._outerPointer=k.query(".outerPointer",h)[0];this._actionList=k.query(".actionsPane .actionList",
h)[0];this._eventConnections=[q.connect(k.query(".close",e)[0],"onclick",this,this.hide),q.connect(this._prevFeatureButton,"onclick",this,this.selectPrevious),q.connect(this._nextFeatureButton,"onclick",this,this.selectNext),q.connect(this._maxButton,"onclick",this,this._toggleSize),q.connect(k.query(".zoomTo",this._actionList)[0],"onclick",this,this._zoomToFeature),q.connect(this,"onClearFeatures",this,this._featuresCleared),q.connect(this,"onSelectionChange",this,this._featureSelected),q.connect(this,
"onDfdComplete",this,this._updateUI)];m("esri-touch")&&(h=x.setScrollable(this._contentPane),this._eventConnections.push(h[0],h[1]));this._toggleVisibility(!1)},onMaximize:function(){},onRestore:function(){},setMap:function(a){this.inherited(arguments);g.place(this.domNode,a.root);this.highlight&&this.enableHighlight(a);this._maxHeight=n.get(this._contentPane,"maxHeight")},unsetMap:function(){this.disableHighlight(this.map);this.inherited(arguments)},setTitle:function(a){this.popupWindow&&(v.isDefined(a)&&
""!==a||(a="\x26nbsp;"),this.destroyDijits(this._title),this.place(a,this._title),this.isShowing&&(this.startupDijits(this._title),this.reposition()))},setContent:function(a){this.popupWindow&&(v.isDefined(a)&&""!==a||(a="\x26nbsp;"),this.destroyDijits(this._contentPane),this.place(a,this._contentPane),this.isShowing&&(this.startupDijits(this._contentPane),this.reposition()))},show:function(a,b){if(this.popupWindow)if(this._delayHide=!1,a){var c=this.map,f;a.spatialReference?(this.location=a,f=c.toScreen(a)):
(this.location=c.toMap(a),f=a);var g=c._getFrameWidth();if(-1!==g&&(f.x%=g,0>f.x&&(f.x+=g),c.width>g))for(c=(c.width-g)/2;f.x<c;)f.x+=g;this._maximized?this.restore():this._setPosition(f);b&&b.closestFirst&&this.showClosestFirst(this.location);this.isShowing||(this._toggleVisibility(!0),this._followMap(),this.startupDijits(this._title),this.startupDijits(this._contentPane),this.reposition(),this.showHighlight(),this.onShow())}else this._toggleVisibility(!0)},hide:function(){this.isShowing&&(this._toggleVisibility(!1),
this._unfollowMap(),this.keepHighlightOnHide||this.hideHighlight(),this.onHide())},resize:function(a,b){this.popupWindow&&(this._sizers.style({width:a+"px"}),n.set(this._contentPane,"maxHeight",b+"px"),this._maxHeight=b,this.isShowing&&this.reposition())},reposition:function(){this.popupWindow&&this.map&&this.location&&!this._maximized&&this.isShowing&&this._setPosition(this.map.toScreen(this.location))},maximize:function(){var c=this.map;if(c&&!this._maximized&&this.popupWindow){this._maximized=
!0;var f=this._maxButton;a.remove(f,"maximize");a.add(f,"restore");b.set(f,"title",this._nls.NLS_restore);var f=this.marginLeft,g=this.marginTop,e=c.width-2*f,c=c.height-2*g;n.set(this.domNode,{left:this._isRTL?null:f+"px",right:this._isRTL?f+"px":null,top:g+"px",bottom:null});n.set(this._positioner,{left:null,right:null,top:null,bottom:null});this._savedWidth=n.get(this._sizers[0],"width");this._savedHeight=n.get(this._contentPane,"maxHeight");this._sizers.style({width:e+"px"});n.set(this._contentPane,
{maxHeight:c-65+"px",height:c-65+"px"});this._showPointer("");this._unfollowMap();a.add(this.domNode,"esriPopupMaximized");this.onMaximize()}},restore:function(){if(this.map&&this._maximized&&this.popupWindow){this._maximized=!1;var c=this._maxButton;a.remove(c,"restore");a.add(c,"maximize");b.set(c,"title",this._nls.NLS_maximize);n.set(this._contentPane,"height",null);this.resize(this._savedWidth,this._savedHeight);this._savedWidth=this._savedHeight=null;this.show(this.location);this._followMap();
a.remove(this.domNode,"esriPopupMaximized");this.onRestore()}},startup:function(){},destroy:function(){this.map&&this.unsetMap();this.cleanup();this.isShowing&&this.hide();this.destroyDijits(this._title);this.destroyDijits(this._content);d.forEach(this._eventConnections,q.disconnect);g.destroy(this.domNode);this._sizers=this._contentPane=this._actionList=this._positioner=this._pointer=this._outerPointer=this._title=this._prevFeatureButton=this._nextFeatureButton=this._spinner=this._eventConnections=
this._pagerScope=this._targetLocation=this._nls=this._maxButton=null},selectNext:function(){this.select(this.selectedIndex+1)},selectPrevious:function(){this.select(this.selectedIndex-1)},setFeatures:function(){this.inherited(arguments);this._updateUI()},postscript:null,_highlightSetter:function(a){var b=this.highlight,c=this.map;this.highlight=a;if(c&&a!==b)if(a){if(this.enableHighlight(c),a=this.features&&this.features[this.selectedIndex])this.updateHighlight(c,a),this.showHighlight()}else this.disableHighlight(c)},
_pagingControlsSetter:function(a){var b=this.pagingControls,c=this.map;this.pagingControls=a;c&&a!==b&&this._updatePagingControls()},_pagingInfoSetter:function(a){var b=this.pagingInfo,c=this.map;this.pagingInfo=a;c&&a!==b&&this.features&&this.features.length&&this._updatePagingInfo()},_popupWindowSetter:function(a){var b=this.popupWindow,c=this.map;this.popupWindow=a;c&&a!==b&&(a?(this._updateUI(),this._updateWindow()):(this.hide(),this.showHighlight()))},_anchorSetter:function(a){var b=this.anchor;
this.anchor=a;this.map&&a!==b&&this.reposition()},_featuresCleared:function(){this.setTitle("\x26nbsp;");this.setContent("\x26nbsp;");this._setPagerCallbacks(this);this._updateUI();this.hideHighlight()},_featureSelected:function(){this._updateUI();this._updateWindow()},_updateWindow:function(){var a=this.selectedIndex;if(0<=a){var b=this.features[a].getContent(),c;!this.titleInBody&&b&&l.isString(b.id)&&(c=t.byId(b.id))&&c.set&&/_PopupRenderer/.test(c.declaredClass)&&c.set("showTitle",!1);this.setContent(b);
this.updateHighlight(this.map,this.features[a]);this.showHighlight()}},_toggleVisibility:function(a){this._setVisibility(a);this.isShowing=a},_setVisibility:function(b){a.toggle(this.domNode,"esriPopupVisible",b);a.toggle(this.domNode,"esriPopupHidden",!b)},_waitAndHide:function(a){var b=this;this._delayHide=!0;setTimeout(function(){b._delayHide&&(b._delayHide=!1,b.hide())},a)},_followMap:function(){this._unfollowMap();var a=this.map;this._handles=[q.connect(a,"onPanStart",this,this._onPanStart),
q.connect(a,"onPan",this,this._onPan),q.connect(a,"onZoomStart",this,this._onZoomStart),q.connect(a,"onExtentChange",this,this._onExtentChange)]},_unfollowMap:function(){var a=this._handles;a&&(d.forEach(a,q.disconnect),this._handles=null)},_onPanStart:function(){var a=this.domNode.style;this._panOrigin={left:a.left,top:a.top,right:a.right,bottom:a.bottom}},_onPan:function(a,b){var c=this._panOrigin,f=b.x,g=b.y,e=c.left,h=c.top,d=c.right,c=c.bottom;e&&(e=parseFloat(e)+f+"px");h&&(h=parseFloat(h)+
g+"px");d&&(d=parseFloat(d)-f+"px");c&&(c=parseFloat(c)-g+"px");n.set(this.domNode,{left:e,top:h,right:d,bottom:c})},_onZoomStart:function(){this._setVisibility(!1)},_onExtentChange:function(a,b,c){c&&(this._setVisibility(!0),this.show(this._targetLocation||this.location));this._targetLocation=null},_toggleSize:function(){this._maximized?this.restore():this.maximize()},_setPosition:function(a){var b=a.x,c=a.y;a=this.offsetX||0;var f=this.offsetY||0,g=0,e=0,h=u.position(this.map.container,!0),d=h.w,
t=h.h,k="Left",m="bottom",v=u.getContentBox(this._positioner),w=v.w/2,x=v.h/2,l=n.get(this._sizers[0],"height")+this._maxHeight+n.get(this._sizers[2],"height"),q=l/2,z=0,A=0,y=b,B=c,r=this.anchor.toLowerCase();if("auto"===r){if(r=p.getBox)r=r(),z=Math.max(r.l,h.x),d=Math.min(r.l+r.w,h.x+h.w),A=Math.max(r.t,h.y),t=Math.min(r.t+r.h,h.y+h.h),y+=h.x,B+=h.y;h=B-A>=l;l=t-B>=l;r=d-y>=v.w;v=y-z>=v.w;B-A>q&&t-B>=q&&(r?(m="",k="Left"):v&&(m="",k="Right"));k&&m&&y-z>w&&d-y>=w&&(h?(k="",m="bottom"):l&&(k="",
m="top"));k&&m&&(r&&h?(k="Left",m="bottom"):r&&l?(k="Left",m="top"):v&&l?(k="Right",m="top"):v&&h&&(k="Right",m="bottom"))}else m=k="",-1!==r.indexOf("top")?m="bottom":-1!==r.indexOf("bottom")&&(m="top"),-1!==r.indexOf("left")?k="Right":-1!==r.indexOf("right")&&(k="Left");q=m+k;switch(q){case "top":case "bottom":e=14;break;case "Left":case "Right":g=13;break;case "topLeft":case "topRight":case "bottomLeft":case "bottomRight":e=14,g=-16}n.set(this.domNode,{left:b+"px",top:c+"px",right:null,bottom:null});
b={left:null,right:null,top:null,bottom:null};k?b[k.toLowerCase()]=g+a+"px":b.left=-w+"px";m?b[m]=e+f+"px":b.top=-x+"px";n.set(this._positioner,b);this._showPointer(q)},_showPointer:function(b){a.remove(this._pointer,"top bottom right left topLeft topRight bottomRight bottomLeft hidden".split(" "));a.remove(this._outerPointer,["right","left","hidden"]);"Right"===b||"Left"===b?(b=b.toLowerCase(),a.add(this._outerPointer,b)):a.add(this._pointer,b)},_setPagerCallbacks:function(a,b,c){if(this.pagingControls&&
(a!==this||this._pagerScope&&this._pagerScope!==this)&&a!==this._pagerScope){this._pagerScope=a;a===this&&(b=this.selectPrevious,c=this.selectNext);var f=this._eventConnections;q.disconnect(f[1]);q.disconnect(f[2]);b&&(f[1]=q.connect(this._prevFeatureButton,"onclick",a,b));c&&(f[2]=q.connect(this._nextFeatureButton,"onclick",a,c))}},_getLocation:function(a){var b,c;if(a=a&&a.geometry)switch(a.type){case "point":b=a;break;case "multipoint":b=a.getPoint(0);c=A.getDenormalizedExtent(a);break;case "polyline":case "polygon":b=
a.getPoint(0,0),c=A.getDenormalizedExtent(a)}return[b,c]},_zoomToFeature:function(a){a.preventDefault();var b=this.features,c=this.selectedIndex;a=this.map;if(b)if(c=this._getLocation(b[c]),b=c[0],c=c[1],b||(b=this.location),c&&c.intersects(this.location)||(this.location=b),c&&c.getWidth()&&c.getHeight())a.setExtent(c,!0);else{var f=a.getNumLevels(),c=a.getLevel(),g=a.getMaxZoom(),e=this.zoomFactor||1;0<f?c!==g&&(f=c+e,f>g&&(f=g),a.navigationManager._wheelZoom({value:f-c,mapPoint:b},!0)):a.navigationManager._wheelZoom({value:1/
Math.pow(2,e)*2,mapPoint:b},!0)}},_updatePagingControls:function(){var b=this._prevFeatureButton,c=this._nextFeatureButton,f=this.selectedIndex,g=this.features?this.features.length:0;this.pagingControls&&1<g?(0===f?a.add(b,"hidden"):a.remove(b,"hidden"),f===g-1?a.add(c,"hidden"):a.remove(c,"hidden")):(a.add(b,"hidden"),a.add(c,"hidden"))},_updatePagingInfo:function(){var a=this.features?this.features.length:0,b=this._nls,c="\x26nbsp;";this.pagingInfo&&1<a&&b.NLS_pagingInfo&&(c=v.substitute({index:this.selectedIndex+
1,total:a},b.NLS_pagingInfo));a&&(b=this.getSelectedFeature(),a=b.getInfoTemplate(),b=b.getTitle(),a&&!/esri\.InfoTemplate/.test(a.declaredClass)&&this.titleInBody||!b||(c=b+("\x26nbsp;"===c?"":" "+c)));this.setTitle(c)},_updateUI:function(){if(this.popupWindow){var b=this.features,c=this.deferreds,f=b?b.length:0,g=this._spinner,e=this._actionList,h=this._nls;this._updatePagingControls();this._updatePagingInfo();f?a.remove(e,"hidden"):a.add(e,"hidden");c&&c.length?b?a.remove(g,"hidden"):this.setContent("\x3cdiv style\x3d'text-align: center;'\x3e"+
h.NLS_searching+"...\x3c/div\x3e"):(a.add(g,"hidden"),f||(this.setContent("\x3cdiv style\x3d'text-align: center;'\x3e"+h.NLS_noInfo+".\x3c/div\x3e"),this.visibleWhenEmpty||this._waitAndHide(this.hideDelay)))}}})})},"dojo/window":function(){define("./_base/lang ./sniff ./_base/window ./dom ./dom-geometry ./dom-style ./dom-construct".split(" "),function(r,l,d,q,k,m,p){l.add("rtl-adjust-position-for-verticalScrollBar",function(e,c){var b=d.body(c),a=p.create("div",{style:{overflow:"scroll",overflowX:"visible",
direction:"rtl",visibility:"hidden",position:"absolute",left:"0",top:"0",width:"64px",height:"64px"}},b,"last"),g=p.create("div",{style:{overflow:"hidden",direction:"ltr"}},a,"last"),h=0!=k.position(g).x;a.removeChild(g);b.removeChild(a);return h});l.add("position-fixed-support",function(e,c){var b=d.body(c),a=p.create("span",{style:{visibility:"hidden",position:"fixed",left:"1px",top:"1px"}},b,"last"),g=p.create("span",{style:{position:"fixed",left:"0",top:"0"}},a,"last"),h=k.position(g).x!=k.position(a).x;
a.removeChild(g);b.removeChild(a);return h});var h={getBox:function(e){e=e||d.doc;var c="BackCompat"==e.compatMode?d.body(e):e.documentElement,b=k.docScroll(e);if(l("touch")){var a=h.get(e);e=a.innerWidth||c.clientWidth;c=a.innerHeight||c.clientHeight}else e=c.clientWidth,c=c.clientHeight;return{l:b.x,t:b.y,w:e,h:c}},get:function(e){if(l("ie")&&h!==document.parentWindow){e.parentWindow.execScript("document._parentWindow \x3d window;","Javascript");var c=e._parentWindow;e._parentWindow=null;return c}return e.parentWindow||
e.defaultView},scrollIntoView:function(e,c){try{e=q.byId(e);var b=e.ownerDocument||d.doc,a=d.body(b),g=b.documentElement||a.parentNode,h=l("ie")||l("trident"),n=l("webkit");if(e!=a&&e!=g)if(!(l("mozilla")||h||n||l("opera")||l("trident")||l("edge"))&&"scrollIntoView"in e)e.scrollIntoView(!1);else{var t="BackCompat"==b.compatMode,f=Math.min(a.clientWidth||g.clientWidth,g.clientWidth||a.clientWidth),p=Math.min(a.clientHeight||g.clientHeight,g.clientHeight||a.clientHeight),b=n||t?a:g,x=c||k.position(e),
w=e.parentNode,n=function(a){return 6>=h||7==h&&t?!1:l("position-fixed-support")&&"fixed"==m.get(a,"position").toLowerCase()},z=this,A=function(a,b,c){"BODY"==a.tagName||"HTML"==a.tagName?z.get(a.ownerDocument).scrollBy(b,c):(b&&(a.scrollLeft+=b),c&&(a.scrollTop+=c))};if(!n(e))for(;w;){w==a&&(w=b);var y=k.position(w),B=n(w),r="rtl"==m.getComputedStyle(w).direction.toLowerCase();if(w==b)y.w=f,y.h=p,b==g&&(h||l("trident"))&&r&&(y.x+=b.offsetWidth-y.w),y.x=0,y.y=0;else{var E=k.getPadBorderExtents(w);
y.w-=E.w;y.h-=E.h;y.x+=E.l;y.y+=E.t;var D=w.clientWidth,F=y.w-D;0<D&&0<F&&(r&&l("rtl-adjust-position-for-verticalScrollBar")&&(y.x+=F),y.w=D);D=w.clientHeight;F=y.h-D;0<D&&0<F&&(y.h=D)}B&&(0>y.y&&(y.h+=y.y,y.y=0),0>y.x&&(y.w+=y.x,y.x=0),y.y+y.h>p&&(y.h=p-y.y),y.x+y.w>f&&(y.w=f-y.x));var G=x.x-y.x,J=x.y-y.y,N=G+x.w-y.w,M=J+x.h-y.h,L,K;0<N*G&&(w.scrollLeft||w==b||w.scrollWidth>w.offsetHeight)&&(L=Math[0>G?"max":"min"](G,N),r&&(8==h&&!t||5<=l("trident"))&&(L=-L),K=w.scrollLeft,A(w,L,0),L=w.scrollLeft-
K,x.x-=L);0<M*J&&(w.scrollTop||w==b||w.scrollHeight>w.offsetHeight)&&(L=Math.ceil(Math[0>J?"max":"min"](J,M)),K=w.scrollTop,A(w,0,L),L=w.scrollTop-K,x.y-=L);w=w!=b&&!B&&w.parentNode}}}catch(W){console.error("scrollIntoView: "+W),e.scrollIntoView(!1)}}};r.setObject("dojo.window",h);return h})},"dojo/Stateful":function(){define(["./_base/declare","./_base/lang","./_base/array","./when"],function(r,l,d,q){return r("dojo.Stateful",null,{_attrPairNames:{},_getAttrNames:function(d){var k=this._attrPairNames;
return k[d]?k[d]:k[d]={s:"_"+d+"Setter",g:"_"+d+"Getter"}},postscript:function(d){d&&this.set(d)},_get:function(d,m){return"function"===typeof this[m.g]?this[m.g]():this[d]},get:function(d){return this._get(d,this._getAttrNames(d))},set:function(d,m){if("object"===typeof d){for(var k in d)d.hasOwnProperty(k)&&"_watchCallbacks"!=k&&this.set(k,d[k]);return this}k=this._getAttrNames(d);var h=this._get(d,k);k=this[k.s];var e;"function"===typeof k?e=k.apply(this,Array.prototype.slice.call(arguments,1)):
this[d]=m;if(this._watchCallbacks){var c=this;q(e,function(){c._watchCallbacks(d,h,m)})}return this},_changeAttrValue:function(d,m){var k=this.get(d);this[d]=m;this._watchCallbacks&&this._watchCallbacks(d,k,m);return this},watch:function(k,m){var p=this._watchCallbacks;if(!p)var h=this,p=this._watchCallbacks=function(b,a,c,e){var g=function(g){if(g){g=g.slice();for(var f=0,e=g.length;f<e;f++)g[f].call(h,b,a,c)}};g(p["_"+b]);e||g(p["*"])};m||"function"!==typeof k?k="_"+k:(m=k,k="*");var e=p[k];"object"!==
typeof e&&(e=p[k]=[]);e.push(m);var c={};c.unwatch=c.remove=function(){var b=d.indexOf(e,m);-1<b&&e.splice(b,1)};return c}})})},"esri/geometry/normalizeUtils":function(){define("dojo/_base/array dojo/_base/lang dojo/_base/Deferred dojo/has ../kernel ../config ../deferredUtils ./Extent ./Polyline ./Polygon ./webMercatorUtils ./jsonUtils".split(" "),function(r,l,d,q,k,m,p,h,e,c,b,a){function g(a,b){return Math.ceil((a-b)/(2*b))}function u(a,b){var c=a.paths||a.rings,f,g,e=c.length,h;for(f=0;f<e;f++)for(h=
c[f].length,g=0;g<h;g++){var d=a.getPoint(f,g);a.setPoint(f,g,d.offset(b,0))}return a}function n(a,b){if(!(a instanceof e||a instanceof c))throw console.error("_straightLineDensify: the input geometry is neither polyline nor polygon"),Error("_straightLineDensify: the input geometry is neither polyline nor polygon");var f=a instanceof e,g=[],h;r.forEach(f?a.paths:a.rings,function(a){g.push(h=[]);h.push([a[0][0],a[0][1]]);var c,f,e,d,n,u,t,k,m,p,v,w;for(n=0;n<a.length-1;n++){c=a[n][0];f=a[n][1];e=a[n+
1][0];d=a[n+1][1];t=Math.sqrt((e-c)*(e-c)+(d-f)*(d-f));k=(d-f)/t;m=(e-c)/t;p=t/b;if(1<p){for(u=1;u<=p-1;u++)w=u*b,v=m*w+c,w=k*w+f,h.push([v,w]);u=(t+Math.floor(p-1)*b)/2;v=m*u+c;w=k*u+f;h.push([v,w])}h.push([e,d])}});return f?new e({paths:g,spatialReference:a.spatialReference}):new c({rings:g,spatialReference:a.spatialReference})}function t(a,c,f){c&&(a=n(a,1E6),a=b.webMercatorToGeographic(a,!0));f&&(a=u(a,f));return a}function f(a,b,c){var f=a.x||a[0],e;f>b?(e=g(f,b),a.x?a=a.offset(-2*e*b,0):a[0]=
f+-2*e*b):f<c&&(e=g(f,c),a.x?a=a.offset(-2*e*c,0):a[0]=f+-2*e*c);return a}function v(a,b){var c=-1;r.forEach(b.cutIndexes,function(f,e){var h=b.geometries[e];r.forEach(h.rings||h.paths,function(a,b){r.some(a,function(c){if(!(180>c[0])){c=0;var f,e=a.length,d;for(f=0;f<e;f++)d=a[f][0],c=d>c?d:c;c=Number(c.toFixed(9));c=-360*g(c,180);e=a.length;for(f=0;f<e;f++)d=h.getPoint(b,f),h.setPoint(b,f,d.offset(c,0))}return!0})});f===c?h.rings?r.forEach(h.rings,function(b){a[f]=a[f].addRing(b)}):r.forEach(h.paths,
function(b){a[f]=a[f].addPath(b)}):(c=f,a[f]=h)});return a}function x(h,n,k,p){var w=new d;w.addCallbacks(k,p);n=n||m.defaults.geometryService;var x=[],l=[],q,z,A,y,B,D,C,E,Q=0;r.forEach(h,function(b){if(b)if(q||(q=b.spatialReference,z=q._getInfo(),y=(A=q._isWebMercator())?2.0037508342788905E7:180,B=A?-2.0037508342788905E7:-180,D=A?102100:4326,C=new e({paths:[[[y,B],[y,y]]],spatialReference:{wkid:D}}),E=new e({paths:[[[B,B],[B,y]]],spatialReference:{wkid:D}})),z){var h=a.fromJson(b.toJson()),d=b.getExtent();
"point"===b.type?x.push(f(h,y,B)):"multipoint"===b.type?(h.points=r.map(h.points,function(a){return f(a,y,B)}),x.push(h)):"extent"===b.type?(h=d._normalize(null,null,z),x.push(h.rings?new c(h):h)):d?(b=2*g(d.xmin,B)*y,h=0===b?h:u(h,b),d=d.offset(b,0),d.intersects(C)&&d.xmax!==y?(Q=d.xmax>Q?d.xmax:Q,h=t(h,A),l.push(h),x.push("cut")):d.intersects(E)&&d.xmin!==B?(Q=2*d.xmax*y>Q?2*d.xmax*y:Q,h=t(h,A,360),l.push(h),x.push("cut")):x.push(h)):x.push(h)}else x.push(b);else x.push(b)});k=new e;p=g(Q,y);for(var U=
-90,ia=p;0<p;){var Y=-180+360*p;k.addPath([[Y,U],[Y,-1*U]]);U*=-1;p--}0<l.length&&0<ia?n?n.cut(l,k,function(a){l=v(l,a);var c=[];r.forEach(x,function(a,f){if("cut"===a){var g=l.shift();h[f].rings&&1<h[f].rings.length&&g.rings.length>=h[f].rings.length?(x[f]="simplify",c.push(g)):x[f]=!0===A?b.geographicToWebMercator(g):g}});0<c.length?n.simplify(c,function(a){r.forEach(x,function(c,f){"simplify"===c&&(x[f]=!0===A?b.geographicToWebMercator(a.shift()):a.shift())});w.callback(x)},function(a){w.errback(a)}):
w.callback(x)},function(a){w.errback(a)}):w.errback(Error("esri.geometry.normalizeCentralMeridian: 'geometryService' argument is missing.")):(r.forEach(x,function(a,c){if("cut"===a){var f=l.shift();x[c]=!0===A?b.geographicToWebMercator(f):f}}),w.callback(x));return w}function w(a,b,c,f){var g=!1,e;l.isObject(a)&&a&&(l.isArray(a)?a.length&&((e=a[0]&&a[0].declaredClass)&&-1!==e.indexOf("Graphic")?(a=r.map(a,function(a){return a.geometry}),g=a.length?!0:!1):e&&-1!==e.indexOf("esri.geometry.")&&(g=!0)):
(e=a.declaredClass)&&-1!==e.indexOf("FeatureSet")?(a=r.map(a.features||[],function(a){return a.geometry}),g=a.length?!0:!1):e&&-1!==e.indexOf("esri.geometry.")&&(g=!0));g&&b.push({index:c,property:f,value:a})}function z(a,b){var c=[];r.forEach(b,function(b){var f=b.i,g=a[f];b=b.p;var e;if(l.isObject(g)&&g)if(b)if("*"===b[0])for(e in g)g.hasOwnProperty(e)&&w(g[e],c,f,e);else r.forEach(b,function(a){w(l.getObject(a,!1,g),c,f,a)});else w(g,c,f)});return c}function A(a,b){var c=0,f={};r.forEach(b,function(b){var g=
b.index,e=b.property,h=b.value,d=h.length||1,n=a.slice(c,c+d);l.isArray(h)||(n=n[0]);c+=d;delete b.value;e?(f[g]=f[g]||{},f[g][e]=n):f[g]=n});return f}function y(a){for(var b=[],c=0,f=0,g=Math.min,e=Math.max,h=0;h<a.length;h++){for(var d=a[h],n=null,u=0;u<d.length;u++)n=d[u],b.push(n),0===u?f=c=n[0]:(c=g(c,n[0]),f=e(f,n[0]));n&&b.push([(c+f)/2,0])}return b}return{normalizeCentralMeridian:x,_foldCutResults:v,_prepareGeometryForCut:t,_offsetMagnitude:g,_pointNormalization:f,_updatePolyGeometry:u,_straightLineDensify:n,
_createWrappers:function(a){var b=l.isObject(a)?a.prototype:l.getObject(a+".prototype");r.forEach(b.__msigns,function(a){var c=b[a.n];b[a.n]=function(){var b=this,f=[],g,e=new d(p._dfdCanceller);a.f&&p._fixDfd(e);for(g=0;g<a.c;g++)f[g]=arguments[g];var h={dfd:e};f.push(h);var n,u=[],t;b.normalization&&!b._isTable&&(n=z(f,a.a),r.forEach(n,function(a){u=u.concat(a.value)}),u.length&&(t=x(u)));t?(e._pendingDfd=t,t.addCallbacks(function(a){e.canceled||(h.assembly=A(a,n),e._pendingDfd=c.apply(b,f))},function(c){var g=
b.declaredClass;g&&-1!==g.indexOf("FeatureLayer")?b._resolve([c],null,f[a.e],e,!0):b._errorHandler(c,f[a.e],e)})):e._pendingDfd=c.apply(b,f);return e}})},_disassemble:z,_addToBucket:w,_reassemble:A,getDenormalizedExtent:function(a){if(!a)return null;var b=a.getExtent();if(!b)return null;var c=a.spatialReference&&a.spatialReference._getInfo();if(!c)return b;var f=c.valid[0],c=c.valid[1],g=2*c,e=b.getWidth(),d=b.xmax,n=b.xmin;if("extent"===a.type||0===e||e<=c||e>g||d<f||n>c)return b;var u;switch(a.type){case "polygon":if(1<
a.rings.length)u=y(a.rings);else return b;break;case "polyline":if(1<a.paths.length)u=y(a.paths);else return b;break;case "multipoint":u=a.points}a=Math.min;for(var f=Math.max,g=new h(b.toJson()),t=0;t<u.length;t++){var k=u[t][0];0>k?(k+=c,n=f(k,n)):(k-=c,d=a(k,d))}g.xmin=d;g.xmax=n;return g.getWidth()<e?(g.xmin-=c,g.xmax-=c,g):b}}})},"esri/geometry/jsonUtils":function(){define("dojo/_base/lang dojo/has ../kernel ./Point ./Polyline ./Polygon ./Multipoint ./Extent".split(" "),function(r,l,d,q,k,m,
p,h){return{fromJson:function(e){if(void 0!==e.x&&void 0!==e.y)return new q(e);if(void 0!==e.paths)return new k(e);if(void 0!==e.rings)return new m(e);if(void 0!==e.points)return new p(e);if(void 0!==e.xmin&&void 0!==e.ymin&&void 0!==e.xmax&&void 0!==e.ymax)return new h(e)},getJsonType:function(e){return e instanceof q?"esriGeometryPoint":e instanceof k?"esriGeometryPolyline":e instanceof m?"esriGeometryPolygon":e instanceof h?"esriGeometryEnvelope":e instanceof p?"esriGeometryMultipoint":null},getGeometryType:function(e){return"esriGeometryPoint"===
e?q:"esriGeometryPolyline"===e?k:"esriGeometryPolygon"===e?m:"esriGeometryEnvelope"===e?h:"esriGeometryMultipoint"===e?p:null}}})},"esri/InfoWindowBase":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/connect dojo/_base/Deferred dojo/dom-construct dojo/has dijit/registry ./kernel ./lang ./geometry/ScreenPoint".split(" "),function(r,l,d,q,k,m,p,h,e,c,b){return r(null,{declaredClass:"esri.InfoWindowBase",constructor:function(){var a=l.hitch;this.__set_title=a(this,
this.__set_title);this.__err_title=a(this,this.__err_title);this.__set_content=a(this,this.__set_content);this.__err_content=a(this,this.__err_content)},setMap:function(a){this.map=a},unsetMap:function(a){delete this.map},setTitle:function(){},setContent:function(){},show:function(){},hide:function(){},resize:function(){},onShow:function(){},onHide:function(){},place:function(a,b){c.isDefined(a)?l.isObject(a)?m.place(a,b,"only"):b.innerHTML=a:b.innerHTML=""},startupDijits:function(a){this._processDijits(a)},
destroyDijits:function(a){this._processDijits(a,!0)},_processDijits:function(a,b){if(a&&1===a.children.length){var c=a.children[0];if(c){var g=h.byNode(c),c=g?[g]:h.findWidgets(c);d.forEach(c,function(a){if(b){if(a._started&&!a._destroyed)try{a.destroyRecursive?a.destroyRecursive():a.destroy&&a.destroy()}catch(f){console.debug("An error occurred when destroying a widget embedded within InfoWindow: "+f.message)}}else if(!a._started)try{a.startup()}catch(f){console.debug("An error occurred when starting a widget embedded within InfoWindow: "+
f.message)}})}}},__registerMapListeners:function(){this.__unregisterMapListeners();var a=this.map;this.__handles=[q.connect(a,"onPan",this,this.__onMapPan),q.connect(a,"onZoomStart",this,this.__onMapZmStart),q.connect(a,"onExtentChange",this,this.__onMapExtChg)]},__unregisterMapListeners:function(){var a=this.__handles;a&&(d.forEach(a,q.disconnect,q),this.__handles=null)},__onMapPan:function(a,b){this.move(b,!0)},__onMapZmStart:function(){this.__mcoords=this.mapCoords||this.map.toMap(new b(this.coords));
this.hide(null,!0)},__onMapExtChg:function(a,b,c){a=this.map;var g=this.mapCoords;g?this.show(g,null,!0):(b=c?a.toScreen(this.__mcoords):this.coords.offset(b&&b.x||0,b&&b.y||0),this.show(b,null,!0))},__setValue:function(a,b){this[a].innerHTML="";var g="_dfd"+a,e=this[g];e&&-1===e.fired&&(e.cancel(),this[g]=null);c.isDefined(b)&&(b instanceof k?(this[g]=b,b.addCallbacks(this["__set"+a],this["__err"+a])):this.__render(a,b))},__set_title:function(a){this._dfd_title=null;this.__render("_title",a)},__err_title:function(a){this._dfd_title=
null},__set_content:function(a){this._dfd_content=null;this.__render("_content",a)},__err_content:function(a){this._dfd_content=null},__render:function(a,b){var c=this[a];this.place(b,c);this.isShowing&&(this.startupDijits(c),"_title"===a&&this._adjustContentArea&&this._adjustContentArea())}})})},"esri/PopupBase":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/Color dojo/_base/Deferred dojo/has ./kernel ./graphic ./geometry/Point ./geometry/jsonUtils ./geometry/mathUtils ./geometry/webMercatorUtils ./symbols/SimpleMarkerSymbol ./symbols/SimpleLineSymbol ./symbols/CartographicLineSymbol ./symbols/SimpleFillSymbol ./tasks/query ./Evented require".split(" "),
function(r,l,d,q,k,m,p,h,e,c,b,a,g,u,n,t,f,v){function x(a){return"sizeInfo"===a.type}return r(v,{declaredClass:"esri.PopupBase",_featureLayers:{},_updateEndHandles:[],_evtMap:{"set-features":!0,"clear-features":!0,"selection-change":!0,"dfd-complete":!0},onSetFeatures:function(){},onClearFeatures:function(){},onSelectionChange:function(){},onDfdComplete:function(){},initialize:function(){this.count=0;this.selectedIndex=-1;this.on("clear-features",l.hitch(this,this._resetUpdateEndListeners));this.on("dfd-complete",
l.hitch(this,this._processFeatures));this.on("set-features",l.hitch(this,this._processFeatures))},cleanup:function(){this.features=this.deferreds=null;this._resetUpdateEndListeners()},setFeatures:function(a){if(a&&a.length){this.clearFeatures();var b,c;a[0]instanceof k?c=a:b=a;b?this._updateFeatures(null,b):(this.deferreds=c,c=c.slice(0),d.forEach(c,function(a){a.addBoth(l.hitch(this,this._updateFeatures,a))},this))}},clearFeatures:function(){this.features=this.deferreds=this._marked=null;this.count=
0;var a=this.selectedIndex;this.selectedIndex=-1;if(-1<a)this.onSelectionChange();this.onClearFeatures()},getSelectedFeature:function(){var a=this.features;if(a)return a[this.selectedIndex]},select:function(a){0>a||a>=this.count||(this.selectedIndex=a,this.onSelectionChange())},enableHighlight:function(a){this._highlighted=a.graphics.add(new h(new e(0,0,a.spatialReference)));this._highlighted.hide();this.markerSymbol||(a=this.markerSymbol=new g,a.setStyle(g.STYLE_TARGET),a._setDim(16,16,0),a.setOutline(new n(u.STYLE_SOLID,
new q([0,255,255]),2,n.CAP_ROUND,n.JOIN_ROUND)),a.setColor(new q([0,0,0,0])));this.lineSymbol||(this.lineSymbol=new u(u.STYLE_SOLID,new q([0,255,255]),2));this.fillSymbol||(this.fillSymbol=new t(t.STYLE_NULL,new u(u.STYLE_SOLID,new q([0,255,255]),2),new q([0,0,0,0])))},disableHighlight:function(a){var b=this._highlighted;b&&(b.hide(),a.graphics.remove(b),delete this._highlighted);this.markerSymbol=this.lineSymbol=this.fillSymbol=null},showHighlight:function(){var a=this.features&&this.features[this.selectedIndex];
this._highlighted&&a&&a.geometry&&this._highlighted.show()},hideHighlight:function(){this._highlighted&&this._highlighted.hide()},updateHighlight:function(a,b){var f=b.geometry,g=this._highlighted;if(f&&g){g.hide();!g._graphicsLayer&&a&&a.graphics.add(g);g.setGeometry(c.fromJson(f.toJson()));var e;switch(f.type){case "point":case "multipoint":var h=b.getLayer(),f=b.symbol||h&&h._getSymbol(b);if(h&&f){var d,n,u=0,t=0,k=0;e=b.symbol?null:h._getRenderer(b);if(h=this._getSizeInfo(e))d=n=e.getSize(b,{sizeInfo:h,
shape:f.style,resolution:a&&a.getResolutionInMeters&&a.getResolutionInMeters()});else switch(f.type){case "simplemarkersymbol":d=n=f.size||0;break;case "picturemarkersymbol":d=f.width||0,n=f.height||0}u=f.xoffset||0;t=f.yoffset||0;k=f.angle||0;e=this.markerSymbol;e.setOffset(0,0);e.setAngle(0);d&&n&&e._setDim(d+1,n+1,0);e.setOffset(u,t);e.setAngle(k)}break;case "polyline":e=this.lineSymbol;break;case "polygon":e=this.fillSymbol}g.setSymbol(e)}else g&&g.hide()},showClosestFirst:function(c){var f=this.features;
if(f&&f.length){if(1<f.length){var g,e=Infinity,h=-1,d,n=b.getLength,u,t=c.spatialReference,k,m;c=c.normalize();for(g=f.length-1;0<=g;g--)if(d=f[g].geometry){k=d.spatialReference;u=0;try{m="point"===d.type?d:d.getExtent().getCenter(),m=m.normalize(),t&&k&&!t.equals(k)&&t._canProject(k)&&(m=t.isWebMercator()?a.geographicToWebMercator(m):a.webMercatorToGeographic(m)),u=n(c,m)}catch(N){}0<u&&u<e&&(e=u,h=g)}0<h&&(f.splice(0,0,f.splice(h,1)[0]),this.select(0))}}else this.deferreds&&(this._marked=c)},_unbind:function(a){a=
d.indexOf(this.deferreds,a);if(-1!==a)return this.deferreds.splice(a,1),this.deferreds.length?1:(this.deferreds=null,2)},_fireComplete:function(a){var b=this._marked;b&&(this._marked=null,this.showClosestFirst(b));this.onDfdComplete(a)},_updateFeatures:function(a,b){if(a){if(this.deferreds){var c=this._unbind(a);if(c)if(b&&b instanceof Error){if(this._fireComplete(b),2===c)this.onSetFeatures()}else if(b&&b.length)if(this.features){var f=d.filter(b,function(a){return-1===d.indexOf(this.features,a)},
this);this.features=this.features.concat(f);this.count=this.features.length;this._fireComplete();if(2===c)this.onSetFeatures()}else{this.features=b;this.count=b.length;this.selectedIndex=0;this._fireComplete();if(2===c)this.onSetFeatures();this.select(0)}else if(this._fireComplete(),2===c)this.onSetFeatures()}}else this.features=b,this.count=b.length,this.selectedIndex=0,this.onSetFeatures(),this.select(0)},_getSizeInfo:function(a){return a?a.sizeInfo||d.filter(a.visualVariables,x)[0]:null},_resetUpdateEndListeners:function(){this._featureLayers=
{};d.forEach(this._updateEndHandles,function(a){a.remove()});this._updateEndHandles=[]},_processFeatures:function(){d.forEach(this.features,function(a){(a=a.getLayer())&&!this._featureLayers[a.id]&&(1===a.currentMode||0===a.currentMode&&6===a.mode)&&a.objectIdField&&a.hasXYFootprint&&a.queryFeatures&&("esriGeometryPolygon"===a.geometryType||"esriGeometryPolyline"===a.geometryType||a.hasXYFootprint())&&(this._featureLayers[a.id]=a,a=a.on("update-end",l.hitch(this,this._fLyrUpdateEndHandler)),this._updateEndHandles.push(a))},
this)},_fLyrUpdateEndHandler:function(a){if(!a.error){var b=this,c=a.target,g=c.getSelectedFeatures(),e=0===c.currentMode&&6===c.mode,h={},n=[];d.forEach(this.features,function(a){if(a.getLayer()===c){var b=a.attributes[c.objectIdField];h[b]=a;n.push(b)}});n.length&&(a=new f,a.objectIds=n,c.queryFeatures(a,function(a){d.forEach(a.features,function(a){var b=h[a.attributes[c.objectIdField]],f=!1;b.geometry!==a.geometry?(b.setGeometry(a.geometry),f=!0):e&&g&&-1!==d.indexOf(g,a)&&(f=!0);f&&this._highlighted&&
b===this.getSelectedFeature()&&this._highlighted.setGeometry(a.geometry)},b)}))}}})})},"esri/graphic":function(){define("dojo/_base/declare dojo/_base/lang dojo/has ./kernel ./domUtils ./lang ./InfoTemplate ./geometry/jsonUtils ./symbols/jsonUtils".split(" "),function(r,l,d,q,k,m,p,h,e){r=r(null,{declaredClass:"esri.Graphic",constructor:function(c,b,a,g){c&&!c.declaredClass?(this.geometry=c.geometry?h.fromJson(c.geometry):null,this.symbol=c.symbol?e.fromJson(c.symbol):null,this.attributes=c.attributes||
null,this.infoTemplate=c.infoTemplate?new p(c.infoTemplate):null):(this.geometry=c,this.symbol=b,this.attributes=a,this.infoTemplate=g)},_shape:null,_graphicsLayer:null,_visible:!0,visible:!0,getDojoShape:function(){return this._shape},getShapes:function(){var c=[];this._shape&&c.push(this._shape);this._bgShape&&c.push(this._bgShape);return c},getNode:function(){var c=this._shape&&this._shape.getNode();return c&&c.nodeType?c:null},getNodes:function(){var c=this.getShapes(),b,a,g=c.length,e=[];for(a=
0;a<g;a++)(b=c[a]&&c[a].getNode())&&b.nodeType&&e.push(b);return e},getLayer:function(){return this._layer},getSourceLayer:function(){return this._sourceLayer||this._layer},draw:function(){var c=this._graphicsLayer;c&&c._draw(this,!0);return this},setGeometry:function(c){this.geometry=c;var b=this._graphicsLayer;b&&(b._updateExtent(this),b._draw(this,!0),c&&"polyline"===c.type&&b._updateSVGMarkers());return this},setSymbol:function(c,b){var a=this._graphicsLayer,g=this._shape;this.symbol=c;a&&(b&&
g&&a._removeShape(this),a._draw(this,!0));return this},setAttributes:function(c){this.attributes=c;this._clearCache();return this},setInfoTemplate:function(c){this.infoTemplate=c;return this},getInfoTemplate:function(){return this._getEffInfoTemplate()},_getEffInfoTemplate:function(){var c=this.getLayer();return this.infoTemplate||c&&c.infoTemplate},getTitle:function(){var c=this.getInfoTemplate(),b=c&&c.title;if(l.isFunction(b))b=b.call(c,this);else if(l.isString(b))var a=(c=this.getLayer())&&c._getDateOpts,
b=m.substitute(this.attributes,b,{first:!0,dateFormat:a&&a.call(c)});return b},getContent:function(){var c=this.getInfoTemplate(),b=c&&c.content;if(l.isFunction(b))b=b.call(c,this);else if(l.isString(b))var a=(c=this.getLayer())&&c._getDateOpts,b=m.substitute(this.attributes,b,{dateFormat:a&&a.call(c)});return b},attr:function(c,b){var a=this.getNodes(),g,e=a.length;for(g=0;g<e;g++)null==b?a[g].removeAttribute(c):a[g].setAttribute(c,b);return this},show:function(){this.visible=this._visible=!0;var c,
b,a;if(this.getShapes().length)for(c=this.getNodes(),a=c.length,this.attr("data-hidden"),b=0;b<a;b++)k.show(c[b]);else this._graphicsLayer&&this._graphicsLayer._draw(this,!0);return this},hide:function(){this.visible=this._visible=!1;var c=this._graphicsLayer,b,a;if(c)if("canvas-2d"===c.surfaceType)c._removeShape(this);else if(c=this.getNodes(),a=c.length)for(this.attr("data-hidden",""),b=0;b<a;b++)k.hide(c[b]);return this},toJson:function(){var c={};this.geometry&&(c.geometry=this.geometry.toJson());
this.attributes&&(c.attributes=l.mixin({},this.attributes));this.symbol&&(c.symbol=this.symbol.toJson());this.infoTemplate&&(c.infoTemplate=this.infoTemplate.toJson());return c},_getViewInfo:function(c){return(c=(c=c||this.getLayer())&&c.getMap())&&c._getViewInfo()},_getDataValue:function(c,b,a,g){var e=this._getCacheItem(c,b);if(void 0===e.value){var h=null,d=this.attributes,f=c.field;b.hasExpr?h=a.executeFunction(b.compiledFunc,a.createExecContext(this,this._getViewInfo(g))):l.isFunction(f)?h=f(this,
c):d&&(h=d[f],(c=c.normalizationField)&&this._isValidNumber(h)&&(d=parseFloat(d[c]),h=this._isValidNumber(d)&&0!==d?h/d:null));this._isValidNumber(h)||(h=null);e.value=h}return e.value},_isValidNumber:function(c){return"number"===typeof c&&!isNaN(c)&&Infinity!==c&&-Infinity!==c},_getCacheItem:function(c,b){var a=this._findCacheItem(c);a?a.version!==b.version&&(a.version=b.version,a.value=void 0):a=this._createCacheItem(c,b);return a},_findCacheItem:function(c){var b,a=this._cache;if(a){var g,e=a.length;
for(g=0;g<e;g++){var h=a[g];if(h.variable===c){b=h;break}}}return b},_createCacheItem:function(c,b){var a=this._cache;a||(a=this._cache=[]);var g={variable:c,version:b.version,value:void 0};a.push(g);return g},_clearCache:function(){this._cache=null}});r.prototype.getShape=r.prototype.getDojoShape;return r})},"esri/InfoTemplate":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/has","./kernel","./lang"],function(r,l,d,q,k){return r(null,{declaredClass:"esri.InfoTemplate",constructor:function(d,
k){d&&l.isObject(d)&&!l.isFunction(d)?l.mixin(this,d):(this.title=d||"${*}",this.content=k||"${*}")},setTitle:function(d){this.title=d;return this},setContent:function(d){this.content=d;return this},toJson:function(){return k.fixJson({title:this.title,content:this.content})}})})},"esri/symbols/jsonUtils":function(){define("dojo/_base/lang dojo/has ../kernel ./SimpleMarkerSymbol ./PictureMarkerSymbol ./SimpleLineSymbol ./CartographicLineSymbol ./SimpleFillSymbol ./PictureFillSymbol ./TextSymbol".split(" "),
function(r,l,d,q,k,m,p,h,e,c){return{fromJson:function(b){var a=null;switch(b.type){case "esriSMS":a=new q(b);break;case "esriPMS":a=new k(b);break;case "esriTS":a=new c(b);break;case "esriSLS":a=void 0!==b.cap?new p(b):new m(b);break;case "esriCLS":a=new p(b);break;case "esriSFS":a=new h(b);break;case "esriPFS":a=new e(b)}return a},getShapeDescriptors:function(b){return b&&b.getShapeDescriptors?b.getShapeDescriptors():{defaultShape:null,fill:null,stroke:null}}}})},"esri/symbols/PictureMarkerSymbol":function(){define("dojo/_base/declare dojo/_base/lang dojo/sniff dojox/gfx/_base ../kernel ../lang ../urlUtils ./MarkerSymbol".split(" "),
function(r,l,d,q,k,m,p,h){var e={url:"",width:12,height:12,angle:0,xoffset:0,yoffset:0};r=r(h,{declaredClass:"esri.symbol.PictureMarkerSymbol",type:"picturemarkersymbol",constructor:function(c,b,a){c?l.isString(c)?(this.url=c,b&&(this.width=b),a&&(this.height=a)):(this.width=q.pt2px(c.width),this.height=q.pt2px(c.height),b=c.imageData,9>d("ie")||!b||(a=this.url,this.url="data:"+(c.contentType||"image")+";base64,"+b,this.imageData=a)):(l.mixin(this,e),this.width=q.pt2px(this.width),this.height=q.pt2px(this.height))},
getStroke:function(){return null},getFill:function(){return null},setWidth:function(c){this.width=c;return this},setHeight:function(c){this.height=c;return this},setUrl:function(c){c!==this.url&&(delete this.imageData,delete this.contentType);this.url=c;return this},getShapeDescriptors:function(){return{defaultShape:{type:"image",x:-Math.round(this.width/2),y:-Math.round(this.height/2),width:this.width,height:this.height,src:this.url||""},fill:null,stroke:null}},toJson:function(){var c=this.url,b=
this.imageData;if(0===c.indexOf("data:"))var a=c,c=b,b=a.indexOf(";base64,")+8,b=a.substr(b);!l.isString(c)||0!==c.indexOf("/")&&0!==c.indexOf("//")&&0!==c.indexOf("./")&&0!==c.indexOf("../")||(c=p.getAbsoluteUrl(c));var a=q.px2pt(this.width),a=isNaN(a)?void 0:a,g=q.px2pt(this.height),g=isNaN(g)?void 0:g,c=m.fixJson(l.mixin(this.inherited("toJson",arguments),{type:"esriPMS",url:c,imageData:b,contentType:this.contentType,width:a,height:g}));delete c.color;delete c.size;c.imageData||delete c.imageData;
return c}});r.defaultProps=e;return r})},"esri/symbols/CartographicLineSymbol":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/Color dojo/has dojox/gfx/_base ../kernel ../lang ./SimpleLineSymbol".split(" "),function(r,l,d,q,k,m,p,h){var e={STYLE_SOLID:"solid",STYLE_DASH:"dash",STYLE_DOT:"dot",STYLE_DASHDOT:"dashdot",STYLE_DASHDOTDOT:"longdashdotdot",STYLE_NULL:"none",STYLE_INSIDE_FRAME:"insideframe",STYLE_SHORTDASH:"shortdash",STYLE_SHORTDOT:"shortdot",STYLE_SHORTDASHDOT:"shortdashdot",
STYLE_SHORTDASHDOTDOT:"shortdashdotdot",STYLE_LONGDASH:"longdash",STYLE_LONGDASHDOT:"longdashdot",CAP_BUTT:"butt",CAP_ROUND:"round",CAP_SQUARE:"square",JOIN_MITER:"miter",JOIN_ROUND:"round",JOIN_BEVEL:"bevel"},c={color:[0,0,0,1],style:e.STYLE_SOLID,width:1,cap:e.CAP_BUTT,join:e.JOIN_MITER,miterLimit:10};r=r(h,{declaredClass:"esri.symbol.CartographicLineSymbol",type:"cartographiclinesymbol",_caps:{butt:"esriLCSButt",round:"esriLCSRound",square:"esriLCSSquare"},_joins:{miter:"esriLJSMiter",round:"esriLJSRound",
bevel:"esriLJSBevel"},constructor:function(b,a,g,e,h,t){b?l.isString(b)?(this.style=b,a&&(this.color=a),void 0!==g&&(this.width=g),e&&(this.cap=e),h&&(this.join=h),void 0!==t&&(this.miterLimit=t)):(this.cap=p.valueOf(this._caps,b.cap),this.join=p.valueOf(this._joins,b.join),this.width=k.pt2px(b.width),this.miterLimit=k.pt2px(b.miterLimit)):(l.mixin(this,c),this.color=new d(this.color),this.width=k.pt2px(this.width),this.miterLimit=k.pt2px(this.miterLimit))},setCap:function(b){this.cap=b;return this},
setJoin:function(b){this.join=b;return this},setMiterLimit:function(b){this.miterLimit=b;return this},getStroke:function(){return l.mixin(this.inherited("getStroke",arguments),{cap:this.cap,join:this.join===e.JOIN_MITER?this.miterLimit:this.join})},getFill:function(){return null},getShapeDescriptors:function(){return{defaultShape:{type:"path",path:"M -15,0 L 15,0 E"},fill:null,stroke:this.getStroke()}},toJson:function(){var b=k.px2pt(this.miterLimit),b=isNaN(b)?void 0:b;return p.fixJson(l.mixin(this.inherited("toJson",
arguments),{type:"esriCLS",cap:this._caps[this.cap],join:this._joins[this.join],miterLimit:b}))}});l.mixin(r,e);r.defaultProps=c;return r})},"esri/symbols/SimpleFillSymbol":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/Color dojo/has dojox/gfx/_base ../kernel ../lang ./FillSymbol ./SimpleLineSymbol require".split(" "),function(r,l,d,q,k,m,p,h,e,c){var b={STYLE_SOLID:"solid",STYLE_NULL:"none",STYLE_HORIZONTAL:"horizontal",STYLE_VERTICAL:"vertical",STYLE_FORWARD_DIAGONAL:"forwarddiagonal",
STYLE_BACKWARD_DIAGONAL:"backwarddiagonal",STYLE_CROSS:"cross",STYLE_DIAGONAL_CROSS:"diagonalcross",STYLE_FORWARDDIAGONAL:"forwarddiagonal",STYLE_BACKWARDDIAGONAL:"backwarddiagonal",STYLE_DIAGONALCROSS:"diagonalcross"},a={style:b.STYLE_SOLID,color:[0,0,0,.25]};r=r(h,{declaredClass:"esri.symbol.SimpleFillSymbol",type:"simplefillsymbol",_styles:{solid:"esriSFSSolid",none:"esriSFSNull",horizontal:"esriSFSHorizontal",vertical:"esriSFSVertical",forwarddiagonal:"esriSFSForwardDiagonal",backwarddiagonal:"esriSFSBackwardDiagonal",
cross:"esriSFSCross",diagonalcross:"esriSFSDiagonalCross"},constructor:function(b,c,h){b?l.isString(b)?(this.style=b,void 0!==c&&(this.outline=c),void 0!==h&&(this.color=h)):this.style=p.valueOf(this._styles,b.style):(l.mixin(this,a),this.outline=new e(this.outline),this.color=new d(this.color))},setStyle:function(a){this.style=a;return this},getStroke:function(){return this.outline&&this.outline.getStroke()},getFill:function(){var a=this.style;return a===b.STYLE_NULL?null:a===b.STYLE_SOLID?this.color:
l.mixin({},k.defaultPattern,{src:c.toUrl("../images/symbol/sfs/"+a+".png"),width:10,height:10})},getShapeDescriptors:function(){return{defaultShape:{type:"path",path:"M -10,-10 L 10,0 L 10,10 L -10,10 L -10,-10 Z"},fill:this.getFill(),stroke:this.getStroke()}},toJson:function(){return p.fixJson(l.mixin(this.inherited("toJson",arguments),{type:"esriSFS",style:this._styles[this.style]}))}});l.mixin(r,b);r.defaultProps=a;return r})},"esri/symbols/FillSymbol":function(){define("dojo/_base/declare dojo/_base/lang dojo/has ../kernel ./Symbol ./SimpleLineSymbol".split(" "),
function(r,l,d,q,k,m){return r(k,{declaredClass:"esri.symbol.FillSymbol",constructor:function(d){d&&l.isObject(d)&&d.outline&&(this.outline=new m(d.outline))},setOutline:function(d){this.outline=d;return this},toJson:function(){var d=this.inherited("toJson",arguments);this.outline&&(d.outline=this.outline.toJson());return d}})})},"esri/symbols/PictureFillSymbol":function(){define("dojo/_base/declare dojo/_base/lang dojo/sniff dojox/gfx/_base ../kernel ../lang ../urlUtils ./FillSymbol".split(" "),
function(r,l,d,q,k,m,p,h){var e={xoffset:0,yoffset:0,width:12,height:12};r=r(h,{declaredClass:"esri.symbol.PictureFillSymbol",type:"picturefillsymbol",xscale:1,yscale:1,xoffset:0,yoffset:0,constructor:function(c,b,a,g){c?l.isString(c)?(this.url=c,void 0!==b&&(this.outline=b),void 0!==a&&(this.width=a),void 0!==g&&(this.height=g)):(this.xoffset=q.pt2px(c.xoffset),this.yoffset=q.pt2px(c.yoffset),this.width=q.pt2px(c.width),this.height=q.pt2px(c.height),b=c.imageData,9>d("ie")||!b||(a=this.url,this.url=
"data:"+(c.contentType||"image")+";base64,"+b,this.imageData=a)):(l.mixin(this,e),this.width=q.pt2px(this.width),this.height=q.pt2px(this.height))},setWidth:function(c){this.width=c;return this},setHeight:function(c){this.height=c;return this},setOffset:function(c,b){this.xoffset=c;this.yoffset=b;return this},setUrl:function(c){c!==this.url&&(delete this.imageData,delete this.contentType);this.url=c;return this},setXScale:function(c){this.xscale=c;return this},setYScale:function(c){this.yscale=c;
return this},getStroke:function(){return this.outline&&this.outline.getStroke()},getFill:function(){return l.mixin({},q.defaultPattern,{src:this.url,width:this.width*this.xscale,height:this.height*this.yscale,x:this.xoffset,y:this.yoffset})},getShapeDescriptors:function(){return{defaultShape:{type:"path",path:"M -10,-10 L 10,0 L 10,10 L -10,10 L -10,-10 Z"},fill:this.getFill(),stroke:this.getStroke()}},toJson:function(){var c=this.url,b=this.imageData;if(0===c.indexOf("data:"))var a=c,c=b,b=a.indexOf(";base64,")+
8,b=a.substr(b);!l.isString(c)||0!==c.indexOf("/")&&0!==c.indexOf("//")&&0!==c.indexOf("./")&&0!==c.indexOf("../")||(c=p.getAbsoluteUrl(c));var a=q.px2pt(this.width),a=isNaN(a)?void 0:a,g=q.px2pt(this.height),g=isNaN(g)?void 0:g,e=q.px2pt(this.xoffset),e=isNaN(e)?void 0:e,h=q.px2pt(this.yoffset),h=isNaN(h)?void 0:h,c=m.fixJson(l.mixin(this.inherited("toJson",arguments),{type:"esriPFS",url:c,imageData:b,contentType:this.contentType,width:a,height:g,xoffset:e,yoffset:h,xscale:this.xscale,yscale:this.yscale}));
c.imageData||delete c.imageData;return c}});r.defaultProps=e;return r})},"esri/symbols/TextSymbol":function(){define("dojo/_base/declare dojo/_base/lang dojo/has dojox/gfx/_base ../kernel ../lang ../Color ./Symbol ./Font".split(" "),function(r,l,d,q,k,m,p,h,e){var c={type:"textsymbol",x:0,y:0,text:"",rotated:!1,kerning:!0,color:[0,0,0,1],font:q.defaultFont,angle:0,xoffset:0,yoffset:0,horizontalAlignment:"center"},b={start:"left",middle:"center",end:"right"},a={left:"start",center:"middle",right:"end",
justify:"start"},g={top:"text-before-edge",middle:"central",baseline:"alphabetic",bottom:"text-after-edge"},u=document.createElement("canvas");r=r(h,{declaredClass:"esri.symbol.TextSymbol",angle:0,xoffset:0,yoffset:0,constructor:function(a,b,f){l.mixin(this,c);this.font=new e(this.font);this.color=new p(this.color);a&&(l.isObject(a)?(l.mixin(this,a),this.color&&m.isDefined(this.color[0])&&(this.color=p.toDojoColor(this.color)),this.type="textsymbol",this.font=new e(this.font),this.xoffset=q.pt2px(this.xoffset),
this.yoffset=q.pt2px(this.yoffset),this.angle&&(this.angle*=-1),this.haloSize&&(this.haloSize=q.pt2px(this.haloSize)),this.haloColor&&(this.haloColor=p.toDojoColor(this.haloColor))):(this.text=a,b&&(this.font=b),f&&(this.color=f)));this.setAlign(this.align||this.getSVGAlign())},setFont:function(a){this.font=a;return this},setSize:function(a){this.font.size=a;return this},setAngle:function(a){this.angle=a;return this},setOffset:function(a,b){this.xoffset=a;this.yoffset=b;return this},setHaloColor:function(a){this.haloColor=
a;return this},setHaloSize:function(a){this.haloSize=a;return this},setAlign:function(a){this.align=a;this.setHorizontalAlignment(a&&b[a.toLowerCase()]||"center");return this},setHorizontalAlignment:function(a){this.horizontalAlignment=a;return this},getSVGAlign:function(){var b=this.horizontalAlignment;return b=b&&a[b.toLowerCase()]||"middle"},setVerticalAlignment:function(a){this.verticalAlignment=a;return this},getSVGBaseline:function(){var a=this.verticalAlignment;return a&&g[a.toLowerCase()]||
"alphabetic"},getSVGBaselineShift:function(){return"bottom"===this.verticalAlignment?"super":null},setDecoration:function(a){this.decoration=a;this.font||this.setFont(new e);this.font.setDecoration(a);return this},setRotated:function(a){this.rotated=a;return this},setKerning:function(a){this.kerning=a;return this},setText:function(a){this.text=a;return this},getStroke:function(){return null},getFill:function(){return this.color},getWidth:function(){var a=u&&u.getContext&&u.getContext("2d");if(a){var b=
this.font;a.font=(b.style?b.style:q.defaultFont.style)+" "+(b.weight?b.weight:q.defaultFont.weight)+" "+(b.size?b.size:q.defaultFont.size)+"px "+(b.family?b.family:q.defaultFont.family);return a.measureText(this.text).width}var a=this.getHeight(),b=0,c,g;for(c=0;c<this.text.length;c++)g=this.text.charAt(c),b=g==g.toUpperCase()?b+.7*a:b+.5*a;return b},getHeight:function(){return q.normalizedLength(this.font.size)},getShapeDescriptors:function(){var a=this.font,b;a&&(b={},a.size&&(b.size=a.size),a.style&&
(b.style=a.style),a.variant&&(b.variant=a.variant),a.decoration&&(b.decoration=a.decoration),a.weight&&(b.weight=a.weight),a.family&&(b.family=a.family));return{defaultShape:{type:"text",text:this.text,x:0,y:this.getHeight()/4,align:"middle",decoration:this.decoration||a&&a.decoration,rotated:this.rotated,kerning:this.kerning},font:b,fill:this.getFill(),stroke:this.getStroke()}},toJson:function(){var a=q.px2pt(this.xoffset),b=q.px2pt(this.yoffset),c=q.px2pt(this.haloSize),a=isNaN(a)?void 0:a,b=isNaN(b)?
void 0:b,c=isNaN(c)?void 0:c;return m.fixJson(l.mixin(this.inherited("toJson",arguments),{type:"esriTS",backgroundColor:this.backgroundColor,borderLineColor:this.borderLineColor,borderLineSize:this.borderLineSize,haloSize:c,haloColor:this.haloColor&&p.toJsonColor(this.haloColor),verticalAlignment:this.verticalAlignment,horizontalAlignment:this.horizontalAlignment,rightToLeft:this.rightToLeft,width:this.width,angle:this.angle&&-1*this.angle,xoffset:a,yoffset:b,text:this.text,rotated:this.rotated,kerning:this.kerning,
font:this.font.toJson()}))}});l.mixin(r,{ALIGN_START:"start",ALIGN_MIDDLE:"middle",ALIGN_END:"end",DECORATION_NONE:"none",DECORATION_UNDERLINE:"underline",DECORATION_OVERLINE:"overline",DECORATION_LINETHROUGH:"line-through"});r.defaultProps=c;return r})},"esri/symbols/Font":function(){define("dojo/_base/declare dojo/_base/lang dojo/sniff dojox/gfx/_base ../kernel ../lang".split(" "),function(r,l,d,q,k,m){r=r(null,{declaredClass:"esri.symbol.Font",constructor:function(k,h,e,c,b){k?l.isObject(k)?l.mixin(this,
k):(this.size=k,parseFloat(this.size)==this.size&&(this.size+="px"),void 0!==h&&(this.style=h),void 0!==e&&(this.variant=e),void 0!==c&&(this.weight=c),void 0!==b&&(this.family=b)):l.mixin(this,q.defaultFont);parseFloat(this.size)==this.size&&(this.size+="pt");9>d("ie")&&this.size&&l.isString(this.size)&&-1<this.size.indexOf("em")&&(this.size=q.pt2px(12*parseFloat(this.size))+"px");this.size=this._convert2PxSize(this.size)},setSize:function(d){this.size=this._convert2PxSize(d);return this},_convert2PxSize:function(d){var h;
parseFloat(d)==d?h=d:l.isString(d)&&(-1<d.indexOf("pt")?h=q.pt2px(parseFloat(d)):-1<d.indexOf("px")?h=parseFloat(d):-1<d.indexOf("em")?h=q.pt2px(12*parseFloat(d)):-1<d.indexOf("%")&&(h=q.pt2px(.12*parseFloat(d))));return h},setStyle:function(d){this.style=d;return this},setVariant:function(d){this.variant=d;return this},setWeight:function(d){this.weight=d;return this},setFamily:function(d){this.family=d;return this},setDecoration:function(d){this.decoration=d;return this},toJson:function(){return m.fixJson({size:q.px2pt(this.size),
style:this.style,variant:this.variant,decoration:this.decoration,weight:this.weight,family:this.family})}});l.mixin(r,{STYLE_NORMAL:"normal",STYLE_ITALIC:"italic",STYLE_OBLIQUE:"oblique",VARIANT_NORMAL:"normal",VARIANT_SMALLCAPS:"small-caps",WEIGHT_NORMAL:"normal",WEIGHT_BOLD:"bold",WEIGHT_BOLDER:"bolder",WEIGHT_LIGHTER:"lighter"});return r})},"esri/tasks/query":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/json dojo/has ../kernel ../geometry/jsonUtils ./SpatialRelationship require require require".split(" "),
function(r,l,d,q,k,m,p,h){var e=r(null,{declaredClass:"esri.tasks.Query",constructor:function(){this.spatialRelationship=e.SPATIAL_REL_INTERSECTS},text:null,where:"",geometry:null,groupByFieldsForStatistics:null,objectIds:null,returnGeometry:!1,returnDistinctValues:!1,orderByFields:null,outSpatialReference:null,outFields:null,outStatistics:null,timeExtent:null,relationParam:null,pixelSize:null,distance:null,units:null,resultOffset:null,resultRecordCount:null,resultType:null,sqlFormat:null,quantizationParameters:null,
_units:{meters:"esriSRUnit_Meter",kilometers:"esriSRUnit_Kilometer",feet:"esriSRUnit_Foot",miles:"esriSRUnit_StatuteMile","nautical-miles":"esriSRUnit_NauticalMile","us-nautical-miles":"esriSRUnit_USNauticalMile"},toJson:function(c){var b={text:this.text,where:this.where,returnGeometry:this.returnGeometry,spatialRel:this.spatialRelationship,maxAllowableOffset:this.maxAllowableOffset,geometryPrecision:this.geometryPrecision,sqlFormat:this.sqlFormat},a=c&&c.geometry||this.geometry,g=this.objectIds,
h=this.outFields,n=this.outSpatialReference,t=this.groupByFieldsForStatistics,f=this.orderByFields,k=this.outStatistics;c=this.distance;a&&(b.geometry=a,b.geometryType=p.getJsonType(a),b.inSR=a.spatialReference.wkid||q.toJson(a.spatialReference.toJson()));g&&(b.objectIds=g.join(","));h&&(b.outFields=h.join(","));this.returnDistinctValues&&(b.returnDistinctValues=!0);t&&(b.groupByFieldsForStatistics=t.join(","));f&&(b.orderByFields=f.join(","));if(k){var m=[];d.forEach(k,function(a){m.push(a.toJson())});
b.outStatistics=q.toJson(m)}n?b.outSR=n.wkid||q.toJson(n.toJson()):a&&(b.outSR=a.spatialReference.wkid||q.toJson(a.spatialReference.toJson()));a=this.timeExtent;b.time=a?a.toJson().join(","):null;(a=this.relationParam)&&this.spatialRelationship===e.SPATIAL_REL_RELATION&&(b.relationParam=a);c&&(b.distance=this.distance,this.hasOwnProperty("units")?b.units=this._units[this.units]||this._units.meters:(console.warn("esri/tasks/query::no distance unit provided, defaulting to meters"),b.units=this._units.meters));
this.hasOwnProperty("start")&&(b.resultOffset=this.start,b.resultRecordCount=10,""===b.where&&(b.where="1\x3d1"));this.hasOwnProperty("num")&&(b.resultRecordCount=this.num);b.resultType=this.resultType;b.pixelSize=this.pixelSize?q.toJson(this.pixelSize.toJson()):null;b.multipatchOption=this.multipatchOption;this.quantizationParameters&&(b.quantizationParameters=q.toJson(this.quantizationParameters));b._ts=this._ts;return b}});l.mixin(e,h);return e})},"esri/tasks/SpatialRelationship":function(){define(["dojo/_base/lang",
"dojo/has","../kernel"],function(r,l,d){return{SPATIAL_REL_INTERSECTS:"esriSpatialRelIntersects",SPATIAL_REL_CONTAINS:"esriSpatialRelContains",SPATIAL_REL_CROSSES:"esriSpatialRelCrosses",SPATIAL_REL_ENVELOPEINTERSECTS:"esriSpatialRelEnvelopeIntersects",SPATIAL_REL_INDEXINTERSECTS:"esriSpatialRelIndexIntersects",SPATIAL_REL_OVERLAPS:"esriSpatialRelOverlaps",SPATIAL_REL_TOUCHES:"esriSpatialRelTouches",SPATIAL_REL_WITHIN:"esriSpatialRelWithin",SPATIAL_REL_RELATION:"esriSpatialRelRelation"}})},"esri/plugins/popupManager":function(){define(["../PopupManager"],
function(r){return{add:function(l,d){l.popupManager||(l.popupManager=new r(d),l.popupManager.setMap(l))},remove:function(l){var d=l.popupManager;d&&(d.unsetMap(),l.popupManager=void 0)}}})},"esri/PopupManager":function(){define("./geometry/Extent ./geometry/ScreenPoint ./kernel ./layerUtils ./tasks/query dijit/registry dojo/_base/array dojo/_base/declare dojo/_base/Deferred dojo/_base/lang dojo/has dojo/on dojo/promise/all dojo/Stateful require".split(" "),function(r,l,d,q,k,m,p,h,e,c,b,a,g,u,n){var t;
return h(u,{declaredClass:"esri.PopupManager",enabled:!1,map:null,_mapClickHandle:null,_featureLayersCache:{},constructor:function(a){this._mapClickHandler=c.hitch(this,this._mapClickHandler)},setMap:function(a){if(this.map)if(a!==this.map)this.unsetMap();else return;this.map=a;this._setupClickHandler()},unsetMap:function(){this.map&&(this.map=null);this._mapClickHandle&&(this._mapClickHandle.remove(),this._mapClickHandle=null)},getMapLayer:function(a){var b;if(a&&(b=a.getLayer())&&(a=b.id,this._featureLayersCache[a])){var c=
a.lastIndexOf("_");-1<c&&(a=a.substring(0,c),b=this.map.getLayer(a))}return b},_enabledSetter:function(a){this.enabled=a;this._setupClickHandler()},_setupClickHandler:function(){this._mapClickHandle&&(this._mapClickHandle.remove(),this._mapClickHandle=null);this.enabled&&this.map&&(this._mapClickHandle=this.map.on("click",this._mapClickHandler))},_mapClickHandler:function(a){var b=this.map.infoWindow,c=a.graphic;b&&this.map.loaded&&(b.clearFeatures&&b.setFeatures?this._showPopup(a):c&&c.getInfoTemplate()&&
this._showInfoWindow(c,a.mapPoint))},_showPopup:function(a){var b=this.map,c=b.infoWindow,f=this,g=[],h=[b.graphics].concat(p.map(b.graphicsLayerIds,b.getLayer,b));p.forEach(h,function(a){a&&a.loaded&&a.infoTemplate&&!a.suspended&&g.push(a)});var d=[];p.forEach(b.layerIds,function(a){(a=b.getLayer(a))&&a.loaded&&!a.suspended&&(f._isImageServiceLayer(a)&&a.infoTemplate?g.push(a):"esri.layers.WMSLayer"===a.declaredClass&&a.getFeatureInfoURL?g.push(a):"esri.layers.ArcGISDynamicMapServiceLayer"!==a.declaredClass&&
"esri.layers.ArcGISTiledMapServiceLayer"!==a.declaredClass||!a.infoTemplates||d.push(a))});this._getSubLayerFeatureLayers(d).then(function(h){g=g.concat(h);var d=null;a.graphic&&a.graphic.getInfoTemplate()&&!f._isImageServiceLayer(a.graphic._layer)&&(d=a.graphic);if(g.length||d){var n=f._calculateClickTolerance(g),u=a.screenPoint;h=b.toMap(new l(u.x-n,u.y+n));var n=b.toMap(new l(u.x+n,u.y-n)),t=new r(h.x,h.y,n.x,n.y,b.spatialReference);if(t=t.intersects(b.extent)){var m=new k,v=!!d,x=!0;h=p.map(g,
function(c){m.timeExtent=c.useMapTime?b.timeExtent:null;var g=f._isAggregationEnabled(c);c=g?c.getAggregationLayer():c;var h;if(f._isImageServiceLayer(c))m.geometry=a.mapPoint,x=!1,h=c.queryVisibleRasters(m,{rasterAttributeTableFieldPrefix:"Raster.",returnDomainValues:!0}),h.addCallback(function(){var a=c.getVisibleRasters();v=v||0<a.length;return a});else if("esri.layers.WMSLayer"===c.declaredClass){h=new e;var n=c._getPopupGraphic(b,a.screenPoint);n?(h.resolve([n]),v=!0):h.resolve([])}else f._featureLayersCache[c.id]||
"function"===typeof c.queryFeatures&&(0===c.currentMode||1===c.currentMode)?(m.geometry=t,h=c.queryFeatures(m),h.addCallback(function(a){a=a.features;a=p.filter(a,function(a){return a.visible});v=v||0<a.length;return a})):(h=new e,n=p.filter(c.graphics,function(a){return a&&a.visible&&t.intersects(a.geometry)}),g&&f._isParentLayer(c,d)&&(g=f._findGraphicById(n,d,"clusterId"))&&(d=g),v=v||0<n.length,h.resolve(n));return h});d&&(n=new e,n.resolve([d]),h.unshift(n));p.some(h,function(a){return!a.isFulfilled()})||
v?(c.setFeatures(h),c.show(a.mapPoint,{closestFirst:x})):(c.hide(),c.clearFeatures())}}})},_getSubLayerFeatureLayers:function(b,c){var f=c||new e,h=[],d=b.length,u=Math.floor(this.map.extent.getWidth()/this.map.width),k=this.map.getScale(),m=!1,v=this,l=0;a:for(;l<d;l++){var r=b[l],F=r.dynamicLayerInfos||r.layerInfos;if(F){var G=null;r._params&&(r._params.layers||r._params.dynamicLayers)&&(G=r.visibleLayers);for(var G=q._getVisibleLayers(F,G),J=q._getLayersForScale(k,F),N=F.length,M=0;M<N;M++){var L=
F[M],K=L.id,W=r.infoTemplates[K];if(!L.subLayerIds&&W&&W.infoTemplate&&-1<p.indexOf(G,K)&&-1<p.indexOf(J,K)){if(!t){m=!0;break a}var R=r.id+"_"+K,ba=this._featureLayersCache[R];ba&&ba.loadError||(ba||((ba=W.layerUrl)||(ba=L.source?this._getLayerUrl(r.url,"/dynamicLayer"):this._getLayerUrl(r.url,K)),ba=new t(ba,{id:R,drawMode:!1,mode:t.MODE_SELECTION,outFields:this._getOutFields(W.infoTemplate),resourceInfo:W.resourceInfo,source:L.source}),this._featureLayersCache[R]=ba),ba.setDefinitionExpression(r.layerDefinitions&&
r.layerDefinitions[K]),ba.setGDBVersion(r.gdbVersion),ba.setInfoTemplate(W.infoTemplate),ba.setMaxAllowableOffset(u),ba.setUseMapTime(!!r.useMapTime),r.layerDrawingOptions&&r.layerDrawingOptions[K]&&r.layerDrawingOptions[K].renderer&&ba.setRenderer(r.layerDrawingOptions[K].renderer),h.push(ba))}}}}if(m){var O=new e;n(["./layers/FeatureLayer"],function(a){t=a;O.resolve()});O.then(function(){v._getSubLayerFeatureLayers(b,f)})}else{var Q=[];p.forEach(h,function(b){if(!b.loaded){var c=new e;a.once(b,
"load, error",function(){c.resolve()});Q.push(c.promise)}});Q.length?g(Q).then(function(){h=p.filter(h,function(a){return!a.loadError&&a.isVisibleAtScale(k)});f.resolve(h)}):(h=p.filter(h,function(a){return a.isVisibleAtScale(k)}),f.resolve(h))}return f.promise},_getLayerUrl:function(a,b){var c=a.indexOf("?");return-1===c?a+"/"+b:a.substring(0,c)+"/"+b+a.substring(c)},_getOutFields:function(a){var b;a.info&&"esri.dijit.PopupTemplate"===a.declaredClass?(b=[],p.forEach(a.info.fieldInfos,function(a){var c=
a.fieldName&&a.fieldName.toLowerCase();c&&"shape"!==c&&0!==c.indexOf("relationships/")&&b.push(a.fieldName)})):b=["*"];return b},_calculateClickTolerance:function(a){var b=6,c,f;p.forEach(a,function(a){if(c=a.renderer)"esri.renderer.SimpleRenderer"===c.declaredClass?((f=c.symbol)&&f.xoffset&&(b=Math.max(b,Math.abs(f.xoffset))),f&&f.yoffset&&(b=Math.max(b,Math.abs(f.yoffset)))):"esri.renderer.UniqueValueRenderer"!==c.declaredClass&&"esri.renderer.ClassBreaksRenderer"!==c.declaredClass||p.forEach(c.infos,
function(a){(f=a.symbol)&&f.xoffset&&(b=Math.max(b,Math.abs(f.xoffset)));f&&f.yoffset&&(b=Math.max(b,Math.abs(f.yoffset)))})});return b},_showInfoWindow:function(a,b){var f=this.map.infoWindow,g=a.geometry,g=g&&"point"===g.type?g:b,e=a.getContent();f.setTitle(a.getTitle());if(e&&c.isString(e.id)){var h=m.byId(e.id);h&&h.set&&/_PopupRenderer/.test(h.declaredClass)&&h.set("showTitle",!1)}f.setContent(e);f.show(g)},_findGraphicById:function(a,b,c){var f,g=(b=b.attributes)&&b[c];p.some(a,function(a){var b=
a.attributes;b&&b[c]===g&&(f=a);return!!f});return f},_isParentLayer:function(a,b){var c=b&&b.getLayer();return a&&c===a},_isAggregationEnabled:function(a){return a&&a.isAggregationEnabled&&a.isAggregationEnabled()},_isImageServiceLayer:function(a){return"esri.layers.ArcGISImageServiceLayer"===a.declaredClass||"esri.layers.ArcGISImageServiceVectorLayer"===a.declaredClass}})})},"esri/layerUtils":function(){define(["dojo/_base/lang","dojo/_base/array","dojo/_base/json","dojo/has","./kernel"],function(r,
l,d,q,k){return{_serializeLayerDefinitions:function(k,p){var h=[],e=/[:;]/;if(k&&(l.forEach(k,function(b,a){b&&(h.push([a,b]),!p&&e.test(b)&&(p=!0))}),0<h.length)){var c;p?(c={},l.forEach(h,function(b){c[b[0]]=b[1]}),c=d.toJson(c)):(c=[],l.forEach(h,function(b){c.push(b[0]+":"+b[1])}),c=c.join(";"));return c}return null},_serializeTimeOptions:function(k,p){if(k){var h=[];l.forEach(k,function(e,c){if(e){var b=e.toJson();p&&-1!==l.indexOf(p,c)&&(b.useTime=!1);h.push('"'+c+'":'+d.toJson(b))}});if(h.length)return"{"+
h.join(",")+"}"}},_getVisibleLayers:function(d,k){var h=[],e,c,b;if(!d)return h;if(k)for(h=k.concat(),b=0;b<d.length;b++)e=d[b],c=l.indexOf(d,e.id),e.subLayerIds&&-1<c&&(h.splice(c,1),h=h.concat(e.subLayerIds));else h=this._getDefaultVisibleLayers(d);return h},_getDefaultVisibleLayers:function(d){var k=[],h;if(!d)return k;for(h=0;h<d.length;h++)0<=d[h].parentLayerId&&-1===l.indexOf(k,d[h].parentLayerId)&&l.some(d,function(e){return e.id===d[h].parentLayerId})||d[h].defaultVisibility&&k.push(d[h].id);
return k},_getLayersForScale:function(d,k){var h=[];if(0<d&&k){var e;for(e=0;e<k.length;e++)if(!(0<=k[e].parentLayerId&&-1===l.indexOf(h,k[e].parentLayerId)&&l.some(k,function(a){return a.id===k[e].parentLayerId}))&&0<=k[e].id){var c=!0,b=k[e].maxScale,a=k[e].minScale;if(0<b||0<a)0<b&&0<a?c=b<=d&&d<=a:0<b?c=b<=d:0<a&&(c=d<=a);c&&h.push(k[e].id)}}return h}}})},"dojo/uacss":function(){define(["./dom-geometry","./_base/lang","./domReady","./sniff","./_base/window"],function(r,l,d,q,k){var m=k.doc.documentElement;
k=q("ie");var p=q("trident"),h=q("opera"),e=Math.floor,c=q("ff"),b=r.boxModel.replace(/-/,""),h={dj_quirks:q("quirks"),dj_opera:h,dj_khtml:q("khtml"),dj_webkit:q("webkit"),dj_safari:q("safari"),dj_chrome:q("chrome"),dj_edge:q("edge"),dj_gecko:q("mozilla"),dj_ios:q("ios"),dj_android:q("android")};k&&(h.dj_ie=!0,h["dj_ie"+e(k)]=!0,h.dj_iequirks=q("quirks"));p&&(h.dj_trident=!0,h["dj_trident"+e(p)]=!0);c&&(h["dj_ff"+e(c)]=!0);h["dj_"+b]=!0;var a="",g;for(g in h)h[g]&&(a+=g+" ");m.className=l.trim(m.className+
" "+a);d(function(){if(!r.isBodyLtr()){var b="dj_rtl dijitRtl "+a.replace(/ /g,"-rtl ");m.className=l.trim(m.className+" "+b+"dj_rtl dijitRtl "+a.replace(/ /g,"-rtl "))}});return q})},"esri/MapNavigationManager":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/connect dojo/_base/event dojo/mouse dojo/keys dijit/focus ./kernel ./MouseEvents ./TouchEvents ./PointerEvents ./config ./sniff ./lang ./fx ./graphic ./tileUtils ./geometry/ScreenPoint ./geometry/Extent ./geometry/Rect ./geometry/mathUtils ./symbols/SimpleFillSymbol".split(" "),
function(r,l,d,q,k,m,p,h,e,c,b,a,g,u,n,t,f,v,x,w,z,A,y){var B=q.connect,C=q.disconnect,E=u("chrome"),D=u("safari"),F=[p.NUMPAD_PLUS,61,187,p.NUMPAD_MINUS,173,189,p.UP_ARROW,p.NUMPAD_8,p.RIGHT_ARROW,p.NUMPAD_6,p.DOWN_ARROW,p.NUMPAD_2,p.LEFT_ARROW,p.NUMPAD_4,p.PAGE_UP,p.NUMPAD_9,p.PAGE_DOWN,p.NUMPAD_3,p.END,p.NUMPAD_1,p.HOME,p.NUMPAD_7];return r(null,{declaredClass:"esri.MapNavigationManager",eventModel:"",constructor:function(e,h){this.map=e;l.mixin(this,h);var d=e.__container;u("esri-pointer")?(this.pointerEvents=
new a(d,{map:e}),this.eventModel="pointer"):u("esri-touch")?(u("ios")||(this.mouseEvents=new c(d,{map:e})),this.touchEvents=new b(d,{map:e,mouseEvents:this.mouseEvents}),this.eventModel="touch"):(this.mouseEvents=new c(d,{map:e}),this.eventModel="mouse");this._zoomRect=new f(null,new y(g.defaults.map.zoomSymbol));this._keyDx=this._keyDy=0;this._adjustPinch=l.hitch(this,this._adjustPinch);this._adjustPinchEnd=l.hitch(this,this._adjustPinchEnd)},_panInit:function(a){var b=this.mouseEvents;m.isLeft(a)&&
this.map.isPan&&!a.shiftKey&&(this._dragOrigin=new x(0,0),l.mixin(this._dragOrigin,a.screenPoint),C(this._panStartHandle),C(this._panHandle),C(this._panEndHandle),this._panStartHandle=B(b,"onMouseDragStart",this,this._panStart),this._panHandle=B(b,"onMouseDrag",this,this._pan),this._panEndHandle=B(b,"onMouseUp",this,this._panEnd),E||D)&&(a.preventDefault(),h.curNode&&h.curNode.blur())},_panStart:function(a){this.map.setCursor("move");this.map.__panStart(a.screenPoint.x,a.screenPoint.y)},_pan:function(a){this.map.__pan(a.screenPoint.x-
this._dragOrigin.x,a.screenPoint.y-this._dragOrigin.y)},_panEnd:function(a){C(this._panStartHandle);C(this._panHandle);C(this._panEndHandle);this._panStartHandle=this._panHandle=this._panEndHandle=null;var b=this.map;b.__panning&&(b.__panEnd(a.screenPoint.x-this._dragOrigin.x,a.screenPoint.y-this._dragOrigin.y),b.resetMapCursor())},_zoomInit:function(a){var b=this.map,c=this.pointerEvents||this.mouseEvents;(m.isLeft(a)||a.pointerType)&&b.isRubberBandZoom&&a.shiftKey&&(b.setCursor("crosshair"),this._dragOrigin=
l.mixin({},a.screenPoint),this._zoomDir=a.ctrlKey||a.metaKey?-1:1,this.pointerEvents?(this._zoomHandle=B(c,"onSwipeMove",this,this._zoom),this._zoomEndHandle=B(c,"onSwipeEnd",this,this._zoomEnd)):(this._zoomHandle=B(c,"onMouseDrag",this,this._zoom),this._zoomEndHandle=B(c,"onMouseUp",this,this._zoomEnd)),E&&a.preventDefault())},_zoom:function(a){var b=this.map,c=this._normalizeRect(a).offset(b.__visibleRect.x,b.__visibleRect.y);a=b.graphics;var f=this._zoomRect;f.geometry||b.setCursor("crosshair");
f.geometry&&a.remove(f,!0);var g=b.toMap(new x(c.x,c.y)),c=b.toMap(new x(c.x+c.width,c.y+c.height)),c=new z(g.x,g.y,c.x-g.x,g.y-c.y,b.spatialReference);c._originOnly=!0;f.setGeometry(c);a.add(f,!0)},_zoomEnd:function(a){var b=this._zoomRect,c=this.map,f=c.extent,g=c.spatialReference;C(this._zoomHandle);C(this._zoomEndHandle);this._zoomHandle=this._zoomEndHandle=null;if(c._canZoom(this._zoomDir)&&b.getDojoShape()){c.graphics.remove(b);b.geometry=null;a=this._normalizeRect(a);a.x+=c.__visibleRect.x;
a.y+=c.__visibleRect.y;if(-1===this._zoomDir){var e=f.getWidth();a=(e*c.width/a.width-e)/2;g=new w(f.xmin-a,f.ymin-a,f.xmax+a,f.ymax+a,g)}else f=c.toMap({x:a.x,y:a.y+a.height}),a=c.toMap({x:a.x+a.width,y:a.y}),g=new w(f.x,f.y,a.x,a.y,g);c._extentUtil(null,null,g)}b.getDojoShape()&&c.graphics.remove(b,!0);this._zoomDir=0;c.resetMapCursor()},_wheelZoom:function(a,b){var c=this.map;if(!b){if(c.smartNavigation&&!a.shiftKey&&!c._isPanningOrZooming()){c.disableScrollWheelZoom();this._setScrollWheelPan(!0);
this._wheelPan(a);return}var f=a.timeStamp;if(!n.isDefined(f)||0>=f)f=(new Date).getTime();if(100>(this._mwts?f-this._mwts:f))return;this._mwts=f}c._canZoom(a.value)&&c._extentUtil({numLevels:a.value,mapAnchor:a.mapPoint,screenAnchor:a.screenPoint})},_wheelPan:function(a){var b=this.map;if(a.shiftKey&&!b._isPanningOrZooming())this._setScrollWheelPan(!1),b.enableScrollWheelZoom(),this._wheelZoom(a);else{var c=0,f=0;u("ff")?a.axis===a.HORIZONTAL_AXIS?c=-a.detail:f=-a.detail:(c=a.wheelDeltaX,f=a.wheelDeltaY);
b.translate(c,f)}},_setScrollWheelPan:function(a){this.map.isScrollWheelPan=a;this.mouseEvents.enableMouseWheel(a);C(this._mwMacHandle);this._mwMacHandle=null;a&&(this._mwMacHandle=B(this.mouseEvents,"onMouseWheel",this,this._wheelPan))},_recenter:function(a){a.shiftKey&&!this.map._isPanningOrZooming()&&this.map.centerAt(a.mapPoint)},_recenterZoom:function(a){a.shiftKey&&!this.map._isPanningOrZooming()&&(a.value=a.ctrlKey||a.metaKey?-1:1,this._wheelZoom(a,!0))},_dblClickZoom:function(a){this.map._isPanningOrZooming()||
(a.value=1,this._wheelZoom(a,!0))},_twoFingerTap:function(a){this.map._isPanningOrZooming()||(a.value=-1,this._wheelZoom(a,!0))},_keyDown:function(a){var b=a.keyCode,c=this.map;if(-1!==d.indexOf(F,b)){if(b===p.NUMPAD_PLUS||61===b||187===b)c._extentUtil({numLevels:1});else if(b===p.NUMPAD_MINUS||173===b||189===b)c._extentUtil({numLevels:-1});else{c.__panning||c.__panStart(0,0);switch(b){case p.UP_ARROW:case p.NUMPAD_8:this._keyDy+=10;break;case p.RIGHT_ARROW:case p.NUMPAD_6:this._keyDx-=10;break;case p.DOWN_ARROW:case p.NUMPAD_2:this._keyDy-=
10;break;case p.LEFT_ARROW:case p.NUMPAD_4:this._keyDx+=10;break;case p.PAGE_UP:case p.NUMPAD_9:this._keyDx-=10;this._keyDy+=10;break;case p.PAGE_DOWN:case p.NUMPAD_3:this._keyDx-=10;this._keyDy-=10;break;case p.END:case p.NUMPAD_1:this._keyDx+=10;this._keyDy-=10;break;case p.HOME:case p.NUMPAD_7:this._keyDx+=10;this._keyDy+=10;break;default:return}c.__pan(this._keyDx,this._keyDy)}k.stop(a)}},_keyEnd:function(a){var b=this.map;b.__panning&&a.keyCode!==p.SHIFT&&(b.__panEnd(this._keyDx,this._keyDy),
this._keyDx=this._keyDy=0)},_swipeInit:function(a){var b=this.map,b=b._zoomAnim||b._panAnim;if(a.shiftKey)return!1;b&&b._active&&(b.stop(),b._fire("onEnd",[b.node]));this._dragOrigin=new x(0,0);l.mixin(this._dragOrigin,a.screenPoint);C(this._swipeHandle);C(this._swipeEndHandle);this._swipeHandle=B(this.touchEvents||this.pointerEvents,"onSwipeMove",this,this._swipe);this._swipeEndHandle=B(this.touchEvents||this.pointerEvents,"onSwipeEnd",this,this._swipeEnd)},_swipe:function(a){var b=this.map;b.__panning?
(this._panX=a.screenPoint.x,this._panY=a.screenPoint.y,b.__pan(a.screenPoint.x-this._dragOrigin.x,a.screenPoint.y-this._dragOrigin.y)):(b.setCursor("move"),b.__panStart(a.screenPoint.x,a.screenPoint.y))},_swipeEnd:function(a){C(this._swipeHandle);C(this._swipeEndHandle);this._swipeHandle=this._swipeEndHandle=null;var b=this.map;b.__panning&&(b.resetMapCursor(),b.__panEnd(a.screenPoint.x-this._dragOrigin.x,a.screenPoint.y-this._dragOrigin.y))},_pinchInit:function(a){var b=this.map,c=b._zoomAnim||b._panAnim;
c&&c._active?(c.stop(),c._fire("onEnd",[c.node])):b.__panning&&(a.screenPoint=new x(this._panX,this._panY),a.mapPoint=b.toMap(a.screenPoint),this._swipeEnd(a));C(this._pinchHandle);C(this._pinchEndHandle);this._pinchHandle=B(this.touchEvents||this.pointerEvents,"onPinchMove",this,this._pinch);this._pinchEndHandle=B(this.touchEvents||this.pointerEvents,"onPinchEnd",this,this._pinchEnd)},_pinch:function(a){var b=this.map;if(a.screenPoints){this.currLength=A.getLength(a.screenPoints[0],a.screenPoints[1]);
var c;b.__zooming?(c=this.currLength/this._length,this._zoomStartExtent=this.__scaleExtent(b.extent,c,this._dragOrigin),b.__zoom(this._zoomStartExtent,c,this._dragOrigin)):(this._dragOrigin=new x((a.screenPoints[0].x+a.screenPoints[1].x)/2,(a.screenPoints[0].y+a.screenPoints[1].y)/2),this._length=this.currLength,b.__zoomStart(b.extent,this._dragOrigin));this._pinchScale=c;b._fireOnScale(this.currLength/this._length,this._dragOrigin,!0)}},_pinchEnd:function(a){a=this.map;C(this._pinchHandle);C(this._pinchEndHandle);
this._pinchHandle=this._pinchEndHandle=null;this._pinchScale=0;if(a.__zooming&&null===a._zoomAnim){var b=this.currLength/this._length,c=a.extent.getWidth();this._zoomAnimAnchor=a.toMap(this._dragOrigin);this._zoomStartExtent=this.__scaleExtent(a.extent,1/b,this._zoomAnimAnchor);if(a.__tileInfo){var f=v.getCandidateTileInfo(a,a.__tileInfo,this._zoomStartExtent),e=a.__getExtentForLevel(f.lod.level,this._zoomAnimAnchor),h=a.getMinZoom(),d=a.getMaxZoom(),n=e.extent,e=e.lod,u=c/n.getWidth(),k=f.lod.level;
1>b?u>b&&k--:u<b&&k++;k<h?k=h:k>d&&(k=d);k!==f.lod.level&&(e=a.__getExtentForLevel(k,this._zoomAnimAnchor),n=e.extent,e=e.lod);this._zoomEndExtent=n;this._zoomEndLod=e;a._zoomAnim=t.animateRange({range:{start:c/this._zoomStartExtent.getWidth(),end:u},duration:g.defaults.map.zoomDuration,rate:g.defaults.map.zoomRate,onAnimate:this._adjustPinch,onEnd:this._adjustPinchEnd});a._zoomAnim.play();a._fireOnScale(a.extent.getWidth()/this._zoomEndExtent.getWidth(),this._dragOrigin)}else this._zoomEndExtent=
this._zoomStartExtent,a._fireOnScale(a.extent.getWidth()/this._zoomEndExtent.getWidth(),this._dragOrigin),this._adjustPinchEnd()}},_adjustPinch:function(a){var b=this.__scaleExtent(this.map.extent,a,this._zoomAnimAnchor);this.map.__zoom(b,a,this._dragOrigin)},_adjustPinchEnd:function(){var a=this.map,b=a.extent.getWidth()/this._zoomEndExtent.getWidth(),c=this.__scaleExtent(a.extent,1/b,this._zoomAnimAnchor),f=this._dragOrigin,g=this._zoomEndLod;this._zoomStartExtent=this._zoomEndExtent=this._zoomEndLod=
this._dragOrigin=a._zoomAnim=this._zoomAnimAnchor=null;a.__zoomEnd(c,b,f,g,!0)},__scaleExtent:function(a,b,c){c=c||a.getCenter();b=a.expand(b);var f=a.xmin-(b.getWidth()-a.getWidth())*(c.x-a.xmin)/a.getWidth();c=a.ymax-(b.getHeight()-a.getHeight())*(c.y-a.ymax)/a.getHeight();return new w(f,c-b.getHeight(),f+b.getWidth(),c,a.spatialReference)},_normalizeRect:function(a){a=a.screenPoint;var b=this._dragOrigin.x,c=this._dragOrigin.y;a=new z((a.x<b?a.x:b)-this.map.__visibleRect.x,(a.y<c?a.y:c)-this.map.__visibleRect.y,
Math.abs(a.x-b),Math.abs(a.y-c));delete a.spatialReference;0===a.width&&(a.width=1);0===a.height&&(a.height=1);return a},setImmediateClick:function(a){switch(this.eventModel){case "mouse":this.mouseEvents.setImmediateClick(a);break;case "touch":this.touchEvents.setImmediateTap(a);this.mouseEvents&&this.mouseEvents.setImmediateClick(a);break;case "pointer":this.pointerEvents.setImmediateTap(a)}},enablePan:function(){this.disablePan();switch(this.eventModel){case "mouse":this._panInitHandle=B(this.mouseEvents,
"onMouseDown",this,this._panInit);break;case "touch":this._panInitHandle=B(this.mouseEvents,"onMouseDown",this,this._panInit);this._swipeInitHandle=B(this.touchEvents,"onSwipeStart",this,this._swipeInit);break;case "pointer":this._swipeInitHandle=B(this.pointerEvents,"onSwipeStart",this,this._swipeInit)}},disablePan:function(){C(this._panInitHandle);this._panInitHandle=null;C(this._swipeInitHandle);this._swipeInitHandle=null},enableRubberBandZoom:function(){this.disableRubberBandZoom();this._zoomInitHandle=
this.pointerEvents?B(this.pointerEvents,"onSwipeStart",this,this._zoomInit):B(this.mouseEvents,"onMouseDown",this,this._zoomInit)},disableRubberBandZoom:function(){C(this._zoomInitHandle);this._zoomInitHandle=null},enablePinchZoom:function(){this.disablePinchZoom();if("touch"===this.eventModel||"pointer"===this.eventModel)this._pinchInitHandle=B(this.touchEvents||this.pointerEvents,"onPinchStart",this,this._pinchInit)},disablePinchZoom:function(){C(this._pinchInitHandle);this._pinchInitHandle=null},
enableScrollWheelZoom:function(){this.disableScrollWheelZoom();this._wheelHandle=B(this.mouseEvents||this.pointerEvents,"onMouseWheel",this,this._wheelZoom)},disableScrollWheelZoom:function(){C(this._wheelHandle);this._wheelHandle=null},enableScrollWheelPan:function(){var a=this.map;a&&a.loaded&&a.smartNavigation&&(this.disableScrollWheelPan(),this._setScrollWheelPan(!0))},disableScrollWheelPan:function(){var a=this.map;a&&a.loaded&&a.smartNavigation&&this._setScrollWheelPan(!1)},enableDoubleClickZoom:function(){this.disableDoubleClickZoom();
switch(this.eventModel){case "mouse":this._dblClickHandle=B(this.mouseEvents,"onDblClick",this,this._dblClickZoom);break;case "touch":this._dblClickHandle=B(this.mouseEvents,"onDblClick",this,this._dblClickZoom);this._dblTapHandle=B(this.touchEvents,"onDoubleTap",this,this._dblClickZoom);this._zoomOutHandle=B(this.touchEvents,"onTwoFingerTap",this,this._twoFingerTap);break;case "pointer":this._dblTapHandle=B(this.pointerEvents,"onDoubleTap",this,this._dblClickZoom),this._zoomOutHandle=B(this.pointerEvents,
"onTwoFingerTap",this,this._twoFingerTap)}},disableDoubleClickZoom:function(){C(this._dblClickHandle);C(this._zoomOutHandle);this._dblTapHandle&&C(this._dblTapHandle);this._dblClickHandle=this._zoomOutHandle=this._dblTapHandle=null},enableShiftDoubleClickZoom:function(){this.disableShiftDoubleClickZoom();this._sDblClickHandle=B(this.pointerEvents||this.mouseEvents,"onDblClick",this,this._recenterZoom)},disableShiftDoubleClickZoom:function(){C(this._sDblClickHandle);this._sDblClickHandle=null},enableClickRecenter:function(){this.disableClickRecenter();
this._recenterHandle=B(this.pointerEvents||this.mouseEvents,"onClick",this,this._recenter)},disableClickRecenter:function(){C(this._recenterHandle);this._recenterHandle=null},enableKeyboardNavigation:function(){this.disableKeyboardNavigation();this._keyHandle=B(this.pointerEvents||this.mouseEvents,"onKeyDown",this,this._keyDown);this._keyEndHandle=B(this.pointerEvents||this.mouseEvents,"onKeyUp",this,this._keyEnd)},disableKeyboardNavigation:function(){C(this._keyHandle);C(this._keyEndHandle);this._keyHandle=
this._keyEndHandle=null},enableScrollWheel:function(){var a=this.map;a&&(a.smartNavigation?this.enableScrollWheelPan():a.enableScrollWheelZoom())},disableScrollWheel:function(){var a=this.map;a&&(a.disableScrollWheelZoom(),a.smartNavigation&&this.disableScrollWheelPan())},enableNavigation:function(){var a=this.map;a&&a.loaded&&(a._evalNavigationFeature("DoubleClickZoom"),a._evalNavigationFeature("ClickRecenter"),a._evalNavigationFeature("Pan"),a._evalNavigationFeature("RubberBandZoom"),a._evalNavigationFeature("PinchZoom"),
a._evalNavigationFeature("KeyboardNavigation"),a._evalNavigationFeature("ScrollWheel"))},disableNavigation:function(){var a=this.map;a&&a.loaded&&(a._evalNavigationFeature("DoubleClickZoom"),a._evalNavigationFeature("ClickRecenter"),a._evalNavigationFeature("Pan"),a._evalNavigationFeature("RubberBandZoom"),a._evalNavigationFeature("PinchZoom"),a._evalNavigationFeature("KeyboardNavigation"),a._evalNavigationFeature("ScrollWheel"))},destroy:function(){this.touchEvents&&this.touchEvents.destroy();this.mouseEvents&&
this.mouseEvents.destroy();this.pointerEvents&&this.pointerEvents.destroy();var a,b=[this._panInitHandle,this._panStartHandle,this._panHandle,this._panEndHandle,this._zoomInitHandle,this._zoomHandle,this._zoomEndHandle,this._wheelHandle,this._mwMacHandle,this._dblClickHandle,this._zoomOutHandle,this._recenterHandle,this._sDblClickHandle,this._dblTapHandle,this._keyHandle,this._keyEndHandle,this._swipeInitHandle,this._swipeHandle,this._swipeEndHandle,this._pinchInitHandle,this._pinchHandle,this._pinchEndHandle];
for(a=0;a<b.length;a++)C(b[a]);this.map=this.touchEvents=this.mouseEvents=this.eventModel=this.pointerEvents=this._zoomRect=this._dragOrigin=this._panInitHandle=this._panStartHandle=this._panHandle=this._panEndHandle=this._zoomInitHandle=this._zoomHandle=this._zoomEndHandle=this._wheelHandle=this._mwMacHandle=this._dblClickHandle=this._zoomOutHandle=this._recenterHandle=this._sDblClickHandle=this._dblTapHandle=this._keyHandle=this._keyEndHandle=this._swipeInitHandle=this._swipeHandle=this._swipeEndHandle=
this._pinchInitHandle=this._pinchHandle=this._pinchEndHandle=null}})})},"dijit/focus":function(){define("dojo/aspect dojo/_base/declare dojo/dom dojo/dom-attr dojo/dom-class dojo/dom-construct dojo/Evented dojo/_base/lang dojo/on dojo/domReady dojo/sniff dojo/Stateful dojo/_base/window dojo/window ./a11y ./registry ./main".split(" "),function(r,l,d,q,k,m,p,h,e,c,b,a,g,u,n,t,f){var v,x,w=new (l([a,p],{curNode:null,activeStack:[],constructor:function(){var a=h.hitch(this,function(a){d.isDescendant(this.curNode,
a)&&this.set("curNode",null);d.isDescendant(this.prevNode,a)&&this.set("prevNode",null)});r.before(m,"empty",a);r.before(m,"destroy",a)},registerIframe:function(a){return this.registerWin(a.contentWindow,a)},registerWin:function(a,c){var f=this,g=a.document&&a.document.body;if(g){var h=b("pointer-events")?"pointerdown":b("MSPointer")?"MSPointerDown":b("touch-events")?"mousedown, touchstart":"mousedown",d=e(a.document,h,function(a){a&&a.target&&null==a.target.parentNode||f._onTouchNode(c||a.target,
"mouse")}),u=e(g,"focusin",function(a){if(a.target.tagName){var b=a.target.tagName.toLowerCase();"#document"!=b&&"body"!=b&&(n.isFocusable(a.target)?f._onFocusNode(c||a.target):f._onTouchNode(c||a.target))}}),t=e(g,"focusout",function(a){f._onBlurNode(c||a.target)});return{remove:function(){d.remove();u.remove();t.remove();g=d=u=t=null}}}},_onBlurNode:function(a){a=(new Date).getTime();a<v+100||(this._clearFocusTimer&&clearTimeout(this._clearFocusTimer),this._clearFocusTimer=setTimeout(h.hitch(this,
function(){this.set("prevNode",this.curNode);this.set("curNode",null)}),0),this._clearActiveWidgetsTimer&&clearTimeout(this._clearActiveWidgetsTimer),a<x+100||(this._clearActiveWidgetsTimer=setTimeout(h.hitch(this,function(){delete this._clearActiveWidgetsTimer;this._setStack([])}),0)))},_onTouchNode:function(a,b){x=(new Date).getTime();this._clearActiveWidgetsTimer&&(clearTimeout(this._clearActiveWidgetsTimer),delete this._clearActiveWidgetsTimer);k.contains(a,"dijitPopup")&&(a=a.firstChild);var c=
[];try{for(;a;){var f=q.get(a,"dijitPopupParent");if(f)a=t.byId(f).domNode;else if(a.tagName&&"body"==a.tagName.toLowerCase()){if(a===g.body())break;a=u.get(a.ownerDocument).frameElement}else{var e=a.getAttribute&&a.getAttribute("widgetId"),h=e&&t.byId(e);!h||"mouse"==b&&h.get("disabled")||c.unshift(e);a=a.parentNode}}}catch(F){}this._setStack(c,b)},_onFocusNode:function(a){a&&9!=a.nodeType&&(v=(new Date).getTime(),this._clearFocusTimer&&(clearTimeout(this._clearFocusTimer),delete this._clearFocusTimer),
this._onTouchNode(a),a!=this.curNode&&(this.set("prevNode",this.curNode),this.set("curNode",a)))},_setStack:function(a,b){var c=this.activeStack,f=c.length-1,g=a.length-1;if(a[g]!=c[f]){this.set("activeStack",a);var e;for(e=f;0<=e&&c[e]!=a[e];e--)if(f=t.byId(c[e]))f._hasBeenBlurred=!0,f.set("focused",!1),f._focusManager==this&&f._onBlur(b),this.emit("widget-blur",f,b);for(e++;e<=g;e++)if(f=t.byId(a[e]))f.set("focused",!0),f._focusManager==this&&f._onFocus(b),this.emit("widget-focus",f,b)}},focus:function(a){if(a)try{a.focus()}catch(y){}}}));
c(function(){var a=w.registerWin(u.get(document));b("ie")&&e(window,"unload",function(){a&&(a.remove(),a=null)})});f.focus=function(a){w.focus(a)};for(var z in w)/^_/.test(z)||(f.focus[z]="function"==typeof w[z]?h.hitch(w,z):w[z]);w.watch(function(a,b,c){f.focus[a]=c});return w})},"dijit/a11y":function(){define("dojo/_base/array dojo/dom dojo/dom-attr dojo/dom-style dojo/_base/lang dojo/sniff ./main".split(" "),function(r,l,d,q,k,m,p){var h={_isElementShown:function(e){var c=q.get(e);return"hidden"!=
c.visibility&&"collapsed"!=c.visibility&&"none"!=c.display&&"hidden"!=d.get(e,"type")},hasDefaultTabStop:function(e){switch(e.nodeName.toLowerCase()){case "a":return d.has(e,"href");case "area":case "button":case "input":case "object":case "select":case "textarea":return!0;case "iframe":var c;try{var b=e.contentDocument;if("designMode"in b&&"on"==b.designMode)return!0;c=b.body}catch(a){try{c=e.contentWindow.document.body}catch(g){return!1}}return c&&("true"==c.contentEditable||c.firstChild&&"true"==
c.firstChild.contentEditable);default:return"true"==e.contentEditable}},effectiveTabIndex:function(e){if(!d.get(e,"disabled"))return d.has(e,"tabIndex")?+d.get(e,"tabIndex"):h.hasDefaultTabStop(e)?0:void 0},isTabNavigable:function(e){return 0<=h.effectiveTabIndex(e)},isFocusable:function(e){return-1<=h.effectiveTabIndex(e)},_getTabNavigable:function(e){function c(a){return a&&"input"==a.tagName.toLowerCase()&&a.type&&"radio"==a.type.toLowerCase()&&a.name&&a.name.toLowerCase()}function b(a){return k[c(a)]||
a}var a,g,u,n,t,f,k={},p=h._isElementShown,l=h.effectiveTabIndex,q=function(b){for(b=b.firstChild;b;b=b.nextSibling)if(!(1!=b.nodeType||9>=m("ie")&&"HTML"!==b.scopeName)&&p(b)){var e=l(b);if(0<=e){if(0==e)a||(a=b),g=b;else if(0<e){if(!u||e<n)n=e,u=b;if(!t||e>=f)f=e,t=b}e=c(b);d.get(b,"checked")&&e&&(k[e]=b)}"SELECT"!=b.nodeName.toUpperCase()&&q(b)}};p(e)&&q(e);return{first:b(a),last:b(g),lowest:b(u),highest:b(t)}},getFirstInTabbingOrder:function(e,c){var b=h._getTabNavigable(l.byId(e,c));return b.lowest?
b.lowest:b.first},getLastInTabbingOrder:function(e,c){var b=h._getTabNavigable(l.byId(e,c));return b.last?b.last:b.highest}};k.mixin(p,h);return h})},"esri/MouseEvents":function(){define("dojo/_base/declare dojo/_base/html dojo/_base/lang dojo/_base/sniff dojo/_base/connect dojo/_base/event ./kernel ./Evented ./geometry/Point ./geometry/ScreenPoint".split(" "),function(r,l,d,q,k,m,p,h,e,c){var b=k.connect,a=k.disconnect;return r([h],{declaredClass:"esri.MouseEvents",doubleClickDuration:300,minWheelValue:1,
maxWheelValue:1,mozWheelDivisor:-1!==q("mac")?1:3,wheelDivisor:2>q("chrome")?360:120,preventPageScroll:!0,map:null,constructor:function(a,c){this.node=a;d.mixin(this,c);var g=function(a){m.stop(a);return!1};q("mozilla")&&l.style(a,"MozUserSelect","none");this._handles=[b(a,"onselectstart",g),b(a,"ondragstart",g),b(a,"onmouseenter",this,this._onMouseEnterHandler),b(a,"onmouseleave",this,this._onMouseLeaveHandler),b(a,"onmousedown",this,this._onMouseDownHandler),b(a,"onclick",this,this._onClickHandler),
b(a,"ondblclick",this,this._onDblClickHandler)];this._onMouseMoveHandler_connect=b(a,"onmousemove",this,this._onMouseMoveHandler);this._onMouseUpHandler_connect=b(a,"onmouseup",this,this._onMouseUpHandler);this._fireClickEvent=d.hitch(this,this._fireClickEvent);this._initialDuration=this.doubleClickDuration;this.preventPageScroll=(g=this.map)?g.isScrollWheelZoom||g.isScrollWheelPan:this.preventPageScroll;this.enableMouseWheel(!1)},_fire:function(a,b){if(!this._preventClick||"onClick"!==a&&"onDblClick"!==
a){if(this[a])this[a](b);if(this.map&&this.map[a])this.map[a](b)}},_processEvent:function(a){a=m.fix(a,a.target);var b=this.map,g=b&&b.position;g&&("DOMMouseScroll"===a.type&&3>q("ff")?a.screenPoint=new c(window.scrollX+a.screenX-g.x,window.scrollY+a.screenY-g.y):a.screenPoint=new c(a.pageX-g.x,a.pageY-g.y),a.mapPoint=b.extent?b.toMap(a.screenPoint):new e);a.numPoints=0;return a},_onMouseEnterHandler:function(c){a(this._onKeyDown_connect);a(this._onKeyUp_connect);this._onKeyDown_connect=b(document,
"onkeydown",this,this._onKeyDownHandler);this._onKeyUp_connect=b(document,"onkeyup",this,this._onKeyUpHandler);this._fire("onMouseOver",this._processEvent(c))},_onMouseLeaveHandler:function(b){a(this._onKeyDown_connect);a(this._onKeyUp_connect);this._onKeyDown_connect=this._onKeyUp_connect=null;this._fire("onMouseOut",this._processEvent(b))},_onMouseMoveHandler:function(a){this._dragEnd?this._dragEnd=!1:this._fire("onMouseMove",this._processEvent(a))},_onMouseDownHandler:function(c){a(this._onMouseMoveHandler_connect);
this._onMouseMoveHandler_connect=null;this.node.setCapture&&this.node.setCapture(!1);a(this._onMouseDragHandler_connect);this._onMouseDragHandler_connect=b(document,"onmousemove",this,this._onMouseDragHandler);this._startX=c.pageX;this._startY=c.pageY;this._fire("onMouseDown",this._processEvent(c))},_onMouseUpHandler:function(c){var g=this.node;g.releaseCapture&&g.releaseCapture();a(this._onMouseDragHandler_connect);this._onMouseDragHandler_connect=null;a(this._onMouseMoveHandler_connect);this._onMouseMoveHandler_connect=
b(g,"onmousemove",this,this._onMouseMoveHandler);this._fire("onMouseUp",this._processEvent(c))},_onMouseDragHandler:function(c){a(this._onMouseDragHandler_connect);this._onMouseDragHandler_connect=b(document,"onmousemove",this,this._onMouseDraggingHandler);a(this._onMouseUpHandler_connect);this._onMouseUpHandler_connect=b(document,"onmouseup",this,this._onDragMouseUpHandler);this._docLeaveConnect=b(document,"onmouseout",this,this._onDocMouseOut);this._fire("onMouseDragStart",this._processEvent(c))},
_onMouseDraggingHandler:function(a){m.stop(a);this._fire("onMouseDrag",this._processEvent(a))},_onDragMouseUpHandler:function(c){var g=this.node;g.releaseCapture&&g.releaseCapture();this._dragEnd=!0;a(this._docLeaveConnect);a(this._onMouseDragHandler_connect);a(this._onMouseUpHandler_connect);this._docLeaveConnect=this._onMouseDragHandler_connect=null;this._onMouseMoveHandler_connect=b(g,"onmousemove",this,this._onMouseMoveHandler);this._onMouseUpHandler_connect=b(g,"onmouseup",this,this._onMouseUpHandler);
c=this._processEvent(c);this._fire("onMouseDragEnd",c);this._fire("onMouseUp",c)},_onDocMouseOut:function(a){var b=9>q("ie")?a.toElement:a.relatedTarget,c=b&&b.nodeName.toLowerCase();(!b||(q("chrome")||q("safari"))&&"html"===c)&&this._onDragMouseUpHandler(a)},_onClickHandler:function(a){a=this._processEvent(a);if(a.pageX===this._startX&&a.pageY===this._startY){clearTimeout(this._clickTimer);var b={},c="movementX"in a,g;for(g in a)if(!c||"webkitMovementX"!==g&&"webkitMovementY"!==g)b[g]=a[g];this._clickEvent=
b;this._clickTimer=setTimeout(this._fireClickEvent,this.doubleClickDuration)}},_fireClickEvent:function(){clearTimeout(this._clickTimer);9>q("ie")&&(this._clickEvent.graphic=p._ieGraphic,delete p._ieGraphic);this._fire("onClick",this._clickEvent)},_onDblClickHandler:function(a){clearTimeout(this._clickTimer);this._fire("onDblClick",this._processEvent(a))},_onMouseWheelHandler:function(a){var b=this.map;(b?b.isScrollWheelZoom||b.isScrollWheelPan:this.preventPageScroll)&&m.stop(a);var b=q("ff")||q("mozilla")?
-a.detail/this.mozWheelDivisor:a.wheelDelta/this.wheelDivisor,c=Math.abs(b),c=c<=this.minWheelValue?this.minWheelValue:this.maxWheelValue;a.value=0>b?-c:c;this._fire("onMouseWheel",this._processEvent(a))},_onKeyDownHandler:function(a){this._fire("onKeyDown",a)},_onKeyUpHandler:function(a){this._fire("onKeyUp",a)},enableMouseWheel:function(c){a(this._scrollHandle);this._scrollHandle=b(this.node,q("ff")||q("mozilla")?c?"MozMousePixelScroll":"DOMMouseScroll":"onmousewheel",this,this._onMouseWheelHandler)},
setImmediateClick:function(a){this.doubleClickDuration=a?0:this._initialDuration},preventClickEvents:function(a){this._preventClick=a},destroy:function(){var b=this._handles.concat([this._onMouseMoveHandler_connect,this._onMouseUpHandler_connect,this._onMouseDragHandler_connect,this._scrollHandle,this._onKeyDown_connect,this._onKeyUp_connect,this._docLeaveConnect]),c;for(c=0;c<b.length;c++)a(b[c]);clearTimeout(this._clickTimer);this.node=this.map=this._handles=this._clickEvent=this._onMouseMoveHandler_connect=
this._onMouseUpHandler_connect=this._onMouseDragHandler_connect=this._scrollHandle=this._onKeyDown_connect=this._onKeyUp_connect=this._docLeaveConnect=null}})})},"esri/TouchEvents":function(){define("dojo/_base/declare dojo/_base/html dojo/_base/lang dojo/_base/sniff dojo/dom ./kernel ./Evented ./geometry/Point ./geometry/ScreenPoint".split(" "),function(r,l,d,q,k,m,p,h,e){return r([p],{declaredClass:"esri.TouchEvents",tapRadius:8,doubleTapRadius:10,tapStartTolerance:50,doubleTapDuration:300,map:null,
constructor:function(c,b){this.node=c;d.mixin(this,b);l.setSelectable(c,!1);this._touchStart=d.hitch(this,this._touchStart);this._touchMove=d.hitch(this,this._touchMove);this._touchEnd=d.hitch(this,this._touchEnd);this._touchCancel=d.hitch(this,this._touchCancel);c.addEventListener("touchstart",this._touchStart,!1);c.addEventListener("touchmove",this._touchMove,!1);c.addEventListener("touchend",this._touchEnd,!1);c.addEventListener("touchcancel",this._touchCancel,!1);this.map&&q("ios")&&(this._mouseOver=
d.hitch(this,this._mouseOver),this._mouseOut=d.hitch(this,this._mouseOut),this._mouseDown=d.hitch(this,this._mouseDown),this._mouseUp=d.hitch(this,this._mouseUp),this._mouseClick=d.hitch(this,this._mouseClick),c.addEventListener("mouseover",this._mouseOver,!1),c.addEventListener("mouseout",this._mouseOut,!1),c.addEventListener("mousedown",this._mouseDown,!1),c.addEventListener("mouseup",this._mouseUp,!1),c.addEventListener("click",this._mouseClick,!1));this._numTouches=0;this._nodeTouches=[];this._touches=
{};this._touchIds=[];this._taps=[];this._immediate=!1},_touchStart:function(c){var b=this._touches,a,g=c.changedTouches.length,e,h,d,f,k=(new Date).getTime();if(!(q("android")&&q("safari")&&1===c.targetTouches.length&&c.touches.length===c.targetTouches.length&&c.targetTouches.length===c.changedTouches.length&&0===c.changedTouches[0].identifier&&b[c.changedTouches[0].identifier])){this._addTouch(c);for(a=0;a<g;a++)e=c.changedTouches[a],h=b[e.identifier]={},h.startX=e.pageX,h.startY=e.pageY,h.startTS=
k,-1===this._touchIds.indexOf(e.identifier)&&this._touchIds.push(e.identifier);this._swipeActive&&(d=this._nodeTouches[0]);this._pinchActive&&(f=this._nodeTouches[1]);1===this._numTouches?this._swipeActive?(this._swipeActive=!1,this._fire("onSwipeEnd",this._processTouchEvent(c,d))):this._pinchActive&&(this._pinchActive=!1,this._fire("onPinchEnd",this._processTouchEvent(c,[d,f]))):2===this._numTouches?this._swipeActive&&(d&&(h=b[this._touchIds[0]],h.startX=d.pageX,h.startY=d.pageY,h.moved=!1),this._swipeActive=
!1,this._fire("onSwipeEnd",this._processTouchEvent(c,d))):this._swipeActive?(this._swipeActive=!1,this._fire("onSwipeEnd",this._processTouchEvent(c,d))):this._pinchActive&&(this._pinchActive=!1,this._fire("onPinchEnd",this._processTouchEvent(c,[d,f])))}},_touchMove:function(c){c.preventDefault();this._updateTouch(c);var b=this._touches,a,g=c.changedTouches.length,e,h,d,f;if(!(q("android")&&q("safari")&&1===c.targetTouches.length&&c.touches.length===c.targetTouches.length&&c.targetTouches.length===
c.changedTouches.length&&0===c.changedTouches[0].identifier&&b[c.changedTouches[0].identifier]&&1<this._touchIds.length)){for(a=0;a<g;a++)if(e=c.changedTouches[a],h=b[e.identifier])d=Math.abs(e.pageX-h.startX),e=Math.abs(e.pageY-h.startY),!h.moved&&(d>=this.tapRadius||e>=this.tapRadius)&&(h.moved=h.absMoved=!0),f=f?f:h.moved;1===this._numTouches?(b=c.changedTouches[0],this._swipeActive?this._fire("onSwipeMove",this._processTouchEvent(c,b)):f&&(this._swipeActive=!0,this._fire("onSwipeStart",this._processTouchEvent(c,
b)))):2===this._numTouches&&(a=this._nodeTouches[0],g=this._nodeTouches[1],this._pinchActive?this._fire("onPinchMove",this._processTouchEvent(c,[a,g])):f&&(f=b[a.identifier],h=b[g.identifier],b=Math.abs(f.startX-h.startX),f=Math.abs(f.startY-h.startY),h=Math.abs(a.pageX-g.pageX),d=Math.abs(a.pageY-g.pageY),Math.abs(Math.sqrt(h*h+d*d)-Math.sqrt(b*b+f*f))>=2*this.tapRadius&&(this._pinchActive=!0,this._fire("onPinchStart",this._processTouchEvent(c,[a,g])))))}},_touchEnd:function(c){this._removeTouch(c);
var b=this._touches,a=c.changedTouches,g,e=a.length,h,d,f=(new Date).getTime(),k=this._touchIds;for(g=0;g<e;g++)if(d=b[a[g].identifier])d.absMoved&&(h=!0),d.pageX=a[g].pageX,d.pageY=a[g].pageY,d.endTS=f;if(0===this._numTouches)if(this._touches={},this._touchIds=[],this._swipeActive)this._swipeActive=!1,this._fire("onSwipeEnd",this._processTouchEvent(c,a[0]));else if(this._pinchActive)this._pinchActive=!1,this._fire("onPinchEnd",this._processTouchEvent(c,a));else{if(!h){e=Infinity;h=-Infinity;var f=
Infinity,m=-Infinity,p=this.tapStartTolerance,l=[],q=!0;for(g=0;g<k.length;g++)d=b[k[g]],l.push(d),d.startTS<e&&(e=d.startTS),d.startTS>h&&(h=d.startTS),d.endTS<f&&(f=d.endTS),d.endTS>m&&(m=d.endTS),delete b[k[g]];1===l.length&&a[0]&&(b=Math.abs(a[0].pageY-l[0].startY),Math.abs(a[0].pageX-l[0].startX)>=this.tapRadius||b>=this.tapRadius)&&(q=!1);q&&Math.abs(h-e)<=p&&Math.abs(m-f)<=p&&this._basicTap(c,l)}}else 1===this._numTouches&&this._pinchActive&&(g=this._nodeTouches[0],d=b[g.identifier],d.startX=
g.pageX,d.startY=g.pageY,this._pinchActive=d.moved=!1,this._fire("onPinchEnd",this._processTouchEvent(c,[a[0],g])))},_touchCancel:function(c){this._numTouches&&this._touchEnd(c)},_basicTap:function(c,b){var a=(new Date).getTime(),g=this;c=this._processTouchEvent(c,b);this._taps.push({touchInfos:b,ts:a,event:c});2<this._taps.length&&this._taps.shift();this._fire("onBasicTap",c);clearTimeout(this._tapTimer);this._immediate?this._analyzeTap(!0):this._tapTimer=setTimeout(function(){var a=g;g=null;clearTimeout(a._tapTimer);
a._analyzeTap()},2===this._taps.length?this.doubleTapDuration/2:this.doubleTapDuration)},_analyzeTap:function(c){var b=this._taps,a=b[0],g=b[1],e=a.touchInfos,h=g&&g.touchInfos;b.length&&(c||(this._taps=[]),a&&g?e.length===h.length?g.ts-a.ts<=this.doubleTapDuration?(1===e.length?(c=Math.abs(e[0].startX-h[0].startX),e=Math.abs(e[0].startY-h[0].startY),e=c<=this.doubleTapRadius&&e<=this.doubleTapRadius):e=!0,e?this._processedDoubleTap(b):this._processedTap(g)):this._processedTap(g):this._processedTap(g):
this._processedTap(a||g))},_processedTap:function(c){var b=c.event;this._fire("onProcessedTap",b);1===c.touchInfos.length?this._fire("onTap",this._fixEvent(b)):2===c.touchInfos.length&&this._fire("onTwoFingerTap",b)},_processedDoubleTap:function(c){var b=1===c[1].touchInfos.length,a;b&&(a=[this._fixEvent(c[0].event),this._fixEvent(c[1].event)],a[1].relatedEvents=a);c=[c[0].event,c[1].event];c[1].relatedEvents=c;this._fire("onProcessedDoubleTap",c[1]);b&&(this._fire("onDoubleTap",a[1]),this._fire("onDblClick",
a[1]))},_addTouch:function(c){var b=c.changedTouches,a=this._nodeTouches,g,e,h;this._numTouches+=b.length;for(c=0;c<b.length;c++){e=a.length;h=!1;for(g=0;g<e&&!(h=a[g].identifier===b[c].identifier);g++);h?this._numTouches--:a.push(b[c])}for(c=a.length-1;0<=c;c--)k.isDescendant(a[c].target,document.body)||(a.splice(c,1),this._numTouches--);0>this._numTouches&&(this._numTouches=0)},_removeTouch:function(c){var b=[],a=[],g=c.changedTouches,e=this._nodeTouches;this._numTouches-=g.length;0>this._numTouches&&
(this._numTouches=0);for(c=0;c<g.length;c++)b.push(g[c].identifier);for(c=e.length-1;0<=c;c--)-1!==b.indexOf(e[c].identifier)&&a.push(e.splice(c,1)[0]);return a},_updateTouch:function(c){var b=[],a,g=c.changedTouches,e=this._nodeTouches;for(c=0;c<g.length;c++)b.push(g[c].identifier);for(c=0;c<e.length;c++)a=b.indexOf(e[c].identifier),-1!==a&&e.splice(c,1,g[a])},_mouseOver:function(c){this._fire("onMouseOver",this._processMouseEvent(c))},_mouseOut:function(c){this._fire("onMouseOut",this._processMouseEvent(c))},
_mouseDown:function(c){this._fire("onMouseDown",this._processMouseEvent(c))},_mouseUp:function(c){this._fire("onMouseUp",this._processMouseEvent(c))},_mouseClick:function(c){this._fire("onClick",this._processMouseEvent(c))},_fire:function(c,b){if("onDblClick"===c&&this.mouseEvents){this.mouseEvents.preventClickEvents(!0);var a=this;setTimeout(function(){a.mouseEvents.preventClickEvents(!1)},350)}if(this[c])this[c](b);if(this.map&&this.map[c])this.map[c](b)},_fixEvent:function(c){var b={},a;for(a in c)b[a]=
c[a];this.map&&(b.screenPoint=b.screenPoints[0],b.mapPoint=b.mapPoints[0]);return b},_processTouchEvent:function(c,b){var a=this.map,g=a&&a.position,u=0;if(g&&b)if(d.isArray(b)){var n,t;c.screenPoints=[];c.mapPoints=[];for(n=0;n<b.length;n++)b[n]?(t=new e(b[n].pageX-g.x,b[n].pageY-g.y),c.screenPoints.push(t),c.mapPoints.push(a.extent?a.toMap(t):new h)):u++}else c.screenPoint=new e(b.pageX-g.x,b.pageY-g.y),c.mapPoint=a.extent?a.toMap(c.screenPoint):new h;c.numPoints=b?d.isArray(b)?b.length-u:1:0;return c},
_processMouseEvent:function(c){var b=this.map,a=b&&b.position;a&&(c.screenPoint=new e(c.pageX-a.x,c.pageY-a.y),c.mapPoint=b.extent?b.toMap(c.screenPoint):new h);return c},setImmediateTap:function(c){this._immediate=c},destroy:function(){var c=this.node;c.removeEventListener("touchstart",this._touchStart,!1);c.removeEventListener("touchmove",this._touchMove,!1);c.removeEventListener("touchend",this._touchEnd,!1);c.removeEventListener("touchcancel",this._touchCancel,!1);this.map&&(c.removeEventListener("mouseover",
this._mouseOver,!1),c.removeEventListener("mouseout",this._mouseOut,!1),c.removeEventListener("mousedown",this._mouseDown,!1),c.removeEventListener("mouseup",this._mouseUp,!1),c.removeEventListener("click",this._mouseClick,!1));l.setSelectable(c,!0);clearTimeout(this._tapTimer);this.node=this.map=this._numTouches=this._nodeTouches=this._touches=this._touchIds=this._taps=null}})})},"esri/PointerEvents":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/has ./kernel ./Evented ./geometry/Point ./geometry/ScreenPoint".split(" "),
function(r,l,d,q,k,m,p,h){return r([m],{declaredClass:"esri.PointerEvents",tapRadius:8,clickRadius:2,doubleTapRadius:10,tapStartTolerance:50,doubleTapDuration:300,minWheelValue:1,maxWheelValue:1,mozWheelDivisor:-1!==q("mac")?1:3,wheelDivisor:120,preventPageScroll:!0,_dragging:!1,constructor:function(e,c){this.node=e;l.mixin(this,c);void 0!==e.style.msTouchAction?e.style.msTouchAction="none":void 0!==e.style.touchAction&&(e.style.touchAction="none");var b=navigator.msPointerEnabled,a=function(a){a.preventDefault()};
e.addEventListener("selectstart",a,!1);e.addEventListener("dragstart",a,!1);this._pointerDown=l.hitch(this,this._pointerDown);this._pointerMove=l.hitch(this,this._pointerMove);this._pointerUp=l.hitch(this,this._pointerUp);this._pointerCancel=l.hitch(this,this._pointerCancel);e.addEventListener(b?"MSPointerDown":"pointerdown",this._pointerDown,!1);e.addEventListener(b?"MSPointerMove":"pointermove",this._pointerMove,!1);e.addEventListener(b?"MSPointerUp":"pointerup",this._pointerUp,!1);e.addEventListener(b?
"MSPointerCancel":"pointercancel",this._pointerCancel,!1);this.map&&(this._mouseOver=l.hitch(this,this._mouseOver),this._mouseOut=l.hitch(this,this._mouseOut),this._mouseLeave=l.hitch(this,this._mouseLeave),this._mouseDown=l.hitch(this,this._mouseDown),this._mouseUp=l.hitch(this,this._mouseUp),this._mouseClick=l.hitch(this,this._mouseClick),this._mouseWheel=l.hitch(this,this._mouseWheel),this._mouseMove=l.hitch(this,this._mouseMove),this._mouseEnter=l.hitch(this,this._mouseEnter),this._onKeyDown=
l.hitch(this,this._onKeyDown),this._onKeyUp=l.hitch(this,this._onKeyUp),e.addEventListener("mouseover",this._mouseOver,!1),e.addEventListener("mouseout",this._mouseOut,!1),e.addEventListener("mouseleave",this._mouseLeave,!1),e.addEventListener("mousedown",this._mouseDown,!1),e.addEventListener("mouseup",this._mouseUp,!1),e.addEventListener("click",this._mouseClick,!1),e.addEventListener("mousewheel",this._mouseWheel,!1),e.addEventListener("mousemove",this._mouseMove,!1),e.addEventListener("mouseenter",
this._mouseEnter,!1));this._numTouches=0;this._touches={};this._touchIds=[];this._taps=[];this._immediate=!1},_pointerDown:function(e){if(-1<d.indexOf(this._touchIds,e.pointerId))this._pointerUp(e);else{var c=this._touches,b=e.target,a=e.pointerId,g=this._touchIds,h,n=(new Date).getTime();h=c[a]={};h.pointerId=a;h.startX=h.pageX=e.pageX;h.startY=h.pageY=e.pageY;h.startTS=n;g.push(a);this._numTouches++;b.setPointerCapture?b.setPointerCapture(a):b.msSetPointerCapture&&b.msSetPointerCapture(a);b=c[g[0]];
c=c[g[1]];1!==this._numTouches&&(2===this._numTouches?this._swipeActive&&(b&&(b.startX=b.pageX,b.startY=b.pageY,b.moved=!1),this._swipeActive=!1,this._fire("onSwipeEnd",this._processTouchEvent(e,b))):this._swipeActive?(this._swipeActive=!1,this._fire("onSwipeEnd",this._processTouchEvent(e,b))):this._pinchActive&&(this._pinchActive=!1,this._fire("onPinchEnd",this._processTouchEvent(e,[b,c]))))}},_pointerMove:function(e){var c=this._touches,b=this._touchIds,a,g,h;if((a=c[e.pointerId])&&(a.pageX!==e.pageX||
a.pageY!==e.pageY))if(a.pageX=e.pageX,a.pageY=e.pageY,g=Math.abs(a.pageX-a.startX),h=Math.abs(a.pageY-a.startY),!a.moved&&(g>=this.tapRadius||h>=this.tapRadius)&&(a.moved=a.absMoved=!0),1===this._numTouches)this._swipeActive?this._fire("onSwipeMove",this._processTouchEvent(e,e)):a.moved&&(this._swipeActive=!0,this._fire("onSwipeStart",this._processTouchEvent(e,e)));else if(2===this._numTouches)if(a=c[b[0]],c=c[b[1]],this._pinchActive)this._fire("onPinchMove",this._processTouchEvent(e,[a,c]));else if(a.moved||
c.moved){b=Math.abs(a.startX-c.startX);g=Math.abs(a.startY-c.startY);h=Math.abs(a.pageX-c.pageX);var d=Math.abs(a.pageY-c.pageY);Math.abs(Math.sqrt(h*h+d*d)-Math.sqrt(b*b+g*g))>=2*this.tapRadius&&(this._pinchActive=!0,this._fire("onPinchStart",this._processTouchEvent(e,[a,c])))}},_pointerUp:function(e){var c=this._touches,b,a=this.node,g=e.target,h=e.pointerId,n=this._touchIds,t=n.slice(0),f=d.map(t,function(a){return c[a]}),k=(new Date).getTime();if(b=c[h])if(b.pageX=e.pageX,b.pageY=e.pageY,b.endTS=
k,this._numTouches--,g.releasePointerCapture?g.releasePointerCapture(h):g.msReleasePointerCapture&&g.msReleasePointerCapture(h),0===this._numTouches)if(this._touches={},this._touchIds=[],this._swipeActive)this._swipeActive=!1,this._fire("onSwipeEnd",this._processTouchEvent(e,e));else if(this._pinchActive)this._pinchActive=!1,this._fire("onPinchEnd",this._processTouchEvent(e,e));else{if(!b.absMoved){var g=Infinity,h=-Infinity,n=Infinity,k=-Infinity,m=this.tapStartTolerance,p;for(p=0;p<t.length;p++)b=
f[p],b.startTS<g&&(g=b.startTS),b.startTS>h&&(h=b.startTS),b.endTS<n&&(n=b.endTS),b.endTS>k&&(k=b.endTS);Math.abs(h-g)<=m&&Math.abs(k-n)<=m&&this._basicTap(e,f)}}else 1===this._numTouches&&this._pinchActive&&(n.splice(d.indexOf(n,e.pointerId),1),delete c[e.pointerId],b=c[n[0]],b.startX=b.pageX,b.startY=b.pageY,b.moved=!1,document.msElementsFromPoint&&(t=document.msElementsFromPoint(b.pageX,b.pageY),d.some(t,function(b){return b===a})||(this._touches={},this._touchIds=[],this._numTouches=0)),this._pinchActive=
!1,this._fire("onPinchEnd",this._processTouchEvent(e,[e,b])))},_pointerCancel:function(e){this._numTouches&&this._pointerUp(e)},_basicTap:function(e,c){var b=(new Date).getTime(),a=this,g=this._immediate;e=this._processTouchEvent(e,c);this._taps.push({touchInfos:c,ts:b,event:e});2<this._taps.length&&this._taps.shift();this._fire("onBasicTap",e);clearTimeout(this._tapTimer);b=2===this._taps.length?this.doubleTapDuration/2:this.doubleTapDuration;this._tapTimer=setTimeout(function(){var b=a;a=null;clearTimeout(b._tapTimer);
b._analyzeTap(g)},g?0:b)},_analyzeTap:function(e){var c=this._taps,b=c[0],a=c[1],g=b.touchInfos,h=a&&a.touchInfos;c.length&&(e||(this._taps=[]),b&&a?g.length===h.length?a.ts-b.ts<=this.doubleTapDuration?(1===g.length?(e=Math.abs(g[0].startX-h[0].startX),g=Math.abs(g[0].startY-h[0].startY),g=e<=this.doubleTapRadius&&g<=this.doubleTapRadius):g=!0,g?this._processedDoubleTap(c):this._processedTap(a)):this._processedTap(a):this._processedTap(a):this._processedTap(b||a))},_processedTap:function(e){var c=
e.event;this._fire("onProcessedTap",c);1===e.touchInfos.length?this._fire("onTap",this._fixEvent(c)):2===e.touchInfos.length&&this._fire("onTwoFingerTap",c)},_processedDoubleTap:function(e){var c=1===e[1].touchInfos.length,b;c&&(b=[this._fixEvent(e[0].event),this._fixEvent(e[1].event)],b[1].relatedEvents=b);e=[e[0].event,e[1].event];e[1].relatedEvents=e;this._fire("onProcessedDoubleTap",e[1]);c&&(this._fire("onDoubleTap",b[1]),this._fire("onDblClick",b[1]))},_mouseOver:function(e){this._fire("onMouseOver",
this._processMouseEvent(e))},_mouseMove:function(e){this._dragging?this._fire("onMouseDrag",this._processMouseEvent(e)):this._fire("onMouseMove",this._processMouseEvent(e))},_mouseOut:function(e){this._fire("onMouseOut",this._processMouseEvent(e))},_mouseLeave:function(e){document.removeEventListener("keydown",this._onKeyDown,!1);document.removeEventListener("keyup",this._onKeyUp,!1);this._fire("onMouseOut",this._processMouseEvent(event))},_mouseDown:function(e){this._downX=e.pageX;this._downY=e.pageY;
this._fire("onMouseDown",this._processMouseEvent(e));0===e.button&&(this._dragging=!0,this._fire("onMouseDragStart",this._processMouseEvent(e)))},_mouseUp:function(e){this._dragging&&(this._dragging=!1,this._fire("onMouseDragEnd",this._processMouseEvent(e)));this._fire("onMouseUp",this._processMouseEvent(e))},_mouseClick:function(e){Math.abs(e.pageX-this._downX)<=this.clickRadius&&Math.abs(e.pageY-this._downY)<=this.clickRadius&&this._fire("onClick",this._processMouseEvent(e))},_mouseWheel:function(e){var c=
this.map;(c?c.isScrollWheelZoom||c.isScrollWheelPan:this.preventPageScroll)&&e.preventDefault();var c=e.wheelDelta?e.wheelDelta/this.wheelDivisor:-e.detail/this.mozWheelDivisor,b=Math.abs(c),b=b<=this.minWheelValue?this.minWheelValue:this.maxWheelValue;e.value=0>c?-b:b;this._fire("onMouseWheel",this._processMouseEvent(e))},_mouseEnter:function(e){document.removeEventListener("keydown",this._onKeyDown,!1);document.removeEventListener("keyup",this._onKeyUp,!1);document.addEventListener("keydown",this._onKeyDown,
!1);document.addEventListener("keyup",this._onKeyUp,!1);this._fire("onMouseEnter",this._processMouseEvent(e))},_onKeyDown:function(e){this._fire("onKeyDown",e)},_onKeyUp:function(e){this._fire("onKeyUp",e)},_fire:function(e,c){if(this[e])this[e](c);if(this.map&&this.map[e])this.map[e](c)},_fixEvent:function(e){var c={},b;for(b in e)c[b]=e[b];c.preventDefault=function(){e.preventDefault()};c.stopPropagation=function(){e.stopPropagation()};this.map&&(c.screenPoint=c.screenPoints[0],c.mapPoint=c.mapPoints[0]);
return c},_processTouchEvent:function(e,c){var b=this.map,a=b&&b.position,g=0;if(a&&c)if(l.isArray(c)){var d,n;e.screenPoints=[];e.mapPoints=[];for(d=0;d<c.length;d++)c[d]?(n=new h(c[d].pageX-a.x,c[d].pageY-a.y),e.screenPoints.push(n),e.mapPoints.push(b.extent?b.toMap(n):new p)):g++}else e.screenPoint=new h(c.pageX-a.x,c.pageY-a.y),e.mapPoint=b.extent?b.toMap(e.screenPoint):new p;e.numPoints=c?l.isArray(c)?c.length-g:1:0;return e},_processMouseEvent:function(e){var c=this.map,b=c&&c.position;b&&(e.screenPoint=
new h(e.pageX-b.x,e.pageY-b.y),e.mapPoint=c.extent?c.toMap(e.screenPoint):new p);return e},setImmediateTap:function(e){this._immediate=e},destroy:function(){var e=this.node;e.removeEventListener("MSPointerDown",this._pointerDown,!1);e.removeEventListener("MSPointerMove",this._pointerMove,!1);e.removeEventListener("MSPointerUp",this._pointerUp,!1);e.removeEventListener("MSPointerCancel",this._pointerCancel,!1);this.map&&(e.removeEventListener("mouseover",this._mouseOver,!1),e.removeEventListener("mousemove",
this._mouseMove,!1),e.removeEventListener("mouseout",this._mouseOut,!1),e.removeEventListener("mouseleave",this._mouseLeave,!1),e.removeEventListener("mousedown",this._mouseDown,!1),e.removeEventListener("mouseup",this._mouseUp,!1),e.removeEventListener("click",this._mouseClick,!1),e.removeEventListener("mouseenter",this._mouseEnter,!1));clearTimeout(this._tapTimer);this.node=this.map=this._numTouches=this._touches=this._touchIds=this._taps=null}})})},"esri/renderers/jsonUtils":function(){define("dojo/_base/array dojo/_base/lang dojo/has dojox/gfx/_base ../kernel ../Color ../symbols/jsonUtils ./SimpleRenderer ./UniqueValueRenderer ./ClassBreaksRenderer ./VectorFieldRenderer ./DotDensityRenderer ./ScaleDependentRenderer ./TimeClassBreaksAger ./TimeRampAger ./TemporalRenderer ./HeatmapRenderer ./StretchRenderer".split(" "),
function(r,l,d,q,k,m,p,h,e,c,b,a,g,u,n,t,f,v){return{fromJson:function(a){var f;switch(a.type||""){case "simple":f=new h(a);break;case "uniqueValue":f=new e(a);break;case "classBreaks":f=new c(a);break;case "vectorField":f=new b(a);break;case "scaleDependent":f=this._scaleDependentFromJson(a);break;case "dotDensity":f=this._dotDensityFromJson(a);break;case "temporal":f=this._temporalFromJson(a);break;case "heatmap":f=this._heatmapFromJson(a);break;case "rasterStretch":f=new v(a)}return f},_scaleDependentFromJson:function(a){var b=
{},c=a.minScale;b.rendererInfos=r.map(a.rendererInfos,function(a){var b=a.maxScale;a={minScale:c,maxScale:b,renderer:a.renderer&&this.fromJson(a.renderer)};c=b;return a},this);return new g(b)},_dotDensityFromJson:function(b){b.backgroundColor&&l.isArray(b.backgroundColor)&&(b.backgroundColor=m.toDojoColor(b.backgroundColor));0<b.dotSize&&(b.dotSize=q.pt2px(b.dotSize));b.fields&&r.forEach(b.fields,function(a){a&&l.isArray(a.color)&&(a.color=m.toDojoColor(a.color))});b.legendOptions&&(b.legendOptions.backgroundColor&&
l.isArray(b.legendOptions.backgroundColor)&&(b.legendOptions.backgroundColor=m.toDojoColor(b.legendOptions.backgroundColor)),b.legendOptions.outline&&(b.legendOptions.outline=p.fromJson(b.legendOptions.outline)));b.outline&&(b.outline=p.fromJson(b.outline));return new a(b)},_temporalFromJson:function(a){var b,c,f;a=a||{};b=this.fromJson(a.observationRenderer);c=a.latestObservationRenderer?this.fromJson(a.latestObservationRenderer):null;f=a.trackRenderer?this.fromJson(a.trackRenderer):null;a=this._agerFromJson(a.observationAger);
return new t(b,c,f,a)},_agerFromJson:function(a){var b;a=a||{};a.colorRange||a.sizeRange||a.alphaRange?b=this._timeRampFromJson(a):a.agerClassBreakInfos&&(b=this._timeClassBreaksFromJson(a));return b},_timeRampFromJson:function(a){var b,c,f;a.colorRange&&1<a.colorRange.length&&(b=[m.toDojoColor(a.colorRange[0]),m.toDojoColor(a.colorRange[1])]);a.sizeRange&&1<a.sizeRange.length&&(c=[a.sizeRange[0],a.sizeRange[1]]);a.alphaRange&&1<a.alphaRange.length&&(f=[a.alphaRange[0]/255,a.alphaRange[1]/255]);return new n(b,
c,f)},_timeClassBreaksFromJson:function(a){var b=a.agerClassBreakInfos,c,f,g=[],e;c=u.UNIT_DAYS;switch(a.timeUnits){case "esriTimeUnitsSeconds":c=u.UNIT_SECONDS;break;case "esriTimeUnitsMilliseconds":c=u.UNIT_MILLISECONDS;break;case "esriTimeUnitsHours":c=u.UNIT_HOURS;break;case "esriTimeUnitsMinutes":c=u.UNIT_MINUTES;break;case "esriTimeUnitsMonths":c=u.UNIT_MONTHS;break;case "esriTimeUnitsWeeks":c=u.UNIT_WEEKS;break;case "esriTimeUnitsYears":c=u.UNIT_YEARS}for(e=0;e<b.length;e+=1)a=b[e],f={minAge:0,
maxAge:a.oldestAge||Infinity},a.color&&(f.color=m.toDojoColor(a.color)),a.alpha&&(f.alpha=a.alpha/255),f.size=a.size,g[e]=f;return new u(g,c)},_heatmapFromJson:function(a){var b=a.colorStops;b&&b instanceof Array&&r.forEach(b,function(a){a.color=m.toDojoColor(a.color)});return new f(a)}}})},"esri/renderers/SimpleRenderer":function(){define("dojo/_base/declare dojo/_base/lang dojo/has ../kernel ../lang ../symbols/jsonUtils ./Renderer".split(" "),function(r,l,d,q,k,m,p){return r(p,{declaredClass:"esri.renderer.SimpleRenderer",
constructor:function(h){if(h&&!h.declaredClass){var e=h;this.symbol=(h=e.symbol)&&(h.declaredClass?h:m.fromJson(h));this.label=e.label;this.description=e.description}else this.symbol=h},getSymbol:function(h){return this.symbol},toJson:function(){var h=l.mixin(this.inherited(arguments),{type:"simple",label:this.label,description:this.description,symbol:this.symbol&&this.symbol.toJson()});return k.fixJson(h)}})})},"esri/renderers/Renderer":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/has dojox/gfx/_base ../kernel ../Color ./arcadeUtils".split(" "),
function(r,l,d,q,k,m,p,h){var e=Math.PI,c=1;return r(null,{declaredClass:"esri.renderer.Renderer",constructor:function(b){this._cache={};if(b&&!b.declaredClass){this.rotationInfo=b.rotationInfo;if(!this.rotationInfo){var a=b.rotationType,c=b.rotationExpression;if(a||c)this.rotationInfo={type:a,expression:c}}this.setRotationInfo(this.rotationInfo);this.setSizeInfo(this._readSizeInfo(b.sizeInfo));this.setColorInfo(this._readColorInfo(b.colorInfo));this.setOpacityInfo(this._readOpacityInfo(b.transparencyInfo));
this.setVisualVariables(this._readVariables(b.visualVariables));this.setAuthoringInfo(b.authoringInfo)}this.getSymbol=l.hitch(this,this.getSymbol)},getSymbol:function(b){},_readSizeInfo:function(b){if(b){var a=b.minSize,c=b.maxSize;a&&(b.minSize="number"===typeof a?k.pt2px(a):this._readSizeInfo(a));c&&(b.maxSize="number"===typeof c?k.pt2px(c):this._readSizeInfo(c));b.stops&&d.forEach(b.stops,function(a){a.size&&"number"===typeof a.size&&(a.size=k.pt2px(a.size))})}return b},_readColorInfo:function(b){b&&
(d.forEach(b.colors,function(a,c){l.isArray(a)&&(b.colors[c]=p.toDojoColor(a))}),d.forEach(b.stops,function(a,c){a.color&&l.isArray(a.color)&&(b.stops[c].color=p.toDojoColor(a.color))}));return b},_readOpacityInfo:function(b){var a;b&&(a=l.mixin({},b),a.transparencyValues&&(a.opacityValues=d.map(a.transparencyValues,function(a){return 1-a/100}),delete a.transparencyValues),a.stops&&(a.stops=d.map(a.stops,function(a){a=l.mixin({},a);a.opacity=1-a.transparency/100;delete a.transparency;return a})));
return a},_readVariables:function(b){b&&(b=d.map(b,function(a){"sizeInfo"===a.type?a=this._readSizeInfo(a):"colorInfo"===a.type?a=this._readColorInfo(a):"transparencyInfo"===a.type&&(a=this._readOpacityInfo(a),a.type="opacityInfo");return a},this));return b},setAuthoringInfo:function(b){this.authoringInfo=b},setRotationInfo:function(b){if(b=this.rotationInfo="string"===typeof b?{field:b}:b){if(b.expression&&!l.isFunction(b.expression)&&!b.field){var a=b.expression.match(this.rotationRE);a&&a[1]&&
(b.field=a[1])}b.rotationType=b.type}this._cache.rotationInfo=this._processRotationInfo(b);return this},rotationRE:/^\[([^\]]+)\]$/i,_processRotationInfo:function(b){return this._createCache(b)},getRotationAngle:function(b,a){var c=this._getVarInfo(a&&a.rotationInfo,"rotationInfo"),e=c.variable,c=this._cache[c.cacheKey],h="arithmetic"===this._getRotationType(e),d=c&&c.hasExpr,f=null;if(e.field||d)f=this._getDataValue(b,e,null,c),null!=f&&(f=(f+(h?-90:0))*(h?-1:1));return f},_getRotationType:function(b){return b&&
("rotationInfo"===b.type?b.rotationType:b.type)},_getDataValue:function(b,a,c,e,d){e||(e=this._getVarInfo(a,c),a=e.variable,e=this._cache[e.cacheKey],"sizeInfo"===c&&(e=e.root));return b._getDataValue(a,e,h,d)},setVisualVariables:function(b){var a=this._cache;d.forEach(this.visualVariables,function(b,c){a.hasOwnProperty(c)&&(a[c]=null)},this);this.visualVariables=b;d.some(b,function(a){return!!a.target})&&b.sort(function(a,b){return a.target===b.target?0:a.target?1:-1});d.forEach(b,function(b,c){"colorInfo"===
b.type?a[c]=this._processColorInfo(b):"opacityInfo"===b.type?a[c]=this._processOpacityInfo(b):"sizeInfo"===b.type?a[c]=this._processSizeInfo(b):"rotationInfo"===b.type&&(a[c]=this._processRotationInfo(b))},this);return this},getVisualVariableValues:function(b){var a=this.visualVariables,c;a&&(c=d.map(a,function(a){var c;switch(a.type){case "sizeInfo":c=this.getSize(b,{sizeInfo:a});break;case "colorInfo":c=this.getColor(b,{colorInfo:a});break;case "opacityInfo":c=this.getOpacity(b,{opacityInfo:a});
break;case "rotationInfo":c=this.getRotationAngle(b,{rotationInfo:a})}return{variable:a,value:c}},this));return c},getFieldsUsedInExpressions:function(){var b=[];d.forEach(this._getCacheObjects(),function(a){a.syntaxTree&&(b=b.concat(h.extractFieldNames(a.syntaxTree)))});b.sort();return d.filter(b,function(a,c){return 0===c||b[c-1]!==a})},hasVisualVariables:function(b,a){return b?!!this.getVisualVariablesForType(b,a):!!(this.getVisualVariablesForType("sizeInfo",a)||this.getVisualVariablesForType("colorInfo",
a)||this.getVisualVariablesForType("opacityInfo",a)||this.getVisualVariablesForType("rotationInfo",a))},getVisualVariablesForType:function(b,a){var c=this.visualVariables,e;!a&&this[b]?("rotationInfo"===b&&(this[b].rotationType=this[b].type),e=[this[b]]):c&&(e=d.filter(c,function(c){return c.type===b&&("string"===typeof a?c.target===a:!1===a?!c.target:!0)}))&&0===e.length&&(e=void 0);return e},setSizeInfo:function(b){this.sizeInfo=this.proportionalSymbolInfo=b;this._cache.sizeInfo=this._processSizeInfo(b);
return this},_processSizeInfo:function(b){return b&&{root:this._createCache(b),minSize:this._createCache(b.minSize),maxSize:this._createCache(b.maxSize)}},_convertExpressionToArcade:function(b){b&&b.expression&&(b.valueExpression="$view.scale")},_getVarInfo:function(b,a){var c;b&&b.type===a?(c=d.indexOf(this.visualVariables,b),b=this.visualVariables[c]):(c=a,b=this[a]);return{variable:b,cacheKey:c}},setProportionalSymbolInfo:function(b){this.setSizeInfo(b);return this},getSize:function(b,a){var c=
this._getVarInfo(a&&a.sizeInfo,"sizeInfo"),e=c.variable,c=this._cache[c.cacheKey],h=null;if(e)var d=e.minSize,h=e.maxSize,d="object"===typeof d&&d?this._getSize(b,d,c&&c.minSize,a):d,h="object"===typeof h&&h?this._getSize(b,h,c&&c.maxSize,a):h,h=this._getSize(b,e,c&&c.root,a,[d,h]);return h},_getSize:function(b,a,c,h,d){var g=a.stops,f=0,n=c&&c.hasExpr,u=c&&c.ipData,k=c&&c.isScaleDriven,m="object"===typeof b&&!!b,p="number"===typeof b?b:null;if(a.field||k||n){var l=h&&h.scale,n=d?d[0]:a.minSize;d=
d?d[1]:a.maxSize;var q=a.minDataValue,r=a.maxDataValue,E=a.valueUnit||"unknown",D=a.valueRepresentation,F=a.scaleBy,G=h&&h.shape;k?p=l:"number"!==typeof p&&m&&(p=this._getDataValue(b,a,null,c));if(!this._isValidNumber(p))return null;if(g)n=this._lookupData(p,u),p=n[0],d=n[1],p===d?f=g[p].size:(p=g[p].size,g=g[d].size,f=p+(g-p)*n[2]);else if(null!=n&&null!=d&&null!=q&&null!=r)p<=q?f=n:p>=r?f=d:(g=(p-q)/(r-q),"area"===F&&G?(n=(p="circle"===G)?e*Math.pow(n/2,2):n*n,g=n+g*((p?e*Math.pow(d/2,2):d*d)-n),
f=p?2*Math.sqrt(g/e):Math.sqrt(g)):f=n+g*(d-n));else if("unknown"===E)null!=n&&null!=q&&(n&&q?(g=p/q,f="circle"===G?2*Math.sqrt(g*Math.pow(n/2,2)):"square"===G||"diamond"===G||"image"===G?Math.sqrt(g*Math.pow(n,2)):g*n):f=p+(n||q),f=f<n?n:f,null!=d&&f>d&&(f=d));else{g=(h&&h.resolution?h.resolution:1)*this._meterIn[E];if("area"===D)f=Math.sqrt(p/e)/g,f*=2;else if(f=p/g,"radius"===D||"distance"===D)f*=2;null!=n&&f<n&&(f=n);null!=d&&f>d&&(f=d)}}else f=g&&g[0]&&g[0].size,null==f&&(f=a.minSize);return f=
isNaN(f)?0:f},getSizeRangeAtScale:function(b,a){var c,e=this._getVarInfo(b,"sizeInfo"),h=this._cache[e.cacheKey],d={scale:a};if((b=e.variable)&&a){var e=b.minSize,f=b.maxSize,k=b.stops;k&&k.length?(e=k[0].size,h=k[k.length-1].size):(e="object"===typeof e&&e?this._getSize({},e,h&&h.minSize,d):e,h="object"===typeof f&&f?this._getSize({},f,h&&h.maxSize,d):f);if(null!=e||null!=h)e>h&&(c=h,h=e,e=c),c={minSize:e,maxSize:h}}return c},setColorInfo:function(b){this.colorInfo=b;this._cache.colorInfo=this._processColorInfo(b);
return this},prepareForViewChange:function(){d.forEach(this._getCacheObjects(),function(b){if(b.dependsOnView||b.isJSFunc)b.version=c++})},_viewScaleRE:/^\s*(return\s+)?\$view\.scale\s*(;)?\s*$/i,_createCache:function(b){var a=b&&b.valueExpression,g=h.createSyntaxTree(a),e=h.createFunction(g),d=!(!b||!b.expression)||this._viewScaleRE.test(a);return{ipData:this._interpolateData(b),hasExpr:!!a,compiledFunc:e,syntaxTree:g,isScaleDriven:d,dependsOnView:g?h.dependsOnView(g):!1,isJSFunc:l.isFunction(b&&
b.field),version:c++}},_getCacheObjects:function(b){var a;b=b||this._cache;var c=[];for(a in b){var e=b[a];b.hasOwnProperty(a)&&e&&"object"===typeof e&&(e.hasOwnProperty("version")?c.push(e):c=c.concat(this._getCacheObjects(e)))}return c},_processColorInfo:function(b){b&&(d.forEach(b.colors,function(a,c){l.isArray(a)&&(b.colors[c]=new p(a))}),d.forEach(b.stops,function(a,c){a.color&&l.isArray(a.color)&&(b.stops[c].color=new p(a.color))}));return this._createCache(b)},getColor:function(b,a){var c=
this._getVarInfo(a&&a.colorInfo,"colorInfo");return this._getColorComponent(b,c.variable,this._cache[c.cacheKey])},setOpacityInfo:function(b){this.opacityInfo=b;this._cache.opacityInfo=this._processOpacityInfo(b);return this},_processOpacityInfo:function(b){return this._createCache(b)},getOpacity:function(b,a){var c=this._getVarInfo(a&&a.opacityInfo,"opacityInfo");return this._getColorComponent(b,c.variable,this._cache[c.cacheKey],!0)},_getColorComponent:function(b,a,c,e,h){var g="number"===typeof b?
b:null,f=c&&c.hasExpr,d=c&&c.ipData,n;a&&a.field||f?("number"!==typeof g&&"object"===typeof b&&b&&(g=this._getDataValue(b,a,null,c)),this._isValidNumber(g)||(g=null),null!=g&&(n=e?this._getOpacity(g,a,d):this._getColor(g,a,d))):a&&(b=a.stops,e?(n=b&&b[0]&&b[0].opacity,null==n&&(n=a.opacityValues&&a.opacityValues[0])):n=b&&b[0]&&b[0].color||a.colors&&a.colors[0]);h&&(h.data=g,h.value=n);return h||n},_isValidNumber:function(b){return"number"===typeof b&&!isNaN(b)&&Infinity!==b&&-Infinity!==b},_interpolateData:function(b){var a;
if(b)if(b.colors||b.opacityValues){var c=(b.colors||b.opacityValues).length,e=b.minDataValue,h=(b.maxDataValue-e)/(c-1);a=[];for(b=0;b<c;b++)a[b]=e+b*h}else b.stops&&(a=d.map(b.stops,function(a){return a.value}));return a},_getOpacity:function(b,a,c){b=this._lookupData(b,c);var g;a=a||this.opacityInfo;b&&(c=b[0],g=b[1],c===g?g=this._getOpacValue(a,c):(c=this._getOpacValue(a,c),a=this._getOpacValue(a,g),g=c+(a-c)*b[2]));return g},_getOpacValue:function(b,a){return b.opacityValues?b.opacityValues[a]:
b.stops[a].opacity},_getColor:function(b,a,c){b=this._lookupData(b,c);var g;a=a||this.colorInfo;b&&(g=b[0],c=b[1],g=g===c?this._getColorObj(a,g):p.blendColors(this._getColorObj(a,g),this._getColorObj(a,c),b[2]));return g},_getColorObj:function(b,a){return b.colors?b.colors[a]:b.stops[a].color},_lookupData:function(b,a){var c;if(a){var e=0,h=a.length-1;d.some(a,function(a,c){if(b<a)return h=c,!0;e=c;return!1});c=[e,h,(b-a[e])/(a[h]-a[e])]}return c},_meterIn:{inches:1/.0254,feet:1/.3048,yards:1/.9144,
miles:1/1609.344,"nautical-miles":1/1852,millimeters:1E3,centimeters:100,decimeters:10,meters:1,kilometers:.001,"decimal-degrees":180/20015077},_writeSizeInfo:function(b){if(b){b=l.mixin({},b);this._convertExpressionToArcade(b);var a=b.minSize,c=b.maxSize;a&&(b.minSize="number"===typeof a?k.px2pt(a):this._writeSizeInfo(a));c&&(b.maxSize="number"===typeof c?k.px2pt(c):this._writeSizeInfo(c));if(a=b.legendOptions)if(b.legendOptions=l.mixin({},a),a=a.customValues)b.legendOptions.customValues=a.slice(0);
b.stops&&(b.stops=d.map(b.stops,function(a){a=l.mixin({},a);a.size&&"number"===typeof a.size&&(a.size=k.px2pt(a.size));return a}))}return b},_writeColorInfo:function(b){b&&(b=l.mixin({},b),b.colors&&(b.colors=d.map(b.colors,function(a){return p.toJsonColor(a)})),b.stops&&(b.stops=d.map(b.stops,function(a){a=l.mixin({},a);a.color&&(a.color=p.toJsonColor(a.color));return a})),b.legendOptions&&(b.legendOptions=l.mixin({},b.legendOptions)));return b},_writeOpacityInfo:function(b){var a;b&&(a=l.mixin({},
b),a.opacityValues&&(a.transparencyValues=d.map(a.opacityValues,function(a){return 100*(1-a)}),delete a.opacityValues),a.stops&&(a.stops=d.map(a.stops,function(a){a=l.mixin({},a);a.transparency=100*(1-a.opacity);delete a.opacity;return a})),a.legendOptions&&(a.legendOptions=l.mixin({},a.legendOptions)));return a},toJson:function(b){var a=this.visualVariables,c=l.clone(this.authoringInfo),e=b&&b.useLegacyRotationProperties,h=(b=(b=this.getVisualVariablesForType("rotationInfo",!1))&&b[0])&&b.field,
t;b&&(b===this.rotationInfo||e)&&(t=b.expression||h&&(l.isFunction(h)?h:"["+h+"]"));a&&(a=d.map(a,function(a){"sizeInfo"===a.type?a=this._writeSizeInfo(a):"colorInfo"===a.type?a=this._writeColorInfo(a):"opacityInfo"===a.type?(a=this._writeOpacityInfo(a),a.type="transparencyInfo"):"rotationInfo"===a.type&&(a=e?null:l.mixin({},a));return a},this),a=d.filter(a,function(a){return null!=a}));c&&d.forEach(c.visualVariables,function(a){"opacityInfo"===a.type&&(a.type="transparencyInfo")});return{rotationType:t&&
(this._getRotationType(b)||"geographic"),rotationExpression:t,colorInfo:this._writeColorInfo(this.colorInfo),transparencyInfo:this._writeOpacityInfo(this.opacityInfo),sizeInfo:this._writeSizeInfo(this.sizeInfo),visualVariables:a,authoringInfo:c}}})})},"esri/renderers/arcadeUtils":function(){define(["dojo/_base/lang","dojo/_base/array","dojo/has","../kernel","../arcade/arcade"],function(r,l,d,q,k){var m={vars:{$feature:"any",$view:"any"}},p=/^\$feature\./i,h={createSyntaxTree:function(e,c){c=c||r.clone(m);
var b;try{b=e?k.parseScript(e,c):null}catch(a){b=null}return b},createFunction:function(e,c){c=c||r.clone(m);var b="string"===typeof e?h.createSyntaxTree(e,c):e,a;try{a=b?k.compileScript(b,c):null}catch(g){a=null}return a},createExecContext:function(e,c){return{vars:{$feature:k.constructFeature(e),$view:c&&c.view},spatialReference:c&&c.sr}},evalSyntaxTree:function(e,c){var b;try{b=k.executeScript(e,c,c.spatialReference)}catch(a){b=null}return b},executeFunction:function(e,c){var b;try{b=e?e(c,c.spatialReference):
null}catch(a){b=null}return b},extractFieldNames:function(e,c){var b="string"===typeof e?h.createSyntaxTree(e,c):e,b=k.extractFieldLiterals(b),a=[];l.forEach(b,function(b){p.test(b)&&(b=b.replace(p,""),a.push(b))});a.sort();return l.filter(a,function(b,c){return 0===c||a[c-1]!==b})},dependsOnView:function(e){return k.referencesMember(e,"$view")}};return h})},"esri/arcade/arcade":function(){define("require exports ./arcadeRuntime ./parser ./Feature ./arcadeCompiler dojo/has".split(" "),function(r,
l,d,q,k,m,p){Object.defineProperty(l,"__esModule",{value:!0});l.compileScript=function(h,e){return p("csp-restrictions")?function(c,b){return d.executeScript(h,c,b)}:m.compileScript(h,e)};l.constructFeature=function(h){return k.fromFeature(h)};l.parseScript=function(h){return q.parseScript(h)};l.validateScript=function(h,e){return q.validateScript(h,e,"simple")};l.scriptCheck=function(h,e,c){return q.scriptCheck(h,e,c,"full")};l.parseAndExecuteScript=function(h,e,c){return d.executeScript(q.parseScript(h),
e,c)};l.executeScript=function(h,e,c){return d.executeScript(h,e,c)};l.referencesMember=function(h,e){return d.referencesMember(h,e)};l.referencesFunction=function(h,e){return d.referencesFunction(h,e)};l.extractFieldLiterals=function(h,e){void 0===e&&(e=!1);return q.extractFieldLiterals(h,e)}})},"esri/arcade/arcadeRuntime":function(){define("require exports ../geometry/Polygon ../graphic ../geometry/Polyline ../geometry/Point ../geometry/Extent ../geometry/Multipoint ../SpatialReference ./languageUtils ./treeAnalysis ./Dictionary ./Feature ./FunctionWrapper ./functions/date ./functions/string ./functions/maths ./functions/geometry ./functions/stats ./ImmutablePathArray ./ImmutablePointArray ../geometry/Geometry".split(" "),
function(r,l,d,q,k,m,p,h,e,c,b,a,g,u,n,t,f,v,x,w,z,A){function y(a,b){for(var c=[],f=0;f<b.arguments.length;f++)c.push(C(a,b.arguments[f]));return c}function B(a,b,c){try{return c(a,b,y(a,b))}catch(la){throw la;}}function C(f,e){try{switch(e.type){case "EmptyStatement":return c.voidOperation;case "VariableDeclarator":var h=null===e.init?null:C(f,e.init);h===c.voidOperation&&(h=null);var d=e.id.name.toLowerCase();null!==f.localScope?f.localScope[d]={value:h,valueset:!0,node:e.init}:f.globalScope[d]=
{value:h,valueset:!0,node:e.init};return c.voidOperation;case "VariableDeclaration":for(var n=0;n<e.declarations.length;n++)C(f,e.declarations[n]);return c.voidOperation;case "BlockStatement":var t;a:{for(var k=c.voidOperation,n=0;n<e.body.length;n++)if(k=C(f,e.body[n]),k instanceof c.ReturnResult||k===c.breakResult||k===c.continueResult){t=k;break a}t=k}return t;case "FunctionDeclaration":var m=e.id.name.toLowerCase();f.globalScope[m]={valueset:!0,node:null,value:new u(e,f)};return c.voidOperation;
case "ReturnStatement":var p;if(null===e.argument)p=new c.ReturnResult(c.voidOperation);else{var l=C(f,e.argument);p=new c.ReturnResult(l)}return p;case "IfStatement":var v;if("AssignmentExpression"===e.test.type||"UpdateExpression"===e.test.type)throw Error(b.nodeErrorMessage(e.test,"RUNTIME","CANNOT_USE_ASSIGNMENT_IN_CONDITION"));var w=C(f,e.test);if(!0===w)v=C(f,e.consequent);else if(!1===w)v=null!==e.alternate?C(f,e.alternate):c.voidOperation;else throw Error(b.nodeErrorMessage(e,"RUNTIME","CANNOT_USE_NONBOOLEAN_IN_CONDITION"));
return v;case "ExpressionStatement":var x;if("AssignmentExpression"===e.expression.type||"UpdateExpression"===e.expression.type)x=C(f,e.expression);else{var q=C(f,e.expression);x=q===c.voidOperation?c.voidOperation:new c.ImplicitResult(q)}return x;case "AssignmentExpression":var z;var A=C(f,e.right),n=null,y="";if("MemberExpression"===e.left.type){n=C(f,e.left.object);y=!0===e.left.computed?C(f,e.left.property):e.left.property.name;if(c.isArray(n))if(c.isNumber(y)){0>y&&(y=n.length+y);if(0>y||y>n.length)throw Error("Assignment outside of array bounds");
if(y===n.length&&"\x3d"!==e.operator)throw Error("Invalid Parameter");n[y]=D(A,e.operator,n[y],e)}else throw Error("Invalid Parameter");else if(n instanceof a){if(!1===c.isString(y))throw Error("Dictionary accessor must be a string");if(!0===n.hasField(y))n.setField(y,D(A,e.operator,n.field(y),e));else{if("\x3d"!==e.operator)throw Error("Invalid Parameter");n.setField(y,D(A,e.operator,null,e))}}else if(n instanceof g){if(!1===c.isString(y))throw Error("Feature accessor must be a string");if(!0===
n.hasField(y))n.setField(y,D(A,e.operator,n.field(y),e));else{if("\x3d"!==e.operator)throw Error("Invalid Parameter");n.setField(y,D(A,e.operator,null,e))}}else{if(c.isImmutableArray(n))throw Error("Array is Immutable");throw Error("Invalid Parameter");}z=c.voidOperation}else if(n=e.left.name.toLowerCase(),null!==f.localScope&&void 0!==f.localScope[n])f.localScope[n]={value:D(A,e.operator,f.localScope[n].value,e),valueset:!0,node:e.right},z=c.voidOperation;else if(void 0!==f.globalScope[n])f.globalScope[n]=
{value:D(A,e.operator,f.globalScope[n].value,e),valueset:!0,node:e.right},z=c.voidOperation;else throw Error("Variable not recognised");return z;case "UpdateExpression":var r;var B,n=null,y="";if("MemberExpression"===e.argument.type){n=C(f,e.argument.object);y=!0===e.argument.computed?C(f,e.argument.property):e.argument.property.name;if(c.isArray(n))if(c.isNumber(y)){0>y&&(y=n.length+y);if(0>y||y>=n.length)throw Error("Assignment outside of array bounds");B=c.toNumber(n[y]);n[y]="++"===e.operator?
B+1:B-1}else throw Error("Invalid Parameter");else if(n instanceof a){if(!1===c.isString(y))throw Error("Dictionary accessor must be a string");if(!0===n.hasField(y))B=c.toNumber(n.field(y)),n.setField(y,"++"===e.operator?B+1:B-1);else throw Error("Invalid Parameter");}else if(n instanceof g){if(!1===c.isString(y))throw Error("Feature accessor must be a string");if(!0===n.hasField(y))B=c.toNumber(n.field(y)),n.setField(y,"++"===e.operator?B+1:B-1);else throw Error("Invalid Parameter");}else{if(c.isImmutableArray(n))throw Error("Array is Immutable");
throw Error("Invalid Parameter");}r=!1===e.prefix?B:"++"===e.operator?B+1:B-1}else if(n=e.argument.name.toLowerCase(),null!==f.localScope&&void 0!==f.localScope[n])B=c.toNumber(f.localScope[n].value),f.localScope[n]={value:"++"===e.operator?B+1:B-1,valueset:!0,node:e},r=!1===e.prefix?B:"++"===e.operator?B+1:B-1;else if(void 0!==f.globalScope[n])B=c.toNumber(f.globalScope[n].value),f.globalScope[n]={value:"++"===e.operator?B+1:B-1,valueset:!0,node:e},r=!1===e.prefix?B:"++"===e.operator?B+1:B-1;else throw Error("Variable not recognised");
return r;case "BreakStatement":return c.breakResult;case "ContinueStatement":return c.continueResult;case "ForStatement":null!==e.init&&C(f,e.init);y={testResult:!0,lastAction:c.voidOperation};do b:{z=f;A=e;r=y;if(null!==A.test){r.testResult=C(z,A.test);if(!1===r.testResult)break b;if(!0!==r.testResult)throw Error(b.nodeErrorMessage(A,"RUNTIME","CANNOT_USE_NONBOOLEAN_IN_CONDITION"));}r.lastAction=C(z,A.body);r.lastAction===c.breakResult?r.testResult=!1:r.lastAction instanceof c.ReturnResult?r.testResult=
!1:null!==A.update&&C(z,A.update)}while(!0===y.testResult);n=y.lastAction instanceof c.ReturnResult?y.lastAction:c.voidOperation;return n;case "ForInStatement":return E(f,e);case "Identifier":var F;var H;try{var ea=e.name.toLowerCase();if(null!==f.localScope&&void 0!==f.localScope[ea])H=f.localScope[ea],!0!==H.valueset&&(H.value=C(f,H.node),H.valueset=!0),F=H.value;else if(void 0!==f.globalScope[ea])H=f.globalScope[ea],!0!==H.valueset&&(H.value=C(f,H.node),H.valueset=!0),F=H.value;else throw Error(b.nodeErrorMessage(e,
"RUNTIME","VARIABLENOTFOUND"));}catch(Ha){throw Ha;}return F;case "MemberExpression":return G(f,e);case "Literal":return e.value;case "ThisExpression":throw Error(b.nodeErrorMessage(e,"RUNTIME","NOTSUPPORTED"));case "CallExpression":return L(f,e);case "UnaryExpression":return J(f,e);case "BinaryExpression":return N(f,e);case "LogicalExpression":return M(f,e);case "ConditionalExpression":throw Error(b.nodeErrorMessage(e,"RUNTIME","NOTSUPPORTED"));case "ArrayExpression":try{for(n=[],y=0;y<e.elements.length;y++){var K=
C(f,e.elements[y]);if(c.isFunctionParameter(K))throw Error(b.nodeErrorMessage(e,"RUNTIME","FUNCTIONCONTEXTILLEGAL"));K===c.voidOperation?n.push(null):n.push(K)}}catch(Ha){throw Ha;}return n;case "ObjectExpression":n={};for(y=0;y<e.properties.length;y++){var ca=C(f,e.properties[y]);if(c.isFunctionParameter(ca.value))throw Error("Illegal Argument");if(!1===c.isString(ca.key))throw Error("Illegal Argument");n[ca.key.toString()]=ca.value===c.voidOperation?null:ca.value}var W=new a(n);W.immutable=!1;return W;
case "Property":return{key:"Identifier"===e.key.type?e.key.name:C(f,e.key),value:C(f,e.value)};case "Array":throw Error(b.nodeErrorMessage(e,"RUNTIME","NOTSUPPORTED"));default:throw Error(b.nodeErrorMessage(e,"RUNTIME","UNREOGNISED"));}}catch(Ha){throw Ha;}}function E(f,e){var h=C(f,e.right);"VariableDeclaration"===e.left.type&&C(f,e.left);var d=null,n="VariableDeclaration"===e.left.type?e.left.declarations[0].id.name:e.left.name;null!==f.localScope&&void 0!==f.localScope[n]&&(d=f.localScope[n]);
null===d&&void 0!==f.globalScope[n]&&(d=f.globalScope[n]);if(null===d)throw Error(b.nodeErrorMessage(e,"RUNTIME","VARIABLENOTDECLARED"));if(c.isArray(h)||c.isString(h)){for(var h=h.length,t=0;t<h&&(d.value=t,n=C(f,e.body),n!==c.breakResult);t++)if(n instanceof c.ReturnResult)return n;return c.voidOperation}if(c.isImmutableArray(h)){for(t=0;t<h.length()&&(d.value=t,n=C(f,e.body),n!==c.breakResult);t++)if(n instanceof c.ReturnResult)return n;return c.voidOperation}if(h instanceof a||h instanceof g)for(h=
h.keys(),t=0;t<h.length&&(d.value=h[t],n=C(f,e.body),n!==c.breakResult);t++){if(n instanceof c.ReturnResult)return n}else return c.voidOperation}function D(a,f,g,e){switch(f){case "\x3d":return a===c.voidOperation?null:a;case "/\x3d":return c.toNumber(g)/c.toNumber(a);case "*\x3d":return c.toNumber(g)*c.toNumber(a);case "-\x3d":return c.toNumber(g)-c.toNumber(a);case "+\x3d":return c.isString(g)||c.isString(a)?c.toString(g)+c.toString(a):c.toNumber(g)+c.toNumber(a);case "%\x3d":return c.toNumber(g)%
c.toNumber(a);default:throw Error(b.nodeErrorMessage(e,"RUNTIME","OPERATORNOTRECOGNISED"));}}function F(f,g,e,h){g=g.toLowerCase();switch(g){case "hasz":return f=f.hasZ,void 0===f?!1:f;case "hasm":return f=f.hasM,void 0===f?!1:f;case "spatialreference":return g=f.spatialReference._arcadeCacheId,void 0===g&&(e=!0,Object.freeze&&Object.isFrozen(f.spatialReference)&&(e=!1),e&&(Y++,g=f.spatialReference._arcadeCacheId=Y)),f=new a({wkt:f.spatialReference.wkt,wkid:f.spatialReference.wkid}),void 0!==g&&(f._arcadeCacheId=
"SPREF"+g.toString()),f}switch(f.type){case "extent":switch(g){case "xmin":case "xmax":case "ymin":case "ymax":case "zmin":case "zmax":case "mmin":case "mmax":return f=f[g],void 0!==f?f:null;case "type":return"Extent"}break;case "polygon":switch(g){case "rings":return g=c.isVersion4?f.cache._arcadeCacheId:f.getCacheValue("_arcadeCacheId"),void 0===g&&(Y++,g=Y,c.isVersion4?f.cache._arcadeCacheId=g:f.setCacheValue("_arcadeCacheId",g)),f=new w(f.rings,f.spatialReference,!0===f.hasZ,!0===f.hasM,g);case "type":return"Polygon"}break;
case "point":switch(g){case "x":case "y":case "z":case "m":return void 0!==f[g]?f[g]:null;case "type":return"Point"}break;case "polyline":switch(g){case "paths":return g=c.isVersion4?f.cache._arcadeCacheId:f.getCacheValue("_arcadeCacheId"),void 0===g&&(Y++,g=Y,c.isVersion4?f.cache._arcadeCacheId=g:f.setCacheValue("_arcadeCacheId",g)),f=new w(f.paths,f.spatialReference,!0===f.hasZ,!0===f.hasM,g);case "type":return"Polyline"}break;case "multipoint":switch(g){case "points":return g=c.isVersion4?f.cache._arcadeCacheId:
f.getCacheValue("_arcadeCacheId"),void 0===g&&(Y++,g=Y,c.isVersion4?f.cache._arcadeCacheId=g:f.setCacheValue("_arcadeCacheId",g)),f=new z(f.points,f.spatialReference,!0===f.hasZ,!0===f.hasM,g,1);case "type":return"Multipoint"}}throw Error(b.nodeErrorMessage(h,"RUNTIME","PROPERTYNOTFOUND"));}function G(f,e){try{var h=C(f,e.object);if(null===h)throw Error(b.nodeErrorMessage(e,"RUNTIME","NOTFOUND"));if(!1===e.computed){if(h instanceof a||h instanceof g)return h.field(e.property.name);if(h instanceof
A)return F(h,e.property.name,f,e);throw Error(b.nodeErrorMessage(e,"RUNTIME","INVALIDTYPE"));}var d=C(f,e.property);if(h instanceof a||h instanceof g){if(c.isString(d))return h.field(d)}else if(h instanceof A){if(c.isString(d))return F(h,d,f,e)}else if(c.isArray(h)){if(c.isNumber(d)&&isFinite(d)&&Math.floor(d)===d){0>d&&(d=h.length+d);if(d>=h.length||0>d)throw Error(b.nodeErrorMessage(e,"RUNTIME","OUTOFBOUNDS"));return h[d]}}else if(c.isString(h)){if(c.isNumber(d)&&isFinite(d)&&Math.floor(d)===d){0>
d&&(d=h.length+d);if(d>=h.length||0>d)throw Error(b.nodeErrorMessage(e,"RUNTIME","OUTOFBOUNDS"));return h[d]}}else if(c.isImmutableArray(h)&&c.isNumber(d)&&isFinite(d)&&Math.floor(d)===d){0>d&&(d=h.length()+d);if(d>=h.length()||0>d)throw Error(b.nodeErrorMessage(e,"RUNTIME","OUTOFBOUNDS"));return h.get(d)}throw Error(b.nodeErrorMessage(e,"RUNTIME","INVALIDTYPE"));}catch(ma){throw ma;}}function J(a,f){try{var g=C(a,f.argument);if(c.isBoolean(g)){if("!"===f.operator)return!g;if("-"===f.operator)return-1*
c.toNumber(g);if("+"===f.operator)return 1*c.toNumber(g);throw Error(b.nodeErrorMessage(f,"RUNTIME","NOTSUPPORTEDUNARYOPERATOR"));}if("-"===f.operator)return-1*c.toNumber(g);if("+"===f.operator)return 1*c.toNumber(g);throw Error(b.nodeErrorMessage(f,"RUNTIME","NOTSUPPORTEDUNARYOPERATOR"));}catch(la){throw la;}}function N(a,f){try{var g=[C(a,f.left),C(a,f.right)],e=g[0],h=g[1];switch(f.operator){case "\x3d\x3d":return c.equalityTest(e,h);case "\x3d":return c.equalityTest(e,h);case "!\x3d":return!c.equalityTest(e,
h);case "\x3c":return c.greaterThanLessThan(e,h,f.operator);case "\x3e":return c.greaterThanLessThan(e,h,f.operator);case "\x3c\x3d":return c.greaterThanLessThan(e,h,f.operator);case "\x3e\x3d":return c.greaterThanLessThan(e,h,f.operator);case "+":return c.isString(e)||c.isString(h)?c.toString(e)+c.toString(h):c.toNumber(e)+c.toNumber(h);case "-":return c.toNumber(e)-c.toNumber(h);case "*":return c.toNumber(e)*c.toNumber(h);case "/":return c.toNumber(e)/c.toNumber(h);case "%":return c.toNumber(e)%
c.toNumber(h);default:throw Error(b.nodeErrorMessage(f,"RUNTIME","OPERATORNOTRECOGNISED"));}}catch(sa){throw sa;}}function M(a,f){try{if("AssignmentExpression"===f.left.type||"UpdateExpression"===f.left.type)throw Error(b.nodeErrorMessage(f.left,"RUNTIME","CANNOT_USE_ASSIGNMENT_IN_CONDITION"));if("AssignmentExpression"===f.right.type||"UpdateExpression"===f.right.type)throw Error(b.nodeErrorMessage(f.right,"RUNTIME","CANNOT_USE_ASSIGNMENT_IN_CONDITION"));var g=C(a,f.left);if(c.isBoolean(g))switch(f.operator){case "||":if(!0===
g)return g;var e=C(a,f.right);if(c.isBoolean(e))return e;throw Error(b.nodeErrorMessage(f,"RUNTIME","ONLYORORAND"));case "\x26\x26":if(!1===g)return g;e=C(a,f.right);if(c.isBoolean(e))return e;throw Error(b.nodeErrorMessage(f,"RUNTIME","ONLYORORAND"));default:throw Error(b.nodeErrorMessage(f,"RUNTIME","ONLYORORAND"));}else throw Error(b.nodeErrorMessage(f,"RUNTIME","ONLYBOOLEAN"));}catch(ma){throw ma;}}function L(a,f){try{if("Identifier"!==f.callee.type)throw Error(b.nodeErrorMessage(f,"RUNTIME",
"ONLYNODESSUPPORTED"));if(null!==a.localScope&&void 0!==a.localScope[f.callee.name.toLowerCase()]){var g=a.localScope[f.callee.name.toLowerCase()];if(g.value instanceof c.NativeFunction)return g.value.fn(a,f);if(g.value instanceof u)return Q(a,f,g.value.definition);throw Error(b.nodeErrorMessage(f,"RUNTIME","NOTAFUNCTION"));}if(void 0!==a.globalScope[f.callee.name.toLowerCase()]){g=a.globalScope[f.callee.name.toLowerCase()];if(g.value instanceof c.NativeFunction)return g.value.fn(a,f);if(g.value instanceof
u)return Q(a,f,g.value.definition);throw Error(b.nodeErrorMessage(f,"RUNTIME","NOTAFUNCTION"));}throw Error(b.nodeErrorMessage(f,"RUNTIME","NOTFOUND"));}catch(la){throw la;}}function K(b){return null==b?"":c.isArray(b)||c.isImmutableArray(b)?"Array":c.isDate(b)?"Date":c.isString(b)?"String":c.isBoolean(b)?"Boolean":c.isNumber(b)?"Number":b instanceof a?"Dictionary":b instanceof g?"Feature":b instanceof m?"Point":b instanceof d?"Polygon":b instanceof k?"Polyline":b instanceof h?"Multipoint":b instanceof
p?"Extent":c.isFunctionParameter(b)?"Function":b===c.voidOperation?"":"number"===typeof b&&isNaN(b)?"Number":"Unrecognised Type"}function W(a,b,f,g){try{var e=C(a,b.arguments[f]);if(c.equalityTest(e,g))return C(a,b.arguments[f+1]);var h=b.arguments.length-f;return 1===h?C(a,b.arguments[f]):2===h?null:3===h?C(a,b.arguments[f+2]):W(a,b,f+2,g)}catch(ka){throw ka;}}function R(a,b,f,g){try{if(!0===g)return C(a,b.arguments[f+1]);if(3===b.arguments.length-f)return C(a,b.arguments[f+2]);var e=C(a,b.arguments[f+
2]);if(!1===c.isBoolean(e))throw Error("WHEN needs boolean test conditions");return R(a,b,f+2,e)}catch(sa){throw sa;}}function ba(a,b){var c=a.length,f=Math.floor(c/2);if(0===c)return[];if(1===c)return[a[0]];for(var g=ba(a.slice(0,f),b),c=ba(a.slice(f,c),b),f=[];0<g.length||0<c.length;)if(0<g.length&&0<c.length){var e=b(g[0],c[0]);isNaN(e)&&(e=0);0>=e?(f.push(g[0]),g=g.slice(1)):(f.push(c[0]),c=c.slice(1))}else 0<g.length?(f.push(g[0]),g=g.slice(1)):0<c.length&&(f.push(c[0]),c=c.slice(1));return f}
function O(a,b,f){try{var g=a.body;if(f.length!==a.params.length)throw Error("Invalid Parameter calls to function.");for(var e=0;e<f.length;e++)b.localScope[a.params[e].name.toLowerCase()]={d:null,value:f[e],valueset:!0,node:null};var h=C(b,g);if(h instanceof c.ReturnResult)return h.value;if(h===c.breakResult)throw Error("Cannot Break from a Function");if(h===c.continueResult)throw Error("Cannot Continue from a Function");return h instanceof c.ImplicitResult?h.value:h}catch(ka){throw ka;}}function Q(a,
b,c){return B(a,b,function(b,f,g){b={spatialReference:a.spatialReference,applicationCache:void 0===a.applicationCache?null:a.applicationCache,globalScope:a.globalScope,depthCounter:a.depthCounter+1,console:a.console,localScope:{}};if(64<b.depthCounter)throw Error("Exceeded maximum function depth");return O(c,b,g)})}function U(a){return function(){var b={applicationCache:void 0===a.context.applicationCache?null:a.context.applicationCache,spatialReference:a.context.spatialReference,console:a.context.console,
localScope:{},depthCounter:a.context.depthCounter+1,globalScope:a.context.globalScope};if(64<b.depthCounter)throw Error("Exceeded maximum function depth");return O(a.definition,b,arguments)}}function ia(a){console.log(a)}Object.defineProperty(l,"__esModule",{value:!0});var Y=0,ca={};n.registerFunctions(ca,B);t.registerFunctions(ca,B);f.registerFunctions(ca,B);v.registerFunctions(ca,B);x.registerFunctions(ca,B);ca["typeof"]=function(a,b){return B(a,b,function(a,b,f){c.pcCheck(f,1,1);a=K(f[0]);if("Unrecognised Type"===
a)throw Error("Unrecognised Type");return a})};ca.iif=function(a,b){try{c.pcCheck(null===b.arguments?[]:b.arguments,3,3);var f=C(a,b.arguments[0]);if(!1===c.isBoolean(f))throw Error("IF Function must have a boolean test condition");return!0===f?C(a,b.arguments[1]):C(a,b.arguments[2])}catch(la){throw la;}};ca.decode=function(a,b){try{if(2>b.arguments.length)throw Error("Missing Parameters");if(2===b.arguments.length)return C(a,b.arguments[1]);if(0===(b.arguments.length-1)%2)throw Error("Must have a default value result.");
var c=C(a,b.arguments[0]);return W(a,b,1,c)}catch(la){throw la;}};ca.when=function(a,b){try{if(3>b.arguments.length)throw Error("Missing Parameters");if(0===b.arguments.length%2)throw Error("Must have a default value result.");var f=C(a,b.arguments[0]);if(!1===c.isBoolean(f))throw Error("WHEN needs boolean test conditions");return R(a,b,0,f)}catch(la){throw la;}};ca.top=function(a,b){return B(a,b,function(a,b,f){c.pcCheck(f,2,2);if(c.isArray(f[0]))return c.toNumber(f[1])>=f[0].length?f[0].slice(0):
f[0].slice(0,c.toNumber(f[1]));if(c.isImmutableArray(f[0]))return c.toNumber(f[1])>=f[0].length()?f[0].slice(0):f[0].slice(0,c.toNumber(f[1]));throw Error("Top cannot accept this parameter type");})};ca.first=function(a,b){return B(a,b,function(a,b,f){c.pcCheck(f,1,1);return c.isArray(f[0])?0===f[0].length?null:f[0][0]:c.isImmutableArray(f[0])?0===f[0].length()?null:f[0].get(0):null})};ca.sort=function(a,b){return B(a,b,function(a,b,f){c.pcCheck(f,1,2);a=f[0];c.isImmutableArray(a)&&(a=a.toArray());
if(!1===c.isArray(a))throw Error("Illegal Argument");if(1<f.length){if(!1===c.isFunctionParameter(f[1]))throw Error("Illegal Argument");var g=U(f[1]);a=ba(a,function(a,b){return g(a,b)})}else{if(0===a.length)return[];f={};for(b=0;b<a.length;b++){var e=K(a[b]);""!==e&&(f[e]=!0)}if(!0===f.Array||!0===f.Dictionary||!0===f.Feature||!0===f.Point||!0===f.Polygon||!0===f.Polyline||!0===f.Multipoint||!0===f.Extent||!0===f.Function)return a.slice(0);b=0;var e="",h;for(h in f)b++,e=h;a=1<b||"String"===e?ba(a,
function(a,b){if(null===a||void 0===a||a===c.voidOperation)return null===b||void 0===b||b===c.voidOperation?0:1;if(null===b||void 0===b||b===c.voidOperation)return-1;var f=c.toString(a),g=c.toString(b);return f<g?-1:f===g?0:1}):"Number"===e?ba(a,function(a,b){return a-b}):"Boolean"===e?ba(a,function(a,b){return a===b?0:b?-1:1}):"Date"===e?ba(a,function(a,b){return b-a}):a.slice(0)}return a})};l.functionHelper={fixSpatialReference:c.fixSpatialReference,parseArguments:y,standardFunction:B};l.executeScript=
function(b,f,h){h||(h=new e(102100));var d=f.vars,n=f.customfunctions,t={};d||(d={});n||(n={});var k=new a({newline:"\n",tab:"\t",singlequote:"'",doublequote:'"',forwardslash:"/",backwardslash:"\\"});k.immutable=!1;t.textformatting={value:k,valueset:!0,node:null};t.infinity={value:Number.POSITIVE_INFINITY,valueset:!0,node:null};t.pi={value:Math.PI,valueset:!0,node:null};for(var m in ca)t[m]={value:new c.NativeFunction(ca[m]),valueset:!0,node:null};for(m in n)t[m]={value:new c.NativeFunction(n[m]),
"native":!0,valueset:!0,node:null};for(m in d)t[m]=d[m]instanceof q?{value:new g(d[m]),valueset:!0,node:null}:{value:d[m],valueset:!0,node:null};b=C({spatialReference:h,globalScope:t,localScope:null,console:f.console?f.console:ia,depthCounter:1,applicationCache:void 0===f.applicationCache?null:f.applicationCache},b.body[0].body);b instanceof c.ReturnResult&&(b=b.value);b instanceof c.ImplicitResult&&(b=b.value);b===c.voidOperation&&(b=null);if(b===c.breakResult)throw Error("Cannot return BREAK");
if(b===c.continueResult)throw Error("Cannot return CONTINUE");if(b instanceof u)throw Error("Cannot return FUNCTION");if(b instanceof c.NativeFunction)throw Error("Cannot return FUNCTION");return b};l.extractFieldLiterals=function(a,c){void 0===c&&(c=!1);return b.findFieldLiterals(a,c)};l.validateScript=function(a,c){return b.validateScript(a,c,"simple")};l.referencesMember=function(a,c){return b.referencesMember(a,c)};l.referencesFunction=function(a,c){return b.referencesFunction(a,c)}})},"esri/arcade/treeAnalysis":function(){define(["require",
"exports"],function(r,l){function d(a,b,c,g){void 0!==a.fmin&&(a.min=a.fmin);void 0!==a.fmax&&(a.max=a.fmax);return"0"!==a.min&&c.length<Number(a.min)||"*"!==a.max&&c.length>Number(a.max)?-2:1}function q(a,b,c){if(null!==c.localScope&&void 0!==c.localScope[a.toLowerCase()]){var f=c.localScope[a.toLowerCase()];if("FormulaFunction"===f.type||"any"===f.type)return void 0===f.signature&&(f.signature={min:"0",max:"*"}),d(f.signature,a,b,c)}return void 0!==c.globalScope[a.toLowerCase()]&&(f=c.globalScope[a.toLowerCase()],
"FormulaFunction"===f.type||"any"===f.type)?(void 0===f.signature&&(f.signature={min:"0",max:"*"}),d(f.signature,a,b,c)):-1}function k(a,b){void 0===b&&(b=!0);var c=g(a,"SYNTAX","UNREOGNISED");try{switch(a.type){case "VariableDeclarator":return null!==a.init&&"FunctionExpression"===a.init.type?g(a,"SYNTAX","FUNCTIONVARIABLEDECLARATOR"):"Identifier"!==a.id.type?g(a,"SYNTAX","VARIABLEMUSTHAVEIDENTIFIER"):null!==a.init?k(a.init,!1):"";case "VariableDeclaration":for(var f=0;f<a.declarations.length;f++)if(c=
k(a.declarations[f],b),""!==c)return c;return"";case "ForInStatement":c=k(a.left,b);if(""!==c)break;if("VariableDeclaration"===a.left.type){if(1<a.left.declarations.length)return g(a,"SYNTAX","ONLY1VAR");if(null!==a.left.declarations[0].init)return g(a,"SYNTAX","CANNOTDECLAREVAL")}else if("Identifier"!==a.left.type)return g(a,"SYNTAX","LEFTNOTVAR");c=k(a.right,b);if(""!==c)break;c=k(a.body,b);if(""!==c)break;return"";case "ForStatement":if(null!==a.test&&(c=k(a.test,b),""!==c))break;if(null!==a.init&&
(c=k(a.init,b),""!==c))break;if(null!==a.update&&(c=k(a.update,b),""!==c))break;if(null!==a.body&&(c=k(a.body,b),""!==c))break;return"";case "ContinueStatement":return"";case "EmptyStatement":return"";case "BreakStatement":return"";case "IfStatement":c=k(a.test,b);if(""!==c)break;if(null!==a.consequent&&(c=k(a.consequent,!1),""!==c))break;if(null!==a.alternate&&(c=k(a.alternate,!1),""!==c))break;return"";case "BlockStatement":for(var e=[],f=0;f<a.body.length;f++)"EmptyStatement"!==a.body[f].type&&
e.push(a.body[f]);a.body=e;for(f=0;f<a.body.length;f++)if(c=k(a.body[f],b),""!==c)return c;return"";case "FunctionDeclaration":return!1===b?g(a,"SYNTAX","GLOBALFUNCTIONSONLY"):"Identifier"!==a.id.type?g(a,"SYNTAX","FUNCTIONMUSTHAVEIDENTIFIER"):k(a.body,!1);case "ReturnStatement":return null!==a.argument?k(a.argument,b):"";case "UpdateExpression":return"Identifier"!==a.argument.type&&"MemberExpression"!==a.argument.type?g(a,"SYNTAX","ASSIGNMENTTOVARSONLY"):k(a.argument,b);case "AssignmentExpression":if("Identifier"!==
a.left.type&&"MemberExpression"!==a.left.type)return g(a,"SYNTAX","ASSIGNMENTTOVARSONLY");c=k(a.left,b);if(""!==c)break;switch(a.operator){case "\x3d":case "/\x3d":case "*\x3d":case "%\x3d":case "+\x3d":case "-\x3d":break;default:return g(a,"SYNTAX","OPERATORNOTRECOGNISED")}return k(a.right,!1);case "ExpressionStatement":return k(a.expression,!1);case "Identifier":c="";break;case "MemberExpression":c=k(a.object,b);if(""!==c)break;return!0===a.computed?k(a.property,b):"";case "Literal":return"";case "ThisExpression":return g(a,
"SYNTAX","NOTSUPPORTED");case "CallExpression":if("Identifier"!==a.callee.type)return g(a,"SYNTAX","ONLYNODESSUPPORTED");c="";for(f=0;f<a.arguments.length;f++)if(c=k(a.arguments[f],b),""!==c)return c;return"";case "UnaryExpression":c=k(a.argument,b);break;case "BinaryExpression":c=k(a.left,b);if(""!==c)break;c=k(a.right,b);if(""!==c)break;switch(a.operator){case "\x3d\x3d":case "!\x3d":case "\x3c":case "\x3c\x3d":case "\x3e":case "\x3e\x3d":case "+":case "-":case "*":case "/":case "%":break;default:return g(a,
"SYNTAX","OPERATORNOTRECOGNISED")}return"";case "LogicalExpression":c=k(a.left,b);if(""!==c)break;c=k(a.right);if(""!==c)break;switch(a.operator){case "\x26\x26":case "||":break;default:return g(a,"SYNTAX","OPERATORNOTRECOGNISED")}return"";case "ConditionalExpression":return g(a,"SYNTAX","NOTSUPPORTED");case "ArrayExpression":c="";for(f=0;f<a.elements.length&&(c=k(a.elements[f],b),""===c);f++);break;case "Array":return g(a,"SYNTAX","NOTSUPPORTED");case "ObjectExpression":c="";for(f=0;f<a.properties.length&&
(c="",null!==a.properties[f].key&&("Literal"!==a.properties[f].key.type&&"Identifier"!==a.properties[f].key.type&&(c=g(a,"SYNTAX","OBJECTPROPERTYMUSTBESTRING")),"Literal"===a.properties[f].key.type&&(e=a.properties[f].key.value,"string"===typeof e||e instanceof String||(c=g(a,"SYNTAX","OBJECTPROPERTYMUSTBESTRING")))),""===c&&(c=k(a.properties[f],b)),""===c);f++);break;case "Property":if("Literal"!==a.key.type&&"Identifier"!==a.key.type)return g(a,"SYNTAX","ONLYLITERAL");if("Identifier"!==a.key.type&&
(c=k(a.key,b),""!==c))break;c=k(a.value,b)}return c}catch(A){throw A;}}function m(a,e){var f=g(a,"SYNTAX","UNREOGNISED"),h=null,d="";try{switch(a.type){case "VariableDeclarator":if(null!==a.init&&"FunctionExpression"===a.init.type)return g(a,"SYNTAX","FUNCTIONVARIABLEDECLARATOR");null!==e.localScope?void 0!==e.localScope[a.id.name.toLowerCase()]&&a.id.name.toLowerCase():void 0!==e.globalScope[a.id.name.toLowerCase()]&&a.id.name.toLowerCase();var n=null===a.init?"":m(a.init,e);if(""!==n)return n;null===
e.localScope?e.globalScope[a.id.name.toLowerCase()]={type:"any"}:e.localScope[a.id.name.toLowerCase()]={type:"any"};return"";case "FunctionDeclaration":h=c(a.id.name.toLowerCase(),a,e);d=b(a,e);if(""!==d)return d;if(null!==e.localScope)return g(a,"SYNTAX","GLOBALFUNCTIONSONLY");h.isnative=!1;e.globalScope[a.id.name.toLowerCase()]={type:"FormulaFunction",signature:[h]};return"";case "VariableDeclaration":for(var f="",t=0;t<a.declarations.length&&(f=m(a.declarations[t],e),""===f);t++);break;case "IfStatement":f=
m(a.test,e);if(""!==f)break;if("AssignmentExpression"===a.test.type||"UpdateExpression"===a.test.type)return g(a.test,"SYNTAX","CANNOT_USE_ASSIGNMENT_IN_CONDITION");if(null!==a.consequent&&(f=m(a.consequent,e),""!==f))break;if(null!==a.alternate&&(f=m(a.alternate,e),""!==f))break;return"";case "EmptyStatement":return"";case "BlockStatement":for(t=0;t<a.body.length;t++)if(f=m(a.body[t],e),""!==f)return f;return"";case "ReturnStatement":return null!==a.argument?m(a.argument,e):"";case "ForInStatement":if("VariableDeclaration"===
a.left.type){if(1<a.left.declarations.length)return g(a,"SYNTAX","ONLY1VAR");if(null!==a.left.declarations[0].init)return g(a,"SYNTAX","CANNOTDECLAREVAL")}else if("Identifier"!==a.left.type)return g(a,"SYNTAX","LEFTNOTVAR");f=m(a.left,e);if(""!==f)break;f=m(a.right,e);if(""!==f)break;f=m(a.body,e);if(""!==f)break;return"";case "ForStatement":if(null!==a.init&&(f=m(a.init,e),""!==f))break;if(null!==a.test&&(f=m(a.test,e),""!==f))break;if(null!==a.body&&(f=m(a.body,e),""!==f))break;if(null!==a.update&&
(f=m(a.update,e),""!==f))break;return"";case "BreakStatement":return"";case "ContinueStatement":return"";case "UpdateExpression":if("Identifier"!==a.argument.type&&"MemberExpression"!==a.argument.type)return g(a,"SYNTAX","ASSIGNMENTTOVARSONLY");var u=!1;if("MemberExpression"===a.argument.type)return m(a.argument,e);null!==e.localScope&&void 0!==e.localScope[a.argument.name.toLowerCase()]&&(u=!0);void 0!==e.globalScope[a.argument.name.toLowerCase()]&&(u=!0);return!1===u?"Identifier "+a.argument.name+
" has not been declared.":"";case "AssignmentExpression":if("Identifier"!==a.left.type&&"MemberExpression"!==a.left.type)return g(a,"SYNTAX","ASSIGNMENTTOVARSONLY");var k=m(a.right,e);if(""!==k)return k;u=!1;if("MemberExpression"===a.left.type)return k=m(a.left,e),""!==k?k:"";null!==e.localScope&&void 0!==e.localScope[a.left.name.toLowerCase()]&&(u=!0);void 0!==e.globalScope[a.left.name.toLowerCase()]&&(u=!0);return!1===u?"Identifier "+a.left.name+" has not been declared.":"";case "ExpressionStatement":return m(a.expression,
e);case "Identifier":var p=a.name.toLowerCase();if(null!==e.localScope&&void 0!==e.localScope[p])return"";f=void 0!==e.globalScope[p]?"":g(a,"SYNTAX","VARIABLENOTFOUND");break;case "MemberExpression":f=m(a.object,e);if(""!==f)break;return!0===a.computed?m(a.property,e):"";case "Literal":return"";case "ThisExpression":f=g(a,"SYNTAX","NOTSUPPORTED");break;case "CallExpression":if("Identifier"!==a.callee.type)return g(a,"SYNTAX","ONLYNODESSUPPORTED");f="";for(t=0;t<a.arguments.length;t++)if(f=m(a.arguments[t],
e),""!==f)return f;var l=q(a.callee.name,a.arguments,e);-1===l&&(f=g(a,"SYNTAX","NOTFOUND"));-2===l&&(f=g(a,"SYNTAX","WRONGSIGNATURE"));break;case "UnaryExpression":f=m(a.argument,e);break;case "BinaryExpression":f=m(a.left,e);if(""!==f)break;f=m(a.right,e);if(""!==f)break;return"";case "LogicalExpression":f=m(a.left,e);if(""!==f)break;if("AssignmentExpression"===a.left.type||"UpdateExpression"===a.left.type)return g(a.left,"SYNTAX","CANNOT_USE_ASSIGNMENT_IN_CONDITION");f=m(a.right,e);if(""!==f)break;
return"AssignmentExpression"===a.right.type||"UpdateExpression"===a.right.type?g(a.right,"SYNTAX","CANNOT_USE_ASSIGNMENT_IN_CONDITION"):"";case "ConditionalExpression":return g(a,"SYNTAX","NOTSUPPORTED");case "ArrayExpression":f="";for(t=0;t<a.elements.length&&(f=m(a.elements[t],e),""===f);t++);break;case "ObjectExpression":f="";for(t=0;t<a.properties.length;t++){f="";if(null!==a.properties[t].key&&("Literal"!==a.properties[t].key.type&&"Identifier"!==a.properties[t].key.type&&(f=g(a,"SYNTAX","OBJECTPROPERTYMUSTBESTRING")),
"Literal"===a.properties[t].key.type)){var v=a.properties[t].key.value;"string"===typeof v||v instanceof String||(f=g(a,"SYNTAX","OBJECTPROPERTYMUSTBESTRING"))}""===f&&(f=m(a.properties[t],e));if(""!==f)break}break;case "Property":if("Literal"!==a.key.type&&"Identifier"!==a.key.type)return g(a,"SYNTAX","ONLYLITERAL");if("Identifier"!==a.key.type&&(f=m(a.key,e),""!==f))break;f=m(a.value,e);break;case "Array":return g(a,"SYNTAX","NOTSUPPORTED")}return f}catch(G){throw G;}}function p(a,b){var c=!1;try{switch(a.type){case "VariableDeclarator":return null!==
a.init?p(a.init,b):c;case "FunctionDeclaration":return p(a.body,b);case "VariableDeclaration":for(var f=0;f<a.declarations.length;f++)if(p(a.declarations[f],b))return!0;return c;case "IfStatement":return p(a.test,b)||null!==a.consequent&&p(a.consequent,b)||null!==a.alternate&&p(a.alternate,b)?!0:c;case "EmptyStatement":return c;case "BlockStatement":for(f=0;f<a.body.length;f++)if(p(a.body[f],b))return!0;return c;case "ReturnStatement":return null!==a.argument?p(a.argument,b):c;case "UpdateExpression":return p(a.argument,
b);case "AssignmentExpression":return(c=p(a.right,b))?c:p(a.left,b);case "ExpressionStatement":return p(a.expression,b);case "ForInStatement":return(c=p(a.left,b))||(c=p(a.right,b))?c:c=p(a.body,b);case "ForStatement":if(null!==a.init&&(c=p(a.init,b))||null!==a.test&&(c=p(a.test,b))||null!==a.body&&(c=p(a.body,b)))return c;null!==a.update&&(c=p(a.update,b));return c;case "BreakStatement":return c;case "ContinueStatement":return c;case "Compound":return c;case "Identifier":return b.toLowerCase()===
a.name.toLowerCase();case "MemberExpression":if(c=p(a.object,b))return c;!0===a.computed&&(c=p(a.property,b));return c;case "Literal":return c;case "ThisExpression":return c;case "CallExpression":for(f=0;f<a.arguments.length;f++)p(a.arguments[f],b)&&(c=!0);return c;case "ArrayExpression":for(f=0;f<a.elements.length;f++)p(a.elements[f],b)&&(c=!0);return c;case "UnaryExpression":return p(a.argument,b);case "BinaryExpression":return(c=p(a.left,b))?c:c=p(a.right,b);case "LogicalExpression":return(c=p(a.left,
b))?c:c=p(a.right,b);case "ObjectExpression":for(f=0;f<a.properties.length;f++)p(a.properties[f],b)&&(c=!0);return c;case "Property":return c=p(a.value,b);case "ConditionalExpression":return c;case "Array":return c;default:return c}}catch(z){throw z;}}function h(a,b){var c=!1;try{switch(a.type){case "VariableDeclarator":return null!==a.init?h(a.init,b):c;case "FunctionDeclaration":return h(a.body,b);case "VariableDeclaration":for(var f=0;f<a.declarations.length;f++)if(h(a.declarations[f],b))return!0;
return c;case "IfStatement":return h(a.test,b)||null!==a.consequent&&h(a.consequent,b)||null!==a.alternate&&h(a.alternate,b)?!0:c;case "EmptyStatement":return c;case "BlockStatement":for(f=0;f<a.body.length;f++)if(h(a.body[f],b))return!0;return c;case "ReturnStatement":return null!==a.argument?h(a.argument,b):c;case "UpdateExpression":return h(a.argument,b);case "AssignmentExpression":return h(a.left,b)?!0:h(a.right,b);case "ExpressionStatement":return h(a.expression,b);case "ForInStatement":return(c=
h(a.left,b))||(c=h(a.right,b))?c:c=h(a.body,b);case "ForStatement":if(null!==a.init&&(c=h(a.init,b))||null!==a.test&&(c=h(a.test,b))||null!==a.body&&(c=h(a.body,b)))return c;null!==a.update&&(c=h(a.update,b));return c;case "BreakStatement":return c;case "ContinueStatement":return c;case "Compound":return c;case "Identifier":return c;case "MemberExpression":if(c=h(a.object,b))return c;!0===a.computed&&(c=h(a.property,b));return c;case "Literal":return c;case "ThisExpression":return c;case "CallExpression":if(a.callee.name.toLowerCase()===
b.toLowerCase())return!0;for(f=0;f<a.arguments.length;f++)h(a.arguments[f],b)&&(c=!0);return c;case "ArrayExpression":for(f=0;f<a.elements.length;f++)h(a.elements[f],b)&&(c=!0);return c;case "UnaryExpression":return h(a.argument,b);case "BinaryExpression":return(c=h(a.left,b))?c:c=h(a.right,b);case "LogicalExpression":return(c=h(a.left,b))?c:c=h(a.right,b);case "ConditionalExpression":return c;case "ObjectExpression":for(f=0;f<a.properties.length;f++)h(a.properties[f],b)&&(c=!0);return c;case "Property":return c=
h(a.value,b);case "Array":return c;default:return c}}catch(z){throw z;}}function e(a,b){var c=[],f;try{switch(a.type){case "VariableDeclarator":return null!==a.init?e(a.init,b):c;case "FunctionDeclaration":return e(a.body,b);case "VariableDeclaration":for(var g=0;g<a.declarations.length;g++)f=e(a.declarations[g],b),c=c.concat(f);return c;case "ForInStatement":return f=e(a.left,b),c=c.concat(f),f=e(a.right,b),c=c.concat(f),f=e(a.body,b),c=c.concat(f);case "ForStatement":return null!==a.init&&(f=e(a.init,
b),c=c.concat(f)),null!==a.test&&(f=e(a.test,b),c=c.concat(f)),null!==a.body&&(f=e(a.body,b),c=c.concat(f)),null!==a.update&&(f=e(a.update,b),c=c.concat(f)),c;case "IfStatement":return f=e(a.test,b),c=c.concat(f),null!==a.consequent&&(f=e(a.consequent,b),c=c.concat(f)),null!==a.alternate&&(f=e(a.alternate,b),c=c.concat(f)),c;case "EmptyStatement":return c;case "BlockStatement":for(g=0;g<a.body.length;g++)f=e(a.body[g],b),c=c.concat(f);return c;case "ReturnStatement":return null!==a.argument?e(a.argument,
b):c;case "UpdateExpression":return e(a.argument,b);case "AssignmentExpression":return c=e(a.left,b),c=c.concat(e(a.right,b));case "ExpressionStatement":return e(a.expression,b);case "BreakStatement":return c;case "ContinueStatement":return c;case "Compound":return c;case "Identifier":return c;case "MemberExpression":if("Identifier"!==a.object.type)return c;if(!1===a.computed)c.push(a.object.name.toLowerCase()+"."+a.property.name.toLowerCase());else try{"Literal"===a.property.type&&"string"===typeof a.property.value&&
c.push(a.object.name.toLowerCase()+"."+a.property.value.toString().toLowerCase())}catch(A){}return c;case "Literal":return c;case "ThisExpression":return c;case "CallExpression":for(g=0;g<a.arguments.length;g++)f=e(a.arguments[g],b),c=c.concat(f);return c;case "ArrayExpression":for(g=0;g<a.elements.length;g++)f=e(a.elements[g],b),c=c.concat(f);return c;case "UnaryExpression":return e(a.argument,b);case "ObjectExpression":for(g=0;g<a.properties.length;g++)f=e(a.properties[g],b),c=c.concat(f);return c;
case "Property":return e(a.value,b);case "BinaryExpression":return f=e(a.left,b),c=c.concat(f),f=e(a.right,b),c=c.concat(f);case "LogicalExpression":return f=e(a.left,b),c=c.concat(f),f=e(a.right,b),c=c.concat(f);case "ConditionalExpression":return c;case "Array":return c;default:return c}}catch(A){throw A;}}function c(a,b,c){c=[];if(void 0!==b.params&&null!==b.params)for(var f=0;f<b.params.length;f++)c.push("any");return{name:a,"return":"any",params:c}}function b(a,b){for(var c={globalScope:b.globalScope,
localScope:{}},f=0;f<a.params.length;f++)c.localScope[a.params[f].name.toLowerCase()]={type:"any"};return m(a.body,c)}function a(a,b,c,g){var f={};if(void 0===a||null===a)a={};if(void 0===c||null===c)c={};f.infinity={type:"any"};f.textformatting={type:"any"};f.pi={type:"any"};for(var e in b)if("simple"!==g||"simple"===g&&"a"===b[e].av)f[e]={type:"FormulaFunction",signature:b[e]};for(b=0;b<c.length;b++)e=c[b],f[e.name]={type:"FormulaFunction",signature:e};for(e in a)f[e]=a[e],f[e].type="any";return f}
function g(a,b,c){var f="";switch(b){case "SYNTAX":f="Syntax Error: ";break;case "RUNTIME":f="Runtime Error: ";break;default:f="Syntax Error: "}try{switch(a.type){case "IfStatement":switch(c){case "CANNOT_USE_ASSIGNMENT_IN_CONDITION":f+=" Assignments not be made in logical tests";break;case "CANNOT_USE_NONBOOLEAN_IN_CONDITION":f+=" Non Boolean used as Condition"}break;case "UpdateExpression":case "AssignmentExpression":switch(c){case "CANNOT_USE_ASSIGNMENT_IN_CONDITION":f+=" Assignments not be made in logical tests";
break;case "ASSIGNMENTTOVARSONLY":f+=" Assignments can only be made to identifiers"}break;case "ExpressionStatement":f+=" Assignments can only be made to identifiers";break;case "FunctionDeclaration":switch(c){case "GLOBALFUNCTIONSONLY":f+=" Functions cannot be declared as variables";break;case "FUNCTIONMUSTHAVEIDENTIFIER":f+=" Function Definition must have an identifier"}break;case "VariableDeclaration":f+=" Only 1 variable can be declared at a time";break;case "VariableDeclarator":switch(c){case "FUNCTIONVARIABLEDECLARATOR":f+=
" Functions cannot be declared as variables";break;case "VARIABLEMUSTHAVEIDENTIFIER":f+=" Variable Definition must have an identifier"}break;case "Identifier":f+=" Identifier Not Found. ";f+=a.name;break;case "ObjectExpression":switch(c){case "OBJECTPROPERTYMUSTBESTRING":f+=" Property name must be a string"}break;case "ForStatement":switch(c){case "CANNOT_USE_NONBOOLEAN_IN_CONDITION":f+=" Non Boolean used as Condition"}break;case "ForInStatement":switch(c){case "ONLY1VAR":f+=" Can only declare 1 var for use with IN";
break;case "CANNOTDECLAREVAL":f+=" Can only declare value for use with IN";break;case "LEFTNOVAR":f+="Must provide a variable to iterate with.";break;case "VARIABLENOTDECLARED":f+="Variable must be declared before it is used..";break;case "CANNOTITERATETHISTYPE":f+="This type cannot be used in an IN loop"}break;case "MemberExpression":switch(c){case "PROPERTYNOTFOUND":f+="Cannot find member property. ";f+=!1===a.computed?a.property.name:"";break;case "OUTOFBOUNDS":f+="Out of Bounds. ";f+=!1===a.computed?
a.property.name:"";break;case "NOTFOUND":f+="Cannot call member method on null. ";f+=!1===a.computed?a.property.name:"";break;case "INVALIDTYPE":f+="Cannot call member property on object of this type. ",f+=!1===a.computed?a.property.name:""}break;case "Property":switch(c){case "ONLYLITERAL":f+="Property names must be literals or identifiers"}break;case "Literal":break;case "ThisExpression":f+="THIS construct is not supported.";case "CallExpression":switch(c){case "WRONGSIGNATURE":f+="Function signature does not match: ";
f+=a.callee.name;break;case "ONLYNODESUPPORTED":f+="Functions must be declared.";f+=a.callee.name;break;case "NOTAFUNCTION":f+="Not a Function: ";f+=a.callee.name;break;case "NOTFOUND":f+="Function Not Found: "+a.callee.name}break;case "UnaryExpression":switch(c){case "NOTSUPPORTEDUNARYOPERATOR":f+="Operator "+a.operator+" not allowed in this context. Only ! can be used with boolean, and - with a number";break;case "NOTSUPPORTEDTYPE":f+="Unary operator "+a.operator+" cannot be used with this argument."}case "BinaryExpression":switch(c){case "OPERATORNOTRECOGNISED":f+=
"Binary Operator not recognised "+a.operator}break;case "LogicalExpression":switch(c){case "ONLYBOOLEAN":f+="Operator "+a.operator+" cannot be used. Only || or \x26\x26 are allowed values";break;case "ONLYORORAND":f+="Logical Expression "+a.operator+" being applied to parameters that are not boolean."}case "ConditionalExpression":f+="Conditional statements not supported.";break;case "ArrayExpression":switch(c){case "FUNCTIONCONTEXTILLEGAL":f+=" Cannot Put Function inside Array."}break;case "Array":f+=
"Expression contains unrecognised array structure.";break;default:f+="Expression contains unrecognised code structures."}}catch(z){throw z;}return f}function u(a,b,c){return{line:a.loc.start.line,character:a.loc.start.column,reason:g(a,b,c)}}function n(a,b,c,g,e){void 0===e&&(e=!0);b={globalScope:b.globalScope,localScope:{}};for(e=0;e<a.params.length;e++)b.localScope[a.params[e].name.toLowerCase()]={type:"any"};t(a.body,b,c,g,!1)}function t(a,b,e,h,d){void 0===d&&(d=!0);if(null===a)throw Error("Unnexpexted Expression Syntax");
g(a,"SYNTAX","UNREOGNISED");var f=null;try{switch(a.type){case "VariableDeclarator":if(null!==a.init&&"FunctionExpression"===a.init.type){h.push(u(a,"SYNTAX","FUNCTIONVARIABLEDECLARATOR"));break}"Identifier"!==a.id.type?h.push(u(a,"SYNTAX","VARIABLEMUSTHAVEIDENTIFIER")):(null!==b.localScope?void 0!==b.localScope[a.id.name.toLowerCase()]&&a.id.name.toLowerCase():void 0!==b.globalScope[a.id.name.toLowerCase()]&&a.id.name.toLowerCase(),null===b.localScope?b.globalScope[a.id.name.toLowerCase()]={type:"any"}:
b.localScope[a.id.name.toLowerCase()]={type:"any"});null===a.init?"":t(a.init,b,e,h,d);break;case "FunctionDeclaration":!1===d&&h.push(u(a,"SYNTAX","GLOBALFUNCTIONSONLY"));"Identifier"!==a.id.type&&h.push(u(a,"SYNTAX","FUNCTIONMUSTHAVEIDENTIFIER"));f=c("",a,b);n(a,b,e,h,d);null!==b.localScope&&h.push(u(a,"SYNTAX","GLOBALFUNCTIONSONLY"));f.isnative=!1;"Identifier"===a.id.type&&(b.globalScope[a.id.name.toLowerCase()]={type:"FormulaFunction",signature:[f]});break;case "VariableDeclaration":for(var k=
0;k<a.declarations.length;k++)t(a.declarations[k],b,e,h,d);break;case "IfStatement":null!==a.test&&(t(a.test,b,e,h,d),"AssignmentExpression"!==a.test.type&&"UpdateExpression"!==a.test.type||h.push(u(a.test,"SYNTAX","CANNOT_USE_ASSIGNMENT_IN_CONDITION")));null!==a.consequent&&t(a.consequent,b,e,h,d);null!==a.alternate&&t(a.alternate,b,e,h,d);break;case "EmptyStatement":break;case "BlockStatement":if(null!==a.body)for(k=0;k<a.body.length;k++)t(a.body[k],b,e,h,d);break;case "ReturnStatement":null!==
a.argument&&t(a.argument,b,e,h,d);break;case "ForInStatement":"VariableDeclaration"===a.left.type?(1<a.left.declarations.length&&h.push(u(a,"SYNTAX","ONLY1VAR")),null!==a.left.declarations[0].init&&h.push(u(a,"SYNTAX","CANNOTDECLAREVAL"))):"Identifier"!==a.left.type&&h.push(u(a,"SYNTAX","LEFTNOTVAR"));t(a.left,b,e,h,d);t(a.right,b,e,h,d);t(a.body,b,e,h,d);break;case "ForStatement":null!==a.init&&t(a.init,b,e,h,d);null!==a.test&&t(a.test,b,e,h,d);null!==a.body&&t(a.body,b,e,h,d);null!==a.update&&t(a.update,
b,e,h,d);break;case "BreakStatement":break;case "ContinueStatement":break;case "UpdateExpression":"Identifier"!==a.argument.type&&"MemberExpression"!==a.argument.type?h.push(u(a,"SYNTAX","ASSIGNMENTTOVARSONLY")):("Identifier"===a.argument.type&&(f=!1,!1===e&&(null!==b.localScope&&void 0!==b.localScope[a.argument.name.toLowerCase()]&&(f=!0),void 0!==b.globalScope[a.argument.name.toLowerCase()]&&(f=!0),!1===f&&h.push({line:null===a?0:a.loc.start.line,character:null===a?0:a.loc.start.column,reason:"Identifier "+
a.argument.name+" has not been declared."}))),"MemberExpression"===a.argument.type&&t(a.argument,b,e,h,d));break;case "AssignmentExpression":"Identifier"!==a.left.type&&"MemberExpression"!==a.left.type&&h.push(u(a,"SYNTAX","ASSIGNMENTTOVARSONLY"));switch(a.operator){case "\x3d":case "/\x3d":case "*\x3d":case "%\x3d":case "+\x3d":case "-\x3d":break;default:h.push(u(a,"SYNTAX","OPERATORNOTRECOGNISED"))}t(a.right,b,e,h,d);f=!1;"Identifier"===a.left.type&&(null!==b.localScope&&void 0!==b.localScope[a.left.name.toLowerCase()]&&
(f=!0),void 0!==b.globalScope[a.left.name.toLowerCase()]&&(f=!0),!1===e&&!1===f&&h.push({line:null===a?0:a.loc.start.line,character:null===a?0:a.loc.start.column,reason:"Identifier "+a.argument.name+" has not been declared."}));"MemberExpression"===a.left.type&&t(a.left,b,e,h,d);break;case "ExpressionStatement":t(a.expression,b,e,h,d);break;case "Identifier":var m=a.name.toLowerCase();if(null!==b.localScope&&void 0!==b.localScope[m])break;void 0===b.globalScope[m]&&!1===e&&h.push(u(a,"SYNTAX","VARIABLENOTFOUND"));
break;case "MemberExpression":t(a.object,b,e,h,d);!0===a.computed&&t(a.property,b,e,h,d);break;case "Literal":return"";case "ThisExpression":h.push(u(a,"SYNTAX","NOTSUPPORTED"));break;case "CallExpression":"Identifier"!==a.callee.type&&h.push(u(a,"SYNTAX","ONLYNODESSUPPORTED"));for(k=0;k<a.arguments.length;k++)t(a.arguments[k],b,e,h,d);var p=q(a.callee.name,a.arguments,b);!1===e&&-1===p&&h.push(u(a,"SYNTAX","NOTFOUND"));-2===p&&h.push(u(a,"SYNTAX","WRONGSIGNATURE"));break;case "UnaryExpression":t(a.argument,
b,e,h,d);break;case "BinaryExpression":t(a.left,b,e,h,d);t(a.right,b,e,h,d);switch(a.operator){case "\x3d\x3d":case "!\x3d":case "\x3c":case "\x3c\x3d":case "\x3e":case "\x3e\x3d":case "+":case "-":case "*":case "/":case "%":break;default:h.push(u(a,"SYNTAX","OPERATORNOTRECOGNISED"))}break;case "LogicalExpression":switch(a.operator){case "\x26\x26":case "||":break;default:h.push(u(a,"SYNTAX","OPERATORNOTRECOGNISED"))}t(a.left,b,e,h,d);"AssignmentExpression"!==a.left.type&&"UpdateExpression"!==a.left.type||
h.push(u(a,"SYNTAX","CANNOT_USE_ASSIGNMENT_IN_CONDITION"));t(a.right,b,e,h,d);"AssignmentExpression"!==a.right.type&&"UpdateExpression"!==a.right.type||h.push(u(a,"SYNTAX","CANNOT_USE_ASSIGNMENT_IN_CONDITION"));break;case "ConditionalExpression":h.push(u(a,"SYNTAX","NOTSUPPORTED"));break;case "ArrayExpression":for(k=0;k<a.elements.length;k++)t(a.elements[k],b,e,h,d);break;case "Array":h.push(u(a,"SYNTAX","NOTSUPPORTED"));case "ObjectExpression":for(k=0;k<a.properties.length;k++)t(a.properties[k],
b,e,h,d);break;case "Property":"Literal"!==a.key.type&&"Identifier"!==a.key.type&&h.push(u(a,"SYNTAX","ONLYLITERAL"));"Literal"===a.key.type&&t(a.key,b,e,h,d);t(a.value,b,e,h,d);break;default:h.push(u(a,"SYNTAX","UNRECOGNISED"))}}catch(E){h.push({line:null===a?0:a.loc.start.line,character:null===a?0:a.loc.start.column,reason:"Unnexpected Syntax"})}}Object.defineProperty(l,"__esModule",{value:!0});l.functionDecls={concatenate:{min:"0",max:"*",av:"a"},split:{min:"2",max:"4",av:"a"},guid:{min:"0",max:"1",
av:"a"},today:{min:"0",max:"0",av:"a"},now:{min:"0",max:"0",av:"a"},timestamp:{min:"0",max:"0",av:"a"},day:{min:"1",max:"1",av:"a"},month:{min:"1",max:"1",av:"a"},year:{min:"1",max:"1",av:"a"},hour:{min:"1",max:"1",av:"a"},second:{min:"1",max:"1",av:"a"},millisecond:{min:"1",max:"1",av:"a"},minute:{min:"1",max:"1",av:"a"},weekday:{min:"1",max:"1",av:"a"},toutc:{min:"1",max:"1",av:"a"},tolocal:{min:"1",max:"1",av:"a"},date:{min:"0",max:"7",av:"a"},datediff:{min:"2",max:"3",av:"a"},dateadd:{min:"2",
max:"3",av:"a"},trim:{min:"1",max:"1",av:"a"},text:{min:"1",max:"2",av:"a"},left:{min:"2",max:"2",av:"a"},right:{min:"2",max:"2",av:"a"},mid:{min:"2",max:"3",av:"a"},upper:{min:"1",max:"1",av:"a"},proper:{min:"1",max:"2",av:"a"},lower:{min:"1",max:"1",av:"a"},find:{min:"2",max:"3",av:"a"},iif:{min:"3",max:"3",av:"a"},decode:{min:"2",max:"*",av:"a"},when:{min:"2",max:"*",av:"a"},defaultvalue:{min:"2",max:"2",av:"a"},isempty:{min:"1",max:"1",av:"a"},maplayer:{min:"2",max:"3",av:"f"},domaincode:{min:"3",
max:"4",av:"a"},domainname:{min:"2",max:"4",av:"a"},polygon:{min:"1",max:"1",av:"a"},point:{min:"1",max:"1",av:"a"},polyline:{min:"1",max:"1",av:"a"},extent:{min:"1",max:"1",av:"a"},multipoint:{min:"1",max:"1",av:"a"},geometry:{min:"1",max:"1",av:"a"},featurelayer:{min:"1",max:"3",av:"f"},featurecollection:{min:"1",max:"1",av:"f"},buffer:{min:"2",max:"4",av:"f"},area:{min:"1",max:"2",av:"f"},sumarea:{min:"1",max:"2",av:"f"},length:{min:"1",max:"2",av:"f"},sumlength:{min:"1",max:"2",av:"f"},count:{min:"0",
max:"*",av:"a"},filter:{min:"2",max:"2",av:"f"},envelopeintersects:{min:"2",max:"2",av:"f"},intersects:{min:"2",max:"2",av:"f"},contains:{min:"2",max:"2",av:"f"},overlaps:{min:"2",max:"2",av:"f"},within:{min:"2",max:"2",av:"f"},touches:{min:"2",max:"2",av:"f"},crosses:{min:"2",max:"2",av:"f"},union:{min:"1",max:"2",av:"f",fmin:1},difference:{min:"2",max:"2",av:"f",fmin:2,fmax:3},intersection:{min:"2",max:"2",av:"f",fmin:2,fmax:3},symmetricdifference:{min:"2",max:"2",av:"f",fmin:2,fmax:3},number:{min:"1",
max:"2",av:"a"},acos:{min:"1",max:"1",av:"a"},asin:{min:"1",max:"1",av:"a"},atan:{min:"1",max:"1",av:"a"},atan2:{min:"2",max:"2",av:"a"},ceil:{min:"1",max:"2",av:"a"},floor:{min:"1",max:"2",av:"a"},round:{min:"1",max:"2",av:"a"},cos:{min:"1",max:"1",av:"a"},exp:{min:"1",max:"1",av:"a"},log:{min:"1",max:"1",av:"a"},min:{min:"0",max:"*",av:"a"},console:{min:"0",max:"*",av:"a"},max:{min:"0",max:"*",av:"a"},pow:{min:"2",max:"2",av:"a"},random:{min:"0",max:"0",av:"a"},sqrt:{min:"1",max:"1",av:"a"},sin:{min:"1",
max:"1",av:"a"},tan:{min:"1",max:"1",av:"a"},abs:{min:"1",max:"1",av:"a"},isnan:{min:"1",max:"1",av:"a"},stdev:{min:"0",max:"*",av:"a"},average:{min:"0",max:"*",av:"a"},mean:{min:"0",max:"*",av:"a"},sum:{min:"0",max:"*",av:"a"},variance:{min:"0",max:"*",av:"a"},distinct:{min:"0",max:"*",av:"a"},addfield:{min:"3",max:"3",av:"f"},removefield:{min:"2",max:"2",av:"f"},aggregate:{min:"3",max:"3",av:"f"},dissolve:{min:"2",max:"3",av:"f"},changeshape:{min:"2",max:"4",av:"f"},first:{min:"1",max:"1",av:"a"},
top:{min:"2",max:"2",av:"a"},orderby:{min:"2",max:"2",av:"f"},"boolean":{min:"1",max:"1",av:"a"},dictionary:{min:"0",max:"*",av:"a"},servicearea:{min:"2",max:"*",av:"f"},equals:{min:"2",max:"2",av:"a"},"typeof":{min:"1",max:"1",av:"a"},reverse:{min:"1",max:"1",av:"a"},replace:{min:"3",max:"4",av:"a"},sort:{min:"1",max:"2",av:"a"},feature:{min:"1",max:"*",av:"a"},haskey:{min:"2",max:"2",av:"a"},indexof:{min:"2",max:"2",av:"a"},centroid:{min:"1",max:"1",av:"f"},multiparttosinglepart:{min:"1",max:"1",
av:"f"}};l.checkFunctionSignature=d;l.findFunction=q;l.validateLanguageNode=k;l.testValidityOfExpression=m;l.referencesMemberImpl=p;l.referencesMember=function(a,b){return!0===p(a.body[0].body,b.toLowerCase())?!0:!1};l.referencesFunctionImpl=h;l.referencesFunction=function(a,b){return!0===h(a.body[0].body,b)?!0:!1};l.findFieldLiteralsImpl=e;l.findFieldLiterals=function(a,b){return e(a.body[0].body,b)};l.extractFunctionDeclaration=c;l.validateFunction=b;l.constructGlobalScope=a;l.validateScript=function(b,
c,g){void 0===g&&(g="full");c={globalScope:a(c.vars,l.functionDecls,c.customFunctions,g),localScope:null};return m(b.body[0].body,c)};l.validateLanguage=function(a){return"BlockStatement"!==a.body[0].body.type?"Invalid formula content.":k(a.body[0].body)};l.nodeErrorMessage=g;l.makeError=u;l.extractAllIssuesInFunction=n;l.extractAllIssues=t;l.checkScript=function(b,c,g,e){void 0===e&&(e="full");var f=[];if("BlockStatement"!==b.body[0].body.type)return[{line:0,character:0,reason:"Invalid Body"}];if(null===
c||void 0===c)c={vars:{},customFunctions:[]};c={globalScope:a(c.vars,l.functionDecls,c.customFunctions,e),localScope:null};try{t(b.body[0].body,c,g,f)}catch(A){}return f}})},"esri/arcade/Feature":function(){define("require exports dojo/_base/lang ../geometry/Geometry ../graphic ../geometry/jsonUtils ./Dictionary ./languageUtils ./ImmutableArray ../geometry/Point".split(" "),function(r,l,d,q,k,m,p,h,e,c){return function(){function b(a,c,e){this._layer=this.attributes=this.geometry=null;this.immutable=
this._datesfixed=!0;a instanceof b?(this.attributes=a.attributes,this.geometry=a.geometry,a._layer&&(this._layer=a._layer)):a instanceof k?(this.geometry=a.geometry,this.attributes=void 0===a.attributes?{}:null===a.attributes?{}:a.attributes,a._layer?(this._layer=a._layer,this._datesfixed=!1):a.layer&&(this._layer=a.layer,this._datesfixed=!1)):a instanceof p?(this.attributes=a.field("attributes"),null!==this.attributes&&(this.attributes=this.attributes instanceof p?this.attributes.attributes:null),
this.geometry=a.field("geometry"),null!==this.geometry&&(this.geometry instanceof p?this.geometry=b.parseGeometryFromDictionary(this.geometry):this.geometry instanceof q||(this.geometry=null))):(c instanceof q||null===c?(this.geometry=c,this.attributes=void 0===a?{}:null===a?{}:a):"string"===typeof a?(a=JSON.parse(a),null!==a.geometry&&void 0!==a.geometry&&(this.geometry=m.fromJson(a.geometry)),this.attributes=void 0===a.attributes?{}:null===a.attributes?{}:a.attributes):(void 0===a?this.attributes=
{}:null===a&&(this.attributes={}),this.geometry=null),void 0!==e&&(this._layer=e))}b.prototype.castToText=function(){var a="",b;for(b in this.attributes){""!==a&&(a+=",");var c=this.attributes[b];null==c?c="null":h.isBoolean(c)||h.isNumber(c)||h.isString(c)?a+=JSON.stringify(b)+":"+JSON.stringify(c):c instanceof q?a+=JSON.stringify(b)+":"+h.toStringExplicit(c):c instanceof e?a+=JSON.stringify(b)+":"+h.toStringExplicit(c):c instanceof Array?a+=JSON.stringify(b)+":"+h.toStringExplicit(c):c instanceof
Date?a+=JSON.stringify(b)+":"+JSON.stringify(c):null!==c&&"object"===typeof c&&void 0!==c.castToText&&(a+=JSON.stringify(b)+":"+c.castToText())}return'{"geometry":'+(null===this.geometry?"null":h.toStringExplicit(this.geometry))+',"attributes":{'+a+"}}"};b.prototype._fixDates=function(){for(var a=[],b=0;b<this._layer.fields.length;b++){var c=this._layer.fields[b];"date"!==c.type&&"esriFieldTypeDate"!==c.type||a.push(c.name)}0<a.length&&this._fixDateFields(a);this._datesfixed=!0};b.prototype._fixDateFields=
function(a){this.attributes=d.mixin({},this.attributes);for(var b=0;b<a.length;b++){var c=this.attributes[a[b]];if(null!==c)if(void 0===c)for(var e in this.attributes){if(e.toLowerCase()===a[b]){c=this.attributes[e];null===c||c instanceof Date||(this.attributes[e]=new Date(c));break}}else c instanceof Date||(this.attributes[a[b]]=new Date(c))}};b.prototype.field=function(a){!1===this._datesfixed&&this._fixDates();var b=a.toLowerCase();a=this.attributes[a];if(void 0!==a)return a;for(var c in this.attributes)if(c.toLowerCase()===
b)return this.attributes[c];if(this._hasFieldDefinition(b))return null;throw Error("Field not Found");};b.prototype._hasFieldDefinition=function(a){if(null===this._layer)return!1;for(var b=0;b<this._layer.fields.length;b++)if(this._layer.fields[b].name.toLowerCase()===a)return!0;return!1};b.prototype._field=function(a){!1===this._datesfixed&&this._fixDates();var b=a.toLowerCase();a=this.attributes[a];if(void 0!==a)return a;for(var c in this.attributes)if(c.toLowerCase()===b)return this.attributes[c];
return null};b.prototype.setField=function(a,b){if(this.immutable)throw Error("Feature is Immutable");if(!1===h.isSimpleType(b))throw Error("Illegal Value Assignment to Feature");var c=a.toLowerCase();if(void 0===this.attributes[a])for(var g in this.attributes)if(g.toLowerCase()===c){this.attributes[g]=b;return}this.attributes[a]=b};b.prototype.hasField=function(a){var b=a.toLowerCase();if(void 0!==this.attributes[a])return!0;for(var c in this.attributes)if(c.toLowerCase()===b)return!0;return this._hasFieldDefinition(b)?
!0:!1};b.prototype.keys=function(){var a=[],b={},c;for(c in this.attributes)a.push(c),b[c.toLowerCase()]=1;if(null!==this._layer)for(c=0;c<this._layer.fields.length;c++){var e=this._layer.fields[c];1!==b[e.name.toLowerCase()]&&a.push(e.name)}return a=a.sort()};b.fromFeature=function(a){return new b(a)};b.parseGeometryFromDictionary=function(a){a=b.convertDictionaryToJson(a,!0);void 0!==a.spatialreference&&(a.spatialReference=a.spatialreference,delete a.spatialreference);void 0!==a.rings&&(a.rings=
this.fixPathArrays(a.rings,!0===a.hasZ,!0===a.hasM));void 0!==a.paths&&(a.paths=this.fixPathArrays(a.paths,!0===a.hasZ,!0===a.hasM));void 0!==a.points&&(a.points=this.fixPointArrays(a.points,!0===a.hasZ,!0===a.hasM));return m.fromJson(a)};b.fixPathArrays=function(a,b,c){var g=[];if(a instanceof Array)for(var h=0;h<a.length;h++)g.push(this.fixPointArrays(a[h],b,c));else if(a instanceof e)for(h=0;h<a.length();h++)g.push(this.fixPointArrays(a.get(h),b,c));return g};b.fixPointArrays=function(a,b,h){var g=
[];if(a instanceof Array)for(var d=0;d<a.length;d++){var f=a[d];f instanceof c?b&&h?g.push([f.x,f.y,f.z,f.m]):b?g.push([f.x,f.y,f.z]):h?g.push([f.x,f.y,f.m]):g.push([f.x,f.y]):g.push(f)}else if(a instanceof e)for(d=0;d<a.length();d++)f=a.get(d),f instanceof c?b&&h?g.push([f.x,f.y,f.z,f.m]):b?g.push([f.x,f.y,f.z]):h?g.push([f.x,f.y,f.m]):g.push([f.x,f.y]):g.push(f);return g};b.convertDictionaryToJson=function(a,c){void 0===c&&(c=!1);var g={},e;for(e in a.attributes){var h=a.attributes[e];h instanceof
p&&(h=b.convertDictionaryToJson(h));c?g[e.toLowerCase()]=h:g[e]=h}return g};b.parseAttributesFromDictionary=function(a){var b={},c;for(c in a.attributes){var e=a.attributes[c];if(h.isSimpleType(e))b[c]=e;else throw Error("Illegal Argument");}return b};b.fromJson=function(a){var c=null;null!==a.geometry&&void 0!==a.geometry&&(c=m.fromJson(a.geometry));var e={};if(null!==a.attributes&&void 0!==a.attributes)for(var d in a.attributes){var t=a.attributes[d];if(h.isString(t)||h.isNumber(t)||h.isBoolean(t)||
h.isDate(t))e[d]=t;else throw Error("Illegal Argument");}return new b(e,c)};b.prototype.domainValueLookup=function(a,b,c){if(null===this._layer||!this._layer.fields)return null;c=h.getDomain(a,this._layer,this,c);if(void 0===b)try{b=this.field(a)}catch(n){return null}return h.getDomainValue(c,b)};b.prototype.domainCodeLookup=function(a,b,c){if(null===this._layer||!this._layer.fields)return null;a=h.getDomain(a,this._layer,this,c);return h.getDomainCode(a,b)};return b}()})},"esri/arcade/functions/date":function(){define(["require",
"exports","../../moment","../languageUtils"],function(r,l,d,q){function k(d){return null===d?d:isNaN(d.getTime())?null:d}Object.defineProperty(l,"__esModule",{value:!0});l.registerFunctions=function(m,p){m.today=function(h,e){return p(h,e,function(c,b,a){q.pcCheck(a,0,0);c=new Date;c.setHours(0,0,0,0);return c})};m.now=function(h,e){return p(h,e,function(c,b,a){q.pcCheck(a,0,0);return new Date})};m.timestamp=function(h,e){return p(h,e,function(c,b,a){q.pcCheck(a,0,0);c=new Date;return c=new Date(c.getUTCFullYear(),
c.getUTCMonth(),c.getUTCDate(),c.getUTCHours(),c.getUTCMinutes(),c.getUTCSeconds(),c.getUTCMilliseconds())})};m.toutc=function(h,e){return p(h,e,function(c,b,a){q.pcCheck(a,1,1);c=q.toDate(a[0]);return null===c?null:new Date(c.getUTCFullYear(),c.getUTCMonth(),c.getUTCDate(),c.getUTCHours(),c.getUTCMinutes(),c.getUTCSeconds(),c.getUTCMilliseconds())})};m.tolocal=function(h,e){return p(h,e,function(c,b,a){q.pcCheck(a,1,1);c=q.toDate(a[0]);return null===c?null:d.utc([c.getFullYear(),c.getMonth(),c.getDate(),
c.getHours(),c.getMinutes(),c.getSeconds(),c.getMilliseconds()]).toDate()})};m.day=function(h,e){return p(h,e,function(c,b,a){q.pcCheck(a,1,1);c=q.toDate(a[0]);return null===c?NaN:c.getDate()})};m.month=function(h,e){return p(h,e,function(c,b,a){q.pcCheck(a,1,1);c=q.toDate(a[0]);return null===c?NaN:c.getMonth()})};m.year=function(h,e){return p(h,e,function(c,b,a){q.pcCheck(a,1,1);c=q.toDate(a[0]);return null===c?NaN:c.getFullYear()})};m.hour=function(h,e){return p(h,e,function(c,b,a){q.pcCheck(a,
1,1);c=q.toDate(a[0]);return null===c?NaN:c.getHours()})};m.second=function(h,e){return p(h,e,function(c,b,a){q.pcCheck(a,1,1);c=q.toDate(a[0]);return null===c?NaN:c.getSeconds()})};m.millisecond=function(h,e){return p(h,e,function(c,b,a){q.pcCheck(a,1,1);c=q.toDate(a[0]);return null===c?NaN:c.getMilliseconds()})};m.minute=function(h,e){return p(h,e,function(c,b,a){q.pcCheck(a,1,1);c=q.toDate(a[0]);return null===c?NaN:c.getMinutes()})};m.weekday=function(h,e){return p(h,e,function(c,b,a){q.pcCheck(a,
1,1);c=q.toDate(a[0]);return null===c?NaN:c.getDay()})};m.date=function(h,e){return p(h,e,function(c,b,a){q.pcCheck(a,0,7);if(3===a.length)return k(new Date(q.toNumber(a[0]),q.toNumber(a[1]),q.toNumber(a[2]),0,0,0,0));if(4===a.length)return k(new Date(q.toNumber(a[0]),q.toNumber(a[1]),q.toNumber(a[2]),q.toNumber(a[3]),0,0,0));if(5===a.length)return k(new Date(q.toNumber(a[0]),q.toNumber(a[1]),q.toNumber(a[2]),q.toNumber(a[3]),q.toNumber(a[4]),0,0));if(6===a.length)return k(new Date(q.toNumber(a[0]),
q.toNumber(a[1]),q.toNumber(a[2]),q.toNumber(a[3]),q.toNumber(a[4]),q.toNumber(a[5]),0));if(7===a.length)return k(new Date(q.toNumber(a[0]),q.toNumber(a[1]),q.toNumber(a[2]),q.toNumber(a[3]),q.toNumber(a[4]),q.toNumber(a[5]),q.toNumber(a[6])));if(2===a.length){c=q.toString(a[1]);if(""===c)return null;c=q.standardiseDateFormat(c);a=d(q.toString(a[0]),c,!0);return!0===a.isValid()?a.toDate():null}if(1===a.length){if(q.isString(a[0])&&""===a[0].replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,""))return null;
c=q.toNumber(a[0]);return!1===isNaN(c)?k(new Date(c)):q.toDate(a[0])}if(0===a.length)return new Date})};m.datediff=function(h,e){return p(h,e,function(c,b,a){q.pcCheck(a,2,3);c=q.toDateM(a[0]);b=q.toDateM(a[1]);if(null===c||null===b)return NaN;switch(q.toString(a[2]).toLowerCase()){case "days":case "day":case "d":return c.diff(b,"days",!0);case "months":case "month":return c.diff(b,"months",!0);case "minutes":case "minute":case "m":return"M"===a[2]?c.diff(b,"months",!0):c.diff(b,"minutes",!0);case "seconds":case "second":case "s":return c.diff(b,
"seconds",!0);case "milliseconds":case "millisecond":case "ms":return c.diff(b);case "hours":case "hour":case "h":return c.diff(b,"hours",!0);case "years":case "year":case "y":return c.diff(b,"years",!0);default:return c.diff(b)}})};m.dateadd=function(h,e){return p(h,e,function(c,b,a){q.pcCheck(a,2,3);c=q.toDateM(a[0]);if(null===c)return null;b="milliseconds";switch(q.toString(a[2]).toLowerCase()){case "days":case "day":case "d":b="days";break;case "months":case "month":b="months";break;case "minutes":case "minute":case "m":b=
"M"===a[2]?"months":"minutes";break;case "seconds":case "second":case "s":b="seconds";break;case "milliseconds":case "millisecond":case "ms":b="milliseconds";break;case "hours":case "hour":case "h":b="hours";break;case "years":case "year":case "y":b="years"}c.add(q.toNumber(a[1]),b);return c.toDate()})}}})},"esri/arcade/functions/string":function(){define(["require","exports","../languageUtils","../Feature"],function(r,l,d,q){Object.defineProperty(l,"__esModule",{value:!0});l.registerFunctions=function(k,
m){k.trim=function(k,h){return m(k,h,function(e,c,b){d.pcCheck(b,1,1);return d.toString(b[0]).trim()})};k.upper=function(k,h){return m(k,h,function(e,c,b){d.pcCheck(b,1,1);return d.toString(b[0]).toUpperCase()})};k.proper=function(k,h){return m(k,h,function(e,c,b){d.pcCheck(b,1,2);e=1;2===b.length&&"firstword"===d.toString(b[1]).toLowerCase()&&(e=2);c=/\s/;b=d.toString(b[0]);for(var a="",g=!0,h=0;h<b.length;h++){var n=b[h];c.test(n)?1===e&&(g=!0):n.toUpperCase()!==n.toLowerCase()&&(g?(n=n.toUpperCase(),
g=!1):n=n.toLowerCase());a+=n}return a})};k.lower=function(k,h){return m(k,h,function(e,c,b){d.pcCheck(b,1,1);return d.toString(b[0]).toLowerCase()})};k.guid=function(k,h){return m(k,h,function(e,c,b){d.pcCheck(b,0,1);if(0<b.length)switch(d.toString(b[0]).toLowerCase()){case "digits":return d.generateUUID().replace("-","").replace("-","").replace("-","").replace("-","");case "digits-hyphen":return d.generateUUID();case "digits-hyphen-parentheses":return"("+d.generateUUID()+")"}return"{"+d.generateUUID()+
"}"})};k.console=function(k,h){return m(k,h,function(e,c,b){0!==b.length&&(1===b.length?k.console(d.toString(b[0])):k.console(d.toString(b)));return d.voidOperation})};k.mid=function(k,h){return m(k,h,function(e,c,b){d.pcCheck(b,2,3);e=d.toNumber(b[1]);if(isNaN(e))return"";0>e&&(e=0);if(2===b.length)return d.toString(b[0]).substr(e);c=d.toNumber(b[2]);if(isNaN(c))return"";0>c&&(c=0);return d.toString(b[0]).substr(e,c)})};k.find=function(k,h){return m(k,h,function(e,c,b){d.pcCheck(b,2,3);e=0;if(2<
b.length){e=d.toNumber(d.defaultUndefined(b[2],0));if(isNaN(e))return-1;0>e&&(e=0)}return d.toString(b[1]).indexOf(d.toString(b[0]),e)})};k.left=function(k,h){return m(k,h,function(e,c,b){d.pcCheck(b,2,2);e=d.toNumber(b[1]);if(isNaN(e))return"";0>e&&(e=0);return d.toString(b[0]).substr(0,e)})};k.right=function(k,h){return m(k,h,function(e,c,b){d.pcCheck(b,2,2);e=d.toNumber(b[1]);if(isNaN(e))return"";0>e&&(e=0);return d.toString(b[0]).substr(-1*e,e)})};k.split=function(k,h){return m(k,h,function(e,
c,b){d.pcCheck(b,2,4);e=d.toNumber(d.defaultUndefined(b[2],-1));c=d.toBoolean(d.defaultUndefined(b[3],!1));-1===e||null===e||!0===c?b=d.toString(b[0]).split(d.toString(b[1])):(isNaN(e)&&(e=-1),-1>e&&(e=-1),b=d.toString(b[0]).split(d.toString(b[1]),e));if(!1===c)return b;c=[];for(var a=0;a<b.length&&!(-1!==e&&c.length>=e);a++)""!==b[a]&&void 0!==b[a]&&c.push(b[a]);return c})};k.text=function(k,h){return m(k,h,function(e,c,b){d.pcCheck(b,1,2);return d.toStringExplicit(b[0],b[1])})};k.concatenate=function(k,
h){return m(k,h,function(e,c,b){e=[];if(1>b.length)return"";if(d.isArray(b[0])){c=d.defaultUndefined(b[2],"");for(var a=0;a<b[0].length;a++)e[a]=d.toStringExplicit(b[0][a],c);return 1<b.length?e.join(b[1]):e.join("")}if(d.isImmutableArray(b[0])){c=d.defaultUndefined(b[2],"");for(a=0;a<b[0].length();a++)e[a]=d.toStringExplicit(b[0].get(a),c);return 1<b.length?e.join(b[1]):e.join("")}for(a=0;a<b.length;a++)e[a]=d.toStringExplicit(b[a]);return e.join("")})};k.reverse=function(k,h){return m(k,h,function(e,
c,b){d.pcCheck(b,1,1);if(d.isArray(b[0]))return e=b[0].slice(0),e.reverse(),e;if(d.isImmutableArray(b[0]))return e=b[0].toArray().slice(0),e.reverse(),e;throw Error("Invalid Parameter");})};k.replace=function(k,h){return m(k,h,function(e,c,b){d.pcCheck(b,3,4);e=d.toString(b[0]);c=d.toString(b[1]);var a=d.toString(b[2]);return(4===b.length?d.toBoolean(b[3]):1)?d.multiReplace(e,c,a):e.replace(c,a)})};k.domainname=function(k,h){return m(k,h,function(e,c,b){d.pcCheck(b,2,4);if(b[0]instanceof q)return b[0].domainValueLookup(d.toString(b[1]),
b[2],void 0===b[3]?void 0:d.toNumber(b[3]));throw Error("Invalid Parameter");})};k.domaincode=function(k,h){return m(k,h,function(e,c,b){d.pcCheck(b,3,4);if(b[0]instanceof q)return b[0].domainCodeLookup(d.toString(b[1]),b[2],void 0===b[3]?void 0:d.toNumber(b[3]));throw Error("Invalid Parameter");})}}})},"esri/arcade/functions/maths":function(){define(["require","exports","../languageUtils","dojo/number"],function(r,l,d,q){function k(d,k,h){if("undefined"===typeof h||0===+h)return Math[d](k);k=+k;
h=+h;if(isNaN(k)||"number"!==typeof h||0!==h%1)return NaN;k=k.toString().split("e");k=Math[d](+(k[0]+"e"+(k[1]?+k[1]-h:-h)));k=k.toString().split("e");return+(k[0]+"e"+(k[1]?+k[1]+h:h))}Object.defineProperty(l,"__esModule",{value:!0});l.registerFunctions=function(m,p){m.number=function(h,e){return p(h,e,function(c,b,a){d.pcCheck(a,1,2);c=a[0];return d.isNumber(c)?c:null===c?0:d.isDate(c)||d.isBoolean(c)?Number(c):d.isArray(c)?NaN:""===c||void 0===c?Number(c):d.isString(c)?void 0!==a[1]?(a=d.multiReplace(a[1],
"\u2030",""),a=d.multiReplace(a,"\u00a4",""),q.parse(c,{pattern:a})):Number(c.trim()):Number(c)})};m.abs=function(h,e){return p(h,e,function(c,b,a){d.pcCheck(a,1,1);return Math.abs(d.toNumber(a[0]))})};m.acos=function(h,e){return p(h,e,function(c,b,a){d.pcCheck(a,1,1);return Math.acos(d.toNumber(a[0]))})};m.asin=function(h,e){return p(h,e,function(c,b,a){d.pcCheck(a,1,1);return Math.asin(d.toNumber(a[0]))})};m.atan=function(h,e){return p(h,e,function(c,b,a){d.pcCheck(a,1,1);return Math.atan(d.toNumber(a[0]))})};
m.atan2=function(h,e){return p(h,e,function(c,b,a){d.pcCheck(a,2,2);return Math.atan2(d.toNumber(a[0]),d.toNumber(a[1]))})};m.ceil=function(h,e){return p(h,e,function(c,b,a){d.pcCheck(a,1,2);return 2===a.length?(c=d.toNumber(a[1]),isNaN(c)&&(c=0),k("ceil",d.toNumber(a[0]),-1*c)):Math.ceil(d.toNumber(a[0]))})};m.round=function(h,e){return p(h,e,function(c,b,a){d.pcCheck(a,1,2);return 2===a.length?(c=d.toNumber(a[1]),isNaN(c)&&(c=0),k("round",d.toNumber(a[0]),-1*c)):Math.round(d.toNumber(a[0]))})};
m.floor=function(h,e){return p(h,e,function(c,b,a){d.pcCheck(a,1,2);return 2===a.length?(c=d.toNumber(a[1]),isNaN(c)&&(c=0),k("floor",d.toNumber(a[0]),-1*c)):Math.floor(d.toNumber(a[0]))})};m.cos=function(h,e){return p(h,e,function(c,b,a){d.pcCheck(a,1,1);return Math.cos(d.toNumber(a[0]))})};m.isnan=function(h,e){return p(h,e,function(c,b,a){d.pcCheck(a,1,1);return"number"===typeof a[0]&&isNaN(a[0])})};m.exp=function(h,e){return p(h,e,function(c,b,a){d.pcCheck(a,1,1);return Math.exp(d.toNumber(a[0]))})};
m.log=function(h,e){return p(h,e,function(c,b,a){d.pcCheck(a,1,1);return Math.log(d.toNumber(a[0]))})};m.pow=function(h,e){return p(h,e,function(c,b,a){d.pcCheck(a,2,2);return Math.pow(d.toNumber(a[0]),d.toNumber(a[1]))})};m.random=function(h,e){return p(h,e,function(c,b,a){d.pcCheck(a,0,0);return Math.random()})};m.sin=function(h,e){return p(h,e,function(c,b,a){d.pcCheck(a,1,1);return Math.sin(d.toNumber(a[0]))})};m.sqrt=function(h,e){return p(h,e,function(c,b,a){d.pcCheck(a,1,1);return Math.sqrt(d.toNumber(a[0]))})};
m.tan=function(h,e){return p(h,e,function(c,b,a){d.pcCheck(a,1,1);return Math.tan(d.toNumber(a[0]))})};m.defaultvalue=function(h,e){return p(h,e,function(c,b,a){d.pcCheck(a,2,2);return null===a[0]||""===a[0]||void 0===a[0]?a[1]:a[0]})};m.isempty=function(h,e){return p(h,e,function(c,b,a){d.pcCheck(a,1,1);return null===a[0]||""===a[0]||void 0===a[0]?!0:!1})};m["boolean"]=function(h,e){return p(h,e,function(c,b,a){d.pcCheck(a,1,1);return d.toBoolean(a[0])})}}})},"esri/arcade/functions/geometry":function(){define("require exports ../../geometry/Geometry ../../geometry/Polygon ../../geometry/Polyline ../../geometry/Point ../../geometry/Extent ../../geometry/Multipoint ../../geometry/jsonUtils ../languageUtils ../Dictionary ../Feature".split(" "),
function(r,l,d,q,k,m,p,h,e,c,b,a){Object.defineProperty(l,"__esModule",{value:!0});l.registerFunctions=function(g,u){g.polygon=function(g,h){return u(g,h,function(f,h,d){c.pcCheck(d,1,1);f=null;if(d[0]instanceof b){if(f=c.fixSpatialReference(a.parseGeometryFromDictionary(d[0]),g.spatialReference),!1===f instanceof q)throw Error("Illegal Parameter");}else f=d[0]instanceof q?e.fromJson(d[0].toJson()):c.fixSpatialReference(new q(JSON.parse(d[0])),g.spatialReference);if(null!==f&&!1===f.spatialReference.equals(g.spatialReference))throw Error("Cannot create Geometry in this SpatialReference. Engine is using a different spatial reference.");
return c.fixNullGeometry(f)})};g.polyline=function(g,h){return u(g,h,function(f,h,d){c.pcCheck(d,1,1);f=null;if(d[0]instanceof b){if(f=c.fixSpatialReference(a.parseGeometryFromDictionary(d[0]),g.spatialReference),!1===f instanceof k)throw Error("Illegal Parameter");}else f=d[0]instanceof k?e.fromJson(d[0].toJson()):c.fixSpatialReference(new k(JSON.parse(d[0])),g.spatialReference);if(null!==f&&!1===f.spatialReference.equals(g.spatialReference))throw Error("Cannot create Geometry in this SpatialReference. Engine is using a different spatial reference.");
return c.fixNullGeometry(f)})};g.point=function(g,h){return u(g,h,function(f,h,d){c.pcCheck(d,1,1);f=null;if(d[0]instanceof b){if(f=c.fixSpatialReference(a.parseGeometryFromDictionary(d[0]),g.spatialReference),!1===f instanceof m)throw Error("Illegal Parameter");}else f=d[0]instanceof m?e.fromJson(d[0].toJson()):c.fixSpatialReference(new m(JSON.parse(d[0])),g.spatialReference);if(null!==f&&!1===f.spatialReference.equals(g.spatialReference))throw Error("Cannot create Geometry in this SpatialReference. Engine is using a different spatial reference.");
return c.fixNullGeometry(f)})};g.multipoint=function(g,d){return u(g,d,function(f,d,n){c.pcCheck(n,1,1);f=null;if(n[0]instanceof b){if(f=c.fixSpatialReference(a.parseGeometryFromDictionary(n[0]),g.spatialReference),!1===f instanceof h)throw Error("Illegal Parameter");}else f=n[0]instanceof h?e.fromJson(n[0].toJson()):c.fixSpatialReference(new h(JSON.parse(n[0])),g.spatialReference);if(null!==f&&!1===f.spatialReference.equals(g.spatialReference))throw Error("Cannot create Geometry in this SpatialReference. Engine is using a different spatial reference.");
return c.fixNullGeometry(f)})};g.extent=function(g,d){return u(g,d,function(f,d,n){c.pcCheck(n,1,1);f=null;n[0]instanceof b?f=c.fixSpatialReference(a.parseGeometryFromDictionary(n[0]),g.spatialReference):n[0]instanceof m?(f={xmin:n[0].x,ymin:n[0].y,xmax:n[0].x,ymax:n[0].y,spatialReference:n[0].spatialReference.toJson()},n[0].hasZ?(f.zmin=n[0].z,f.zmax=n[0].z):n[0].hasM&&(f.mmin=n[0].m,f.mmax=n[0].m),f=e.fromJson(f)):f=n[0]instanceof q?e.fromJson(n[0].getExtent().toJson()):n[0]instanceof k?e.fromJson(n[0].getExtent().toJson()):
n[0]instanceof h?e.fromJson(n[0].getExtent().toJson()):n[0]instanceof p?e.fromJson(n[0].toJson()):c.fixSpatialReference(new p(JSON.parse(n[0])),g.spatialReference);if(null!==f&&!1===f.spatialReference.equals(g.spatialReference))throw Error("Cannot create Geometry in this SpatialReference. Engine is using a different spatial reference.");return c.fixNullGeometry(f)})};g.geometry=function(g,h){return u(g,h,function(f,h,d){c.pcCheck(d,1,1);f=null;f=d[0]instanceof a?c.fixSpatialReference(d[0].geometry,
g.spatialReference):d[0]instanceof b?c.fixSpatialReference(a.parseGeometryFromDictionary(d[0]),g.spatialReference):c.fixSpatialReference(e.fromJson(JSON.parse(d[0])),g.spatialReference);if(null!==f&&!1===f.spatialReference.equals(g.spatialReference))throw Error("Cannot create Geometry in this SpatialReference. Engine is using a different spatial reference.");return c.fixNullGeometry(f)})};g.feature=function(g,e){return u(g,e,function(f,e,h){if(0===h.length)throw Error("Missing Parameters");f=null;
if(1===h.length)if(c.isString(h[0]))f=a.fromJson(JSON.parse(h[0]));else if(h[0]instanceof a)f=new a(h[0]);else if(h[0]instanceof d)f=new a(null,h[0]);else if(h[0]instanceof b)f=h[0].hasField("geometry")?h[0].field("geometry"):null,e=h[0].hasField("attributes")?h[0].field("attributes"):null,null!==f&&f instanceof b&&(f=a.parseGeometryFromDictionary(f)),null!==e&&(e=a.parseAttributesFromDictionary(e)),f=new a(e,f);else throw Error("Illegal Argument");else{if(2===h.length){e=f=null;if(null!==h[0])if(h[0]instanceof
d)f=h[0];else if(f instanceof b)f=a.parseGeometryFromDictionary(h[0]);else throw Error("Illegal Argument");if(null!==h[1])if(h[1]instanceof b)e=a.parseAttributesFromDictionary(h[1]);else throw Error("Illegal Argument");}else{f=null;e={};if(null!==h[0])if(h[0]instanceof d)f=h[0];else if(f instanceof b)f=a.parseGeometryFromDictionary(h[0]);else throw Error("Illegal Argument");for(var n=1;n<h.length;n+=2){var t=c.toString(h[n]),u=h[n+1];if(null===u||void 0===u||c.isString(u)||isNaN(u)||c.isDate(u)||
c.isNumber(u)||c.isBoolean(u)){if(c.isFunctionParameter(u)||!1===c.isSimpleType(u))throw Error("Illegal Argument");e[t]=u===c.voidOperation?null:u}else throw Error("Illegal Argument");}}f=new a(e,f)}f.geometry=c.fixSpatialReference(f.geometry,g.spatialReference);f.immutable=!1;return f})};g.dictionary=function(a,g){return u(a,g,function(a,g,e){if(0===e.length)throw Error("Missing Parameters");if(0!==e.length%2)throw Error("Missing Parameters");a={};for(g=0;g<e.length;g+=2){var f=c.toString(e[g]),
h=e[g+1];if(null===h||void 0===h||c.isString(h)||isNaN(h)||c.isDate(h)||c.isNumber(h)||c.isBoolean(h)||c.isArray(h)||c.isImmutableArray(h)){if(c.isFunctionParameter(h))throw Error("Illegal Argument");a[f]=h===c.voidOperation?null:h}else throw Error("Illegal Argument");}e=new b(a);e.immutable=!1;return e})};g.haskey=function(g,e){return u(g,e,function(f,g,e){c.pcCheck(e,2,2);f=c.toString(e[1]);if(e[0]instanceof a||e[0]instanceof b)return e[0].hasField(f);throw Error("Illegal Argument");})};g.indexof=
function(a,b){return u(a,b,function(a,b,g){c.pcCheck(g,2,2);a=g[1];if(c.isArray(g[0])){for(b=0;b<g[0].length;b++)if(c.equalityTest(a,g[0][b]))return b;return-1}if(c.isImmutableArray(g[0])){var f=g[0].length();for(b=0;b<f;b++)if(c.equalityTest(a,g[0].get(b)))return b;return-1}throw Error("Illegal Argument");})}}})},"esri/arcade/functions/stats":function(){define(["require","exports","../languageUtils","./fieldStats"],function(r,l,d,q){function k(k,p,h,e){if(1===e.length){if(d.isArray(e[0]))return q.calculateStat(k,
e[0],-1);if(d.isImmutableArray(e[0]))return q.calculateStat(k,e[0].toArray(),-1)}return q.calculateStat(k,e,-1)}Object.defineProperty(l,"__esModule",{value:!0});l.registerFunctions=function(m,p){m.stdev=function(h,e){return p(h,e,function(c,b,a){return k("stdev",c,b,a)})};m.variance=function(h,e){return p(h,e,function(c,b,a){return k("variance",c,b,a)})};m.average=function(h,e){return p(h,e,function(c,b,a){return k("mean",c,b,a)})};m.mean=function(h,e){return p(h,e,function(c,b,a){return k("mean",
c,b,a)})};m.sum=function(h,e){return p(h,e,function(c,b,a){return k("sum",c,b,a)})};m.min=function(h,e){return p(h,e,function(c,b,a){return k("min",c,b,a)})};m.max=function(h,e){return p(h,e,function(c,b,a){return k("max",c,b,a)})};m.distinct=function(h,e){return p(h,e,function(c,b,a){return k("distinct",c,b,a)})};m.count=function(h,e){return p(h,e,function(c,b,a){d.pcCheck(a,1,1);if(d.isArray(a[0])||d.isString(a[0]))return a[0].length;if(d.isImmutableArray(a[0]))return a[0].length();throw Error("Invalid Parameters for Count");
})}}})},"esri/arcade/functions/fieldStats":function(){define(["require","exports","../languageUtils"],function(r,l,d){function q(d){for(var k=0,h=0;h<d.length;h++)k+=d[h];return k/d.length}function k(d){for(var k=q(d),h=0,e=0;e<d.length;e++)h+=Math.pow(k-d[e],2);return h/d.length}Object.defineProperty(l,"__esModule",{value:!0});l.decodeStatType=function(d){switch(d.toLowerCase()){case "distinct":return"distinct";case "avg":case "mean":return"avg";case "min":return"min";case "sum":return"sum";case "max":return"max";
case "stdev":case "stddev":return"stddev";case "var":case "variance":return"var";case "count":return"count"}return""};l.calculateStat=function(m,p,h){void 0===h&&(h=1E3);switch(m.toLowerCase()){case "distinct":a:{m=h;h=[];for(var e={},c=[],b=0;b<p.length;b++){if(void 0!==p[b]&&null!==p[b]&&p[b]!==d.voidOperation){var a=p[b];if(d.isNumber(a)||d.isString(a))void 0===e[a]&&(h.push(a),e[a]=1);else{for(var g=!1,u=0;u<c.length;u++)!0===d.equalityTest(c[u],a)&&(g=!0);!1===g&&(c.push(a),h.push(a))}}if(h.length>=
m&&-1!==m){p=h;break a}}p=h}return p;case "avg":case "mean":return q(d.toNumberArray(p));case "min":return Math.min.apply(Math,d.toNumberArray(p));case "sum":p=d.toNumberArray(p);for(h=m=0;h<p.length;h++)m+=p[h];return m;case "max":return Math.max.apply(Math,d.toNumberArray(p));case "stdev":case "stddev":return Math.sqrt(k(d.toNumberArray(p)));case "var":case "variance":return k(d.toNumberArray(p));case "count":return p.length}return 0}})},"esri/arcade/parser":function(){define(["require","exports",
"./treeAnalysis","./lib/esprima"],function(r,l,d,q){Object.defineProperty(l,"__esModule",{value:!0});l.parseScript=function(k){k=q.parse("function _() { "+k+"\n}");if(null===k.body||void 0===k.body)throw Error("No formula provided.");if(0===k.body.length)throw Error("No formula provided.");if(0===k.body.length)throw Error("No formula provided.");if("BlockStatement"!==k.body[0].body.type)throw Error("Invalid formula content.");var m=d.validateLanguage(k);if(""!==m)throw Error(m);return k};l.scriptCheck=
function(k,m,p,h){var e=[];try{var c=q.parse("function _() { "+k+"\n}",{tolerant:!0,loc:!0}),b=c.errors;if(0<b.length)for(var a=0;a<b.length;a++)e.push({line:b[a].lineNumber,character:b[a].column,reason:b[a].description});var g=d.checkScript(c,m,p,h);for(m=0;m<g.length;m++)e.push(g[m])}catch(u){try{"Unexpected token }"===u.description&&(u.index=("function _() { "+k+"\n}").length-1)?e.push({line:u.lineNumber,character:u.column,reason:"Unexpected end of script"}):e.push({line:u.lineNumber,character:u.column,
reason:u.description})}catch(n){}}return e};l.extractFieldLiterals=function(k,m){void 0===m&&(m=!1);return d.findFieldLiterals(k,m)};l.validateScript=function(k,m,p){void 0===p&&(p="full");return d.validateScript(k,m,p)};l.referencesMember=function(k,m){return d.referencesMember(k,m)};l.referencesFunction=function(k,m){return d.referencesFunction(k,m)}})},"esri/arcade/lib/esprima":function(){(function(r,l){"function"===typeof define&&define.amd?define(["exports"],l):"undefined"!==typeof exports?l(exports):
l(r.esprima={})})(this,function(r){function l(a,b){if(!a)throw Error("ASSERT: "+b);}function d(a){return 48<=a&&57>=a}function q(a){return 0<="0123456789abcdefABCDEF".indexOf(a)}function k(a){return 0<="01234567".indexOf(a)}function m(a){return 10===a||13===a||8232===a||8233===a}function p(a){return 36===a||95===a||65<=a&&90>=a||97<=a&&122>=a||92===a||128<=a&&cb.NonAsciiIdentifierStart.test(String.fromCharCode(a))}function h(a){return 36===a||95===a||65<=a&&90>=a||97<=a&&122>=a||48<=a&&57>=a||92===
a||128<=a&&cb.NonAsciiIdentifierPart.test(String.fromCharCode(a))}function e(a){a=a.toLowerCase();switch(a.length){case 2:return"if"===a||"in"===a;case 3:return"var"===a||"for"===a;case 4:return"else"===a;case 5:return"break"===a;case 6:return"return"===a;case 8:return"function"===a.toLowerCase()||"continue"===a;default:return!1}}function c(a,b,c,f,g){l("number"===typeof c,"Comment must have valid position");Z.lastCommentStart>=c||(Z.lastCommentStart=c,a={type:a,value:b},P.range&&(a.range=[c,f]),
P.loc&&(a.loc=g),P.comments.push(a),P.attachComment&&(P.leadingComments.push(a),P.trailingComments.push(a)))}function b(a){var b,f,g;b=I-a;for(f={start:{line:ga,column:I-ja-a}};I<na;)if(g=S.charCodeAt(I),++I,m(g)){P.comments&&(a=S.slice(b+a,I-1),f.end={line:ga,column:I-ja-1},c("Line",a,b,I-1,f));13===g&&10===S.charCodeAt(I)&&++I;++ga;ja=I;return}P.comments&&(a=S.slice(b+a,I),f.end={line:ga,column:I-ja},c("Line",a,b,I,f))}function a(){var a,f;for(f=0===I;I<na;)if(a=S.charCodeAt(I),32===a||9===a||11===
a||12===a||160===a||5760<=a&&0<=[5760,6158,8192,8193,8194,8195,8196,8197,8198,8199,8200,8201,8202,8239,8287,12288,65279].indexOf(a))++I;else if(m(a))++I,13===a&&10===S.charCodeAt(I)&&++I,++ga,ja=I,f=!0;else if(47===a)if(a=S.charCodeAt(I+1),47===a)++I,++I,b(2),f=!0;else if(42===a){++I;++I;a:{var g=a=void 0,e=void 0,e=void 0;P.comments&&(a=I-2,g={start:{line:ga,column:I-ja-2}});for(;I<na;)if(e=S.charCodeAt(I),m(e))13===e&&10===S.charCodeAt(I+1)&&++I,++ga,++I,ja=I,I>=na&&K();else{if(42===e&&47===S.charCodeAt(I+
1)){++I;++I;P.comments&&(e=S.slice(a+2,I-2),g.end={line:ga,column:I-ja},c("Block",e,a,I,g));break a}++I}K()}}else break;else if(f&&45===a)if(45===S.charCodeAt(I+1)&&62===S.charCodeAt(I+2))I+=3,b(3);else break;else if(60===a)if("!--"===S.slice(I+1,I+4))++I,++I,++I,++I,b(4);else break;else break}function g(a){var b,c,f=0;b="u"===a?4:2;for(a=0;a<b;++a)if(I<na&&q(S[I]))c=S[I++],f=16*f+"0123456789abcdef".indexOf(c.toLowerCase());else return"";return String.fromCharCode(f)}function u(){var a,b;a=S.charCodeAt(I++);
b=String.fromCharCode(a);92===a&&(117!==S.charCodeAt(I)&&K(),++I,(a=g("u"))&&"\\"!==a&&p(a.charCodeAt(0))||K(),b=a);for(;I<na;){a=S.charCodeAt(I);if(!h(a))break;++I;b+=String.fromCharCode(a);92===a&&(b=b.substr(0,b.length-1),117!==S.charCodeAt(I)&&K(),++I,(a=g("u"))&&"\\"!==a&&h(a.charCodeAt(0))||K(),b+=a)}return b}function n(){var a=I,b=S.charCodeAt(I),c,f=S[I];switch(b){case 46:case 40:case 41:case 59:case 44:case 123:case 125:case 91:case 93:case 58:case 63:case 126:return++I,P.tokenize&&(40===
b?P.openParenToken=P.tokens.length:123===b&&(P.openCurlyToken=P.tokens.length)),{type:T.Punctuator,value:String.fromCharCode(b),lineNumber:ga,lineStart:ja,start:a,end:I};default:if(c=S.charCodeAt(I+1),61===c)switch(b){case 43:case 45:case 47:case 60:case 62:case 94:case 124:case 37:case 38:case 42:return I+=2,{type:T.Punctuator,value:String.fromCharCode(b)+String.fromCharCode(c),lineNumber:ga,lineStart:ja,start:a,end:I};case 33:case 61:return I+=2,61===S.charCodeAt(I)&&++I,{type:T.Punctuator,value:S.slice(a,
I),lineNumber:ga,lineStart:ja,start:a,end:I}}}b=S.substr(I,4);if("\x3e\x3e\x3e\x3d"===b)return I+=4,{type:T.Punctuator,value:b,lineNumber:ga,lineStart:ja,start:a,end:I};b=b.substr(0,3);if("\x3e\x3e\x3e"===b||"\x3c\x3c\x3d"===b||"\x3e\x3e\x3d"===b)return I+=3,{type:T.Punctuator,value:b,lineNumber:ga,lineStart:ja,start:a,end:I};b=b.substr(0,2);if(f===b[1]&&0<="+-\x3c\x3e\x26|".indexOf(f)||"\x3d\x3e"===b)return I+=2,{type:T.Punctuator,value:b,lineNumber:ga,lineStart:ja,start:a,end:I};if(0<="\x3c\x3e\x3d!+-*%\x26|^/".indexOf(f))return++I,
{type:T.Punctuator,value:f,lineNumber:ga,lineStart:ja,start:a,end:I};K()}function t(){var a,b,c;c=S[I];l(d(c.charCodeAt(0))||"."===c,"Numeric literal must start with a decimal digit or a decimal point");b=I;a="";if("."!==c){a=S[I++];c=S[I];if("0"===a){if("x"===c||"X"===c){++I;for(a="";I<na&&q(S[I]);)a+=S[I++];0===a.length&&K();p(S.charCodeAt(I))&&K();return{type:T.NumericLiteral,value:parseInt("0x"+a,16),lineNumber:ga,lineStart:ja,start:b,end:I}}if("b"===c||"B"===c){++I;for(c="";I<na;){a=S[I];if("0"!==
a&&"1"!==a)break;c+=S[I++]}0===c.length&&K();I<na&&(a=S.charCodeAt(I),(p(a)||d(a))&&K());return{type:T.NumericLiteral,value:parseInt(c,2),lineNumber:ga,lineStart:ja,start:b,end:I}}if("o"===c||"O"===c||k(c)){k(c)?(c=!0,a="0"+S[I++]):(c=!1,++I,a="");for(;I<na&&k(S[I]);)a+=S[I++];c||0!==a.length||K();(p(S.charCodeAt(I))||d(S.charCodeAt(I)))&&K();return{type:T.NumericLiteral,value:parseInt(a,8),octal:c,lineNumber:ga,lineStart:ja,start:b,end:I}}c&&d(c.charCodeAt(0))&&K()}for(;d(S.charCodeAt(I));)a+=S[I++];
c=S[I]}if("."===c){for(a+=S[I++];d(S.charCodeAt(I));)a+=S[I++];c=S[I]}if("e"===c||"E"===c){a+=S[I++];c=S[I];if("+"===c||"-"===c)a+=S[I++];if(d(S.charCodeAt(I)))for(;d(S.charCodeAt(I));)a+=S[I++];else K()}p(S.charCodeAt(I))&&K();return{type:T.NumericLiteral,value:parseFloat(a),lineNumber:ga,lineStart:ja,start:b,end:I}}function f(){X=null;a();N("Regular Expression language structures not supported")}function v(){a();f()}function x(){var a;a=P.tokens[P.tokens.length-1];if(!a)return v();if("Punctuator"===
a.type){if("]"===a.value)return n();if(")"===a.value)return a=P.tokens[P.openParenToken-1],!a||"Keyword"!==a.type||"if"!==a.value.toLowerCase()&&"while"!==a.value.toLowerCase()&&"for"!==a.value.toLowerCase()&&"with"!==a.value.toLowerCase()?n():v();if("}"===a.value){if(P.tokens[P.openCurlyToken-3]&&"Keyword"===P.tokens[P.openCurlyToken-3].type){if(a=P.tokens[P.openCurlyToken-4],!a)return n()}else if(P.tokens[P.openCurlyToken-4]&&"Keyword"===P.tokens[P.openCurlyToken-4].type){if(a=P.tokens[P.openCurlyToken-
5],!a)return v()}else return n();if(0<=Ba.indexOf(a.value))return n()}return v()}return"Keyword"===a.type&&"this"!==a.value?v():n()}function w(){var b;a();if(I>=na)return{type:T.EOF,lineNumber:ga,lineStart:ja,start:I,end:I};b=S.charCodeAt(I);if(p(b)){var c;b=I;if(92===S.charCodeAt(I))c=u();else a:{var f;for(c=I++;I<na;){f=S.charCodeAt(I);if(92===f){I=c;c=u();break a}if(h(f))++I;else break}c=S.slice(c,I)}return{type:1===c.length?T.Identifier:e(c)?T.Keyword:"null"===c.toLowerCase()?T.NullLiteral:"true"===
c.toLowerCase()||"false"===c.toLowerCase()?T.BooleanLiteral:T.Identifier,value:c,lineNumber:ga,lineStart:ja,start:b,end:I}}if(40===b||41===b||59===b)return n();if(39===b||34===b){var v="",w,z,A;f=!1;var y,r;y=ga;r=ja;b=S[I];l("'"===b||'"'===b,"String literal must starts with a quote");c=I;for(++I;I<na;)if(w=S[I++],w===b){b="";break}else if("\\"===w)if((w=S[I++])&&m(w.charCodeAt(0)))++ga,"\r"===w&&"\n"===S[I]&&++I,ja=I;else switch(w){case "u":case "x":if("{"===S[I]){++I;z=w=void 0;w=S[I];z=0;for("}"===
w&&K();I<na;){w=S[I++];if(!q(w))break;z=16*z+"0123456789abcdef".indexOf(w.toLowerCase())}(1114111<z||"}"!==w)&&K();w=65535>=z?String.fromCharCode(z):String.fromCharCode((z-65536>>10)+55296,(z-65536&1023)+56320);v+=w}else A=I,(z=g(w))?v+=z:(I=A,v+=w);break;case "n":v+="\n";break;case "r":v+="\r";break;case "t":v+="\t";break;case "b":v+="\b";break;case "f":v+="\f";break;case "v":v+="\x0B";break;default:k(w)?(z="01234567".indexOf(w),0!==z&&(f=!0),I<na&&k(S[I])&&(f=!0,z=8*z+"01234567".indexOf(S[I++]),
0<="0123".indexOf(w)&&I<na&&k(S[I])&&(z=8*z+"01234567".indexOf(S[I++]))),v+=String.fromCharCode(z)):v+=w}else if(m(w.charCodeAt(0)))break;else v+=w;""!==b&&K();return{type:T.StringLiteral,value:v,octal:f,startLineNumber:y,startLineStart:r,lineNumber:ga,lineStart:ja,start:c,end:I}}return 46===b?d(S.charCodeAt(I+1))?t():n():d(b)?t():P.tokenize&&47===b?x():n()}function z(){var b,c,f;a();b={start:{line:ga,column:I-ja}};c=w();b.end={line:ga,column:I-ja};c.type!==T.EOF&&(f=S.slice(c.start,c.end),b={type:xa[c.type],
value:f,range:[c.start,c.end],loc:b},c.regex&&(b.regex={pattern:c.regex.pattern,flags:c.regex.flags}),P.tokens.push(b));return c}function A(){var a;a=X;I=a.end;ga=a.lineNumber;ja=a.lineStart;X="undefined"!==typeof P.tokens?z():w();I=a.end;ga=a.lineNumber;ja=a.lineStart;return a}function y(){var a,b,c;a=I;b=ga;c=ja;X="undefined"!==typeof P.tokens?z():w();I=a;ga=b;ja=c}function B(){this.line=ga;this.column=I-ja}function C(){this.start=new B;this.end=null}function E(a){this.start=a.type===T.StringLiteral?
{line:a.startLineNumber,column:a.start-a.startLineStart}:{line:a.lineNumber,column:a.start-a.lineStart};this.end=null}function D(){I=X.start;X.type===T.StringLiteral?(ga=X.startLineNumber,ja=X.startLineStart):(ga=X.lineNumber,ja=X.lineStart);P.range&&(this.range=[I,0]);P.loc&&(this.loc=new C)}function F(a){P.range&&(this.range=[a.start,0]);P.loc&&(this.loc=new E(a))}function G(){var b,c,f,g;b=I;c=ga;f=ja;a();g=ga!==c;I=b;ga=c;ja=f;return g}function J(a,b,c){var f=Error("Line "+a+": "+c);f.index=b;
f.lineNumber=a;f.column=b-ja+1;f.description=c;return f}function N(a){var b,c;b=Array.prototype.slice.call(arguments,1);c=a.replace(/%(\d)/g,function(a,c){l(c<b.length,"Message reference must be in range");return b[c]});throw J(ga,I,c);}function M(a){var b,c;b=Array.prototype.slice.call(arguments,1);c=a.replace(/%(\d)/g,function(a,c){l(c<b.length,"Message reference must be in range");return b[c]});c=J(ga,I,c);if(P.errors)P.errors.push(c);else throw c;}function L(a,b){var c=aa.UnexpectedToken;a&&(c=
b?b:a.type===T.EOF?aa.UnexpectedEOS:a.type===T.Identifier?aa.UnexpectedIdentifier:a.type===T.NumericLiteral?aa.UnexpectedNumber:a.type===T.StringLiteral?aa.UnexpectedString:aa.UnexpectedToken);c=c.replace("%0",a?a.value:"ILLEGAL");return a&&"number"===typeof a.lineNumber?J(a.lineNumber,a.start,c):J(ga,I,c)}function K(a,b){throw L(a,b);}function W(a,b){var c=L(a,b);if(P.errors)P.errors.push(c);else throw c;}function R(a){var b=A();b.type===T.Punctuator&&b.value===a||K(b)}function ba(){var a;P.errors?
(a=X,a.type===T.Punctuator&&","===a.value?A():a.type===T.Punctuator&&";"===a.value?(A(),W(a)):W(a,aa.UnexpectedToken)):R(",")}function O(a){var b=A();b.type===T.Keyword&&b.value.toLowerCase()===a.toLowerCase()||K(b)}function Q(a){return X.type===T.Punctuator&&X.value===a}function U(a){return X.type===T.Keyword&&X.value.toLowerCase()===a.toLowerCase()}function ia(){var b;59===S.charCodeAt(I)||Q(";")?A():(b=ga,a(),ga===b&&(X.type===T.EOF||Q("}")||K(X)))}function Y(a){return a.type===fa.Identifier||
a.type===fa.MemberExpression}function ca(a,b){var c,f,g=new D;c=ha;f=Ca();ha=c;return g.finishFunctionExpression(null,a,[],f)}function H(){var a,b;a=ha;ha=!0;b=$a();b=ca(b.params);ha=a;return b}function ea(){var a,b=new D;a=A();return a.type===T.StringLiteral||a.type===T.NumericLiteral?(ha&&a.octal&&W(a,aa.StrictOctalLiteral),b.finishLiteral(a)):b.finishIdentifier(a.value)}function va(){var a,b,c,f=new D;a=X;if(a.type===T.Identifier)return b=ea(),"get"!==a.value||Q(":")||Q("(")?"set"!==a.value||Q(":")||
Q("(")?Q(":")?(A(),a=ra(),f.finishProperty("init",b,a,!1,!1)):Q("(")?(a=H(),f.finishProperty("init",b,a,!0,!1)):f.finishProperty("init",b,b,!1,!0):(b=ea(),R("("),a=X,a.type!==T.Identifier?(R(")"),W(a),a=ca([])):(c=[Fa()],R(")"),a=ca(c,a)),f.finishProperty("set",b,a,!1,!1)):(b=ea(),R("("),R(")"),a=ca([]),f.finishProperty("get",b,a,!1,!1));if(a.type===T.EOF||a.type===T.Punctuator)K(a);else{b=ea();if(Q(":"))return A(),a=ra(),f.finishProperty("init",b,a,!1,!1);if(Q("("))return a=H(),f.finishProperty("init",
b,a,!0,!1);K(A())}}function la(a){var b=[],c,f,g={},e=String,h=new D;for(!0!==a&&R("{");!Q("}");)a=va(),c=a.key.type===fa.Identifier?a.key.name:e(a.key.value),f="init"===a.kind?Na.Data:"get"===a.kind?Na.Get:Na.Set,c="$"+c,Object.prototype.hasOwnProperty.call(g,c)?(g[c]===Na.Data?ha&&f===Na.Data?M(aa.StrictDuplicateProperty):f!==Na.Data&&M(aa.AccessorDataProperty):f===Na.Data?M(aa.AccessorDataProperty):g[c]&f&&M(aa.AccessorGetSet),g[c]|=f):g[c]=f,b.push(a),Q("}")||ba();R("}");return h.finishObjectExpression(b)}
function ma(){var a,b,c,g;if(Q("("))return R("("),Q(")")?(A(),b=Xa.ArrowParameterPlaceHolder):(++Z.parenthesisCount,b=oa(),R(")")),b;if(Q("[")){b=[];var e=new D;for(R("[");!Q("]");)Q(",")?(A(),b.push(null)):(b.push(ra()),Q("]")||R(","));A();return e.finishArrayExpression(b)}if(Q("{"))return la();a=X.type;g=new D;if(a===T.Identifier)c=g.finishIdentifier(A().value);else if(a===T.StringLiteral||a===T.NumericLiteral)ha&&X.octal&&W(X,aa.StrictOctalLiteral),c=g.finishLiteral(A());else if(a===T.Keyword){if(U("function")){g=
null;var h;c=[];var d=[],n,t=new D;O("function");Q("(")||(g=Fa());h=$a(b);c=h.params;d=h.defaults;a=h.stricted;b=h.firstRestricted;h.message&&(e=h.message);n=ha;h=Ca();ha&&b&&K(b,e);ha&&a&&W(a,e);ha=n;return t.finishFunctionExpression(g,c,d,h)}U("this")?(A(),c=g.finishThisExpression()):K(A())}else a===T.BooleanLiteral?(b=A(),b.value="true"===b.value.toLowerCase(),c=g.finishLiteral(b)):a===T.NullLiteral?(b=A(),b.value=null,c=g.finishLiteral(b)):Q("/")||Q("/\x3d")?(c="undefined"!==typeof P.tokens?g.finishLiteral(v()):
g.finishLiteral(f()),y()):K(A());return c}function sa(){var a=[];R("(");if(!Q(")"))for(;I<na;){a.push(ra());if(Q(")"))break;ba()}R(")");return a}function ka(){R(".");var a,b=new D;a=A();a.type===T.Identifier||a.type===T.Keyword||a.type===T.BooleanLiteral||a.type===T.NullLiteral||K(a);return b.finishIdentifier(a.value)}function ta(){var a;R("[");a=oa();R("]");return a}function ua(){var a,b,c=new D;O("new");var f;l(Z.allowIn,"callee of new expression always allow in keyword.");f=X;for(a=U("new")?ua():
ma();;)if(Q("["))b=ta(),a=(new F(f)).finishMemberExpression("[",a,b);else if(Q("."))b=ka(),a=(new F(f)).finishMemberExpression(".",a,b);else break;b=Q("(")?sa():[];return c.finishNewExpression(a,b)}function qa(){var a,b,c=X,f,g=Z.allowIn;b=X;Z.allowIn=!0;for(a=U("new")?ua():ma();;)if(Q("."))f=ka(),a=(new F(b)).finishMemberExpression(".",a,f);else if(Q("("))f=sa(),a=(new F(b)).finishCallExpression(a,f);else if(Q("["))f=ta(),a=(new F(b)).finishMemberExpression("[",a,f);else break;Z.allowIn=g;X.type!==
T.Punctuator||!Q("++")&&!Q("--")||G()||(Y(a)||M(aa.InvalidLHSInAssignment),b=A(),a=(new F(c)).finishPostfixExpression(b.value,a));return a}function da(){var a,b,c;X.type!==T.Punctuator&&X.type!==T.Keyword?b=qa():Q("++")||Q("--")?(c=X,a=A(),b=da(),Y(b)||M(aa.InvalidLHSInAssignment),b=(new F(c)).finishUnaryExpression(a.value,b)):Q("+")||Q("-")||Q("~")||Q("!")?(c=X,a=A(),b=da(),b=(new F(c)).finishUnaryExpression(a.value,b)):U("delete")||U("void")||U("typeof")?(c=X,a=A(),b=da(),b=(new F(c)).finishUnaryExpression(a.value,
b),ha&&"delete"===b.operator&&b.argument.type===fa.Identifier&&M(aa.StrictDelete)):b=qa();return b}function Aa(a,b){var c=0;if(a.type!==T.Punctuator&&a.type!==T.Keyword)return 0;switch(a.value){case "||":c=1;break;case "\x26\x26":c=2;break;case "|":c=3;break;case "^":c=4;break;case "\x26":c=5;break;case "\x3d\x3d":case "!\x3d":case "\x3d\x3d\x3d":case "!\x3d\x3d":c=6;break;case "\x3c":case "\x3e":case "\x3c\x3d":case "\x3e\x3d":case "instanceof":c=7;break;case "in":c=b?7:0;break;case "\x3c\x3c":case "\x3e\x3e":case "\x3e\x3e\x3e":c=
8;break;case "+":case "-":c=9;break;case "*":case "/":case "%":c=11}return c}function Ea(){var a,b,c,f,g,e;a=X;b=da();if(b===Xa.ArrowParameterPlaceHolder)return b;c=X;f=Aa(c,Z.allowIn);if(0===f)return b;c.prec=f;A();a=[a,X];e=da();for(g=[b,c,e];0<(f=Aa(X,Z.allowIn));){for(;2<g.length&&f<=g[g.length-2].prec;)e=g.pop(),c=g.pop().value,b=g.pop(),a.pop(),b=(new F(a[a.length-1])).finishBinaryExpression(c,b,e),g.push(b);c=A();c.prec=f;g.push(c);a.push(X);b=da();g.push(b)}f=g.length-1;b=g[f];for(a.pop();1<
f;)b=(new F(a.pop())).finishBinaryExpression(g[f-1].value,g[f-2],b),f-=2;return b}function za(a){var b,c,f,g,e,h,d;g=[];e=[];h=0;d={paramSet:{}};b=0;for(c=a.length;b<c;b+=1)if(f=a[b],f.type===fa.Identifier)g.push(f),e.push(null),Ta(d,f,f.name);else if(f.type===fa.AssignmentExpression)g.push(f.left),e.push(f.right),++h,Ta(d,f.left,f.left.name);else return null;d.message===aa.StrictParamDupe&&(a=ha?d.stricted:d.firstRestricted,K(a,d.message));0===h&&(e=[]);return{params:g,defaults:e,rest:null,stricted:d.stricted,
firstRestricted:d.firstRestricted,message:d.message}}function ra(){var a,b,c,f,g;a=Z.parenthesisCount;b=g=X;var e,h;h=X;c=Ea();c!==Xa.ArrowParameterPlaceHolder&&Q("?")&&(A(),e=Z.allowIn,Z.allowIn=!0,b=ra(),Z.allowIn=e,R(":"),e=ra(),c=(new F(h)).finishConditionalExpression(c,b,e));if(c===Xa.ArrowParameterPlaceHolder||Q("\x3d\x3e"))if(Z.parenthesisCount===a||Z.parenthesisCount===a+1)if(c.type===fa.Identifier?f=za([c]):c.type===fa.AssignmentExpression?f=za([c]):c.type===fa.SequenceExpression?f=za(c.expressions):
c===Xa.ArrowParameterPlaceHolder&&(f=za([])),f)return a=f,g=new F(g),R("\x3d\x3e"),f=ha,c=Q("{")?Ca():ra(),ha&&a.firstRestricted&&K(a.firstRestricted,a.message),ha&&a.stricted&&W(a.stricted,a.message),ha=f,g.finishArrowFunctionExpression(a.params,a.defaults,c,c.type!==fa.BlockStatement);X.type!==T.Punctuator?a=!1:(a=X.value,a="\x3d"===a||"*\x3d"===a||"/\x3d"===a||"%\x3d"===a||"+\x3d"===a||"-\x3d"===a||"\x3c\x3c\x3d"===a||"\x3e\x3e\x3d"===a||"\x3e\x3e\x3e\x3d"===a||"\x26\x3d"===a||"^\x3d"===a||"|\x3d"===
a);a&&(Y(c)||M(aa.InvalidLHSInAssignment),b=A(),a=ra(),c=(new F(g)).finishAssignmentExpression(b.value,c,a));return c}function oa(){var a,b=X;a=ra();if(Q(",")){for(a=[a];I<na&&Q(",");)A(),a.push(ra());a=(new F(b)).finishSequenceExpression(a)}return a}function Fa(){var a,b=new D;a=A();a.type!==T.Identifier&&K(a);return b.finishIdentifier(a.value)}function Ma(a){var b=null,c,f=new D;c=Fa();"const"===a?(R("\x3d"),b=ra()):Q("\x3d")&&(A(),b=ra());return f.finishVariableDeclarator(c,b)}function Ja(a){var b=
[];do{b.push(Ma(a));if(!Q(","))break;A()}while(I<na);return b}function Ga(a){var b=X.type,c,f;b===T.EOF&&K(X);if(b===T.Punctuator&&"{"===X.value){if(a){R("{");var g=X;a=I;c=ga;f=ja;A();b=Q(":");X=g;I=a;ga=c;ja=f;if((X.type===T.Identifier||X.type===T.StringLiteral)&&b)return la(!0);a=new D;for(c=[];I<na&&!Q("}");){f=Ua();if("undefined"===typeof f)break;c.push(f)}R("}");return a.finishBlockStatement(c)}return la()}a=new D;if(b===T.Punctuator)switch(X.value){case ";":return a=new D,R(";"),a.finishEmptyStatement();
case "(":return c=oa(),ia(),a.finishExpressionStatement(c)}else if(b===T.Keyword)switch(X.value.toLowerCase()){case "break":return c=null,O("break"),59===S.charCodeAt(I)?(A(),Z.inIteration||Z.inSwitch||N(aa.IllegalBreak),a=a.finishBreakStatement(null)):G()?(Z.inIteration||Z.inSwitch||N(aa.IllegalBreak),a=a.finishBreakStatement(null)):(X.type===T.Identifier&&(c=Fa(),f="$"+c.name,Object.prototype.hasOwnProperty.call(Z.labelSet,f)||N(aa.UnknownLabel,c.name)),ia(),null!==c||Z.inIteration||Z.inSwitch||
N(aa.IllegalBreak),a=a.finishBreakStatement(c)),a;case "continue":return c=null,O("continue"),59===S.charCodeAt(I)?(A(),Z.inIteration||N(aa.IllegalContinue),a=a.finishContinueStatement(null)):G()?(Z.inIteration||N(aa.IllegalContinue),a=a.finishContinueStatement(null)):(X.type===T.Identifier&&(c=Fa(),f="$"+c.name,Object.prototype.hasOwnProperty.call(Z.labelSet,f)||N(aa.UnknownLabel,c.name)),ia(),null!==c||Z.inIteration||N(aa.IllegalContinue),a=a.finishContinueStatement(c)),a;case "for":var e,h,d;h=
Z.allowIn;e=b=g=null;O("for");R("(");if(Q(";"))A();else{if(U("var")){Z.allowIn=!1;var n=new D;e=A();d=Ja();e=n.finishVariableDeclaration(d,e.value);Z.allowIn=h;1===e.declarations.length&&U("in")&&(A(),c=e,f=oa(),e=null)}else Z.allowIn=!1,e=oa(),Z.allowIn=h,U("in")&&(Y(e)||M(aa.InvalidLHSInForIn),A(),c=e,f=oa(),e=null);"undefined"===typeof c&&R(";")}"undefined"===typeof c&&(Q(";")||(b=oa()),R(";"),Q(")")||(g=oa()));R(")");d=Z.inIteration;Z.inIteration=!0;h=Ga(!0);Z.inIteration=d;return"undefined"===
typeof c?a.finishForStatement(e,b,g,h):a.finishForInStatement(c,f,h);case "function":return gb(a);case "if":return O("if"),R("("),c=oa(),R(")"),f=Ga(!0),U("else")?(A(),b=Ga(!0)):b=null,a.finishIfStatement(c,f,b);case "return":return c=null,O("return"),Z.inFunctionBody||M(aa.IllegalReturn),32===S.charCodeAt(I)&&p(S.charCodeAt(I+1))?(c=oa(),ia(),a=a.finishReturnStatement(c)):G()?a=a.finishReturnStatement(null):(Q(";")||Q("}")||X.type===T.EOF||(c=oa()),ia(),a=a.finishReturnStatement(c)),a;case "var":return O("var"),
c=Ja(),ia(),a.finishVariableDeclaration(c,"var")}c=oa();if(c.type===fa.Identifier&&Q(":"))return A(),b="$"+c.name,Object.prototype.hasOwnProperty.call(Z.labelSet,b)&&N(aa.Redeclaration,"Label",c.name),Z.labelSet[b]=!0,f=Ga(!1),delete Z.labelSet[b],a.finishLabeledStatement(c,f);ia();return a.finishExpressionStatement(c)}function Ca(){var a,b=[],c,f,g,e,h,d=new D;for(R("{");I<na&&X.type===T.StringLiteral;){c=X;a=Ua();b.push(a);if(a.expression.type!==fa.Literal)break;a=S.slice(c.start+1,c.end-1);"use strict"===
a?(ha=!0,f&&W(f,aa.StrictOctalLiteral)):!f&&c.octal&&(f=c)}c=Z.labelSet;f=Z.inIteration;g=Z.inSwitch;e=Z.inFunctionBody;h=Z.parenthesizedCount;Z.labelSet={};Z.inIteration=!1;Z.inSwitch=!1;Z.inFunctionBody=!0;for(Z.parenthesizedCount=0;I<na&&!Q("}");){a=Ua();if("undefined"===typeof a)break;b.push(a)}R("}");Z.labelSet=c;Z.inIteration=f;Z.inSwitch=g;Z.inFunctionBody=e;Z.parenthesizedCount=h;return d.finishBlockStatement(b)}function Ta(a,b,c){c="$"+c;ha?Object.prototype.hasOwnProperty.call(a.paramSet,
c)&&(a.stricted=b,a.message=aa.StrictParamDupe):!a.firstRestricted&&Object.prototype.hasOwnProperty.call(a.paramSet,c)&&(a.firstRestricted=b,a.message=aa.StrictParamDupe);a.paramSet[c]=!0}function $a(a){a={params:[],defaultCount:0,defaults:[],firstRestricted:a};R("(");if(!Q(")"))for(a.paramSet={};I<na;){var b=a,c=void 0,f=void 0,g=void 0,c=X,f=Fa();Ta(b,c,c.value);Q("\x3d")&&(A(),g=ra(),++b.defaultCount);b.params.push(f);b.defaults.push(g);if(Q(")"))break;R(",")}R(")");0===a.defaultCount&&(a.defaults=
[]);return{params:a.params,defaults:a.defaults,stricted:a.stricted,firstRestricted:a.firstRestricted,message:a.message}}function gb(){var a,b=[],c=[],f,g,e,h,d,n=new D;O("function");a=Fa();f=$a(e);b=f.params;c=f.defaults;g=f.stricted;e=f.firstRestricted;f.message&&(h=f.message);d=ha;f=Ca();ha&&e&&K(e,h);ha&&g&&W(g,h);ha=d;return n.finishFunctionDeclaration(a,b,c,f)}function Ua(){if(X.type===T.Keyword)return"function"===X.value.toLowerCase()?gb():Ga(!1);if(X.type!==T.EOF)return Ga(!1)}function Ha(){var a,
b,c,f=[];for(a=0;a<P.tokens.length;++a)b=P.tokens[a],c={type:b.type,value:b.value},b.regex&&(c.regex={pattern:b.regex.pattern,flags:b.regex.flags}),P.range&&(c.range=b.range),P.loc&&(c.loc=b.loc),f.push(c);P.tokens=f}var T,xa,Ba,fa,Xa,Na,aa,cb,S,ha,I,ga,ja,na,X,Z,P;T={BooleanLiteral:1,EOF:2,Identifier:3,Keyword:4,NullLiteral:5,NumericLiteral:6,Punctuator:7,StringLiteral:8,RegularExpression:9};xa={};xa[T.BooleanLiteral]="Boolean";xa[T.EOF]="\x3cend\x3e";xa[T.Identifier]="Identifier";xa[T.Keyword]=
"Keyword";xa[T.NullLiteral]="Null";xa[T.NumericLiteral]="Numeric";xa[T.Punctuator]="Punctuator";xa[T.StringLiteral]="String";xa[T.RegularExpression]="RegularExpression";Ba="( { [ in typeof instanceof new return case delete throw void \x3d +\x3d -\x3d *\x3d /\x3d %\x3d \x3c\x3c\x3d \x3e\x3e\x3d \x3e\x3e\x3e\x3d \x26\x3d |\x3d ^\x3d , + - * / % ++ -- \x3c\x3c \x3e\x3e \x3e\x3e\x3e \x26 | ^ ! ~ \x26\x26 || ? : \x3d\x3d\x3d \x3d\x3d \x3e\x3d \x3c\x3d \x3c \x3e !\x3d !\x3d\x3d".split(" ");fa={AssignmentExpression:"AssignmentExpression",
ArrayExpression:"ArrayExpression",BlockStatement:"BlockStatement",BinaryExpression:"BinaryExpression",BreakStatement:"BreakStatement",CallExpression:"CallExpression",ConditionalExpression:"ConditionalExpression",ContinueStatement:"ContinueStatement",DoWhileStatement:"DoWhileStatement",EmptyStatement:"EmptyStatement",ExpressionStatement:"ExpressionStatement",ForStatement:"ForStatement",ForInStatement:"ForInStatement",FunctionDeclaration:"FunctionDeclaration",FunctionExpression:"FunctionExpression",
Identifier:"Identifier",IfStatement:"IfStatement",Literal:"Literal",LogicalExpression:"LogicalExpression",MemberExpression:"MemberExpression",ObjectExpression:"ObjectExpression",Program:"Program",Property:"Property",ReturnStatement:"ReturnStatement",UnaryExpression:"UnaryExpression",UpdateExpression:"UpdateExpression",VariableDeclaration:"VariableDeclaration",VariableDeclarator:"VariableDeclarator"};Xa={ArrowParameterPlaceHolder:{type:"ArrowParameterPlaceHolder"}};Na={Data:1,Get:2,Set:4};aa={UnexpectedToken:"Unexpected token %0",
UnexpectedNumber:"Unexpected number",UnexpectedString:"Unexpected string",UnexpectedIdentifier:"Unexpected identifier",UnexpectedReserved:"Unexpected reserved word",UnexpectedEOS:"Unexpected end of input",NewlineAfterThrow:"Illegal newline after throw",InvalidRegExp:"Invalid regular expression",UnterminatedRegExp:"Invalid regular expression: missing /",InvalidLHSInAssignment:"Invalid left-hand side in assignment",InvalidLHSInForIn:"Invalid left-hand side in for-in",MultipleDefaultsInSwitch:"More than one default clause in switch statement",
NoCatchOrFinally:"Missing catch or finally after try",UnknownLabel:"Undefined label '%0'",Redeclaration:"%0 '%1' has already been declared",IllegalContinue:"Illegal continue statement",IllegalBreak:"Illegal break statement",IllegalReturn:"Illegal return statement",StrictModeWith:"Strict mode code may not include a with statement",StrictCatchVariable:"Catch variable may not be eval or arguments in strict mode",StrictVarName:"Variable name may not be eval or arguments in strict mode",StrictParamName:"Parameter name eval or arguments is not allowed in strict mode",
StrictParamDupe:"Strict mode function may not have duplicate parameter names",StrictFunctionName:"Function name may not be eval or arguments in strict mode",StrictOctalLiteral:"Octal literals are not allowed in strict mode.",StrictDelete:"Delete of an unqualified identifier in strict mode.",StrictDuplicateProperty:"Duplicate data property in object literal not allowed in strict mode",AccessorDataProperty:"Object literal may not have data and accessor property with the same name",AccessorGetSet:"Object literal may not have multiple get/set accessors with the same name",
StrictLHSAssignment:"Assignment to eval or arguments is not allowed in strict mode",StrictLHSPostfix:"Postfix increment/decrement may not have eval or arguments operand in strict mode",StrictLHSPrefix:"Prefix increment/decrement may not have eval or arguments operand in strict mode",StrictReservedWord:"Use of future reserved word in strict mode"};cb={NonAsciiIdentifierStart:RegExp("[\u00aa\u00b5\u00ba\u00c0-\u00d6\u00d8-\u00f6\u00f8-\u02c1\u02c6-\u02d1\u02e0-\u02e4\u02ec\u02ee\u0370-\u0374\u0376\u0377\u037a-\u037d\u037f\u0386\u0388-\u038a\u038c\u038e-\u03a1\u03a3-\u03f5\u03f7-\u0481\u048a-\u052f\u0531-\u0556\u0559\u0561-\u0587\u05d0-\u05ea\u05f0-\u05f2\u0620-\u064a\u066e\u066f\u0671-\u06d3\u06d5\u06e5\u06e6\u06ee\u06ef\u06fa-\u06fc\u06ff\u0710\u0712-\u072f\u074d-\u07a5\u07b1\u07ca-\u07ea\u07f4\u07f5\u07fa\u0800-\u0815\u081a\u0824\u0828\u0840-\u0858\u08a0-\u08b2\u0904-\u0939\u093d\u0950\u0958-\u0961\u0971-\u0980\u0985-\u098c\u098f\u0990\u0993-\u09a8\u09aa-\u09b0\u09b2\u09b6-\u09b9\u09bd\u09ce\u09dc\u09dd\u09df-\u09e1\u09f0\u09f1\u0a05-\u0a0a\u0a0f\u0a10\u0a13-\u0a28\u0a2a-\u0a30\u0a32\u0a33\u0a35\u0a36\u0a38\u0a39\u0a59-\u0a5c\u0a5e\u0a72-\u0a74\u0a85-\u0a8d\u0a8f-\u0a91\u0a93-\u0aa8\u0aaa-\u0ab0\u0ab2\u0ab3\u0ab5-\u0ab9\u0abd\u0ad0\u0ae0\u0ae1\u0b05-\u0b0c\u0b0f\u0b10\u0b13-\u0b28\u0b2a-\u0b30\u0b32\u0b33\u0b35-\u0b39\u0b3d\u0b5c\u0b5d\u0b5f-\u0b61\u0b71\u0b83\u0b85-\u0b8a\u0b8e-\u0b90\u0b92-\u0b95\u0b99\u0b9a\u0b9c\u0b9e\u0b9f\u0ba3\u0ba4\u0ba8-\u0baa\u0bae-\u0bb9\u0bd0\u0c05-\u0c0c\u0c0e-\u0c10\u0c12-\u0c28\u0c2a-\u0c39\u0c3d\u0c58\u0c59\u0c60\u0c61\u0c85-\u0c8c\u0c8e-\u0c90\u0c92-\u0ca8\u0caa-\u0cb3\u0cb5-\u0cb9\u0cbd\u0cde\u0ce0\u0ce1\u0cf1\u0cf2\u0d05-\u0d0c\u0d0e-\u0d10\u0d12-\u0d3a\u0d3d\u0d4e\u0d60\u0d61\u0d7a-\u0d7f\u0d85-\u0d96\u0d9a-\u0db1\u0db3-\u0dbb\u0dbd\u0dc0-\u0dc6\u0e01-\u0e30\u0e32\u0e33\u0e40-\u0e46\u0e81\u0e82\u0e84\u0e87\u0e88\u0e8a\u0e8d\u0e94-\u0e97\u0e99-\u0e9f\u0ea1-\u0ea3\u0ea5\u0ea7\u0eaa\u0eab\u0ead-\u0eb0\u0eb2\u0eb3\u0ebd\u0ec0-\u0ec4\u0ec6\u0edc-\u0edf\u0f00\u0f40-\u0f47\u0f49-\u0f6c\u0f88-\u0f8c\u1000-\u102a\u103f\u1050-\u1055\u105a-\u105d\u1061\u1065\u1066\u106e-\u1070\u1075-\u1081\u108e\u10a0-\u10c5\u10c7\u10cd\u10d0-\u10fa\u10fc-\u1248\u124a-\u124d\u1250-\u1256\u1258\u125a-\u125d\u1260-\u1288\u128a-\u128d\u1290-\u12b0\u12b2-\u12b5\u12b8-\u12be\u12c0\u12c2-\u12c5\u12c8-\u12d6\u12d8-\u1310\u1312-\u1315\u1318-\u135a\u1380-\u138f\u13a0-\u13f4\u1401-\u166c\u166f-\u167f\u1681-\u169a\u16a0-\u16ea\u16ee-\u16f8\u1700-\u170c\u170e-\u1711\u1720-\u1731\u1740-\u1751\u1760-\u176c\u176e-\u1770\u1780-\u17b3\u17d7\u17dc\u1820-\u1877\u1880-\u18a8\u18aa\u18b0-\u18f5\u1900-\u191e\u1950-\u196d\u1970-\u1974\u1980-\u19ab\u19c1-\u19c7\u1a00-\u1a16\u1a20-\u1a54\u1aa7\u1b05-\u1b33\u1b45-\u1b4b\u1b83-\u1ba0\u1bae\u1baf\u1bba-\u1be5\u1c00-\u1c23\u1c4d-\u1c4f\u1c5a-\u1c7d\u1ce9-\u1cec\u1cee-\u1cf1\u1cf5\u1cf6\u1d00-\u1dbf\u1e00-\u1f15\u1f18-\u1f1d\u1f20-\u1f45\u1f48-\u1f4d\u1f50-\u1f57\u1f59\u1f5b\u1f5d\u1f5f-\u1f7d\u1f80-\u1fb4\u1fb6-\u1fbc\u1fbe\u1fc2-\u1fc4\u1fc6-\u1fcc\u1fd0-\u1fd3\u1fd6-\u1fdb\u1fe0-\u1fec\u1ff2-\u1ff4\u1ff6-\u1ffc\u2071\u207f\u2090-\u209c\u2102\u2107\u210a-\u2113\u2115\u2119-\u211d\u2124\u2126\u2128\u212a-\u212d\u212f-\u2139\u213c-\u213f\u2145-\u2149\u214e\u2160-\u2188\u2c00-\u2c2e\u2c30-\u2c5e\u2c60-\u2ce4\u2ceb-\u2cee\u2cf2\u2cf3\u2d00-\u2d25\u2d27\u2d2d\u2d30-\u2d67\u2d6f\u2d80-\u2d96\u2da0-\u2da6\u2da8-\u2dae\u2db0-\u2db6\u2db8-\u2dbe\u2dc0-\u2dc6\u2dc8-\u2dce\u2dd0-\u2dd6\u2dd8-\u2dde\u2e2f\u3005-\u3007\u3021-\u3029\u3031-\u3035\u3038-\u303c\u3041-\u3096\u309d-\u309f\u30a1-\u30fa\u30fc-\u30ff\u3105-\u312d\u3131-\u318e\u31a0-\u31ba\u31f0-\u31ff\u3400-\u4db5\u4e00-\u9fcc\ua000-\ua48c\ua4d0-\ua4fd\ua500-\ua60c\ua610-\ua61f\ua62a\ua62b\ua640-\ua66e\ua67f-\ua69d\ua6a0-\ua6ef\ua717-\ua71f\ua722-\ua788\ua78b-\ua78e\ua790-\ua7ad\ua7b0\ua7b1\ua7f7-\ua801\ua803-\ua805\ua807-\ua80a\ua80c-\ua822\ua840-\ua873\ua882-\ua8b3\ua8f2-\ua8f7\ua8fb\ua90a-\ua925\ua930-\ua946\ua960-\ua97c\ua984-\ua9b2\ua9cf\ua9e0-\ua9e4\ua9e6-\ua9ef\ua9fa-\ua9fe\uaa00-\uaa28\uaa40-\uaa42\uaa44-\uaa4b\uaa60-\uaa76\uaa7a\uaa7e-\uaaaf\uaab1\uaab5\uaab6\uaab9-\uaabd\uaac0\uaac2\uaadb-\uaadd\uaae0-\uaaea\uaaf2-\uaaf4\uab01-\uab06\uab09-\uab0e\uab11-\uab16\uab20-\uab26\uab28-\uab2e\uab30-\uab5a\uab5c-\uab5f\uab64\uab65\uabc0-\uabe2\uac00-\ud7a3\ud7b0-\ud7c6\ud7cb-\ud7fb\uf900-\ufa6d\ufa70-\ufad9\ufb00-\ufb06\ufb13-\ufb17\ufb1d\ufb1f-\ufb28\ufb2a-\ufb36\ufb38-\ufb3c\ufb3e\ufb40\ufb41\ufb43\ufb44\ufb46-\ufbb1\ufbd3-\ufd3d\ufd50-\ufd8f\ufd92-\ufdc7\ufdf0-\ufdfb\ufe70-\ufe74\ufe76-\ufefc\uff21-\uff3a\uff41-\uff5a\uff66-\uffbe\uffc2-\uffc7\uffca-\uffcf\uffd2-\uffd7\uffda-\uffdc]"),
NonAsciiIdentifierPart:RegExp("[\u00aa\u00b5\u00ba\u00c0-\u00d6\u00d8-\u00f6\u00f8-\u02c1\u02c6-\u02d1\u02e0-\u02e4\u02ec\u02ee\u0300-\u0374\u0376\u0377\u037a-\u037d\u037f\u0386\u0388-\u038a\u038c\u038e-\u03a1\u03a3-\u03f5\u03f7-\u0481\u0483-\u0487\u048a-\u052f\u0531-\u0556\u0559\u0561-\u0587\u0591-\u05bd\u05bf\u05c1\u05c2\u05c4\u05c5\u05c7\u05d0-\u05ea\u05f0-\u05f2\u0610-\u061a\u0620-\u0669\u066e-\u06d3\u06d5-\u06dc\u06df-\u06e8\u06ea-\u06fc\u06ff\u0710-\u074a\u074d-\u07b1\u07c0-\u07f5\u07fa\u0800-\u082d\u0840-\u085b\u08a0-\u08b2\u08e4-\u0963\u0966-\u096f\u0971-\u0983\u0985-\u098c\u098f\u0990\u0993-\u09a8\u09aa-\u09b0\u09b2\u09b6-\u09b9\u09bc-\u09c4\u09c7\u09c8\u09cb-\u09ce\u09d7\u09dc\u09dd\u09df-\u09e3\u09e6-\u09f1\u0a01-\u0a03\u0a05-\u0a0a\u0a0f\u0a10\u0a13-\u0a28\u0a2a-\u0a30\u0a32\u0a33\u0a35\u0a36\u0a38\u0a39\u0a3c\u0a3e-\u0a42\u0a47\u0a48\u0a4b-\u0a4d\u0a51\u0a59-\u0a5c\u0a5e\u0a66-\u0a75\u0a81-\u0a83\u0a85-\u0a8d\u0a8f-\u0a91\u0a93-\u0aa8\u0aaa-\u0ab0\u0ab2\u0ab3\u0ab5-\u0ab9\u0abc-\u0ac5\u0ac7-\u0ac9\u0acb-\u0acd\u0ad0\u0ae0-\u0ae3\u0ae6-\u0aef\u0b01-\u0b03\u0b05-\u0b0c\u0b0f\u0b10\u0b13-\u0b28\u0b2a-\u0b30\u0b32\u0b33\u0b35-\u0b39\u0b3c-\u0b44\u0b47\u0b48\u0b4b-\u0b4d\u0b56\u0b57\u0b5c\u0b5d\u0b5f-\u0b63\u0b66-\u0b6f\u0b71\u0b82\u0b83\u0b85-\u0b8a\u0b8e-\u0b90\u0b92-\u0b95\u0b99\u0b9a\u0b9c\u0b9e\u0b9f\u0ba3\u0ba4\u0ba8-\u0baa\u0bae-\u0bb9\u0bbe-\u0bc2\u0bc6-\u0bc8\u0bca-\u0bcd\u0bd0\u0bd7\u0be6-\u0bef\u0c00-\u0c03\u0c05-\u0c0c\u0c0e-\u0c10\u0c12-\u0c28\u0c2a-\u0c39\u0c3d-\u0c44\u0c46-\u0c48\u0c4a-\u0c4d\u0c55\u0c56\u0c58\u0c59\u0c60-\u0c63\u0c66-\u0c6f\u0c81-\u0c83\u0c85-\u0c8c\u0c8e-\u0c90\u0c92-\u0ca8\u0caa-\u0cb3\u0cb5-\u0cb9\u0cbc-\u0cc4\u0cc6-\u0cc8\u0cca-\u0ccd\u0cd5\u0cd6\u0cde\u0ce0-\u0ce3\u0ce6-\u0cef\u0cf1\u0cf2\u0d01-\u0d03\u0d05-\u0d0c\u0d0e-\u0d10\u0d12-\u0d3a\u0d3d-\u0d44\u0d46-\u0d48\u0d4a-\u0d4e\u0d57\u0d60-\u0d63\u0d66-\u0d6f\u0d7a-\u0d7f\u0d82\u0d83\u0d85-\u0d96\u0d9a-\u0db1\u0db3-\u0dbb\u0dbd\u0dc0-\u0dc6\u0dca\u0dcf-\u0dd4\u0dd6\u0dd8-\u0ddf\u0de6-\u0def\u0df2\u0df3\u0e01-\u0e3a\u0e40-\u0e4e\u0e50-\u0e59\u0e81\u0e82\u0e84\u0e87\u0e88\u0e8a\u0e8d\u0e94-\u0e97\u0e99-\u0e9f\u0ea1-\u0ea3\u0ea5\u0ea7\u0eaa\u0eab\u0ead-\u0eb9\u0ebb-\u0ebd\u0ec0-\u0ec4\u0ec6\u0ec8-\u0ecd\u0ed0-\u0ed9\u0edc-\u0edf\u0f00\u0f18\u0f19\u0f20-\u0f29\u0f35\u0f37\u0f39\u0f3e-\u0f47\u0f49-\u0f6c\u0f71-\u0f84\u0f86-\u0f97\u0f99-\u0fbc\u0fc6\u1000-\u1049\u1050-\u109d\u10a0-\u10c5\u10c7\u10cd\u10d0-\u10fa\u10fc-\u1248\u124a-\u124d\u1250-\u1256\u1258\u125a-\u125d\u1260-\u1288\u128a-\u128d\u1290-\u12b0\u12b2-\u12b5\u12b8-\u12be\u12c0\u12c2-\u12c5\u12c8-\u12d6\u12d8-\u1310\u1312-\u1315\u1318-\u135a\u135d-\u135f\u1380-\u138f\u13a0-\u13f4\u1401-\u166c\u166f-\u167f\u1681-\u169a\u16a0-\u16ea\u16ee-\u16f8\u1700-\u170c\u170e-\u1714\u1720-\u1734\u1740-\u1753\u1760-\u176c\u176e-\u1770\u1772\u1773\u1780-\u17d3\u17d7\u17dc\u17dd\u17e0-\u17e9\u180b-\u180d\u1810-\u1819\u1820-\u1877\u1880-\u18aa\u18b0-\u18f5\u1900-\u191e\u1920-\u192b\u1930-\u193b\u1946-\u196d\u1970-\u1974\u1980-\u19ab\u19b0-\u19c9\u19d0-\u19d9\u1a00-\u1a1b\u1a20-\u1a5e\u1a60-\u1a7c\u1a7f-\u1a89\u1a90-\u1a99\u1aa7\u1ab0-\u1abd\u1b00-\u1b4b\u1b50-\u1b59\u1b6b-\u1b73\u1b80-\u1bf3\u1c00-\u1c37\u1c40-\u1c49\u1c4d-\u1c7d\u1cd0-\u1cd2\u1cd4-\u1cf6\u1cf8\u1cf9\u1d00-\u1df5\u1dfc-\u1f15\u1f18-\u1f1d\u1f20-\u1f45\u1f48-\u1f4d\u1f50-\u1f57\u1f59\u1f5b\u1f5d\u1f5f-\u1f7d\u1f80-\u1fb4\u1fb6-\u1fbc\u1fbe\u1fc2-\u1fc4\u1fc6-\u1fcc\u1fd0-\u1fd3\u1fd6-\u1fdb\u1fe0-\u1fec\u1ff2-\u1ff4\u1ff6-\u1ffc\u200c\u200d\u203f\u2040\u2054\u2071\u207f\u2090-\u209c\u20d0-\u20dc\u20e1\u20e5-\u20f0\u2102\u2107\u210a-\u2113\u2115\u2119-\u211d\u2124\u2126\u2128\u212a-\u212d\u212f-\u2139\u213c-\u213f\u2145-\u2149\u214e\u2160-\u2188\u2c00-\u2c2e\u2c30-\u2c5e\u2c60-\u2ce4\u2ceb-\u2cf3\u2d00-\u2d25\u2d27\u2d2d\u2d30-\u2d67\u2d6f\u2d7f-\u2d96\u2da0-\u2da6\u2da8-\u2dae\u2db0-\u2db6\u2db8-\u2dbe\u2dc0-\u2dc6\u2dc8-\u2dce\u2dd0-\u2dd6\u2dd8-\u2dde\u2de0-\u2dff\u2e2f\u3005-\u3007\u3021-\u302f\u3031-\u3035\u3038-\u303c\u3041-\u3096\u3099\u309a\u309d-\u309f\u30a1-\u30fa\u30fc-\u30ff\u3105-\u312d\u3131-\u318e\u31a0-\u31ba\u31f0-\u31ff\u3400-\u4db5\u4e00-\u9fcc\ua000-\ua48c\ua4d0-\ua4fd\ua500-\ua60c\ua610-\ua62b\ua640-\ua66f\ua674-\ua67d\ua67f-\ua69d\ua69f-\ua6f1\ua717-\ua71f\ua722-\ua788\ua78b-\ua78e\ua790-\ua7ad\ua7b0\ua7b1\ua7f7-\ua827\ua840-\ua873\ua880-\ua8c4\ua8d0-\ua8d9\ua8e0-\ua8f7\ua8fb\ua900-\ua92d\ua930-\ua953\ua960-\ua97c\ua980-\ua9c0\ua9cf-\ua9d9\ua9e0-\ua9fe\uaa00-\uaa36\uaa40-\uaa4d\uaa50-\uaa59\uaa60-\uaa76\uaa7a-\uaac2\uaadb-\uaadd\uaae0-\uaaef\uaaf2-\uaaf6\uab01-\uab06\uab09-\uab0e\uab11-\uab16\uab20-\uab26\uab28-\uab2e\uab30-\uab5a\uab5c-\uab5f\uab64\uab65\uabc0-\uabea\uabec\uabed\uabf0-\uabf9\uac00-\ud7a3\ud7b0-\ud7c6\ud7cb-\ud7fb\uf900-\ufa6d\ufa70-\ufad9\ufb00-\ufb06\ufb13-\ufb17\ufb1d-\ufb28\ufb2a-\ufb36\ufb38-\ufb3c\ufb3e\ufb40\ufb41\ufb43\ufb44\ufb46-\ufbb1\ufbd3-\ufd3d\ufd50-\ufd8f\ufd92-\ufdc7\ufdf0-\ufdfb\ufe00-\ufe0f\ufe20-\ufe2d\ufe33\ufe34\ufe4d-\ufe4f\ufe70-\ufe74\ufe76-\ufefc\uff10-\uff19\uff21-\uff3a\uff3f\uff41-\uff5a\uff66-\uffbe\uffc2-\uffc7\uffca-\uffcf\uffd2-\uffd7\uffda-\uffdc]")};
F.prototype=D.prototype={processComment:function(){var a,b,c,f=P.bottomRightStack,g,e,h=f[f.length-1];if(!(this.type===fa.Program&&0<this.body.length)){if(0<P.trailingComments.length){c=[];for(g=P.trailingComments.length-1;0<=g;--g)e=P.trailingComments[g],e.range[0]>=this.range[1]&&(c.unshift(e),P.trailingComments.splice(g,1));P.trailingComments=[]}else h&&h.trailingComments&&h.trailingComments[0].range[0]>=this.range[1]&&(c=h.trailingComments,delete h.trailingComments);if(h)for(;h&&h.range[0]>=this.range[0];)a=
h,h=f.pop();if(a)a.leadingComments&&a.leadingComments[a.leadingComments.length-1].range[1]<=this.range[0]&&(this.leadingComments=a.leadingComments,a.leadingComments=void 0);else if(0<P.leadingComments.length)for(b=[],g=P.leadingComments.length-1;0<=g;--g)e=P.leadingComments[g],e.range[1]<=this.range[0]&&(b.unshift(e),P.leadingComments.splice(g,1));b&&0<b.length&&(this.leadingComments=b);c&&0<c.length&&(this.trailingComments=c);f.push(this)}},finish:function(){P.range&&(this.range[1]=I);P.loc&&(this.loc.end=
new B,P.source&&(this.loc.source=P.source));P.attachComment&&this.processComment()},finishArrayExpression:function(a){this.type=fa.ArrayExpression;this.elements=a;this.finish();return this},finishAssignmentExpression:function(a,b,c){this.type=fa.AssignmentExpression;this.operator=a;this.left=b;this.right=c;this.finish();return this},finishBinaryExpression:function(a,b,c){this.type="||"===a||"\x26\x26"===a?fa.LogicalExpression:fa.BinaryExpression;this.operator=a;this.left=b;this.right=c;this.finish();
return this},finishBlockStatement:function(a){this.type=fa.BlockStatement;this.body=a;this.finish();return this},finishBreakStatement:function(a){this.type=fa.BreakStatement;this.label=a;this.finish();return this},finishCallExpression:function(a,b){this.type=fa.CallExpression;this.callee=a;this.arguments=b;this.finish();return this},finishConditionalExpression:function(a,b,c){this.type=fa.ConditionalExpression;this.test=a;this.consequent=b;this.alternate=c;this.finish();return this},finishContinueStatement:function(a){this.type=
fa.ContinueStatement;this.label=a;this.finish();return this},finishEmptyStatement:function(){this.type=fa.EmptyStatement;this.finish();return this},finishExpressionStatement:function(a){this.type=fa.ExpressionStatement;this.expression=a;this.finish();return this},finishForStatement:function(a,b,c,f){this.type=fa.ForStatement;this.init=a;this.test=b;this.update=c;this.body=f;this.finish();return this},finishForInStatement:function(a,b,c){this.type=fa.ForInStatement;this.left=a;this.right=b;this.body=
c;this.each=!1;this.finish();return this},finishFunctionDeclaration:function(a,b,c,f){this.type=fa.FunctionDeclaration;this.id=a;this.params=b;this.defaults=c;this.body=f;this.rest=null;this.expression=this.generator=!1;this.finish();return this},finishFunctionExpression:function(a,b,c,f){this.type=fa.FunctionExpression;this.id=a;this.params=b;this.defaults=c;this.body=f;this.rest=null;this.expression=this.generator=!1;this.finish();return this},finishIdentifier:function(a){this.type=fa.Identifier;
this.name=a;this.finish();return this},finishIfStatement:function(a,b,c){this.type=fa.IfStatement;this.test=a;this.consequent=b;this.alternate=c;this.finish();return this},finishLiteral:function(a){this.type=fa.Literal;this.value=a.value;this.raw=S.slice(a.start,a.end);a.regex&&(this.regex=a.regex);this.finish();return this},finishMemberExpression:function(a,b,c){this.type=fa.MemberExpression;this.computed="["===a;this.object=b;this.property=c;this.finish();return this},finishObjectExpression:function(a){this.type=
fa.ObjectExpression;this.properties=a;this.finish();return this},finishPostfixExpression:function(a,b){this.type=fa.UpdateExpression;this.operator=a;this.argument=b;this.prefix=!1;this.finish();return this},finishProgram:function(a){this.type=fa.Program;this.body=a;this.finish();return this},finishProperty:function(a,b,c,f,g){this.type=fa.Property;this.key=b;this.value=c;this.kind=a;this.method=f;this.shorthand=g;this.finish();return this},finishReturnStatement:function(a){this.type=fa.ReturnStatement;
this.argument=a;this.finish();return this},finishUnaryExpression:function(a,b){this.type="++"===a||"--"===a?fa.UpdateExpression:fa.UnaryExpression;this.operator=a;this.argument=b;this.prefix=!0;this.finish();return this},finishVariableDeclaration:function(a,b){this.type=fa.VariableDeclaration;this.declarations=a;this.kind=b;this.finish();return this},finishVariableDeclarator:function(a,b){this.type=fa.VariableDeclarator;this.id=a;this.init=b;this.finish();return this}};r.version="2.0.0-dev";r.tokenize=
function(a,b){var c,f;c=String;"string"===typeof a||a instanceof String||(a=c(a));S=a;I=0;ga=0<S.length?1:0;ja=0;na=S.length;X=null;Z={allowIn:!0,labelSet:{},inFunctionBody:!1,inIteration:!1,inSwitch:!1,lastCommentStart:-1};P={};b=b||{};b.tokens=!0;P.tokens=[];P.tokenize=!0;P.openParenToken=-1;P.openCurlyToken=-1;P.range="boolean"===typeof b.range&&b.range;P.loc="boolean"===typeof b.loc&&b.loc;"boolean"===typeof b.comment&&b.comment&&(P.comments=[]);"boolean"===typeof b.tolerant&&b.tolerant&&(P.errors=
[]);try{y();if(X.type===T.EOF)return P.tokens;for(A();X.type!==T.EOF;)try{A()}catch(Wa){if(P.errors){P.errors.push(Wa);break}else throw Wa;}Ha();f=P.tokens;"undefined"!==typeof P.comments&&(f.comments=P.comments);"undefined"!==typeof P.errors&&(f.errors=P.errors)}catch(Wa){throw Wa;}finally{P={}}return f};r.parse=function(b,c){var f,g;g=String;"string"===typeof b||b instanceof String||(b=g(b));S=b;I=0;ga=0<S.length?1:0;ja=0;na=S.length;X=null;Z={allowIn:!0,labelSet:{},parenthesisCount:0,inFunctionBody:!1,
inIteration:!1,inSwitch:!1,lastCommentStart:-1};P={};"undefined"!==typeof c&&(P.range="boolean"===typeof c.range&&c.range,P.loc="boolean"===typeof c.loc&&c.loc,P.attachComment="boolean"===typeof c.attachComment&&c.attachComment,P.loc&&null!==c.source&&void 0!==c.source&&(P.source=g(c.source)),"boolean"===typeof c.tokens&&c.tokens&&(P.tokens=[]),"boolean"===typeof c.comment&&c.comment&&(P.comments=[]),"boolean"===typeof c.tolerant&&c.tolerant&&(P.errors=[]),P.attachComment&&(P.range=!0,P.comments=
[],P.bottomRightStack=[],P.trailingComments=[],P.leadingComments=[]));try{var e;a();y();e=new D;ha=!1;var h;g=[];for(var d,n,t;I<na;){d=X;if(d.type!==T.StringLiteral)break;h=Ua();g.push(h);if(h.expression.type!==fa.Literal)break;n=S.slice(d.start+1,d.end-1);"use strict"===n?(ha=!0,t&&W(t,aa.StrictOctalLiteral)):!t&&d.octal&&(t=d)}for(;I<na;){h=Ua();if("undefined"===typeof h)break;g.push(h)}f=e.finishProgram(g);"undefined"!==typeof P.comments&&(f.comments=P.comments);"undefined"!==typeof P.tokens&&
(Ha(),f.tokens=P.tokens);"undefined"!==typeof P.errors&&(f.errors=P.errors)}catch(kb){throw kb;}finally{P={}}return f};r.Syntax=function(){var a,b={};"function"===typeof Object.create&&(b=Object.create(null));for(a in fa)fa.hasOwnProperty(a)&&(b[a]=fa[a]);"function"===typeof Object.freeze&&Object.freeze(b);return b}()})},"esri/arcade/arcadeCompiler":function(){define("require exports ../geometry/Polygon ../graphic ../geometry/Polyline ../geometry/Point ../geometry/Extent ../geometry/Multipoint ../SpatialReference ./languageUtils ./treeAnalysis ./Dictionary ./Feature ./functions/date ./functions/string ./functions/maths ./functions/geometry ./functions/stats ./ImmutablePathArray ./ImmutablePointArray ../geometry/Geometry".split(" "),
function(r,l,d,q,k,m,p,h,e,c,b,a,g,u,n,t,f,v,x,w,z){function A(a,b,c){try{return c(a,null,b)}catch(la){throw la;}}function y(a,c){try{switch(c.type){case "EmptyStatement":return"lc.voidOperation";case "VariableDeclarator":return F(a,c);case "VariableDeclaration":for(var f=[],g=0;g<c.declarations.length;g++)f.push(y(a,c.declarations[g]));return f.join("\n")+" \n lastStatement\x3d  lc.voidOperation; \n";case "BlockStatement":return D(a,c);case "FunctionDeclaration":var g=c.id.name.toLowerCase(),e={applicationCache:void 0===
a.applicationCache?null:a.applicationCache,spatialReference:a.spatialReference,console:a.console,symbols:a.symbols,localScope:{_SymbolsMap:{}},depthCounter:a.depthCounter+1,globalScope:a.globalScope};if(64<e.depthCounter)throw Error("Exceeded maximum function depth");for(var h="new lc.SizzleFunction( lang.functionDepthchecker(function() { var lastStatement \x3d lc.voidOperation; var lscope \x3d [];\n ",d=0;d<c.params.length;d++){var n=c.params[d].name.toLowerCase(),t=W(n,a);e.localScope._SymbolsMap[n]=
t;h+="lscope['"+t+"']\x3darguments["+d.toString()+"];\n"}h+=D(e,c.body)+"\n return lastStatement; }, runtimeCtx))";h+="\n lastStatement \x3d lc.voidOperation; \n";void 0!==a.globalScope[g]?f="gscope['"+g+"']\x3d"+h:void 0!==a.globalScope._SymbolsMap[g]?f="gscope['"+a.globalScope._SymbolsMap[g]+"']\x3d"+h:(t=W(g,a),a.globalScope._SymbolsMap[g]=t,f="gscope['"+t+"']\x3d"+h);return f;case "ReturnStatement":var u;u=null===c.argument?"return lc.voidOperation;":"return "+y(a,c.argument)+";";return u;case "IfStatement":if("AssignmentExpression"===
c.test.type||"UpdateExpression"===c.test.type)throw Error(b.nodeErrorMessage(c.test,"RUNTIME","CANNOT_USE_ASSIGNMENT_IN_CONDITION"));var k=y(a,c.test),m=R(a),p="var "+m+" \x3d "+k+";\n if ("+m+" \x3d\x3d\x3d true) {\n"+E(a,c.consequent)+"\n }\n",p=null!==c.alternate?p+("else if ("+m+"\x3d\x3d\x3dfalse)   { \n"+E(a,c.alternate)+"}\n"):p+("else if ("+m+"\x3d\x3d\x3dfalse) { \n lastStatement \x3d lc.voidOperation;\n }\n");return p+="else { lang.error({type: '"+c.type+"'},'RUNTIME','CANNOT_USE_NONBOOLEAN_IN_CONDITION'); \n}\n";
case "ExpressionStatement":var l;l="AssignmentExpression"===c.expression.type?"lastStatement \x3d lc.voidOperation; "+y(a,c.expression)+" \n ":"lastStatement \x3d "+y(a,c.expression)+";";return l;case "AssignmentExpression":return C(a,c);case "UpdateExpression":return B(a,c);case "BreakStatement":return"break;";case "ContinueStatement":return"continue;";case "ForStatement":f="lastStatement \x3d lc.voidOperation; \n";null!==c.init&&(f+=y(a,c.init));var v=R(a),w=R(a),f=f+("var "+v+" \x3d true;")+"\n do { ";
null!==c.update&&(f+=" if ("+v+"\x3d\x3d\x3dfalse) {\n "+y(a,c.update)+"  \n}\n "+v+"\x3dfalse; \n");null!==c.test&&(f+="var "+w+" \x3d "+y(a,c.test)+";",f+="if ("+w+"\x3d\x3d\x3dfalse) { break; } else if ("+w+"!\x3d\x3dtrue) { lang.error({type: '"+c.type+"'},'RUNTIME','CANNOT_USE_NONBOOLEAN_IN_CONDITION');   }\n");f+=y(a,c.body);null!==c.update&&(f+="\n "+y(a,c.update));return f+("\n"+v+" \x3d true; \n} while(true);  lastStatement \x3d lc.voidOperation;");case "ForInStatement":var q=R(a),x=R(a),
z=R(a),A="var "+q+" \x3d "+y(a,c.right)+";\n";"VariableDeclaration"===c.left.type&&(A+=y(a,c.left));var r="VariableDeclaration"===c.left.type?c.left.declarations[0].id.name:c.left.name,r=r.toLowerCase(),f="";null!==a.localScope&&(void 0!==a.localScope[r]?f="lscope['"+r+"']":void 0!==a.localScope._SymbolsMap[r]&&(f="lscope['"+a.localScope._SymbolsMap[r]+"']"));""===f&&(void 0!==a.globalScope[r]?f="gscope['"+r+"']":void 0!==a.globalScope._SymbolsMap[r]&&(f="gscope['"+a.globalScope._SymbolsMap[r]+"']"));
A=A+("if ("+q+"\x3d\x3d\x3dnull) {  lastStatement \x3d lc.voidOperation; }\n ")+("else if (lc.isArray("+q+") || lc.isString("+q+")) {")+("var "+x+"\x3d"+q+".length; \n")+("for(var "+z+"\x3d0; "+z+"\x3c"+x+"; "+z+"++) {\n");A+=f+"\x3d"+z+";\n";A+=y(a,c.body);A+="\n}\n";A+=" lastStatement \x3d lc.voidOperation; \n";A+=" \n}\n";A+="else if (lc.isImmutableArray("+q+")) {";A=A+("var "+x+"\x3d"+q+".length(); \n")+("for(var "+z+"\x3d0; "+z+"\x3c"+x+"; "+z+"++) {\n");A+=f+"\x3d"+z+";\n";A+=y(a,c.body);A+=
"\n}\n";A+=" lastStatement \x3d lc.voidOperation; \n";A+=" \n}\n";A+="else if (( "+q+" instanceof lang.Dictionary) || ( "+q+" instanceof lang.Feature)) {";A=A+("var "+x+"\x3d"+q+".keys(); \n")+("for(var "+z+"\x3d0; "+z+"\x3c"+x+".length; "+z+"++) {\n");A+=f+"\x3d"+x+"["+z+"];\n";A+=y(a,c.body);A+="\n}\n";A+=" lastStatement \x3d lc.voidOperation; \n";A+=" \n}\n";return A+"else { lastStatement \x3d lc.voidOperation; } \n";case "Identifier":return J(a,c);case "MemberExpression":var M;try{f=void 0,f=
!0===c.computed?y(a,c.property):"'"+c.property.name+"'",M="lang.member("+y(a,c.object)+","+f+")"}catch(Ba){throw Ba;}return M;case "Literal":return null===c.value||void 0===c.value?"null":JSON.stringify(c.value);case "ThisExpression":throw Error(b.nodeErrorMessage(c,"RUNTIME","NOTSUPPORTED"));case "CallExpression":try{if("Identifier"!==c.callee.type)throw Error(b.nodeErrorMessage(c,"RUNTIME","ONLYNODESSUPPORTED"));var G=c.callee.name.toLowerCase(),f="";null!==a.localScope&&(void 0!==a.localScope[G]?
f="lscope['"+G+"']":void 0!==a.localScope._SymbolsMap[G]&&(f="lscope['"+a.localScope._SymbolsMap[G]+"']"));""===f&&(void 0!==a.globalScope[G]?f="gscope['"+G+"']":void 0!==a.globalScope._SymbolsMap[G]&&(f="gscope['"+a.globalScope._SymbolsMap[G]+"']"));if(""!==f)for(g="[",e=0;e<c.arguments.length;e++)0<e&&(g+=", "),g+=y(a,c.arguments[e]);else throw Error(b.nodeErrorMessage(c,"RUNTIME","NOTFOUND"));}catch(Ba){throw Ba;}return"lang.callfunc("+f+","+(g+"]")+",runtimeCtx)";case "UnaryExpression":var N;
try{N="lang.unary("+y(a,c.argument)+",'"+c.operator+"')"}catch(Ba){throw Ba;}return N;case "BinaryExpression":var L;try{L="lang.binary("+y(a,c.left)+","+y(a,c.right)+",'"+c.operator+"')"}catch(Ba){throw Ba;}return L;case "LogicalExpression":var H;try{if("AssignmentExpression"===c.left.type||"UpdateExpression"===c.left.type)throw Error(b.nodeErrorMessage(c.left,"RUNTIME","CANNOT_USE_ASSIGNMENT_IN_CONDITION"));if("AssignmentExpression"===c.right.type||"UpdateExpression"===c.right.type)throw Error(b.nodeErrorMessage(c.right,
"RUNTIME","CANNOT_USE_ASSIGNMENT_IN_CONDITION"));if("\x26\x26"===c.operator||"||"===c.operator)H="(lang.logicalCheck("+y(a,c.left)+") "+c.operator+" lang.logicalCheck("+y(a,c.right)+"))";else throw Error(b.nodeErrorMessage("LogicalExpression","RUNTIME","ONLYORORAND"));}catch(Ba){throw Ba;}return H;case "ConditionalExpression":throw Error(b.nodeErrorMessage(c,"RUNTIME","NOTSUPPORTED"));case "ArrayExpression":try{f=[];for(g=0;g<c.elements.length;g++)"Literal"===c.elements[g].type?f.push(y(a,c.elements[g])):
f.push("lang.aCheck("+y(a,c.elements[g])+",'ArrayExpression')");h="["+f.join(",")+"]"}catch(Ba){throw Ba;}return h;case "ObjectExpression":f="lang.dictionary([";for(g=0;g<c.properties.length;g++){var d=c.properties[g],K="Identifier"===d.key.type?"'"+d.key.name+"'":y(a,d.key),ca=y(a,d.value);0<g&&(f+=",");f+="lang.strCheck("+K+",'ObjectExpression'),lang.aCheck("+ca+", 'ObjectExpression')"}return f+"])";case "Property":throw Error("Should not get here");case "Array":throw Error(b.nodeErrorMessage(c,
"RUNTIME","NOTSUPPORTED"));default:throw Error(b.nodeErrorMessage(c,"RUNTIME","UNREOGNISED"));}}catch(Ba){throw Ba;}}function B(a,b){var c=null,f="";if("MemberExpression"===b.argument.type)return c=y(a,b.argument.object),f=!0===b.argument.computed?y(a,b.argument.property):"'"+b.argument.property.name+"'","lang.memberupdate("+c+","+f+",'"+b.operator+"',"+b.prefix+")";c=b.argument.name.toLowerCase();if(null!==a.localScope){if(void 0!==a.localScope[c])return"lang.update(lscope, '"+c+"','"+b.operator+
"',"+b.prefix+")";if(void 0!==a.localScope._SymbolsMap[c])return"lang.update(lscope, '"+a.localScope._SymbolsMap[c]+"','"+b.operator+"',"+b.prefix+")"}if(void 0!==a.globalScope[c])return"lang.update(gscope, '"+c+"','"+b.operator+"',"+b.prefix+")";if(void 0!==a.globalScope._SymbolsMap[c])return"lang.update(gscope, '"+a.globalScope._SymbolsMap[c]+"','"+b.operator+"',"+b.prefix+")";throw Error("Variable not recognised");}function C(a,b){var c=y(a,b.right),f=null,g="";if("MemberExpression"===b.left.type)return f=
y(a,b.left.object),g=!0===b.left.computed?y(a,b.left.property):"'"+b.left.property.name+"'","lang.assignmember("+f+","+g+",'"+b.operator+"',"+c+");";f=b.left.name.toLowerCase();if(null!==a.localScope){if(void 0!==a.localScope[f])return"lscope['"+f+"']\x3dlang.assign("+c+",'"+b.operator+"', lscope['"+f+"']); ";if(void 0!==a.localScope._SymbolsMap[f])return"lscope['"+a.localScope._SymbolsMap[f]+"']\x3dlang.assign("+c+",'"+b.operator+"', lscope['"+a.localScope._SymbolsMap[f]+"']); "}if(void 0!==a.globalScope[f])return"gscope['"+
f+"']\x3dlang.assign("+c+",'"+b.operator+"', gscope['"+f+"']); ";if(void 0!==a.globalScope._SymbolsMap[f])return"gscope['"+a.globalScope._SymbolsMap[f]+"']\x3dlang.assign("+c+",'"+b.operator+"', gscope['"+a.globalScope._SymbolsMap[f]+"']); ";throw Error("Variable not recognised");}function E(a,b){return"BlockStatement"===b.type?y(a,b):"ReturnStatement"===b.type?y(a,b):"BreakStatement"===b.type?y(a,b):"ContinueStatement"===b.type?y(a,b):"UpdateExpression"===b.type?"lastStatement \x3d "+y(a,b)+";":
"ExpressionStatement"===b.type?y(a,b):"ObjectExpression"===b.type?"lastStatement \x3d "+y(a,b)+";":y(a,b)}function D(a,b){for(var c="",f=0;f<b.body.length;f++)c="ReturnStatement"===b.body[f].type?c+(y(a,b.body[f])+" \n"):"BreakStatement"===b.body[f].type?c+(y(a,b.body[f])+" \n"):"ContinueStatement"===b.body[f].type?c+(y(a,b.body[f])+" \n"):"UpdateExpression"===b.body[f].type?c+("lastStatement \x3d "+y(a,b.body[f])+"; \n"):"ObjectExpression"===b.body[f].type?c+("lastStatement \x3d "+y(a,b.body[f])+
"; \n"):c+(y(a,b.body[f])+" \n");return c}function F(a,b){var f=null===b.init?null:y(a,b.init);f===c.voidOperation&&(f=null);var g=b.id.name.toLowerCase();if(null!==a.localScope){if(void 0!==a.localScope[g])return"lscope['"+g+"']\x3d"+f+";";if(void 0!==a.localScope._SymbolsMap[g])return"lscope['"+a.localScope._SymbolsMap[g]+"']\x3d"+f+";";var e=W(g,a);a.localScope._SymbolsMap[g]=e;return"lscope['"+e+"']\x3d"+f+";"}if(void 0!==a.globalScope[g])return"gscope['"+g+"']\x3d"+f+";";if(void 0!==a.globalScope._SymbolsMap[g])return"gscope['"+
a.globalScope._SymbolsMap[g]+"']\x3d"+f+";";e=W(g,a);a.globalScope._SymbolsMap[g]=e;return"gscope['"+e+"']\x3d"+f+";"}function G(f,g,e){g=g.toLowerCase();switch(g){case "hasz":return f=f.hasZ,void 0===f?!1:f;case "hasm":return f=f.hasM,void 0===f?!1:f;case "spatialreference":return g=f.spatialReference._arcadeCacheId,void 0===g&&(e=!0,Object.freeze&&Object.isFrozen(f.spatialReference)&&(e=!1),e&&(Q++,g=f.spatialReference._arcadeCacheId=Q)),f=new a({wkt:f.spatialReference.wkt,wkid:f.spatialReference.wkid}),
void 0!==g&&(f._arcadeCacheId="SPREF"+g.toString()),f}switch(f.type){case "extent":switch(g){case "xmin":case "xmax":case "ymin":case "ymax":case "zmin":case "zmax":case "mmin":case "mmax":return f=f[g],void 0!==f?f:null;case "type":return"Extent"}break;case "polygon":switch(g){case "rings":return g=c.isVersion4?f.cache._arcadeCacheId:f.getCacheValue("_arcadeCacheId"),void 0===g&&(Q++,g=Q,c.isVersion4?f.cache._arcadeCacheId=g:f.setCacheValue("_arcadeCacheId",g)),f=new x(f.rings,f.spatialReference,
!0===f.hasZ,!0===f.hasM,g);case "type":return"Polygon"}break;case "point":switch(g){case "x":case "y":case "z":case "m":return void 0!==f[g]?f[g]:null;case "type":return"Point"}break;case "polyline":switch(g){case "paths":return g=c.isVersion4?f.cache._arcadeCacheId:f.getCacheValue("_arcadeCacheId"),void 0===g&&(Q++,g=Q,c.isVersion4?f.cache._arcadeCacheId=g:f.setCacheValue("_arcadeCacheId",g)),f=new x(f.paths,f.spatialReference,!0===f.hasZ,!0===f.hasM,g);case "type":return"Polyline"}break;case "multipoint":switch(g){case "points":return g=
c.isVersion4?f.cache._arcadeCacheId:f.getCacheValue("_arcadeCacheId"),void 0===g&&(Q++,g=Q,c.isVersion4?f.cache._arcadeCacheId=g:f.setCacheValue("_arcadeCacheId",g)),f=new w(f.points,f.spatialReference,!0===f.hasZ,!0===f.hasM,g,1);case "type":return"Multipoint"}}throw Error(b.nodeErrorMessage(e,"RUNTIME","PROPERTYNOTFOUND"));}function J(a,c){try{var f=c.name.toLowerCase();if(null!==a.localScope){if(void 0!==a.localScope[f])return"lscope['"+f+"']";if(void 0!==a.localScope._SymbolsMap[f])return"lscope['"+
a.localScope._SymbolsMap[f]+"']"}if(void 0!==a.globalScope[f])return"gscope['"+f+"']";if(void 0!==a.globalScope._SymbolsMap[f])return"gscope['"+a.globalScope._SymbolsMap[f]+"']";throw Error(b.nodeErrorMessage(c,"RUNTIME","VARIABLENOTFOUND"));}catch(la){throw la;}}function N(b){return null===b?"":c.isArray(b)||c.isImmutableArray(b)?"Array":c.isDate(b)?"Date":c.isString(b)?"String":c.isBoolean(b)?"Boolean":c.isNumber(b)?"Number":b instanceof a?"Dictionary":b instanceof g?"Feature":b instanceof m?"Point":
b instanceof d?"Polygon":b instanceof k?"Polyline":b instanceof h?"Multipoint":b instanceof p?"Extent":c.isFunctionParameter(b)?"Function":b===c.voidOperation?"":"number"===typeof b&&isNaN(b)?"Number":"Unrecognised Type"}function M(a,b,f,g){try{if(c.equalityTest(b[f],g))return b[f+1];var e=b.length-f;return 1===e?b[f]:2===e?null:3===e?b[f+2]:M(a,b,f+2,g)}catch(sa){throw sa;}}function L(a,b,f,g){try{if(!0===g)return b[f+1];if(3===b.length-f)return b[f+2];var e=b[f+2];if(!1===c.isBoolean(e))throw Error("WHEN needs boolean test conditions");
return L(a,b,f+2,e)}catch(sa){throw sa;}}function K(a,b){var c=a.length,f=Math.floor(c/2);if(0===c)return[];if(1===c)return[a[0]];for(var g=K(a.slice(0,f),b),c=K(a.slice(f,c),b),f=[];0<g.length||0<c.length;)if(0<g.length&&0<c.length){var e=b(g[0],c[0]);isNaN(e)&&(e=0);0>=e?(f.push(g[0]),g=g.slice(1)):(f.push(c[0]),c=c.slice(1))}else 0<g.length?(f.push(g[0]),g=g.slice(1)):0<c.length&&(f.push(c[0]),c=c.slice(1));return f}function W(a,b){b.symbols.symbolCounter++;return"_T"+b.symbols.symbolCounter.toString()}
function R(a){a.symbols.symbolCounter++;return"_Tvar"+a.symbols.symbolCounter.toString()}function ba(a,b,c){var f={};a||(a={});c||(c={});f._SymbolsMap={};f.textformatting=1;f.infinity=1;f.pi=1;for(var g in b)f[g]=1;for(g in c)f[g]=1;for(g in a)f[g]=1;return f}function O(a){console.log(a)}Object.defineProperty(l,"__esModule",{value:!0});var Q=0,U={};u.registerFunctions(U,A);n.registerFunctions(U,A);t.registerFunctions(U,A);f.registerFunctions(U,A);v.registerFunctions(U,A);U["typeof"]=function(a,b){return A(a,
b,function(a,b,f){c.pcCheck(f,1,1);a=N(f[0]);if("Unrecognised Type"===a)throw Error("Unrecognised Type");return a})};U.iif=function(a,b){try{return A(a,b,function(a,b,f){c.pcCheck(f,3,3);if(!1===c.isBoolean(f[0]))throw Error("IF Function must have a boolean test condition");return f[0]?f[1]:f[2]})}catch(va){throw va;}};U.decode=function(a,b){try{return A(a,b,function(b,c,f){if(2>f.length)throw Error("Missing Parameters");if(2===f.length)return f[1];if(0===(f.length-1)%2)throw Error("Must have a default value result.");
return M(a,f,1,f[0])})}catch(va){throw va;}};U.when=function(a,b){try{return A(a,b,function(b,f,g){if(3>g.length)throw Error("Missing Parameters");if(0===g.length%2)throw Error("Must have a default value result.");b=g[0];if(!1===c.isBoolean(b))throw Error("WHEN needs boolean test conditions");return L(a,g,0,b)})}catch(va){throw va;}};U.top=function(a,b){return A(a,b,function(a,b,f){c.pcCheck(f,2,2);if(c.isArray(f[0]))return c.toNumber(f[1])>=f[0].length?f[0].slice(0):f[0].slice(0,c.toNumber(f[1]));
if(c.isImmutableArray(f[0]))return c.toNumber(f[1])>=f[0].length()?f[0].slice(0):f[0].slice(0,c.toNumber(f[1]));throw Error("Top cannot accept this parameter type");})};U.first=function(a,b){return A(a,b,function(a,b,f){c.pcCheck(f,1,1);return c.isArray(f[0])?0===f[0].length?null:f[0][0]:c.isImmutableArray(f[0])?0===f[0].length()?null:f[0].get(0):null})};U.sort=function(a,b){return A(a,b,function(a,b,f){c.pcCheck(f,1,2);b=f[0];c.isImmutableArray(b)&&(b=b.toArray());if(!1===c.isArray(b))throw Error("Illegal Argument");
if(1<f.length){if(!1===c.isFunctionParameter(f[1]))throw Error("Illegal Argument");b=K(b,function(b,c){return ca.callfunc(f[1],[b,c],a)})}else{if(0===b.length)return[];for(var g={},e=0;e<b.length;e++){var h=N(b[e]);""!==h&&(g[h]=!0)}if(!0===g.Array||!0===g.Dictionary||!0===g.Feature||!0===g.Point||!0===g.Polygon||!0===g.Polyline||!0===g.Multipoint||!0===g.Extent||!0===g.Function)return b.slice(0);var e=0,h="",d;for(d in g)e++,h=d;b=1<e||"String"===h?K(b,function(a,b){if(null===a||void 0===a||a===
c.voidOperation)return null===b||void 0===b||b===c.voidOperation?0:1;if(null===b||void 0===b||b===c.voidOperation)return-1;var f=c.toString(a),g=c.toString(b);return f<g?-1:f===g?0:1}):"Number"===h?K(b,function(a,b){return a-b}):"Boolean"===h?K(b,function(a,b){return a===b?0:b?-1:1}):"Date"===h?K(b,function(a,b){return b-a}):b.slice(0)}return b})};for(var ia in U)U[ia]=new c.NativeFunction(U[ia]);var Y=function(){};Y.prototype=U;l.functionHelper={fixSpatialReference:c.fixSpatialReference,parseArguments:function(a,
b){for(var c=[],f=0;f<b.arguments.length;f++)c.push(y(a,b.arguments[f]));return c},standardFunction:A};l.executeScript=function(a,b,c){return a(b,c)};l.extractFieldLiterals=function(a,c){void 0===c&&(c=!1);return b.findFieldLiterals(a,c)};l.validateScript=function(a,c){return b.validateScript(a,c,"simple")};l.referencesMember=function(a,c){return b.referencesMember(a,c)};l.referencesFunction=function(a,c){return b.referencesFunction(a,c)};var ca={error:function(a,c,f){throw Error(b.nodeErrorMessage(a,
c,f));},functionDepthchecker:function(a,b){return function(){b.depthCounte++;if(64<b.depthCounter)throw Error("Exceeded maximum function depth");var c=a.apply(this,arguments);b.depthCounte--;return c}},aCheck:function(a,f){if(c.isFunctionParameter(a))throw Error(b.nodeErrorMessage({type:f},"RUNTIME","FUNCTIONCONTEXTILLEGAL"));return a===c.voidOperation?null:a},Dictionary:a,Feature:g,dictionary:function(b){for(var f={},g=0;g<b.length;g+=2){if(c.isFunctionParameter(b[g+1]))throw Error("Illegal Argument");
if(!1===c.isString(b[g]))throw Error("Illegal Argument");f[b[g].toString()]=b[g+1]===c.voidOperation?null:b[g+1]}b=new a(f);b.immutable=!1;return b},strCheck:function(a,b){if(!1===c.isString(a))throw Error("Illegal Argument");return a},unary:function(a,f){if(c.isBoolean(a)){if("!"===f)return!a;if("-"===f)return-1*c.toNumber(a);if("+"===f)return 1*c.toNumber(a);throw Error(b.nodeErrorMessage({type:"UnaryExpression"},"RUNTIME","NOTSUPPORTEDUNARYOPERATOR"));}if("-"===f)return-1*c.toNumber(a);if("+"===
f)return 1*c.toNumber(a);throw Error(b.nodeErrorMessage({type:"UnaryExpression"},"RUNTIME","NOTSUPPORTEDUNARYOPERATOR"));},logicalCheck:function(a){if(!1===c.isBoolean(a))throw Error(b.nodeErrorMessage("LogicalExpression","RUNTIME","ONLYORORAND"));return a},logical:function(a,f,g){if(c.isBoolean(a)&&c.isBoolean(f))switch(g){case "||":return a||f;case "\x26\x26":return a&&f;default:throw Error(b.nodeErrorMessage("LogicalExpression","RUNTIME","ONLYORORAND"));}else throw Error(b.nodeErrorMessage("LogicalExpression",
"RUNTIME","ONLYORORAND"));},binary:function(a,f,g){switch(g){case "\x3d\x3d":return c.equalityTest(a,f);case "\x3d":return c.equalityTest(a,f);case "!\x3d":return!c.equalityTest(a,f);case "\x3c":return c.greaterThanLessThan(a,f,g);case "\x3e":return c.greaterThanLessThan(a,f,g);case "\x3c\x3d":return c.greaterThanLessThan(a,f,g);case "\x3e\x3d":return c.greaterThanLessThan(a,f,g);case "+":return c.isString(a)||c.isString(f)?c.toString(a)+c.toString(f):c.toNumber(a)+c.toNumber(f);case "-":return c.toNumber(a)-
c.toNumber(f);case "*":return c.toNumber(a)*c.toNumber(f);case "/":return c.toNumber(a)/c.toNumber(f);case "%":return c.toNumber(a)%c.toNumber(f);default:throw Error(b.nodeErrorMessage({type:"BinaryExpression"},"RUNTIME","OPERATORNOTRECOGNISED"));}},assign:function(a,f,g){switch(f){case "\x3d":return a===c.voidOperation?null:a;case "/\x3d":return c.toNumber(g)/c.toNumber(a);case "*\x3d":return c.toNumber(g)*c.toNumber(a);case "-\x3d":return c.toNumber(g)-c.toNumber(a);case "+\x3d":return c.isString(g)||
c.isString(a)?c.toString(g)+c.toString(a):c.toNumber(g)+c.toNumber(a);case "%\x3d":return c.toNumber(g)%c.toNumber(a);default:throw Error(b.nodeErrorMessage("AssignmentExpression","RUNTIME","OPERATORNOTRECOGNISED"));}},update:function(a,b,f,g){var e=c.toNumber(a[b]);a[b]="++"===f?e+1:e-1;return!1===g?e:"++"===f?e+1:e-1},memberupdate:function(b,f,e,h){var d;if(c.isArray(b))if(c.isNumber(f)){0>f&&(f=b.length+f);if(0>f||f>=b.length)throw Error("Assignment outside of array bounds");d=c.toNumber(b[f]);
b[f]="++"===e?d+1:d-1}else throw Error("Invalid Parameter");else if(b instanceof a){if(!1===c.isString(f))throw Error("Dictionary accessor must be a string");if(!0===b.hasField(f))d=c.toNumber(b.field(f)),b.setField(f,"++"===e?d+1:d-1);else throw Error("Invalid Parameter");}else if(b instanceof g){if(!1===c.isString(f))throw Error("Feature accessor must be a string");if(!0===b.hasField(f))d=c.toNumber(b.field(f)),b.setField(f,"++"===e?d+1:d-1);else throw Error("Invalid Parameter");}else{if(c.isImmutableArray(b))throw Error("Array is Immutable");
throw Error("Invalid Parameter");}return!1===h?d:"++"===e?d+1:d-1},assignmember:function(b,f,e,h){if(c.isArray(b))if(c.isNumber(f)){0>f&&(f=b.length+f);if(0>f||f>b.length)throw Error("Assignment outside of array bounds");if(f===b.length&&"\x3d"!==e)throw Error("Invalid Parameter");b[f]=this.assign(h,e,b[f])}else throw Error("Invalid Parameter");else if(b instanceof a){if(!1===c.isString(f))throw Error("Dictionary accessor must be a string");if(!0===b.hasField(f))b.setField(f,this.assign(h,e,b.field(f)));
else{if("\x3d"!==e)throw Error("Invalid Parameter");b.setField(f,this.assign(h,e,null))}}else if(b instanceof g){if(!1===c.isString(f))throw Error("Feature accessor must be a string");if(!0===b.hasField(f))b.setField(f,this.assign(h,e,b.field(f)));else{if("\x3d"!==e)throw Error("Invalid Parameter");b.setField(f,this.assign(h,e,null))}}else{if(c.isImmutableArray(b))throw Error("Array is Immutable");throw Error("Invalid Parameter");}},member:function(f,e){if(null===f)throw Error(b.nodeErrorMessage("MemberExpression",
"RUNTIME","NOTFOUND"));if(f instanceof a||f instanceof g){if(c.isString(e))return f.field(e)}else if(f instanceof z){if(c.isString(e))return G(f,e,"MemberExpression")}else if(c.isArray(f)){if(c.isNumber(e)&&isFinite(e)&&Math.floor(e)===e){0>e&&(e=f.length+e);if(e>=f.length||0>e)throw Error(b.nodeErrorMessage("MemberExpression","RUNTIME","OUTOFBOUNDS"));return f[e]}}else if(c.isString(f)){if(c.isNumber(e)&&isFinite(e)&&Math.floor(e)===e){0>e&&(e=f.length+e);if(e>=f.length||0>e)throw Error(b.nodeErrorMessage("MemberExpression",
"RUNTIME","OUTOFBOUNDS"));return f[e]}}else if(c.isImmutableArray(f)&&c.isNumber(e)&&isFinite(e)&&Math.floor(e)===e){0>e&&(e=f.length()+e);if(e>=f.length()||0>e)throw Error(b.nodeErrorMessage("MemberExpression","RUNTIME","OUTOFBOUNDS"));return f.get(e)}throw Error(b.nodeErrorMessage("MemberExpression","RUNTIME","INVALIDTYPE"));},callfunc:function(a,b,f){return a instanceof c.NativeFunction?a.fn(f,b):a instanceof c.SizzleFunction?a.fn.apply(this,b):a.apply(this,b)}};l.compileScript=function(b,f){void 0===
f&&(f=null);null===f&&(f={vars:{},customfunctions:{}});var h={globalScope:ba(f.vars,U,f.customfunctions),localScope:null,console:O,symbols:{symbolCounter:0}},h=y(h,b.body[0].body);""===h&&(h="lc.voidOperation;");var d={lc:c,lang:ca,postProcess:function(a){a instanceof c.ReturnResult&&(a=a.value);a instanceof c.ImplicitResult&&(a=a.value);a===c.voidOperation&&(a=null);if(a===c.breakResult)throw Error("Cannot return BREAK");if(a===c.continueResult)throw Error("Cannot return CONTINUE");if(c.isFunctionParameter(a))throw Error("Cannot return FUNCTION");
return a},prepare:function(b,c){c||(c=new e(102100));var f=b.vars,h=b.customfunctions,d=new Y;f||(f={});h||(h={});var n=new a({newline:"\n",tab:"\t",singlequote:"'",doublequote:'"',forwardslash:"/",backwardslash:"\\"});n.immutable=!1;d._SymbolsMap={textformatting:1,infinity:1,pi:1};d.textformatting=n;d.infinity=Number.POSITIVE_INFINITY;d.pi=Math.PI;for(var t in h)d[t]=h[t],d._SymbolsMap[t]=1;for(t in f)d._SymbolsMap[t]=1,d[t]=f[t]instanceof q?new g(f[t]):f[t];return{spatialReference:c,globalScope:d,
localScope:null,console:b.console?b.console:O,symbols:{symbolCounter:0},depthCounter:1,applicationCache:void 0===b.applicationCache?null:b.applicationCache}}};return(new Function("context","spatialReference","var runtimeCtx\x3dthis.prepare(context, spatialReference);\n var lc \x3d this.lc;  var lang \x3d this.lang; var gscope\x3druntimeCtx.globalScope; \n function mainBody() {\n var lastStatement\x3dlc.voidOperation;\n "+h+"\n return lastStatement; } \n return this.postProcess(mainBody());")).bind(d)}})},
"esri/renderers/UniqueValueRenderer":function(){define("dojo/_base/declare dojo/_base/array dojo/_base/lang dojo/has ../kernel ../lang ../symbols/jsonUtils ./Renderer ./arcadeUtils".split(" "),function(r,l,d,q,k,m,p,h,e){return r(h,{declaredClass:"esri.renderer.UniqueValueRenderer",constructor:function(c,b,a,g,e){this.values=[];this._symbols={};this.infos=[];c&&!c.declaredClass?(b=c,this.defaultSymbol=(c=b.defaultSymbol)&&(c.declaredClass?c:p.fromJson(c)),this.attributeField=b.field1,this.attributeField2=
b.field2,this.attributeField3=b.field3,this.fieldDelimiter=b.fieldDelimiter,this.defaultLabel=b.defaultLabel,this.setValueExpression(b.valueExpression),this.valueExpressionTitle=b.valueExpressionTitle,this.legendOptions=b.legendOptions,b.backgroundFillSymbol&&(this.backgroundFillSymbol=p.fromJson(b.backgroundFillSymbol)),l.forEach(b.uniqueValueInfos,this._addValueInfo,this)):(this.defaultSymbol=c,this.attributeField=b,this.attributeField2=a,this.attributeField3=g,this.fieldDelimiter=e);this._multiple=
!!this.attributeField2},addValue:function(c,b){var a=d.isObject(c)?c:{value:c,symbol:b};this._addValueInfo(a)},removeValue:function(c){var b=l.indexOf(this.values,c);-1!==b&&(this.values.splice(b,1),delete this._symbols[c],this.infos.splice(b,1))},getUniqueValueInfo:function(c){var b=this.attributeField,a=c.attributes,g,h;this._compiledFunc?b=e.executeFunction(this._compiledFunc,e.createExecContext(c,c._getViewInfo())):this._multiple?(c=this.attributeField2,g=this.attributeField3,h=[],b&&h.push(a[b]),
c&&h.push(a[c]),g&&h.push(a[g]),b=h.join(this.fieldDelimiter||"")):b=d.isFunction(b)?b(c):a[b];return this._symbols[b]},setValueExpression:function(c){this.valueExpression=c;this._compiledFunc=e.createFunction(c)},getFieldsUsedInExpressions:function(){var c=this.inherited(arguments);this.valueExpression&&(c=c.concat(e.extractFieldNames(this.valueExpression)));c.sort();return l.filter(c,function(b,a){return 0===a||c[a-1]!==b})},getSymbol:function(c){return(c=this.getUniqueValueInfo(c))&&c.symbol||
this.defaultSymbol},_addValueInfo:function(c){var b=c.value;this.values.push(b);this.infos.push(c);var a=c.symbol;a&&!a.declaredClass&&(c.symbol=p.fromJson(a));this._symbols[b]=c},toJson:function(){var c=m.fixJson,b;b={type:"uniqueValue",field1:this.attributeField,field2:this.attributeField2,field3:this.attributeField3,fieldDelimiter:this.fieldDelimiter,valueExpression:this.valueExpression,valueExpressionTitle:this.valueExpressionTitle,legendOptions:d.clone(this.legendOptions),defaultSymbol:this.defaultSymbol&&
this.defaultSymbol.toJson(),defaultLabel:this.defaultLabel,uniqueValueInfos:l.map(this.infos||[],function(a){a=d.mixin({},a);a.symbol=a.symbol&&a.symbol.toJson();a.value+="";return c(a)})};this.backgroundFillSymbol&&(b.backgroundFillSymbol=this.backgroundFillSymbol.toJson());b=d.mixin(this.inherited(arguments),b);return c(b)}})})},"esri/renderers/ClassBreaksRenderer":function(){define("dojo/_base/declare dojo/_base/array dojo/_base/lang dojo/has ../kernel ../lang ../symbols/jsonUtils ./Renderer ./arcadeUtils".split(" "),
function(r,l,d,q,k,m,p,h,e){return r(h,{declaredClass:"esri.renderer.ClassBreaksRenderer",constructor:function(c,b){this.breaks=[];this._symbols={};this.infos=[];this.isMaxInclusive=!0;if(c&&!c.declaredClass){var a=c;this.attributeField=a.field;this.setValueExpression(a.valueExpression);this.valueExpressionTitle=a.valueExpressionTitle;this.legendOptions=a.legendOptions;this.defaultSymbol=(c=a.defaultSymbol)&&(c.declaredClass?c:p.fromJson(c));this.backgroundFillSymbol=(c=a.backgroundFillSymbol)&&(c.declaredClass?
c:p.fromJson(c));this._copy(["defaultLabel","classificationMethod:rest","normalizationType:rest","normalizationField","normalizationTotal"],a,this);var g=a.minValue;(a=a.classBreakInfos)&&a[0]&&m.isDefined(a[0].classMaxValue)&&l.forEach(a,function(a){var b=a.classMaxValue;a.minValue=g;g=a.maxValue=b},this);l.forEach(a,this._addBreakInfo,this)}else this.defaultSymbol=c,this.attributeField=b},addBreak:function(c,b,a){c=d.isObject(c)?c:{minValue:c,maxValue:b,symbol:a};this._addBreakInfo(c)},removeBreak:function(c,
b){var a,g=this.breaks,e,h=g.length,d=this._symbols;for(e=0;e<h;e++)if(a=g[e],a[0]==c&&a[1]==b){g.splice(e,1);delete d[c+"-"+b];this.infos.splice(e,1);break}},clearBreaks:function(){this.breaks=[];this._symbols={};this.infos=[]},getBreakIndex:function(c){var b=this.attributeField,a=c.attributes,g=this.breaks,h=g.length,n=this.isMaxInclusive;if(this._compiledFunc)c=e.executeFunction(this._compiledFunc,e.createExecContext(c,c._getViewInfo()));else if(d.isFunction(b))c=b(c);else{c=parseFloat(a[b]);var b=
this.normalizationType,t;if(b)if(t=parseFloat(this.normalizationTotal),a=parseFloat(a[this.normalizationField]),"log"===b)c=Math.log(c)*Math.LOG10E;else if("percent-of-total"===b&&!isNaN(t))c=c/t*100;else if("field"===b){if(isNaN(c)||isNaN(a))return-1;c/=a}}if(null!=c&&!isNaN(c)&&"number"===typeof c)for(a=0;a<h;a++)if(b=g[a],b[0]<=c&&(n?c<=b[1]:c<b[1]))return a;return-1},getBreakInfo:function(c){c=this.getBreakIndex(c);return-1!==c?this.infos[c]:null},getSymbol:function(c){return(c=this.breaks[this.getBreakIndex(c)])?
this._symbols[c[0]+"-"+c[1]]:this.defaultSymbol},setMaxInclusive:function(c){this.isMaxInclusive=c},setValueExpression:function(c){this.valueExpression=c;this._compiledFunc=e.createFunction(c)},getFieldsUsedInExpressions:function(){var c=this.inherited(arguments);this.valueExpression&&(c=c.concat(e.extractFieldNames(this.valueExpression)));c.sort();return l.filter(c,function(b,a){return 0===a||c[a-1]!==b})},isContinuousRenderer:function(){var c=!1;if(this.infos&&1===this.infos.length)var b=this.attributeField,
a=this.normalizationField,g=this.valueExpression,c=this.getVisualVariablesForType("colorInfo",!1)||[],e=this.getVisualVariablesForType("sizeInfo",!1)||[],h=this.getVisualVariablesForType("opacityInfo",!1)||[],c=c.concat(e).concat(h),c=l.some(c,function(c){return(c.field===b||c.valueExpression===g)&&c.normalizationField==a});return c},_normalizationTypeEnums:[["field","esriNormalizeByField"],["log","esriNormalizeByLog"],["percent-of-total","esriNormalizeByPercentOfTotal"]],_classificationMethodEnums:[["natural-breaks",
"esriClassifyNaturalBreaks"],["equal-interval","esriClassifyEqualInterval"],["quantile","esriClassifyQuantile"],["standard-deviation","esriClassifyStandardDeviation"],["geometrical-interval","esriClassifyGeometricalInterval"],["defined-interval","esriClassifyDefinedInterval"]],_copy:function(c,b,a){l.forEach(c,function(c){var g=c.split(":"),e,h,f;1<g.length&&(c=g[0],e=this["_"+c+"Enums"],"rest"===g[1]?(h="1",f="0"):"sdk"===g[1]&&(h="0",f="1"));g=b[c];if(void 0!==g&&(a[c]=g,e&&h)){var d,k=e.length;
for(d=0;d<k;d++)if(e[d][h]===g){a[c]=e[d][f];break}}},this)},_addBreakInfo:function(c){var b=c.minValue,a=c.maxValue;this.breaks.push([b,a]);this.infos.push(c);var g=c.symbol;g&&!g.declaredClass&&(c.symbol=p.fromJson(g));this._symbols[b+"-"+a]=c.symbol},toJson:function(){var c=this.infos||[],b=m.fixJson,a=c[0]&&c[0].minValue,g=this.backgroundFillSymbol,c=d.mixin(this.inherited(arguments),{type:"classBreaks",field:this.attributeField,valueExpression:this.valueExpression,valueExpressionTitle:this.valueExpressionTitle,
legendOptions:d.clone(this.legendOptions),defaultSymbol:this.defaultSymbol&&this.defaultSymbol.toJson(),backgroundFillSymbol:g&&g.toJson(),minValue:-Infinity===a?-Number.MAX_VALUE:a,classBreakInfos:l.map(c,function(a){a=d.mixin({},a);a.symbol=a.symbol&&a.symbol.toJson();a.classMaxValue=Infinity===a.maxValue?Number.MAX_VALUE:a.maxValue;delete a.minValue;delete a.maxValue;return b(a)})});this._copy(["defaultLabel","classificationMethod:sdk","normalizationType:sdk","normalizationField","normalizationTotal"],
this,c);c.hasOwnProperty("normalizationType")&&!c.normalizationType&&delete c.normalizationType;c.hasOwnProperty("classificationMethod")&&!c.classificationMethod&&delete c.classificationMethod;return b(c)}})})},"esri/renderers/VectorFieldRenderer":function(){define("dojo/_base/declare dojo/_base/lang dojo/has dojo/_base/array ../kernel ../lang ../Color ./Renderer ./ClassBreaksRenderer ../symbols/SimpleMarkerSymbol ../symbols/PictureMarkerSymbol ../symbols/SimpleLineSymbol ../symbols/jsonUtils require".split(" "),
function(r,l,d,q,k,m,p,h,e,c,b,a,g,u){var n=r(h,{declaredClass:"esri.renderer.VectorFieldRenderer",iconFolderPath:"../images/symbol/sfs/",constructor:function(a){m.isDefined(a)||(a={});a.attributeField=a.attributeField||"Magnitude";a.rotationInfo=a.rotationInfo||this._getRotationInfo(a);r.safeMixin(this,a);this.style=this.style||n.STYLE_SINGLE_ARROW;this.singleArrowSymbol&&(this.singleArrowSymbol=this.singleArrowSymbol.declaredClass?this.singleArrowSymbol:g.fromJson(this.singleArrowSymbol));this.renderer=
new e(this._getDefaultSymbol(),a.attributeField);this._updateRenderer(this.style);this.flowRepresentation=this.flowRepresentation||this.FLOW_FROM},getSymbol:function(a){return this.renderer&&this.renderer.getSymbol(a)},setVisualVariables:function(a){a=q.filter(a,function(a){if("sizeInfo"===a.type)return m.isDefined(this._updateSizeInfo(a))},this);this.inherited(arguments);return this},setSizeInfo:function(a){this._updateSizeInfo(a);this.inherited(arguments);return this},setProportionalSymbolInfo:function(a){this.setSizeInfo(a);
return this},setColorInfo:function(a){return this},_updateRenderer:function(a){return m.isDefined(this.renderer)?a===n.STYLE_SINGLE_ARROW?this._createSingleArrowRenderer():a===n.STYLE_BEAUFORT_KN?this._createBeaufortKnotsRenderer():a===n.STYLE_BEAUFORT_METER?this._createBeaufortMeterRenderer():a===n.STYLE_BEAUFORT_FEET?this._createBeaufortFeetRenderer():a===n.STYLE_BEAUFORT_MILE?this._createBeaufortMilesRenderer():a===n.STYLE_BEAUFORT_KM?this._createBeaufortKilometersRenderer():a===n.STYLE_OCEAN_CURRENT_M?
this._createCurrentMeterRenderer():a===n.STYLE_OCEAN_CURRENT_KN?this._createCurrentKnotsRenderer():a===n.STYLE_SCALAR?this._createSimpleScalarRenderer():a===n.STYLE_WIND_BARBS?this._createWindBarbsRenderer():this._createClassifiedArrowRenderer():Error("Invalid Renderer!")},_updateSizeInfo:function(a){return a&&m.isDefined(a.minSize)&&m.isDefined(a.maxSize)&&m.isDefined(a.minDataValue)&&m.isDefined(a.maxDataValue)?(this.style===n.STYLE_WIND_BARBS&&(a.minSize=a.maxSize),a.field=a.field||"Magnitude",
a.type="sizeInfo",a):null},_createClassifiedArrowRenderer:function(){this.renderer.defaultSymbol=this._getDefaultSymbol(new p([56,168,0]));var a=[0,1E-6,3.5,7,10.5,14];if(m.isDefined(this.minDataValue)&&m.isDefined(this.maxDataValue)){var b=(this.maxDataValue-this.minDataValue)/5,a=[],c,g;g=this.minDataValue;for(c=0;6>c;c++)a[c]=g,g+=b}this._addBreaks(a,[[56,168,0],[139,309,0],[255,255,0],[255,128,0],[255,0,0]])},_createSingleArrowRenderer:function(){this.renderer.defaultSymbol=this.singleArrowSymbol||
this._getDefaultSymbol()},_createBeaufortMeterRenderer:function(){this.renderer.defaultSymbol=this._getDefaultSymbol(new p([214,47,39]));this._addBreaks([0,.2,1.8,3.3,5.4,8.5,11,14.1,17.2,20.8,24.4,28.6,32.7],[[69,117,181],[101,137,184],[132,158,186],[162,180,189],[192,204,190],[222,227,191],[255,255,191],[255,220,161],[250,185,132],[245,152,105],[237,117,81],[232,21,21]])},_createBeaufortKnotsRenderer:function(){this.renderer.defaultSymbol=this._getDefaultSymbol(new p([214,47,39]));this._addBreaks([0,
1,3,6,10,16,21,27,33,40,47,55,63],[[40,146,199],[89,162,186],[129,179,171],[160,194,155],[191,212,138],[218,230,119],[250,250,100],[252,213,83],[252,179,102],[250,141,52],[247,110,42],[240,71,29]])},_createBeaufortFeetRenderer:function(){var a=[0,.2,1.8,3.3,5.4,8.5,11,14.1,17.2,20.8,24.4,28.6,32.7];q.forEach(a,function(b,c){a[c]*=3.28084});this.renderer.defaultSymbol=this._getDefaultSymbol(new p([214,47,39]));this._addBreaks(a,[[69,117,181],[101,137,184],[132,158,186],[162,180,189],[192,204,190],
[222,227,191],[255,255,191],[255,220,161],[250,185,132],[245,152,105],[237,117,81],[232,21,21]])},_createBeaufortMilesRenderer:function(){var a=[0,.2,1.8,3.3,5.4,8.5,11,14.1,17.2,20.8,24.4,28.6,32.7];q.forEach(a,function(b,c){a[c]*=2.23694});this.renderer.defaultSymbol=this._getDefaultSymbol(new p([214,47,39]));this._addBreaks(a,[[69,117,181],[101,137,184],[132,158,186],[162,180,189],[192,204,190],[222,227,191],[255,255,191],[255,220,161],[250,185,132],[245,152,105],[237,117,81],[232,21,21]])},_createBeaufortKilometersRenderer:function(){var a=
[0,.2,1.8,3.3,5.4,8.5,11,14.1,17.2,20.8,24.4,28.6,32.7];q.forEach(a,function(b,c){a[c]*=3.6});this.renderer.defaultSymbol=this._getDefaultSymbol(new p([214,47,39]));this._addBreaks(a,[[69,117,181],[101,137,184],[132,158,186],[162,180,189],[192,204,190],[222,227,191],[255,255,191],[255,220,161],[250,185,132],[245,152,105],[237,117,81],[232,21,21]])},_createCurrentMeterRenderer:function(){this.renderer.defaultSymbol=this._getDefaultSymbol(new p([177,177,177]));this._addBreaks([0,.5,1,1.5,2],[[78,26,
153],[179,27,26],[202,128,26],[177,177,177]])},_createCurrentKnotsRenderer:function(){this.renderer.defaultSymbol=this._getDefaultSymbol(new p([177,177,177]));this._addBreaks([0,.25,.5,1,1.5,2,2.5,3,3.5,4],[[0,0,0],[0,37,100],[78,26,153],[151,0,100],[179,27,26],[177,78,26],[202,128,26],[177,179,52],[177,177,177]])},_createSimpleScalarRenderer:function(){this.renderer.defaultSymbol=new b({url:u.toUrl(this.iconFolderPath+"scalar.png"),height:20,width:20,type:"esriPMS",angle:0})},_createWindBarbsRenderer:function(){var g=
[],f,e;for(f=0;150>=f;f+=5)g.push(f);e="M20 20 M5 20 A15 15 0 1 0 35 20 A15 15 0 1 0 5 20 M20 20 M10 20 A10 10 0 1 0 30 20 A10 10 0 1 0 10 20;M25 0 L25 40 M25 35 L17.5 37.5;M25 0 L25 40 L10 45 L25 40;M25 0 L25 40 L10 45 L25 40 M25 35 L17.5 37.5;M25 0 L25 40 L10 45 L25 40 M25 35 L10 40;M25 0 L25 40 L10 45 L25 40 M25 35 L10 40 L25 35 M25 30 L17.5 32.5;M25 0 L25 40 L10 45 L25 40 M25 35 L10 40 L25 35 M25 30 L10 35;M25 0 L25 40 L10 45 L25 40 M25 35 L10 40 L25 35 M25 30 L10 35 L25 30 M25 25 L17.5 27.5;M25 0 L25 40 L10 45 L25 40 M25 35 L10 40 L25 35 M25 30 L10 35 L25 30 M25 25 L10 30;M25 0 L25 40 L10 45 L25 40 M25 35 L10 40 L25 35 M25 30 L10 35 L25 30 M25 25 L10 30 L25 25 M25 20 L17.5 22.5;M25 0 L25 40 L10 40 L25 35;M25 0 L25 40 L10 40 L25 35 M25 30 L17.5 32.5;M25 0 L25 40 L10 40 L25 35 M25 30 L10 35;M25 0 L25 40 L10 40 L25 35 M25 30 L10 35 L25 30 M25 25 L17.5 27.5;M25 0 L25 40 L10 40 L25 35 M25 30 L10 35 L25 30 M25 25 L10 30;M25 0 L25 40 L10 40 L25 35 M25 30 L10 35 L25 30 M25 25 L10 30 L25 25 M25 20 L17.5 22.5;M25 0 L25 40 L10 40 L25 35 M25 30 L10 35 L25 30 M25 25 L10 30 L25 25 M25 20 L10 25;M25 0 L25 40 L10 40 L25 35 M25 30 L10 35 L25 30 M25 25 L10 30 L25 25 M25 20 L10 25 L25 20 M25 15 L17.5 17.5;M25 0 L25 40 L10 40 L25 35 M25 30 L10 35 L25 30 M25 25 L10 30 L25 25 M25 20 L10 25 L25 20 M25 15 L10 20;M25 0 L25 40 L10 40 L25 35 M25 30 L10 35 L25 30 M25 25 L10 30 L25 25 M25 20 L10 25 L25 20 M25 15 L10 20 L25 15 M25 10 L17.5 12.5;M25 0 L25 40 L10 40 L25 35 L10 35 L25 30;M25 0 L25 40 L10 40 L25 35 L10 35 L25 30 M25 25 L17.5 27.5;M25 0 L25 40 L10 40 L25 35 L10 35 L25 30 M25 25 L10 30;M25 0 L25 40 L10 40 L25 35 L10 35 L25 30 M25 25 L10 30 M25 25 M25 20 L17.5 22.5;M25 0 L25 40 L10 40 L25 35 L10 35 L25 30 M25 25 L10 30 M25 25 M25 20 L10 25;M25 0 L25 40 L10 40 L25 35 L10 35 L25 30 M25 25 L10 30 M25 25 M25 20 L10 25 M25 20 M25 15 L17.5 17.5;M25 0 L25 40 L10 40 L25 35 L10 35 L25 30 M25 25 L10 30 M25 25 M25 20 L10 25 M25 20 M25 15 L10 20;M25 0 L25 40 L10 40 L25 35 L10 35 L25 30 M25 25 L10 30 M25 25 M25 20 L10 25 M25 20 M25 15 L10 20 M25 15 M25 10 L17.5 12.5;M25 0 L25 40 L10 40 L25 35 L10 35 L25 30 M25 25 L10 30 M25 25 M25 20 L10 25 M25 20 M25 15 L10 20 M25 15 M25 10 L10 15;M25 0 L25 40 L10 40 L25 35 L10 35 L25 30 M25 25 L10 30 M25 25 M25 20 L10 25 M25 20 M25 15 L10 20 M25 15 M25 10 L10 15 M25 10 M25 5 L17.5 7.5".split(";");
var h=new b({url:u.toUrl(this.iconFolderPath+"windbarb.png"),height:20,width:20,type:"esriPMS",angle:0});this.renderer.defaultSymbol=h;for(f=0;f<g.length-1;f++)0==f?this.renderer.addBreak({minValue:g[f],maxValue:g[f+1],symbol:h}):this.renderer.addBreak({minValue:g[f],maxValue:g[f+1],symbol:(new c).setPath(e[f]).setOutline((new a).setWidth(1.5)).setSize(20).setColor(new p([0,0,0,255]))})},_getDefaultSymbol:function(b){return(new c).setPath("M14,32 14,18 9,23 16,3 22,23 17,18 17,32 z").setOutline((new a).setWidth(0)).setSize(20).setColor(b||
new p([0,92,230]))},_getRotationInfo:function(a){var b=a&&a.flowRepresentation||n.FLOW_FROM,c=a&&a.rotationField||"Direction",g=n.FLOW_FROM;return{field:function(a){a=a.attributes[c];return b===g?a:a+180},type:"geographic"}},_addBreaks:function(a,b){if(!m.isDefined(this.renderer))return Error("Invalid Renderer!");if(!(a&&b&&a.length&&b.length&&a.length>=b.length))return Error("AddBreaks: Input arguments break values and colors not valid");var c;for(c=0;c<b.length;c++)this.renderer.addBreak({minValue:a[c],
maxValue:a[c+1],symbol:this._getDefaultSymbol(new p(b[c]))})},toJson:function(){var a=l.mixin(this.inherited(arguments),{type:"vectorField",style:this.style,attributeField:this.attributeField,flowRepresentation:this.flowRepresentation});this.renderer&&this.renderer.defaultSymbol&&this.style===n.STYLE_SINGLE_ARROW&&(a.singleArrowSymbol=this.renderer.defaultSymbol.toJson());return m.fixJson(a)}});l.mixin(n,{STYLE_WIND_BARBS:"wind_speed",STYLE_SINGLE_ARROW:"single_arrow",STYLE_CLASSIFIED_ARROW:"classified_arrow",
STYLE_BEAUFORT_KN:"beaufort_kn",STYLE_BEAUFORT_METER:"beaufort_m",STYLE_BEAUFORT_MILE:"beaufort_mi",STYLE_BEAUFORT_FEET:"beaufort_ft",STYLE_BEAUFORT_KM:"beaufort_km",STYLE_OCEAN_CURRENT_M:"ocean_current_m",STYLE_OCEAN_CURRENT_KN:"ocean_current_kn",STYLE_SCALAR:"simple_scalar"},{FLOW_FROM:"flow_from",FLOW_TO:"flow_to"});return n})},"esri/renderers/DotDensityRenderer":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/dom-construct dojo/has dojox/gfx/_base ../kernel ../lang ../Color ./Renderer ../symbols/PictureFillSymbol ../geometry/ScreenPoint ../geometry/Point".split(" "),
function(r,l,d,q,k,m,p,h,e,c,b,a,g){return r(c,{declaredClass:"esri.renderer.DotDensityRenderer",constructor:function(a){this.dotSize=a.dotSize||3;this.dotValue=a.dotValue;this.fields=a.fields;this.outline=a.outline;this.backgroundColor=a.backgroundColor;this.exactCount=a.exactCount||!0;this.dotShape=a.dotShape||"square";this.legendOptions=a.legendOptions;this._exactCountMinArea=1E4;this._currentMapScale=this._map=this._canvas=null;this._symbolMap={};this._currentGraphic=this._currentResolution=this._objectIdField=
null;this._supportsCanvas=window.CanvasRenderingContext2D?!0:!1;window.CanvasRenderingContext2D||console.log("The DotDensityRenderer requires a Canvas enabled Browser.  IE8 and less does not support Canvas.")},getSymbol:function(a){var c,g;this._currentGraphic=a;if(!this._supportsCanvas)return null;this._map||(this._map=a.getLayer()._map,this._objectIdField=a.getLayer().objectIdField,this._currentMapScale=this._map.getScale(),this._currentResolution=this._map.extent.getWidth()/this._map.width,this._map.on("zoom-end",
l.hitch(this,function(a){this._currentMapScale=this._map.getScale();this._currentResolution=a.extent.getWidth()/this._map.width;this._symbolMap[this._currentMapScale]={}})));if(this._symbolMap[this._currentMapScale]&&this._symbolMap[this._currentMapScale][a.attributes[this._objectIdField]])return c=this._symbolMap[this._currentMapScale][a.attributes[this._objectIdField]],g=this._getShapeProperties(a),c.setOffset(g.dx,g.dy),c;c=this._generateFieldsCount(this.fields,a.attributes,this.dotValue);g=this._getShapeProperties(a);
c=new b(this._generateImageSrc(g.width,g.height,c,g.minXY,g.maxXY),this.outline,g.width,g.height);c.setOffset(g.dx,g.dy);this._symbolMap[this._currentMapScale]||(this._symbolMap[this._currentMapScale]={});return this._symbolMap[this._currentMapScale][a.attributes[this._objectIdField]]=c},_generateFieldsCount:function(a,b,c){var f,g;for(g=a.length-1;0<=g;g--)f=b[a[g].name]/c,a[g].numPoints=Math.round(f);return a},_getShapeProperties:function(a){var b,c,f,e;b=a.geometry.getExtent();b.contains(this._map.extent)&&
(b=this._map.extent);f=Math.ceil(b.getWidth()/this._currentResolution);e=Math.ceil(b.getHeight()/this._currentResolution);c=this._map.toScreen(new g(b.xmin,b.ymin,b.spatialReference));b=this._map.toScreen(new g(b.xmax,b.ymax,b.spatialReference));a=a.getLayer().getNode().getCTM();return{minXY:c,maxXY:b,dx:(c.x-a.e)%f,dy:(b.y-a.f)%e,width:f,height:e}},_generateImageSrc:function(a,b,c,f,g,e){var h=this.dotSize,d,n,t;this._canvas?(this._canvas.width=a,this._canvas.height=b):this._canvas=this._initCanvas(a,
b);d=this._canvas.getContext("2d");if(e=e||this.backgroundColor)d.fillStyle=e.toCss(!0),d.fillRect(0,0,a,b),d.fill();for(e=c.length-1;0<=e;e--)for(d.fillStyle=c[e].color.toCss(!0),n=c[e].numPoints-1;0<=n;n--)t=this._getRandomPoint(a,b,f,g),"square"===this.dotShape?d.fillRect(t.x,t.y,h,h):"circle"===this.dotShape&&(d.beginPath(),d.arc(t.x,t.y,h/2,0,2*Math.PI,!0)),d.fill();return this._canvas.toDataURL()},_initCanvas:function(a,b){var c=q.create("canvas",{id:"canvas",width:a+"px",height:b+"px",style:"position: absolute; left: -10000px; top: 0px;"},
null);document.body.appendChild(c);return c},_getRandomInt:function(a,b){return Math.floor(Math.random()*(b-a+1)+a)},_getRandomPoint:function(b,c,g,f){var e={},h=this.outline&&this.outline.width?this.outline.width:0;if(!0===this.exactCount&&b*c>this._exactCountMinArea){b=!1;do e.x=this._getRandomInt(g.x,f.x),e.y=this._getRandomInt(f.y,g.y),b=new a(e.x,e.y),b=this._checkPointShapeBounds(b,this.dotSize+h,this._currentGraphic.geometry),!0===b&&(e.x-=g.x,e.y-=f.y);while(!1===b)}else e.x=this._getRandomInt(0,
b),e.y=this._getRandomInt(0,c);return e},_checkPointShapeBounds:function(a,b,c){var f=null,f=!1,g=!0,e=0;do{switch(e){case 1:a.x+=b;break;case 2:a.y+=b;break;case 3:a.x-=b}f=this._map.toMap(a);f=c.contains(f);!1===f&&(g=!1);e+=1}while(3>=e&&!0===g);return f},setDotSize:function(a){0<a&&(this.dotSize=a)},setDotValue:function(a){0<a&&(this.dotValue=a)},setOutline:function(a){this.outline=a},setBackgroundColor:function(a){this.backgroundColor=a},toJson:function(){var a=l.mixin(this.inherited(arguments),
{type:"dotDensity",backgroundColor:e.toJsonColor(this.backgroundColor),dotShape:this.dotShape,dotSize:0<this.dotSize?m.px2pt(this.dotSize):0,dotValue:this.dotValue,fields:d.map(this.fields,function(a){return h.fixJson({color:e.toJsonColor(a.color),name:a.name})}),legendOptions:this.legendOptions&&h.fixJson({backgroundColor:e.toJsonColor(this.legendOptions.backgroundColor),dotCoverage:this.legendOptions.dotCoverage,outline:this.legendOptions.outline&&this.legendOptions.outline.toJson(),valueUnit:this.legendOptions.valueUnit}),
outline:this.outline&&this.outline.toJson()});return h.fixJson(a)}})})},"esri/renderers/ScaleDependentRenderer":function(){define("dojo/_base/declare dojo/_base/array dojo/_base/lang dojo/has ../kernel ../lang ./Renderer".split(" "),function(r,l,d,q,k,m,p){return r(p,{declaredClass:"esri.renderer.ScaleDependentRenderer",constructor:function(h){this.setRendererInfos(h&&h.rendererInfos||[])},setRendererInfos:function(h){this.rendererInfos=h;this._setRangeType();return this},getSymbol:function(h){var e=
this.getRendererInfo(h);return e&&e.renderer&&e.renderer.getSymbol(h)},getRendererInfo:function(h){h=h.getLayer().getMap();return"zoom"===this.rangeType?this.getRendererInfoByZoom(h.getZoom()):this.getRendererInfoByScale(h.getScale())},getRendererInfoByZoom:function(h){var e,c=this.rendererInfos,b,a=0;do e=c[a],h>=e.minZoom&&h<=e.maxZoom&&(b=e),a++;while(!b&&a<c.length);return b},getRendererInfoByScale:function(h){var e,c=this.rendererInfos,b,a=0,g,d,n,t;do e=c[a],g=e.minScale,d=e.maxScale,n=!g,t=
!d,!n&&h<=g&&(n=!0),!t&&h>=d&&(t=!0),n&&t&&(b=e),a++;while(!b&&a<c.length);return b},addRendererInfo:function(h){var e,c=0,b,a=this.rendererInfos,g=h.hasOwnProperty("minZoom")?"minZoom":"minScale",d=a.length;do{b=a[c];if(d===c||h[g]<b[g])a.splice(c,0,h),this._setRangeType(),e=!0;c++}while(!e&&c<d);return this},_setRangeType:function(){var h=this.rendererInfos;if(h=h&&h[0])this.rangeType=h.hasOwnProperty("minZoom")?"zoom":h.hasOwnProperty("minScale")?"scale":""},toJson:function(){if("zoom"===this.rangeType)return null;
var h=this.rendererInfos||[],e=h[0]&&h[0].minScale,h=d.mixin(this.inherited(arguments),{type:"scaleDependent",minScale:0<e?e:0,rendererInfos:l.map(h,function(c){return m.fixJson({maxScale:0<c.maxScale?c.maxScale:0,renderer:c.renderer&&c.renderer.toJson()})})});return m.fixJson(h)}})})},"esri/renderers/TimeClassBreaksAger":function(){define("dojo/_base/declare dojo/_base/array dojo/_base/lang dojo/has dojo/date ../kernel ../lang ../symbols/jsonUtils ../Color ./SymbolAger".split(" "),function(r,l,d,
q,k,m,p,h,e,c){var b=r(c,{declaredClass:"esri.renderer.TimeClassBreaksAger",constructor:function(a,b){this.infos=a;this.timeUnits=b||"day";a.sort(function(a,b){return a.minAge<b.minAge?-1:a.minAge>b.minAge?1:0})},getAgedSymbol:function(a,b){var c=b.getLayer(),g=b.attributes,e=p.isDefined;a=h.fromJson(a.toJson());var f=c._map.timeExtent.endTime;if(!f)return a;var d=k.difference(new Date(g[c._startTimeField]),f,this.timeUnits);l.some(this.infos,function(b){if(d>=b.minAge&&d<=b.maxAge){var c=b.color,
f=b.size;b=b.alpha;c&&a.setColor(c);e(f)&&this._setSymbolSize(a,f);e(b)&&a.color&&(a.color.a=b);return!0}},this);return a},toJson:function(){var a={agerClassBreakInfos:[]},b,c,h;a.timeUnits=this._getRestUnits(this.timeUnits);for(b=0;b<this.infos.length;b+=1)c=this.infos[b],h={},h.oldestAge=Infinity===c.maxAge?null:c.maxAge,h.size=c.size,c.color&&(h.color=e.toJsonColor(c.color)),c.alpha&&(h.alpha=Math.round(255*c.alpha)),a.agerClassBreakInfos[b]=h;return a},_getRestUnits:function(a){var c="esriTimeUnitsDays";
switch(a){case b.UNIT_SECONDS:c="esriTimeUnitsSeconds";break;case b.UNIT_MILLISECONDS:c="esriTimeUnitsMilliseconds";break;case b.UNIT_HOURS:c="esriTimeUnitsHours";break;case b.UNIT_MINUTES:c="esriTimeUnitsMinutes";break;case b.UNIT_MONTHS:c="esriTimeUnitsMonths";break;case b.UNIT_WEEKS:c="esriTimeUnitsWeeks";break;case b.UNIT_YEARS:c="esriTimeUnitsYears"}return c}});d.mixin(b,{UNIT_DAYS:"day",UNIT_HOURS:"hour",UNIT_MILLISECONDS:"millisecond",UNIT_MINUTES:"minute",UNIT_MONTHS:"month",UNIT_SECONDS:"second",
UNIT_WEEKS:"week",UNIT_YEARS:"year"});return b})},"esri/renderers/SymbolAger":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/has","../kernel"],function(r,l,d,q){return r(null,{declaredClass:"esri.renderer.SymbolAger",getAgedSymbol:function(d,m){},_setSymbolSize:function(d,m){switch(d.type){case "simplemarkersymbol":d.setSize(m);break;case "picturemarkersymbol":d.setWidth(m);d.setHeight(m);break;case "simplelinesymbol":case "cartographiclinesymbol":d.setWidth(m);break;case "simplefillsymbol":case "picturefillsymbol":d.outline&&
d.outline.setWidth(m)}}})})},"esri/renderers/TimeRampAger":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/Color dojo/has ../kernel ../symbols/jsonUtils ../Color ./SymbolAger".split(" "),function(r,l,d,q,k,m,p,h){return r(h,{declaredClass:"esri.renderer.TimeRampAger",constructor:function(e,c,b){this.colorRange=e;this.sizeRange=c;this.alphaRange=b},getAgedSymbol:function(e,c){var b=c.getLayer(),a=c.attributes;e=m.fromJson(e.toJson());var g=b._map.timeExtent,h=g.startTime,g=g.endTime;
if(!h||!g)return e;h=h.getTime();g=g.getTime();b=new Date(a[b._startTimeField]);b=b.getTime();b<h&&(b=h);h=g===h?1:(b-h)/(g-h);if(b=this.sizeRange)a=b[0],g=b[1],b=Math.abs(g-a)*h,this._setSymbolSize(e,a<g?a+b:a-b);if(b=this.colorRange){var g=b[0],n=b[1],t=Math.round,a=new d,f=g.r,k=n.r,b=Math.abs(k-f)*h;a.r=t(f<k?f+b:f-b);f=g.g;k=n.g;b=Math.abs(k-f)*h;a.g=t(f<k?f+b:f-b);f=g.b;k=n.b;b=Math.abs(k-f)*h;a.b=t(f<k?f+b:f-b);g=g.a;n=n.a;b=Math.abs(n-g)*h;a.a=g<n?g+b:g-b;e.setColor(a)}a=e.color;(b=this.alphaRange)&&
a&&(g=b[0],n=b[1],b=Math.abs(n-g)*h,a.a=g<n?g+b:g-b);return e},toJson:function(){var e={};this.sizeRange&&(e.sizeRange=this.sizeRange);this.colorRange&&(e.colorRange=[p.toJsonColor(this.colorRange[0]),p.toJsonColor(this.colorRange[1])]);this.alphaRange&&(e.alphaRange=[Math.round(255*this.alphaRange[0]),Math.round(255*this.alphaRange[1])]);return e}})})},"esri/renderers/TemporalRenderer":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/has","../kernel","./Renderer"],function(r,l,d,q,
k){return r(k,{declaredClass:"esri.renderer.TemporalRenderer",constructor:function(d,k,h,e){this.observationRenderer=d;this.latestObservationRenderer=k;this.trackRenderer=h;this.observationAger=e},getSymbol:function(d){var k=d.getLayer(),h=this.getObservationRenderer(d),e=h&&h.getSymbol(d),c=this.observationAger;k.timeInfo&&k._map.timeExtent&&h===this.observationRenderer&&c&&e&&(e=c.getAgedSymbol(e,d));return e},getObservationRenderer:function(d){return 0===d.getLayer()._getKind(d)?this.observationRenderer:
this.latestObservationRenderer||this.observationRenderer},toJson:function(){var d={type:"temporal"};d.observationRenderer=this.observationRenderer.toJson();this.latestObservationRenderer&&(d.latestObservationRenderer=this.latestObservationRenderer.toJson());this.trackRenderer&&(d.trackRenderer=this.trackRenderer.toJson());this.observationAger&&(d.observationAger=this.observationAger.toJson());return d}})})},"esri/renderers/HeatmapRenderer":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/dom-construct ../sniff ../kernel ../lang ../symbols/PictureMarkerSymbol ../Color ./Renderer".split(" "),
function(r,l,d,q,k,m,p,h,e,c){return r([c],{declaredClass:"esri.renderer.HeatmapRenderer",colors:null,blurRadius:10,maxPixelIntensity:100,minPixelIntensity:0,field:null,fieldOffset:null,colorStops:null,constructor:function(b){(this._supportsCanvas=window.CanvasRenderingContext2D?!0:!1)?("string"==typeof b&&(b=JSON.parse(b)),l.mixin(this,b),this._canvas=null,this.colors||this.colorStops||(this.colorStops=[{ratio:0,color:"rgba(255, 140, 0, 0)"},{ratio:.75,color:"rgba(255, 140, 0, 1)"},{ratio:.9,color:"rgba(255, 0,   0, 1)"}]),
this.gradient=this._generateGradient(this.colorStops||this.colors)):console.log("The HeatmapRenderer requires a Canvas enabled Browser.  IE8 and less does not support Canvas.")},getSymbol:function(b){if(!this._supportsCanvas)return!1;var a=b.attributes.imageData;b=b.attributes.size;if(!b)return null;var c=this._getContext(b[0],b[1]),e=c.getImageData(0,0,b[0],b[1]);window.ArrayBuffer&&a instanceof ArrayBuffer?a=window.Uint8ClampedArray?new Uint8ClampedArray(a):new Uint8Array(a):a.BYTES_PER_ELEMENT&&
1!==a.BYTES_PER_ELEMENT&&(a=window.Uint8ClampedArray?new Uint8ClampedArray(a.buffer):new Uint8Array(a.buffer));if(window.CanvasPixelArray&&e.data instanceof window.CanvasPixelArray)for(var d=e.data,t=d.length;t--;)d[t]=a[t];else e.data.set(a);c.putImageData(e,0,0);return new h(c.canvas.toDataURL(),b[0],b[1])},setColors:function(b){b&&(b instanceof Array||b.colors)&&(this.gradient=this._generateGradient(b.colors||b),this.colors=b);return this},setColorStops:function(b){b&&(b instanceof Array||b.colorStops)&&
(this.gradient=this._generateGradient(b.colorStops||b),this.colorStops=b);return this},setMaxPixelIntensity:function(b){this.maxPixelIntensity=b;return this},setMinPixelIntensity:function(b){this.minPixelIntensity=b;return this},setField:function(b){this.field=b;return this},setFieldOffset:function(b){this.fieldOffset=b;return this},setBlurRadius:function(b){this.blurRadius=b;return this},getStats:function(){},getHistogramData:function(){},toJson:function(){var b=l.mixin(this.inherited(arguments),
{type:"heatmap",blurRadius:this.blurRadius,colorStops:this._colorsToStops(this.colorStops||this.colors),maxPixelIntensity:this.maxPixelIntensity,minPixelIntensity:this.minPixelIntensity,field:this.field});null!=this.fieldOffset&&(b.fieldOffset=this.fieldOffset);d.forEach(b.colorStops,function(a){a.color=e.toJsonColor(a.color)});return p.fixJson(b)},_getContext:function(b,a){this._canvas?(this._canvas.width=b,this._canvas.height=a):this._canvas=this._initCanvas(b,a);return this._canvas.getContext("2d")},
_initCanvas:function(b,a){var c=q.create("canvas",{id:"hm_canvas-"+Math.floor(1E3*Math.random()),style:"position: absolute; left: 0px; top: -10000px;"},null);c.width=b;c.height=a;document.body.appendChild(c);return c},_generateGradient:function(b,a){a||(a=512);for(var c=this._colorsToStops(b),e=this._getContext(1,a||512),h=e.createLinearGradient(0,0,0,a),d=0,f;d<c.length;d++)f=c[d],h.addColorStop(f.ratio,f.color.toCss(!0));e.fillStyle=h;e.fillRect(0,0,1,a);return e.getImageData(0,0,1,a).data},_colorsToStops:function(b){var a=
[];if(!b[0])return a;if(null!=b[0].ratio)a=d.map(b,function(a){return{ratio:a.ratio,color:this._toColor(a.color)}},this);else if(null!=b[0].value){var c=Infinity,a=-Infinity,e=0,h;for(h=0;h<b.length;h++){var t=b[h].value;t<c&&(c=t);t>a&&(a=t)}e=a-c;this.maxPixelIntensity=a;this.minPixelIntensity=c;a=d.map(b,function(a){var b=a.value;a=this._toColor(a.color);return{value:b,ratio:(b-c)/e,color:a}},this)}else var f=b.length-1,a=d.map(b,function(a,b){return{color:this._toColor(a),ratio:b/f}},this);return a},
_toColor:function(b){b.toRgba||b.declaredClass||(b=new e(b));return b}})})},"esri/renderers/StretchRenderer":function(){define("dojo/_base/declare dojo/_base/array dojo/_base/lang dojo/has ../kernel ../lang ../layers/RasterFunction ./colorRampUtils".split(" "),function(r,l,d,q,k,m,p,h){var e={TYPE_NONE:"none",TYPE_STANDARDDEVIATION:"standardDeviation",TYPE_HISTOGRAMEQUALIZATION:"histogramEqualization",TYPE_MINMAX:"minMax",TYPE_PERCENTCLIP:"percentClip",TYPE_SIGMOID:"sigmoid"};r=r(null,{declaredClass:"esri.renderer.StretchRenderer",
constructor:function(c){c=c||{};this.stretchType=e.TYPE_NONE;this.dra=!0;this.statistics=[];this.gamma=[];this.computeGamma=this.useGamma=!1;this.sigmoidStrengthLevel=this.numberOfStandardDeviations=this.minPercent=this.maxPercent=this.min=this.max=null;d.mixin(this,c);this.colorRamp=h.fromJson(c.colorRamp)},toJson:function(){var c={type:"rasterStretch",stretchType:this.stretchType,colorRamp:this.colorRamp&&this.colorRamp.toJson(),min:this.min,max:this.max,numberOfStandardDeviations:this.numberOfStandardDeviations,
statistics:d.clone(this.statistics),dra:this.dra,minPercent:this.minPercent,maxPercent:this.maxPercent,useGamma:this.useGamma,gamma:d.clone(this.gamma),computeGamma:this.computeGamma,sigmoidStrengthLevel:this.sigmoidStrengthLevel};return m.fixJson(c)},toRenderingRule:function(){var c=new p;c.functionName="Stretch";var b=this._convertStretchTypeEnumToIndex(this.stretchType),a={StretchType:b,Statistics:this.statistics,DRA:this.dra,UseGamma:this.useGamma,Gamma:this.gamma,ComputeGamma:this.computeGamma};
m.isDefined(this.min)&&(a.Min=this.min);m.isDefined(this.min)&&(a.Max=this.max);3===b?(a.NumberOfStandardDeviations=this.numberOfStandardDeviations,c.outputPixelType="U8"):6===b?(a.MinPercent=parseFloat(this.minPercent),a.MaxPercent=parseFloat(this.maxPercent),c.outputPixelType="U8"):5===b?c.outputPixelType="U8":9===b&&(a.SigmoidStrengthLevel=this.sigmoidStrengthLevel);c.functionArguments=a;c.variableName="Raster";return this.colorRamp?(b=new p,a=h.getColorRampName(this.colorRamp),b.functionArguments=
a?{colorRamp:a}:{colorRamp:this.colorRamp.toJson()},b.variableName="Raster",b.functionName="Colormap",b.functionArguments.Raster=c,b):c},_convertStretchTypeEnumToIndex:function(c){var b=0;c===e.TYPE_STANDARDDEVIATION?b=3:c===e.TYPE_HISTOGRAMEQUALIZATION?b=4:c===e.TYPE_MINMAX?b=5:c===e.TYPE_PERCENTCLIP?b=6:c===e.TYPE_SIGMOID&&(b=9);return b},_convertStretchTypeIndexToEnum:function(c){var b=0;3===c?b=e.TYPE_STANDARDDEVIATION:4===c?b=e.TYPE_HISTOGRAMEQUALIZATION:5===c?b=e.TYPE_MINMAX:6===c?b=e.TYPE_PERCENTCLIP:
9===c&&(b=e.TYPE_SIGMOID);return b}});d.mixin(r,e);return r})},"esri/layers/RasterFunction":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/has","../kernel","../lang"],function(r,l,d,q,k){var m=r(null,{declaredClass:"esri.layers.RasterFunction",functionName:null,arguments:null,functionArguments:null,variableName:null,outputPixelType:null,constructor:function(d){if(l.isObject(d)){var h=0;this.functionName=d.rasterFunction;this.functionArguments=l.clone(d.rasterFunctionArguments||d.arguments);
l.mixin(this,d);if(d=this.functionArguments)if(d.Raster=this._toRasterFunction(d.Raster),d.Raster2=this._toRasterFunction(d.Raster2),d.DEM=this._toRasterFunction(d.DEM),d.FillRaster=this._toRasterFunction(d.FillRaster),d.Rasters&&d.Rasters.length)for(h=0;h<d.Rasters.length;h++)d.Rasters[h]=this._toRasterFunction(d.Rasters[h])}},_toRasterFunction:function(d){return d&&(d.rasterFunction||d.functionName)?new m(d):d},_rfToJson:function(d){d&&"esri.layers.RasterFunction"===d.declaredClass&&(d=d.toJson());
return d},toJson:function(){var d=l.clone(this.functionArguments||this.arguments);if(d&&(d.Raster=this._rfToJson(d.Raster),d.Raster2=this._rfToJson(d.Raster2),d.DEM=this._rfToJson(d.DEM),d.FillRaster=this._rfToJson(d.FillRaster),d.Rasters&&d.Rasters.length)){var h,e=[];for(h=0;h<d.Rasters.length;h++)e.push(this._rfToJson(d.Rasters[h]));d.Rasters=e}return k.filter({rasterFunction:this.functionName,rasterFunctionArguments:d,variableName:this.variableName,outputPixelType:this.outputPixelType?this.outputPixelType:
null},function(c){if(null!==c&&void 0!==c)return!0})}});return m})},"esri/renderers/colorRampUtils":function(){define("dojo/_base/lang dojo/_base/array dojo/store/Memory ../tasks/AlgorithmicColorRamp ../tasks/MultipartColorRamp ../Color".split(" "),function(r,l,d,q,k,m){function p(c,g,h){if(c){g=g||b;h=h||a;var f=null,d=c.declaredClass,n,t;(n="string"===typeof c?c:c.name)?l.some(h,function(a){if(a.name===n)return f=a.id,!0}):"esri.tasks.AlgorithmicColorRamp"===d?l.some(g,function(a){if(e(c.fromColor.toRgb(),
a.fromColor)&&e(c.toColor.toRgb(),a.toColor))return f=a.id,!0},this):"esri.tasks.MultipartColorRamp"===d&&l.some(g,function(a){if(c.colorRamps&&a.colorRamps&&c.colorRamps.length===a.colorRamps.length&&(t=c.colorRamps,!l.some(a.colorRamps,function(a,b){if(!e(t[b].fromColor.toRgb(),a.fromColor)||!e(t[b].toColor.toRgb(),a.toColor))return!0},this))){if(f)return!0;f=a.id}},this);return f}}function h(a){var b=new q;b.fromColor=m.toDojoColor(a.fromColor);b.toColor=m.toDojoColor(a.toColor);b.algorithm=a.algorithm;
return b}function e(a,b){return a&&b&&a.length&&b.length&&a.length===b.length?!l.some(a,function(a,c){if(a!==b[c])return!0}):!1}var c={},b=[{id:"none",selected:!0},{id:"aspect_predefined",type:"multipart",colorRamps:[{fromColor:[190,190,190],toColor:[255,45,8]},{fromColor:[255,45,8],toColor:[255,181,61]},{fromColor:[255,181,61],toColor:[255,254,52]},{fromColor:[255,254,52],toColor:[0,251,50]},{fromColor:[0,251,50],toColor:[255,254,52]},{fromColor:[0,253,255],toColor:[0,181,255]},{fromColor:[0,181,
255],toColor:[26,35,253]},{fromColor:[26,35,253],toColor:[255,57,251]},{fromColor:[255,57,251],toColor:[255,45,8]}]},{id:"blackToWhite_predefined",fromColor:[0,0,0],toColor:[255,255,255]},{id:"blueBright_predefined",fromColor:[204,204,255],toColor:[0,0,224]},{id:"blueLightToDark_predefined",fromColor:[211,229,232],toColor:[46,100,140]},{id:"blueGreenBright_predefined",fromColor:[203,245,234],toColor:[48,207,146]},{id:"blueGreenLightToDark_predefined",fromColor:[216,242,237],toColor:[21,79,74]},{id:"brownLightToDark_predefined",
fromColor:[240,236,170],toColor:[102,72,48]},{id:"brownToBlueGreenDivergingBright_predefined",type:"multipart",colorRamps:[{fromColor:[156,85,31],toColor:[255,255,191]},{fromColor:[255,255,191],toColor:[33,130,145]}]},{id:"brownToBlueGreenDivergingDark_predefined",type:"multipart",colorRamps:[{fromColor:[110,70,45],toColor:[204,204,102]},{fromColor:[204,204,102],toColor:[48,100,102]}]},{id:"coefficientBias_predefined",fromColor:[214,214,255],toColor:[0,57,148]},{id:"coldToHotDiverging_predefined",
type:"multipart",colorRamps:[{fromColor:[69,117,181],toColor:[255,255,191]},{fromColor:[255,255,191],toColor:[214,47,39]}]},{id:"conditionNumber_predefined",type:"multipart",colorRamps:[{fromColor:[0,97,0],toColor:[255,255,0]},{fromColor:[255,255,0],toColor:[255,34,0]}]},{id:"cyanToPurple_predefined",type:"multipart",colorRamps:[{fromColor:[0,245,245],toColor:[0,0,245]},{fromColor:[0,0,245],toColor:[245,0,245]}]},{id:"cyanLightToBlueDark_predefined",type:"multipart",colorRamps:[{fromColor:[182,237,
240],toColor:[31,131,224]},{fromColor:[31,131,224],toColor:[9,9,145]}]},{id:"distance_predefined",fromColor:[255,200,0],toColor:[0,0,255]},{id:"elevation1_predefined",type:"multipart",colorRamps:[{fromColor:[175,240,233],toColor:[255,255,179]},{fromColor:[255,255,179],toColor:[0,128,64]},{fromColor:[0,128,64],toColor:[252,186,3]},{fromColor:[252,186,3],toColor:[128,0,0]},{fromColor:[120,0,0],toColor:[105,48,13]},{fromColor:[105,48,13],toColor:[171,171,171]},{fromColor:[171,171,171],toColor:[255,252,
255]}]},{id:"elevation2_predefined",type:"multipart",colorRamps:[{fromColor:[118,219,211],toColor:[255,255,199]},{fromColor:[255,255,199],toColor:[255,255,128]},{fromColor:[255,255,128],toColor:[217,194,121]},{fromColor:[217,194,121],toColor:[135,96,38]},{fromColor:[135,96,38],toColor:[150,150,181]},{fromColor:[150,150,181],toColor:[181,150,181]},{fromColor:[181,150,181],toColor:[255,252,255]}]},{id:"errors_predefined",fromColor:[255,235,214],toColor:[196,10,10]},{id:"grayLightToDark_predefined",
fromColor:[219,219,219],toColor:[69,69,69]},{id:"greenBright_predefined",fromColor:[204,255,204],toColor:[14,204,14]},{id:"greenLightToDark_predefined",fromColor:[220,245,233],toColor:[34,102,51]},{id:"greenToBlue_predefined",type:"multipart",colorRamps:[{fromColor:[32,204,16],toColor:[0,242,242]},{fromColor:[0,242,242],toColor:[2,33,227]}]},{id:"orangeBright_predefined",fromColor:[255,235,204],toColor:[240,118,5]},{id:"orangeLightToDark_predefined",fromColor:[250,233,212],toColor:[171,65,36]},{id:"partialSpectrum_predefined",
type:"multipart",colorRamps:[{fromColor:[242,241,162],toColor:[255,255,0]},{fromColor:[255,255,0],toColor:[255,0,0]},{fromColor:[252,3,69],toColor:[176,7,237]},{fromColor:[176,7,237],toColor:[2,29,173]}]},{id:"partialSpectrum1Diverging_predefined",type:"multipart",colorRamps:[{fromColor:[135,38,38],toColor:[240,149,12]},{fromColor:[240,149,12],toColor:[255,255,191]},{fromColor:[255,255,191],toColor:[74,80,181]},{fromColor:[74,80,181],toColor:[39,32,122]}]},{id:"partialSpectrum2Diverging_predefined",
type:"multipart",colorRamps:[{fromColor:[115,77,42],toColor:[201,137,52]},{fromColor:[201,137,52],toColor:[255,255,191]},{fromColor:[255,255,191],toColor:[91,63,176]},{fromColor:[91,63,176],toColor:[81,13,97]}]},{id:"pinkToYellowGreenDivergingBright_predefined",type:"multipart",colorRamps:[{fromColor:[158,30,113],toColor:[255,255,191]},{fromColor:[255,255,191],toColor:[99,110,45]}]},{id:"pinkToYellowGreenDivergingDark_predefined",type:"multipart",colorRamps:[{fromColor:[97,47,73],toColor:[204,204,
102]},{fromColor:[204,204,102],toColor:[22,59,15]}]},{id:"precipitation_predefined",type:"multipart",colorRamps:[{fromColor:[194,82,60],toColor:[237,161,19]},{fromColor:[237,161,19],toColor:[255,255,0]},{fromColor:[255,255,0],toColor:[0,219,0]},{fromColor:[0,219,0],toColor:[32,153,143]},{fromColor:[32,153,143],toColor:[11,44,122]}]},{id:"prediction_predefined",type:"multipart",colorRamps:[{fromColor:[40,146,199],toColor:[250,250,100]},{fromColor:[250,250,100],toColor:[232,16,20]}]},{id:"purpleBright_predefined",
fromColor:[255,204,255],toColor:[199,0,199]},{id:"purpleToGreenDivergingBright_predefined",type:"multipart",colorRamps:[{fromColor:[77,32,150],toColor:[255,255,191]},{fromColor:[255,255,191],toColor:[20,122,11]}]},{id:"purpleToGreenDivergingDark_predefined",type:"multipart",colorRamps:[{fromColor:[67,14,89],toColor:[204,204,102]},{fromColor:[204,204,102],toColor:[24,79,15]}]},{id:"purpleBlueBright_predefined",fromColor:[223,184,230],toColor:[112,12,242]},{id:"purpleBlueLightToDark_predefined",fromColor:[229,
213,242],toColor:[93,44,112]},{id:"purpleRedBright_predefined",fromColor:[255,204,225],toColor:[199,0,99]},{id:"purpleRedLightToDark_predefined",fromColor:[250,215,246],toColor:[143,17,57]},{id:"redBright_predefined",fromColor:[255,204,204],toColor:[219,0,0]},{id:"redLightToDark_predefined",fromColor:[255,224,224],toColor:[143,10,10]},{id:"redToBlueDivergingBright_predefined",type:"multipart",colorRamps:[{fromColor:[196,69,57],toColor:[255,255,191]},{fromColor:[255,255,191],toColor:[48,95,207]}]},
{id:"redToBlueDivergingDark_predefined",type:"multipart",colorRamps:[{fromColor:[107,13,13],toColor:[204,204,102]},{fromColor:[204,204,102],toColor:[13,53,97]}]},{id:"redToGreen_predefined",type:"multipart",colorRamps:[{fromColor:[245,0,0],toColor:[245,245,0]},{fromColor:[245,245,0],toColor:[0,245,0]}]},{id:"redToGreenDivergingBright_predefined",type:"multipart",colorRamps:[{fromColor:[186,20,20],toColor:[255,255,191]},{fromColor:[255,255,191],toColor:[54,145,33]}]},{id:"redToGreenDivergingDark_predefined",
type:"multipart",colorRamps:[{fromColor:[97,21,13],toColor:[204,204,102]},{fromColor:[204,204,102],toColor:[16,69,16]}]},{id:"slope_predefined",type:"multipart",colorRamps:[{fromColor:[56,168,0],toColor:[255,255,0]},{fromColor:[255,255,0],toColor:[255,0,0]}]},{id:"spectrumFullBright_predefined",type:"multipart",colorRamps:[{fromColor:[255,0,0],toColor:[255,255,0]},{fromColor:[255,255,0],toColor:[0,255,255]},{fromColor:[0,255,255],toColor:[0,0,255]}]},{id:"spectrumFullDark_predefined",type:"multipart",
colorRamps:[{fromColor:[153,0,0],toColor:[153,153,0]},{fromColor:[153,153,0],toColor:[0,153,153]},{fromColor:[0,153,153],toColor:[0,0,153]}]},{id:"spectrumFullLight_predefined",type:"multipart",colorRamps:[{fromColor:[255,153,153],toColor:[255,255,153]},{fromColor:[255,255,153],toColor:[153,255,255]},{fromColor:[153,255,255],toColor:[153,153,255]}]},{id:"surface_predefined",type:"multipart",colorRamps:[{fromColor:[112,153,89],toColor:[242,238,162]},{fromColor:[242,238,162],toColor:[242,206,133]},
{fromColor:[242,206,133],toColor:[194,140,124]},{fromColor:[194,140,124],toColor:[255,242,255]}]},{id:"temperature_predefined",type:"multipart",colorRamps:[{fromColor:[255,252,255],toColor:[255,0,255]},{fromColor:[255,0,255],toColor:[0,0,255]},{fromColor:[0,0,255],toColor:[0,255,255]},{fromColor:[0,255,255],toColor:[0,255,0]},{fromColor:[0,255,0],toColor:[255,255,0]},{fromColor:[255,255,0],toColor:[255,128,0]},{fromColor:[255,128,0],toColor:[128,0,0]}]},{id:"whiteToBlack_predefined",fromColor:[255,
255,255],toColor:[0,0,0]},{id:"yellowToDarkRed_predefined",type:"multipart",colorRamps:[{fromColor:[255,255,128],toColor:[242,167,46]},{fromColor:[242,167,46],toColor:[107,0,0]}]},{id:"yellowToGreenToDarkBlue_predefined",type:"multipart",colorRamps:[{fromColor:[255,255,128],toColor:[56,224,9]},{fromColor:[56,224,9],toColor:[26,147,171]},{fromColor:[26,147,171],toColor:[12,16,120]}]},{id:"yellowToRed_predefined",fromColor:[245,245,0],toColor:[255,0,0]},{id:"yellowGreenBright_predefined",fromColor:[236,
252,204],toColor:[157,204,16]},{id:"yellowGreenLightToDark_predefined",fromColor:[215,240,175],toColor:[96,107,45]}],a=[{name:"Aspect",id:"aspect_predefined"},{name:"Black to White",id:"blackToWhite_predefined"},{name:"Blue Bright",id:"blueBright_predefined"},{name:"Blue Light to Dark",id:"blueLightToDark_predefined"},{name:"Blue-Green Bright",id:"blueGreenBright_predefined"},{name:"Blue-Green Light to Dark",id:"blueGreenLightToDark_predefined"},{name:"Brown Light to Dark",id:"brownLightToDark_predefined"},
{name:"Brown to Blue Green Diverging, Bright",id:"brownToBlueGreenDivergingBright_predefined"},{name:"Brown to Blue Green Diverging, Dark",id:"brownToBlueGreenDivergingDark_predefined"},{name:"Coefficient Bias",id:"coefficientBias_predefined"},{name:"Cold to Hot Diverging",id:"coldToHotDiverging_predefined"},{name:"Condition Number",id:"conditionNumber_predefined"},{name:"Cyan to Purple",id:"cyanToPurple_predefined"},{name:"Cyan-Light to Blue-Dark",id:"cyanLightToBlueDark_predefined"},{name:"Distance",
id:"distance_predefined"},{id:"elevation1_predefined",name:"Elevation #1"},{id:"elevation2_predefined",name:"Elevation #2"},{id:"errors_predefined",name:"Errors"},{id:"grayLightToDark_predefined",name:"Gray Light to Dark"},{id:"greenBright_predefined",name:"Green Bright"},{id:"greenLightToDark_predefined",name:"Green Light to Dark"},{name:"Green to Blue",id:"greenToBlue_predefined"},{name:"Orange Bright",id:"orangeBright_predefined"},{name:"Orange Light to Dark",id:"orangeLightToDark_predefined"},
{id:"partialSpectrum_predefined",name:"Partial Spectrum"},{id:"partialSpectrum1Diverging_predefined",name:"Partial Spectrum 1 Diverging",type:"multipart"},{id:"partialSpectrum2Diverging_predefined",name:"Partial Spectrum 2 Diverging"},{name:"Pink to YellowGreen Diverging, Bright",id:"pinkToYellowGreenDivergingBright_predefined"},{name:"Pink to YellowGreen Diverging, Dark",id:"pinkToYellowGreenDivergingDark_predefined"},{id:"precipitation_predefined",name:"Precipitation"},{id:"prediction_predefined",
name:"Prediction"},{name:"Purple Bright",id:"purpleBright_predefined"},{id:"purpleToGreenDivergingBright_predefined",name:"Purple to Green Diverging, Bright"},{id:"purpleToGreenDivergingDark_predefined",name:"Purple to Green Diverging, Dark"},{name:"Purple-Blue Bright",id:"purpleBlueBright_predefined"},{name:"Purple-Blue Light to Dark",id:"purpleBlueLightToDark_predefined"},{name:"Purple-Red Bright",id:"purpleRedBright_predefined"},{name:"Purple-Red Light to Dark",id:"purpleRedLightToDark_predefined"},
{name:"Red Bright",id:"redBright_predefined"},{name:"Red Light to Dark",id:"redLightToDark_predefined"},{id:"redToBlueDivergingBright_predefined",name:"Red to Blue Diverging, Bright"},{id:"redToBlueDivergingDark_predefined",name:"Red to Blue Diverging, Dark"},{id:"redToGreen_predefined",name:"Red to Green"},{id:"redToGreenDivergingBright_predefined",name:"Red to Green Diverging, Bright"},{id:"redToGreenDivergingDark_predefined",name:"Red to Green Diverging, Dark"},{name:"Slope",id:"slope_predefined"},
{id:"spectrumFullBright_predefined",name:"Spectrum-Full Bright"},{id:"spectrumFullDark_predefined",name:"Spectrum-Full Dark"},{id:"spectrumFullLight_predefined",name:"Spectrum-Full Light"},{id:"surface_predefined",name:"Surface"},{id:"temperature_predefined",name:"Temperature"},{name:"White to Black",id:"whiteToBlack_predefined"},{id:"yellowToDarkRed_predefined",name:"Yellow to Dark Red"},{id:"yellowToGreenToDarkBlue_predefined",name:"Yellow to Green to Dark Blue"},{name:"Yellow to Red",id:"yellowToRed_predefined"},
{name:"Yellow-Green Bright",id:"yellowGreenBright_predefined"},{name:"Yellow-Green Light to Dark",id:"yellowGreenLightToDark_predefined"}],g=new d({data:a});r.mixin(c,{predefinedColorRamps:b,predefinedColorRampNameMap:a,getColorRampName:function(a){return(a=p(a))?(a=g.query({id:a}),a[0]?a[0].name:null):null},fromJson:function(a){var b=null;if(!a)return b;"multipart"===a.type?(b=new k,b.colorRamps=l.map(a.colorRamps,function(a){return h(a)},this)):"algorithmic"===a.type&&(b=h(a));return b},colorsEqual:e,
getColorRampId:p});return c})},"dojo/store/Memory":function(){define(["../_base/declare","./util/QueryResults","./util/SimpleQueryEngine"],function(r,l,d){return r("dojo.store.Memory",null,{constructor:function(d){for(var k in d)this[k]=d[k];this.setData(this.data||[])},data:null,idProperty:"id",index:null,queryEngine:d,get:function(d){return this.data[this.index[d]]},getIdentity:function(d){return d[this.idProperty]},put:function(d,k){var m=this.data,l=this.index,h=this.idProperty,h=d[h]=k&&"id"in
k?k.id:h in d?d[h]:Math.random();if(h in l){if(k&&!1===k.overwrite)throw Error("Object already exists");m[l[h]]=d}else l[h]=m.push(d)-1;return h},add:function(d,k){(k=k||{}).overwrite=!1;return this.put(d,k)},remove:function(d){var k=this.index,m=this.data;if(d in k)return m.splice(k[d],1),this.setData(m),!0},query:function(d,k){return l(this.queryEngine(d,k)(this.data))},setData:function(d){d.items?(this.idProperty=d.identifier||this.idProperty,d=this.data=d.items):this.data=d;this.index={};for(var k=
0,m=d.length;k<m;k++)this.index[d[k][this.idProperty]]=k}})})},"dojo/store/util/QueryResults":function(){define(["../../_base/array","../../_base/lang","../../when"],function(r,l,d){var q=function(k){function m(h){k[h]=function(){var e=arguments,c=d(k,function(b){Array.prototype.unshift.call(e,b);return q(r[h].apply(r,e))});if("forEach"!==h||p)return c}}if(!k)return k;var p=!!k.then;p&&(k=l.delegate(k));m("forEach");m("filter");m("map");null==k.total&&(k.total=d(k,function(h){return h.length}));return k};
l.setObject("dojo.store.util.QueryResults",q);return q})},"dojo/store/util/SimpleQueryEngine":function(){define(["../../_base/array"],function(r){return function(l,d){function q(k){k=r.filter(k,l);var m=d&&d.sort;m&&k.sort("function"==typeof m?m:function(e,c){for(var b,a=0;b=m[a];a++){var g=e[b.attribute],h=c[b.attribute],g=null!=g?g.valueOf():g,h=null!=h?h.valueOf():h;if(g!=h)return!!b.descending==(null==g||g>h)?-1:1}return 0});if(d&&(d.start||d.count)){var h=k.length;k=k.slice(d.start||0,(d.start||
0)+(d.count||Infinity));k.total=h}return k}switch(typeof l){default:throw Error("Can not query with a "+typeof l);case "object":case "undefined":var k=l;l=function(d){for(var m in k){var h=k[m];if(h&&h.test){if(!h.test(d[m],d))return!1}else if(h!=d[m])return!1}return!0};break;case "string":if(!this[l])throw Error("No filter function "+l+" was found in store");l=this[l];case "function":}q.matches=l;return q}})},"esri/tasks/AlgorithmicColorRamp":function(){define("dojo/_base/declare dojo/_base/lang dojo/has ../kernel ../Color ./ColorRamp".split(" "),
function(r,l,d,q,k,m){return r(m,{declaredClass:"esri.tasks.AlgorithmicColorRamp",type:"algorithmic",fromColor:null,toColor:null,algorithm:null,toJson:function(){var d;switch(this.algorithm&&this.algorithm.toLowerCase()){case "cie-lab":d="esriCIELabAlgorithm";break;case "hsv":d="esriHSVAlgorithm";break;case "lab-lch":d="esriLabLChAlgorithm"}d={type:"algorithmic",algorithm:d};d.fromColor=k.toJsonColor(this.fromColor);d.toColor=k.toJsonColor(this.toColor);return d}})})},"esri/tasks/ColorRamp":function(){define(["dojo/_base/declare",
"dojo/_base/lang","dojo/has","../kernel"],function(r,l,d,q){return r(null,{declaredClass:"esri.tasks.ColorRamp",type:null})})},"esri/tasks/MultipartColorRamp":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/has ../kernel ../symbols/Symbol ./ColorRamp".split(" "),function(r,l,d,q,k,m){return r(m,{declaredClass:"esri.tasks.MultipartColorRamp",type:"multipart",constructor:function(){this.colorRamps=[]},addColorRamp:function(d){this.colorRamps.push(d)},toJson:function(){return{type:"multipart",
colorRamps:d.map(this.colorRamps,function(d){return d.toJson()})}}})})},"esri/dijit/PopupTemplate":function(){define("dojo/_base/declare dojo/_base/lang dojo/has dojo/dom-construct ../kernel ../InfoTemplate ../PopupInfo ./PopupRenderer".split(" "),function(r,l,d,q,k,m,p,h){return r([m,p],{declaredClass:"esri.dijit.PopupTemplate","-chains-":{constructor:"manual"},chartTheme:null,constructor:function(e,c){l.mixin(this,c);this.initialize(e,c)},getTitle:function(e){var c;this.info&&(c=this.titleHasRelatedFields?
"":this._getPopupValues(e,!0).title);return c||""},getContent:function(e){return this.info?(new h({template:this,graphic:e,chartTheme:this.chartTheme},q.create("div"))).domNode:""}})})},"esri/PopupInfo":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/json dojo/i18n dojo/has dojo/Deferred dojo/sniff dojo/promise/all dojox/html/entities ./lang ./kernel ./request ./tasks/query ./tasks/QueryTask ./tasks/RelationshipQuery ./tasks/StatisticDefinition ./renderers/arcadeUtils dojo/i18n!dojo/cldr/nls/number".split(" "),
function(r,l,d,q,k,m,p,h,e,c,b,a,g,u,n,t,f,v,x){return r(null,{declaredClass:"esri.PopupInfo",_reExprField:/^\s*expression\//i,_exprPrefix:"expression/",_relatedFieldPrefix:"relationships/",initialize:function(a,b){if(a){l.mixin(this,b);this.info=a;this.title=this.getTitle;this.content=this.getContent;this._exprCache=this._compileExpressions(this.info.expressionInfos);var c=this._fieldLabels={},f=this._fieldsMap={};this.info.fieldInfos&&d.forEach(this.info.fieldInfos,function(a){var b=a.fieldName.toLowerCase(),
g=this._isExpressionField(b)?this.getExpressionInfo(b):null;c[b]=g?g.title:a.label;f[b]=a},this);this.titleHasRelatedFields=!(!this.info.title||-1===this.info.title.indexOf("{"+this._relatedFieldPrefix))}},toJson:function(){return q.fromJson(q.toJson(this.info))},getTitle:function(){},getContent:function(){},getFieldInfo:function(a){var b;d.some(this.info&&this.info.fieldInfos,function(c){c.fieldName===a&&(b=c);return!!b});return b},getExpressionInfo:function(a){if(this._isExpressionField(a)){a=a.replace(this._reExprField,
"");a=a.toLowerCase();var b;d.some(this.info.expressionInfos,function(c){c.name.toLowerCase()===a&&(b=c);return!!b});return b}},getComponents:function(a){var b=this.info,c=new p,f,g;b.fieldInfos&&(g=d.filter(b.fieldInfos,function(a){return-1!==a.fieldName.indexOf(this._relatedFieldPrefix)},this));g&&0<g.length&&(f=this._getRelatedRecords({graphic:a,fieldsInfo:g}));f?f.always(l.hitch(this,function(){c.resolve(this._getPopupValues(a))})):c.resolve(this._getPopupValues(a));return c.promise},getAttachments:function(a){var b=
a.getSourceLayer();a=a.attributes;if(this.info.showAttachments&&b&&b.hasAttachments&&b.objectIdField&&(a=a&&a[b.objectIdField]))return b.queryAttachmentInfos(a)},_isExpressionField:function(a){return this._reExprField.test(a)},_compileExpressions:function(a){var b={};d.forEach(a,function(a){b[a.name]={compiledFunc:v.createFunction(a.expression)}});return b},_fetchAttributes:function(a){var b=l.clone(a.attributes)||{},f=this._exprPrefix,g=this._exprCache;d.forEach(this.info.expressionInfos,function(e){var h=
f+e.name;e=g[e.name];e=v.executeFunction(e&&e.compiledFunc,v.createExecContext(a,a._getViewInfo()));"string"===typeof e&&(e=c.encode(e));b[h]=e});return b},_getPopupValues:function(a,c){var f=this.info,g=a.getSourceLayer(),e=this._fetchAttributes(a),h=l.clone(e),n=f.fieldInfos,t="",u="",k,m,p,w,v,q=g&&g._getDateOpts&&g._getDateOpts().properties,q=q&&q.slice(0),x={dateFormat:{properties:q,formatter:"DateFormat"+this._insertOffset(this._dateFormats.shortDateShortTime)}};if(this._relatedInfo)for(w in this._relatedInfo)if(this._relatedInfo.hasOwnProperty(w)){var z=
this._relatedInfo[w],r=this._relatedLayersInfo[w];z&&(d.forEach(z.relatedFeatures,function(a){for(v in a.attributes)if(a.attributes.hasOwnProperty(v)&&"esriRelCardinalityOneToOne"===r.relation.cardinality){var b=this._toRelatedFieldName([r.relation.id,v]);e[b]=h[b]=a.attributes[v]}},this),d.forEach(z.relatedStatsFeatures,function(a){for(v in a.attributes)if(a.attributes.hasOwnProperty(v)){var b=this._toRelatedFieldName([r.relation.id,v]);e[b]=h[b]=a.attributes[v]}},this))}n&&d.forEach(n,function(a){m=
a.fieldName;var b=this._getLayerFieldInfo(g,m);b&&(m=a.fieldName=b.name);h[m]=this._formatValue(h[m],m,x);q&&a.format&&a.format.dateFormat&&(a=d.indexOf(q,m),-1<a&&q.splice(a,1))},this);if(g){w=g.types;var O=(z=g.typeIdField)&&e[z];for(m in e)if(e.hasOwnProperty(m)&&-1===m.indexOf(this._relatedFieldPrefix)&&(p=e[m],b.isDefined(p))){var Q=this._getDomainName(g,a,w,O,m,p);b.isDefined(Q)?h[m]=Q:m===z&&(Q=this._getTypeName(g,a,p),b.isDefined(Q)&&(h[m]=Q))}}f.title&&(t=this._processFieldsInLinks(this._fixTokens(f.title,
g),e),t=l.trim(b.substitute(h,t,x)||""));if(c)return{title:t};f.description&&(u=this._processFieldsInLinks(this._fixTokens(f.description,g),e),u=l.trim(b.substitute(h,u,x)||""));n&&(k=[],d.forEach(n,function(a){(m=a.fieldName)&&a.visible&&k.push([this._fieldLabels[m.toLowerCase()]||m,b.substitute(h,"${"+m+"}",x)||""])},this));var U,ia;f.mediaInfos&&(U=[],d.forEach(f.mediaInfos,function(a){ia=0;p=a.value;switch(a.type){case "image":var c=p.sourceURL,c=c&&l.trim(b.substitute(e,this._fixTokens(c,g)));
ia=!!c;break;case "piechart":case "linechart":case "columnchart":case "barchart":var f,c=p.normalizeField;p.fields=d.map(p.fields,function(a){return(f=this._getLayerFieldInfo(g,a))?f.name:a},this);c&&(f=this._getLayerFieldInfo(g,c),p.normalizeField=f?f.name:c);ia=d.some(p.fields,function(a){return b.isDefined(e[a])||-1!==a.indexOf(this._relatedFieldPrefix)&&this._relatedInfo},this);break;default:return}if(ia){a=l.clone(a);p=a.value;var c=a.title?this._processFieldsInLinks(this._fixTokens(a.title,
g),e):"",n=a.caption?this._processFieldsInLinks(this._fixTokens(a.caption,g),e):"";a.title=c?l.trim(b.substitute(h,c,x)||""):"";a.caption=n?l.trim(b.substitute(h,n,x)||""):"";if("image"===a.type)p.sourceURL=b.substitute(e,this._fixTokens(p.sourceURL,g)),p.linkURL&&(p.linkURL=l.trim(b.substitute(e,this._fixTokens(p.linkURL,g))||""));else{var t,u;d.forEach(p.fields,function(a,b){if(-1!==a.indexOf(this._relatedFieldPrefix))u=this._getRelatedChartInfos(a,p,e,x),u instanceof Array?p.fields=u:p.fields[b]=
u;else{var c=e[a],c=void 0===c?null:c;t=e[p.normalizeField]||0;c&&t&&(c/=t);p.fields[b]={y:c,tooltip:(this._fieldLabels[a.toLowerCase()]||a)+":\x3cbr/\x3e"+this._formatValue(c,a,x,!!t)}}},this)}U.push(a)}},this));return{title:t,description:u,hasDescription:!!f.description,fields:k&&k.length?k:null,mediaInfos:U&&U.length?U:null,formatted:h,editSummary:g&&g.getEditSummary?g.getEditSummary(a):""}},_getRelatedChartInfos:function(a,c,f,g){var e,h,n,t,u,k;e=[];k=this._fromRelatedFieldName(a);u=k[0];h=this._relatedInfo[u];
u=this._relatedLayersInfo[u];h&&d.forEach(h.relatedFeatures,function(h){h=h.attributes;var d,u;for(u in h)if(h.hasOwnProperty(u)&&u===k[1]){d={};t=h[u];c.normalizeField&&(n=-1!==c.normalizeField.indexOf(this._relatedFieldPrefix)?h[this._fromRelatedFieldName(c.normalizeField)[1]]:f[c.normalizeField]);t&&n&&(t/=n);if(c.tooltipField)if(-1!==c.tooltipField.indexOf(this._relatedFieldPrefix)){var m=this._fromRelatedFieldName(c.tooltipField)[1],l=b.isDefined(h[m])?h[m]:m;d.tooltip=l+":\x3cbr/\x3e"+this._formatValue(t,
m,g,!!n)}else d.tooltip=(this._fieldLabels[a.toLowerCase()]||a)+":\x3cbr/\x3e"+this._formatValue(t,c.tooltipField,g,!!n);else d.tooltip=t;d.y=t;e.push(d)}},this);return"esriRelCardinalityOneToMany"===u.relation.cardinality||"esriRelCardinalityManyToMany"===u.relation.cardinality?e:e[0]},_dateFormats:{shortDate:"(datePattern: 'M/d/y', selector: 'date')",shortDateLE:"(datePattern: 'd/M/y', selector: 'date')",longMonthDayYear:"(datePattern: 'MMMM d, y', selector: 'date')",dayShortMonthYear:"(datePattern: 'd MMM y', selector: 'date')",
longDate:"(datePattern: 'EEEE, MMMM d, y', selector: 'date')",shortDateShortTime:"(datePattern: 'M/d/y', timePattern: 'h:mm a', selector: 'date and time')",shortDateLEShortTime:"(datePattern: 'd/M/y', timePattern: 'h:mm a', selector: 'date and time')",shortDateShortTime24:"(datePattern: 'M/d/y', timePattern: 'H:mm', selector: 'date and time')",shortDateLEShortTime24:"(datePattern: 'd/M/y', timePattern: 'H:mm', selector: 'date and time')",shortDateLongTime:"(datePattern: 'M/d/y', timePattern: 'h:mm:ss a', selector: 'date and time')",
shortDateLELongTime:"(datePattern: 'd/M/y', timePattern: 'h:mm:ss a', selector: 'date and time')",shortDateLongTime24:"(datePattern: 'M/d/y', timePattern: 'H:mm:ss', selector: 'date and time')",shortDateLELongTime24:"(datePattern: 'd/M/y', timePattern: 'H:mm:ss', selector: 'date and time')",longMonthYear:"(datePattern: 'MMMM y', selector: 'date')",shortMonthYear:"(datePattern: 'MMM y', selector: 'date')",year:"(datePattern: 'y', selector: 'date')"},_reHref:/href\s*=\s*\"([^\"]+)\"/ig,_reHrefApos:/href\s*=\s*\'([^\']+)\'/ig,
_fixTokens:function(a,b){var c=this;return a.replace(/(\{([^\{\r\n]+)\})/g,function(a,f,g){a=c._getLayerFieldInfo(b,g);return"$"+(a?"{"+a.name+"}":f)})},_encodeAttributes:function(a){a=l.clone(a)||{};var b,c;for(b in a)(c=a[b])&&"string"===typeof c&&(c=encodeURIComponent(c).replace(/\'/g,"\x26apos;"),a[b]=c);return a},_processFieldsInLinks:function(a,b){var c=this._encodeAttributes(b),f=this;a&&(a=a.replace(this._reHref,function(a,g){return f._addValuesToHref(a,g,b,c)}).replace(this._reHrefApos,function(a,
g){return f._addValuesToHref(a,g,b,c)}));return a},_addValuesToHref:function(a,c,f,g){c=c&&l.trim(c);return b.substitute(c&&0===c.indexOf("${")?f:g,a)},_getLayerFieldInfo:function(a,b){return a&&a.getField?a.getField(b):null},_formatValue:function(a,c,f,g){var e=this._fieldsMap[c.toLowerCase()],h=e&&e.format;c=-1!==d.indexOf(f.dateFormat.properties,c);var n="number"===typeof a&&!c&&(!h||!h.dateFormat);if(!b.isDefined(a)||!e||!b.isDefined(h))return n?this._forceLTR(a):a;var t="",e=[],u=h.hasOwnProperty("places")||
h.hasOwnProperty("digitSeparator"),k=h.hasOwnProperty("digitSeparator")?h.digitSeparator:!0;if(u&&!c)t="NumberFormat",e.push("places: "+(b.isDefined(h.places)&&(!g||0<h.places)?Number(h.places):"Infinity")),e.length&&(t+="("+e.join(",")+")");else if(h.dateFormat)t="DateFormat"+this._insertOffset(this._dateFormats[h.dateFormat]||this._dateFormats.shortDateShortTime);else return n?this._forceLTR(a):a;var m=this._applyFormatting(a,t,f);u&&-1<a.constructor.toString().indexOf("Array")&&(m="",d.forEach(a,
l.hitch(this,function(a,b){b&&(m+=" ");m+=this._applyFormatting(a,t,f)})));u&&!k&&x.group&&(m=m.replace(new RegExp("\\"+x.group,"g"),""));c&&(m='\x3cspan class\x3d"esriDateValue"\x3e'+m+"\x3c/span\x3e");return n?this._forceLTR(m):m},_applyFormatting:function(a,c,f){return b.substitute({myKey:a},"${myKey:"+c+"}",f)||""},_forceLTR:function(a){var b=h("ie");return b&&10>=b?a:"\x3cspan class\x3d'esriNumericValue'\x3e"+a+"\x3c/span\x3e"},_insertOffset:function(a){a&&(a=b.isDefined(this.utcOffset)?a.replace(/\)\s*$/,
", utcOffset:"+this.utcOffset+")"):a);return a},_getDomainName:function(a,b,c,f,g,e){return(a=a.getDomain&&a.getDomain(g,{feature:b}))&&a.codedValues?a.getName(e):null},_getTypeName:function(a,b,c){return(a=a.getType&&a.getType(b))&&a.name},_getRelatedRecords:function(a){var b=a.graphic,c=new p,f;this._relatedLayersInfo?this._queryRelatedLayers(b).then(l.hitch(this,function(a){this._setRelatedRecords(b,a);c.resolve(a)}),l.hitch(this,this._handlerErrorResponse,c)):this._getRelatedLayersInfo(a).then(l.hitch(this,
function(a){for(f in a)a.hasOwnProperty(f)&&a[f]&&(this._relatedLayersInfo[f].relatedLayerInfo=a[f]);this._queryRelatedLayers(b).then(l.hitch(this,function(a){this._setRelatedRecords(b,a);c.resolve(a)}),l.hitch(this,this._handlerErrorResponse,c))}),l.hitch(this,this._handlerErrorResponse,c));return c.promise},_getRelatedLayersInfo:function(a){var b=a.fieldsInfo,c,h,n={};c=a.graphic.getSourceLayer();this._relatedLayersInfo||(this._relatedLayersInfo={});d.forEach(b,function(a){var b,g,e,h;b=this._fromRelatedFieldName(a.fieldName);
g=b[0];b=b[1];g&&(this._relatedLayersInfo[g]||(d.some(c.relationships,function(a){if(a.id==g)return h=a,!0}),h&&(this._relatedLayersInfo[g]={relation:h,relatedFields:[],outStatistics:[]})),this._relatedLayersInfo[g]&&(this._relatedLayersInfo[g].relatedFields.push(b),a.statisticType&&(e=new f,e.statisticType=a.statisticType,e.onStatisticField=b,e.outStatisticFieldName=b,this._relatedLayersInfo[g].outStatistics.push(e))))},this);for(h in this._relatedLayersInfo)this._relatedLayersInfo.hasOwnProperty(h)&&
this._relatedLayersInfo[h]&&(a=this._relatedLayersInfo[h].relation,a=c.url.replace(/[0-9]+$/,a.relatedTableId),this._relatedLayersInfo[h].relatedLayerUrl=a,n[h]=g({url:a,content:{f:"json"},callbackParamName:"callback"}));return e(n)},_queryRelatedLayers:function(a){var b={},c;for(c in this._relatedLayersInfo)this._relatedLayersInfo.hasOwnProperty(c)&&(b[c]=this._queryRelatedLayer({graphic:a,relatedInfo:this._relatedLayersInfo[c]}));return e(b)},_queryRelatedLayer:function(a){var b,c,f,g,h,t,k,m,v,
q,w,x,r;b=a.graphic;c=b.getSourceLayer();f=c.url.match(/[0-9]+$/g)[0];w=a.relatedInfo;q=w.relatedLayerInfo;x=w.relatedLayerUrl;a=w.relation;d.some(q.relationships,function(a){if(a.relatedTableId===parseInt(f,10))return g=a,!0},this);g&&(h=new u,d.some(q.fields,function(a){if(a.name===g.keyField)return m=-1!==d.indexOf(["esriFieldTypeSmallInteger","esriFieldTypeInteger","esriFieldTypeSingle","esriFieldTypeDouble"],a.type)?"number":"string",!0}),g.relationshipTableId&&g.keyFieldInRelationshipTable?
(r=new p,this._queryRelatedRecords(b,g).then(l.hitch(this,function(a){var f;f=a[b.attributes[c.objectIdField]];a=d.map(f.features,function(a){return a.attributes[q.objectIdField]},this);w.outStatistics&&0<w.outStatistics.length&&q.supportsStatistics&&(v=new u,v.objectIds=a,v.outFields=h.outFields,v.outStatistics=w.outStatistics);v&&(t=new n(x),t.execute(v).then(l.hitch(this,function(a){var b=[];b.push(f);b.push(a);r.resolve(b)})))}))):(k="string"===m?g.keyField+"\x3d'"+b.attributes[a.keyField]+"'":
g.keyField+"\x3d"+b.attributes[a.keyField],h.where=k,h.outFields=w.relatedFields,w.outStatistics&&0<w.outStatistics.length&&q.supportsStatistics&&(v=new u,v.where=h.where,v.outFields=h.outFields,v.outStatistics=w.outStatistics),t=new n(x),k=[],k.push(t.execute(h)),v&&k.push(t.execute(v))));return k?e(k):r?r.promise:void 0},_setRelatedRecords:function(a,c){this._relatedInfo=[];for(var f in c)if(c.hasOwnProperty(f)&&c[f]){var g=c[f];this._relatedInfo[f]={};this._relatedInfo[f].relatedFeatures=g[0].features;
b.isDefined(g[1])&&(this._relatedInfo[f].relatedStatsFeatures=g[1].features)}},_handlerErrorResponse:function(a,b){a.reject(b)},_fromRelatedFieldName:function(a){var b=[];-1!==a.indexOf(this._relatedFieldPrefix)&&(a=a.split("/"),b=a.slice(1));return b},_toRelatedFieldName:function(a){var b="";a&&0<a.length&&(b=this._relatedFieldPrefix+a[0]+"/"+a[1]);return b},_queryRelatedRecords:function(a,b){var c=a.getSourceLayer(),f=new t;f.outFields=["*"];f.relationshipId=b.id;f.objectIds=[a.attributes[c.objectIdField]];
return c.queryRelatedFeatures(f)}})})},"dojox/html/entities":function(){define(["dojo/_base/lang"],function(r){var l=r.getObject("dojox.html.entities",!0),d=function(d,m){var k,h;if(m._encCache&&m._encCache.regexp&&m._encCache.mapper&&m.length==m._encCache.length)k=m._encCache.mapper,h=m._encCache.regexp;else{k={};h=["["];var e;for(e=0;e<m.length;e++)k[m[e][0]]="\x26"+m[e][1]+";",h.push(m[e][0]);h.push("]");h=new RegExp(h.join(""),"g");m._encCache={mapper:k,regexp:h,length:m.length}}return d=d.replace(h,
function(c){return k[c]})},q=function(d,m){var k,h;if(m._decCache&&m._decCache.regexp&&m._decCache.mapper&&m.length==m._decCache.length)k=m._decCache.mapper,h=m._decCache.regexp;else{k={};h=["("];var e;for(e=0;e<m.length;e++){var c="\x26"+m[e][1]+";";e&&h.push("|");k[c]=m[e][0];h.push(c)}h.push(")");h=new RegExp(h.join(""),"g");m._decCache={mapper:k,regexp:h,length:m.length}}return d=d.replace(h,function(b){return k[b]})};l.html=[["\x26","amp"],['"',"quot"],["\x3c","lt"],["\x3e","gt"],["\u00a0","nbsp"]];
l.latin=[["\u00a1","iexcl"],["\u00a2","cent"],["\u00a3","pound"],["\u20ac","euro"],["\u00a4","curren"],["\u00a5","yen"],["\u00a6","brvbar"],["\u00a7","sect"],["\u00a8","uml"],["\u00a9","copy"],["\u00aa","ordf"],["\u00ab","laquo"],["\u00ac","not"],["\u00ad","shy"],["\u00ae","reg"],["\u00af","macr"],["\u00b0","deg"],["\u00b1","plusmn"],["\u00b2","sup2"],["\u00b3","sup3"],["\u00b4","acute"],["\u00b5","micro"],["\u00b6","para"],["\u00b7","middot"],["\u00b8","cedil"],["\u00b9","sup1"],["\u00ba","ordm"],
["\u00bb","raquo"],["\u00bc","frac14"],["\u00bd","frac12"],["\u00be","frac34"],["\u00bf","iquest"],["\u00c0","Agrave"],["\u00c1","Aacute"],["\u00c2","Acirc"],["\u00c3","Atilde"],["\u00c4","Auml"],["\u00c5","Aring"],["\u00c6","AElig"],["\u00c7","Ccedil"],["\u00c8","Egrave"],["\u00c9","Eacute"],["\u00ca","Ecirc"],["\u00cb","Euml"],["\u00cc","Igrave"],["\u00cd","Iacute"],["\u00ce","Icirc"],["\u00cf","Iuml"],["\u00d0","ETH"],["\u00d1","Ntilde"],["\u00d2","Ograve"],["\u00d3","Oacute"],["\u00d4","Ocirc"],
["\u00d5","Otilde"],["\u00d6","Ouml"],["\u00d7","times"],["\u00d8","Oslash"],["\u00d9","Ugrave"],["\u00da","Uacute"],["\u00db","Ucirc"],["\u00dc","Uuml"],["\u00dd","Yacute"],["\u00de","THORN"],["\u00df","szlig"],["\u00e0","agrave"],["\u00e1","aacute"],["\u00e2","acirc"],["\u00e3","atilde"],["\u00e4","auml"],["\u00e5","aring"],["\u00e6","aelig"],["\u00e7","ccedil"],["\u00e8","egrave"],["\u00e9","eacute"],["\u00ea","ecirc"],["\u00eb","euml"],["\u00ec","igrave"],["\u00ed","iacute"],["\u00ee","icirc"],
["\u00ef","iuml"],["\u00f0","eth"],["\u00f1","ntilde"],["\u00f2","ograve"],["\u00f3","oacute"],["\u00f4","ocirc"],["\u00f5","otilde"],["\u00f6","ouml"],["\u00f7","divide"],["\u00f8","oslash"],["\u00f9","ugrave"],["\u00fa","uacute"],["\u00fb","ucirc"],["\u00fc","uuml"],["\u00fd","yacute"],["\u00fe","thorn"],["\u00ff","yuml"],["\u0192","fnof"],["\u0391","Alpha"],["\u0392","Beta"],["\u0393","Gamma"],["\u0394","Delta"],["\u0395","Epsilon"],["\u0396","Zeta"],["\u0397","Eta"],["\u0398","Theta"],["\u0399",
"Iota"],["\u039a","Kappa"],["\u039b","Lambda"],["\u039c","Mu"],["\u039d","Nu"],["\u039e","Xi"],["\u039f","Omicron"],["\u03a0","Pi"],["\u03a1","Rho"],["\u03a3","Sigma"],["\u03a4","Tau"],["\u03a5","Upsilon"],["\u03a6","Phi"],["\u03a7","Chi"],["\u03a8","Psi"],["\u03a9","Omega"],["\u03b1","alpha"],["\u03b2","beta"],["\u03b3","gamma"],["\u03b4","delta"],["\u03b5","epsilon"],["\u03b6","zeta"],["\u03b7","eta"],["\u03b8","theta"],["\u03b9","iota"],["\u03ba","kappa"],["\u03bb","lambda"],["\u03bc","mu"],["\u03bd",
"nu"],["\u03be","xi"],["\u03bf","omicron"],["\u03c0","pi"],["\u03c1","rho"],["\u03c2","sigmaf"],["\u03c3","sigma"],["\u03c4","tau"],["\u03c5","upsilon"],["\u03c6","phi"],["\u03c7","chi"],["\u03c8","psi"],["\u03c9","omega"],["\u03d1","thetasym"],["\u03d2","upsih"],["\u03d6","piv"],["\u2022","bull"],["\u2026","hellip"],["\u2032","prime"],["\u2033","Prime"],["\u203e","oline"],["\u2044","frasl"],["\u2118","weierp"],["\u2111","image"],["\u211c","real"],["\u2122","trade"],["\u2135","alefsym"],["\u2190",
"larr"],["\u2191","uarr"],["\u2192","rarr"],["\u2193","darr"],["\u2194","harr"],["\u21b5","crarr"],["\u21d0","lArr"],["\u21d1","uArr"],["\u21d2","rArr"],["\u21d3","dArr"],["\u21d4","hArr"],["\u2200","forall"],["\u2202","part"],["\u2203","exist"],["\u2205","empty"],["\u2207","nabla"],["\u2208","isin"],["\u2209","notin"],["\u220b","ni"],["\u220f","prod"],["\u2211","sum"],["\u2212","minus"],["\u2217","lowast"],["\u221a","radic"],["\u221d","prop"],["\u221e","infin"],["\u2220","ang"],["\u2227","and"],
["\u2228","or"],["\u2229","cap"],["\u222a","cup"],["\u222b","int"],["\u2234","there4"],["\u223c","sim"],["\u2245","cong"],["\u2248","asymp"],["\u2260","ne"],["\u2261","equiv"],["\u2264","le"],["\u2265","ge"],["\u2282","sub"],["\u2283","sup"],["\u2284","nsub"],["\u2286","sube"],["\u2287","supe"],["\u2295","oplus"],["\u2297","otimes"],["\u22a5","perp"],["\u22c5","sdot"],["\u2308","lceil"],["\u2309","rceil"],["\u230a","lfloor"],["\u230b","rfloor"],["\u2329","lang"],["\u232a","rang"],["\u25ca","loz"],
["\u2660","spades"],["\u2663","clubs"],["\u2665","hearts"],["\u2666","diams"],["\u0152","OElig"],["\u0153","oelig"],["\u0160","Scaron"],["\u0161","scaron"],["\u0178","Yuml"],["\u02c6","circ"],["\u02dc","tilde"],["\u2002","ensp"],["\u2003","emsp"],["\u2009","thinsp"],["\u200c","zwnj"],["\u200d","zwj"],["\u200e","lrm"],["\u200f","rlm"],["\u2013","ndash"],["\u2014","mdash"],["\u2018","lsquo"],["\u2019","rsquo"],["\u201a","sbquo"],["\u201c","ldquo"],["\u201d","rdquo"],["\u201e","bdquo"],["\u2020","dagger"],
["\u2021","Dagger"],["\u2030","permil"],["\u2039","lsaquo"],["\u203a","rsaquo"]];l.encode=function(k,m){k&&(m?k=d(k,m):(k=d(k,l.html),k=d(k,l.latin)));return k};l.decode=function(d,m){d&&(m?d=q(d,m):(d=q(d,l.html),d=q(d,l.latin)));return d};return l})},"esri/tasks/QueryTask":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/Deferred dojo/_base/json dojo/has ../kernel ../request ../deferredUtils ../geometry/Extent ../geometry/normalizeUtils ./Task ./FeatureSet".split(" "),
function(r,l,d,q,k,m,p,h,e,c,b,a,g){r=r(a,{declaredClass:"esri.tasks.QueryTask",_eventMap:{complete:["featureSet"],"execute-for-count-complete":["count"],"execute-for-ids-complete":["objectIds"],"execute-relationship-query-complete":["featureSets"]},constructor:function(a,b){this._handler=l.hitch(this,this._handler);this._relationshipQueryHandler=l.hitch(this,this._relationshipQueryHandler);this._executeForIdsHandler=l.hitch(this,this._executeForIdsHandler);this._countHandler=l.hitch(this,this._countHandler);
this._extentHandler=l.hitch(this,this._extentHandler);this.source=b&&b.source;this.gdbVersion=b&&b.gdbVersion;this.registerConnectEvents()},__msigns:[{n:"execute",c:4,a:[{i:0,p:["geometry"]}],e:2},{n:"executeForIds",c:3,a:[{i:0,p:["geometry"]}],e:2},{n:"executeForCount",c:3,a:[{i:0,p:["geometry"]}],e:2},{n:"executeForExtent",c:3,a:[{i:0,p:["geometry"]}],e:2}],onComplete:function(){},onExecuteRelationshipQueryComplete:function(){},onExecuteForIdsComplete:function(){},onExecuteForCountComplete:function(){},
onExecuteForExtentComplete:function(){},execute:function(a,b,c,f,g){var e=g.assembly;a=this._encode(l.mixin({},this._url.query,{f:"json"},a.toJson(e&&e[0])));var d=this._handler,n=this._errorHandler;this.source&&(e={source:this.source.toJson()},a.layer=k.toJson(e));this.gdbVersion&&(a.gdbVersion=this.gdbVersion);return h({url:this._url.path+"/query",content:a,callbackParamName:"callback",load:function(a,f){d(a,f,b,c,g.dfd)},error:function(a){n(a,c,g.dfd)},callbackSuffix:f},this.requestOptions)},executeRelationshipQuery:function(a,
b,c){a=this._encode(l.mixin({},this._url.query,{f:"json"},a.toJson()));var f=this._relationshipQueryHandler,g=this._errorHandler;this.gdbVersion&&(a.gdbVersion=this.gdbVersion);var d=new q(e._dfdCanceller);d._pendingDfd=h({url:this._url.path+"/queryRelatedRecords",content:a,callbackParamName:"callback",load:function(a,g){f(a,g,b,c,d)},error:function(a){g(a,c,d)}},this.requestOptions);return d},executeForIds:function(a,b,c,f){var g=f.assembly;a=this._encode(l.mixin({},this._url.query,{f:"json",returnIdsOnly:!0},
a.toJson(g&&g[0])));var e=this._executeForIdsHandler,d=this._errorHandler;this.source&&(g={source:this.source.toJson()},a.layer=k.toJson(g));this.gdbVersion&&(a.gdbVersion=this.gdbVersion);return h({url:this._url.path+"/query",content:a,callbackParamName:"callback",load:function(a,g){e(a,g,b,c,f.dfd)},error:function(a){d(a,c,f.dfd)}},this.requestOptions)},executeForCount:function(a,b,c,f){var g=f.assembly;a=this._encode(l.mixin({},this._url.query,{f:"json",returnIdsOnly:!0,returnCountOnly:!0},a.toJson(g&&
g[0])));var e=this._countHandler,d=this._errorHandler;this.source&&(g={source:this.source.toJson()},a.layer=k.toJson(g));this.gdbVersion&&(a.gdbVersion=this.gdbVersion);return h({url:this._url.path+"/query",content:a,callbackParamName:"callback",load:function(a,g){e(a,g,b,c,f.dfd)},error:function(a){d(a,c,f.dfd)}},this.requestOptions)},executeForExtent:function(a,b,c,f){var g=f.assembly;a=this._encode(l.mixin({},this._url.query,{f:"json",returnExtentOnly:!0,returnCountOnly:!0},a.toJson(g&&g[0])));
var e=this._extentHandler,d=this._errorHandler;this.source&&(g={source:this.source.toJson()},a.layer=k.toJson(g));this.gdbVersion&&(a.gdbVersion=this.gdbVersion);return h({url:this._url.path+"/query",content:a,callbackParamName:"callback",load:function(a,g){e(a,g,b,c,f.dfd)},error:function(a){d(a,c,f.dfd)}},this.requestOptions)},_handler:function(a,b,c,f,e){try{var h=new g(a);this._successHandler([h],"onComplete",c,e)}catch(w){this._errorHandler(w,f,e)}},_relationshipQueryHandler:function(a,b,c,f,
e){try{var h=a.geometryType,n=a.spatialReference,t={};d.forEach(a.relatedRecordGroups,function(a){var b={};b.geometryType=h;b.spatialReference=n;b.features=a.relatedRecords;b=new g(b);if(null!=a.objectId)t[a.objectId]=b;else for(var c in a)a.hasOwnProperty(c)&&"relatedRecords"!==c&&(t[a[c]]=b)});this._successHandler([t],"onExecuteRelationshipQueryComplete",c,e)}catch(A){this._errorHandler(A,f,e)}},_executeForIdsHandler:function(a,b,c,f,g){try{this._successHandler([a.objectIds],"onExecuteForIdsComplete",
c,g)}catch(x){this._errorHandler(x,f,g)}},_countHandler:function(a,b,c,f,g){try{var e,h=a.features,d=a.objectIds;if(d)e=d.length;else{if(h)throw Error("Unable to perform query. Please check your parameters.");e=a.count}this._successHandler([e],"onExecuteForCountComplete",c,g)}catch(A){this._errorHandler(A,f,g)}},_extentHandler:function(a,b,g,f,e){try{a.extent&&(a.extent=new c(a.extent)),this._successHandler([a],"onExecuteForExtentComplete",g,e)}catch(x){this._errorHandler(x,f,e)}}});b._createWrappers(r);
return r})},"esri/tasks/Task":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/json dojo/has ../kernel ../deferredUtils ../urlUtils ../Evented".split(" "),function(r,l,d,q,k,m,p,h){return r(h,{declaredClass:"esri.tasks._Task",_eventMap:{error:["error"],complete:["result"]},constructor:function(e,c){e&&l.isString(e)&&(this._url=p.urlToObject(this.url=e));c&&c.requestOptions&&(this.requestOptions=c.requestOptions);this.normalization=!0;this._errorHandler=l.hitch(this,this._errorHandler);
this.registerConnectEvents()},_useSSL:function(){var e=this._url,c=/^http:/i;this.url&&(this.url=this.url.replace(c,"https:"));e&&e.path&&(e.path=e.path.replace(c,"https:"))},_encode:function(e,c,b){var a,g,h={},n,t;for(n in e)if("declaredClass"!==n&&(a=e[n],g=typeof a,null!==a&&void 0!==a&&"function"!==g))if(l.isArray(a))for(h[n]=[],t=a.length,g=0;g<t;g++)h[n][g]=this._encode(a[g]);else"object"===g?a.toJson&&(g=a.toJson(b&&b[n]),"esri.tasks.FeatureSet"===a.declaredClass&&g.spatialReference&&(g.sr=
g.spatialReference,delete g.spatialReference),h[n]=c?g:d.toJson(g)):h[n]=a;return h},_successHandler:function(e,c,b,a){c&&this[c].apply(this,e);b&&b.apply(null,e);a&&m._resDfd(a,e)},_errorHandler:function(e,c,b){this.onError(e);c&&c(e);b&&b.errback(e)},setNormalization:function(e){this.normalization=e},onError:function(){}})})},"esri/tasks/FeatureSet":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/has ../kernel ../lang ../graphic ../SpatialReference ../graphicsUtils ../geometry/jsonUtils ../symbols/jsonUtils".split(" "),
function(r,l,d,q,k,m,p,h,e,c,b){return r(null,{declaredClass:"esri.tasks.FeatureSet",constructor:function(a){if(a){l.mixin(this,a);var g=this.features,e=a.spatialReference,n=c.getGeometryType(a.geometryType),e=this.spatialReference=new h(e);this.geometryType=a.geometryType;a.fields&&(this.fields=a.fields);d.forEach(g,function(a,c){var f=a.geometry&&a.geometry.spatialReference;g[c]=new p(n&&a.geometry?new n(a.geometry):null,a.symbol&&b.fromJson(a.symbol),a.attributes);g[c].geometry&&!f&&g[c].geometry.setSpatialReference(e)});
this._hydrate()}else this.features=[]},displayFieldName:null,geometryType:null,spatialReference:null,fieldAliases:null,toJson:function(a){var b={};this.displayFieldName&&(b.displayFieldName=this.displayFieldName);this.fields&&(b.fields=this.fields);this.spatialReference?b.spatialReference=this.spatialReference.toJson():this.features[0]&&this.features[0].geometry&&(b.spatialReference=this.features[0].geometry.spatialReference.toJson());this.features[0]&&(this.features[0].geometry&&(b.geometryType=
c.getJsonType(this.features[0].geometry)),b.features=e._encodeGraphics(this.features,a));b.exceededTransferLimit=this.exceededTransferLimit;b.transform=this.transform;return m.fixJson(b)},_hydrate:function(){var a=this.transform,b=this.geometryType;if(a&&b)for(var c=this.features,e=a.translate[0],h=a.translate[1],f=a.scale[0],d=a.scale[1],k=function(a,b,c){if("esriGeometryPoint"===a)return function(a){a.x=b(a.x);a.y=c(a.y)};if("esriGeometryPolyline"===a||"esriGeometryPolygon"===a)return function(a){a=
a.rings||a.paths;var f,g,e,h,d,n,t,u;f=0;for(g=a.length;f<g;f++)for(d=a[f],e=0,h=d.length;e<h;e++)n=d[e],0<e?(t+=n[0],u+=n[1]):(t=n[0],u=n[1]),n[0]=b(t),n[1]=c(u)};if("esriGeometryEnvelope"===a)return function(a){a.xmin=b(a.xmin);a.ymin=c(a.ymin);a.xmax=b(a.xmax);a.ymax=c(a.ymax)};if("esriGeometryMultipoint"===a)return function(a){a=a.points;var f,g,e,h,d;f=0;for(g=a.length;f<g;f++)e=a[f],0<f?(h+=e[0],d+=e[1]):(h=e[0],d=e[1]),e[0]=b(h),e[1]=c(d)}}(b,function(a){return a*f+e},function(a){return h-
a*d}),a=0,b=c.length;a<b;a++)c[a].geometry&&k(c[a].geometry);this.transform=null},quantize:function(a){if(!this.geometryType)return this.transform=null,this;var b=a.translate[0],c=a.translate[1],e=a.scale[0],h=a.scale[1],f=this.features,d=function(a,b,c){var f,g,e,h,d,n,t=[];f=0;for(g=a.length;f<g;f++)if(e=a[f],0<f){if(n=b(e[0]),e=c(e[1]),n!==h||e!==d)t.push([n-h,e-d]),h=n,d=e}else h=b(e[0]),d=c(e[1]),t.push([h,d]);return 0<t.length?t:null},k=function(a,b,c){if("esriGeometryPoint"===a)return function(a){a.x=
b(a.x);a.y=c(a.y);return a};if("esriGeometryPolyline"===a||"esriGeometryPolygon"===a)return function(a){var f,g,e,h,n;e=a.rings||a.paths;n=[];f=0;for(g=e.length;f<g;f++)h=e[f],(h=d(h,b,c))&&n.push(h);return 0<n.length?(a.rings?a.rings=n:a.paths=n,a):null};if("esriGeometryMultipoint"===a)return function(a){var f;f=d(a.points,b,c);return 0<f.length?(a.points=f,a):null};if("esriGeometryEnvelope"===a)return function(a){return a}}(this.geometryType,function(a){return Math.round((a-b)/e)},function(a){return Math.round((c-
a)/h)}),m,l;m=0;for(l=f.length;m<l;m++)f[m].geometry&&(k(f[m].geometry)||f[m].setGeometry(null));this.transform=a;return this}})})},"esri/graphicsUtils":function(){define(["dojo/_base/lang","dojo/_base/array","dojo/has","./kernel","./geometry/Extent"],function(r,l,d,q,k){return{graphicsExtent:function(d){if(!d||!d.length)return null;var m=d[0].geometry,h=m.getExtent(),e,c,b=d.length;null===h&&(h=new k(m.x,m.y,m.x,m.y,m.spatialReference));for(c=1;c<b;c++)e=(m=d[c].geometry).getExtent(),null===e&&(e=
new k(m.x,m.y,m.x,m.y,m.spatialReference)),h=h.union(e);return 0>h.getWidth()&&0>h.getHeight()?null:h},getGeometries:function(d){return l.map(d,function(d){return d.geometry})},_encodeGraphics:function(d,k){var h=[],e,c,b;l.forEach(d,function(a,g){e=a.toJson();c={};e.geometry&&(b=k&&k[g],c.geometry=b&&b.toJson()||e.geometry);e.attributes&&(c.attributes=e.attributes);h[g]=c});return h}}})},"esri/tasks/RelationshipQuery":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/_base/json","dojo/has",
"../kernel"],function(r,l,d,q,k){return r(null,{declaredClass:"esri.tasks.RelationshipQuery",definitionExpression:"",relationshipId:null,returnGeometry:!1,objectIds:null,outSpatialReference:null,outFields:null,toJson:function(){var k={definitionExpression:this.definitionExpression,relationshipId:this.relationshipId,returnGeometry:this.returnGeometry,maxAllowableOffset:this.maxAllowableOffset,geometryPrecision:this.geometryPrecision},l=this.objectIds,h=this.outFields,e=this.outSpatialReference;l&&
(k.objectIds=l.join(","));h&&(k.outFields=h.join(","));e&&(k.outSR=e.wkid||d.toJson(e.toJson()));k._ts=this._ts;return k}})})},"esri/tasks/StatisticDefinition":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/has","../kernel"],function(r,l,d,q){return r(null,{declaredClass:"esri.tasks.StatisticDefinition",toJson:function(){return{statisticType:this.statisticType,onStatisticField:this.onStatisticField,outStatisticFieldName:this.outStatisticFieldName,maxPointCount:this.maxPointCount,
maxRecordCount:this.maxRecordCount,maxVertexCount:this.maxVertexCount}}})})},"esri/dijit/PopupRenderer":function(){define("require dojo/_base/declare dojo/_base/connect dojo/_base/lang dojo/_base/array dojo/_base/kernel dojo/sniff dojo/query dojo/dom dojo/dom-attr dojo/dom-class dojo/dom-construct dojo/dom-style dojox/html/entities dijit/_Widget dijit/_Templated ../kernel ../urlUtils ./_EventedWidget dojo/i18n!../nls/jsapi dojo/NodeList-dom".split(" "),function(r,l,d,q,k,m,p,h,e,c,b,a,g,u,n,t,f,v,
x,w){var z=0;return l([x,n,t],{declaredClass:"esri.dijit._PopupRenderer",constructor:function(){this._nls=q.mixin({},w.widgets.popup)},templateString:"\x3cdiv class\x3d'esriViewPopup'\x3e\x3cdiv class\x3d'mainSection'\x3e\x3cdiv class\x3d'header' dojoAttachPoint\x3d'_title'\x3e\x3c/div\x3e\x3cdiv class\x3d'hzLine'\x3e\x3c/div\x3e\x3cdiv dojoAttachPoint\x3d'_description'\x3e\x3c/div\x3e\x3cdiv class\x3d'break'\x3e\x3c/div\x3e\x3c/div\x3e\x3cdiv class\x3d'attachmentsSection hidden'\x3e\x3cdiv\x3e${_nls.NLS_attach}:\x3c/div\x3e\x3cul dojoAttachPoint\x3d'_attachmentsList'\x3e\x3c/ul\x3e\x3cdiv class\x3d'break'\x3e\x3c/div\x3e\x3c/div\x3e\x3cdiv class\x3d'mediaSection hidden'\x3e\x3cdiv class\x3d'header' dojoAttachPoint\x3d'_mediaTitle'\x3e\x3c/div\x3e\x3cdiv class\x3d'hzLine'\x3e\x3c/div\x3e\x3cdiv class\x3d'caption' dojoAttachPoint\x3d'_mediaCaption'\x3e\x3c/div\x3e\x3cdiv class\x3d'gallery' dojoAttachPoint\x3d'_gallery'\x3e\x3cdiv class\x3d'mediaHandle prev' dojoAttachPoint\x3d'_prevMedia' dojoAttachEvent\x3d'onclick: _goToPrevMedia'\x3e\x3c/div\x3e\x3cdiv class\x3d'mediaHandle next' dojoAttachPoint\x3d'_nextMedia' dojoAttachEvent\x3d'onclick: _goToNextMedia'\x3e\x3c/div\x3e\x3cul class\x3d'summary'\x3e\x3cli class\x3d'image mediaCount hidden' dojoAttachPoint\x3d'_imageCount'\x3e0\x3c/li\x3e\x3cli class\x3d'image mediaIcon hidden'\x3e\x3c/li\x3e\x3cli class\x3d'chart mediaCount hidden' dojoAttachPoint\x3d'_chartCount'\x3e0\x3c/li\x3e\x3cli class\x3d'chart mediaIcon hidden'\x3e\x3c/li\x3e\x3c/ul\x3e\x3cdiv class\x3d'frame' dojoAttachPoint\x3d'_mediaFrame'\x3e\x3c/div\x3e\x3c/div\x3e\x3c/div\x3e\x3cdiv class\x3d'editSummarySection hidden' dojoAttachPoint\x3d'_editSummarySection'\x3e\x3cdiv class\x3d'break'\x3e\x3c/div\x3e\x3cdiv class\x3d'break hidden' dojoAttachPoint\x3d'_mediaBreak'\x3e\x3c/div\x3e\x3cdiv class\x3d'editSummary' dojoAttachPoint\x3d'_editSummary'\x3e\x3c/div\x3e\x3c/div\x3e\x3c/div\x3e",
showTitle:!0,startup:function(){this.inherited(arguments);this.template.getComponents(this.graphic).then(q.hitch(this,this._handleComponentsSuccess),q.hitch(this,this._handleComponentsError))},destroy:function(){this._dfd&&this._dfd.cancel();this._destroyFrame();this.template=this.graphic=this._nls=this._mediaInfos=this._mediaPtr=this._dfd=null;this.inherited(arguments)},_goToPrevMedia:function(){0>this._mediaPtr-1||(this._mediaPtr--,this._updateUI(),this._displayMedia())},_goToNextMedia:function(){this._mediaPtr+
1!==this._mediaInfos.length&&(this._mediaPtr++,this._updateUI(),this._displayMedia())},_updateUI:function(){var a=this._mediaInfos,f=a.length,g=this.domNode,e=this._prevMedia,h=this._nextMedia;if(1<f){var d=0,n=0;k.forEach(a,function(a){"image"===a.type?d++:-1!==a.type.indexOf("chart")&&n++});d&&(c.set(this._imageCount,"innerHTML",d),m.query(".summary .image",g).removeClass("hidden"));n&&(c.set(this._chartCount,"innerHTML",n),m.query(".summary .chart",g).removeClass("hidden"))}else m.query(".summary",
g).addClass("hidden"),b.add(e,"hidden"),b.add(h,"hidden");a=this._mediaPtr;0===a?b.add(e,"hidden"):b.remove(e,"hidden");a===f-1?b.add(h,"hidden"):b.remove(h,"hidden");this._destroyFrame()},_displayMedia:function(){var a=this._mediaInfos[this._mediaPtr],f=a.title,g=a.caption,e=m.query(".mediaSection .hzLine",this.domNode)[0];c.set(this._mediaTitle,"innerHTML",f);b[f?"remove":"add"](this._mediaTitle,"hidden");c.set(this._mediaCaption,"innerHTML",g);b[g?"remove":"add"](this._mediaCaption,"hidden");b[f&&
g?"remove":"add"](e,"hidden");this._rid=null;if("image"===a.type)this._showImage(a.value);else{var h=this,f=["dojox/charting/Chart2D","dojox/charting/action2d/Tooltip"],g=a.value.theme||this.chartTheme;q.isString(g)&&(g=g.replace(/\./gi,"/"),-1===g.indexOf("/")&&(g="dojox/charting/themes/"+g));g||(g="./Rainbow");f.push(g);try{var d=this._rid=z++;r(f,function(b,c,f){d===h._rid&&(h._rid=null,h._showChart(a.type,a.value,b,c,f))})}catch(F){console.log("PopupRenderer: error loading modules")}}},_preventNewTab:function(a){return(a=
a&&q.trim(a).toLowerCase())&&(0===a.indexOf("mailto:")||0===a.indexOf("tel:"))},_showImage:function(c){b.add(this._mediaFrame,"image");var f=g.get(this._gallery,"height"),e;c.linkURL&&(e=a.create("a",{href:c.linkURL,target:this._preventNewTab(c.linkURL)?"":"_blank"},this._mediaFrame));a.create("img",{className:"esriPopupMediaImage",src:c.sourceURL},e||this._mediaFrame);var h=m.query(".esriPopupMediaImage",this._mediaFrame)[0],n=this,t;t=d.connect(h,"onload",function(){d.disconnect(t);t=null;n._imageLoaded(h,
f)})},_showChart:function(c,f,g,e,h){b.remove(this._mediaFrame,"image");g=this._chart=new g(a.create("div",{"class":"chart"},this._mediaFrame),{margins:{l:4,t:4,r:4,b:4}});h&&g.setTheme(h);switch(c){case "piechart":g.addPlot("default",{type:"Pie",labels:!1});g.addSeries("Series A",f.fields);break;case "linechart":g.addPlot("default",{type:"Markers"});g.addAxis("x",{min:0,majorTicks:!1,minorTicks:!1,majorLabels:!1,minorLabels:!1});g.addAxis("y",{includeZero:!0,vertical:!0,fixUpper:"minor"});k.forEach(f.fields,
function(a,b){a.x=b+1});g.addSeries("Series A",f.fields);break;case "columnchart":g.addPlot("default",{type:"Columns",gap:3});g.addAxis("y",{includeZero:!0,vertical:!0,fixUpper:"minor"});g.addSeries("Series A",f.fields);break;case "barchart":g.addPlot("default",{type:"Bars",gap:3}),g.addAxis("x",{includeZero:!0,fixUpper:"minor",minorLabels:!1}),g.addAxis("y",{vertical:!0,majorTicks:!1,minorTicks:!1,majorLabels:!1,minorLabels:!1}),g.addSeries("Series A",f.fields)}this._action=new e(g);g.render()},
_destroyFrame:function(){this._rid=null;this._chart&&(this._chart.destroy(),this._chart=null);this._action&&(this._action.destroy(),this._action=null);c.set(this._mediaFrame,"innerHTML","")},_imageLoaded:function(a,b){var c=a.height;c<b&&g.set(a,"marginTop",Math.round((b-c)/2)+"px")},_attListHandler:function(a,b){if(a===this._dfd){this._dfd=null;var f="";b instanceof Error||!b||!b.length||k.forEach(b,function(a){f+="\x3cli\x3e";f+="\x3ca href\x3d'"+v.addProxy(a.url)+"' target\x3d'_blank'\x3e"+(a.name||
"[No name]")+"\x3c/a\x3e";f+="\x3c/li\x3e"});c.set(this._attachmentsList,"innerHTML",f||"\x3cli\x3e"+this._nls.NLS_noAttach+"\x3c/li\x3e")}},_handleComponentsSuccess:function(a){if(a){var f=this.showTitle?a.title:"",g=a.description,h=a.fields,d=a.mediaInfos,n=this.domNode,t=this._nls,l=this,p=this.template,v=this.graphic;this._prevMedia.title=t.NLS_prevMedia;this._nextMedia.title=t.NLS_nextMedia;c.set(this._title,"innerHTML",f);f||b.add(this._title,"hidden");!a.hasDescription&&h&&(g="",k.forEach(h,
function(a){g+="\x3ctr valign\x3d'top'\x3e";g+="\x3ctd class\x3d'attrName'\x3e"+u.encode(a[0])+"\x3c/td\x3e";g+="\x3ctd class\x3d'attrValue'\x3e"+a[1].replace(/^\s*(https?:\/\/[^\s]+)\s*$/i,"\x3ca target\x3d'_blank' href\x3d'$1' title\x3d'$1'\x3e"+t.NLS_moreInfo+"\x3c/a\x3e")+"\x3c/td\x3e";g+="\x3c/tr\x3e"}),g&&(g="\x3ctable class\x3d'attrTable' cellpadding\x3d'0px' cellspacing\x3d'0px'\x3e"+g+"\x3c/table\x3e"));c.set(this._description,"innerHTML",g);g||b.add(this._description,"hidden");m.query("a",
this._description).forEach(function(a){l._preventNewTab(a.href)?"_blank"===a.target&&c.remove(a,"target"):c.set(a,"target","_blank")});f&&g?m.query(".mainSection .hzLine",n).removeClass("hidden"):f||g?m.query(".mainSection .hzLine",n).addClass("hidden"):m.query(".mainSection",n).addClass("hidden");if(f=this._dfd=p.getAttachments(v))f.addBoth(q.hitch(this,this._attListHandler,f)),c.set(this._attachmentsList,"innerHTML","\x3cli\x3e"+t.NLS_searching+"...\x3c/li\x3e"),m.query(".attachmentsSection",n).removeClass("hidden");
d&&d.length&&(m.query(".mediaSection",n).removeClass("hidden"),e.setSelectable(this._mediaFrame,!1),this._mediaInfos=d,this._mediaPtr=0,this._updateUI(),this._displayMedia());a.editSummary&&(c.set(this._editSummary,"innerHTML",a.editSummary),d&&d.length&&b.remove(this._mediaBreak,"hidden"),b.remove(this._editSummarySection,"hidden"))}},_handleComponentsError:function(a){console.log("PopupRenderer: error loading template",a)}})})},"dijit/_Widget":function(){define("dojo/aspect dojo/_base/config dojo/_base/connect dojo/_base/declare dojo/has dojo/_base/kernel dojo/_base/lang dojo/query dojo/ready ./registry ./_WidgetBase ./_OnDijitClickMixin ./_FocusMixin dojo/uacss ./hccss".split(" "),
function(r,l,d,q,k,m,p,h,e,c,b,a,g){function u(){}function n(a){return function(b,c,g,e){return b&&"string"==typeof c&&b[c]==u?b.on(c.substring(2).toLowerCase(),p.hitch(g,e)):a.apply(d,arguments)}}r.around(d,"connect",n);m.connect&&r.around(m,"connect",n);r=q("dijit._Widget",[b,a,g],{onClick:u,onDblClick:u,onKeyDown:u,onKeyPress:u,onKeyUp:u,onMouseDown:u,onMouseMove:u,onMouseOut:u,onMouseOver:u,onMouseLeave:u,onMouseEnter:u,onMouseUp:u,constructor:function(a){this._toConnect={};for(var b in a)this[b]===
u&&(this._toConnect[b.replace(/^on/,"").toLowerCase()]=a[b],delete a[b])},postCreate:function(){this.inherited(arguments);for(var a in this._toConnect)this.on(a,this._toConnect[a]);delete this._toConnect},on:function(a,b){return this[this._onMap(a)]===u?d.connect(this.domNode,a.toLowerCase(),this,b):this.inherited(arguments)},_setFocusedAttr:function(a){this._focused=a;this._set("focused",a)},setAttribute:function(a,b){m.deprecated(this.declaredClass+"::setAttribute(attr, value) is deprecated. Use set() instead.",
"","2.0");this.set(a,b)},attr:function(a,b){return 2<=arguments.length||"object"===typeof a?this.set.apply(this,arguments):this.get(a)},getDescendants:function(){m.deprecated(this.declaredClass+"::getDescendants() is deprecated. Use getChildren() instead.","","2.0");return this.containerNode?h("[widgetId]",this.containerNode).map(c.byNode):[]},_onShow:function(){this.onShow()},onShow:function(){},onHide:function(){},onClose:function(){return!0}});k("dijit-legacy-requires")&&e(0,function(){require(["dijit/_base"])});
return r})},"dijit/_WidgetBase":function(){define("require dojo/_base/array dojo/aspect dojo/_base/config dojo/_base/connect dojo/_base/declare dojo/dom dojo/dom-attr dojo/dom-class dojo/dom-construct dojo/dom-geometry dojo/dom-style dojo/has dojo/_base/kernel dojo/_base/lang dojo/on dojo/ready dojo/Stateful dojo/topic dojo/_base/window ./Destroyable dojo/has!dojo-bidi?./_BidiMixin ./registry".split(" "),function(r,l,d,q,k,m,p,h,e,c,b,a,g,u,n,t,f,v,x,w,z,A,y){function B(a){return function(b){h[b?
"set":"remove"](this.domNode,a,b);this._set(a,b)}}g.add("dijit-legacy-requires",!u.isAsync);g.add("dojo-bidi",!1);g("dijit-legacy-requires")&&f(0,function(){r(["dijit/_base/manager"])});var C={};q=m("dijit._WidgetBase",[v,z],{id:"",_setIdAttr:"domNode",lang:"",_setLangAttr:B("lang"),dir:"",_setDirAttr:B("dir"),"class":"",_setClassAttr:{node:"domNode",type:"class"},_setTypeAttr:null,style:"",title:"",tooltip:"",baseClass:"",srcNodeRef:null,domNode:null,containerNode:null,ownerDocument:null,_setOwnerDocumentAttr:function(a){this._set("ownerDocument",
a)},attributeMap:{},_blankGif:q.blankGif||r.toUrl("dojo/resources/blank.gif"),textDir:"",_introspect:function(){var a=this.constructor;if(!a._setterAttrs){var b=a.prototype,c=a._setterAttrs=[],a=a._onMap={},f;for(f in b.attributeMap)c.push(f);for(f in b)/^on/.test(f)&&(a[f.substring(2).toLowerCase()]=f),/^_set[A-Z](.*)Attr$/.test(f)&&(f=f.charAt(4).toLowerCase()+f.substr(5,f.length-9),b.attributeMap&&f in b.attributeMap||c.push(f))}},postscript:function(a,b){this.create(a,b)},create:function(a,b){this._introspect();
this.srcNodeRef=p.byId(b);this._connects=[];this._supportingWidgets=[];this.srcNodeRef&&this.srcNodeRef.id&&"string"==typeof this.srcNodeRef.id&&(this.id=this.srcNodeRef.id);a&&(this.params=a,n.mixin(this,a));this.postMixInProperties();this.id||(this.id=y.getUniqueId(this.declaredClass.replace(/\./g,"_")),this.params&&delete this.params.id);this.ownerDocument=this.ownerDocument||(this.srcNodeRef?this.srcNodeRef.ownerDocument:document);this.ownerDocumentBody=w.body(this.ownerDocument);y.add(this);
this.buildRendering();var c;if(this.domNode){this._applyAttributes();var f=this.srcNodeRef;f&&f.parentNode&&this.domNode!==f&&(f.parentNode.replaceChild(this.domNode,f),c=!0);this.domNode.setAttribute("widgetId",this.id)}this.postCreate();c&&delete this.srcNodeRef;this._created=!0},_applyAttributes:function(){var a={},b;for(b in this.params||{})a[b]=this._get(b);l.forEach(this.constructor._setterAttrs,function(b){if(!(b in a)){var c=this._get(b);c&&this.set(b,c)}},this);for(b in a)this.set(b,a[b])},
postMixInProperties:function(){},buildRendering:function(){this.domNode||(this.domNode=this.srcNodeRef||this.ownerDocument.createElement("div"));if(this.baseClass){var a=this.baseClass.split(" ");this.isLeftToRight()||(a=a.concat(l.map(a,function(a){return a+"Rtl"})));e.add(this.domNode,a)}},postCreate:function(){},startup:function(){this._started||(this._started=!0,l.forEach(this.getChildren(),function(a){a._started||a._destroyed||!n.isFunction(a.startup)||(a.startup(),a._started=!0)}))},destroyRecursive:function(a){this._beingDestroyed=
!0;this.destroyDescendants(a);this.destroy(a)},destroy:function(a){function b(b){b.destroyRecursive?b.destroyRecursive(a):b.destroy&&b.destroy(a)}this._beingDestroyed=!0;this.uninitialize();l.forEach(this._connects,n.hitch(this,"disconnect"));l.forEach(this._supportingWidgets,b);this.domNode&&l.forEach(y.findWidgets(this.domNode,this.containerNode),b);this.destroyRendering(a);y.remove(this.id);this._destroyed=!0},destroyRendering:function(a){this.bgIframe&&(this.bgIframe.destroy(a),delete this.bgIframe);
this.domNode&&(a?h.remove(this.domNode,"widgetId"):c.destroy(this.domNode),delete this.domNode);this.srcNodeRef&&(a||c.destroy(this.srcNodeRef),delete this.srcNodeRef)},destroyDescendants:function(a){l.forEach(this.getChildren(),function(b){b.destroyRecursive&&b.destroyRecursive(a)})},uninitialize:function(){return!1},_setStyleAttr:function(b){var c=this.domNode;n.isObject(b)?a.set(c,b):c.style.cssText=c.style.cssText?c.style.cssText+("; "+b):b;this._set("style",b)},_attrToDom:function(a,b,c){c=3<=
arguments.length?c:this.attributeMap[a];l.forEach(n.isArray(c)?c:[c],function(c){var f=this[c.node||c||"domNode"];switch(c.type||"attribute"){case "attribute":n.isFunction(b)&&(b=n.hitch(this,b));c=c.attribute?c.attribute:/^on[A-Z][a-zA-Z]*$/.test(a)?a.toLowerCase():a;f.tagName?h.set(f,c,b):f.set(c,b);break;case "innerText":f.innerHTML="";f.appendChild(this.ownerDocument.createTextNode(b));break;case "innerHTML":f.innerHTML=b;break;case "class":e.replace(f,b,this[a]);break;case "toggleClass":e.toggle(f,
c.className||a,b)}},this)},get:function(a){var b=this._getAttrNames(a);return this[b.g]?this[b.g]():this._get(a)},set:function(a,b){if("object"===typeof a){for(var c in a)this.set(c,a[c]);return this}c=this._getAttrNames(a);var f=this[c.s];if(n.isFunction(f))var g=f.apply(this,Array.prototype.slice.call(arguments,1));else{var f=this.focusNode&&!n.isFunction(this.focusNode)?"focusNode":"domNode",e=this[f]&&this[f].tagName,h;if((h=e)&&!(h=C[e])){h=this[f];var d={},t;for(t in h)d[t.toLowerCase()]=!0;
h=C[e]=d}t=h;c=a in this.attributeMap?this.attributeMap[a]:c.s in this?this[c.s]:t&&c.l in t&&"function"!=typeof b||/^aria-|^data-|^role$/.test(a)?f:null;null!=c&&this._attrToDom(a,b,c);this._set(a,b)}return g||this},_attrPairNames:{},_getAttrNames:function(a){var b=this._attrPairNames;if(b[a])return b[a];var c=a.replace(/^[a-z]|-[a-zA-Z]/g,function(a){return a.charAt(a.length-1).toUpperCase()});return b[a]={n:a+"Node",s:"_set"+c+"Attr",g:"_get"+c+"Attr",l:c.toLowerCase()}},_set:function(a,b){var c=
this[a];this[a]=b;!this._created||c===b||c!==c&&b!==b||(this._watchCallbacks&&this._watchCallbacks(a,c,b),this.emit("attrmodified-"+a,{detail:{prevValue:c,newValue:b}}))},_get:function(a){return this[a]},emit:function(a,b,c){b=b||{};void 0===b.bubbles&&(b.bubbles=!0);void 0===b.cancelable&&(b.cancelable=!0);b.detail||(b.detail={});b.detail.widget=this;var f,g=this["on"+a];g&&(f=g.apply(this,c?c:[b]));this._started&&!this._beingDestroyed&&t.emit(this.domNode,a.toLowerCase(),b);return f},on:function(a,
b){var c=this._onMap(a);return c?d.after(this,c,b,!0):this.own(t(this.domNode,a,b))[0]},_onMap:function(a){var b=this.constructor,c=b._onMap;if(!c){var c=b._onMap={},f;for(f in b.prototype)/^on/.test(f)&&(c[f.replace(/^on/,"").toLowerCase()]=f)}return c["string"==typeof a&&a.toLowerCase()]},toString:function(){return"[Widget "+this.declaredClass+", "+(this.id||"NO ID")+"]"},getChildren:function(){return this.containerNode?y.findWidgets(this.containerNode):[]},getParent:function(){return y.getEnclosingWidget(this.domNode.parentNode)},
connect:function(a,b,c){return this.own(k.connect(a,b,this,c))[0]},disconnect:function(a){a.remove()},subscribe:function(a,b){return this.own(x.subscribe(a,n.hitch(this,b)))[0]},unsubscribe:function(a){a.remove()},isLeftToRight:function(){return this.dir?"ltr"==this.dir.toLowerCase():b.isBodyLtr(this.ownerDocument)},isFocusable:function(){return this.focus&&"none"!=a.get(this.domNode,"display")},placeAt:function(a,b){var f=!a.tagName&&y.byId(a);!f||!f.addChild||b&&"number"!==typeof b?(f=f&&"domNode"in
f?f.containerNode&&!/after|before|replace/.test(b||"")?f.containerNode:f.domNode:p.byId(a,this.ownerDocument),c.place(this.domNode,f,b),!this._started&&(this.getParent()||{})._started&&this.startup()):f.addChild(this,b);return this},defer:function(a,b){var c=setTimeout(n.hitch(this,function(){c&&(c=null,this._destroyed||n.hitch(this,a)())}),b||0);return{remove:function(){c&&(clearTimeout(c),c=null);return null}}}});g("dojo-bidi")&&q.extend(A);return q})},"dijit/Destroyable":function(){define(["dojo/_base/array",
"dojo/aspect","dojo/_base/declare"],function(r,l,d){return d("dijit.Destroyable",null,{destroy:function(d){this._destroyed=!0},own:function(){var d=["destroyRecursive","destroy","remove"];r.forEach(arguments,function(k){function m(){h.remove();r.forEach(e,function(c){c.remove()})}var p,h=l.before(this,"destroy",function(c){k[p](c)}),e=[];k.then?(p="cancel",k.then(m,m)):r.forEach(d,function(c){"function"===typeof k[c]&&(p||(p=c),e.push(l.after(k,c,m,!0)))})},this);return arguments}})})},"dijit/_OnDijitClickMixin":function(){define("dojo/on dojo/_base/array dojo/keys dojo/_base/declare dojo/has ./a11yclick".split(" "),
function(r,l,d,q,k,m){r=q("dijit._OnDijitClickMixin",null,{connect:function(d,h,e){return this.inherited(arguments,[d,"ondijitclick"==h?m:h,e])}});r.a11yclick=m;return r})},"dijit/_FocusMixin":function(){define(["./focus","./_WidgetBase","dojo/_base/declare","dojo/_base/lang"],function(r,l,d,q){q.extend(l,{focused:!1,onFocus:function(){},onBlur:function(){},_onFocus:function(){this.onFocus()},_onBlur:function(){this.onBlur()}});return d("dijit._FocusMixin",null,{_focusManager:r})})},"dijit/hccss":function(){define(["dojo/dom-class",
"dojo/hccss","dojo/domReady","dojo/_base/window"],function(r,l,d,q){d(function(){l("highcontrast")&&r.add(q.body(),"dijit_a11y")});return l})},"dojo/hccss":function(){define("require ./_base/config ./dom-class ./dom-style ./has ./domReady ./_base/window".split(" "),function(r,l,d,q,k,m,p){k.add("highcontrast",function(){var h=p.doc.createElement("div");try{h.style.cssText='border: 1px solid; border-color:red green; position: absolute; height: 5px; top: -999px;background-image: url("'+(l.blankGif||
r.toUrl("./resources/blank.gif"))+'");';p.body().appendChild(h);var e=q.getComputedStyle(h),c=e.backgroundImage;return e.borderTopColor==e.borderRightColor||c&&("none"==c||"url(invalid-url:)"==c)}catch(b){return console.warn("hccss: exception detecting high-contrast mode, document is likely hidden: "+b.toString()),!1}finally{8>=k("ie")?h.outerHTML="":p.body().removeChild(h)}});m(function(){k("highcontrast")&&d.add(p.body(),"dj_a11y")});return k})},"dijit/_Templated":function(){define("./_WidgetBase ./_TemplatedMixin ./_WidgetsInTemplateMixin dojo/_base/array dojo/_base/declare dojo/_base/lang dojo/_base/kernel".split(" "),
function(r,l,d,q,k,m,p){m.extend(r,{waiRole:"",waiState:""});return k("dijit._Templated",[l,d],{constructor:function(){p.deprecated(this.declaredClass+": dijit._Templated deprecated, use dijit._TemplatedMixin and if necessary dijit._WidgetsInTemplateMixin","","2.0")},_processNode:function(h,e){var c=this.inherited(arguments),b=e(h,"waiRole");b&&h.setAttribute("role",b);(b=e(h,"waiState"))&&q.forEach(b.split(/\s*,\s*/),function(a){-1!=a.indexOf("-")&&(a=a.split("-"),h.setAttribute("aria-"+a[0],a[1]))});
return c}})})},"dijit/_TemplatedMixin":function(){define("dojo/cache dojo/_base/declare dojo/dom-construct dojo/_base/lang dojo/on dojo/sniff dojo/string ./_AttachMixin".split(" "),function(r,l,d,q,k,m,p,h){var e=l("dijit._TemplatedMixin",h,{templateString:null,templatePath:null,_skipNodeCache:!1,searchContainerNode:!0,_stringRepl:function(c){var b=this.declaredClass,a=this;return p.substitute(c,this,function(c,e){"!"==e.charAt(0)&&(c=q.getObject(e.substr(1),!1,a));if("undefined"==typeof c)throw Error(b+
" template:"+e);return null==c?"":"!"==e.charAt(0)?c:this._escapeValue(""+c)},this)},_escapeValue:function(c){return c.replace(/["'<>&]/g,function(b){return{"\x26":"\x26amp;","\x3c":"\x26lt;","\x3e":"\x26gt;",'"':"\x26quot;","'":"\x26#x27;"}[b]})},buildRendering:function(){if(!this._rendered){this.templateString||(this.templateString=r(this.templatePath,{sanitize:!0}));var c=e.getCachedTemplate(this.templateString,this._skipNodeCache,this.ownerDocument),b;if(q.isString(c)){if(b=d.toDom(this._stringRepl(c),
this.ownerDocument),1!=b.nodeType)throw Error("Invalid template: "+c);}else b=c.cloneNode(!0);this.domNode=b}this.inherited(arguments);this._rendered||this._fillContent(this.srcNodeRef);this._rendered=!0},_fillContent:function(c){var b=this.containerNode;if(c&&b)for(;c.hasChildNodes();)b.appendChild(c.firstChild)}});e._templateCache={};e.getCachedTemplate=function(c,b,a){var g=e._templateCache,h=c,n=g[h];if(n){try{if(!n.ownerDocument||n.ownerDocument==(a||document))return n}catch(t){}d.destroy(n)}c=
p.trim(c);if(b||c.match(/\$\{([^\}]+)\}/g))return g[h]=c;b=d.toDom(c,a);if(1!=b.nodeType)throw Error("Invalid template: "+c);return g[h]=b};m("ie")&&k(window,"unload",function(){var c=e._templateCache,b;for(b in c){var a=c[b];"object"==typeof a&&d.destroy(a);delete c[b]}});return e})},"dojo/cache":function(){define(["./_base/kernel","./text"],function(r){return r.cache})},"dojo/text":function(){define(["./_base/kernel","require","./has","./request"],function(r,l,d,q){var k;k=function(c,b,a){q(c,{sync:!!b,
headers:{"X-Requested-With":null}}).then(a)};var m={},p=function(c){if(c){c=c.replace(/^\s*<\?xml(\s)+version=[\'\"](\d)*.(\d)*[\'\"](\s)*\?>/im,"");var b=c.match(/<body[^>]*>\s*([\s\S]+)\s*<\/body>/im);b&&(c=b[1])}else c="";return c},h={},e={};r.cache=function(c,b,a){var g;"string"==typeof c?/\//.test(c)?(g=c,a=b):g=l.toUrl(c.replace(/\./g,"/")+(b?"/"+b:"")):(g=c+"",a=b);c=void 0!=a&&"string"!=typeof a?a.value:a;a=a&&a.sanitize;if("string"==typeof c)return m[g]=c,a?p(c):c;if(null===c)return delete m[g],
null;g in m||k(g,!0,function(a){m[g]=a});return a?p(m[g]):m[g]};return{dynamic:!0,normalize:function(c,b){var a=c.split("!"),g=a[0];return(/^\./.test(g)?b(g):g)+(a[1]?"!"+a[1]:"")},load:function(c,b,a){c=c.split("!");var g=1<c.length,d=c[0],n=b.toUrl(c[0]);c="url:"+n;var t=h,f=function(b){a(g?p(b):b)};d in m?t=m[d]:b.cache&&c in b.cache?t=b.cache[c]:n in m&&(t=m[n]);if(t===h)if(e[n])e[n].push(f);else{var l=e[n]=[f];k(n,!b.async,function(a){m[d]=m[n]=a;for(var b=0;b<l.length;)l[b++](a);delete e[n]})}else f(t)}}})},
"dojo/request":function(){define(["./request/default!"],function(r){return r})},"dojo/request/default":function(){define(["exports","require","../has"],function(r,l,d){var q=d("config-requestProvider");q||(q="./xhr");r.getPlatformDefaultId=function(){return"./xhr"};r.load=function(d,m,p,h){l(["platform"==d?"./xhr":q],function(e){p(e)})}})},"dijit/_AttachMixin":function(){define("require dojo/_base/array dojo/_base/connect dojo/_base/declare dojo/_base/lang dojo/mouse dojo/on dojo/touch ./_WidgetBase".split(" "),
function(r,l,d,q,k,m,p,h,e){var c=k.delegate(h,{mouseenter:m.enter,mouseleave:m.leave,keypress:d._keypress}),b;d=q("dijit._AttachMixin",null,{constructor:function(){this._attachPoints=[];this._attachEvents=[]},buildRendering:function(){this.inherited(arguments);this._attachTemplateNodes(this.domNode);this._beforeFillContent()},_beforeFillContent:function(){},_attachTemplateNodes:function(a){for(var b=a;;)if(1==b.nodeType&&(this._processTemplateNode(b,function(a,b){return a.getAttribute(b)},this._attach)||
this.searchContainerNode)&&b.firstChild)b=b.firstChild;else{if(b==a)break;for(;!b.nextSibling;)if(b=b.parentNode,b==a)return;b=b.nextSibling}},_processTemplateNode:function(a,b,c){var g=!0,e=this.attachScope||this,f=b(a,"dojoAttachPoint")||b(a,"data-dojo-attach-point");if(f)for(var h=f.split(/\s*,\s*/);f=h.shift();)k.isArray(e[f])?e[f].push(a):e[f]=a,g="containerNode"!=f,this._attachPoints.push(f);if(b=b(a,"dojoAttachEvent")||b(a,"data-dojo-attach-event"))for(f=b.split(/\s*,\s*/),h=k.trim;b=f.shift();)if(b){var d=
null;-1!=b.indexOf(":")?(d=b.split(":"),b=h(d[0]),d=h(d[1])):b=h(b);d||(d=b);this._attachEvents.push(c(a,b,k.hitch(e,d)))}return g},_attach:function(a,g,e){g=g.replace(/^on/,"").toLowerCase();g="dijitclick"==g?b||(b=r("./a11yclick")):c[g]||g;return p(a,g,e)},_detachTemplateNodes:function(){var a=this.attachScope||this;l.forEach(this._attachPoints,function(b){delete a[b]});this._attachPoints=[];l.forEach(this._attachEvents,function(a){a.remove()});this._attachEvents=[]},destroyRendering:function(){this._detachTemplateNodes();
this.inherited(arguments)}});k.extend(e,{dojoAttachEvent:"",dojoAttachPoint:""});return d})},"dijit/_WidgetsInTemplateMixin":function(){define(["dojo/_base/array","dojo/aspect","dojo/_base/declare","dojo/_base/lang","dojo/parser"],function(r,l,d,q,k){return d("dijit._WidgetsInTemplateMixin",null,{_earlyTemplatedStartup:!1,contextRequire:null,_beforeFillContent:function(){if(/dojoType|data-dojo-type/i.test(this.domNode.innerHTML)){var d=this.domNode;this.containerNode&&!this.searchContainerNode&&(this.containerNode.stopParser=
!0);k.parse(d,{noStart:!this._earlyTemplatedStartup,template:!0,inherited:{dir:this.dir,lang:this.lang,textDir:this.textDir},propsThis:this,contextRequire:this.contextRequire,scope:"dojo"}).then(q.hitch(this,function(d){this._startupWidgets=d;for(var h=0;h<d.length;h++)this._processTemplateNode(d[h],function(e,c){return e[c]},function(e,c,b){return c in e?e.connect(e,c,b):e.on(c,b,!0)});this.containerNode&&this.containerNode.stopParser&&delete this.containerNode.stopParser}));if(!this._startupWidgets)throw Error(this.declaredClass+
": parser returned unfilled promise (probably waiting for module auto-load), unsupported by _WidgetsInTemplateMixin.   Must pre-load all supporting widgets before instantiation.");}},_processTemplateNode:function(d,k,h){return k(d,"dojoType")||k(d,"data-dojo-type")?!0:this.inherited(arguments)},startup:function(){r.forEach(this._startupWidgets,function(d){d&&!d._started&&d.startup&&d.startup()});this._startupWidgets=null;this.inherited(arguments)}})})},"dojo/parser":function(){define("require ./_base/kernel ./_base/lang ./_base/array ./_base/config ./dom ./_base/window ./_base/url ./aspect ./promise/all ./date/stamp ./Deferred ./has ./query ./on ./ready".split(" "),
function(r,l,d,q,k,m,p,h,e,c,b,a,g,u,n,t){function f(a){return eval("("+a+")")}function v(a){var b=a._nameCaseMap,c=a.prototype;if(!b||b._extendCnt<w){var b=a._nameCaseMap={},f;for(f in c)"_"!==f.charAt(0)&&(b[f.toLowerCase()]=f);b._extendCnt=w}return b}function x(a,b){b||(b=r);var c=b._dojoParserCtorMap||(b._dojoParserCtorMap={}),f=a.join();if(!c[f]){for(var g=[],e=0,h=a.length;e<h;e++){var n=a[e];g[g.length]=c[n]=c[n]||d.getObject(n)||~n.indexOf("/")&&b(n)}e=g.shift();c[f]=g.length?e.createSubclass?
e.createSubclass(g):e.extend.apply(e,g):e}return c[f]}new Date("X");var w=0;e.after(d,"extend",function(){w++},!0);var z={_clearCache:function(){w++;_ctorMap={}},_functionFromScript:function(a,b){var c="",f="",g=a.getAttribute(b+"args")||a.getAttribute("args"),e=a.getAttribute("with"),g=(g||"").split(/\s*,\s*/);e&&e.length&&q.forEach(e.split(/\s*,\s*/),function(a){c+="with("+a+"){";f+="}"});return new Function(g,c+a.innerHTML+f)},instantiate:function(a,b,c){b=b||{};c=c||{};var f=(c.scope||l._scopeName)+
"Type",g="data-"+(c.scope||l._scopeName)+"-",e=g+"type",h=g+"mixins",d=[];q.forEach(a,function(a){var c=f in b?b[f]:a.getAttribute(e)||a.getAttribute(f);if(c){var g=a.getAttribute(h),c=g?[c].concat(g.split(/\s*,\s*/)):[c];d.push({node:a,types:c})}});return this._instantiate(d,b,c)},_instantiate:function(a,b,f,g){function e(a){b._started||f.noStart||q.forEach(a,function(a){"function"!==typeof a.startup||a._started||a.startup()});return a}a=q.map(a,function(a){var c=a.ctor||x(a.types,f.contextRequire);
if(!c)throw Error("Unable to resolve constructor for: '"+a.types.join()+"'");return this.construct(c,a.node,b,f,a.scripts,a.inherited)},this);return g?c(a).then(e):e(a)},construct:function(a,c,t,k,m,p){function w(a){D&&d.setObject(D,a);for(B=0;B<U.length;B++)e[U[B].advice||"after"](a,U[B].method,d.hitch(a,U[B].func),!0);for(B=0;B<ia.length;B++)ia[B].call(a);for(B=0;B<Y.length;B++)a.watch(Y[B].prop,Y[B].func);for(B=0;B<ca.length;B++)n(a,ca[B].event,ca[B].func);return a}var x=a&&a.prototype;k=k||{};
var z={};k.defaults&&d.mixin(z,k.defaults);p&&d.mixin(z,p);var A;g("dom-attributes-explicit")?A=c.attributes:g("dom-attributes-specified-flag")?A=q.filter(c.attributes,function(a){return a.specified}):(p=(/^input$|^img$/i.test(c.nodeName)?c:c.cloneNode(!1)).outerHTML.replace(/=[^\s"']+|="[^"]*"|='[^']*'/g,"").replace(/^\s*<[a-zA-Z0-9]*\s*/,"").replace(/\s*>.*$/,""),A=q.map(p.split(/\s+/),function(a){var b=a.toLowerCase();return{name:a,value:"LI"==c.nodeName&&"value"==a||"enctype"==b?c.getAttribute(b):
c.getAttributeNode(b).value}}));var y=k.scope||l._scopeName;p="data-"+y+"-";var r={};"dojo"!==y&&(r[p+"props"]="data-dojo-props",r[p+"type"]="data-dojo-type",r[p+"mixins"]="data-dojo-mixins",r[y+"type"]="dojotype",r[p+"id"]="data-dojo-id");for(var B=0,C,y=[],D,E;C=A[B++];){var O=C.name,Q=O.toLowerCase();C=C.value;switch(r[Q]||Q){case "data-dojo-type":case "dojotype":case "data-dojo-mixins":break;case "data-dojo-props":E=C;break;case "data-dojo-id":case "jsid":D=C;break;case "data-dojo-attach-point":case "dojoattachpoint":z.dojoAttachPoint=
C;break;case "data-dojo-attach-event":case "dojoattachevent":z.dojoAttachEvent=C;break;case "class":z["class"]=c.className;break;case "style":z.style=c.style&&c.style.cssText;break;default:if(O in x||(O=v(a)[Q]||O),O in x)switch(typeof x[O]){case "string":z[O]=C;break;case "number":z[O]=C.length?Number(C):NaN;break;case "boolean":z[O]="false"!=C.toLowerCase();break;case "function":""===C||-1!=C.search(/[^\w\.]+/i)?z[O]=new Function(C):z[O]=d.getObject(C,!1)||new Function(C);y.push(O);break;default:Q=
x[O],z[O]=Q&&"length"in Q?C?C.split(/\s*,\s*/):[]:Q instanceof Date?""==C?new Date(""):"now"==C?new Date:b.fromISOString(C):Q instanceof h?l.baseUrl+C:f(C)}else z[O]=C}}for(A=0;A<y.length;A++)r=y[A].toLowerCase(),c.removeAttribute(r),c[r]=null;if(E)try{E=f.call(k.propsThis,"{"+E+"}"),d.mixin(z,E)}catch(H){throw Error(H.toString()+" in data-dojo-props\x3d'"+E+"'");}d.mixin(z,t);m||(m=a&&(a._noScript||x._noScript)?[]:u("\x3e script[type^\x3d'dojo/']",c));var U=[],ia=[],Y=[],ca=[];if(m)for(B=0;B<m.length;B++)r=
m[B],c.removeChild(r),t=r.getAttribute(p+"event")||r.getAttribute("event"),k=r.getAttribute(p+"prop"),E=r.getAttribute(p+"method"),y=r.getAttribute(p+"advice"),A=r.getAttribute("type"),r=this._functionFromScript(r,p),t?"dojo/connect"==A?U.push({method:t,func:r}):"dojo/on"==A?ca.push({event:t,func:r}):z[t]=r:"dojo/aspect"==A?U.push({method:E,advice:y,func:r}):"dojo/watch"==A?Y.push({prop:k,func:r}):ia.push(r);a=(m=a.markupFactory||x.markupFactory)?m(z,c,a):new a(z,c);return a.then?a.then(w):w(a)},
scan:function(b,c){function f(a){if(!a.inherited){a.inherited={};var b=a.node,c=f(a.parent),b={dir:b.getAttribute("dir")||c.dir,lang:b.getAttribute("lang")||c.lang,textDir:b.getAttribute(k)||c.textDir},g;for(g in b)b[g]&&(a.inherited[g]=b[g])}return a.inherited}var g=[],e=[],h={},d=(c.scope||l._scopeName)+"Type",n="data-"+(c.scope||l._scopeName)+"-",t=n+"type",k=n+"textdir",n=n+"mixins",u=b.firstChild,m=c.inherited;if(!m){var p=function(a,b){return a.getAttribute&&a.getAttribute(b)||a.parentNode&&
p(a.parentNode,b)},m={dir:p(b,"dir"),lang:p(b,"lang"),textDir:p(b,k)},v;for(v in m)m[v]||delete m[v]}for(var m={inherited:m},w,z;;)if(u)if(1!=u.nodeType)u=u.nextSibling;else if(w&&"script"==u.nodeName.toLowerCase())(A=u.getAttribute("type"))&&/^dojo\/\w/i.test(A)&&w.push(u),u=u.nextSibling;else if(z)u=u.nextSibling;else{var A=u.getAttribute(t)||u.getAttribute(d);v=u.firstChild;if(A||v&&(3!=v.nodeType||v.nextSibling)){z=null;if(A){var y=u.getAttribute(n);w=y?[A].concat(y.split(/\s*,\s*/)):[A];try{z=
x(w,c.contextRequire)}catch(ia){}z||q.forEach(w,function(a){~a.indexOf("/")&&!h[a]&&(h[a]=!0,e[e.length]=a)});y=z&&!z.prototype._noScript?[]:null;m={types:w,ctor:z,parent:m,node:u,scripts:y};m.inherited=f(m);g.push(m)}else m={node:u,scripts:w,parent:m};w=y;z=u.stopParser||z&&z.prototype.stopParser&&!c.template;u=v}else u=u.nextSibling}else{if(!m||!m.node)break;u=m.node.nextSibling;z=!1;m=m.parent;w=m.scripts}var U=new a;e.length?(c.contextRequire||r)(e,function(){U.resolve(q.filter(g,function(a){if(!a.ctor)try{a.ctor=
x(a.types,c.contextRequire)}catch(H){}for(var b=a.parent;b&&!b.types;)b=b.parent;var f=a.ctor&&a.ctor.prototype;a.instantiateChildren=!(f&&f.stopParser&&!c.template);a.instantiate=!b||b.instantiate&&b.instantiateChildren;return a.instantiate}))}):U.resolve(g);return U.promise},_require:function(b,c){var g=f("{"+b.innerHTML+"}"),e=[],h=[],n=new a,t=c&&c.contextRequire||r,k;for(k in g)e.push(k),h.push(g[k]);t(h,function(){for(var a=0;a<e.length;a++)d.setObject(e[a],arguments[a]);n.resolve(arguments)});
return n.promise},_scanAmd:function(b,c){var f=new a,g=f.promise;f.resolve(!0);var e=this;u("script[type\x3d'dojo/require']",b).forEach(function(a){g=g.then(function(){return e._require(a,c)});a.parentNode.removeChild(a)});return g},parse:function(a,b){!a||"string"==typeof a||"nodeType"in a||(b=a,a=b.rootNode);var c=a?m.byId(a):p.body();b=b||{};var f=b.template?{template:!0}:{},g=[],e=this,h=this._scanAmd(c,b).then(function(){return e.scan(c,b)}).then(function(a){return e._instantiate(a,f,b,!0)}).then(function(a){return g=
g.concat(a)}).otherwise(function(a){console.error("dojo/parser::parse() error",a);throw a;});d.mixin(g,h);return g}};l.parser=z;k.parseOnLoad&&t(100,z,"parse");return z})},"dojo/date/stamp":function(){define(["../_base/lang","../_base/array"],function(r,l){var d={};r.setObject("dojo.date.stamp",d);d.fromISOString=function(q,k){d._isoRegExp||(d._isoRegExp=/^(?:(\d{4})(?:-(\d{2})(?:-(\d{2}))?)?)?(?:T(\d{2}):(\d{2})(?::(\d{2})(.\d+)?)?((?:[+-](\d{2}):(\d{2}))|Z)?)?$/);var m=d._isoRegExp.exec(q),p=null;
if(m){m.shift();m[1]&&m[1]--;m[6]&&(m[6]*=1E3);k&&(k=new Date(k),l.forEach(l.map("FullYear Month Date Hours Minutes Seconds Milliseconds".split(" "),function(c){return k["get"+c]()}),function(c,b){m[b]=m[b]||c}));p=new Date(m[0]||1970,m[1]||0,m[2]||1,m[3]||0,m[4]||0,m[5]||0,m[6]||0);100>m[0]&&p.setFullYear(m[0]||1970);var h=0,e=m[7]&&m[7].charAt(0);"Z"!=e&&(h=60*(m[8]||0)+(Number(m[9])||0),"-"!=e&&(h*=-1));e&&(h-=p.getTimezoneOffset());h&&p.setTime(p.getTime()+6E4*h)}return p};d.toISOString=function(d,
k){var m=function(b){return 10>b?"0"+b:b};k=k||{};var l=[],h=k.zulu?"getUTC":"get",e="";"time"!=k.selector&&(e=d[h+"FullYear"](),e=["0000".substr((e+"").length)+e,m(d[h+"Month"]()+1),m(d[h+"Date"]())].join("-"));l.push(e);if("date"!=k.selector){e=[m(d[h+"Hours"]()),m(d[h+"Minutes"]()),m(d[h+"Seconds"]())].join(":");h=d[h+"Milliseconds"]();k.milliseconds&&(e+="."+(100>h?"0":"")+m(h));if(k.zulu)e+="Z";else if("time"!=k.selector)var h=d.getTimezoneOffset(),c=Math.abs(h),e=e+((0<h?"-":"+")+m(Math.floor(c/
60))+":"+m(c%60));l.push(e)}return l.join("T")};return d})},"esri/dijit/_EventedWidget":function(){define("dojo/_base/declare dojo/_base/lang dojo/aspect dojo/on ../Evented dijit/_WidgetBase".split(" "),function(r,l,d,q,k,m){return r([m,k],{_onMap:function(d){var h=this.constructor._onMap,e;h&&h.FINAL||(delete this.constructor._onMap,h=this.registerConnectEvents(),h.FINAL=!0);d=d.toLowerCase();h[d]?e=this[h[d].method]:(d=this._onCamelCase(d),this[d]&&(e=d));return e},on:function(d,h){var e=this._onMap(d),
c=d.replace(/\-/g,""),b="on"+c in this.domNode;return e||!b?this.inherited(arguments):this.own(q(this.domNode,c,h))[0]},emit:function(d,h,e){var c,b,a,g=d.toLowerCase(),k=this.constructor._onMap||this.registerConnectEvents();b=this[this._onMap(g)];h=h||{};h.target||(h.target=this);b&&k&&k[g]&&(this._onObj2Arr(function(){c=Array.prototype.slice.call(arguments)},k[g].argKeys)(h),a=l.mixin({},arguments),a[2]=c,a[0]=k[g].name.replace(/^on/,""));return this.inherited(a||arguments)}})})},"esri/tasks/GeometryService":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/json dojo/_base/Deferred dojo/has ../kernel ../request ../deferredUtils ./Task ../geometry/Extent ../geometry/Polyline ../geometry/Polygon ../geometry/Multipoint ../geometry/jsonUtils".split(" "),
function(r,l,d,q,k,m,p,h,e,c,b,a,g,u,n){r=r(c,{declaredClass:"esri.tasks.GeometryService",_eventMap:{"areas-and-lengths-complete":["result"],"auto-complete-complete":["geometries"],"buffer-complete":["geometries"],"convex-hull-complete":["geometry"],"cut-complete":["result"],"densify-complete":["geometries"],"difference-complete":["geometries"],"distance-complete":["distance"],"generalize-complete":["geometries"],"intersect-complete":["geometries"],"label-points-complete":["geometries"],"lengths-complete":["result"],
"offset-complete":["geometries"],"project-complete":["geometries"],"relation-complete":["relations"],"reshape-complete":["geometry"],"simplify-complete":["geometries"],"trim-extend-complete":["geometries"],"union-complete":["geometry"]},constructor:function(a){a=l.hitch;this._projectHandler=a(this,this._projectHandler);this._simplifyHandler=a(this,this._simplifyHandler);this._bufferHandler=a(this,this._bufferHandler);this._areasAndLengthsHandler=a(this,this._areasAndLengthsHandler);this._lengthsHandler=
a(this,this._lengthsHandler);this._labelPointsHandler=a(this,this._labelPointsHandler);this._relationHandler=a(this,this._relationHandler);this._convexHullHandler=a(this,this._convexHullHandler);this._unionHandler=a(this,this._unionHandler);this._autoCompleteHandler=a(this,this._autoCompleteHandler);this._reshapeHandler=a(this,this._reshapeHandler);this._cutHandler=a(this,this._cutHandler);this._intersectHandler=a(this,this._intersectHandler);this._differenceHandler=a(this,this._differenceHandler);
this._trimExtendHandler=a(this,this._trimExtendHandler);this._densifyHandler=a(this,this._densifyHandler);this._generalizeHandler=a(this,this._densifyHandler);this._offsetHandler=a(this,this._offsetHandler);this._distanceHandler=a(this,this._distanceHandler);this._toGeoCoordinateHandler=a(this,this._toGeoCoordinateHandler);this._fromGeoCoordinateHandler=a(this,this._fromGeoCoordinateHandler);this.registerConnectEvents()},_encodeGeometries:function(a){var b=[],c,g=a.length;for(c=0;c<g;c++)b.push(a[c].toJson());
return{geometryType:n.getJsonType(a[0]),geometries:b}},_decodeGeometries:function(a,b,c){var f=n.getGeometryType(b);a=a.geometries;var g=[],e={spatialReference:c.toJson()},h=l.mixin;d.forEach(a,function(a,b){g[b]=new f(h(a,e))});return g},_toProjectGeometry:function(c){var f=c.spatialReference.toJson();return c instanceof b?new g({rings:[[[c.xmin,c.ymin],[c.xmin,c.ymax],[c.xmax,c.ymax],[c.xmax,c.ymin],[c.xmin,c.ymin]]],spatialReference:f}):new a({paths:[[].concat(c.points)],spatialReference:f})},
_fromProjectedGeometry:function(a,c,g){return"esriGeometryEnvelope"===c?(a=a.rings[0],new b(a[0][0],a[0][1],a[2][0],a[2][1],g)):new u({points:a.paths[0],spatialReference:g.toJson()})},project:function(a,b,c,g){var f=l.mixin({},this._url.query,{f:"json"}),d;a.geometries?(g=c,c=b,b=a.outSR,d=a.geometries[0],f=l.mixin(f,a.toJson())):(d=a[0],f=l.mixin(f,{outSR:b.wkid||q.toJson(b.toJson()),inSR:d.spatialReference.wkid||q.toJson(d.spatialReference.toJson()),geometries:q.toJson(this._encodeGeometries(a))}));
var t=n.getJsonType(d),u=this._projectHandler,m=this._errorHandler,p=new k(e._dfdCanceller);p._pendingDfd=h({url:this._url.path+"/project",content:f,callbackParamName:"callback",load:function(a,f){u(a,f,t,b,c,g,p)},error:function(a){m(a,g,p)}});return p},_projectHandler:function(a,b,c,g,e,h,d){try{var f=this._decodeGeometries(a,c,g);this._successHandler([f],"onProjectComplete",e,d)}catch(B){this._errorHandler(B,h,d)}},onProjectComplete:function(){},simplify:function(a,b,c){var f=a[0].spatialReference,
g=l.mixin({},this._url.query,{f:"json",sr:f.wkid?f.wkid:q.toJson(f.toJson()),geometries:q.toJson(this._encodeGeometries(a))}),d=n.getJsonType(a[0]),t=this._simplifyHandler,u=this._errorHandler,m=new k(e._dfdCanceller);m._pendingDfd=h({url:this._url.path+"/simplify",content:g,callbackParamName:"callback",load:function(a,g){t(a,g,d,f,b,c,m)},error:function(a){u(a,c,m)}});return m},_simplifyHandler:function(a,b,c,g,e,h,d){try{var f=this._decodeGeometries(a,c,g);this._successHandler([f],"onSimplifyComplete",
e,d)}catch(B){this._errorHandler(B,h,d)}},onSimplifyComplete:function(){},convexHull:function(a,b,c){var f=a[0].spatialReference;a=l.mixin({},this._url.query,{f:"json",sr:q.toJson(f.toJson()),geometries:q.toJson(this._encodeGeometries(a))});var g=this._convexHullHandler,d=this._errorHandler,n=new k(e._dfdCanceller);n._pendingDfd=h({url:this._url.path+"/convexHull",content:a,callbackParamName:"callback",load:function(a,e){g(a,e,f,b,c,n)},error:function(a){d(a,c,n)}});return n},_convexHullHandler:function(a,
b,c,g,e,h){try{var f=n.fromJson(a.geometry).setSpatialReference(c);this._successHandler([f],"onConvexHullComplete",g,h)}catch(y){this._errorHandler(y,e,h)}},onConvexHullComplete:function(){},union:function(a,b,c){var f=a[0].spatialReference;a=l.mixin({},this._url.query,{f:"json",sr:q.toJson(f.toJson()),geometries:q.toJson(this._encodeGeometries(a))});var g=this._unionHandler,d=this._errorHandler,n=new k(e._dfdCanceller);n._pendingDfd=h({url:this._url.path+"/union",content:a,callbackParamName:"callback",
load:function(a,e){g(a,e,f,b,c,n)},error:function(a){d(a,c,n)}});return n},_unionHandler:function(a,b,c,g,e,h){try{var f=n.fromJson(a.geometry).setSpatialReference(c);this._successHandler([f],"onUnionComplete",g,h)}catch(y){this._errorHandler(y,e,h)}},onUnionComplete:function(){},autoComplete:function(a,b,c,g){var f=a[0].spatialReference;a=l.mixin({},this._url.query,{f:"json",sr:q.toJson(f.toJson()),polygons:q.toJson(this._encodeGeometries(a).geometries),polylines:q.toJson(this._encodeGeometries(b).geometries)});
var d=this._autoCompleteHandler,n=this._errorHandler,t=new k(e._dfdCanceller);t._pendingDfd=h({url:this._url.path+"/autoComplete",content:a,callbackParamName:"callback",load:function(a,b){d(a,b,f,c,g,t)},error:function(a){n(a,g,t)}});return t},_autoCompleteHandler:function(a,b,c,e,h,d){try{var f=a.geometries;a=[];var n,t=f.length;for(n=0;n<t;n++)a[n]=new g({spatialReference:c,rings:f[n].rings});this._successHandler([a],"onAutoCompleteComplete",e,d)}catch(C){this._errorHandler(C,h,d)}},onAutoCompleteComplete:function(){},
reshape:function(a,b,c,g){var f=a.spatialReference;a=l.mixin({},this._url.query,{f:"json",sr:q.toJson(f.toJson()),target:q.toJson({geometryType:n.getJsonType(a),geometry:a.toJson()}),reshaper:q.toJson(b.toJson())});var d=this._reshapeHandler,t=this._errorHandler,u=new k(e._dfdCanceller);u._pendingDfd=h({url:this._url.path+"/reshape",content:a,callbackParamName:"callback",load:function(a,b){d(a,b,f,c,g,u)},error:function(a){t(a,g,u)}});return u},_reshapeHandler:function(a,b,c,g,e,h){try{var f=n.fromJson(a.geometry).setSpatialReference(c);
this._successHandler([f],"onReshapeComplete",g,h)}catch(y){this._errorHandler(y,e,h)}},onReshapeComplete:function(){},cut:function(a,b,c,g){var f=a[0].spatialReference,t=d.map(a,function(a){return a.toJson()});a=l.mixin({},this._url.query,{f:"json",sr:q.toJson(f.toJson()),target:q.toJson({geometryType:n.getJsonType(a[0]),geometries:t}),cutter:q.toJson(b.toJson())});var u=this._cutHandler,m=this._errorHandler,p=new k(e._dfdCanceller);p._pendingDfd=h({url:this._url.path+"/cut",content:a,callbackParamName:"callback",
load:function(a,b){u(a,b,f,c,g,p)},error:function(a){m(a,g,p)}});return p},_cutHandler:function(a,b,c,g,e,h){try{var f=a.geometries,t={};t.cutIndexes=a.cutIndexes;t.geometries=[];d.forEach(f,function(a){t.geometries.push(n.fromJson(a).setSpatialReference(c))});this._successHandler([t],"onCutComplete",g,h)}catch(B){this._errorHandler(B,e,h)}},onCutComplete:function(){},intersect:function(a,b,c,g){var f=a[0].spatialReference;a=l.mixin({},this._url.query,{f:"json",sr:q.toJson(f.toJson()),geometries:q.toJson(this._encodeGeometries(a)),
geometry:q.toJson({geometryType:n.getJsonType(b),geometry:b.toJson()})});var d=this._intersectHandler,t=this._errorHandler,u=new k(e._dfdCanceller);u._pendingDfd=h({url:this._url.path+"/intersect",content:a,callbackParamName:"callback",load:function(a,b){d(a,b,f,c,g,u)},error:function(a){t(a,g,u)}});return u},_intersectHandler:function(a,b,c,g,e,h){try{var f=[];d.forEach(a.geometries,function(a){f.push(n.fromJson(a).setSpatialReference(c))});this._successHandler([f],"onIntersectComplete",g,h)}catch(y){this._errorHandler(y,
e,h)}},onIntersectComplete:function(){},difference:function(a,b,c,g){var f=a[0].spatialReference;a=l.mixin({},this._url.query,{f:"json",sr:q.toJson(f.toJson()),geometries:q.toJson(this._encodeGeometries(a)),geometry:q.toJson({geometryType:n.getJsonType(b),geometry:b.toJson()})});var d=this._differenceHandler,t=this._errorHandler,u=new k(e._dfdCanceller);u._pendingDfd=h({url:this._url.path+"/difference",content:a,callbackParamName:"callback",load:function(a,b){d(a,b,f,c,g,u)},error:function(a){t(a,
g,u)}});return u},_differenceHandler:function(a,b,c,g,e,h){try{var f=[];d.forEach(a.geometries,function(a){f.push(n.fromJson(a).setSpatialReference(c))});this._successHandler([f],"onDifferenceComplete",g,h)}catch(y){this._errorHandler(y,e,h)}},onDifferenceComplete:function(){},buffer:function(a,b,c){var f=l.mixin({},this._url.query,{f:"json"},a.toJson()),g=a.outSpatialReference||a.geometries[0].spatialReference,d=this._bufferHandler,n=this._errorHandler,t=new k(e._dfdCanceller);t._pendingDfd=h({url:this._url.path+
"/buffer",content:f,callbackParamName:"callback",load:function(a,f){d(a,f,g,b,c,t)},error:function(a){n(a,c,t)}});return t},_bufferHandler:function(a,b,c,e,h,d){try{var f=a.geometries;a=[];var n,t=f.length;for(n=0;n<t;n++)a[n]=new g({spatialReference:c,rings:f[n].rings});this._successHandler([a],"onBufferComplete",e,d)}catch(C){this._errorHandler(C,h,d)}},onBufferComplete:function(){},areasAndLengths:function(a,b,c){a=l.mixin({},this._url.query,{f:"json"},a.toJson());var f=this._areasAndLengthsHandler,
g=this._errorHandler,d=new k(e._dfdCanceller);d._pendingDfd=h({url:this._url.path+"/areasAndLengths",content:a,callbackParamName:"callback",load:function(a,g){f(a,g,b,c,d)},error:function(a){g(a,c,d)}});return d},_areasAndLengthsHandler:function(a,b,c,g,e){try{this._successHandler([a],"onAreasAndLengthsComplete",c,e)}catch(z){this._errorHandler(z,g,e)}},onAreasAndLengthsComplete:function(){},lengths:function(a,b,c){a=l.mixin({},this._url.query,{f:"json"},a.toJson());var f=this._lengthsHandler,g=this._errorHandler,
d=new k(e._dfdCanceller);d._pendingDfd=h({url:this._url.path+"/lengths",content:a,callbackParamName:"callback",load:function(a,g){f(a,g,b,c,d)},error:function(a){g(a,c,d)}});return d},_lengthsHandler:function(a,b,c,g,e){try{this._successHandler([a],"onLengthsComplete",c,e)}catch(z){this._errorHandler(z,g,e)}},onLengthsComplete:function(){},labelPoints:function(a,b,c){var f=d.map(a,function(a){return a.toJson()}),g=a[0].spatialReference,f=l.mixin({},this._url.query,{f:"json",sr:g.wkid?g.wkid:q.toJson(g.toJson()),
polygons:q.toJson(f)}),n=this._labelPointsHandler,t=this._errorHandler,u=new k(e._dfdCanceller);u._pendingDfd=h({url:this._url.path+"/labelPoints",content:f,callbackParamName:"callback",load:function(f,e){n(f,e,a,g,b,c,u)},error:function(a){t(a,c,u)}});return u},_labelPointsHandler:function(a,b,c,g,e,h,u){try{var f=[];d.forEach(a.labelPoints,function(a){f.push(n.fromJson(a).setSpatialReference(g))});this._successHandler([f],"onLabelPointsComplete",e,u)}catch(B){this._errorHandler(B,h,u)}},onLabelPointsComplete:function(){},
relation:function(a,b,c){a=l.mixin({},this._url.query,{f:"json"},a.toJson());var f=this._relationHandler,g=this._errorHandler,d=new k(e._dfdCanceller);d._pendingDfd=h({url:this._url.path+"/relation",content:a,callbackParamName:"callback",load:function(a,g){f(a,g,b,c,d)},error:function(a){g(a,c,d)}});return d},_relationHandler:function(a,b,c,g,e){try{this._successHandler([a.relations],"onRelationComplete",c,e)}catch(z){this._errorHandler(z,g,e)}},onRelationComplete:function(){},trimExtend:function(a,
b,c){var f=l.mixin({},this._url.query,{f:"json"},a.toJson()),g=a.sr,d=this._trimExtendHandler,n=this._errorHandler,t=new k(e._dfdCanceller);t._pendingDfd=h({url:this._url.path+"/trimExtend",content:f,callbackParamName:"callback",load:function(a,f){d(a,f,g,b,c,t)},error:function(a){n(a,c,t)}});return t},_trimExtendHandler:function(b,c,g,e,h,d){try{var f=b.geometries;b=[];var n,t=f.length;for(n=0;n<t;n++)b[n]=new a({spatialReference:g,paths:f[n].paths});this._successHandler([b],"onTrimExtendComplete",
e,d)}catch(C){this._errorHandler(C,h,d)}},onTrimExtendComplete:function(){},densify:function(a,b,c){var f=l.mixin({},this._url.query,{f:"json"},a.toJson()),g=a.geometries[0].spatialReference,d=this._densifyHandler,n=this._errorHandler,t=new k(e._dfdCanceller);t._pendingDfd=h({url:this._url.path+"/densify",content:f,callbackParamName:"callback",load:function(a,f){d(a,f,g,b,c,t)},error:function(a){n(a,c,t)}});return t},_densifyHandler:function(a,b,c,g,e,h){try{var f=[];d.forEach(a.geometries,function(a){f.push(n.fromJson(a).setSpatialReference(c))});
this._successHandler([f],"onDensifyComplete",g,h)}catch(y){this._errorHandler(y,e,h)}},onDensifyComplete:function(){},generalize:function(a,b,c){var f=l.mixin({},this._url.query,{f:"json"},a.toJson()),g=a.geometries[0].spatialReference,d=this._generalizeHandler,n=this._errorHandler,t=new k(e._dfdCanceller);t._pendingDfd=h({url:this._url.path+"/generalize",content:f,callbackParamName:"callback",load:function(a,f){d(a,f,g,b,c,t)},error:function(a){n(a,c,t)}});return t},_generalizeHandler:function(a,
b,c,g,e,h){try{var f=[];d.forEach(a.geometries,function(a){f.push(n.fromJson(a).setSpatialReference(c))});this._successHandler([f],"onGeneralizeComplete",g,h)}catch(y){this._errorHandler(y,e,h)}},onGeneralizeComplete:function(){},offset:function(a,b,c){var f=l.mixin({},this._url.query,{f:"json"},a.toJson()),g=a.geometries[0].spatialReference,d=this._offsetHandler,n=this._errorHandler,t=new k(e._dfdCanceller);t._pendingDfd=h({url:this._url.path+"/offset",content:f,callbackParamName:"callback",load:function(a,
f){d(a,f,g,b,c,t)},error:function(a){n(a,c,t)}});return t},_offsetHandler:function(a,b,c,g,e,h){try{var f=[];d.forEach(a.geometries,function(a){f.push(n.fromJson(a).setSpatialReference(c))});this._successHandler([f],"onOffsetComplete",g,h)}catch(y){this._errorHandler(y,e,h)}},onOffsetComplete:function(){},distance:function(a,b,c){var f=l.mixin({},this._url.query,{f:"json"},a.toJson()),g=a.geometry1.spatialReference,d=this._distanceHandler,n=this._errorHandler,t=new k(e._dfdCanceller);t._pendingDfd=
h({url:this._url.path+"/distance",content:f,callbackParamName:"callback",load:function(a,f){d(a,f,g,b,c,t)},error:function(a){n(a,c,t)}});return t},_distanceHandler:function(a,b,c,g,e,h){try{a=a&&a.distance,this._successHandler([a],"onDistanceComplete",g,h)}catch(A){this._errorHandler(A,e,h)}},onDistanceComplete:function(){},toGeoCoordinateString:function(a,b,c){var f={};l.isObject(a.sr)?f.sr=a.sr.wkid||q.toJson(a.sr.toJson()):f.sr=a.sr;f.coordinates=q.toJson(a.coordinates);f.conversionType=a.conversionType||
"MGRS";f.conversionMode=a.conversionMode;f.numOfDigits=a.numOfDigits;f.rounding=a.rounding;f.addSpaces=a.addSpaces;a=l.mixin({},this._url.query,{f:"json"},f);var g=this._toGeoCoordinateHandler,d=this._errorHandler,n=new k(e._dfdCanceller);n._pendingDfd=h({url:this._url.path+"/toGeoCoordinateString",content:a,callbackParamName:"callback",load:function(a,f){g(a,f,b,c,n)},error:function(a){d(a,c,n)}});return n},_toGeoCoordinateHandler:function(a,b,c,g,e){try{this._successHandler([a.strings],"onToGeoCoordinateStringComplete",
c,e)}catch(z){this._errorHandler(z,g,e)}},onToGeoCoordinateStringComplete:function(){},fromGeoCoordinateString:function(a,b,c){var f={};l.isObject(a.sr)?f.sr=a.sr.wkid||q.toJson(a.sr.toJson()):f.sr=a.sr;f.strings=q.toJson(a.strings);f.conversionType=a.conversionType||"MGRS";f.conversionMode=a.conversionMode;a=l.mixin({},this._url.query,{f:"json"},f);var g=this._fromGeoCoordinateHandler,d=this._errorHandler,n=new k(e._dfdCanceller);n._pendingDfd=h({url:this._url.path+"/fromGeoCoordinateString",content:a,
callbackParamName:"callback",load:function(a,f){g(a,f,b,c,n)},error:function(a){d(a,c,n)}});return n},_fromGeoCoordinateHandler:function(a,b,c,g,e){try{this._successHandler([a.coordinates],"onToGeoCoordinateStringComplete",c,e)}catch(z){this._errorHandler(z,g,e)}},onFromGeoCoordinateStringComplete:function(){}});l.mixin(r,{UNIT_METER:9001,UNIT_GERMAN_METER:9031,UNIT_FOOT:9002,UNIT_SURVEY_FOOT:9003,UNIT_CLARKE_FOOT:9005,UNIT_FATHOM:9014,UNIT_NAUTICAL_MILE:9030,UNIT_SURVEY_CHAIN:9033,UNIT_SURVEY_LINK:9034,
UNIT_SURVEY_MILE:9035,UNIT_KILOMETER:9036,UNIT_CLARKE_YARD:9037,UNIT_CLARKE_CHAIN:9038,UNIT_CLARKE_LINK:9039,UNIT_SEARS_YARD:9040,UNIT_SEARS_FOOT:9041,UNIT_SEARS_CHAIN:9042,UNIT_SEARS_LINK:9043,UNIT_BENOIT_1895A_YARD:9050,UNIT_BENOIT_1895A_FOOT:9051,UNIT_BENOIT_1895A_CHAIN:9052,UNIT_BENOIT_1895A_LINK:9053,UNIT_BENOIT_1895B_YARD:9060,UNIT_BENOIT_1895B_FOOT:9061,UNIT_BENOIT_1895B_CHAIN:9062,UNIT_BENOIT_1895B_LINK:9063,UNIT_INDIAN_FOOT:9080,UNIT_INDIAN_1937_FOOT:9081,UNIT_INDIAN_1962_FOOT:9082,UNIT_INDIAN_1975_FOOT:9083,
UNIT_INDIAN_YARD:9084,UNIT_INDIAN_1937_YARD:9085,UNIT_INDIAN_1962_YARD:9086,UNIT_INDIAN_1975_YARD:9087,UNIT_FOOT_1865:9070,UNIT_RADIAN:9101,UNIT_DEGREE:9102,UNIT_ARCMINUTE:9103,UNIT_ARCSECOND:9104,UNIT_GRAD:9105,UNIT_GON:9106,UNIT_MICRORADIAN:9109,UNIT_ARCMINUTE_CENTESIMAL:9112,UNIT_ARCSECOND_CENTESIMAL:9113,UNIT_MIL6400:9114,UNIT_BRITISH_1936_FOOT:9095,UNIT_GOLDCOAST_FOOT:9094,UNIT_INTERNATIONAL_CHAIN:109003,UNIT_INTERNATIONAL_LINK:109004,UNIT_INTERNATIONAL_YARD:109001,UNIT_STATUTE_MILE:9093,UNIT_SURVEY_YARD:109002,
UNIT_50KILOMETER_LENGTH:109030,UNIT_150KILOMETER_LENGTH:109031,UNIT_DECIMETER:109005,UNIT_CENTIMETER:109006,UNIT_MILLIMETER:109007,UNIT_INTERNATIONAL_INCH:109008,UNIT_US_SURVEY_INCH:109009,UNIT_INTERNATIONAL_ROD:109010,UNIT_US_SURVEY_ROD:109011,UNIT_US_NAUTICAL_MILE:109012,UNIT_UK_NAUTICAL_MILE:109013,UNIT_SQUARE_INCHES:"esriSquareInches",UNIT_SQUARE_FEET:"esriSquareFeet",UNIT_SQUARE_YARDS:"esriSquareYards",UNIT_ACRES:"esriAcres",UNIT_SQUARE_MILES:"esriSquareMiles",UNIT_SQUARE_MILLIMETERS:"esriSquareMillimeters",
UNIT_SQUARE_CENTIMETERS:"esriSquareCentimeters",UNIT_SQUARE_DECIMETERS:"esriSquareDecimeters",UNIT_SQUARE_METERS:"esriSquareMeters",UNIT_ARES:"esriAres",UNIT_HECTARES:"esriHectares",UNIT_SQUARE_KILOMETERS:"esriSquareKilometers"});return r})},"esri/layers/FeatureLayer":function(){define("require module dojo/_base/declare dojo/_base/connect dojo/_base/lang dojo/_base/array dojo/_base/json dojo/_base/Deferred dojo/date/locale dojo/sniff dojo/io-query dojo/dom-construct dojo/i18n dojo/when dojo/promise/all ../kernel ../lang ../request ../config ../deferredUtils ../SpatialReference ../symbols/SimpleMarkerSymbol ../symbols/SimpleLineSymbol ../symbols/SimpleFillSymbol ../symbols/jsonUtils ../renderers/SimpleRenderer ../renderers/UniqueValueRenderer ../renderers/jsonUtils ../renderers/arcadeUtils ../tasks/QueryTask ../tasks/query ../tasks/FeatureSet ../tasks/StatisticDefinition ../geometry/Extent ../geometry/jsonUtils ../geometry/normalizeUtils ../geometry/scaleUtils ./GraphicsLayer ./Field ./TimeInfo ./FeatureType ./FeatureTemplate ./FeatureEditResult ./LabelClass ./SnapshotMode ./OnDemandMode ./SelectionMode ./StreamMode ./TrackManager ./HeatmapManager ./clustering/ClusterManager dojo/i18n!../nls/jsapi require".split(" "),
function(r,l,d,q,k,m,p,h,e,c,b,a,g,u,n,t,f,v,x,w,z,A,y,B,C,E,D,F,G,J,N,M,L,K,W,R,ba,O,Q,U,ia,Y,ca,H,ea,va,la,ma,sa,ka,ta,ua){var qa=x.defaults,da=d(O,{declaredClass:"esri.layers.FeatureLayer",invalidParams:"query contains one or more unsupported parameters",reHostedFS:/(https?:)?\/\/services.*\.arcgis\.com/i,maxPointCountForAuto:4E3,maxRecordCountForAuto:2E3,maxVertexCountForAuto:25E4,generalizeForScale:4E3,_eventMap:{"add-attachment-complete":["result"],"before-apply-edits":["adds","updates","deletes"],
"delete-attachments-complete":["results"],"edits-complete":["adds","updates","deletes"],"query-attachment-infos-complete":["results"],"query-count-complete":["count"],"query-features-complete":["featureSet"],"query-ids-complete":["objectIds"],"query-related-features-complete":["featureSets"],"selection-complete":["features","method"],"update-end":["error","info"]},constructor:function(a,b){this._preventInit||this._initFeatureLayer(a,b)},_initFeatureLayer:function(a,b){this.i18n=ua;b=b||{};this._aggregationInfo=
b.aggregationInfo;this.showLabels=null!=b.showLabels?b.showLabels:!0;this._outFields=b.outFields;this._defnExpr=b.definitionExpression;this._loadCallback=b.loadCallback;var c=b._usePatch;this._usePatch=null===c||void 0===c?!0:c;this._trackIdField=b.trackIdField;this.objectIdField=b.objectIdField;this._maxOffset=null!=b.maxAllowableOffset?b.maxAllowableOffset:this.maxAllowableOffset;this.quantize=null!=b.quantize?b.quantize:!0;this._optEditable=b.editable;this._optAutoGen=b.autoGeneralize;this.editSummaryCallback=
b.editSummaryCallback;this.userId=b.userId;this.userIsAdmin=b.userIsAdmin;this.useMapTime=b.hasOwnProperty("useMapTime")?!!b.useMapTime:!0;this.source=b.source;this.gdbVersion=b.gdbVersion;this.orderByFields=b.orderByFields;this.maxPointCountForAuto=null!=b.maxPointCountForAuto?b.maxPointCountForAuto:this.maxPointCountForAuto;this.maxRecordCountForAuto=null!=b.maxRecordCountForAuto?b.maxRecordCountForAuto:this.maxRecordCountForAuto;this.maxVertexCountForAuto=null!=b.maxVertexCountForAuto?b.maxVertexCountForAuto:
this.maxVertexCountForAuto;this.generalizeForScale=null!=b.generalizeForScale?b.generalizeForScale:this.generalizeForScale;this.queryPagination=null!=b.queryPagination?b.queryPagination:this.url?this.reHostedFS.test(this.url):!1;this.multipatchOption=b.multipatchOption;this._selectedFeatures={};this._selectedFeaturesArr=[];this._newFeatures=[];this._deletedFeatures={};this._ulid=this._getUniqueId();var g=da,c=this.mode=f.isDefined(b.mode)?b.mode:g.MODE_ONDEMAND;this._isStream&&(this.mode=c=g.MODE_STREAM);
switch(c){case g.MODE_SNAPSHOT:this.currentMode=g.MODE_SNAPSHOT;this._mode=new ea(this);this._isSnapshot=!0;break;case g.MODE_ONDEMAND:case g.MODE_AUTO:this.currentMode=g.MODE_ONDEMAND;this._tileWidth=b.tileWidth||512;this._tileHeight=b.tileHeight||512;this._mode=new va(this);this.latticeTiling=b.latticeTiling;break;case g.MODE_SELECTION:this.currentMode=g.MODE_SELECTION;this._mode=new la(this);this._isSelOnly=!0;break;case g.MODE_STREAM:this.currentMode=g.MODE_STREAM,this._mode=new ma(this),this._isStream=
!0}this._initLayer=k.hitch(this,this._initLayer);this._selectHandler=k.hitch(this,this._selectHandler);this._editable=!1;if(k.isObject(a)&&a.layerDefinition)return this._collection=!0,this.mode=this._isStream?g.MODE_STREAM:g.MODE_SNAPSHOT,this._isStream||this._outFields||(this._outFields=["*"]),this._initLayer(a),this;this._task=new J(this.url,{source:this.source,gdbVersion:this.gdbVersion});c=this._url.path;this._fserver=!1;-1!==c.search(/\/FeatureServer\//i)&&(this._fserver=!0);this.mode===g.MODE_AUTO&&
this.reHostedFS.test(this.url)&&this._queryLimit();(g=b.resourceInfo)?this._initLayer(g):(this.source&&(g={source:this.source.toJson()},this._url.query=k.mixin(this._url.query,{layer:p.toJson(g)})),this.gdbVersion&&(this._url.query=k.mixin(this._url.query,{gdbVersion:this.gdbVersion})),v({url:c,content:k.mixin({f:"json"},this._url.query),callbackParamName:"callback",load:this._initLayer,error:this._errorHandler}));this.registerConnectEvents()},_initLayer:function(a,b){if(a||b){this._json=a;this._findCredential();
if(this.credential&&this.credential.ssl||a&&a._ssl)this._useSSL(),this._task._useSSL();this.version=a.currentVersion;this.version||(this.version="capabilities"in a||"drawingInfo"in a||"hasAttachments"in a||"htmlPopupType"in a||"relationships"in a||"timeInfo"in a||"typeIdField"in a||"types"in a?10:9.3);this._collection&&(this._isStream||(this.currentMode=da.MODE_SNAPSHOT,this._mode=new ea(this)),this._isSnapshot=!0,this._featureSet=a.featureSet,this._nextId=a.nextObjectId,a=a.layerDefinition);this.geometryType=
a.geometryType;"string"!==typeof this.multipatchOption&&"esriGeometryMultiPatch"===this.geometryType&&(this.multipatchOption="xyFootprint");if(a.hasOwnProperty("capabilities")){var g=this.capabilities=a.capabilities;g&&-1!==g.toLowerCase().indexOf("editing")?this._editable=!0:this._editable=!1}else this._collection||(this._editable=this._fserver);f.isDefined(this._optEditable)?(this._editable=this._optEditable,delete this._optEditable):"esriGeometryMultiPatch"===this.geometryType&&(this._editable=
!1);this._json=p.toJson(this._json);this.isEditable()?this._setMaxOffset(null):this.mode===da.MODE_SNAPSHOT||"esriGeometryPolyline"!==this.geometryType&&"esriGeometryPolygon"!==this.geometryType&&!this.hasXYFootprint()||(this._autoGeneralize=f.isDefined(this._optAutoGen)?this._optAutoGen:this.mode===da.MODE_ONDEMAND||this.mode===da.MODE_AUTO,delete this._optAutoGen);var g=a.effectiveMinScale||a.minScale,e=a.effectiveMaxScale||a.maxScale;!this._hasMin&&g&&this.setMinScale(g);!this._hasMax&&e&&this.setMaxScale(e);
this.layerId=a.id;this.name=a.name;this.description=a.description;this.copyright=a.copyrightText;this.type=a.type;this.displayField=a.displayField;this.defaultDefinitionExpression=a.definitionExpression||(a.isView?a.viewDefinitionQuery:a.definitionQuery);this.fullExtent=new K(a.extent);this.initialExtent=new K(this.fullExtent.toJson());this.fullExtent.spatialReference&&(this.spatialReference=new z(this.fullExtent.spatialReference.toJson()));this.defaultVisibility=a.defaultVisibility;if("esriGeometryPoint"===
this.geometryType||"esriGeometryMultipoint"===this.geometryType)this.latticeTiling=!1;this.hasM=a.hasM||!1;this.hasZ=a.hasZ||!1;this.indexedFields=a.indexedFields;this.maxRecordCount=a.maxRecordCount;this.canModifyLayer=a.canModifyLayer;this.supportsStatistics=a.supportsStatistics;this.supportsAdvancedQueries=this._collection?!1:a.supportsAdvancedQueries;this.supportsCalculate=a.supportsCalculate;this.supportsAttachmentsByUploadId=a.supportsAttachmentsByUploadId;this.supportsCoordinatesQuantization=
a.supportsCoordinatesQuantization;this.quantize=this.quantize&&this.supportsCoordinatesQuantization;this.hasLabels=a.hasLabels;this.canScaleSymbols=a.canScaleSymbols;this.supportsRollbackOnFailureParameter=this.supportsRollbackOnFailure=a.supportsRollbackOnFailure;this.syncCanReturnChanges=a.syncCanReturnChanges;this.isDataVersioned=a.isDataVersioned;this.editFieldsInfo=a.editFieldsInfo;this.ownershipBasedAccessControlForFeatures=a.ownershipBasedAccessControlForFeatures;this.editFieldsInfo&&this.ownershipBasedAccessControlForFeatures&&
(this.creatorField=this.editFieldsInfo.creatorField);this.relationships=a.relationships;this.allowGeometryUpdates=f.isDefined(a.allowGeometryUpdates)?a.allowGeometryUpdates:!0;this.allowUpdateWithoutMValues=!!a.allowUpdateWithoutMValues;this.advancedQueryCapabilities=a.advancedQueryCapabilities||{supportsStatistics:this.supportsStatistics,supportsOrderBy:this.supportsAdvancedQueries,supportsDistinct:this.supportsAdvancedQueries};this.useStandardizedQueries=a.useStandardizedQueries;this.tileMaxRecordCount=
a.tileMaxRecordCount;this.standardMaxRecordCount=a.standardMaxRecordCount;this._setMaxOffset(this._maxOffset,!0);this._isTable="Table"===this.type;for(var h=this.fields=[],e=a.fields,g=0;g<e.length;g++)h.push(new Q(e[g]));if(!this.objectIdField){this.objectIdField=a.objectIdField;if(!this.objectIdField)for(e=a.fields,g=0;g<e.length;g++)if(h=e[g],"esriFieldTypeOID"===h.type){this.objectIdField=h.name;break}this.objectIdField||this._isStream||console.debug("esri.layers.FeatureLayer: "+f.substitute({url:this.url},
"objectIdField is not set [url: ${url}]"))}if(!f.isDefined(this._nextId)){e=this.objectIdField;h=-1;if(this._collection&&e)for(var d=(g=this._featureSet)&&g.features,n=d?d.length:0,t,g=0;g<n;g++)t=(t=d[g].attributes)&&t[e],t>h&&(h=t);this._nextId=h+1}this.globalIdField=a.globalIdField;if(g=this.typeIdField=a.typeIdField)if(g=!this._getField(g)&&this._getField(g,!0))this.typeIdField=g.name;this.visibilityField=a.visibilityField;if(e=a.defaultSymbol)this.defaultSymbol=C.fromJson(e);var u=this.types=
[],l=a.types,q,v,h=(g=this.editFieldsInfo)&&g.creatorField,d=g&&g.editorField;t=h||d;n=[];if(l)for(g=0;g<l.length;g++)q=new ia(l[g]),v=q.templates,t&&v&&v.length&&(n=n.concat(v)),u.push(q);l=a.templates;q=this.templates=[];if(l)for(g=0;g<l.length;g++)u=new Y(l[g]),t&&n.push(u),q.push(u);for(g=0;g<n.length;g++)if(t=k.getObject("prototype.attributes",!1,n[g]))h&&delete t[h],d&&delete t[d];if(g=a.timeInfo)this.timeInfo=new U(g),this._startTimeField=g.startTimeField,this._endTimeField=g.endTimeField,
this._startTimeField&&this._endTimeField&&(this._twoTimeFields=!0),this._trackIdField?g.trackIdField=this._trackIdField:this._trackIdField=g.trackIdField;this.hasAttachments=!this._collection&&a.hasAttachments?!0:!1;this.htmlPopupType=a.htmlPopupType;var g=a.drawingInfo,w;(h=g&&g.labelingInfo)&&!this.labelingInfo&&(this.labelingInfo=m.map(h,function(a){return new H(a)}),this._fixLabelExpr());if(!this.renderer)if(g&&g.renderer){if(w=g.renderer,this.setRenderer(F.fromJson(w)),"classBreaks"===w.type&&
this.renderer.setMaxInclusive(!0),!this._collection){var x=w.type,e=[];w=this.renderer;switch(x){case "simple":e.push(w.symbol);break;case "uniqueValue":case "classBreaks":e.push(w.defaultSymbol),e=e.concat(m.map(w.infos,function(a){return a.symbol}))}var e=m.filter(e,f.isDefined),r=this._url.path+"/images/",G=this._getToken();m.forEach(e,function(a){var b=a.url;b&&(-1===b.search(/https?\:/)&&-1===b.indexOf("data:")&&(a.url=r+b),G&&-1!==a.url.search(/https?\:/)&&(a.url+="?token\x3d"+G))})}}else if(e)l=
this.types,0<l.length?(w=new D(this.defaultSymbol,this.typeIdField),m.forEach(l,function(a){w.addValue(a.id,a.symbol)})):w=new E(this.defaultSymbol),this.setRenderer(w);else if(!this._isTable){switch(this.geometryType){case "esriGeometryPoint":case "esriGeometryMultipoint":x=new A;break;case "esriGeometryPolyline":x=new y;break;case "esriGeometryPolygon":x=new B;break;default:this.hasXYFootprint()&&(x=new B)}this.setRenderer(x?new E(x):null)}x=g&&g.transparency||0;!this.hasOwnProperty("opacity")&&
0<x&&(this.opacity=1-x/100);(c("ie")||7<=c("trident")||c("safari"))&&this.isEditable()&&10.02>this.version&&(this._ts=!0);this.statistics=a.statistics;this._fixRendererFields();this._updateRequiredFieldsFromLabelingInfo();this._checkFields();this._updateCaps();var N=function(){this.currentMode!==da.MODE_SNAPSHOT&&(this.queryPagination=!1);null==this._maxOffset||this._isFractionalOffsetAllowed()||this._setMaxOffset(this._maxOffset);this.loaded=!0;this.onLoad(this);var a=this._loadCallback;a&&(delete this._loadCallback,
a(this))};this._collection?(x=this._featureSet,this._featureSet=null,this._mode._drawFeatures(new M(x)),this._fcAdded=!0,N.call(this)):this._forceIdentity(this._limitPromise?function(){var a=this;this._limitPromise.then(function(b){a._checkMode(b)});this._limitPromise.always(function(){a._limitPromise=null;N.call(a)})}:N)}},setShowLabels:function(a){this.showLabels=a;this.onShowLabelsChange()},onShowLabelsChange:function(){},onRendererChange:function(a){this.inherited(arguments);var b=this._map;this._ager=
!!(a&&a.observationAger&&a.observationRenderer);a&&"colors"in a&&"blurRadius"in a&&"maxPixelIntensity"in a?"esriGeometryPoint"==this.geometryType&&!this._heatmapManager&&b&&(this._heatmapManager=new ka(this),this._heatmapManager.initialize(b)):this.renderer&&this.renderer.getRendererInfo?m.some(this.renderer.rendererInfos,function(a){return a.renderer&&"colors"in a.renderer&&"blurRadius"in a.renderer})||(this._heatmapManager=null):this._heatmapManager=null;this.timeInfo&&b&&(a&&(a.latestObservationRenderer||
a.trackRenderer)?this._trackManager||(this._trackManager=new sa(this),this._trackManager.initialize(b),this._childLayer=this._trackManager.container,this._mode._applyTimeFilter()):this._trackManager&&!this._isStream&&(this._trackManager.destroy(),this._trackManager=null));if(a){var c=[],b=m.filter([a,a.observationRenderer,a.latestObservationRenderer,a.trackRenderer],f.isDefined),g=function(a){return null!=a&&"function"!=typeof a&&a};m.forEach(b,function(a){var b=g(a.attributeField),f=g(a.attributeField2);
a=g(a.attributeField3);!1!==b&&c.push(b);!1!==f&&c.push(f);!1!==a&&c.push(a)});this._requiredFields=c}else this._requiredFields=[];this.loaded&&(this._fixRendererFields(),this._checkFields(this._requiredFields),this._collection&&(this._typesDirty=!0))},getAggregationInfo:function(){return this._aggregationInfo},setAggregationInfo:function(a){this._aggregationInfo=a;this.loaded&&this._map&&this._evalClusterManager();this.onAggregationInfoChange()},isAggregationEnabled:function(){return this._clusterManager&&
this._clusterManager.isClusteringEnabled()},getAggregationRenderer:function(){return this.isAggregationEnabled()?this._clusterManager.getClusterRenderer():null},getAggregationLayer:function(){return this._clusterManager?this._clusterManager.container:null},_evalClusterManager:function(){var a=this.getAggregationInfo();a?this._canCluster(a)?this._clusterManager?this._updateClusterManager(a):this._clusterManager=this._createClusterManager(a):console.log("FeatureLayer: Clustering is supported only for non-editable point layers in snapshot mode when map spatial reference is WGS84 or WebMercator"):
this._destroyClusterManager()},_canCluster:function(a){var b=this._map.spatialReference;return"cluster"===a.type&&(b.isWebMercator()||4326===b.wkid)&&"esriGeometryPoint"===this.geometryType&&!this.isEditable()&&(this.mode===da.MODE_SNAPSHOT||this.currentMode===da.MODE_SNAPSHOT||this.currentMode===da.MODE_STREAM)},_createClusterManager:function(a){a=new ta({layer:this,aggregationInfo:a});this._clusterHandles=[a.on("renderer-change,mode-change",k.hitch(this,function(){this.onAggregationRendererChange()}))];
a.initialize(this._map);return a},_updateClusterManager:function(a){var b=this._clusterManager;b&&b.setAggregationInfo(a)},_destroyClusterManager:function(){m.forEach(this._clusterHandles,function(a){a.remove()});this._clusterHandles=null;this._clusterManager&&(this._clusterManager.destroy(),this._clusterManager=null)},redraw:function(){this.inherited(arguments);this._clusterManager&&this._clusterManager.redraw();this._trackManager&&this._trackManager.container&&this._trackManager.container.redraw()},
_evalSDRenderer:function(){this.inherited(arguments);var a=this._getRenderer();this._ager=!!(a&&a.observationAger&&a.observationRenderer);this._trackManager&&this._trackManager.container&&this._trackManager.container.setRenderer(a&&a.trackRenderer)},_setMap:function(a){var b=this.inherited(arguments),c=this._mode,f=this;c&&a.loaded&&c.initialize(a);this.geometryType&&this.attr("data-geometry-type",this.geometryType.replace(/esriGeometry/i,"").toLowerCase());this._addHandle=this.on("graphic-node-add",
function(a){a=a.graphic.attributes;(a=f._selectedFeatures[a&&a[f.objectIdField]])&&a.attr("data-selected","")});return b},_unsetMap:function(a){var b=this._mode;b&&b.suspend();this._destroyClusterManager();this._trackManager&&(this._trackManager.destroy(),this._trackManager=null);q.disconnect(this._zoomConnect);q.disconnect(this._addHandle);this._zoomConnect=this._addHandle=null;this._toggleTime(!1);this.inherited("_unsetMap",arguments)},refresh:function(){this._needsRefresh=!1;var a=this._mode;a&&
a.refresh()},hasXYFootprint:function(){return"esriGeometryMultiPatch"===this.geometryType&&"xyFootprint"===this.multipatchOption},getOutFields:function(){return m.filter(this._getOutFields(),function(a){return"*"===a||!!this._getField(a)},this)},getField:function(a){return this._getField(a,!0)},isOutField:function(a){a=this.getField(a);if(!a)return!1;var b=this.getOutFields();return-1<m.indexOf(b,"*")||-1<m.indexOf(b,a.name)},getFieldLabel:function(a){var b=this.infoTemplate,b=b&&b.getFieldInfo&&
b.getFieldInfo(a);a=k.isFunction(a)?null:this.getField(a);var c=b||a,f="";c&&(f=b&&b.label||a&&a.alias||c.name||c.fieldName);return f},getDomain:function(a,b){var c,f,g=b&&b.feature,e=g&&this.typeIdField&&g.attributes&&g.attributes[this.typeIdField];null!=e&&m.some(this.types,function(b){return b.id==e?((c=b.domains&&b.domains[a])&&"inherited"===c.type&&(c=this._getLayerDomain(a),f=!0),!0):!1},this);f||c||(c=this._getLayerDomain(a));return c},_getLayerDomain:function(a){var b;m.some(this.fields,function(c){c.name===
a&&(b=c.domain);return!!b});return b},getType:function(a){var b,c=a&&this.typeIdField&&a.attributes&&a.attributes[this.typeIdField];m.some(this.types,function(a){a.id==c&&(b=a);return!!b});return b},setEditable:function(a){if(!this._collection)return console.log("FeatureLayer:setEditable - this functionality is not yet supported for layer in a feature service"),this;if(!this.loaded)return this._optEditable=a,this;var b=this._editable;this._editable=a;this._updateCaps();if(b!==a)this.onCapabilitiesChange();
return this},getEditCapabilities:function(a){var b={canCreate:!1,canUpdate:!1,canDelete:!1,canUpdateGeometry:!1};if(!this.loaded||!this.isEditable())return b;var c=a&&a.feature;a=a&&a.userId||this.getUserId();var f=m.map(this.capabilities?this.capabilities.toLowerCase().split(","):[],k.trim),g=(b=-1<m.indexOf(f,"editing"))&&-1<m.indexOf(f,"create"),e=b&&-1<m.indexOf(f,"update"),f=b&&-1<m.indexOf(f,"delete"),h=this.ownershipBasedAccessControlForFeatures,d=this.editFieldsInfo,n=d&&d.creatorField,d=
d&&d.realm,c=(c=c&&c.attributes)&&n?c[n]:void 0,t=!!this.userIsAdmin,n=!h||t||!(!h.allowOthersToUpdate&&!h.allowUpdateToOthers),u=!h||t||!(!h.allowOthersToDelete&&!h.allowDeleteToOthers),l=!h||t||!h.hasOwnProperty("allowAnonymousToUpdate")||h.allowAnonymousToUpdate,h=!h||t||!h.hasOwnProperty("allowAnonymousToDelete")||h.allowAnonymousToDelete;a&&d&&(a=a+"@"+d);if(t||b&&!(g||e||f))g=e=f=!0;b={canCreate:g,canUpdate:e,canDelete:f,canUpdateGeometry:t||this.allowGeometryUpdates};a||(b.canUpdate=b.canUpdate&&
l,b.canDelete=b.canDelete&&h);null===c?(b.canUpdate=b.canUpdate&&n,b.canDelete=b.canDelete&&u):""!==c&&c&&a.toLowerCase()!==c.toLowerCase()&&(b.canUpdate=b.canUpdate&&n,b.canDelete=b.canDelete&&u);return b},getUserId:function(){var a;this.loaded&&(a=this.credential&&this.credential.userId||this.userId||"");return a},setUserIsAdmin:function(a){this.userIsAdmin=a},setEditSummaryCallback:function(a){this.editSummaryCallback=a},getEditSummary:function(a,b,c){c=f.isDefined(c)?c:(new Date).getTime();var g=
"";c=this.getEditInfo(a,b,c);(b=b&&b.callback||this.editSummaryCallback)&&(c=b(a,c)||"");if(k.isString(c))g=c;else{if(c){a=c.action;b=c.userId;var e=c.timeValue,h=0;a&&h++;b&&h++;f.isDefined(e)&&h++;1<h&&(g=("edit"===a?"edit":"create")+(b?"User":"")+(f.isDefined(e)?c.displayPattern:""))}g=g&&f.substitute(c,this.i18n.layers.FeatureLayer[g])}return g},getEditInfo:function(a,b,c){if(this.loaded){c=f.isDefined(c)?c:(new Date).getTime();b=b&&b.action||"last";var g=this.editFieldsInfo,e=g&&g.creatorField,
h=g&&g.creationDateField,d=g&&g.editorField,g=g&&g.editDateField,d=(a=a&&a.attributes)&&d?a[d]:void 0,g=a&&g?a[g]:null,e=this._getEditData(a&&e?a[e]:void 0,a&&h?a[h]:null,c);c=this._getEditData(d,g,c);var n;switch(b){case "creation":n=e;break;case "edit":n=c;break;case "last":n=c||e}n&&(n.action=n===c?"edit":"creation");return n}},_getEditData:function(a,b,c){var g,h,d;f.isDefined(b)&&(h=c-b,d=0>h?"Full":6E4>h?"Seconds":12E4>h?"Minute":36E5>h?"Minutes":72E5>h?"Hour":864E5>h?"Hours":6048E5>h?"WeekDay":
"Full");if(void 0!==a||d)g=g||{},g.userId=a,d&&(a=e.format,c=new Date(b),g.minutes=Math.floor(h/6E4),g.hours=Math.floor(h/36E5),g.weekDay=a(c,{datePattern:"EEEE",selector:"date"}),g.formattedDate=a(c,{selector:"date"}),g.formattedTime=a(c,{selector:"time"}),g.displayPattern=d,g.timeValue=b);return g},isEditable:function(){return!(!this._editable&&!this.userIsAdmin)},isQueryable:function(){var a=m.map(this.capabilities?this.capabilities.toLowerCase().split(","):[],k.trim);return this._isStream||this.userIsAdmin||
this._collection||-1!==m.indexOf(a,"query")||-1!==m.indexOf(a,"catalog")},setMaxAllowableOffset:function(a){this.isEditable()||this._setMaxOffset(a,!0);return this},getMaxAllowableOffset:function(){var a=this._quantizationParameters?this._quantizationParameters.tolerance:void 0;return null!=this._maxOffset?this._maxOffset:a},_setMaxOffset:function(a,b){if(null==a)return delete this._maxOffset,delete this._quantizationParameters,this;this.quantize&&this.supportsCoordinatesQuantization?("esriGeometryPolyline"===
this.geometryType?this._maxOffset=a:delete this._maxOffset,this._quantizationParameters={mode:"view",originPosition:"upperLeft",tolerance:a,extent:this.fullExtent}):(this._isFractionalOffsetAllowed()&&b||(a=Math.floor(a)),isNaN(a)||0===a?delete this._maxOffset:this._maxOffset=a,delete this._quantizationParameters);return this},_isFractionalOffsetAllowed:function(){return null==this.version||10.1<=this.version||navigator.languages&&this._isLangWithDot(navigator.languages[0])},_isLangWithDot:function(a){a=
(a=a&&a.split("-"))&&a[0]&&a[0].toLowerCase();return-1!==m.indexOf(this._langsWithDot,a)},_langsWithDot:"ar en et fr he ja ko th vi zh".split(" "),setAutoGeneralize:function(a){this.loaded?this.isEditable()||this.mode===da.MODE_SNAPSHOT||"esriGeometryPolyline"!==this.geometryType&&"esriGeometryPolygon"!==this.geometryType&&!this.hasXYFootprint()||((this._autoGeneralize=a)?(this._autoSnapshot&&(this._prevScale=null),this._updateMaxOffset()):this._setMaxOffset(null)):this._optAutoGen=a;return this},
setGDBVersion:function(a){this._collection||a===this.gdbVersion||!a&&!this.gdbVersion||(this.gdbVersion=a,this._task.gdbVersion=a,this._url.query=k.mixin(this._url.query,{gdbVersion:a}),this.loaded&&(this.clearSelection(),this._map&&this.refresh()),this.onGDBVersionChange());return this},hasAllFeatures:function(){return this._mode?this._mode.hasAllFeatures():!0},setDefinitionExpression:function(a){this._defnExpr=a;(a=this._mode)&&a.propertyChangeHandler(1);return this},getDefinitionExpression:function(){return this._defnExpr},
setTimeDefinition:function(a){this._isSnapshot?(this._timeDefn=a,(a=this._mode)&&a.propertyChangeHandler(2)):console.log("FeatureLayer.setTimeDefinition: layer in on-demand or selection mode does not support time definitions. Layer id \x3d "+this.id+", Layer URL \x3d "+this.url);return this},getTimeDefinition:function(){return this._timeDefn},setTimeOffset:function(a,b){this._timeOffset=a;this._timeOffsetUnits=b;var c=this._mode;c&&c.propertyChangeHandler(0);return this},setUseMapTime:function(a){this.useMapTime=
a;this._toggleTime(!this.suspended);(a=this._mode)&&a.propertyChangeHandler(0)},selectFeatures:function(a,b,c,f){b=b||da.SELECTION_NEW;this._hasPartialSelectedFeatures=!1;a=this._getShallowClone(a);var g=this._map,e,d=this,n=w._fixDfd(new h(w._dfdCanceller));a.outFields=this.getOutFields();a.returnGeometry=!0;a.multipatchOption=this.multipatchOption;g&&(a.outSpatialReference=new z(g.spatialReference.toJson()));if(!this._applyQueryFilters(a,!0))return e={features:[]},this._selectHandler(e,b,c,f,n),
n;if(g=this._canDoClientSideQuery(a))n._pendingDfd=u(this._doQuery(a,g)),n._pendingDfd.then(function(a){e={features:a};d._selectHandler(e,b,c,f,n)});else{if(this._collection)return this._resolve([Error("FeatureLayer::selectFeatures - "+this.invalidParams)],null,f,n,!0),n;if(this.loaded&&!this.isQueryable())return this._resolve([Error("Layer does not support query capability.")],null,f,n,!0),n;var t=this;this._ts&&(a._ts=(new Date).getTime());(n._pendingDfd=this._task.execute(a)).addCallbacks(function(a){t._selectHandler(a,
b,c,f,n)},function(a){t._hasPartialSelectedFeatures=!0;t._resolve([a],null,f,n,!0)})}return n},getSelectedFeatures:function(){var a=this._selectedFeatures,b=[],c;for(c in a)a.hasOwnProperty(c)&&b.push(a[c]);return b},clearSelection:function(a){var b=this._selectedFeatures,c=this._mode,f;for(f in b)b.hasOwnProperty(f)&&(this._unSelectFeatureIIf(f,c),c._removeFeatureIIf(f));this._selectedFeatures={};this._isSelOnly&&c._applyTimeFilter(!0);if(!a)this.onSelectionClear();return this},setSelectionSymbol:function(a){if(this._selectionSymbol=
a){var b=this._selectedFeatures,c;for(c in b)b.hasOwnProperty(c)&&b[c].setSymbol(a)}return this},getSelectionSymbol:function(){return this._selectionSymbol},setLabelingInfo:function(a){a?(this.labelingInfo=a,this._fixLabelExpr()):delete this.labelingInfo;this._collection&&(this._typesDirty=!0);this.onLabelingInfoChange()},_fixLabelExpr:function(){var a=/\[([^\[\]]+)\]/ig,b,c=this,f=function(a,b){var f=c._getField(b,!0);return"["+(f&&f.name||b)+"]"};m.forEach(this.labelingInfo,function(c){if(b=c.labelExpression)c.labelExpression=
b.replace(a,f)})},_updateRequiredFieldsFromLabelingInfo:function(){var a=[];m.forEach(this.labelingInfo,function(b){var c=b.labelExpressionInfo;if(b.labelExpression){var f=/[\[\]]/ig;b=b.labelExpression.match(/\[[^\[\]]+\]/ig);(b=m.map(b,function(a){return a.replace(f,"")}))&&(a=a.concat(b))}if(c){if(c.value){var g=/[\{\}]/ig;b=c.value.match(/\{[^\{\}]+\}/ig);(b=m.map(b,function(a){return a.replace(g,"")}))&&(a=a.concat(b))}c.expression&&(a=a.concat(G.extractFieldNames(c.expression)))}});a=m.map(a,
function(a){var b=this.getField(a);return b?b.name:a},this);this._requiredFields&&(this._requiredFields=this._requiredFields.concat(a))},__msigns:[{n:"applyEdits",c:5,a:[{i:0},{i:1}],e:4,f:1}],applyEdits:function(a,b,c,f,g,e){var h=e.assembly,d=e.dfd;this._applyNormalized(a,h&&h[0]);this._applyNormalized(b,h&&h[1]);this.onBeforeApplyEdits(a,b,c);var n={},t=this.objectIdField,h={f:"json"},u=!1;if(this._collection)e={},e.addResults=a?m.map(a,function(){u=!0;return{objectId:this._nextId++,success:!0}},
this):null,e.updateResults=b?m.map(b,function(a){u=!0;var b=a.attributes[t];n[b]=a;return{objectId:b,success:!0}},this):null,e.deleteResults=c?m.map(c,function(a){u=!0;return{objectId:a.attributes[t],success:!0}},this):null,u?this._editHandler(e,a,n,f,g,d):this._resolve([e.addResults,e.updateResults,e.deleteResults],null,f,d);else{a&&0<a.length&&(h.adds=this._convertFeaturesToJson(a,0,1),u=!0);if(b&&0<b.length){for(e=0;e<b.length;e++){var l=b[e];n[l.attributes[t]]=l}h.updates=this._convertFeaturesToJson(b,
0,0,1);u=!0}if(c&&0<c.length){b=[];for(e=0;e<c.length;e++)b.push(c[e].attributes[t]);h.deletes=b.join(",");u=!0}if(u){var p=this;return v({url:this._url.path+"/applyEdits",content:k.mixin(h,this._url.query),callbackParamName:"callback",load:function(b){p._editHandler(b,a,n,f,g,d)},error:function(a){p._resolve([a],null,g,d,!0)}},{usePost:!0})}this._resolve([],null,f,d)}},queryFeatures:function(a,b,c){return this._query("execute","onQueryFeaturesComplete",a,b,c)},queryRelatedFeatures:function(a,b,c){return this._query("executeRelationshipQuery",
"onQueryRelatedFeaturesComplete",a,b,c)},queryIds:function(a,b,c){return this._query("executeForIds","onQueryIdsComplete",a,b,c)},queryCount:function(a,b,c){return this._query("executeForCount","onQueryCountComplete",a,b,c)},queryExtent:function(a,b,c){return this._query("executeForExtent","onQueryExtentComplete",a,b,c)},queryAttachmentInfos:function(a,c,f){var g=this._url.path+"/"+a+"/attachments",e=new h(w._dfdCanceller),d=this;e._pendingDfd=v({url:g,content:k.mixin({f:"json"},this._url.query),
callbackParamName:"callback",load:function(f){f=f.attachmentInfos;var h;m.forEach(f,function(c){h=b.objectToQuery({gdbVersion:d._url.query&&d._url.query.gdbVersion,layer:d._url.query&&d._url.query.layer,token:d._getToken()});c.url=g+"/"+c.id+(h?"?"+h:"");c.objectId=a});d._resolve([f],"onQueryAttachmentInfosComplete",c,e)},error:function(a){d._resolve([a],null,f,e,!0)}});return e},addAttachment:function(a,b,c,f){return this._sendAttachment("add",a,b,c,f)},updateAttachment:function(b,c,f,g,e){f.appendChild(a.create("input",
{type:"hidden",name:"attachmentId",value:c}));return this._sendAttachment("update",b,f,g,e)},deleteAttachments:function(a,b,c,f){var g=this._url.path+"/"+a+"/deleteAttachments",e=new h(w._dfdCanceller),d=this;b={f:"json",attachmentIds:b.join(",")};e._pendingDfd=v({url:g,content:k.mixin(b,this._url.query),callbackParamName:"callback",load:k.hitch(this,function(b){b=b.deleteAttachmentResults;b=m.map(b,function(b){b=new ca(b);b.attachmentId=b.objectId;b.objectId=a;return b});d._resolve([b],"onDeleteAttachmentsComplete",
c,e)}),error:function(a){d._resolve([a],null,f,e,!0)}},{usePost:!0});return e},addType:function(a){var b=this.types;if(b){if(m.some(b,function(b){return b.id==a.id?!0:!1}))return!1;b.push(a)}else this.types=[a];return this._typesDirty=!0},deleteType:function(a){if(this._collection){var b=this.types;if(b){var c=-1;m.some(b,function(b,f){return b.id==a?(c=f,!0):!1});if(-1<c)return this._typesDirty=!0,b.splice(c,1)[0]}}},toJson:function(){var a=this._json;if(a=k.isString(a)?p.fromJson(a):k.clone(a)){var a=
a.layerDefinition?a:{layerDefinition:a},b=a.layerDefinition,c=this._collection;if(c&&this._typesDirty){b.types=m.map(this.types||[],function(a){return a.toJson()});var f=this.renderer,g=this.labelingInfo,e=b.drawingInfo;!f&&!g||e||(e=b.drawingInfo={});e&&f&&-1===f.declaredClass.indexOf("TemporalRenderer")&&(e.renderer=f.toJson());g&&(e.labelingInfo=m.map(g,function(a){return a.toJson()}))}f=null;if(!c||this._fcAdded)f={geometryType:b.geometryType,features:this._convertFeaturesToJson(this.graphics,
!0)};a.featureSet=k.mixin({},a.featureSet||{},f);a.featureSet.transform&&(g=a.featureSet.transform,delete a.featureSet.transform,f=new M(a.featureSet),f.quantize(g),a.featureSet=f.toJson());c&&(a.nextObjectId=this._nextId,b.capabilities=this.capabilities);return a}},onSelectionComplete:function(){},onSelectionClear:function(){},onBeforeApplyEdits:function(){},onEditsComplete:function(){},onQueryFeaturesComplete:function(){},onQueryRelatedFeaturesComplete:function(){},onQueryIdsComplete:function(){},
onQueryCountComplete:function(){},onQueryExtentComplete:function(){},onQueryAttachmentInfosComplete:function(){},onAddAttachmentComplete:function(){},onUpdateAttachmentComplete:function(){},onDeleteAttachmentsComplete:function(){},onCapabilitiesChange:function(){},onGDBVersionChange:function(){},onQueryLimitExceeded:function(){},onLabelingInfoChange:function(){},onAggregationRendererChange:function(){},onAggregationInfoChange:function(){},_forceIdentity:function(a){var b=this,c,f=this._url&&this._url.path;
c=f&&f.toLowerCase().indexOf("/rest/services");var g=this.editFieldsInfo,g=g&&(g.creatorField||g.editorField);(this.userIsAdmin||g)&&!this._getToken()&&-1<c&&t.id?(c=f.substring(0,c)+"/rest/info",v({url:c,content:{f:"json"},handleAs:"json",callbackParamName:"callback"}).then(function(a){if(a.owningSystemUrl)return t.id.checkSignInStatus(a.owningSystemUrl+"/sharing")}).then(function(a){if(a)return t.id.getCredential(f)}).then(function(a){a&&b._findCredential()}).always(function(){a.call(b)})):a.call(this)},
_checkMode:function(a){var b=this.geometryType,c=this.maxRecordCount;a=(a=a&&a.features&&a.features[0])&&a.attributes&&a.attributes.exceedslimit;this.mode===da.MODE_AUTO&&!this.isEditable()&&0===a&&(this.queryPagination||("esriGeometryPolyline"===b||"esriGeometryPolygon"===b||"esriGeometryMultipoint"===b||this.hasXYFootprint())&&c>=this.maxRecordCountForAuto||"esriGeometryPoint"===b&&c>=this.maxPointCountForAuto)&&(this.currentMode=da.MODE_SNAPSHOT,this._mode=new ea(this),this._isSnapshot=this._autoSnapshot=
!0)},_queryLimit:function(){var a=this,b=new h;this._limitPromise=b.promise;setTimeout(function(){var c=new N,f=new L;f.statisticType="exceedslimit";f.maxPointCount=a.maxPointCountForAuto;f.maxRecordCount=a.maxRecordCountForAuto;f.maxVertexCount=a.maxVertexCountForAuto;f.outStatisticFieldName="exceedslimit";c.outStatistics=[f];a.queryFeatures(c).promise.then(function(a){b.resolve(a)},function(a){b.reject(a)})},0)},_updateCaps:function(){var a=this._editable,b=k.trim(this.capabilities||""),c=m.map(b?
b.split(","):[],k.trim),f=m.map(b?b.toLowerCase().split(","):[],k.trim),b=m.indexOf(f,"editing"),g,f={Create:m.indexOf(f,"create"),Update:m.indexOf(f,"update"),Delete:m.indexOf(f,"delete")};if(a&&-1===b)c.push("Editing");else if(!a&&-1<b){a=[b];for(g in f)-1<f[g]&&a.push(f[g]);a.sort();for(g=a.length-1;0<=g;g--)c.splice(a[g],1)}this.capabilities=c.join(",")},_counter:{value:0},_getUniqueId:function(){return this._counter.value++},onSuspend:function(){this.inherited(arguments);this._toggleTime(!1);
var a=this._mode;a&&a.suspend()},onResume:function(a){this.inherited(arguments);this._toggleTime(!0);var b=this._mode,c=this._map,f=this._getRenderer();a.firstOccurrence?(this._fixRendererFields(),this._updateRequiredFieldsFromLabelingInfo(),this._checkFields(),this.clearSelection(),this._evalClusterManager(),this.timeInfo&&!this._trackManager&&(this._trackIdField||f&&(f.latestObservationRenderer||f.trackRenderer))&&(this._trackManager=new sa(this),this._trackManager.initialize(c),this._childLayer=
this._trackManager.container),f&&"colors"in f&&"blurRadius"in f&&"maxPixelIntensity"in f&&"esriGeometryPoint"==this.geometryType&&!this._heatmapManager&&(this._heatmapManager=new ka(this),this._heatmapManager.initialize(c)),this._autoSnapshot&&this._autoGeneralize&&("esriGeometryPolyline"===this.geometryType||"esriGeometryPolygon"===this.geometryType||this.hasXYFootprint())&&!this.isEditable()&&null==this.getMaxAllowableOffset()&&(f=this.generalizeForScale,this._calculatedScale=f=this.maxScale?this.maxScale:
this.minScale?Math.min(f,this.minScale):Math.min(f,ba.getScale(c,this.initialExtent)),this._calcMaxOffset=c.extent.getWidth()/c.width/c.getScale()*f),this._zoomConnect=q.connect(c,"onZoomEnd",this,this._zoomEndHandler),this._updateMaxOffset(),this._needsRefresh=!1,b&&(b._init||b.initialize(c),b.startup())):(this._zoomEndHandler(),b&&b.resume())},_zoomEndHandler:function(){var a=this._map;this._updateMaxOffset();this._prevScale=a.getScale();!this.suspended&&this._needsRefresh&&this.refresh()},_updateMaxOffset:function(){var a=
this._map;a&&a.loaded&&this._autoGeneralize&&(this._autoSnapshot?(a=this.getMaxAllowableOffset(),this._setMaxOffset(this._getMaxOffsetForScale(),!0),this._needsRefresh||(this._needsRefresh=a!=this.getMaxAllowableOffset())):this._setMaxOffset(a.extent.getWidth()/a.width,!a.extent.spatialReference.isWebMercator()))},_getMaxOffsetForScale:function(){if(this._map){var a=this._map.getScale(),b=this._calculatedScale,c=this._calcMaxOffset,f=this._prevScale;return a>=b&&(null==f||f<b)?c:a<b&&(null==f||f>=
b)?null:this.getMaxAllowableOffset()}},_toggleTime:function(a){var b=this._map;a&&this.timeInfo&&this.useMapTime&&b?(this._mapTimeExtent=b.timeExtent,this._timeConnect||(this._timeConnect=q.connect(b,"onTimeExtentChange",this,this._timeChangeHandler))):(this._mapTimeExtent=null,q.disconnect(this._timeConnect),this._timeConnect=null)},_timeChangeHandler:function(a){this._mapTimeExtent=a;(a=this._mode)&&a.propertyChangeHandler(0)},_getOffsettedTE:function(a){var b=this._timeOffset,c=this._timeOffsetUnits;
return a&&b&&c?a.offset(-1*b,c):a},_getTimeOverlap:function(a,b){return a&&b?a.intersection(b):a||b},_getTimeFilter:function(a){var b=this.getTimeDefinition(),c;if(b&&(c=this._getTimeOverlap(b,null),!c))return[!1];if(a){if(a=c?this._getTimeOverlap(a,c):a,!a)return[!1]}else a=c;return[!0,a]},_getAttributeFilter:function(a){var b=this.getDefinitionExpression();return a?b?"("+b+") AND ("+a+")":a:b},_applyQueryFilters:function(a,b){a.where=this._getAttributeFilter(a.where);!a.returnGeometry||a.maxAllowableOffset||
a.quantizationParameters||(a.maxAllowableOffset=this._maxOffset,a.quantizationParameters=this._quantizationParameters);b&&this.supportsAdvancedQueries&&(a.orderByFields=a.orderByFields||this.getOrderByFields());if(this.timeInfo){var c=this._getTimeFilter(a.timeExtent);if(c[0])a.timeExtent=c[1];else return!1}return!0},_add:function(a){var b=this._selectionSymbol,c=a.attributes,f=this.visibilityField;b&&this._isSelOnly&&a.setSymbol(b);if(f&&c&&c.hasOwnProperty(f))a[c[f]?"show":"hide"]();return this.add.apply(this,
arguments)},_remove:function(){return this.remove.apply(this,arguments)},_canDoClientSideQuery:function(a){var b=[],c=this._map,f;if((this._collection||!this._isTable&&c)&&!(a.text||a.where&&a.where!==this.getDefinitionExpression()||a.orderByFields&&a.orderByFields.length&&(f=this.getOrderByFields()||[])&&a.orderByFields.join()!==f.join()||a.outStatistics||a.returnDistinctValues)){f=this._isSnapshot;var g=this._isSelOnly,e=a.geometry;if(e){if(g||a.spatialRelationship!==N.SPATIAL_REL_INTERSECTS||"extent"!==
e.type||!f&&!c.extent.contains(e))return;b.push(1)}if(c=a.objectIds)if(f)b.push(2);else{var e=c.length,h=this._mode,d=0,n;for(n=0;n<e;n++)h._getFeature(c[n])&&d++;if(d===e)b.push(2);else return}if(this.timeInfo)if(a=a.timeExtent,c=this._mapTimeExtent,f)a&&b.push(3);else if(g){if(a)return}else if(c)if(-1!==m.indexOf(b,2))a&&b.push(3);else if(-1!==m.indexOf(b,1))a==c&&b.push(3);else return;else if(0<b.length)a&&b.push(3);else if(a)return;return 0<b.length?b:null}},_getAbsMid:function(a){return r.toAbsMid?
r.toAbsMid(a):l.id.replace(/\/[^\/]*$/ig,"/")+a},_doQuery:function(a,b,c){var f=[],g=this.objectIdField,e=this,d=new h,n=new h,t=this.graphics;if(-1!==m.indexOf(b,1)){var u=this.spatialIndex||this._map&&this._map.spatialIndex,l,p=a.geometry._normalize(null,!0);null==u&&qa.autoSpatialIndexing?l=(this._map||this).addPlugin(this._getAbsMid("../plugins/spatialIndex")).then(k.hitch(this,k.partial(this._getFromIndex,p,u)),function(a){n.resolve(k.hitch(this,k.partial(this._filterByExtent,t,p)))}):u&&(l=
this._getFromIndex(p,u));l?l.then(function(a){for(var b=0;b<a.length;b++)a[b].results&&(f=f.concat(a[b].results));n.resolve(f)}).otherwise(function(a){n.reject(a)}):n.resolve(this._filterByExtent(t,p))}else n.resolve(t);n.then(function(h){f=h;if(-1!==m.indexOf(b,2)){var n=a.objectIds;f=m.filter(f,function(a){return-1<m.indexOf(n,a.attributes[g])})}-1!==m.indexOf(b,3)&&e.timeInfo&&(h=a.timeExtent,f=e._filterByTime(f,h.startTime,h.endTime).match);c&&(f=m.map(f,function(a){return a.attributes[g]},this));
d.resolve(f)});return d},_getFromIndex:function(a,b){b=b||this.spatialIndex||this._map.spatialIndex;a instanceof Array||(a=[a]);var c=this.id;return n(m.map(a,function(a){return b.intersects(a,c)}))},_filterByExtent:function(a,b){for(var c=[],f=0,g=a.length;f<g;f++){var e=a[f],h=e.geometry;h&&(this.normalization&&b.length?(b[0].intersects(h)||b[1].intersects(h))&&c.push(e):b.intersects(h)&&c.push(e))}return c},_filterByTime:function(a,b,c){var g=this._startTimeField,e=this._endTimeField,h;this._twoTimeFields||
(h=g||e);var d=f.isDefined,n=[],t=[],u,k=a.length,m,l;b=b?b.getTime():-Infinity;c=c?c.getTime():Infinity;if(h)for(u=0;u<k;u++)m=a[u],l=m.attributes,g=l[h],g>=b&&g<=c?n.push(m):t.push(m);else for(u=0;u<k;u++)m=a[u],l=m.attributes,h=l[g],l=l[e],h=d(h)?h:-Infinity,l=d(l)?l:Infinity,h>=b&&h<=c||l>=b&&l<=c||b>=h&&c<=l?n.push(m):t.push(m);return{match:n,noMatch:t}},_getSizeVariables:function(a){return a&&m.filter(a.getVisualVariablesForType("sizeInfo",!1),function(a){return!(!a.field&&!a.valueExpression)})},
_needClientSideSorting:function(a){return this._collection?!(!a||!a.length):m.some(a,function(a){return!!a.valueExpression})},_sortFeatures:function(a){var b=this.renderer,c=this._getSizeVariables(b);if(a&&1<a.length&&this._needClientSideSorting(c)){var f=c[0],g=this;a.sort(function(a,c){a._layer||(a._layer=g);c._layer||(c._layer=g);var e=b._getDataValue(a,f,"sizeInfo",null,g),h=b._getDataValue(c,f,"sizeInfo",null,g);return null==e?-1:null==h?1:h-e})}return a},_resolve:function(a,b,c,f,g){b&&this[b].apply(this,
a);c&&c.apply(null,a);f&&w._resDfd(f,a,g)},_getShallowClone:function(a){var b=new N,c;for(c in a)a.hasOwnProperty(c)&&(b[c]=a[c]);return b},_query:function(a,b,c,f,g){var e=this,d=this._map,n=new h(w._dfdCanceller),t=c,k,l,p;if("executeRelationshipQuery"!==a){var t=this._getShallowClone(c),q=this.getOutFields();t.outFields||(t.outFields=q);t.outFields&&t.outFields.length&&(l=-1<m.indexOf(q,"*")?!1:!m.every(t.outFields,function(a){return-1<m.indexOf(q,a)}));t.returnGeometry=c.hasOwnProperty("returnGeometry")?
c.returnGeometry:!c.outStatistics;t.returnGeometry&&(t.multipatchOption=this.multipatchOption,(t.maxAllowableOffset||t.quantizationParameters)&&(c=t.maxAllowableOffset||t.quantizationParameters.tolerance)&&c!==this.getMaxAllowableOffset()&&(p=!0));var v;d&&(d=d&&d.spatialReference,(c=t.outSpatialReference)?k=!c.equals(d):t.outSpatialReference=new z(d.toJson()));if(!this._applyQueryFilters(t,"execute"===a&&!t.outStatistics)){switch(a){case "execute":v=new M({features:[]});break;case "executeForIds":v=
[];break;case "executeForCount":v=0;break;case "executeForExtent":v={}}this._resolve([v],b,f,n);return n}if(d="executeForExtent"!==a&&!k&&!l&&!p&&this._canDoClientSideQuery(t))return n._pendingDfd=u(this._doQuery(t,d,"executeForIds"===a||"executeForCount"===a)),n._pendingDfd.then(function(c){switch(a){case "execute":v=new M;v.features=c;break;case "executeForIds":v=c;break;case "executeForCount":v=c.length}e._resolve([v],b,f,n)}),n}if(this._collection)return this._resolve([Error("FeatureLayer::_query - "+
this.invalidParams)],null,g,n,!0),n;if(this.loaded&&!this.isQueryable())return this._resolve([Error("Layer does not support query capability.")],null,g,n,!0),n;this._ts&&(t._ts=(new Date).getTime());(n._pendingDfd=this._task[a](t)).addCallbacks(function(c){var g=!!t.outStatistics||k||l||p;if("execute"===a||"executeRelationshipQuery"===a){var h,d;if("execute"===a)for(h=c.features,d=h.length,--d;0<=d;d--){if(h[d]._layer=e,!g&&!e._isTable){var u=e._mode._getFeature(h[d].attributes[e.objectIdField]);
u&&h.splice(d,1,u)}}else for(u in c)if(c.hasOwnProperty(u))for(h=c[u].features,d=h.length,--d;0<=d;d--)h[d]._layer=e}e._resolve([c],b,f,n)},function(a){e._resolve([a],null,g,n,!0)});return n},_convertFeaturesToJson:function(a,b,c,f){var g=[],e=this._selectionSymbol,h=this.visibilityField,d,n=this.objectIdField;this.loaded&&(c||f)&&(d=m.filter(this.fields,function(a){return!1===a.editable&&(!f||a.name!==n)}));for(c=0;c<a.length;c++){var t=a[c],u={},l=t.geometry,q=t.attributes,v=t.symbol;!l||f&&this.loaded&&
!this.allowGeometryUpdates||(u.geometry=l.toJson());h?(u.attributes=q=k.mixin({},q),q[h]=t.visible?1:0):q&&(u.attributes=k.mixin({},q));u.attributes&&d&&d.length&&m.forEach(d,function(a){delete u.attributes[a.name]});v&&v!==e&&(u.symbol=v.toJson());g.push(u)}return b?g:p.toJson(g)},_selectHandler:function(a,b,c,f,g){var e;f=da;switch(b){case f.SELECTION_NEW:this.clearSelection(!0);e=!0;break;case f.SELECTION_ADD:e=!0;break;case f.SELECTION_SUBTRACT:e=!1}f=a.features;var h=this._mode,d=[],n=this.objectIdField,
t,u;if(e)for(e=0;e<f.length;e++)t=f[e],u=t.attributes[n],t=h._addFeatureIIf(u,t),d.push(t),this._selectFeatureIIf(u,t,h);else for(e=0;e<f.length;e++)t=f[e],u=t.attributes[n],this._unSelectFeatureIIf(u,h),u=h._removeFeatureIIf(u),d.push(u||t);this._isSelOnly&&h._applyTimeFilter(!0);this._hasPartialSelectedFeatures=!!a.exceededTransferLimit;this._resolve([d,b,a.exceededTransferLimit?{queryLimitExceeded:!0}:null],"onSelectionComplete",c,g);if(a.exceededTransferLimit)this.onQueryLimitExceeded()},_selectFeatureIIf:function(a,
b,c){var f=this._selectedFeatures,g=f[a];g||(c._incRefCount(a),f[a]=b,this._isTable||(this._setSelectSymbol(b),b.attr("data-selected","")));return g||b},_unSelectFeatureIIf:function(a,b){var c=this._selectedFeatures[a];c&&(b._decRefCount(a),delete this._selectedFeatures[a],this._isTable||(this._setUnSelectSymbol(c),c.attr("data-selected")));return c},_isSelected:function(a){},_setSelectSymbol:function(a){var b=this._selectionSymbol;b&&!this._isSelOnly&&a.setSymbol(b)},_setUnSelectSymbol:function(a){var b=
this._selectionSymbol;b&&!this._isSelOnly&&b===a.symbol&&a.setSymbol(null,!0)},_getOutFields:function(){var a=[this.objectIdField,this.typeIdField,this.creatorField,this._startTimeField,this._endTimeField,this._trackIdField].concat(this._requiredFields).concat(this.dataAttributes),a=m.filter(a,function(a,b,c){return!!a&&m.indexOf(c,a)===b}),b=k.clone(this._outFields);if(b){if(-1!==m.indexOf(b,"*"))return b;m.forEach(a,function(a){-1===m.indexOf(b,a)&&b.push(a)});return b}return a},_checkFields:function(a){var b=
a||this._getOutFields();m.forEach(b,function(a){"*"!==a&&(this._getField(a)||console.debug("esri.layers.FeatureLayer: "+f.substitute({url:this.url,field:a},"unable to find '${field}' field in the layer 'fields' information [url: ${url}]")))},this);a||this._isTable||this._fserver||this._collection||this._isStream||m.some(this.fields,function(a){return a&&"esriFieldTypeGeometry"===a.type?!0:!1})||console.debug("esri.layers.FeatureLayer: "+f.substitute({url:this.url},"unable to find a field of type 'esriFieldTypeGeometry' in the layer 'fields' information. If you are using a map service layer, features will not have geometry [url: ${url}]"))},
_fixFieldCase:function(a,b,c){var f=a&&a[b],g;if(f&&!k.isFunction(f)){if(g=!this._getField(f)&&this._getField(f,!0))f=a[b]=g.name;c&&c.push(f)}return f},_fixRendererFields:function(){var a=this.renderer;this._orderBy=null;this._requiredFields=[];if(a&&0<this.fields.length){var b=[],c,a=m.filter([a,a.observationRenderer,a.latestObservationRenderer,a.trackRenderer],f.isDefined),g=[].concat(a);m.forEach(a,function(a){m.forEach(a.rendererInfos,function(a){a.renderer&&g.push(a.renderer)})});m.forEach(g,
function(a){this._fixFieldCase(a,"attributeField",b);this._fixFieldCase(a,"attributeField2",b);this._fixFieldCase(a,"attributeField3",b);this._fixFieldCase(a.rotationInfo,"field",b);(c=this._fixFieldCase(a.sizeInfo,"field",b))&&!this._orderBy&&(this._orderBy=[c+" DESC"]);this._fixFieldCase(a.sizeInfo,"normalizationField",b);this._fixFieldCase(a.colorInfo,"field",b);this._fixFieldCase(a.colorInfo,"normalizationField",b);this._fixFieldCase(a.field,"field",b);this._fixFieldCase(a.opacityInfo,"field",
b);this._fixFieldCase(a.opacityInfo,"normalizationField",b);m.forEach(a.visualVariables,function(a){c=this._fixFieldCase(a,"field",b);"sizeInfo"===a.type&&c&&!this._orderBy&&(this._orderBy=[c+" DESC"]);this._fixFieldCase(a,"normalizationField",b)},this);var f=m.map(a.getFieldsUsedInExpressions(),function(a){var b=this.getField(a);return b?b.name:a},this);b=b.concat(f);this._orderBy||!a.addBreak||k.isFunction(a.attributeField)||!a.backgroundFillSymbol&&!this._hasSizeDiff(a)||(this._orderBy=[a.attributeField+
" DESC"])},this);this._requiredFields=m.filter(b,f.isDefined)}},_hasSizeDiff:function(a){var b=Number.MAX_VALUE,c=-Number.MAX_VALUE,f,g;m.forEach(a.infos,function(a){if(g=a.symbol){f=0;switch(g.type){case "simplemarkersymbol":f=g.size;break;case "picturemarkersymbol":f=(g.width+g.height)/2;break;case "simplelinesymbol":case "cartographiclinesymbol":f=g.width;break;case "simplefillsymbol":case "picturefillsymbol":f=g.outline&&g.outline.width}f&&(b=Math.min(b,f),c=Math.max(c,f))}});return b!==Number.MAX_VALUE&&
c!==-Number.MAX_VALUE&&1<Math.abs(c-b)},getOrderByFields:function(){var a=this.orderByFields||this._orderBy;return this.supportsAdvancedQueries&&a?m.filter(a,function(a){a=a.split(" ")[0];return!!this._getField(a,!0)},this):null},_getField:function(a,b){var c=this.fields;if(!c||0===c.length)return null;var f;b&&(a=a.toLowerCase());m.some(c,function(c){var g=!1;(g=b?c&&c.name.toLowerCase()===a?!0:!1:c&&c.name===a?!0:!1)&&(f=c);return g});return f},_getDateOpts:function(){this._dtOpts||(this._dtOpts=
{properties:m.map(m.filter(this.fields,function(a){return!(!a||"esriFieldTypeDate"!==a.type)}),function(a){return a.name})});return this._dtOpts},_applyNormalized:function(a,b){a&&b&&m.forEach(a,function(a,c){a&&b[c]&&a.setGeometry(b[c])})},_editHandler:function(a,b,c,f,g,e){g=a.addResults;var h=a.updateResults;a=a.deleteResults;var d,n,t,u,l,p=this.objectIdField,q=this._mode,v=this._isTable;d=this.editFieldsInfo;u=this.getOutFields()||[];var w=d&&d.creatorField,x=d&&d.creationDateField,z=d&&d.editorField,
A=d&&d.editDateField;d=d&&d.realm;-1===m.indexOf(u,"*")&&(w&&-1===m.indexOf(u,w)&&(w=null),x&&-1===m.indexOf(u,x)&&(x=null),z&&-1===m.indexOf(u,z)&&(z=null),A&&-1===m.indexOf(u,A)&&(A=null));var r=x||A?(new Date).getTime():null,y=w||z?this.getUserId():void 0;y&&d&&(y=y+"@"+d);if(g){var B=this.globalIdField;for(d=0;d<g.length;d++)g[d]=new ca(g[d]),v||(n=g[d],n.success&&(t=n.objectId,u=b[d],(l=u._graphicsLayer)&&l!==this&&l.remove(u),l=u.attributes||{},l[p]=t,t=n.globalId,B&&t&&(l[B]=t),w&&(l[w]=y),
z&&(l[z]=y),x&&(l[x]=r),A&&(l[A]=r),u.setAttributes(l),q._init&&q.drawFeature(u)))}if(h)for(d=0;d<h.length;d++)if(h[d]=new ca(h[d]),!v&&(n=h[d],n.success)){t=n.objectId;u=c[t];if(b=q._getFeature(t))b.geometry!==u.geometry&&u.geometry&&b.setGeometry(W.fromJson(u.geometry.toJson())),b.attributes!==u.attributes&&u.attributes&&b.setAttributes(k.mixin(b.attributes,u.attributes)),this._repaint(b,t);u=b||u;l=u.attributes||{};z&&(l[z]=y);A&&(l[A]=r);u.setAttributes(l)}if(a){c=[];for(d=0;d<a.length;d++)if(a[d]=
new ca(a[d]),!v&&(n=a[d],n.success&&(t=n.objectId,u=q._getFeature(t))))this._unSelectFeatureIIf(t,q)&&c.push(u),u._count=0,q._removeFeatureIIf(t);if(0<c.length)this.onSelectionComplete(c,da.SELECTION_SUBTRACT)}this._resolve([g,h,a],"onEditsComplete",f,e)},_sendAttachment:function(a,b,c,f,g){var e=this;return v({url:this._url.path+"/"+b+"/"+("add"===a?"addAttachment":"updateAttachment"),form:c,content:k.mixin(this._url.query,{f:"json",token:this._getToken()||void 0}),callbackParamName:"callback.html",
handleAs:"json"}).addCallback(function(c){var g="add"===a?"onAddAttachmentComplete":"onUpdateAttachmentComplete";c=new ca(c["add"===a?"addAttachmentResult":"updateAttachmentResult"]);c.attachmentId=c.objectId;c.objectId=b;e._resolve([c],g,f);return c}).addErrback(function(a){e._resolve([a],null,g,null,!0)})},_repaint:function(a,b,c){b=f.isDefined(b)?b:a.attributes[this.objectIdField];b in this._selectedFeatures&&this._selectionSymbol||a.setSymbol(a.symbol,c)},_getKind:function(a){var b=this._trackManager;
return b?b.isLatestObservation(a)?1:0:0}});k.mixin(da,{MODE_SNAPSHOT:0,MODE_ONDEMAND:1,MODE_SELECTION:2,SELECTION_NEW:3,SELECTION_ADD:4,SELECTION_SUBTRACT:5,MODE_AUTO:6,MODE_STREAM:7,POPUP_NONE:"esriServerHTMLPopupTypeNone",POPUP_HTML_TEXT:"esriServerHTMLPopupTypeAsHTMLText",POPUP_URL:"esriServerHTMLPopupTypeAsURL"});R._createWrappers(da);return da})},"esri/layers/Field":function(){define("dojo/_base/declare dojo/_base/lang dojo/has ../kernel ./RangeDomain ./CodedValueDomain".split(" "),function(r,
l,d,q,k,m){return r(null,{declaredClass:"esri.layers.Field",constructor:function(d){if(d&&l.isObject(d)&&(this.name=d.name,this.type=d.type,this.alias=d.alias,this.length=d.length,this.editable=d.editable,this.nullable=d.nullable,(d=d.domain)&&l.isObject(d)))switch(d.type){case "range":this.domain=new k(d);break;case "codedValue":this.domain=new m(d)}}})})},"esri/layers/RangeDomain":function(){define("dojo/_base/declare dojo/_base/lang dojo/has ../kernel ../lang ./Domain".split(" "),function(r,l,
d,q,k,m){return r([m],{declaredClass:"esri.layers.RangeDomain",constructor:function(d){d&&l.isObject(d)&&(this.minValue=d.range[0],this.maxValue=d.range[1])},toJson:function(){var d=this.inherited(arguments);d.range=[this.minValue,this.maxValue];return k.fixJson(d)}})})},"esri/layers/Domain":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/has","../kernel","../lang"],function(r,l,d,q,k){return r(null,{declaredClass:"esri.layers.Domain",constructor:function(d){d&&l.isObject(d)&&(this.name=
d.name,this.type=d.type)},toJson:function(){return k.fixJson({name:this.name,type:this.type})}})})},"esri/layers/CodedValueDomain":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/has ../kernel ../lang ./Domain".split(" "),function(r,l,d,q,k,m,p){return r([p],{declaredClass:"esri.layers.CodedValueDomain",constructor:function(d){d&&l.isObject(d)&&(this.codedValues=d.codedValues)},getName:function(h){var e;d.some(this.codedValues,function(c){c.code==h&&(e=c.name);return!!e});
return e},toJson:function(){var d=this.inherited(arguments);d.codedValues=l.clone(this.codedValues);return m.fixJson(d)}})})},"esri/layers/FeatureType":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/has ../kernel ../lang ../symbols/jsonUtils ./RangeDomain ./CodedValueDomain ./InheritedDomain ./FeatureTemplate".split(" "),function(r,l,d,q,k,m,p,h,e,c,b){return r(null,{declaredClass:"esri.layers.FeatureType",constructor:function(a){if(a&&l.isObject(a)){this.id=a.id;this.name=
a.name;var g=a.symbol;g&&(this.symbol=p.fromJson(g));var g=a.domains,d,n=this.domains={};for(d in g)if(g.hasOwnProperty(d)){var t=g[d];switch(t.type){case "range":n[d]=new h(t);break;case "codedValue":n[d]=new e(t);break;case "inherited":n[d]=new c(t)}}if(d=a.templates)for(g=this.templates=[],a=0;a<d.length;a++)g.push(new b(d[a]))}},toJson:function(){var a={id:this.id,name:this.name,symbol:this.symbol&&this.symbol.toJson()},b,c=this.domains,e=this.templates,h=m.fixJson;if(c){var f=a.domains={};for(b in c)c.hasOwnProperty(b)&&
(f[b]=c[b]&&c[b].toJson());h(f)}e&&(a.templates=d.map(e,function(a){return a.toJson()}));return h(a)}})})},"esri/layers/InheritedDomain":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/has","../kernel","./Domain"],function(r,l,d,q,k){return r([k],{declaredClass:"esri.layers.InheritedDomain"})})},"esri/layers/FeatureTemplate":function(){define("dojo/_base/declare dojo/_base/lang dojo/has ../kernel ../lang ../graphic".split(" "),function(r,l,d,q,k,m){r=r(null,{declaredClass:"esri.layers.FeatureTemplate",
constructor:function(d){d&&l.isObject(d)&&(this.name=d.name,this.description=d.description,this.drawingTool=d.drawingTool,this.thumbnail=d.thumbnail,d=d.prototype,this.prototype=new m(d.geometry,null,d.attributes))},toJson:function(){return k.fixJson({name:this.name,description:this.description,drawingTool:this.drawingTool,thumbnail:k.fixJson(l.clone(this.thumbnail)),prototype:this.prototype&&this.prototype.toJson()})}});l.mixin(r,{TOOL_AUTO_COMPLETE_POLYGON:"esriFeatureEditToolAutoCompletePolygon",
TOOL_CIRCLE:"esriFeatureEditToolCircle",TOOL_ELLIPSE:"esriFeatureEditToolEllipse",TOOL_FREEHAND:"esriFeatureEditToolFreehand",TOOL_LINE:"esriFeatureEditToolLine",TOOL_NONE:"esriFeatureEditToolNone",TOOL_POINT:"esriFeatureEditToolPoint",TOOL_POLYGON:"esriFeatureEditToolPolygon",TOOL_RECTANGLE:"esriFeatureEditToolRectangle",TOOL_ARROW:"esriFeatureEditToolArrow",TOOL_TRIANGLE:"esriFeatureEditToolTriangle",TOOL_LEFT_ARROW:"esriFeatureEditToolLeftArrow",TOOL_RIGHT_ARROW:"esriFeatureEditToolRightArrow",
TOOL_UP_ARROW:"esriFeatureEditToolUpArrow",TOOL_DOWN_ARROW:"esriFeatureEditToolDownArrow"});return r})},"esri/layers/FeatureEditResult":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/has","../kernel"],function(r,l,d,q){return r(null,{declaredClass:"esri.layers.FeatureEditResult",constructor:function(d){d&&l.isObject(d)&&(this.objectId=d.objectId,this.globalId=d.globalId,this.success=d.success,d.success||(d=d.error,this.error=Error(),this.error.code=d.code,this.error.message=d.description))}})})},
"esri/layers/LabelClass":function(){define("dojo/_base/declare dojo/_base/lang dojo/has dojox/gfx/_base ../kernel ../lang ../symbols/TextSymbol ../symbols/ShieldLabelSymbol".split(" "),function(r,l,d,q,k,m,p,h){var e=RegExp("__begin__","ig"),c=RegExp("__end__","ig"),b=/^__begin__/i,a=/__end__$/i;return r(null,{declaredClass:"esri.layers.LabelClass",labelPlacement:null,labelExpression:null,format:null,fieldInfos:null,useCodedValues:null,symbol:null,maxScale:0,minScale:0,where:null,sizeInfo:null,_labelPlacementLookup:{"above-center":"esriServerPointLabelPlacementAboveCenter",
"above-left":"esriServerPointLabelPlacementAboveLeft","above-right":"esriServerPointLabelPlacementAboveRight","below-center":"esriServerPointLabelPlacementBelowCenter","below-left":"esriServerPointLabelPlacementBelowLeft","below-right":"esriServerPointLabelPlacementBelowRight","center-center":"esriServerPointLabelPlacementCenterCenter","center-left":"esriServerPointLabelPlacementCenterLeft","center-right":"esriServerPointLabelPlacementCenterRight","above-after":"esriServerLinePlacementAboveAfter",
"above-along":"esriServerLinePlacementAboveAlong","above-before":"esriServerLinePlacementAboveBefore","above-start":"esriServerLinePlacementAboveStart","above-end":"esriServerLinePlacementAboveEnd","below-after":"esriServerLinePlacementBelowAfter","below-along":"esriServerLinePlacementBelowAlong","below-before":"esriServerLinePlacementBelowBefore","below-start":"esriServerLinePlacementBelowStart","below-end":"esriServerLinePlacementBelowEnd","center-after":"esriServerLinePlacementCenterAfter","center-along":"esriServerLinePlacementCenterAlong",
"center-before":"esriServerLinePlacementCenterBefore","center-start":"esriServerLinePlacementCenterStart","center-end":"esriServerLinePlacementCenterEnd","always-horizontal":"esriServerPolygonPlacementAlwaysHorizontal"},constructor:function(a){a&&(l.mixin(this,a),this._labelPlacementLookup.hasOwnProperty(this.labelPlacement)||(this.labelPlacement=m.valueOf(this._labelPlacementLookup,a.labelPlacement)),a.format&&(this.format=a.format),a.fieldInfos&&(this.fieldInfos=a.fieldInfos),a.symbol&&(this.symbol=
"esriSHD"===a.symbol.type?new h(a.symbol):new p(a.symbol)),a=this.sizeInfo)&&(a.minSize&&(a.minSize=q.pt2px(a.minSize)),a.maxSize&&(a.maxSize=q.pt2px(a.maxSize)))},getSymbol:function(){return this.symbol},toJson:function(){var a=this.sizeInfo;a&&(a=l.mixin({},a),a.minSize&&(a.minSize=q.px2pt(a.minSize)),a.maxSize&&(a.maxSize=q.px2pt(a.maxSize)));var b=m.fixJson(this.labelExpressionInfo&&l.clone(this.labelExpressionInfo));this._processLabelExpressionInfo(b);a={name:this.name,labelExpression:this.labelExpression,
labelExpressionInfo:b,format:this.format||void 0,fieldInfos:this.fieldInfos||void 0,useCodedValues:this.useCodedValues,maxScale:this.maxScale,minScale:this.minScale,where:this.where,sizeInfo:a||void 0,labelPlacement:this._labelPlacementLookup.hasOwnProperty(this.labelPlacement)?this._labelPlacementLookup[this.labelPlacement]:this.labelPlacement,symbol:this.symbol&&this.symbol.toJson()};return m.fixJson(a)},_processLabelExpressionInfo:function(a){a&&a.value&&(a.expression=this._convertTemplatedStringToArcade(a.value))},
_convertTemplatedStringToArcade:function(g){var d;g&&(d=l.replace(g,function(a,b){return'__begin__$feature["'+b+'"]__end__'}),d=b.test(d)?d.replace(b,""):'"'+d,d=a.test(d)?d.replace(a,""):d+'"',d=d.replace(e,'" + ').replace(c,' + "'));return d}})})},"esri/symbols/ShieldLabelSymbol":function(){define("dojo/_base/declare dojo/_base/lang dojo/sniff dojox/gfx/_base ../kernel ../lang ../urlUtils ./MarkerSymbol ./Font".split(" "),function(r,l,d,q,k,m,p,h,e){var c={url:"",width:12,height:12,angle:0,xoffset:0,
yoffset:0};r=r(h,{declaredClass:"esri.symbol.ShieldLabelSymbol",type:"shieldlabelsymbol",color:[255,255,255,1],width:32,height:32,font:q.defaultFont,constructor:function(b,a,g,e,h){b?l.isString(b)?(this.url=b,a&&(this.color=a),g&&(this.width=g),e&&(this.height=e),void 0!==h&&(this.font=h)):(this.width=q.pt2px(b.width),this.height=q.pt2px(b.height),a=b.imageData,9>d("ie")||!a||(g=this.url,this.url="data:"+(b.contentType||"image")+";base64,"+a,this.imageData=g)):l.mixin(this,c)},getStroke:function(){return null},
getFill:function(){return this.color},setWidth:function(b){this.width=b;return this},setHeight:function(b){this.height=b;return this},setUrl:function(b){b!==this.url&&(delete this.imageData,delete this.contentType);this.url=b;return this},setFont:function(b){this.font=b;return this},setText:function(b){this.text=b;return this},getWidth:function(){return this.width},getHeight:function(){return this.height},getShapeDescriptors:function(){return{defaultShape:{type:"image",x:-Math.round(this.width/2),
y:-Math.round(this.height/2),width:this.width,height:this.height,src:this.url||""},fill:null,stroke:null}},toJson:function(){var b=this.url,a=this.imageData;if(0===b.indexOf("data:"))var c=b,b=a,a=c.indexOf(";base64,")+8,a=c.substr(a);var b=p.getAbsoluteUrl(b),c=q.px2pt(this.width),c=isNaN(c)?void 0:c,d=q.px2pt(this.height),d=isNaN(d)?void 0:d,b=m.fixJson(l.mixin(this.inherited("toJson",arguments),{type:"esriSHD",url:b,imageData:a,contentType:this.contentType,width:c,height:d}));this.font?(a=new e(this.font),
b.font=a.toJson()):b.font=null;delete b.size;b.imageData||delete b.imageData;return b}});r.defaultProps=c;return r})},"esri/layers/SnapshotMode":function(){define("dojo/_base/declare dojo/_base/lang dojo/has ../kernel ../SpatialReference ../tasks/query ./RenderMode ../srUtils".split(" "),function(r,l,d,q,k,m,p,h){return r([p],{declaredClass:"esri.layers._SnapshotMode",maxFeatures:5E4,constructor:function(e){this.featureLayer=e;this.pagination=e.queryPagination;this._featureMap={};this._hasPartialFeatures=
!1;this._drawFeatures=l.hitch(this,this._drawFeatures);this._queryErrorHandler=l.hitch(this,this._queryErrorHandler)},startup:function(){this.pagination=this.pagination&&null!=this.featureLayer.maxRecordCount;this.featureLayer._collection?this._applyTimeFilter():this._fetchAll()},propertyChangeHandler:function(e){this._init&&(e?this.featureLayer._collection?console.log("FeatureLayer: layer created by value (from a feature collection) does not support definition expressions and time definitions. Layer id \x3d "+
this.featureLayer.id):this._fetchAll():this._applyTimeFilter())},drawFeature:function(e){var c=e.attributes[this.featureLayer.objectIdField];this._addFeatureIIf(c,e);this._incRefCount(c)},resume:function(){this.propertyChangeHandler(0)},refresh:function(){var e=this.featureLayer;e._collection?(e._fireUpdateStart(),e._refresh(!0),e._fireUpdateEnd()):this._fetchAll()},hasAllFeatures:function(){return!this._hasPartialFeatures},_getRequestId:function(e){return("_"+e.name+e.layerId+e._ulid).replace(/[^a-zA-Z0-9\_]+/g,
"_")},_fetchAll:function(){var e=this.featureLayer;e._collection||e.suspended||!e.isQueryable()||(e._fireUpdateStart(),this._clearIIf(),this._hasPartialFeatures=!1,this._sendRequest())},_sendRequest:function(e){var c=this.map,b=this.featureLayer,a=b.getDefinitionExpression(),g=new m;g.outFields=b.getOutFields();g.where=a||"1\x3d1";g.returnGeometry=!0;g.outSpatialReference=h.createSpatialReference(c.spatialReference.toJson());g.timeExtent=b.getTimeDefinition();g.maxAllowableOffset=b._maxOffset;g.quantizationParameters=
b._quantizationParameters;b._ts&&(g._ts=(new Date).getTime());g.orderByFields=b.supportsAdvancedQueries?b.getOrderByFields():null;g.multipatchOption=b.multipatchOption;this.pagination&&(this._start=g.start=null==e?0:e,g.num=b.maxRecordCount);var d;b._usePatch&&(d=this._getRequestId(b),this._cancelPendingRequest(null,d));b._task.execute(g,this._drawFeatures,this._queryErrorHandler,d)},_drawFeatures:function(e){this._purgeRequests();var c=e.features,b=this.featureLayer,a=b.objectIdField,g,d=c.length,
h=e.exceededTransferLimit&&!b._collection,t=b._selectedFeatures,f=b.mode===b.constructor.MODE_AUTO;g=c?c.length:0;var k=b.graphics.length+g,m=k>=this.maxFeatures,l,p;b._fireUpdateStart();m&&(k-=this.maxFeatures)&&c.splice(g-k,k);b._sortFeatures(c);for(g=0;g<d;g++)l=c[g],p=l.attributes[a],k=this._addFeatureIIf(p,l),this._incRefCount(p),f&&k!==l&&t[p]&&(k.setGeometry(l.geometry),k.setAttributes(l.attributes));this._applyTimeFilter(!0);this.pagination&&h&&!m||(this._hasPartialFeatures=!!e.exceededTransferLimit,
b._fireUpdateEnd(null,e.exceededTransferLimit?{queryLimitExceeded:!0}:null));h&&(this.pagination&&!m&&this._sendRequest(this._start+b.maxRecordCount),b.onQueryLimitExceeded())},_queryErrorHandler:function(e){this._purgeRequests();this._hasPartialFeatures=!0;var c=this.featureLayer;c._errorHandler(e);c._fireUpdateEnd(e)}})})},"esri/layers/RenderMode":function(){define("dojo/_base/kernel dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/has dojo/io/script ../kernel".split(" "),function(r,l,d,
q,k,m,p){return l(null,{declaredClass:"esri.layers._RenderMode",constructor:function(){this._prefix="jsonp_"+(r._scopeName||"dojo")+"IoScript"},initialize:function(d){this.map=d;this._init=!0},startup:function(){},propertyChangeHandler:function(d){},destroy:function(){this._init=!1},drawFeature:function(d){},suspend:function(){},resume:function(){},refresh:function(){},hasAllFeatures:function(){return!0},_incRefCount:function(d){(d=this._featureMap[d])&&d._count++},_decRefCount:function(d){(d=this._featureMap[d])&&
d._count--},_getFeature:function(d){return this._featureMap[d]},_addFeatureIIf:function(d,e){var c=this._featureMap,b=c[d],a=this.featureLayer;b||(c[d]=e,a._add(e),e._count=0);return b||e},_removeFeatureIIf:function(d){var e=this._featureMap[d],c=this.featureLayer;if(e){if(e._count)return;delete this._featureMap[d];c._remove(e)}return e},_clearIIf:function(){var d;d=this.featureLayer;var e=d.graphics,c=d._selectedFeatures,b=d.getSelectedFeatures().length,a=d.objectIdField;if(b)for(d=e.length-1;0<=
d;d--){var b=e[d],g=b.attributes[a];g in c?b._count=1:(b._count=0,this._removeFeatureIIf(g))}else d.clear(),this._featureMap={}},_isPending:function(d){return m[this._prefix+d]?!0:!1},_cancelPendingRequest:function(d,e){if(d=d||m[this._prefix+e])try{d.cancel(),m._validCheck(d)}catch(c){}},_purgeRequests:function(){m._validCheck(null)},_toggleVisibility:function(d){var e=this.featureLayer,c=e.graphics,b=d?"show":"hide",a,g=c.length;d=d&&e._ager;for(a=0;a<g;a++){var h=c[a];h[b]();d&&e._repaint(h)}},
_applyTimeFilter:function(d){var e=this.featureLayer;if(e.timeInfo&&!e.suspended){d||e._fireUpdateStart();var c=e._trackManager;c&&c.clearTracks();var b=e.getTimeDefinition(),a=e._getOffsettedTE(e._mapTimeExtent);a?(a=e._getTimeOverlap(b,a))?(b=e._filterByTime(e.graphics,a.startTime,a.endTime),c&&c.addFeatures(b.match),q.forEach(b.match,function(a){var b=a._shape;a.visible||(a.show(),(b=a._shape)&&b._moveToFront());e._ager&&b&&e._repaint(a)}),q.forEach(b.noMatch,function(a){a.visible&&a.hide()})):
this._toggleVisibility(!1):(c&&c.addFeatures(e.graphics),this._toggleVisibility(!0));c&&(c.moveLatestToFront(),c.drawTracks());d||e._fireUpdateEnd()}}})})},"esri/layers/OnDemandMode":function(){define("dojo/_base/declare dojo/_base/connect dojo/_base/lang dojo/_base/array dojo/has ../kernel ../geometry/Point ../tasks/query ./RenderMode ./GridLayout".split(" "),function(r,l,d,q,k,m,p,h,e,c){return r([e],{declaredClass:"esri.layers._OnDemandMode",constructor:function(b){this.featureLayer=b;this._featureMap=
{};this._hasPartialFeatures=!1;this._queryErrorHandler=d.hitch(this,this._queryErrorHandler)},initialize:function(b){this.inherited(arguments);var a=this.featureLayer,g=a._srInfo;this._gridLayer=new c(new p(g?g.valid[0]:b.extent.xmin,g?g.valid[1]:b.extent.ymax,b.spatialReference),{width:a._tileWidth,height:a._tileHeight},{width:b.width,height:b.height},g);this._cellMap={};this._gridLayer.setResolution(b.extent)},startup:function(){this._ioQueue=[];this.featureLayer.suspended||(this._zoomHandler(),
this._enableConnectors())},propertyChangeHandler:function(b){this._init&&(2>b?this._zoomHandler():console.log("FeatureLayer: layer in on-demand mode does not support time definitions. Layer id \x3d "+this.featureLayer.id+", Layer URL \x3d "+this.featureLayer.url))},destroy:function(){this._disableConnectors();this.inherited(arguments)},drawFeature:function(b){var a=b.geometry,c=[];if(a){var c=this._gridLayer.getCellsInExtent("point"===a.type?{xmin:a.x,ymin:a.y,xmax:a.x,ymax:a.y}:a.getExtent(),!1).cells,
a=this._cellMap,e,d,h=b.attributes[this.featureLayer.objectIdField],f,k,m;for(e=0;e<c.length;e++)d=c[e],f=d.latticeID,k=d.row,m=d.col,f?d=a[f]=a[f]||d:(a[k]=a[k]||{},d=a[k][m]=a[k][m]||d),d.features=d.features||[],d.features.push(b),this._addFeatureIIf(h,b),this._incRefCount(h)}},suspend:function(){this._init&&this._disableConnectors()},resume:function(){this._init&&(this._enableConnectors(),this._zoomHandler())},refresh:function(){this._zoomHandler()},hasAllFeatures:function(){if(this._hasPartialFeatures)return!0;
var b=!1,a=this._getCurrentCells(),c;for(c=0;c<a.length;c++)if(a[c].hasPartialFeatures){b=!0;break}return!b},_enableConnectors:function(){var b=this.map;this._zoomConnect=l.connect(b,"onZoomEnd",this,this._zoomHandler);this._panConnect=l.connect(b,"onPanEnd",this,this._panHandler);this._resizeConnect=l.connect(b,"onResize",this,this._panHandler)},_disableConnectors:function(){l.disconnect(this._zoomConnect);l.disconnect(this._panConnect);l.disconnect(this._resizeConnect)},_zoomHandler:function(){this._processIOQueue(!0);
var b=this.featureLayer,a=this.map;!b.suspended&&b.isQueryable()&&(b._fireUpdateStart(),this._clearIIf(),this._hasPartialFeatures=!1,(b=b._trackManager)&&b.clearTracks(),this._cellMap={},this._gridLayer.setResolution(a.extent),this._sendRequest())},_panHandler:function(b){if(this.featureLayer.isQueryable()){this.featureLayer._fireUpdateStart();var a=this.featureLayer._resized;b=a?b:null;a&&this._gridLayer.setMapState(b,this.map.width,this.map.height);this._sendRequest(b)}},_getRequestId:function(b,
a){return("_"+b.name+b.layerId+b._ulid+"_"+a.resolution+"_"+(a.latticeID||a.row+"_"+a.col)).replace(/[^a-zA-Z0-9\_]+/g,"_")},_sendRequest:function(b){this._exceeds=!1;var a=this.featureLayer,c=this.map;b=b||c.extent;c=this._gridLayer.getCellsInExtent(b,a.latticeTiling).cells;if(!a.isEditable())var e=this._cellMap,c=q.filter(c,function(a){if(a.lattice){if(e[a.latticeID])return!1}else if(e[a.row]&&e[a.row][a.col])return!1;return!0});var d=a.getOutFields(),t=a.getDefinitionExpression(),f=a._getOffsettedTE(a._mapTimeExtent),
k=a.supportsAdvancedQueries?a.getOrderByFields():null,m=a._usePatch,l=this._ioQueue,p,A=this,r=this._drawFeatures,B,C,E;this._pending=this._pending||0;for(p=0;p<c.length;p++){B=c[p];C=new h;C.geometry=B.extent||B.lattice;C.outFields=d;C.where=t;a.latticeTiling&&B.extent&&(C.spatialRelationship=h.SPATIAL_REL_CONTAINS);C.returnGeometry=!0;C.timeExtent=f;a._ts&&(C._ts=(new Date).getTime());C.orderByFields=k;C.multipatchOption=a.multipatchOption;C.maxAllowableOffset=a._maxOffset;C.quantizationParameters=
a._quantizationParameters;(E=a.advancedQueryCapabilities)&&E.supportsQueryWithResultType&&(C.resultType="tile");E=null;if(m&&(E=this._getRequestId(a,B),this._isPending(E)))continue;this._pending++;l.push(a._task.execute(C,function(){var a=B;return function(b){r.apply(A,[b,a])}}.call(this),this._queryErrorHandler,E))}this._removeOldCells(b);this._endCheck()},_drawFeatures:function(b,a){a.hasPartialFeatures=!!b.exceededTransferLimit;this._exceeds=this._exceeds||b.exceededTransferLimit;this._finalizeIO();
var c=this.featureLayer,e=this.map.extent,d=a.extent,h=a.row,f=a.col,k=c.objectIdField,m=b.features,l=this._gridLayer,p=this._cellMap,q=a.latticeID,r=q?p[q]:p[h]&&p[h][f];if(a.resolution==l._resolution&&(q?q===l.getLatticeID(e):l.intersects(d,e)))if(r)c._sortFeatures(m),this._updateCell(r,m);else for(c._sortFeatures(m),a.features=m,q?p[q]=a:(p[h]=p[h]||{},p[h][f]=a),e=m.length,c=0;c<e;c++)d=m[c],h=d.attributes[k],this._addFeatureIIf(h,d),this._incRefCount(h);else r&&this._removeCell(h,f,q);this._endCheck()},
_queryErrorHandler:function(b){this._finalizeIO();this._hasPartialFeatures=!0;this.featureLayer._errorHandler(b);this._endCheck(!0)},_finalizeIO:function(){this._purgeRequests();this._pending--},_endCheck:function(b){if(0===this._pending){this._processIOQueue();var a=this.featureLayer,c=a._trackManager;c&&(c.clearTracks(),c.addFeatures(a.graphics),a._ager&&q.forEach(a.graphics,function(b){b._shape&&a._repaint(b)}),c.moveLatestToFront(),c.drawTracks());this.featureLayer._fireUpdateEnd(b&&Error("FeatureLayer: an error occurred while updating the layer"),
this._exceeds?{queryLimitExceeded:!0}:null);if(this._exceeds)a.onQueryLimitExceeded()}},_processIOQueue:function(b){this._ioQueue=q.filter(this._ioQueue,function(a){return-1<a.fired?!1:!0});b&&q.forEach(this._ioQueue,this._cancelPendingRequest)},_getCurrentCells:function(b){var a=[];b=b||this._cellMap;for(var c in b)if(b.hasOwnProperty(c)){var e=b[c];e&&(e.hasOwnProperty("row")||e.hasOwnProperty("latticeID")?a.push(e):"object"===typeof e&&a.push.apply(a,this._getCurrentCells(e)))}return a},_removeOldCells:function(b){var a=
this._cellMap,c=this._gridLayer,e,d;for(e in a)if(a[e]){var h=a[e],f=h.latticeID,k=0,m=0;if(f)k++,f!==c.getLatticeID(b)&&(this._removeCell(null,null,f),m++);else for(d in h)h[d]&&(k++,c.intersects(h[d].extent,b)||(this._removeCell(e,d),m++));m===k&&delete a[e]}},_updateCell:function(b,a){var c=this.featureLayer,e=c.objectIdField,c=c._selectedFeatures,d,h=a.length;b.features=b.features||[];for(d=0;d<h;d++){var f=a[d],k=f.attributes[e],m=this._addFeatureIIf(k,f);m===f?(this._incRefCount(k),b.features.push(m)):
k in c||(m.setGeometry(f.geometry),m.setAttributes(f.attributes))}},_removeCell:function(b,a,c){var g=this._cellMap,e=this.featureLayer,d=e.objectIdField,f=c?g[c]:g[b]&&g[b][a];if(f)for(c?delete g[c]:delete g[b][a],b=f.features,a=0;a<b.length;a++)c=b[a].attributes[d],this._decRefCount(c),c in e._selectedFeatures||this._removeFeatureIIf(c)}})})},"esri/layers/GridLayout":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/has ../kernel ../SpatialReference ../geometry/Extent ../geometry/Polyline ../srUtils".split(" "),
function(r,l,d,q,k,m,p,h,e){return r(null,{declaredClass:"esri.layers._GridLayout",constructor:function(c,b,a,g){this.origin=c;this.cellWidth=b.width;this.cellHeight=b.height;this.mapWidth=a.width;this.mapHeight=a.height;this.srInfo=g},setResolution:function(c){this._resolution=(c.xmax-c.xmin)/this.mapWidth;this.srInfo&&(c=Math.round(Math.round(2*this.srInfo.valid[1]/this._resolution)/this.cellWidth),this._frameStats=[c,0,c-1])},setMapState:function(c,b,a){this.mapWidth=b;this.mapHeight=a;this.setResolution(c)},
getCellCoordinates:function(c){var b=this._resolution,a=this.origin;return{row:Math.floor((a.y-c.y)/(this.cellHeight*b)),col:Math.floor((c.x-a.x)/(this.cellWidth*b))}},normalize:function(c){var b=this._frameStats;if(b){var a=b[0],g=b[1],b=b[2];c<g?(c%=a,c=c<g?c+a:c):c>b&&(c%=a)}return c},intersects:function(c,b){var a=this.srInfo;return a?d.some(b._getParts(a),function(a){return c.intersects(a.extent)}):c.intersects(b)},getCellExtent:function(c,b){var a=this._resolution,g=this.origin,d=this.cellWidth,
h=this.cellHeight;return new p(b*d*a+g.x,g.y-(c+1)*h*a,(b+1)*d*a+g.x,g.y-c*h*a,e.createSpatialReference(g.spatialReference.toJson()))},getLatticeID:function(c){var b=this.getCellCoordinates({x:c.xmin,y:c.ymax}),a=this.getCellCoordinates({x:c.xmax,y:c.ymin});c=b.row;var g=a.row,b=this.normalize(b.col),a=this.normalize(a.col);return c+"_"+g+"_"+b+"_"+a},sorter:function(c,b){return c<b?-1:1},getCellsInExtent:function(c,b){var a=this.getCellCoordinates({x:c.xmin,y:c.ymax}),g=this.getCellCoordinates({x:c.xmax,
y:c.ymin}),e=a.row,n=g.row,a=a.col,g=g.col,t=[],f,k,m,l=[],p=[],q,r,B,C,E=[];for(f=e;f<=n;f++)for(k=a;k<=g;k++)m=this.normalize(k),c=this.getCellExtent(f,m),d.some(t,function(a){return a.row===f&&a.col===m})||t.push({row:f,col:m,extent:c,resolution:this._resolution}),b&&(l.push(c.xmin,c.xmax),p.push(c.ymin,c.ymax));a=this.normalize(a);g=this.normalize(g);l.sort(this.sorter);p.sort(this.sorter);k=l.length;for(f=k-1;0<=f;f--)f<k-1&&l[f]===l[f+1]&&l.splice(f,1);k=p.length;for(f=k-1;0<=f;f--)f<k-1&&p[f]===
p[f+1]&&p.splice(f,1);if(l.length&&p.length){q=l[0];r=l[l.length-1];B=p[0];C=p[p.length-1];k=l.length;for(f=0;f<k;f++)E.push([[l[f],C],[l[f],B]]);k=p.length;for(f=0;f<k;f++)E.push([[q,p[f]],[r,p[f]]]);l=new h({paths:E,spatialReference:this.origin.spatialReference.toJson()});t.push({latticeID:e+"_"+n+"_"+a+"_"+g,lattice:l,resolution:this._resolution})}return{minRow:e,maxRow:n,minCol:a,maxCol:g,cells:t}}})})},"esri/layers/SelectionMode":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/has",
"../kernel","./RenderMode"],function(r,l,d,q,k){return r([k],{declaredClass:"esri.layers._SelectionMode",constructor:function(d){this.featureLayer=d;this._featureMap={}},propertyChangeHandler:function(d){this._init&&0===d&&this._applyTimeFilter()},resume:function(){this.propertyChangeHandler(0)},hasAllFeatures:function(){return!this.featureLayer._hasPartialSelectedFeatures}})})},"esri/layers/StreamMode":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/has ../kernel ../SpatialReference ../tasks/query ../tasks/QueryTask ../geometry/jsonUtils ./RenderMode".split(" "),
function(r,l,d,q,k,m,p,h,e,c){return r([c],{declaredClass:"esri.layers._StreamMode",constructor:function(b,a){this.featureLayer=b;this._featureMap={};this._setRefreshRate();this._drawBuffer={adds:[],updates:[]};this._timeoutId=null;this._flushDrawBuffer=l.hitch(this,this._flushDrawBuffer);this._featuresByTime={};this._lastEndTimeCheck=null;this._maxFeatureAge=0;b.purgeOptions&&b.purgeOptions.age&&"number"===typeof b.purgeOptions.age&&(this._maxFeatureAge=1E3*Math.ceil(60*b.purgeOptions.age));this._drawFeatures=
l.hitch(this,this._drawFeatures);this._queryErrorHandler=l.hitch(this,this._queryErrorHandler)},startup:function(){},propertyChangeHandler:function(b){this._init&&(0===b?this._applyTimeFilter():3===b?this._redrawAllTracks():console.debug("StreamLayer: Stream Layer only supports changing map time or maximumTrackPoints. Layer id \x3d "+this.featureLayer.id))},destroy:function(){this.inherited(arguments);clearTimeout(this._timeoutId);this._featuresByTime=this._drawBuffer=this._featureMap=null},drawFeature:function(b){var a=
this.featureLayer,c=a.objectIdField;this._timeoutId||(this._timeoutId=setTimeout(this._flushDrawBuffer,this._refreshRate));a._joinField&&this._getFeature(b.attributes[c])?this._drawBuffer.updates.push({oid:b.attributes[c],updates:b}):this._drawBuffer.adds.push(b)},resume:function(){this.propertyChangeHandler(0)},refresh:function(){var b=this.featureLayer;b&&(b._relatedUrl||b._keepLatestUrl?(b._fireUpdateStart(),b._refreshing=!0,b.disconnect(),b.clear(),b._relatedQueried=!1,b._keepLatestQueried=!1,
b.connect()):(b._fireUpdateStart(),b.clear(),b._fireUpdateEnd()))},_drawFeatures:function(b,a){this._purgeRequests();var c=this.featureLayer;c._create(b.features||[]);c._fireUpdateEnd(null,a)},_applyTimeFilter:function(b){this.inherited(arguments);this._redrawAllTracks()},_removeFeatures:function(b){var a=this.featureLayer,c=a.objectIdField;b&&d.forEach(b,function(b){b=b.attributes[c];a._unSelectFeatureIIf(b,this);this._decRefCount(b);this._removeFeatureIIf(b)},this)},_addFeatures:function(b){var a=
this.featureLayer,c=a._endTimeField,e=a._startTimeField,h,t,f,k=[],m=[],l=[];h=a._trackManager;t=a.objectIdField;if(h)for(f in b=h.addFeatures(b),b)b.hasOwnProperty(f)&&(k.push(f),b[f].adds&&(m=m.concat(b[f].adds)),b[f].deletes&&(l=l.concat(b[f].deletes)));else m=b;d.forEach(m,function(a){var b=a.attributes[t],f;f=c&&a.attributes[c];!f&&this._maxFeatureAge&&(f=e&&a.attributes[e]?a.attributes[e]+this._maxFeatureAge:Date.now()+this._maxFeatureAge);f&&(f=1E3*Math.ceil(f/1E3),this._featuresByTime[f]?
this._featuresByTime[f].push(b):this._featuresByTime[f]=[b]);this._addFeatureIIf(b,a);this._incRefCount(b)},this);l.length&&this._removeFeatures(l);h&&h.refreshTracks(k)},_updateFeatures:function(b){var a=this.featureLayer,c,e,h=[];c=a._trackManager;e=a._trackIdField;d.forEach(b,function(b){var f=b.updates;b=this._getFeature(b.oid);var g;if(b){f.geometry&&b.setGeometry(f.geometry);f=f.attributes||{};for(g in f)f.hasOwnProperty(g)&&(b.attributes[g]=f[g]);b.setAttributes(b.attributes);b.visible=this._checkFeatureTimeIntersects(b);
c&&b.attributes[e]?h.push(b.attributes[e]):a._repaint(b,null,!0)}},this);h.length&&c.refreshTracks(h)},_redrawAllTracks:function(){var b=this.featureLayer._trackManager,a;b&&(a=b.trimTracks())&&0<a.length&&(this._removeFeatures(a),b.refreshTracks())},_flushDrawBuffer:function(){clearTimeout(this._timeoutId);var b=this._drawBuffer,a=b.adds.splice(0,b.adds.length),c=b.updates.splice(0,b.updates.length),b=this.featureLayer;if(!b)return!1;b.updating||b._fireUpdateStart();this._addFeatures(a);this._updateFeatures(c);
(a=this._getExpiredFeatures())&&a.length&&(this._removeFeatures(a),b._trackManager&&b._trackManager.removeFeatures(a));b._purge();b._fireUpdateEnd();this._timeoutId=null},_clearDrawBuffer:function(){var b=this._timeoutId,a=this._drawBuffer,c=a.adds,a=a.updates;b&&clearTimeout(b);c.splice(0,c.length);a.splice(0,a.length);this._timeoutId=null},_clearTimeBin:function(){this._featuresByTime={};this._lastEndTimeCheck=1E3*Math.ceil(Date.now()/1E3)},_clearFeatureMap:function(){this._featureMap={}},_setRefreshRate:function(b){b=
b||0===b?b:200;0>b&&(b=200);this._refreshRate=b},_checkFeatureTimeIntersects:function(b){var a=this.featureLayer,c=a.getMap();return(c=c?c.timeExtent:null)&&a.timeInfo&&(a.timeInfo.startTimeField||a.timeInfo.endTimeField)?0<a._filterByTime([b],c.startTime,c.endTime).match.length:!0},_getRequestId:function(b){return("_"+b.name+b.layerId+b._ulid).replace(/[^a-zA-Z0-9\_]+/g,"_")},_fetchArchive:function(b){function a(a){q++;n.execute(t).then(function(b){a(null,b)},function(b){a(b)})}function c(b,f){if(b)q>=
z||!d._relatedUrl?A._queryErrorHandler(Error("Could not get features from related feature service")):(r={relatedFeatureWarning:"Querying related feature service using the current filter failed. All related features are displayed, and the filter is applied to the stream service only"},t.where="1\x3d1",a(c));else{var g=A._fixFieldNameCasing(d,f);f.features=g;A._drawFeatures(f,r)}}var d=this.featureLayer,n,t,f,k,l;d._fireUpdateStart();if(b&&this.map){n=new h(b);t=new p;b=this.map;f=d.getFilter()||{};
k=f.where||"1\x3d1";l=f.geometry?e.fromJson(f.geometry):null;f=f.outFields?f.outFields.split(","):["*"];t.geometry=l;t.where=k;t.outFields=f;t.returnGeometry=!0;t.outSpatialReference=new m(b.spatialReference.toJson());d._usePatch&&(b=this._getRequestId(d),this._cancelPendingRequest(null,b));var q=0,z=2,A=this,r=null;a(c)}else return this._fireUpdateEnd({error:"Archive data cannot be fetched if no feature service url is provided or if the layer is not added to a map"}),!1},_queryErrorHandler:function(b){this._purgeRequests();
var a=this.featureLayer;a._errorHandler(b);a._fireUpdateEnd(b)},_fixFieldNameCasing:function(b,a){var c=a.features||[],e=a.fields;if(!e||!c.length)return c;for(var e=this._mapFieldNameDifferences(b.fields,e),d=[],h,f,k=0,m=a.features.length;k<m;k++)h=c[k],f=this._swizzleResponseAttributes(h.attributes,e),d.push({geometry:h.geometry,attributes:f});return d},_mapFieldNameDifferences:function(b,a){var c=[],e={},d,h;d=0;for(h=a.length;d<h;d++)c.push(a[d].name);d=0;for(h=b.length;d<h;d++){var f=b[d].name,
k=this._checkForStreamFieldName(f,c);k&&(e[k]=f)}return e},_checkForStreamFieldName:function(b,a){for(var c=b.toLowerCase(),e,d=0,h=a.length;d<h;d++)if(a[d].toLowerCase()===c){e=a[d];break}return e},_swizzleResponseAttributes:function(b,a){var c={},e;for(e in b)if(b.hasOwnProperty(e)){var d=b[e];a.hasOwnProperty(e)?c[a[e]]=d:c[e]=d}return c},_getExpiredFeatures:function(){var b,a,c,e=[],h=[];if(!this.featureLayer._endTimeField&&!this._maxFeatureAge)return h;b=1E3*Math.floor(this._lastEndTimeCheck/
1E3);this._lastEndTimeCheck=a=1E3*Math.ceil(Date.now()/1E3);if(b&&b!==a)for(c=this._featuresByTime;b<=a;b+=1E3)c[b]&&(e=e.concat(c[b]),delete c[b]);d.forEach(e,function(a){(a=this._getFeature(a))&&h.push(a)},this);return h}})})},"esri/layers/TrackManager":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/has dojo/dom-construct dojox/gfx ../kernel ../graphic ../geometry/Polyline ./GraphicsLayer".split(" "),function(r,l,d,q,k,m,p,h,e,c){var b=-1!==m.renderer.toLowerCase().indexOf("canvas");
return r(null,{declaredClass:"esri.layers._TrackManager",constructor:function(a){this.layer=a;this.trackMap={};this.trackLineMap={}},initialize:function(a){this.map=a;var g=this.layer,e=g._getRenderer(),e=e&&e.trackRenderer;if("esriGeometryPoint"===g.geometryType){var d=this.container=new c._GraphicsLayer({id:g.id+"_tracks",_child:!0,visible:g.visible,minScale:g.minScale,maxScale:g.maxScale});d.loaded=!0;d.onLoad(d);d._setMap(a,g._div);if(!b){a=d._div.getNode();var h=g._div.getNode();a&&h&&k.place(a,
h,"first")}d.setRenderer(e);g.on("visibility-change",l.hitch(this,function(a){this.container.setVisibility(a.visible);this.container.evaluateSuspension()}));g.on("scale-range-change",l.hitch(this,function(){this.container.setScaleRange(this.layer.minScale,this.layer.maxScale)}))}},addFeatures:function(a){var b=this.trackMap,c=this.layer,e=c._trackIdField,h=[];d.forEach(a,function(a){var c=a.attributes[e];(b[c]=b[c]||[]).push(a);-1===d.indexOf(h,c)&&h.push(c)});var f=c._startTimeField,k=c.objectIdField,
m=function(a,b){var c=a.attributes[f],g=b.attributes[f];return c===g?a.attributes[k]<b.attributes[k]?-1:1:c<g?-1:1};d.forEach(h,function(a){b[a].sort(m)})},trimTracks:function(a){function b(a){for(a=c[a]||[];a.length>e;)h.push(a.shift())}var c=this.trackMap,e=this.layer.maximumTrackPoints||0,h=[],f;if(!e)return h;if(a)d.forEach(a,function(a){b(a)});else for(f in c)c.hasOwnProperty(f)&&b(f);return h},drawTracks:function(a){function b(a){var b=t[a],g,d,u;d=c.trackLineMap[a];n.remove(d);delete c.trackLineMap[a];
d=null;if(!b||2>b.length)return!1;d=[];for(g=b.length-1;0<=g;g--)(u=b[g].geometry)&&d.push([u.x,u.y]);b={};b[k]=a;1<d.length&&(d=new h(new e({paths:[d],spatialReference:f}),null,b),n.add(d),c.trackLineMap[a]=d)}var c=this,n=this.container,t,f,k,m;if(n)if(t=this.trackMap,f=this.map.spatialReference,k=this.layer._trackIdField,a)d.forEach(a,function(a){b(a)});else for(m in t)t.hasOwnProperty(m)&&b(m)},refreshTracks:function(a){function b(a){var b,g;c.drawTracks([a]);if(f&&f.latestObservationRenderer)for(a=
e[a]||[],b=a.length,g=0;g<b;g++)h._repaint(a[g],null,!0)}var c=this,e=this.trackMap,h=this.layer,f=h._getRenderer(),k;if(a)d.forEach(a,function(a){b(a)});else for(k in e)e.hasOwnProperty(k)&&b(k);this.moveLatestToFront()},moveLatestToFront:function(a){d.forEach(this.getLatestObservations(a),function(a){var b=a._shape;b&&b._moveToFront();this._repaint(a,null,!0)},this.layer)},getLatestObservations:function(a){function b(a){a=h[a];return a[a.length-1]}var c=[],e=this.layer._getRenderer(),h=this.trackMap,
f;if(!e.latestObservationRenderer)return c;if(a)d.forEach(a,function(a){c.push(b(a))});else for(f in h)h.hasOwnProperty(f)&&c.push(b(f));return c},clearTracks:function(a){var b=this.getLatestObservations(a),c=this.container,e;a?d.forEach(a,function(a){delete this.trackMap[a];c&&(e=this.trackLineMap[a],c.remove(e),delete this.trackLineMap[a])},this):(this.trackMap={},this.trackLineMap={},c&&c.clear());d.forEach(b,function(a){this._repaint(a,null,!0)},this.layer)},isLatestObservation:function(a){var b=
this.trackMap[a.attributes[this.layer._trackIdField]];return b?b[b.length-1]===a:!1},destroy:function(){var a=this.container;a&&(a.clear(),a._unsetMap(this.map,this.layer._div));this.map=this.layer=this.trackMap=this.container=null}})})},"esri/layers/HeatmapManager":function(){define("dojo/_base/declare dojo/_base/lang dojo/aspect dojo/_base/array require ../kernel ../sniff ../geometry/Point ../geometry/webMercatorUtils ./MapImage ../renderers/HeatmapRenderer ../tasks/query dojo/_base/fx".split(" "),
function(r,l,d,q,k,m,p,h,e,c,b,a,g){function u(){}function n(a){var b=a.layer;return{geometry:a.geometry,attributes:a.attributes,getLayer:function(){return b}}}return r(null,{declaredClass:"esri.layers.HeatmapManager",heatmapRenderer:null,sourceLayer:null,imageLayer:null,useTiles:!0,useWorker:!1,map:null,constructor:function(a){this.sourceLayer=a;this._hndls=[]},initialize:function(a){this.map=a;var c=this.sourceLayer,g=c.renderer;c.setDrawMode(!1);this.imageLayer=a._getMapImageLyr();var e=this;this.heatmapRenderer=
g instanceof b?g:(g.getRendererInfoByZoom(a.getZoom())||g.getRendererInfoByScale(a.getScale())).renderer;this._setupDraw=this._setupDraw.bind(this);this.recalculateHeatmap=this.recalculateHeatmap.bind(this);this._removeRenderer=this._removeRenderer.bind(this);this._handleRendererChange=this._handleRendererChange.bind(this);this._rendererChangeHandle=this.sourceLayer.on("renderer-change",this._handleRendererChange);this._handleOpacityChange=this._handleOpacityChange.bind(this);this._reprojectFeature=
this._reprojectFeature.bind(this);k(["../workers/heatmapCalculator"],function(a){e._calculator=new a(l.mixin({width:e.map.width,height:e.map.height},e._getOptions()));e._setupRenderer();e.heatmapRenderer.getStats=a.calculateStats;e.heatmapRenderer.getHistogramData=a.getHistogramData})},destroy:function(){this._removeHandlers();this._rendererChangeHandle&&this._rendererChangeHandle.remove();this._rendererChangeHandle=this.sourceLayer=this.imageLayer=this.map=this.heatmapRenderer=this._hndls=null},
_handleRendererChange:function(a){var c=a.renderer,g=c instanceof b;this.heatmapRenderer?g?this.heatmapRenderer=c:this._removeRenderer(a):g&&(this.heatmapRenderer=c,this.sourceLayer&&this.map&&this._setupRenderer())},_handleOpacityChange:function(a){a=a.opacity;var b=this._getImageBySourceId(this.sourceLayer.id);b&&b.setOpacity(a)},_setupRenderer:function(){var a=this._hndls,b=this.sourceLayer,c=this.map,g=this;b._originalDraw=b._draw;b._draw=u;b._div.clear();clearTimeout(this._resetTimer);this._resetTimer=
setTimeout(this._resetGraphics.bind(this),250);a.push(b.on("update-end",this._setupDraw));a.push(b.on("suspend",function(a){(a=g._getImageBySourceId(g.sourceLayer.id))&&a.hide()}));a.push(b.on("resume",function(a){(a=g._getImageBySourceId(g.sourceLayer.id))&&a.show()}));a.push(d.after(b,"redraw",this._setupDraw));a.push(c.on("layer-remove",function(a){a.layer==b&&((a=g._getImageBySourceId(g.sourceLayer.id))&&g.imageLayer.removeImage(a),g._removeRenderer({target:b}))}));b._collection&&a.push(b.on("graphic-add",
function(a){g._reprojectFeature(a.graphic);g._setupDraw()}));1!==b.mode&&(a.push(c.on("resize, pan-end",this._setupDraw)),a.push(c.on("zoom-end",this._setupDraw)));a.push(b.on("opacity-change",this._handleOpacityChange));this.imageLayer.suspended&&this.imageLayer.resume();b.graphics&&b.graphics.length&&(b.graphics[0].geometry&&!c.spatialReference.equals(b.graphics[0].geometry.spatialReference)&&q.forEach(b.graphics,function(a){this._reprojectFeature(a)}.bind(this)),this._setupDraw())},_setupDraw:function(){if(!this._drawTimer){var a=
this;this._drawTimer=setTimeout(function(){clearTimeout(a._drawTimer);a._drawTimer=null;a.sourceLayer._getRenderer().isInstanceOf(b)&&a.recalculateHeatmap()},16)}},_removeRenderer:function(a){var b=a.target;b._draw=b._originalDraw;delete b._originalDraw;b.setDrawMode(!0);this._removeHandlers();this._hndls=[];var c=this._getImageBySourceId(this.sourceLayer.id);c&&this.imageLayer.removeImage(c);clearTimeout(this._drawTimer);clearTimeout(this._resetTimer);this._drawTimer=this._resetTimer=null;b.renderer!=
a.renderer&&b.renderer.getRendererInfo?this.heatmapRenderer=null:(b.redraw(),this.destroy())},recalculateHeatmap:function(){this._calculator?this._doMainCalculation():this._calculatorClient&&this._doWorkerCalculation()},_reprojectFeature:function(a){if(a&&a.geometry){var b=a.geometry,c=this.map.spatialReference;c.equals(b.spatialReference)||(b=e.project(b,c),null==b?console.log("Unable to reproject features to map's spatial reference. Please convert feature geometry before adding to layer"):a.geometry=
b)}},_doWorkerCalculation:function(){},_doMainCalculation:function(){var b=this.sourceLayer,f=this.map,g=this.heatmapRenderer,e=this.map.extent,d=this.map.width,h=this.map.height,k=this._calculator,u=this,m=function(a){a=u._getScreenPoints(a.features,f,b);a=k.calculateImageData(l.mixin({screenPoints:a,mapinfo:{extent:[e.xmin,e.ymin,e.xmax,e.ymax],resolution:f.getResolution()},width:d,height:h},u._getOptions()));a=g.getSymbol(n({geometry:f.extent,attributes:{size:[d,h],imageData:a},layer:b}));a=new c({extent:f.extent,
href:a.url,opacity:0,sourceId:b.id});u._swapMapImages(a,u._getImageBySourceId(b.id));b.suspended&&a.hide()},p={geometry:f.extent,timeExtent:b.useMapTime?f.timeExtent:void 0,spatialRelationship:a.SPATIAL_REL_INTERSECTS};null!=b._canDoClientSideQuery(p)?b.queryFeatures(p,m):m({features:b.graphics})},_getScreenPoints:function(a,b,c){var f=[],g=a.length,e=0,d=0,n,k=new h(b.extent.xmin,b.extent.ymax,b.spatialReference),t=b.toScreen(k),u=t.x,t=t.y,m=b.getResolution(),l;for((d=b.extent.getCacheValue("_parts"))&&
(l=q.map(d,function(a){return c._intersects(b,a.extent)[0]}));g--;)d=a[g],d.geometry&&(n={x:Math.ceil((d.geometry.x-k.x)/m+u),y:Math.floor((k.y-d.geometry.y)/m-t),attributes:d.attributes},l&&(d=1<l.length&&n.x<-l[0]?l[1]:l[0],n.x+=d),f[e++]=n);return f},_getImageBySourceId:function(a){var b=this.imageLayer.getImages(),b=q.filter(b,function(b){return b.sourceId==a});if(b.length)return b[b.length-1]},_swapMapImages:function(a,b){function c(){f.removeImage(b)}var f=this.imageLayer,e=this.sourceLayer.opacity;
f.addImage(a);g.anim(a._node,{opacity:e},null,null,function(){a.opacity=e});null!=b&&g.anim(b._node,{opacity:0},null,null,c)},_removeHandlers:function(){if(null!=this._hndls)for(var a=this._hndls.length;a--;)this._hndls[a].remove()},_getOptions:function(){var a=this.heatmapRenderer;return{blurRadius:a.blurRadius,gradient:a.gradient,maxPixelIntensity:a.maxPixelIntensity,minPixelIntensity:a.minPixelIntensity,field:a.field,fieldOffset:a.fieldOffset}},_resetGraphics:function(){clearTimeout(this._resetTimer);
this._resetTimer=null;for(var a=this.sourceLayer.graphics,b=a.length,c;b--;)c=a[b],c._shape=c._offsets=void 0}})})},"esri/layers/MapImage":function(){define("dojo/_base/declare dojo/_base/lang dojo/dom-style dojo/has ../kernel ../domUtils ../geometry/Extent".split(" "),function(r,l,d,q,k,m,p){return r(null,{declaredClass:"esri.layers.MapImage",constructor:function(d){l.mixin(this,d);this.extent=new p(this.extent)},visible:!0,opacity:1,getLayer:function(){return this._layer},getNode:function(){return this._node},
show:function(){if(!this.visible){this.visible=!0;var d=this._node,e=this._layer,c;if(d){if(c=e&&e._div)e.suspended||e._setPos(d,c._left,c._top),(e._active||c).appendChild(d);m.show(d)}}},hide:function(){if(this.visible){this.visible=!1;var d=this._node;d&&(m.hide(d),d.parentNode&&d.parentNode.removeChild(d))}},setOpacity:function(h){var e=this._node;this.opacity=h;e&&d.set(e,"opacity",h)}})})},"esri/layers/clustering/ClusterManager":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/has ../../kernel ../../Evented ../../graphic ../../dijit/PopupTemplate ../../dijit/Legend/utils ../../renderers/SimpleRenderer ../../symbols/SimpleMarkerSymbol ../GraphicsLayer ./GeohashAggregation".split(" "),
function(r,l,d,q,k,m,p,h,e,c,b,a,g){return r(m,{declaredClass:"esri.layers.clustering.ClusterManager",layer:null,aggregationInfo:null,container:null,defaults:{clusterSize:80,markerSymbol:{color:[77,77,77,255],size:6,angle:0,xoffset:0,yoffset:0,type:"esriSMS",style:"esriSMSCircle",outline:{color:[255,255,255,255],width:.75,type:"esriSLS",style:"esriSLSSolid"}}},_map:null,_eventHandles:null,_clusterSize:null,_renderer:null,_statisticInfos:null,_infoTemplate:null,_clusterGenerator:null,constructor:function(a){this._eventHandles=
[];this.layer=a.layer;this.setAggregationInfo(a.aggregationInfo)},initialize:function(a){this._map=a;this.container=this._createContainer();this._clusterGenerator=this._createClusterGenerator();this._initClusterGenerator();this._createLayerEventListeners();this._createMapEventListeners()},destroy:function(){this._destroyEventListeners();this._destroyClusterGenerator();this._destroyContainer();this.layer=this.aggregationInfo=this._map=null},setAggregationInfo:function(a){this.aggregationInfo=a;this._applyAggregationInfo()},
getClusterRenderer:function(){return this._renderer},redraw:function(){this.container&&this.container.redraw()},isClusteringEnabled:function(){return this._clusterGenerator&&this._clusterGenerator.clustersEnabled},_createContainer:function(){var b=this.layer,c=new a._GraphicsLayer({_child:!0,id:b.id+"_clusters",visible:b.visible,minScale:b.minScale,maxScale:b.maxScale,infoTemplate:this._infoTemplate});c.setRenderer(this._renderer);c.loaded=!0;c.onLoad(c);c._setMap(this._map,b._div);return b._childLayer=
c},_destroyContainer:function(){var a=this.container;a&&(a.clear(),a._unsetMap(this._map,this.layer._div),this.layer._childLayer=null);this.container=null},_createClusterGenerator:function(){return new g({map:this._map,layer:this.layer,clusterSize:this._clusterSize,statisticInfos:this._statisticInfos})},_initClusterGenerator:function(){var a=this._clusterGenerator;a.loaded?(this._applyRenderer(),this._initClusterUpdates()):this._eventHandles.push(a.on("load",l.hitch(this,function(){this._applyRenderer();
this._initClusterUpdates()})),a.on("load-error",l.hitch(this,function(a){console.log(a.error)})));this._eventHandles.push(a.on("mode-change",l.hitch(this,function(){this.emit("mode-change")})))},_destroyClusterGenerator:function(){this._clusterGenerator&&this._clusterGenerator.destroy();this._clusterGenerator=null},_applyAggregationInfo:function(){this._applyClusterSize();this._applyRenderer();this._clusterGenerator&&!this._clusterGenerator.isUpdateScheduled()&&this.redraw()},_applyClusterSize:function(){var a=
this.aggregationInfo;this._clusterSize=a&&a.clusterSize||this.defaults.clusterSize;this._clusterGenerator&&this._clusterGenerator.setClusterSize(this._clusterSize)},_applyRenderer:function(){this._renderer=this._getRenderer(this.aggregationInfo,"avg");this._statisticInfos=this._createStatisticInfos(this._renderer,"avg");this._clusterGenerator&&this._clusterGenerator.setStatisticInfos(this._statisticInfos);this.container&&(this.container.setRenderer(this._renderer),this.emit("renderer-change"),d.forEach(this.container.graphics,
function(a){a.setAttributes(a._cluster.attributes)}));this._applyInfoTemplate()},_applyInfoTemplate:function(){this._infoTemplate=this._getInfoTemplate(this.aggregationInfo,this._statisticInfos);this.container&&this.container.setInfoTemplate(this._infoTemplate)},_getRenderer:function(a,b){var c=a&&a.renderer;c||(c=(c=this.layer&&this.layer.renderer)?this._createClusterRenderer(c,b):this._getDefaultClusterRenderer());return c},_getDefaultClusterRenderer:function(){var a=new c(new b(this.defaults.markerSymbol));
this._addSizeByCountVariable(a);return a},_createClusterRenderer:function(a,b){if(!this._isSupportedRenderer(a))return this._getDefaultClusterRenderer();var c=new a.constructor(a.toJson()),f=b+"_";c.attributeField=f+c.attributeField;c.normalizationField&&(c.normalizationField=f+c.normalizationField);c.setVisualVariables(null);var f=this._getSupportedVariables(a),g=this._createClusterVariables(f.allVars,b);c.setVisualVariables(g);f.sizeVars.length||this._addSizeByCountVariable(c);return c},_isSupportedRenderer:function(a){var b=
a.declaredClass.toLowerCase();return-1<b.indexOf("simplerenderer")?!0:-1<b.indexOf("classbreaksrenderer")?a.valueExpression?!1:a.isContinuousRenderer():!1},_getSupportedVariables:function(a){var b=a.getVisualVariablesForType("colorInfo",!1)||[],c=a.getVisualVariablesForType("sizeInfo",!1)||[];a=a.getVisualVariablesForType("opacityInfo",!1)||[];b=d.filter(b,this._variableFilter);c=d.filter(c,this._variableFilter);a=d.filter(a,this._variableFilter);return{colorVars:b,sizeVars:c,opacityVars:a,allVars:b.concat(c).concat(a)}},
_variableFilter:function(a){return"string"===typeof a.field},_createClusterVariables:function(a,b){return d.map(a,function(a){return this._createVarForAvg(a,b)},this)},_createVarForAvg:function(a,b){var c=l.clone(a),f=b+"_";c.field=f+c.field;c.normalizationField&&(c.normalizationField=f+c.normalizationField);this._setVariableTitle(c,a);return c},_setVariableTitle:function(a,b){a.legendOptions&&a.legendOptions.title||(a.legendOptions=a.legendOptions||{},a.legendOptions.title=e.getVisualVariableTitle(b,
this.layer))},_createStatisticInfos:function(a,b){if(-1!==a.declaredClass.toLowerCase().indexOf("classbreaksrenderer")){var c=[a.attributeField,a.normalizationField];d.forEach(a.visualVariables,function(a){"count"!==a.field&&(c.push(a.field),c.push(a.normalizationField))});c=d.filter(c,function(a){return!!a});c.sort();var c=d.filter(c,function(a,b){return 0===b||c[b-1]!==a}),f=b+"_";return d.map(c,function(a){return{field:a.replace(f,""),type:b}})}},_addSizeByCountVariable:function(a){var b=this._createSizeByCountVariable();
b&&this._addVariable(a,b)},_getSizeByCountVariable:function(a){a=a.getVisualVariablesForType("sizeInfo",!1)||[];return d.filter(a,function(a){return"count"===a.field})[0]},_updateSizeByCountVariable:function(){var a=this._renderer,b=this._getSizeByCountVariable(a);if(b){var c=this._createSizeByCountVariable();c&&this._replaceVariable(a,b,c)}else this._addSizeByCountVariable(a)},_createSizeByCountVariable:function(){var a=this._clusterGenerator,b;a&&(a=a.getCurrentLodStats(),b={type:"sizeInfo",field:"count",
valueUnit:"unknown",minSize:8,maxSize:50,minDataValue:a.min,maxDataValue:a.max,legendOptions:{title:"Number of features"}});return b},_addVariable:function(a,b){var c=a.visualVariables||[];c.push(b);a.setVisualVariables(c)},_replaceVariable:function(a,b,c){var f=a.visualVariables;b=d.indexOf(f,b);-1<b&&f.splice(b,1);f.push(c);a.setVisualVariables(f)},_getInfoTemplate:function(a,b){var c=a&&a.infoTemplate;if(!c){var f=this.layer,g=[{fieldName:"count",visible:!0,label:"Number of features",format:{digitSeparator:!0,
places:0}}],e=[];d.forEach(b,function(a){var b=a.type+"_"+a.field;g.push({fieldName:b,visible:!0,label:"Average "+f.getFieldLabel(a.field),format:{digitSeparator:!0,places:1}});e.push("Average \x3cb\x3e"+f.getFieldLabel(a.field)+"\x3c/b\x3e within this cluster is \x3cb\x3e{"+b+"}\x3c/b\x3e.\x3cbr\x3e")});c=e.length?"\x3cbr\x3e"+e.join(""):"";c=new h({fieldInfos:g,description:"This cluster represents \x3cb\x3e{count}\x3c/b\x3e features.\x3cbr\x3e"+c})}return c},_removeFromPopup:function(a){var b=this._map.infoWindow,
c=b.features,f=[];d.forEach(c,function(b,c){b.getLayer()===a&&f.push(c)});f.length&&(f.sort(function(a,b){return b-a}),c=c.slice(0),d.forEach(f,function(a){c.splice(a,1)}),b.setFeatures(c),c.length||b.hide())},_initClusterUpdates:function(){this._updateClusters(!0,!1);this._eventHandles.push(this._clusterGenerator.on("update-end",l.hitch(this,function(a){this._updateClusters(a.levelChange,a.modeChange)})))},_updateClusters:function(a,b){this.isClusteringEnabled()&&b&&this._removeFromPopup(this.layer);
var c=d.map(this._clusterGenerator.clusters,function(a){var b=new p(a.centroid,null,a.attributes);b._cluster=a;return b});this._addGraphics(c,a)},_addGraphics:function(a,b){var c=this.container;c.clear();var f=this.aggregationInfo&&this.aggregationInfo.renderer;b&&this.isClusteringEnabled()&&this._renderer!==f&&(this._updateSizeByCountVariable(),this.emit("renderer-change"));d.forEach(a,function(a){c.add(a)})},_createLayerEventListeners:function(){var a=this.layer;this._eventHandles.push(a.on("visibility-change",
l.hitch(this,function(a){this.container.setVisibility(a.visible);this.container.evaluateSuspension()})),a.on("scale-range-change",l.hitch(this,function(){this.container.setScaleRange(this.layer.minScale,this.layer.maxScale)})),a.on("renderer-change",l.hitch(this,function(){this._applyRenderer()})))},_createMapEventListeners:function(){this._eventHandles.push(this._map.on("zoom-start",l.hitch(this,function(a){this.isClusteringEnabled()&&this._removeFromPopup(this.container);this.container.clear()})))},
_destroyEventListeners:function(){d.forEach(this._eventHandles,function(a){a.remove()})}})})},"esri/dijit/Legend/utils":function(){define(["dojo/_base/lang","esri/lang","dojo/i18n!../../nls/jsapi"],function(r,l,d){var q=d.widgets.legend;return{getVisualVariableTitle:function(d,m){var k,h=d.field,e=d.normalizationField,c=!1,b=!1,a=!1,g,h=r.isFunction(h)?null:h,e=r.isFunction(e)?null:e;if(d.legendOptions&&d.legendOptions.title)k=d.legendOptions.title;else if(d.valueExpressionTitle)k=d.valueExpressionTitle;
else{if(m.renderer&&m.renderer.authoringInfo&&m.renderer.authoringInfo.visualVariables){var u=m.renderer.authoringInfo.visualVariables;for(g=0;g<u.length;g++){var n=u[g];if("colorInfo"===n.type&&"ratio"===n.style){c=!0;break}else if("colorInfo"===n.type&&"percent"===n.style){b=!0;break}else if("colorInfo"===n.type&&"percentTotal"===n.style){a=!0;break}}}(c=a&&"showRatioPercentTotal"||b&&"showRatioPercent"||c&&"showRatio"||e&&"showNormField"||h&&"showField"||null)&&(k=l.substitute({field:h&&m.getFieldLabel(h),
normField:e&&m.getFieldLabel(e)},q[c]))}return k},getRendererTitle:function(d,m){}}})},"esri/layers/clustering/GeohashAggregation":function(){define("dojo/has dojo/_base/declare dojo/_base/lang dojo/_base/array ../../kernel ../../Evented ../../geometry/Point ../../geometry/mathUtils ./geohashUtils".split(" "),function(r,l,d,q,k,m,p,h,e){return l(m,{loaded:!1,map:null,layer:null,lod:null,tolerance:null,maxLod:null,clusterMode:null,clusterSize:null,sortEnabled:!0,filterEnabled:!0,bufferEnabled:!0,updateEnabled:!0,
clusters:null,clustersEnabled:!0,statisticInfos:null,defaults:{lod:1,tolerance:0,clusterMode:"auto",clusterSize:80,sortEnabled:!0,filterEnabled:!0,bufferEnabled:!0,updateEnabled:!0},_eventHandles:null,_updateHandle:null,_cellIndex:null,_globalIndex:null,_perfProfile:null,_maxGeohashLength:12,_minClusterSize:15,_active:!1,_levelChange:!0,_modeChange:!1,constructor:function(c){this._update=d.hitch(this,this._update);this._eventHandles=[];this._globalIndex={numFeatures:null,fullExtent:null,lodStats:null};
this._perfProfile={lastIndex:{total:null,numFeatures:0},lastUpdate:{cells:null,clusters:null,total:null}};this.clusters=[];this.map=c.map;this.layer=c.layer;this.setLod(c.lod);this.setTolerance(c.tolerance);this.setClusterMode(c.clusterMode);this.setClusterSize(c.clusterSize);this.setSortEnabled(c.sortEnabled);this.setFilterEnabled(c.filterEnabled);this.setBufferEnabled(c.bufferEnabled);this.setUpdateEnabled(c.updateEnabled);this.setStatisticInfos(c.statisticInfos);this._load();this.loaded?this._startup():
this._eventHandles.push(this.on("load",d.hitch(this,this._startup)))},destroy:function(){this._displayFeatures(!0);q.forEach(this._eventHandles,function(c){c.remove()});clearTimeout(this._updateHandle);this._cellIndex=this._globalIndex=this._eventHandles=this._updateHandle=this.map=this.layer=this.clusters=null},setLod:function(c){var b=this.lod;this.lod=c||this.defaults.lod;b!==this.lod&&this.update()},setTolerance:function(c){var b=this.tolerance;this.tolerance=c||this.defaults.tolerance;b!==this.tolerance&&
this.update()},setClusterMode:function(c){var b=this.clusterMode;this.clusterMode=c||this.defaults.clusterMode;this._evalClusterParams();b!==this.clusterMode&&this.update()},setClusterSize:function(c){var b=this.clusterSize;this.clusterSize=null!=c?c:this.defaults.clusterSize;this._evalClusterParams();b!==this.clusterSize&&this.update()},setSortEnabled:function(c){var b=this.sortEnabled;this.sortEnabled=null!=c?!!c:this.defaults.sortEnabled;b!==this.sortEnabled&&this.update()},setFilterEnabled:function(c){var b=
this.filterEnabled;this.filterEnabled=null!=c?!!c:this.defaults.filterEnabled;b!==this.filterEnabled&&this.update()},setBufferEnabled:function(c){var b=this.bufferEnabled;this.bufferEnabled=null!=c?!!c:this.defaults.bufferEnabled;b!==this.bufferEnabled&&this.update()},setUpdateEnabled:function(c){var b=this.updateEnabled;(this.updateEnabled=null!=c?!!c:this.defaults.updateEnabled)&&b!==this.updateEnabled&&this.update()},setStatisticInfos:function(c){this.statisticInfos=c||[];this.loaded&&this._applyStatInfos(this.statisticInfos)},
update:function(){this.loaded&&null==this._updateHandle&&(this._updateHandle=setTimeout(this._update,0))},isUpdateScheduled:function(){return null!=this._updateHandle},getCell:function(c){return this._cellIndex[c.length][c]},getCluster:function(c){var b;q.some(this.clusters,function(a){-1<q.indexOf(a.geohashes,c)&&(b=a);return!!b});return b},getCellsInCluster:function(c){var b=[];q.forEach(c&&c.geohashes,function(a){(a=this.getCell(a))&&b.push(a)},this);return b},getCurrentLodStats:function(){var c=
this._globalIndex.lodStats;return c&&c[this.lod]},_load:function(){this._displayFeatures(!1);this._checkLoadStatus();this.map.loaded||this._eventHandles.push(this.map.on("load",d.hitch(this,this._checkLoadStatus)));this.layer.loaded||this._eventHandles.push(this.layer.on("load",d.hitch(this,this._checkLoadStatus)))},_checkLoadStatus:function(){if(this.map.loaded&&this.layer.loaded){var c;if("esriGeometryPoint"!==this.layer.geometryType)c=Error("GeohashAggregation is supported only for points");else{var b=
this.map.spatialReference;b.isWebMercator()||4326===b.wkid||(c=Error("GeohashAggregation is supported only when map spatial reference is WGS84 or WebMercator"))}c?(this.loadError=c,this.emit("load-error",{error:c})):(this.loaded=!0,this.emit("load"))}},_startup:function(){this._evalUpdateStatus();this._processFeatures();this._processExtentChange();this._eventHandles.push(this.layer.on("update-end",d.hitch(this,this._processFeatures)),this.layer.on("suspend",d.hitch(this,this._evalUpdateStatus)),this.layer.on("resume",
d.hitch(this,this._evalUpdateStatus)),this.map.on("extent-change",d.hitch(this,this._processExtentChange)))},_processFeatures:function(){this._indexFeatures();this.update()},_evalUpdateStatus:function(){this.setUpdateEnabled(!this.layer.suspended)},_processExtentChange:function(){this._evalClusterParams();this.update()},_update:function(){this._updateHandle=null;if(this.updateEnabled){this.emit("update-start");this._evalClustersEnabled();if(this.clustersEnabled){var c=this.map.geographicExtent;if(c){var b=
this._getIntersectingCells(c),c=this._getClusters(b.cells,c);this.clusters=c.clusters;this._applyStatInfosToClusters(this._getStatFields(this.statisticInfos));var b=b.profile,c=c.profile,a=b.total+c.total;b.total=this._getElapsedTime(b.total);c.total=this._getElapsedTime(c.total);var g=this._perfProfile.lastUpdate={};g.cells=b;g.clusters=c;g.total=this._getElapsedTime(a)}}else this.clusters=[],this._perfProfile.lastUpdate=null;this.emit("update-end",{levelChange:this._levelChange,modeChange:this._modeChange});
this._modeChange&&this.emit("mode-change")}},_evalClustersEnabled:function(){var c=this.clustersEnabled;(this.clustersEnabled=!(null!=this.maxLod&&this.lod>this.maxLod))&&!this._active&&(this._active=!0);this._modeChange=!1;!this._active||c===this.clustersEnabled&&this.layer._params.drawMode!==this.clustersEnabled||(this._modeChange=!0,this._displayFeatures(!this.clustersEnabled))},_displayFeatures:function(c){var b=this.layer;b.setDrawMode(c);c?b.redraw():b.clearNodes()},_indexFeatures:function(){var c=
this._getTime();this._initializeIndexing();var b=0,a=this._globalIndex.fullExtent;q.forEach(this.layer.graphics,function(c){var g=this._getLngLat(c.geometry),f;g&&(f=e.pointToGeohash(g));f&&(this._addGeohashToIndex(f,c,g),b++,this._updateExtent(a,g))},this);this._applyStatInfosToIndex(this._getStatFields(this.statisticInfos));this._globalIndex.numFeatures=b;for(var g=this._globalIndex.lodStats,d=1;d<=this._maxGeohashLength;d++)g[d]=this._getLODStats(d,b);this.maxLod=b?this._findMaxLOD(g):null;this._perfProfile.lastIndex.total=
this._getElapsedTime(c,this._getTime());this._perfProfile.lastIndex.numFeatures=b;this.emit("index-complete")},_initializeIndexing:function(){this._globalIndex={numFeatures:0,fullExtent:{xmin:Infinity,ymin:Infinity,xmax:-Infinity,ymax:-Infinity},lodStats:{}};for(var c=this._cellIndex=[],b=1;b<=this._maxGeohashLength;b++)c[b]={}},_getLngLat:function(c){if(c){var b=c.getLongitude();c=c.getLatitude();c=null!=b&&null!=c?{x:b,y:c}:null}return c},_addGeohashToIndex:function(c,b,a){for(var g=this._cellIndex,
e="",d=0;d<this._maxGeohashLength;d++){var e=e+c[d],h=g[e.length],f=h[e];f||(f=h[e]={count:0,centroid:{x:null,y:null},extent:{xmin:Infinity,ymin:Infinity,xmax:-Infinity,ymax:-Infinity},features:[],geohash:e,statistics:null});this._updateItem(f,1,a,!0);f.features.push(b)}},_getLODStats:function(c,b){var a=this._cellIndex[c],g=0,e=Infinity,d=-Infinity,h=null,f;for(f in a){var k=a[f];g++;k.count<e&&(e=k.count);k.count>d&&(d=k.count)}0<g&&(h=Number((b/g).toFixed(2)));return{lod:c,count:g,min:Infinity===
e?null:e,max:-Infinity===d?null:d,avg:h}},_findMaxLOD:function(c){for(var b=this._maxGeohashLength;1<b&&c[b].count===c[b-1].count;)b--;return b-1},_evalClusterParams:function(){if(this.loaded&&"auto"===this.clusterMode){var c=this._getClusterParams(this.map.getResolutionInMeters(),this.clusterSize,this._minClusterSize);this._levelChange=this.lod!==c.lod;this.lod=c.lod;this.tolerance=c.tolerance}},_getClusterParams:function(c,b,a){b<a&&(b=a);a=Math.ceil(c*b);c=this._getClosestLODRange(a).max;var g;
do g=this._getCellSize(c),b=a-g,(g=b>g||1===g)||(c+=1);while(!g);a=b/this._getCellSize(c);return{lod:c,tolerance:b,multiplier:Number(a.toFixed(2))}},_getClosestLODRange:function(c){for(var b,a=this._maxGeohashLength;1<=a;a--)if(this._getCellSize(a)>=c){b=a;break}null==b&&(b=1);c=b+1;c>this._maxGeohashLength&&(c=this._maxGeohashLength);return{min:b,max:c}},_getCellSize:function(c){c=e.getCellSizeInMeters(c);return Math.ceil(Math.min(c.width,c.height))},_sorter:function(c,b){var a=c.centroid,g=b.centroid;
return c.count>b.count?-1:c.count<b.count?1:a.x>g.x?-1:a.x<g.x?1:0},_getIntersectingCells:function(c){var b=this._getTime(),a=e.getIntersecting(c,this.lod,this.bufferEnabled?this.tolerance:0);c=this._getTime();var g=[],d=this.tolerance,h=this.sortEnabled;q.forEach(a,function(a){(a=this.getCell(a))&&g.push(a)},this);d&&h&&g.sort(this._sorter);a=this._getTime();return{cells:g,profile:{findCells:this._getElapsedTime(b,c),scanAndSortCells:this._getElapsedTime(c,a),total:a-b}}},_getClusters:function(c,
b){var a=this._getTime(),g=[],e={},d={findCells:0};q.forEach(c,function(a,b){var c=this._createCluster(a,e,d);c&&g.push(c)},this);this._markIntersecting(g,b);this.filterEnabled&&(g=this._getIntersectingClusters(g));var h=this._getTime();return{clusters:g,profile:{findCellsInCluster:this._getElapsedTime(d.findCells),total:h-a}}},_markIntersecting:function(c,b){var a=b.normalize();q.forEach(c,function(b){var c=b.centroid.x,g=b.centroid.y;b.isIntersecting=q.some(a,function(a){return c>=a.xmin&&c<=a.xmax&&
g>=a.ymin&&g<=a.ymax})})},_getIntersectingClusters:function(c){return q.filter(c,function(b){return b.isIntersecting})},_createCluster:function(c,b,a){if(!b[c.geohash]){var g=[{cell:c,distance:0}];if(this.tolerance){var d=this._getTime(),h=e.getNeighborsWithinDistance(c.centroid,this.lod,this.tolerance);a.findCells+=this._getTime()-d;q.forEach(h,function(a){if(a!==c.geohash&&(a=this.getCell(a))){var b=this._calculateDistance(c.centroid,a.centroid);b<=this.tolerance&&g.push({cell:a,distance:b})}},
this)}return this._mergeCells(g,b)}},_calculateDistance:function(c,b){return h.getLength(e.geographicToWebMercator(c),e.geographicToWebMercator(b))},_mergeCells:function(c,b){var a=this._initializeCluster({},c[0].cell.geohash);q.forEach(c,function(c){var g=c.cell,e=g.geohash;c=c.distance;var d=b[e];if(d)if(c<d.distance)this._removeCellFromCluster(e,b);else return;b[e]={cluster:a,distance:c};this._updateItem(a,g.count,g.centroid);a.geohashes.push(e)},this);return a},_removeCellFromCluster:function(c,
b){var a=b[c].cluster;delete b[c];var g=q.indexOf(a.geohashes,c);-1<g&&a.geohashes.splice(g,1);this._reevaluateCluster(a)},_reevaluateCluster:function(c){var b=c.geohashes;c=this._initializeCluster(c,c.primary);q.forEach(b,function(a){var b=this.getCell(a);b&&(this._updateItem(c,b.count,b.centroid),c.geohashes.push(a))},this)},_initializeCluster:function(c,b){c.count=0;c.centroid=new p(null,null);c.geohashes=[];c.primary=b;c.statistics=null;return c},_applyStatInfos:function(c){c=this._getStatFields(c);
this._applyStatInfosToIndex(c);this._applyStatInfosToClusters(c)},_getStatFields:function(c){c=this._getValidStatInfos(c);var b=[];q.forEach(c,function(a){-1===q.indexOf(b,a.field)&&b.push(a.field)});return b},_getValidStatInfos:function(c){var b=this.layer;return q.filter(c,function(a){return b.loaded&&b.isOutField(a.field)&&("sum"===a.type||"avg"===a.type)})},_applyStatInfosToIndex:function(c){var b=this._cellIndex;if(b)for(var a=1;a<=this._maxGeohashLength;a++){var g=b[a],e;for(e in g)this._applyStatInfosToCell(g[e],
c)}},_applyStatInfosToCell:function(c,b){var a=this._initializeStats(c,b);q.forEach(c.features,function(c){this._calcFeatureStats(c,b,a)},this);this._summarizeStats(c,a,b)},_calcFeatureStats:function(c,b,a){var g=c.attributes;g&&q.forEach(b,function(b){var c=g[b];b=a[b];this._isValidNumber(c)&&(b.count++,b.sum+=c)},this)},_applyStatInfosToClusters:function(c){q.forEach(this.clusters,function(b){var a=this._initializeStats(b,c);q.forEach(this.getCellsInCluster(b),function(b){this._calcCellStats(b,
c,a)},this);this._summarizeStats(b,a,c);b.attributes.clusterId=b.primary},this)},_calcCellStats:function(c,b,a){var g=c.statistics;q.forEach(b,function(b){var c=g[b];b=a[b];c.count&&(b.count+=c.count,b.sum+=c.sum)})},_initializeStats:function(c,b){var a=c.statistics={};q.forEach(b,function(b){a[b]={count:0,sum:null,avg:null}});return a},_summarizeStats:function(c,b,a){var g=c.attributes={count:c.count};q.forEach(a,function(a){var c=b[a];0<c.count&&(c.avg=c.sum/c.count);g["sum_"+a]=c.sum;g["avg_"+
a]=c.avg})},_updateItem:function(c,b,a,g){var e=a.y,d=c.centroid,h=c.count;d.x=(h*d.x+b*a.x)/(h+b);d.y=(h*d.y+b*e)/(h+b);c.count+=b;g&&this._updateExtent(c.extent,a)},_updateExtent:function(c,b){var a=b.x,g=b.y;a<c.xmin&&(c.xmin=a);a>c.xmax&&(c.xmax=a);g<c.ymin&&(c.ymin=g);g>c.ymax&&(c.ymax=g)},_isValidNumber:function(c){return"number"===typeof c&&!isNaN(c)&&Infinity!==c&&-Infinity!==c},_getTime:function(){return window.performance?window.performance.now():(new Date).getTime()},_getElapsedTime:function(c,
b){var a,g;g=null!=c&&null!=b?b-c:c;null!=g&&(a="millisecond",1E3<=g&&(g/=1E3,a="second",60<=g&&(g/=60,a="minute")),a={value:Number(g.toFixed(2)),unit:a});return a}})})},"esri/layers/clustering/geohashUtils":function(){define("dojo/has dojo/string dojo/_base/lang dojo/_base/array ../../kernel ../../geometry/Point ../../geometry/Extent ../../SpatialReference ../../geometry/webMercatorUtils".split(" "),function(r,l,d,q,k,m,p,h,e){function c(a){var b=a.spatialReference;if(!b)return{x:a.x,y:a.y};var c=
b.isWebMercator(),f;4326===b.wkid?f={x:a.x,y:a.y}:c&&(f={x:a.getLongitude(),y:a.getLatitude()});return f}function b(a){var b=a.spatialReference,c=!(!b||!b.isWebMercator()),f;b&&4326===b.wkid?f=new p(a.toJson()):c&&(f=e.webMercatorToGeographic(a,!0));return f}function a(a,b){b.x=m.prototype._normalizeX(a.x,h.prototype._info[4326]);b.y=a.y;return b}function g(a){a=F.decimals[a].toString(2);return l.pad(a,F.bitsPerBase32Char,"0")}function u(a,b){var c;b=b.slice();b.splice(1,0,0);for(var f=b[0],g=b[2],
e=0;e<a.length;e++)Number(a[e])?b[0]=b[1]:b[2]=b[1],c=b[1]=(b[0]+b[2])/2,f=b[0],g=b[2];return{value:c,min:f,max:g}}function n(a,b,c){var f=[];b=b.slice();b.splice(1,0,0);for(var g=b[0],e=b[2],d=0;d<c;d++)a>=b[1]?(b[0]=b[1],g=1):(b[2]=b[1],g=0),b[1]=(b[0]+b[2])/2,f.push(g),g=b[0],e=b[2];return{value:f.join(""),min:g,max:e}}function t(a){var b=a*F.bitsPerBase32Char;0===b%2?a=b/=2:(a=(b+1)/2,b-=a);return{lon:a,lat:b}}function f(a){var b=0;a=a.split("").reverse().join("");for(var c=0;c<a.length;c++)b+=
Number(a[c])*Math.pow(2,c);return F.base32[b]}function v(a,b){var c={x:a.xmin,y:a.ymax},f={x:a.xmax,y:a.ymin},g={x:a.xmax,y:a.ymax};return{sw:G.pointToGeohash({x:a.xmin,y:a.ymin},b),nw:G.pointToGeohash(c,b),se:G.pointToGeohash(f,b),ne:G.pointToGeohash(g,b)}}function x(a,b,c,f,g){var e=a;do g[e]||(g[e]=!0,f.push(e)),(a=e===b)||(e=D(e,c));while(!a)}function w(a,b,c,f){var g=v(a,b);a=[];x(g.sw,g.nw,"n",a,{});b=[];x(g.se,g.ne,"n",b,{});for(g=0;g<a.length;g++)x(a[g],b[g],"e",c,f)}function z(a){return q.filter(a,
function(a){return 180===a.xmax?!0:!1})[0]}function A(a){return q.filter(a,function(a){return-180===a.xmin?!0:!1})[0]}function y(a,b,c,f){var g=G.geographicToWebMercator(a);a={x:g.x-b,y:g.y-b};b=G.webMercatorToGeographic({x:g.x+b,y:g.y+b},!0);a=G.webMercatorToGeographic(a,!0);return new p(null!=c?c:a.x,a.y,null!=f?f:b.x,b.y)}function B(a,b,c,f){var g;a=v(a,b);var e,d;"min"===f?d=180:"max"===f&&(e=-180);var h=e;f=d;g=G.geohashToCell(a.sw).extent;b=G.geohashToCell(a.ne).extent;a=null!=h?h:g.xmin;g=
g.ymin;f=null!=f?f:b.xmax;b=b.ymax;a=y({x:a,y:g},c,e,d);c=y({x:f,y:b},c,e,d);return new p(a.xmin,a.ymin,c.xmax,c.ymax)}function C(a,b,c){var f=a,g=0;do g++,(a=f===b)||(f=D(f,c));while(!a);return g}function E(a,b){var c=v(a,b),f=C(c.nw,c.ne,"e");return{rows:C(c.nw,c.sw,"s"),cols:f}}function D(a,b){var c=a.length%2,f=a.slice(-1),g=F.decimals[f],e=a.slice(0,-1);-1!=F.borders[b][c].indexOf(f)&&e&&(e=D(e,b));return e+F.neighbors[b][c][g]}var F={base32:"0123456789bcdefghjkmnpqrstuvwxyz",decimals:function(){for(var a=
{},b=0;32>b;b++)a["0123456789bcdefghjkmnpqrstuvwxyz"[b]]=b;return a}(),neighbors:{n:[null,"238967debc01fg45kmstqrwxuvhjyznp"],s:[null,"bc01fg45238967deuvhjyznpkmstqrwx"],e:[null,"14365h7k9dcfesgujnmqp0r2twvyx8zb"],w:[null,"p0r21436x8zb9dcf5h7kjnmqesgutwvy"]},borders:{n:[null,"bcfguvyz"],s:[null,"0145hjnp"],e:[null,"prxz"],w:[null,"028b"]},bitsPerBase32Char:5,maxGeohashLength:12,longitudeRange:[-180,180],latitudeRange:[-90,90]};F.neighbors.n[0]="14365h7k9dcfesgujnmqp0r2twvyx8zb";F.neighbors.s[0]="p0r21436x8zb9dcf5h7kjnmqesgutwvy";
F.neighbors.e[0]="238967debc01fg45kmstqrwxuvhjyznp";F.neighbors.w[0]="bc01fg45238967deuvhjyznpkmstqrwx";F.borders.n[0]="prxz";F.borders.s[0]="028b";F.borders.e[0]="bcfguvyz";F.borders.w[0]="0145hjnp";var G={geographicToWebMercator:function(a){a=m.lngLatToXY(a.x,a.y);return{x:a[0],y:a[1]}},webMercatorToGeographic:function(a,b){var c=m.xyToLngLat(a.x,a.y,b);return{x:c[0],y:c[1]}},geohashToCell:function(a){for(var b=[],c=0;c<a.length;c++)b.push(g(a[c]));for(var b=b.join(""),c=[],f=[],e=0;e<b.length;e++)0===
e%2?c.push(b[e]):f.push(b[e]);c=c.join("");f=f.join("");c=[c,f];b=u(c[0],F.longitudeRange);c=u(c[1],F.latitudeRange);return{point:{x:b.value,y:c.value},extent:{xmin:b.min,xmax:b.max,ymin:c.min,ymax:c.max},geohash:a}},pointToCell:function(b,g){var e,d,h;g=g||F.maxGeohashLength;var k=c(b);if(k){k=a(k,k);e=t(g);h=n(k.x,F.longitudeRange,e.lon);var m=n(k.y,F.latitudeRange,e.lat);e=h.value;d=m.value;h={xmin:h.min,xmax:h.max,ymin:m.min,ymax:m.max};for(var m=[],u=Math.ceil((e.length+d.length)/F.bitsPerBase32Char),
l=0,p=0,q=0;q<u*F.bitsPerBase32Char;q++){var v=0===q%2?e[l++]:d[p++];null==v&&(v=0);m.push(v)}e=m.join("");d=F.bitsPerBase32Char;m=e.length/d;u=[];for(l=0;l<m;l++)p=e.substr(l*d,d),u.push(f(p));e=u.join("");return{point:k,extent:h,geohash:e}}},geohashToPoint:function(a){return G.geohashToCell(a).point},pointToGeohash:function(a,b){var c=G.pointToCell(a,b);return c&&c.geohash},getCells:function(a){return q.map(a,function(a){return G.geohashToCell(a)})},getCellSize:function(a){var b=F.longitudeRange,
c=F.latitudeRange,b=Math.abs(b[1]-b[0]),c=Math.abs(c[1]-c[0]);a=t(a||1);return{width:b/Math.pow(2,a.lon),height:c/Math.pow(2,a.lat)}},getCellSizeInMeters:function(a){a=G.getCellSize(a);var b=e.metersPerDegree;a.width*=b;a.height*=b;return a},getIntersecting:function(a,c,f){c=c||1;f=f||0;var g=[],e=b(a);if(e){f&&(e=G.expandExtent(a,c,f));a=e.normalize();var d={};q.forEach(a,function(a){w(a,c,g,d)})}return g},countIntersecting:function(c,f,g){f=f||1;g=g||0;var e=0,d=b(c);if(d){g&&(d=G.expandExtent(c,
f,g));c=d.normalize();if(2===c.length){e=z(c);d=A(c);g=E(e,f);var h=E(d,f);c=g.rows;g=g.cols+h.cols;e={x:e.xmin,y:e.ymax};d={x:d.xmax,y:d.ymax};e=a(e,{});d=a(d,{});e=G.pointToGeohash(e,f);f=G.pointToGeohash(d,f);e===f&&g--;f={rows:c,cols:g}}else f=E(c[0],f);e=f.cols*f.rows}return e},getChildren:function(a){a=a||"";var b=[],c;for(c in F.decimals)b.push(a+c);return b},getNeighbors:function(a){var b=D(a,"n"),c=D(a,"s");return[b,D(b,"e"),D(b,"w"),c,D(c,"e"),D(c,"w"),D(a,"e"),D(a,"w")]},getExtentFromDistance:function(a,
b){b=b||1E3;var f,g=c(a);g&&(f=y(g,b));return f},expandExtent:function(a,c,f){c=c||1;f=f||0;if(a=b(a)){if(f){a=a.normalize();if(2===a.length){var g=f;f=z(a);a=A(a);f=B(f,c,g,"min");a=B(a,c,g,"max");360<=f.getWidth()+a.getWidth()?(c=-180,a=180):(c=f.xmin,a=a.xmax);return new p(c,f.ymin,a,f.ymax)}return B(a[0],c,f)}return a}},getNeighborsWithinDistance:function(a,b,f){f=f||1E3;b=b||1;var g=[];if(a=c(a)){f=y(a,f).normalize();var e={};q.forEach(f,function(a){w(a,b,g,e)})}return g}};return G})},"esri/tasks/ProjectParameters":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/json dojo/has ../kernel ../lang ../geometry/jsonUtils".split(" "),
function(r,l,d,q,k,m,p,h){return r(null,{declaredClass:"esri.tasks.ProjectParameters",geometries:null,outSR:null,transformation:null,transformForward:null,toJson:function(){var e=d.map(this.geometries,function(b){return b.toJson()}),c={};c.outSR=this.outSR.wkid||q.toJson(this.outSR.toJson());c.inSR=this.geometries[0].spatialReference.wkid||q.toJson(this.geometries[0].spatialReference.toJson());c.geometries=q.toJson({geometryType:h.getJsonType(this.geometries[0]),geometries:e});this.transformation&&
(c.transformation=this.transformation.wkid||q.toJson(this.transformation));p.isDefined(this.transformForward)&&(c.transformForward=this.transformForward);return c}})})},"jimu/portalUrlUtils":function(){define(["dojo/_base/lang","jimu/shared/basePortalUrlUtils"],function(r,l){var d=r.clone(l);d.declaredClass="jimu.portalUrlUtils";d.getPortalUrlFromLocation=function(){return d.getPortalServerFromLocation()+d.getDeployContextFromLocation()};d.getPortalSignInUrlFromLocation=function(){var l=d.getPortalUrlFromLocation();
return d.setHttpsProtocol(l+"home/signin.html")};d.getPortalServerFromLocation=function(){return window.location.protocol+"//"+window.location.host};d.getDeployContextFromLocation=function(){var d=window.location.href.split("?")[0],k=d.indexOf("/home");0>k&&(k=d.indexOf("/apps"));d=d.substring(d.indexOf(window.location.host)+window.location.host.length+1,k);"/"!==d&&(d="/"+d+"/");return d};d.getRestBaseUrlFromLocation=function(){return window.location.protocol+"//"+window.location.host+d.getDeployContextFromLocation()+
"sharing/rest/"};return d})},"jimu/shared/basePortalUrlUtils":function(){define(function(){var r={declaredClass:"jimu.shared.basePortalUrlUtils"};"function"!==typeof String.prototype.trim&&(String.prototype.trim=function(){return this.replace(/^\s*/gi,"").replace(/\s*$/gi,"")});"function"!==typeof String.prototype.startWith&&(String.prototype.startWith=function(l){return this.substr(0,l.length)===l});"function"!==typeof String.prototype.endWith&&(String.prototype.endWith=function(l){return this.substr(this.length-
l.length,l.length)===l});r.getServerByUrl=function(l){l=(l||"").trim();l=l.replace(/^(http(s?):?)\/\//gi,"");0===l.indexOf("//")&&(l=l.slice(2));return l.split("/")[0]};r.getServerWithProtocol=function(l){var d="";if(l=(l||"").trim()){var q=r.getServerByUrl(l);if(!q)return d;var k=r.getProtocol(l);k?d=k+"://"+q:0===l.indexOf("//")&&(d="//"+q)}return d};r.isSameServer=function(l,d){l=r.getServerByUrl(l)||"";d=r.getServerByUrl(d)||"";return l.toLowerCase()===d.toLowerCase()};r.getDomain=function(l){var d=
"";if(l=r.getServerByUrl(l))l=l.replace(/:\d+$/,""),l=l.match(/[^.]\w+\.\w+$/),null!==l&&(d=l[0],/^\d+\.\d+$/.test(d)&&(d=""));return d};r.isSameDomain=function(l,d){var q=r.getDomain(l),k=r.getDomain(d);return""!==q&&q===k};r.isOrgOnline=function(l){return 0<=r.getServerByUrl(l).toLowerCase().indexOf(".maps.arcgis.com")};r.isOnline=function(l){return 0<=r.getServerByUrl(l).toLowerCase().indexOf(".arcgis.com")};r.isArcGIScom=function(l){l=r.getServerByUrl(l).toLowerCase();return"www.arcgis.com"===
l||"arcgis.com"===l};r.getStandardPortalUrl=function(l){var d=r.getServerByUrl(l);if(""===d)return"";r.isOnline(d)?(r.isArcGIScom(d)&&(d="www.arcgis.com"),l=r.addProtocol(l),l=r.getProtocol(l)+"://"+d):(l=(l||"").trim().replace(/sharing(.*)/gi,"").replace(/\/*$/g,""),l=r.addProtocol(l),l.replace(new RegExp("http(s?)://"+d,"g"),"")||(l+="/arcgis"));return l};r.isSamePortalUrl=function(l,d){var q=/^http(s?):\/\//gi,k=/^\/\//gi;l=r.getStandardPortalUrl(l).toLowerCase().replace(q,"").replace(k,"");d=
r.getStandardPortalUrl(d).toLowerCase().replace(q,"").replace(k,"");return l===d};r.addProtocol=function(l){if(-1>=l.toLowerCase().indexOf("http://")&&-1>=l.toLowerCase().indexOf("https://")){var d="";"undefined"!==typeof window&&window.location?(d=window.location.protocol,l=l.startWith("//")?d+l:l.startWith("/")?d+"//"+window.location.host+l:d+"//"+l):(d="http:",l=l.startWith("//")?d+l:d+"//"+l)}return l};r.getProtocol=function(l){var d="";l=l.toLowerCase();0===l.indexOf("https://")?d="https":0===
l.indexOf("http://")&&(d="http");return d};r.updateUrlProtocolByOtherUrl=function(l,d){d=d.toLowerCase();0===d.indexOf("https://")?l=r.setHttpsProtocol(l):0===d.indexOf("http://")&&(l=r.setHttpProtocol(l));return l};r.removeProtocol=function(l){return l.replace(/^http(s?):\/\//i,"//")};r.setHttpProtocol=function(l){l=r.addProtocol(l);return l.replace(/^https:\/\//,"http://")};r.setHttpsProtocol=function(l){l=r.addProtocol(l);return l.replace(/^http:\/\//,"https://")};r.setProtocol=function(l,d){return 0<=
d.indexOf("https")?r.setHttpsProtocol(l):0<=d.indexOf("http")?r.setHttpProtocol(l):l};r.getSharingUrl=function(l){var d="";(l=r.getStandardPortalUrl(l))&&(d=l+"/sharing/rest");return d};r.getOAuth2Url=function(l){var d="";(l=r.getStandardPortalUrl(l))&&(d=l+"/sharing/rest/oauth2");return d};r.getAppIdUrl=function(l,d){var q="",k=r.getStandardPortalUrl(l);k&&(q=k+"/sharing/rest/oauth2/apps/"+d);return q};r.getSignInUrl=function(l){var d="";(l=r.getStandardPortalUrl(l))&&(d=l+"/home/signin.html");return d};
r.getBaseSearchUrl=function(l){var d="";l=r.getStandardPortalUrl(l);(l=l.replace(/\/*$/g,""))&&(d=l+"/sharing/rest/search");return d};r.getBaseItemUrl=function(l){var d="";(l=r.getStandardPortalUrl(l))&&(d=l+"/sharing/rest/content/items");return d};r.getItemUrl=function(l,d){var q="",k=r.getBaseItemUrl(l);k&&d&&(q=k+"/"+d);return q};r.getItemDataUrl=function(l,d){var q="",k=r.getItemUrl(l,d);k&&(q=k+"/data");return q};r.getItemGroupsUrl=function(l,d){var q="",k=r.getItemUrl(l,d);k&&(q=k+"/groups");
return q};r.getGenerateTokenUrl=function(l){var d="";(l=r.getStandardPortalUrl(l))&&(d=l+"/sharing/generateToken");return d};r.getItemDetailsPageUrl=function(l,d){var q="";l&&d&&(l=r.getStandardPortalUrl(l),q=l+"/home/item.html?id\x3d"+d);return q};r.getUserProfilePageUrl=function(l,d){var q="";l&&d&&(l=r.getStandardPortalUrl(l),q=l+"/home/user.html?user\x3d"+d);return q};r.getBaseGroupUrl=function(l){var d="";(l=r.getStandardPortalUrl(l))&&(d=l+"/sharing/rest/community/groups");return d};r.getPortalSelfInfoUrl=
function(l){var d="";(l=r.getStandardPortalUrl(l||""))&&(d=l+"/sharing/rest/portals/self");return d};r.getCommunitySelfUrl=function(l){var d="";(l=r.getStandardPortalUrl(l||""))&&(d=l+"/sharing/rest/community/self");return d};r.getBaseUserUrl=function(l){var d="";(l=r.getStandardPortalUrl(l))&&(d=l+"/sharing/rest/community/users");return d};r.getUserUrl=function(l,d){var q="",k=r.getBaseUserUrl(l);l&&d&&(q=k+"/"+d);return q};r.getUserTagsUrl=function(l,d){var q="",k=r.getUserUrl(l,d);l&&d&&(q=k+"/tags");
return q};r.getUserThumbnailUrl=function(l,d,q){var k="";(l=r.getUserUrl(l,d))&&q&&(k=l+"/info/"+q);return k};r.getContentUrl=function(l){var d="";l&&(l=r.getStandardPortalUrl(l),d=l+"/sharing/rest/content");return d};r.getUserContentUrl=function(l,d,q){var k="",k="";l&&d&&(k=r.getContentUrl(l),k=q?k+"/users/"+d+"/"+q:k+"/users/"+d);return k};r.getUserContentItemUrl=function(l,d,q){var k="",k="";l&&d&&q&&(k=r.getUserContentUrl(l,d),k=k+"/items/"+q);return k};r.getItemResourceUrl=function(l,d,q){var k=
"",k="";l&&d&&(k=r.getContentUrl(l),k=q?k+"/items/"+d+"/resources/"+q:k+"/items/"+d+"/resources");return k};r.getAddItemUrl=function(l,d,q){var k="",k="";l&&d&&(k=r.getUserContentUrl(l,d,q),k+="/addItem");return k};r.getDeleteItemUrl=function(l,d,q){var k="";(l=r.getUserItemsUrl(l,d))&&(k=l+"/"+q+"/delete");return k};r.getUserItemsUrl=function(l,d,q){var k="",k="";l&&d&&(k=r.getUserContentUrl(l,d,q),k+="/items");return k};r.getUpdateItemUrl=function(l,d,q,k){var m="",m="";l&&d&&(m=r.getUserItemsUrl(l,
d,k),m=m+"/"+q+"/update");return m};r.shareItemUrl=function(l,d,q,k){var m="",m="";l&&d&&(m=r.getUserItemsUrl(l,d,k),m=m+"/"+q+"/share");return m};r.getHomeIndexUrl=function(l){var d="";(l=r.getStandardPortalUrl(l))&&(d=l+"/home/index.html");return d};r.getHomeMapViewerUrl=function(l,d){var q="",k=r.getStandardPortalUrl(l);k&&(q=k+"/home/webmap/viewer.html",q=d?q+("?webmap\x3d"+d):q+"?useExisting\x3d1");return q};r.getHomeSceneViewerUrl=function(l,d){var q="",k=r.getStandardPortalUrl(l);k&&(q=k+"/home/webscene/viewer.html",
d&&(q+="?webscene\x3d"+d));return q};r.getHomeGalleryUrl=function(l){var d="";(l=r.getStandardPortalUrl(l))&&(d=l+"/home/gallery.html");return d};r.getHomeGroupsUrl=function(l){var d="";(l=r.getStandardPortalUrl(l))&&(d=l+"/home/groups.html");return d};r.getHomeMyContentUrl=function(l){var d="";(l=r.getStandardPortalUrl(l))&&(d=l+"/home/content.html");return d};r.getHomeMyOrganizationUrl=function(l){var d="";(l=r.getStandardPortalUrl(l))&&(d=l+"/home/organization.html");return d};r.getHomeUserUrl=
function(l){var d="";(l=r.getStandardPortalUrl(l))&&(d=l+"/home/user.html");return d};r.getPortalHelpUrl=function(l,d){var q="",k=r.getStandardPortalUrl(l);k&&(q=k+"/portalhelp/"+(d||"en")+"/website/help/");return q};r.getPortalAdminHelpUrl=function(l,d){var q="",k=r.getStandardPortalUrl(l);k&&(q=k+"/portalhelp/"+(d||"en")+"/admin/help/");return q};r.getPortalProxyUrl=function(l){var d="";(l=r.getStandardPortalUrl(l))&&(d=l+"/sharing/proxy");return d};r.getOAuth2SignOutUrl=function(l){var d="";(l=
r.getStandardPortalUrl(l))&&(d=l+"/sharing/rest/oauth2/signout");return d};r.getNewPrintUrl=function(l){var d="";if(l=r.getStandardPortalUrl(l))l=r.setHttpProtocol(l),d=l+"/sharing/tools/newPrint";return d};r.getSwitchAccoutnsUrl=function(l,d,q){var k="";if(l=r.getStandardPortalUrl(l))k=l+"/home/pages/Account/manage_accounts.html#client_id\x3d"+d,q&&(k+="\x26redirect_uri\x3d"+q);k&&(k=r.setHttpsProtocol(k));return k};return r})},"jimu/shared/utils":function(){define(["./basePortalUrlUtils"],function(r){function l(d,
m){function k(h,e){var c,b,a,g,k="widgetOnScreen"===h;if(d[h]){if(d[h].groups)for(c=0;c<d[h].groups.length;c++)if(a=d[h].groups[c],e(a,{index:c,isWidget:!1,groupId:a.id,isThemeWidget:!1,isOnScreen:k}),d[h].groups[c].widgets)for(b=0;b<d[h].groups[c].widgets.length;b++)g=d[h].groups[c].widgets[b],e(g,{index:b,isWidget:!0,groupId:a.id,isThemeWidget:g.uri&&-1<g.uri.indexOf("themes/"+d.theme.name),isOnScreen:k});if(d[h].widgets)for(c=0;c<d[h].widgets.length;c++)g=d[h].widgets[c],e(d[h].widgets[c],{index:c,
isWidget:!0,groupId:h,isThemeWidget:g.uri&&-1<g.uri.indexOf("themes/"+d.theme.name),isOnScreen:k})}}k("widgetOnScreen",m);k("widgetPool",m)}var d={},q="inPanel hasLocale hasStyle hasConfig hasUIFile hasSettingPage hasSettingUIFile hasSettingLocale hasSettingStyle keepConfigAfterMapSwitched isController hasVersionManager isThemeWidget supportMultiInstance".split(" ");d.visitElement=l;d.getConfigElementById=function(d,m){var k;if("map"===m)return d.map;l(d,function(d){if(d.id===m)return k=d,!0});return k};
d.getConfigElementByLabel=function(d,m){var k;if("map"===m)return d.map;l(d,function(d){if(d.label||d.name===m)return k=d,!0});return k};d.getConfigElementsByName=function(d,m){var k=[];if("map"===m)return[d.map];l(d,function(d){d.name===m&&k.push(d)});return k};d.getWidgetNameFromUri=function(d){d=d.split("/");d.pop();return d.pop()};d.getAmdFolderFromUri=function(d){d=d.split("/");d.pop();return d.join("/")+"/"};d.widgetProperties=q;d.processWidgetProperties=function(d){"undefined"===typeof d.properties.isController&&
(d.properties.isController=!1);"undefined"===typeof d.properties.isThemeWidget&&(d.properties.isThemeWidget=!1);"undefined"===typeof d.properties.hasVersionManager&&(d.properties.hasVersionManager=!1);q.forEach(function(k){"undefined"===typeof d.properties[k]&&(d.properties[k]=!0)})};d.getControllerWidgets=function(d){var k=[];d.visitElement(function(d){d.isController&&k.push(d)});return k};d.addI18NLabelToManifest=function(d,m,l){function h(b,a){a[e]&&(d.i18nLabels[b]=a[e]);"theme"===d.category&&
(d.layouts&&d.layouts.forEach(function(c){d["i18nLabels_layout_"+c.name]||(d["i18nLabels_layout_"+c.name]={});d["i18nLabels_layout_"+c.name][b]=a["_layout_"+c.name]}),d.styles&&d.styles.forEach(function(c){d["i18nLabels_style_"+c.name]||(d["i18nLabels_style_"+c.name]={});d["i18nLabels_style_"+c.name][b]=a["_style_"+c.name]}));"widget"===d.category&&d.featureActions&&d.featureActions.forEach(function(c){d["i18nLabels_featureAction_"+c.name]||(d["i18nLabels_featureAction_"+c.name]={});d["i18nLabels_featureAction_"+
c.name][b]=a["_featureAction_"+c.name]})}d.i18nLabels={};var e="widget"===d.category?"_widgetLabel":"_themeLabel";m&&m.root&&m.root[e]&&(d.i18nLabels.defaultLabel=m.root[e],"theme"===d.category&&(d.layouts&&d.layouts.forEach(function(b){d["i18nLabels_layout_"+b.name]={};d["i18nLabels_layout_"+b.name].defaultLabel=m.root["_layout_"+b.name]}),d.styles&&d.styles.forEach(function(b){d["i18nLabels_style_"+b.name]={};d["i18nLabels_style_"+b.name].defaultLabel=m.root["_style_"+b.name]})),"widget"===d.category&&
d.featureActions&&d.featureActions.forEach(function(b){d["i18nLabels_featureAction_"+b.name]={};d["i18nLabels_featureAction_"+b.name].defaultLabel=m.root["_featureAction_"+b.name]}));for(var c in l)h(c,l[c])};d.isHostedService=function(d){var k=r.getServerByUrl(d);return(new RegExp(k+"/[^/]+/[^/]+/rest/services","gi")).test(d)};return d})},"jimu/portalUtils":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/config dojo/Deferred dojo/topic dojo/json dojo/request/xhr esri/request ./Role ./utils ./portalUrlUtils ./tokenUtils".split(" "),
function(r,l,d,q,k,m,p,h,e,c,b,a,g){var u=r([],{declaredClass:"jimu.Portal",selfUrl:null,user:null,selfInfo:null,portalUrl:null,credential:null,constructor:function(b){this.portalUrl=a.getStandardPortalUrl(b);this.selfUrl=a.getPortalSelfInfoUrl(b)},loadSelfInfo:function(){var a=new k,b={url:this.selfUrl,content:{f:"json"},handleAs:"json",callbackParamName:"callback",preventCache:!0};this.isValidCredential()&&(b.content.token=this.credential.token);e(b).then(l.hitch(this,function(b){var c=b.user;delete b.user;
l.mixin(this,b);b.user=c;a.resolve(b)}),l.hitch(this,function(b){console.error(b);a.reject(b)}));return a},_checkCredential:function(){var a=g.isValidCredential(this.credential);a||this.clearCredentialAndUser();return a},isValidCredential:function(){this.updateCredential();return this._checkCredential()},updateCredential:function(){this._checkCredential()||(this.credential=g.getPortalCredential(this.portalUrl))},signIn:function(){var a=new k;this.updateCredential();this.isValidCredential()?setTimeout(l.hitch(this,
function(){a.resolve(this.credential)}),0):a=g.signInPortal(this.portalUrl);return a},haveSignIn:function(){return g.userHaveSignInPortal(this.portalUrl)},clearCredentialAndUser:function(){this.user=this.credential=null},getUser:function(){this.updateCredential();var a=new k;this.user&&"jimu.PortalUser"===this.user.declaredClass?setTimeout(l.hitch(this,function(){this.user.updateCredential();a.resolve(this.user)}),0):this.isValidCredential()?this.credential.userId?this._getUser(this.credential.userId).then(l.hitch(this,
function(b){this.user=b;a.resolve(this.user)}),l.hitch(this,function(b){console.error(b);a.reject(b)})):g.getUserIdByToken(this.credential.token,this.portalUrl).then(l.hitch(this,function(b){this.credential.userId=b;this._getUser(this.credential.userId).then(l.hitch(this,function(b){this.user=b;a.resolve(this.user)}),l.hitch(this,function(b){console.error(b);a.reject(b)}))}),l.hitch(this,function(b){console.error(b);a.reject(b)})):setTimeout(l.hitch(this,function(){a.reject("credential is null.")}),
0);return a},queryItems:function(b){this.updateCredential();var c=new k,g=a.getBaseSearchUrl(this.portalUrl),h={f:"json"};b&&(h=l.mixin(h,b));this.isValidCredential()&&(h.token=this.credential.token);h.sortField||h.sortOrder||(h.sortField="title",h.sortOrder="asc");e({url:g,handleAs:"json",content:h,callbackParamName:"callback"}).then(l.hitch(this,function(a){a.results=d.map(a.results,l.hitch(this,function(a){a.portalUrl=this.portalUrl;a.credential=this.credential;a.portal=this;return new f(a)}));
c.resolve(a)}),l.hitch(this,function(a){console.error(a);c.reject(a)}));return c},getItemData:function(b){this.updateCredential();b={url:a.getItemDataUrl(this.portalUrl,b),handleAs:"json",content:{f:"json"},callbackParamName:"callback"};return e(b)},_getItemById:function(b,c){var g={url:a.getItemUrl(this.portalUrl,b),handleAs:"json",content:{f:"json"},callbackParamName:"callback"};c&&(g.content.token=c);return e(g).then(l.hitch(this,function(a){a.portalUrl=this.portalUrl;a.credential=this.credential;
a.portal=this;return new f(a)}))},getItemById:function(a,b){this.updateCredential();return this._getItemById(a).then(l.hitch(this,function(c){return b&&c.owner&&this.isValidCredential()&&this.credential&&this.credential.userId===c.owner?this._getItemById(a,this.credential.token):c}))},getAppById:function(b){var c=new k;this.updateCredential();this.isValidCredential()?(b=a.getAppIdUrl(this.portalUrl,b),c=e({url:b,handleAs:"json",content:{f:"json",token:this.credential.token}})):setTimeout(l.hitch(this,
function(){c.reject("token is null.")}),0);return c},queryGroups:function(b){this.updateCredential();var c=new k,f=a.getBaseGroupUrl(this.portalUrl),g={f:"json"};b&&(g=l.mixin(g,b));this.isValidCredential()&&(g.token=this.credential.token);e({url:f,handleAs:"json",content:g,callbackParamName:"callback"}).then(l.hitch(this,function(a){a.results=d.map(a.results,l.hitch(this,function(a){a.portalUrl=this.portalUrl;a.credential=this.credential;a.portal=this;return new t(a)}));c.resolve(a)}),l.hitch(this,
function(a){console.error(a);c.reject(a)}));return c},registerApp:function(b,c,f){var g=new k;this.updateCredential();if(this.isValidCredential())var d=this.credential&&this.credential.token,h=a.getOAuth2Url(this.portalUrl),g=e({url:h+"/registerApp",content:{itemId:b,appType:c,redirect_uris:p.stringify(f),token:d,f:"json"},handleAs:"json"},{usePost:!0});else setTimeout(l.hitch(this,function(){g.reject("token is null.")}),0);return g},createAndRegisterApp:function(a){var b=new k;this.updateCredential();
this.isValidCredential()?this.getUser().then(l.hitch(this,function(c){c.addItem({title:"Web AppBuilder for ArcGIS",type:"Web Mapping Application",text:"",snippet:"",tags:"Registered App for OAuth"},"").then(l.hitch(this,function(c){c.success?this.registerApp(c.id,"browser",a).then(l.hitch(this,function(a){b.resolve(a)}),l.hitch(this,function(a){console.error(a);b.reject(a)})):b.reject("create app failed")}),l.hitch(this,function(a){console.error(a);b.reject(a)}))}),l.hitch(this,function(a){console.error(a);
b.reject(a)})):setTimeout(l.hitch(this,function(){b.reject("token is null.")}),0);return b},_getUser:function(b){this.updateCredential();var c=new k;b={url:a.getUserUrl(this.portalUrl,b),content:{f:"json"},handleAs:"json",callbackParamName:"callback"};this.isValidCredential()&&(b.content.token=this.credential&&this.credential.token);e(b).then(l.hitch(this,function(a){a.portalUrl=this.portalUrl;a.credential=this.credential;a.portal=this;this.user=new n(a);c.resolve(this.user)}),l.hitch(this,function(a){console.error(a);
c.reject(a)}));return c}}),n=r([],{declaredClass:"jimu.PortalUser",portalUrl:null,credential:null,portal:null,constructor:function(a){a&&l.mixin(this,a)},_checkCredential:function(){var a=g.isValidCredential(this.credential);a||(this.credential=null);return a},isValidCredential:function(){this.updateCredential();return this._checkCredential()},updateCredential:function(){this._checkCredential()||(this.portal.updateCredential(),this.credential=this.portal.credential)},canCreateItem:function(){var a=
new c({id:this.roleId?this.roleId:this.role,role:this.role});this.privileges&&a.setPrivileges(this.privileges);return a.canCreateItem()},getGroups:function(){var a=[];this.groups&&(a=d.map(this.groups,l.hitch(this,function(a){a.portalUrl=this.portalUrl;a.credential=this.credential;a.portal=this.portal;return new t(a)})));return a},getItemsByKeywords:function(a,b){return this.portal.queryItems({start:b||1,num:100,q:"owner:"+this.username+' AND typekeywords:"'+a+'"'})},getContent:function(){this.updateCredential();
var b={url:a.getUserContentUrl(this.portalUrl,this.username),handleAs:"json",content:{f:"json"},callbackParamName:"callback"};this.isValidCredential&&(b.content.token=this.credential.token);return e(b)},getTags:function(){this.updateCredential();var b={url:a.getUserTagsUrl(this.portalUrl,this.username),handleAs:"json",content:{f:"json"},callbackParamName:"callback"};this.isValidCredential()&&(b.content.token=this.credential.token);return e(b)},addItem:function(b,c){this.updateCredential();var f=new k;
if(this.isValidCredential()){var g={f:"json",token:this.credential.token};b&&(g=l.mixin(g,b));e({url:a.getAddItemUrl(this.portalUrl,this.username,c),handleAs:"json",callbackParamName:"callback",content:g},{usePost:!0}).then(l.hitch(this,function(a){f.resolve(a)}),l.hitch(this,function(a){console.error(a);f.reject(a)}))}else setTimeout(l.hitch(this,function(){f.reject("token is null.")}),0);return f},deleteItem:function(b){this.updateCredential();var c=new k;this.isValidCredential()?(b=a.getDeleteItemUrl(this.portalUrl,
this.username,b),c=e({url:b,content:{token:this.credential.token,f:"json"},handleAs:"json"},{usePost:!0})):setTimeout(l.hitch(this,function(){c.reject("token is null.")}),0);return c},getItemById:function(b,c){this.updateCredential();var g=new k,d={url:a.getUserItemsUrl(this.portalUrl,this.username,c)+"/"+b,handleAs:"json",content:{f:"json"},callbackParamName:"callback"};e(d).then(l.hitch(this,function(a){a.portalUrl=this.portalUrl;a.credential=this.credential;a.portal=this;a=new f(a);g.resolve(a)}),
l.hitch(this,function(a){console.error(a);g.reject(a)}));return g},shareItem:function(b,c,f){this.updateCredential();var g=new k;this.isValidCredential()?(c={url:a.shareItemUrl(this.portalUrl,this.username,c,f),handleAs:"json",callbackParamName:"callback",content:{f:"json",token:this.credential.token}},b&&(c.content=l.mixin(c.content,b)),e(c,{usePost:!0}).then(l.hitch(this,function(a){g.resolve(a)}),l.hitch(this,function(a){console.error(a);g.reject(a)}))):setTimeout(l.hitch(this,function(){g.reject("token is null.")}),
0);return g},updateItem:function(b,c){this.updateCredential();var f=new k;this.isValidCredential()?this.portal.getItemById(b).then(l.hitch(this,function(g){var d={f:"json",token:this.credential.token};c&&(d=l.mixin(d,c));e({url:a.getUpdateItemUrl(this.portalUrl,g.owner,b,g.ownerFolder),handleAs:"json",callbackParamName:"callback",timeout:1E5,content:d},{usePost:!0}).then(l.hitch(this,function(a){f.resolve(a)}),l.hitch(this,function(a){console.error(a);f.reject(a)}))}),l.hitch(this,function(a){console.error(a);
f.reject(a)})):setTimeout(l.hitch(this,function(){f.reject("token is null.")}),0);return f},isAdminRole:function(){return"org_admin"===this.role||"account_admin"===this.role},isPublisherRole:function(){return"org_publisher"===this.role||"account_publisher"===this.role},isUserRole:function(){return"org_user"===this.role||"account_user"===this.role},getRegisteredAppInfo:function(b,c){var f=new k;this.updateCredential();f=a.getUserItemsUrl(this.portalUrl,this.username,c);return f=e({url:f+"/"+b+"/registeredAppInfo",
content:{token:this.credential.token,f:"json"},handleAs:"json"},{usePost:!0})},getRegisteredAppInfoWithXhr:function(b,c){var f=new k;this.updateCredential();f=a.getUserItemsUrl(this.portalUrl,this.username,c);return f=h(f+"/"+b+"/registeredAppInfo",{data:{token:this.credential.token,f:"json"},method:"POST",handleAs:"json"})}}),t=r([],{declaredClass:"jimu.PortalGroup",portalUrl:null,credential:null,portal:null,constructor:function(a){a&&l.mixin(this,a)},_checkCredential:function(){var a=g.isValidCredential(this.credential);
a||(this.credential=null);return a},isValidCredential:function(){this.updateCredential();return this._checkCredential()},updateCredential:function(){this._checkCredential()||(this.portal.updateCredential(),this.credential=this.portal.credential)},queryItems:function(a){a.q="group:"+this.id+" AND "+a.q;return this.portal.queryItems(a)}}),f=r([],{declaredClass:"jimu.PortalItem",itemUrl:null,detailsPageUrl:null,ownerPageUrl:null,portalUrl:null,credential:null,portal:null,token:null,constructor:function(b){b&&
l.mixin(this,b);this.itemUrl=a.getItemUrl(this.portalUrl,this.id);!this.thumbnailUrl&&this.thumbnail&&this.itemUrl&&(this.thumbnailUrl=this.itemUrl+"/info/"+this.thumbnail);this.token=this.credential&&this.credential.token;this.thumbnailUrl&&this.token&&(this.thumbnailUrl+="?token\x3d"+this.token);this.portalUrl&&this.id&&(this.detailsPageUrl=a.getItemDetailsPageUrl(this.portalUrl,this.id));this.portalUrl&&this.owner&&(this.ownerPageUrl=a.getUserProfilePageUrl(this.portalUrl,this.owner))},_checkCredential:function(){var a=
g.isValidCredential(this.credential);a||(this.credential=null);return a},isValidCredential:function(){this.updateCredential();return this._checkCredential()},updateCredential:function(){this._checkCredential()||(this.portal.updateCredential(),this.credential=this.portal.credential)},getItemData:function(){return this.portal.getItemData(this.id)},getItemGroups:function(){this.updateCredential();var b={url:a.getItemGroupsUrl(this.portalUrl,this.id),handleAs:"json",content:{f:"json"},callbackParamName:"callback"};
this.isValidCredential()&&(b.content.token=this.credential.token);return e(b)}}),v={portals:[],webMapQueryStr:" "+b.getItemQueryStringByTypes(["Web Map"])+" ",webSceneQueryStr:" "+b.getItemQueryStringByTypes(["Web Scene"])+" ",_findPortal:function(b){for(var c=0;c<this.portals.length;c++){var f=this.portals[c];if(a.isSamePortalUrl(b,f.portalUrl))return f.updateCredential(),f}return null},getPortal:function(b){if(!b||"string"!==typeof b||!l.trim(b))return null;b=a.getStandardPortalUrl(b);var c=this._findPortal(b);
c||(c=new u(b),c.credential=g.getPortalCredential(c.portalUrl),c.updateCredential(),this.portals.push(c));return c},getPortalSelfInfo:function(a){return this.getPortal(a).loadSelfInfo()},getBasemapGalleryGroup:function(a){return this._getPortalSelfGroup(a,"basemapGalleryGroupQuery")},getTemplatesGroup:function(a){return this._getPortalSelfGroup(a,"templatesGroupQuery")},getUnits:function(a){var b="english",c="",f=new k;this.getPortal(a).getUser().then(l.hitch(this,function(a){a&&a.units?b=a.units:
(c=q.locale,b=c.startWith("en")?"english":"metric");f.resolve(b)}),l.hitch(this,function(g){console.warn(g);this.getPortalSelfInfo(a).then(l.hitch(this,function(a){var b=null;a&&a.units?b=a.units:(c=a&&a.culture||q.locale,b=c.startWith("en")?"english":"metric");f.resolve(b)}),l.hitch(this,function(a){console.warn(a);c=q.locale;b=c.startWith("en")?"english":"metric";f.resolve(b)}))}));return f.promise},_getPortalSelfGroup:function(a,b){var c=new k,f=this.getPortal(a);f||setTimeout(l.hitch(this,function(){c.reject()}),
0);this.getPortalSelfInfo(a).then(l.hitch(this,function(a){f.queryGroups({f:"json",q:a[b]}).then(l.hitch(this,function(a){0<a.results.length?(a=a.results[0],a.portalUrl=f.portalUrl,a.credential=f.credential,a.portal=f,a=new t(a),c.resolve(a)):c.reject("Can't find portal self group.")}),l.hitch(this,function(a){console.error(a);c.reject(a)}))}),l.hitch(this,function(a){console.error(a);c.reject(a)}));return c},getWebMapsFromBasemapGalleryGroup:function(a){var b=new k;this.getBasemapGalleryGroup(a).then(l.hitch(this,
function(a){a?a.queryItems({start:1,num:100,f:"json",q:this.webMapQueryStr}).then(l.hitch(this,function(a){b.resolve(a)}),l.hitch(this,function(a){console.error(a);b.reject(a)})):b.reject()}),l.hitch(this,function(a){console.error(a);b.reject(a)}));return b},getDefaultWebScene:function(b){var c=a.getStandardPortalUrl(b);return this._searchWABDefaultWebScene(c).then(l.hitch(this,function(a){return a?a:this._createWABDefaultWebScene(c).then(l.hitch(this,function(a){return this.getPortal(c).getUser().then(l.hitch(this,
function(b){var c=!1;b&&b.privileges&&0<b.privileges.length&&(c=d.some(b.privileges,function(a){return 0<=a.indexOf("shareToPublic")}));return c?b.shareItem({everyone:!0},a).then(l.hitch(this,function(){return a}),l.hitch(this,function(){return a})):a}),l.hitch(this,function(b){console.error(b);return a}))}))}))},_searchWABDefaultWebScene:function(b){var c=new k;b=a.getStandardPortalUrl(b);this.getPortal(b).queryItems({q:'typekeywords:"WABDefaultWebScene" access:public '+this.webSceneQueryStr}).then(l.hitch(this,
function(a){a&&a.results&&0<a.results.length?c.resolve(a.results[0].id):c.resolve(null)}),l.hitch(this,function(a){console.error("_searchWABDefaultWebScene error:",a);c.reject(a)}));return c},_createWABDefaultWebScene:function(b){var c=new k;b=a.getStandardPortalUrl(b);this.getPortal(b).getUser().then(l.hitch(this,function(a){var b={title:"Default Web Scene",type:"Web Scene",typeKeywords:"WABDefaultWebScene",tags:"default",text:p.stringify({operationalLayers:[],baseMap:{id:"151b431fe65-basemap-0",
title:"Topographic",baseMapLayers:[{id:"defaultBasemap",url:"http://services.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer",layerType:"ArcGISTiledMapServiceLayer"}],elevationLayers:[{id:"globalElevation",url:"http://elevation3d.arcgis.com/arcgis/rest/services/WorldElevation3D/Terrain3D/ImageServer",layerType:"ArcGISTiledElevationServiceLayer"}]},version:"1.3",authoringApp:"WebSceneViewer",authoringAppVersion:"3.10.0.0",spatialReference:{wkid:102100,latestWkid:3857},viewingMode:"global",
initialState:{viewpoint:{scale:4.5188197847224146E7,rotation:0,targetGeometry:{x:144770.99872895706,y:3232837.215000455,spatialReference:{wkid:102100,latestWkid:3857},z:-127.7412482528016},camera:{position:{x:144770.99767624016,y:3182557.105058348,spatialReference:{wkid:102100,latestWkid:3857},z:2.551254800000001E7},heading:0,tilt:.0999986601088944}},environment:{lighting:{datetime:1426420488E3,displayUTCOffset:0}}},presentation:{slides:[]}}),snippet:""};a.addItem(b,"").then(l.hitch(this,function(a){a.success?
c.resolve(a.id):(console.error("Can't create default web scene:",a),c.reject())}))}),l.hitch(this,function(a){console.error("Can't create default web scene");c.reject(a)}));return c},getDefaultWebMap:function(a){var b=new k;this.getPortalSelfInfo(a).then(l.hitch(this,function(c){var f=c.defaultBasemap&&c.defaultBasemap.id;f?b.resolve(f):this._getDefaultWebMapByBasemapGallery(a,c).then(l.hitch(this,function(c){c?b.resolve(c):this._getMostNumViewsWebMap(a).then(l.hitch(this,function(a){a?b.resolve(a):
b.reject()}),l.hitch(this,function(a){console.error(a);b.reject(a)}))}),l.hitch(this,function(a){console.error(a);b.reject(a)}))}),l.hitch(this,function(a){console.error(a);b.reject(a)}));return b},_getDefaultWebMapByBasemapGallery:function(a,b){var c=new k,f=this.getPortal(a),g=b.defaultBasemap&&b.defaultBasemap.title;f.queryGroups({f:"json",q:b.basemapGalleryGroupQuery}).then(l.hitch(this,function(a){a=a.results;0<a.length?f.queryItems({start:1,num:1,f:"json",q:this.webMapQueryStr+" AND group:"+
a[0].id+" AND title:"+g}).then(l.hitch(this,function(a){a=a.results;a=d.filter(a,l.hitch(this,function(a){return a.type&&"web map"===a.type.toLowerCase()}));0<a.length?c.resolve(a[0].id):(console.log("Can't find web map under basemapGalleryGroupQuery."),f.queryItems({start:1,num:1,f:"json",q:this.webMapQueryStr+" AND title:"+g}).then(l.hitch(this,function(a){a=a.results;a=d.filter(a,l.hitch(this,function(a){return a.type&&"web map"===a.type.toLowerCase()}));if(0<a.length){var b=a[0];f.getItemData(b.id).then(l.hitch(this,
function(a){a&&(a.operationalLayers||a.baseMap||a.version)?c.resolve(b.id):c.resolve(null)}),l.hitch(this,function(){c.resolve(null)}))}else console.log("Can't find web map by defaultBasemap.title."),c.resolve(null)}),l.hitch(this,function(a){console.error(a);c.reject(a)})))}),l.hitch(this,function(a){console.error(a);c.reject(a)})):(console.log("Can't find group by basemapGalleryGroupQuery."),c.resolve(null))}),l.hitch(this,function(a){console.error(a);c.reject(a)}));return c},_getMostNumViewsWebMap:function(a){var b=
new k;this.getPortal(a).queryItems({start:1,num:1,f:"json",q:this.webMapQueryStr+" AND access:public AND owner:esri_en",sortField:"numViews",sortOrder:"desc"}).then(l.hitch(this,function(a){a=a.results;a=d.filter(a,l.hitch(this,function(a){return a.type&&"web map"===a.type.toLowerCase()}));0<a.length?b.resolve(a[0].id):b.reject("Can't find most-num-views web map.")}),l.hitch(this,function(a){console.error(a);b.reject(a)}));return b},comparePortalVersion:function(a,b){var c=a.split("."),f=parseInt(c[0],
10),c=1<c.length?parseInt(c[1],10):0,g=b.split("."),e=parseInt(g[0],10),g=1<g.length?parseInt(g[1],10):0;return f>e?1:f<e?-1:c>g?1:c<g?-1:0},getItemResources:function(b){b||(b=100);var c=a.getStandardPortalUrl(window.portalUrl),c=a.getItemResourceUrl(c,window.appInfo.id);return e({url:c,content:{f:"json",num:b}}).then(function(a){if(a&&a.resources)return a.resources},function(a){console.error(a.message||a);return a})},addResource:function(b,c,f,g){var d=a.getStandardPortalUrl(window.portalUrl),h=
this.getPortal(d),n=new FormData;n.append("file",c,f);n.append("fileName",f);n.append("f","json");var k="";g?(n.append("resourcesPrefix",g),k=g+"/"+f):k=f;return h.getItemById(b,!0).then(function(c){c=a.getUserContentItemUrl(d,c.owner,b);return e({url:c+"/addResources",form:n}).then(function(b){var c="";b&&b.success&&(c=a.getItemResourceUrl(d,"${itemId}",k));return c},function(a){console.error(a.message||a);return a})})},removeResources:function(b,c){var f={resource:c?c+"/"+b:b,f:"json"},g=a.getStandardPortalUrl(window.portalUrl);
return this.getPortal(g).getItemById(window.appInfo.id,!0).then(function(b){b=a.getUserContentItemUrl(g,b.owner,window.appInfo.id);return e({url:b+"/removeResources",content:f},{usePost:!0}).then(function(a){return a},function(a){console.error(a.message||a);return a})})}};m.subscribe("userSignOut",function(a){(a=v._findPortal(a))&&a.clearCredentialAndUser()});return v})},"jimu/Role":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/_base/array","dojo/json","esri/lang"],function(r,l,
d,q,k){return r(null,{id:null,baseRole:null,name:null,description:null,privileges:[],privilegeObj:null,constructor:function(d){d=d||{};this.id=d.id;this.baseRole=d.role;this.name=d.name;this.description=d.description},_initPrivilegesObject:function(){this.privilegeObj={portal:{admin:{inviteUsers:!1,disableUsers:!1,viewUsers:!1,updateUsers:!1,deleteUsers:!1,changeUserRoles:!1,viewGroups:!1,updateGroups:!1,deleteGroups:!1,reassignGroups:!1,assignToGroups:!1,manageEnterpriseGroups:!1,viewItems:!1,updateItems:!1,
deleteItems:!1,reassignItems:!1,manageLicenses:!1},publisher:{publishFeatures:!1,publishTiles:!1,publishScenes:!1},user:{createGroup:!1,joinGroup:!1,joinNonOrgGroup:!1,createItem:!1,shareToGroup:!1,shareToOrg:!1,shareToPublic:!1,shareGroupToOrg:!1,shareGroupToPublic:!1}},features:{user:{edit:!1,fullEdit:!1}},opendata:{user:{openDataAdmin:!1,designateGroup:!1}},premium:{user:{geocode:!1,networkanalysis:!1,spatialanalysis:!1,geoenrichment:!1,demographics:!1,elevation:!1}},marketplace:{admin:{manage:!1,
purchase:!1,startTrial:!1}}}},_readPrivileges:function(m){k.isDefined(m)&&m instanceof Array&&d.forEach(m,l.hitch(this,function(d){this._readPrivilege(d)}))},_readPrivilege:function(d){this._applyEffectToAction(!0,d)},_applyEffectToAction:function(d,k){switch(k){case "portal:admin:inviteUsers":this.privilegeObj.portal.admin.inviteUsers=d;break;case "portal:admin:disableUsers":this.privilegeObj.portal.admin.disableUsers=d;break;case "portal:admin:viewUsers":this.privilegeObj.portal.admin.viewUsers=
d;break;case "portal:admin:updateUsers":this.privilegeObj.portal.admin.updateUsers=d;break;case "portal:admin:deleteUsers":this.privilegeObj.portal.admin.deleteUsers=d;break;case "portal:admin:changeUserRoles":this.privilegeObj.portal.admin.changeUserRoles=d;break;case "portal:admin:viewGroups":this.privilegeObj.portal.admin.viewGroups=d;break;case "portal:admin:updateGroups":this.privilegeObj.portal.admin.updateGroups=d;break;case "portal:admin:deleteGroups":this.privilegeObj.portal.admin.deleteGroups=
d;break;case "portal:admin:reassignGroups":this.privilegeObj.portal.admin.reassignGroups=d;break;case "portal:admin:assignToGroups":this.privilegeObj.portal.admin.assignToGroups=d;break;case "portal:admin:manageEnterpriseGroups":this.privilegeObj.portal.admin.manageEnterpriseGroups=d;break;case "portal:admin:viewItems":this.privilegeObj.portal.admin.viewItems=d;break;case "portal:admin:updateItems":this.privilegeObj.portal.admin.updateItems=d;break;case "portal:admin:deleteItems":this.privilegeObj.portal.admin.deleteItems=
d;break;case "portal:admin:reassignItems":this.privilegeObj.portal.admin.reassignItems=d;break;case "portal:admin:manageLicenses":this.privilegeObj.portal.admin.manageLicenses=d;break;case "portal:publisher:publishFeatures":this.privilegeObj.portal.publisher.publishFeatures=d;break;case "portal:publisher:publishTiles":this.privilegeObj.portal.publisher.publishTiles=d;break;case "portal:publisher:publishScenes":this.privilegeObj.portal.publisher.publishScenes=d;break;case "portal:user:createGroup":this.privilegeObj.portal.user.createGroup=
d;break;case "portal:user:joinGroup":this.privilegeObj.portal.user.joinGroup=d;break;case "portal:user:joinNonOrgGroup":this.privilegeObj.portal.user.joinNonOrgGroup=d;break;case "portal:user:createItem":this.privilegeObj.portal.user.createItem=d;break;case "portal:user:shareToGroup":this.privilegeObj.portal.user.shareToGroup=d;break;case "portal:user:shareToOrg":this.privilegeObj.portal.user.shareToOrg=d;break;case "portal:user:shareToPublic":this.privilegeObj.portal.user.shareToPublic=d;break;case "portal:user:shareGroupToOrg":this.privilegeObj.portal.user.shareGroupToOrg=
d;break;case "portal:user:shareGroupToPublic":this.privilegeObj.portal.user.shareGroupToPublic=d;break;case "features:user:edit":this.privilegeObj.features.user.edit=d;break;case "features:user:fullEdit":this.privilegeObj.features.user.fullEdit=d;break;case "opendata:user:openDataAdmin":this.privilegeObj.opendata.user.openDataAdmin=d;break;case "opendata:user:designateGroup":this.privilegeObj.opendata.user.designateGroup=d;break;case "premium:user:geocode":this.privilegeObj.premium.user.geocode=d;
break;case "premium:user:networkanalysis":this.privilegeObj.premium.user.networkanalysis=d;break;case "premium:user:spatialanalysis":this.privilegeObj.premium.user.spatialanalysis=d;break;case "premium:user:geoenrichment":this.privilegeObj.premium.user.geoenrichment=d;break;case "premium:user:demographics":this.privilegeObj.premium.user.demographics=d;break;case "premium:user:elevation":this.privilegeObj.premium.user.elevation=d;break;case "marketplace:admin:purchase":this.privilegeObj.marketplace.admin.purchase=
d;break;case "marketplace:admin:manage":this.privilegeObj.marketplace.admin.manage=d;break;case "marketplace:admin:startTrial":this.privilegeObj.marketplace.admin.startTrial=d}},_applyToAll:function(d){this.privilegeObj.portal.admin.inviteUsers=d;this.privilegeObj.portal.admin.disableUsers=d;this.privilegeObj.portal.admin.viewUsers=d;this.privilegeObj.portal.admin.updateUsers=d;this.privilegeObj.portal.admin.deleteUsers=d;this.privilegeObj.portal.admin.changeUserRoles=d;this.privilegeObj.portal.admin.viewGroups=
d;this.privilegeObj.portal.admin.updateGroups=d;this.privilegeObj.portal.admin.deleteGroups=d;this.privilegeObj.portal.admin.reassignGroups=d;this.privilegeObj.portal.admin.assignToGroups=d;this.privilegeObj.portal.admin.manageEnterpriseGroups=d;this.privilegeObj.portal.admin.viewItems=d;this.privilegeObj.portal.admin.updateItems=d;this.privilegeObj.portal.admin.deleteItems=d;this.privilegeObj.portal.admin.reassignItems=d;this.privilegeObj.portal.admin.manageLicenses=d;this.privilegeObj.portal.publisher.publishFeatures=
d;this.privilegeObj.portal.publisher.publishTiles=d;this.privilegeObj.portal.publisher.publishScenes=d;this.privilegeObj.portal.user.createGroup=d;this.privilegeObj.portal.user.joinGroup=d;this.privilegeObj.portal.user.joinNonOrgGroup=d;this.privilegeObj.portal.user.createItem=d;this.privilegeObj.portal.user.shareToGroup=d;this.privilegeObj.portal.user.shareToOrg=d;this.privilegeObj.portal.user.shareToPublic=d;this.privilegeObj.portal.user.shareGroupToOrg=d;this.privilegeObj.portal.user.shareGroupToPublic=
d;this.privilegeObj.features.user.edit=d;this.privilegeObj.opendata.user.openDataAdmin=d;this.privilegeObj.opendata.user.designateGroup=d;this.privilegeObj.premium.user.geocode=d;this.privilegeObj.premium.user.networkanalysis=d;this.privilegeObj.premium.user.spatialanalysis=d;this.privilegeObj.premium.user.geoenrichment=d;this.privilegeObj.premium.user.demographics=d;this.privilegeObj.premium.user.elevation=d;this.privilegeObj.marketplace.admin.purchase=d;this.privilegeObj.marketplace.admin.manage=
d;this.privilegeObj.marketplace.admin.startTrial=d},_buildPrivilegesArray:function(){var d=[];!0===this.privilegeObj.portal.admin.inviteUsers&&d.push("portal:admin:inviteUsers");!0===this.privilegeObj.portal.admin.disableUsers&&d.push("portal:admin:disableUsers");!0===this.privilegeObj.portal.admin.viewUsers&&d.push("portal:admin:viewUsers");!0===this.privilegeObj.portal.admin.updateUsers&&d.push("portal:admin:updateUsers");!0===this.privilegeObj.portal.admin.deleteUsers&&d.push("portal:admin:deleteUsers");
!0===this.privilegeObj.portal.admin.changeUserRoles&&d.push("portal:admin:changeUserRoles");!0===this.privilegeObj.portal.admin.viewGroups&&d.push("portal:admin:viewGroups");!0===this.privilegeObj.portal.admin.updateGroups&&d.push("portal:admin:updateGroups");!0===this.privilegeObj.portal.admin.deleteGroups&&d.push("portal:admin:deleteGroups");!0===this.privilegeObj.portal.admin.reassignGroups&&d.push("portal:admin:reassignGroups");!0===this.privilegeObj.portal.admin.assignToGroups&&d.push("portal:admin:assignToGroups");
!0===this.privilegeObj.portal.admin.manageEnterpriseGroups&&d.push("portal:admin:manageEnterpriseGroups");!0===this.privilegeObj.portal.admin.viewItems&&d.push("portal:admin:viewItems");!0===this.privilegeObj.portal.admin.updateItems&&d.push("portal:admin:updateItems");!0===this.privilegeObj.portal.admin.deleteItems&&d.push("portal:admin:deleteItems");!0===this.privilegeObj.portal.admin.reassignItems&&d.push("portal:admin:reassignItems");!0===this.privilegeObj.portal.admin.manageLicenses&&d.push("portal:admin:manageLicenses");
!0===this.privilegeObj.portal.publisher.publishFeatures&&d.push("portal:publisher:publishFeatures");!0===this.privilegeObj.portal.publisher.publishTiles&&d.push("portal:publisher:publishTiles");!0===this.privilegeObj.portal.publisher.publishScenes&&d.push("portal:publisher:publishScenes");!0===this.privilegeObj.portal.user.createGroup&&d.push("portal:user:createGroup");!0===this.privilegeObj.portal.user.joinGroup&&d.push("portal:user:joinGroup");!0===this.privilegeObj.portal.user.joinNonOrgGroup&&
d.push("portal:user:joinNonOrgGroup");!0===this.privilegeObj.portal.user.createItem&&d.push("portal:user:createItem");!0===this.privilegeObj.portal.user.shareToGroup&&d.push("portal:user:shareToGroup");!0===this.privilegeObj.portal.user.shareToOrg&&d.push("portal:user:shareToOrg");!0===this.privilegeObj.portal.user.shareToPublic&&d.push("portal:user:shareToPublic");!0===this.privilegeObj.portal.user.shareGroupToOrg&&d.push("portal:user:shareGroupToOrg");!0===this.privilegeObj.portal.user.shareGroupToPublic&&
d.push("portal:user:shareGroupToPublic");!0===this.privilegeObj.features.user.edit&&d.push("features:user:edit");!0===this.privilegeObj.features.user.fullEdit&&d.push("features:user:fullEdit");!0===this.privilegeObj.opendata.user.openDataAdmin&&d.push("opendata:user:openDataAdmin");!0===this.privilegeObj.opendata.user.designateGroup&&d.push("opendata:user:designateGroup");!0===this.privilegeObj.premium.user.geocode&&d.push("premium:user:geocode");!0===this.privilegeObj.premium.user.networkanalysis&&
d.push("premium:user:networkanalysis");!0===this.privilegeObj.premium.user.spatialanalysis&&d.push("premium:user:spatialanalysis");!0===this.privilegeObj.premium.user.geoenrichment&&d.push("premium:user:geoenrichment");!0===this.privilegeObj.premium.user.demographics&&d.push("premium:user:demographics");!0===this.privilegeObj.premium.user.elevation&&d.push("premium:user:elevation");!0===this.privilegeObj.marketplace.admin.purchase&&d.push("marketplace:admin:purchase");!0===this.privilegeObj.marketplace.admin.manage&&
d.push("marketplace:admin:manage");!0===this.privilegeObj.marketplace.admin.startTrial&&d.push("marketplace:admin:startTrial");return d},isUser:function(){return k.isDefined(this.id)&&("org_user"===this.id||"account_user"===this.id)},isPublisher:function(){return k.isDefined(this.id)&&("org_publisher"===this.id||"account_publisher"===this.id)},isAdmin:function(){return k.isDefined(this.id)&&("org_admin"===this.id||"account_admin"===this.id)},isBasedOnUser:function(){return this.isUser()||k.isDefined(this.baseRole)&&
("org_user"===this.baseRole||"account_user"===this.baseRole)},isBasedOnPublisher:function(){return this.isPublisher()||k.isDefined(this.baseRole)&&("org_publisher"===this.baseRole||"account_publisher"===this.baseRole)},isBasedOnAdmin:function(){return this.isAdmin()||k.isDefined(this.baseRole)&&("org_admin"===this.baseRole||"account_admin"===this.baseRole)},isCustom:function(){return!this.isUser()&&!this.isPublisher()&&!this.isAdmin()&&k.isDefined(this.id)&&0<this.id.length},canInviteUsers:function(){return this.privilegeObj&&
this.privilegeObj.portal.admin.inviteUsers},canDisableUsers:function(){return this.privilegeObj&&this.privilegeObj.portal.admin.disableUsers},canViewUsers:function(){return this.privilegeObj&&this.privilegeObj.portal.admin.viewUsers},canUpdateUsers:function(){return this.privilegeObj&&this.privilegeObj.portal.admin.updateUsers},canDeleteUsers:function(){return this.privilegeObj&&this.privilegeObj.portal.admin.deleteUsers},canChangeUserRoles:function(){return this.privilegeObj&&this.privilegeObj.portal.admin.changeUserRoles},
canViewOrgGroups:function(){return this.privilegeObj&&this.privilegeObj.portal.admin.viewGroups},canUpdateOrgGroups:function(){return this.privilegeObj&&this.privilegeObj.portal.admin.updateGroups},canDeleteOrgGroups:function(){return this.privilegeObj&&this.privilegeObj.portal.admin.deleteGroups},canReassignOrgGroups:function(){return this.privilegeObj&&this.privilegeObj.portal.admin.reassignGroups},canAssignUsersToOrgGroups:function(){return this.privilegeObj&&this.privilegeObj.portal.admin.assignToGroups},
canManageEnterpriseGroups:function(){return this.privilegeObj&&this.privilegeObj.portal.admin.manageEnterpriseGroups},canViewOrgItems:function(){return this.privilegeObj&&this.privilegeObj.portal.admin.viewItems},canUpdateOrgItems:function(){return this.privilegeObj&&this.privilegeObj.portal.admin.updateItems},canDeleteOrgItems:function(){return this.privilegeObj&&this.privilegeObj.portal.admin.deleteItems},canReassignOrgItems:function(){return this.privilegeObj&&this.privilegeObj.portal.admin.reassignItems},
canManageLicenses:function(){return this.privilegeObj&&this.privilegeObj.portal.admin.manageLicenses},canCreateGroup:function(){return this.privilegeObj&&this.privilegeObj.portal.user.createGroup},canJoinOrgGroup:function(){return this.privilegeObj&&this.privilegeObj.portal.user.joinGroup},canJoinNonOrgGroup:function(){return this.privilegeObj&&this.privilegeObj.portal.user.joinNonOrgGroup},canPublishFeatures:function(){return this.privilegeObj&&this.privilegeObj.portal.publisher.publishFeatures},
canPublishTiles:function(){return this.privilegeObj&&this.privilegeObj.portal.publisher.publishTiles},canPublishScenes:function(){return this.privilegeObj&&this.privilegeObj.portal.publisher.publishScenes},canCreateItem:function(){return this.privilegeObj&&this.privilegeObj.portal.user.createItem},canShareItemToGroup:function(){return this.privilegeObj&&this.privilegeObj.portal.user.shareToGroup},canShareItemToOrg:function(){return this.privilegeObj&&this.privilegeObj.portal.user.shareToOrg},canShareItemToPublic:function(){return this.privilegeObj&&
this.privilegeObj.portal.user.shareToPublic},canShareGroupToOrg:function(){return this.privilegeObj&&this.privilegeObj.portal.user.shareGroupToOrg},canShareGroupToPublic:function(){return this.privilegeObj&&this.privilegeObj.portal.user.shareGroupToPublic},canEditFeatures:function(){return this.privilegeObj&&this.privilegeObj.features.user.edit},canEditFeaturesFullControl:function(){return this.privilegeObj&&this.privilegeObj.features.user.fullEdit},canManageOpenData:function(){return this.privilegeObj&&
this.privilegeObj.opendata.user.openDataAdmin},canDesignateOpenDataGroups:function(){return this.privilegeObj&&this.privilegeObj.opendata.user.designateGroup},canUseGeocode:function(){return this.privilegeObj&&this.privilegeObj.premium.user.geocode},canUseNetworkAnalysis:function(){return this.privilegeObj&&this.privilegeObj.premium.user.networkanalysis},canUseSpatialAnalysis:function(){return this.privilegeObj&&this.privilegeObj.premium.user.spatialanalysis},canUseGeoenrichment:function(){return this.privilegeObj&&
this.privilegeObj.premium.user.geoenrichment},canUseDemographics:function(){return this.privilegeObj&&this.privilegeObj.premium.user.demographics},canUseElevation:function(){return this.privilegeObj&&this.privilegeObj.premium.user.elevation},canPurchaseMarketplace:function(){return this.privilegeObj&&this.privilegeObj.marketplace.admin.purchase},canManageMarketplace:function(){return this.privilegeObj&&this.privilegeObj.marketplace.admin.manage},canTrialMarketplace:function(){return this.privilegeObj&&
this.privilegeObj.marketplace.admin.startTrial},setPrivileges:function(d){this.privileges=d;this._initPrivilegesObject();k.isDefined(d)&&this._readPrivileges(d)},stringify:function(){return q.stringify({id:this.id,name:this.name,description:this.description,privileges:this._buildPrivilegesArray()})},stringifyRole:function(){return q.stringify({id:this.id,name:this.name,description:this.description})},stringifyPrivileges:function(){return q.stringify({privileges:this._buildPrivilegesArray()})},stringifyPretty:function(){return q.stringify({id:this.id,
name:this.name,description:this.description,privileges:this._buildPrivilegesArray()},null,"  ")}})})},"jimu/tokenUtils":function(){define("dojo/_base/lang dojo/_base/array dojo/aspect dojo/Deferred dojo/cookie dojo/json dojo/topic dojo/request/script esri/kernel esri/config esri/request esri/urlUtils esri/IdentityManager esri/arcgis/OAuthInfo jimu/portalUrlUtils jimu/utils".split(" "),function(r,l,d,q,k,m,p,h,e,c,b,a,g,u,n,t){"function"!==typeof k.getAll&&(k.getAll=function(a){var b=[];(a=k(a))&&
b.push(a);return b});g={portalUrl:null,cookiePath:"/",_started:!1,webTierPortalUrls:[],isInBuilderWindow:function(){return!!window.isBuilder},isInConfigOrPreviewWindow:function(){return t.isInConfigOrPreviewWindow()},isStringStartWith:function(a,b){return a.substr(0,b.length)===b},getCookiePath:function(){return this.cookiePath},setPortalUrl:function(a){(a=n.getStandardPortalUrl(a))&&(a+="/");this.portalUrl=a},getPortalUrl:function(){return this.portalUrl},isWebTierPortal:function(b){var f=new q,
g=n.getStandardPortalUrl(b);b=g+"/sharing";var d=n.setHttpsProtocol(g+"/sharing/generateToken?f\x3djson"),k=n.setHttpsProtocol(b);h.get(d,{jsonp:"callback"}).then(r.hitch(this,function(b){b.token?(this.webTierPortalUrls.push(g),this.removeWabAuthCookie(),e.id.getCredential(k).then(r.hitch(this,function(e){function k(a){var b=a.creationTime||(new Date).getTime(),c=a.expires;0<b&&0<c&&c>b&&setTimeout(function(){h.get(d,{jsonp:"callback"}).then(function(b){b.token&&(a.token=b.token,a.expires=b.expires,
a.creationTime=(new Date).getTime(),a.refreshServerTokens(),k(a))},function(a){console.error(a)})},.8*(c-b))}e.token||(e.token=b.token);e.expires||(e.expires=b.expires);var t=a.canUseXhr(e.server,!0);-1<t&&c.defaults.io.corsEnabledServers.splice(t,1);this._pushCorsEnabledServerInfo({host:n.getServerByUrl(g),withCredentials:!0});f.resolve(!0);k(e)}),r.hitch(this,function(){f.resolve(!0)}))):f.resolve(!1)}),r.hitch(this,function(a){console.error(a);f.reject(a)}));return f},addAuthorizedCrossOriginDomains:function(a){if(a&&
0<a.length)for(var b=0;b<a.length;b++)this.addWithCredentialDomain(a[b])},addWithCredentialDomain:function(b){if(b&&"string"===typeof b){var f=c.defaults.io.corsEnabledServers,g=n.getServerByUrl(b);(b=n.getServerWithProtocol(b))||(b="http://"+g);b=a.canUseXhr(b,!0);-1<b&&f.splice(b,1);this._pushCorsEnabledServerInfo({host:g,withCredentials:!0})}},_pushCorsEnabledServerInfo:function(a){if(a){var b=c.defaults.io.corsEnabledServers,f="charAt charCodeAt concat endsWith indexOf lastIndexOf localeCompare match replace search slice split startsWith substr substring toLocaleLowerCase toLocaleUpperCase toLowerCase toString toUpperCase trim trimLeft trimRight valueOf".split(" ");
if("object"===typeof a&&"string"===typeof a.host){for(var g in a.host)a[g]="function"===typeof a.host[g]?function(){return a.host[g].apply(a.host,arguments)}:a.host[g];a.length=a.host.length;l.forEach(f,function(b){"function"===typeof a.host[b]&&(a[b]=function(){return a.host[b].apply(a.host,arguments)})})}b.push(a)}},tryRegisterCredential:function(a){return this.isValidCredential(a)?l.some(e.id.credentials,r.hitch(this,function(b){return a.token===b.token}))?!1:(e.id.credentials.push(a),!0):!1},
registerToken:function(a){var b=n.getSharingUrl(this.portalUrl);e.id.findCredential(b)&&l.some(e.id.credentials,r.hitch(this,function(a,b){if(this.isValidPortalCredentialOfPortalUrl(this.portalUrl,a))return e.id.credentials.splice(b,1),!0}));return this._getTokenInfo(a).then(function(a){a&&e.id.registerToken(a)})},_getTokenInfo:function(a){var b=n.getPortalSelfInfoUrl(this.portalUrl);return h.get(b+("?f\x3djson\x26token\x3d"+a),{jsonp:"callback"}).then(r.hitch(this,function(b){return b.user?{server:n.getSharingUrl(this.portalUrl),
ssl:b.allSSL,token:a,userId:b.user.username}:null}),function(a){console.error(a);throw Error(window.jimuNls.urlParams.validateTokenError);})},_isInvalidPortalUrl:function(a){return a&&"string"===typeof a&&r.trim(a)},signInPortal:function(a){var b=new q;if(this._isInvalidPortalUrl(a)){a=n.getStandardPortalUrl(a);var c=n.getSharingUrl(a),f=this.getPortalCredential(a);f?setTimeout(r.hitch(this,function(){b.resolve(f)}),0):b=e.id.getCredential(c)}else setTimeout(r.hitch(this,function(){b.reject("Invalid portalurl.")}),
0);return b},_loadPortalSelfInfo:function(a){a=n.getPortalSelfInfoUrl(a);return b({url:a,handleAs:"json",content:{f:"json"},callbackParamName:"callback"})},registerOAuthInfo:function(a,b){if(!a||"string"!==typeof a||!b||"string"!==typeof b)return null;var c=e.id.findOAuthInfo(a);c||(c=window.location.protocol+"//"+window.location.host+require.toUrl("jimu")+"/oauth-callback.html",c=new u({appId:b,expiration:20159,portalUrl:a,authNamespace:"/",popup:!0,popupCallbackUrl:c}),e.id.registerOAuthInfos([c]));
c.appId=b;return c},signOutAll:function(){var a=n.getStandardPortalUrl(this.portalUrl),b=!!e.id.findCredential(a+"/sharing/rest");window.appInfo.isRunInPortal?this.removeEsriAuthCookieStorage():this.removeWabAuthCookie();e.id.destroyCredentials();e.id._oAuthHash=null;b&&this._publishCurrentPortalUserSignOut(a)},userHaveSignInPortal:function(a){return!!this.getPortalCredential(r.trim(a||""))},isValidCredential:function(a){var b=!1;if(a){var b=a.token,c=a.server,f=a.scope,b=b&&"string"===typeof b&&
r.trim(b),c=c&&"string"===typeof c&&r.trim(c),f="portal"===f||"server"===f,g=!0;a.expires&&(a=parseInt(a.expires,10),g=(new Date).getTime(),g=a>g);b=b&&c&&f&&g}return b},isValidPortalCredentialOfPortalUrl:function(a,b){var c=!1;if(this.isValidCredential(b))var c="portal"===b.scope,f=n.isSameServer(a,b.server),c=c&&f;return c},getPortalCredential:function(a){var b=null;a=r.trim(a||"");if(!a)return null;a=n.getStandardPortalUrl(a);(b=this._filterPortalCredential(a,e.id.credentials))||this._tryConvertArcGIScomCrendentialToOrgCredential();
return b},_tryConvertArcGIScomCrendentialToOrgCredential:function(){var a=this.portalUrl;if(a&&(a=n.getStandardPortalUrl(a),n.isOrgOnline(a)&&!this._filterPortalCredential(a,e.id.credentials))){var b=this._filterPortalCredential("http://www.arcgis.com",e.id.credentials);b&&e.id.registerToken({token:b.token,scope:"portal",userId:b.userId,server:a+"/sharing/rest",expires:b.expires})}},saveAndRegisterCookieToCredential:function(a){a=r.clone(a);a.referer=window.location.host;a.scope="portal";a.isAdmin=
!!a.isAdmin;this.saveWabCookie(a);var b=a.server+"/sharing/rest";a.server=b;e.id.registerToken(a);return e.id.findCredential(b,a.userId)},registerAuth2Hash:function(a){a=r.clone(a);var b=1E3*parseInt(a.expires_in,10),b=(new Date).getTime()+b,c=n.getStandardPortalUrl(a.state.portalUrl);return this.saveAndRegisterCookieToCredential({referer:window.location.host,server:c,token:a.access_token,expires:b,userId:a.username,scope:"portal",isAdmin:!!a.isAdmin})},saveWabCookie:function(a){this.removeCookie("wab_auth");
k("wab_auth",m.stringify(a),{expires:new Date(a.expires),path:"/"})},removeWabAuthCookie:function(){this.removeCookie("wab_auth")},removeEsriAuthCookieStorage:function(){this.removeCookie("esri_auth");window.localStorage&&window.localStorage.removeItem("esriJSAPIOAuth");window.sessionStorage&&window.sessionStorage.removeItem("esriJSAPIOAuth")},_filterPortalCredential:function(a,b){var c=null;a=n.getStandardPortalUrl(a);if(b&&0<b.length){var f=l.filter(b,r.hitch(this,function(b){return this.isValidPortalCredentialOfPortalUrl(a,
b)}));0<f.length&&(c=f[f.length-1])}return c},_removePortalCredential:function(a){var b=r.trim(a||"");if(b){b=n.getStandardPortalUrl(b);for(a=l.filter(e.id.credentials,r.hitch(this,function(a){return this.isValidPortalCredentialOfPortalUrl(b,a)}));0<a.length;)a[0].destroy(),a.splice(0,1);e.id.credentials=l.filter(e.id.credentials,r.hitch(this,function(a){return!this.isValidPortalCredentialOfPortalUrl(b,a)}))}},getUserIdByToken:function(a,c){var f=new q;if(a&&"string"===typeof a&&c&&"string"===typeof c){var g=
n.getStandardPortalUrl(c),d=l.filter(e.id.credentials,r.hitch(this,function(b){var c=b.token===a&&b.userId;b=n.isSameServer(g,b.server);return c&&b}));if(0<d.length){var h=d[0];setTimeout(r.hitch(this,function(){f.resolve(h.userId)}),0);return f}d=n.getCommunitySelfUrl(g);b({url:d,handleAs:"json",content:{f:"json"},callbackParamName:"callback"}).then(r.hitch(this,function(a){f.resolve(a&&a.username||"")}),r.hitch(this,function(a){console.error(a);f.reject("fail to get userId by token")}))}else setTimeout(r.hitch(this,
function(){f.reject("invalid parameters")}),0);return f},xtGetCredentialFromCookie:function(a){var b=k("wab_auth"),c=null;if(b)try{c=m.parse(b)}catch(w){console.error(w)}if(!c||"object"!==typeof c||!n.isSameServer(a,c.server)||window.location.host!==c.referer)return null;c.expires=parseInt(c.expires,10);b=(new Date).getTime();if(!(c.expires>b))return this.removeCookie("wab_auth"),null;a+="/sharing/rest";c.server=a;(b=e.id.findCredential(a))||e.id.registerToken(c);return b=e.id.findCredential(a)},
removeCookie:function(a){var b=this.getCookiePath();t.removeCookie(a,b)},_getDomainsByServerName:function(a){var b=a.split("."),c=b.length;return l.map(b,r.hitch(this,function(a,f){var g=b.slice(f,c),e="",d=g.length-1;l.forEach(g,r.hitch(this,function(a,b){e+=a;b!==d&&(e+=".")}));return e}))},_publishCurrentPortalUserSignIn:function(a){if(this.isValidCredential(a))try{p.publish("userSignIn",a)}catch(v){console.error(v)}},_publishAnyUserSignIn:function(a){if(this.isValidCredential(a))try{p.publish("anyUserSignIn",
a)}catch(v){console.error(v)}},_publishCurrentPortalUserSignOut:function(a){try{p.publish("userSignOut",a)}catch(v){console.error(v)}},_signInSuccess:function(a){try{this.isValidPortalCredentialOfPortalUrl(this.portalUrl,a)&&this._publishCurrentPortalUserSignIn(a),this._publishAnyUserSignIn(a)}catch(v){console.error(v)}},_bindEvents:function(){d.after(e.id,"signIn",r.hitch(this,function(a,b){console.log(b[1]);d.after(a,"callback",r.hitch(this,function(a,b){this._signInSuccess(b[0],!1)}));return a}))},
isStart:function(){return this._started},startup:function(){if(!this._started){if(this.isInConfigOrPreviewWindow()){var a=window.parent;if(a){var b=a.esri&&a.esri.id;b&&(e.id=b,b=window.esriConfig.defaults.io,a=a.esriConfig.defaults.io,b.corsEnabledServers=a.corsEnabledServers,b.webTierAuthServers=a.webTierAuthServers,b._processedCorsServers=a._processedCorsServers,b.corsStatus=a.corsStatus)}}this._bindEvents();this._started=!0}}};g.startup();return g})},"esri/IdentityManager":function(){define(["./IdentityManagerDialog",
"./kernel","./OAuthSignInHandler","dojo/_base/declare"],function(r,l,d,q){r=new r;l.id=q.safeMixin(r,d);return l.id})},"esri/IdentityManagerDialog":function(){define("dojo/_base/kernel dojo/_base/declare dojo/_base/config dojo/_base/Deferred dojo/_base/lang dojo/has dojo/dom-attr dojo/keys dijit/registry dijit/Dialog ./kernel ./lang ./domUtils ./Credential ./IdentityManagerBase dojo/i18n!./nls/jsapi dojo/query dijit/form/Button dijit/form/Form dijit/form/ValidationTextBox".split(" "),function(r,l,
d,q,k,m,p,h,e,c,b,a,g,u,n,t){return l([n],{declaredClass:"esri.IdentityManager",_eventMap:{"dialog-cancel":["info"]},constructor:function(a){k.mixin(this,a);this.registerConnectEvents()},_dialogContent:"\x3cdiv data-dojo-type\x3d'dijit.form.Form' data-dojo-props\x3d'\"class\":\"esriIdForm\"'\x3e\x3cdiv class\x3d'dijitDialogPaneContentArea'\x3e\x3cdiv style\x3d'padding-bottom: 5px; word-wrap: break-word;'\x3e${info}\x3c/div\x3e\x3cdiv style\x3d'margin: 0px; padding: 0px; height: 10px;'\x3e\x3c/div\x3e\x3cdiv class\x3d'esriErrorMsg' style\x3d'display: none; color: white; background-color: #D46464; text-align: center; padding-top: 3px; padding-bottom: 3px;'\x3e${invalidUser}\x3c/div\x3e\x3cdiv style\x3d'margin: 0px; padding: 0px; height: 10px;'\x3e\x3c/div\x3e\x3ctable style\x3d'width: 100%;'\x3e\x3ctr\x3e\x3ctd\x3e\x3clabel\x3e${lblUser}\x3c/label\x3e\x3cbr/\x3e\x3cinput data-dojo-type\x3d'dijit.form.ValidationTextBox' data-dojo-props\x3d'type:\"text\", \"class\":\"esriIdUser\", required:true, trim:true, style:\"width: 100%;\", autocapitalize:\"none\", autocorrect:\"off\", spellcheck:false' /\x3e\x3c/td\x3e\x3c/tr\x3e\x3ctr\x3e\x3ctd\x3e\x3clabel\x3e${lblPwd}\x3c/label\x3e\x3cbr/\x3e\x3cinput data-dojo-type\x3d'dijit.form.ValidationTextBox' data-dojo-props\x3d'type:\"password\", \"class\":\"esriIdPwd\", required:true, style:\"width: 100%;\"' /\x3e\x3c/td\x3e\x3c/tr\x3e\x3c/table\x3e\x3c/div\x3e\x3cdiv class\x3d'dijitDialogPaneActionBar'\x3e\x3cbutton data-dojo-type\x3d'dijit.form.Button' data-dojo-props\x3d'type:\"button\", \"class\":\"esriIdSubmit\"'\x3e${lblOk}\x3c/button\x3e\x3cbutton data-dojo-type\x3d'dijit.form.Button' data-dojo-props\x3d'type:\"button\", \"class\":\"esriIdCancel\"'\x3e${lblCancel}\x3c/button\x3e\x3c/div\x3e\x3c/div\x3e",
onDialogCreate:function(){},onDialogCancel:function(){},signIn:function(a,b,c){this._nls||(this._nls=t.identity);this._loginDialog||(this._loginDialog=this.dialog=this._createLoginDialog(),this.onDialogCreate());var f=this._loginDialog,e=c&&c.error,h=c&&c.token,n=new q(function(){f.onCancel()});if(f.open)return a=Error("BUSY"),a.code="IdentityManager.1",a.log=!!d.isDebug,n.errback(a),n;g.hide(f.errMsg_);e&&403==e.code&&h&&(p.set(f.errMsg_,"innerHTML",this._nls.forbidden),g.show(f.errMsg_));f.dfd_=
n;f.serverInfo_=b;f.resUrl_=a;f.admin_=c&&c.isAdmin;p.set(f.resLink_,{title:a,innerHTML:"("+(this.getResourceName(a)||this._nls.lblItem)+")"});p.set(f.serverLink_,{title:b.server,innerHTML:(-1!==b.server.toLowerCase().indexOf("arcgis.com")?"ArcGIS Online":b.server)+" "});f.txtPwd_.set("value","");f.show();return n},_createLoginDialog:function(){var f=this._nls,n=a.substitute(f,this._dialogContent),n=a.substitute({resource:"\x3cspan class\x3d'resLink' style\x3d'word-wrap: break-word;'\x3e\x3c/span\x3e",
server:"\x3cspan class\x3d'serverLink' style\x3d'word-wrap: break-word;'\x3e\x3c/span\x3e"},n),k=new c({title:f.title,content:n,"class":"esriSignInDialog",style:"width: 18em;",esriIdMgr_:this,keypressed_:function(a){a.charOrCode===h.ENTER&&this.execute_()},execute_:function(){var e=this.txtUser_.get("value"),d=this.txtPwd_.get("value"),h=this.dfd_,n=this;if(this.form_.validate()&&e&&d){this.btnSubmit_.set("label",f.lblSigning);var k=b.id.findCredential(n.resUrl_,e),t=function(b){n.btnSubmit_.set("label",
f.lblOk);n.btnSubmit_.set("disabled",!1);g.hide(n.errMsg_);n.hide();c._DialogLevelManager.hide(n);var d=n.serverInfo_;n.dfd_=n.serverInfo_=n.generateDfd_=n.resUrl_=null;var t,l,m=k,p;b&&(t=b.token,l=a.isDefined(b.expires)?Number(b.expires):null,p=!!b.ssl,m?(m.userId=e,m.token=t,m.expires=l,m.validity=b.validity,m.ssl=p,m.creationTime=(new Date).getTime()):m=new u({userId:e,server:d.server,token:t,expires:l,ssl:p,isAdmin:n.admin_,validity:b.validity}));h.callback(m)};k&&!k._enqueued?t():(n.btnSubmit_.set("disabled",
!0),n.generateDfd_=b.id.generateToken(this.serverInfo_,{username:e,password:d},{isAdmin:this.admin_}).addCallback(t).addErrback(function(a){n.btnSubmit_.set("disabled",!1);n.generateDfd_=null;n.btnSubmit_.set("label",f.lblOk);p.set(n.errMsg_,"innerHTML",a&&a.code?f.invalidUser:f.noAuthService);g.show(n.errMsg_)}))}},cancel_:function(){k.generateDfd_&&k.generateDfd_.cancel();var a=k.dfd_,b=k.resUrl_,f=k.serverInfo_;k.btnSubmit_.set("disabled",!1);k.dfd_=k.serverInfo_=k.generateDfd_=k.resUrl_=null;
g.hide(k.errMsg_);c._DialogLevelManager.hide(k);k.esriIdMgr_.onDialogCancel({resourceUrl:b,serverInfo:f});b=Error("ABORTED");b.code="IdentityManager.2";b.log=!!d.isDebug;a.errback(b)}}),n=k.domNode;k.form_=e.byNode(r.query(".esriIdForm",n)[0]);k.txtUser_=e.byNode(r.query(".esriIdUser",n)[0]);k.txtPwd_=e.byNode(r.query(".esriIdPwd",n)[0]);k.btnSubmit_=e.byNode(r.query(".esriIdSubmit",n)[0]);k.btnCancel_=e.byNode(r.query(".esriIdCancel",n)[0]);k.resLink_=r.query(".resLink",n)[0];k.serverLink_=r.query(".serverLink",
n)[0];k.errMsg_=r.query(".esriErrorMsg",n)[0];k.connect(k.txtUser_,"onKeyPress",k.keypressed_);k.connect(k.txtPwd_,"onKeyPress",k.keypressed_);k.connect(k.btnSubmit_,"onClick",k.execute_);k.connect(k.btnCancel_,"onClick",k.onCancel);k.connect(k,"onCancel",k.cancel_);return k}})})},"dijit/Dialog":function(){define("require dojo/_base/array dojo/aspect dojo/_base/declare dojo/Deferred dojo/dom dojo/dom-class dojo/dom-geometry dojo/dom-style dojo/_base/fx dojo/i18n dojo/keys dojo/_base/lang dojo/on dojo/ready dojo/sniff dojo/touch dojo/window dojo/dnd/Moveable dojo/dnd/TimedMoveable ./focus ./_base/manager ./_Widget ./_TemplatedMixin ./_CssStateMixin ./form/_FormMixin ./_DialogMixin ./DialogUnderlay ./layout/ContentPane ./layout/utils dojo/text!./templates/Dialog.html ./a11yclick dojo/i18n!./nls/common".split(" "),
function(r,l,d,q,k,m,p,h,e,c,b,a,g,u,n,t,f,v,x,w,z,A,y,B,C,E,D,F,G,J,N){function M(){}var L=new k;L.resolve(!0);A=q("dijit._DialogBase"+(t("dojo-bidi")?"_NoBidi":""),[B,E,D,C],{templateString:N,baseClass:"dijitDialog",cssStateNodes:{closeButtonNode:"dijitDialogCloseIcon"},_setTitleAttr:{node:"titleNode",type:"innerHTML"},open:!1,duration:A.defaultDuration,refocus:!0,autofocus:!0,_firstFocusItem:null,_lastFocusItem:null,draggable:!0,_setDraggableAttr:function(a){this._set("draggable",a)},maxRatio:.9,
closable:!0,_setClosableAttr:function(a){this.closeButtonNode.style.display=a?"":"none";this._set("closable",a)},postMixInProperties:function(){var a=b.getLocalization("dijit","common");g.mixin(this,a);this.inherited(arguments)},postCreate:function(){e.set(this.domNode,{display:"none",position:"absolute"});this.ownerDocumentBody.appendChild(this.domNode);this.inherited(arguments);d.after(this,"onExecute",g.hitch(this,"hide"),!0);d.after(this,"onCancel",g.hitch(this,"hide"),!0);u(this.closeButtonNode,
f.press,function(a){a.stopPropagation()});this._modalconnects=[]},onLoad:function(){this.resize();this._position();this.autofocus&&W.isTop(this)&&(this._getFocusItems(),z.focus(this._firstFocusItem));this.inherited(arguments)},focus:function(){this._getFocusItems();z.focus(this._firstFocusItem)},_endDrag:function(){var a=h.position(this.domNode),b=v.getBox(this.ownerDocument);a.y=Math.min(Math.max(a.y,0),b.h-a.h);a.x=Math.min(Math.max(a.x,0),b.w-a.w);this._relativePosition=a;this._position()},_setup:function(){var a=
this.domNode;this.titleBar&&this.draggable?(this._moveable=new (6==t("ie")?w:x)(a,{handle:this.titleBar}),d.after(this._moveable,"onMoveStop",g.hitch(this,"_endDrag"),!0)):p.add(a,"dijitDialogFixed");this.underlayAttrs={dialogId:this.id,"class":l.map(this["class"].split(/\s/),function(a){return a+"_underlay"}).join(" "),_onKeyDown:g.hitch(this,"_onKey"),ownerDocument:this.ownerDocument}},_size:function(){this.resize()},_position:function(){if(!p.contains(this.ownerDocumentBody,"dojoMove")){var a=
this.domNode,b=v.getBox(this.ownerDocument),c=this._relativePosition,f=h.position(a);e.set(a,{left:Math.floor(b.l+(c?Math.min(c.x,b.w-f.w):(b.w-f.w)/2))+"px",top:Math.floor(b.t+(c?Math.min(c.y,b.h-f.h):(b.h-f.h)/2))+"px"})}},_onKey:function(b){if(b.keyCode==a.TAB){this._getFocusItems();var c=b.target;this._firstFocusItem==this._lastFocusItem?(b.stopPropagation(),b.preventDefault()):c==this._firstFocusItem&&b.shiftKey?(z.focus(this._lastFocusItem),b.stopPropagation(),b.preventDefault()):c!=this._lastFocusItem||
b.shiftKey||(z.focus(this._firstFocusItem),b.stopPropagation(),b.preventDefault())}else this.closable&&b.keyCode==a.ESCAPE&&(this.onCancel(),b.stopPropagation(),b.preventDefault())},show:function(){if(this.open)return L.promise;this._started||this.startup();this._alreadyInitialized||(this._setup(),this._alreadyInitialized=!0);this._fadeOutDeferred&&(this._fadeOutDeferred.cancel(),W.hide(this));var a=v.get(this.ownerDocument);this._modalconnects.push(u(a,"scroll",g.hitch(this,"resize",null)));this._modalconnects.push(u(this.domNode,
"keydown",g.hitch(this,"_onKey")));e.set(this.domNode,{opacity:0,display:""});this._set("open",!0);this._onShow();this.resize();this._position();var b;this._fadeInDeferred=new k(g.hitch(this,function(){b.stop();delete this._fadeInDeferred}));this._fadeInDeferred.then(void 0,M);a=this._fadeInDeferred.promise;b=c.fadeIn({node:this.domNode,duration:this.duration,beforeBegin:g.hitch(this,function(){W.show(this,this.underlayAttrs)}),onEnd:g.hitch(this,function(){this.autofocus&&W.isTop(this)&&(this._getFocusItems(),
z.focus(this._firstFocusItem));this._fadeInDeferred.resolve(!0);delete this._fadeInDeferred})}).play();return a},hide:function(){if(!this._alreadyInitialized||!this.open)return L.promise;this._fadeInDeferred&&this._fadeInDeferred.cancel();var a;this._fadeOutDeferred=new k(g.hitch(this,function(){a.stop();delete this._fadeOutDeferred}));this._fadeOutDeferred.then(void 0,M);this._fadeOutDeferred.then(g.hitch(this,"onHide"));var b=this._fadeOutDeferred.promise;a=c.fadeOut({node:this.domNode,duration:this.duration,
onEnd:g.hitch(this,function(){this.domNode.style.display="none";W.hide(this);this._fadeOutDeferred.resolve(!0);delete this._fadeOutDeferred})}).play();this._scrollConnected&&(this._scrollConnected=!1);for(var f;f=this._modalconnects.pop();)f.remove();this._relativePosition&&delete this._relativePosition;this._set("open",!1);return b},resize:function(a){if("none"!=this.domNode.style.display){this._checkIfSingleChild();if(!a){this._shrunk&&(this._singleChild&&"undefined"!=typeof this._singleChildOriginalStyle&&
(this._singleChild.domNode.style.cssText=this._singleChildOriginalStyle,delete this._singleChildOriginalStyle),l.forEach([this.domNode,this.containerNode,this.titleBar,this.actionBarNode],function(a){a&&e.set(a,{position:"static",width:"auto",height:"auto"})}),this.domNode.style.position="absolute");var b=v.getBox(this.ownerDocument);b.w*=this.maxRatio;b.h*=this.maxRatio;var c=h.position(this.domNode);c.w>=b.w||c.h>=b.h?(a={w:Math.min(c.w,b.w),h:Math.min(c.h,b.h)},this._shrunk=!0):this._shrunk=!1}if(a){h.setMarginBox(this.domNode,
a);b=[];this.titleBar&&b.push({domNode:this.titleBar,region:"top"});this.actionBarNode&&b.push({domNode:this.actionBarNode,region:"bottom"});c={domNode:this.containerNode,region:"center"};b.push(c);var f=J.marginBox2contentBox(this.domNode,a);J.layoutChildren(this.domNode,f,b);this._singleChild?(b=J.marginBox2contentBox(this.containerNode,c),this._singleChild.resize({w:b.w,h:b.h})):(this.containerNode.style.overflow="auto",this._layoutChildren())}else this._layoutChildren();t("touch")||a||this._position()}},
_layoutChildren:function(){l.forEach(this.getChildren(),function(a){a.resize&&a.resize()})},destroy:function(){this._fadeInDeferred&&this._fadeInDeferred.cancel();this._fadeOutDeferred&&this._fadeOutDeferred.cancel();this._moveable&&this._moveable.destroy();for(var a;a=this._modalconnects.pop();)a.remove();W.hide(this);this.inherited(arguments)}});t("dojo-bidi")&&(A=q("dijit._DialogBase",A,{_setTitleAttr:function(a){this._set("title",a);this.titleNode.innerHTML=a;this.applyTextDir(this.titleNode)},
_setTextDirAttr:function(a){this._created&&this.textDir!=a&&(this._set("textDir",a),this.set("title",this.title))}}));var K=q("dijit.Dialog",[G,A],{});K._DialogBase=A;var W=K._DialogLevelManager={_beginZIndex:950,show:function(a,b){R[R.length-1].focus=z.curNode;var c=R[R.length-1].dialog?R[R.length-1].zIndex+2:K._DialogLevelManager._beginZIndex;e.set(a.domNode,"zIndex",c);F.show(b,c-1);R.push({dialog:a,underlayAttrs:b,zIndex:c})},hide:function(a){if(R[R.length-1].dialog==a){R.pop();var b=R[R.length-
1];1==R.length?F.hide():F.show(b.underlayAttrs,b.zIndex-1);if(a.refocus&&(a=b.focus,!b.dialog||a&&m.isDescendant(a,b.dialog.domNode)||(b.dialog._getFocusItems(),a=b.dialog._firstFocusItem),a))try{a.focus()}catch(Q){}}else b=l.indexOf(l.map(R,function(a){return a.dialog}),a),-1!=b&&R.splice(b,1)},isTop:function(a){return R[R.length-1].dialog==a}},R=K._dialogStack=[{dialog:null,focus:null,underlayAttrs:null}];z.watch("curNode",function(a,b,c){a=R[R.length-1].dialog;if(c&&a&&!a._fadeOutDeferred&&c.ownerDocument==
a.ownerDocument){do if(c==a.domNode||p.contains(c,"dijitPopup"))return;while(c=c.parentNode);a.focus()}});t("dijit-legacy-requires")&&n(0,function(){r(["dijit/TooltipDialog"])});return K})},"dojo/dnd/Moveable":function(){define("../_base/array ../_base/declare ../_base/lang ../dom ../dom-class ../Evented ../has ../on ../topic ../touch ./common ./Mover ../_base/window".split(" "),function(r,l,d,q,k,m,p,h,e,c,b,a,g){function u(a,b){"touchAction"in document.body.style?n="touchAction":"msTouchAction"in
document.body.style&&(n="msTouchAction");t=function(a,b){a.style[n]=b};t(a,b)}var n,t=function(){};p("touch-action")&&(t=u);return l("dojo.dnd.Moveable",[m],{handle:"",delay:0,skip:!1,constructor:function(b,g){this.node=q.byId(b);t(this.node,"none");g||(g={});this.handle=g.handle?q.byId(g.handle):null;this.handle||(this.handle=this.node);this.delay=0<g.delay?g.delay:0;this.skip=g.skip;this.mover=g.mover?g.mover:a;this.events=[h(this.handle,c.press,d.hitch(this,"onMouseDown")),h(this.handle,"dragstart",
d.hitch(this,"onSelectStart")),h(this.handle,"selectstart",d.hitch(this,"onSelectStart"))]},markupFactory:function(a,b,c){return new c(b,a)},destroy:function(){r.forEach(this.events,function(a){a.remove()});t(this.node,"");this.events=this.node=this.handle=null},onMouseDown:function(a){if(!this.skip||!b.isFormElement(a)){if(this.delay)this.events.push(h(this.handle,c.move,d.hitch(this,"onMouseMove")),h(this.handle.ownerDocument,c.release,d.hitch(this,"onMouseUp"))),this._lastX=a.pageX,this._lastY=
a.pageY;else this.onDragDetected(a);a.stopPropagation();a.preventDefault()}},onMouseMove:function(a){if(Math.abs(a.pageX-this._lastX)>this.delay||Math.abs(a.pageY-this._lastY)>this.delay)this.onMouseUp(a),this.onDragDetected(a);a.stopPropagation();a.preventDefault()},onMouseUp:function(a){for(var b=0;2>b;++b)this.events.pop().remove();a.stopPropagation();a.preventDefault()},onSelectStart:function(a){this.skip&&b.isFormElement(a)||(a.stopPropagation(),a.preventDefault())},onDragDetected:function(a){new this.mover(this.node,
a,this)},onMoveStart:function(a){e.publish("/dnd/move/start",a);k.add(g.body(),"dojoMove");k.add(this.node,"dojoMoveItem")},onMoveStop:function(a){e.publish("/dnd/move/stop",a);k.remove(g.body(),"dojoMove");k.remove(this.node,"dojoMoveItem")},onFirstMove:function(){},onMove:function(a,b){this.onMoving(a,b);var c=a.node.style;c.left=b.l+"px";c.top=b.t+"px";this.onMoved(a,b)},onMoving:function(){},onMoved:function(){}})})},"dojo/dnd/common":function(){define(["../sniff","../_base/kernel","../_base/lang",
"../dom"],function(r,l,d,q){var k=d.getObject("dojo.dnd",!0);k.getCopyKeyState=function(d){return d[r("mac")?"metaKey":"ctrlKey"]};k._uniqueId=0;k.getUniqueId=function(){var d;do d=l._scopeName+"Unique"+ ++k._uniqueId;while(q.byId(d));return d};k._empty={};k.isFormElement=function(d){d=d.target;3==d.nodeType&&(d=d.parentNode);return 0<=" a button textarea input select option ".indexOf(" "+d.tagName.toLowerCase()+" ")};return k})},"dojo/dnd/Mover":function(){define("../_base/array ../_base/declare ../_base/lang ../sniff ../_base/window ../dom ../dom-geometry ../dom-style ../Evented ../on ../touch ./common ./autoscroll".split(" "),
function(r,l,d,q,k,m,p,h,e,c,b,a,g){return l("dojo.dnd.Mover",[e],{constructor:function(a,e,h){function f(a){a.preventDefault();a.stopPropagation()}this.node=m.byId(a);this.marginBox={l:e.pageX,t:e.pageY};this.mouseButton=e.button;e=this.host=h;a=a.ownerDocument;this.events=[c(a,b.move,d.hitch(this,"onFirstMove")),c(a,b.move,d.hitch(this,"onMouseMove")),c(a,b.release,d.hitch(this,"onMouseUp")),c(a,"dragstart",f),c(a.body,"selectstart",f)];g.autoScrollStart(a);if(e&&e.onMoveStart)e.onMoveStart(this)},
onMouseMove:function(a){g.autoScroll(a);var b=this.marginBox;this.host.onMove(this,{l:b.l+a.pageX,t:b.t+a.pageY},a);a.preventDefault();a.stopPropagation()},onMouseUp:function(a){(q("webkit")&&q("mac")&&2==this.mouseButton?0==a.button:this.mouseButton==a.button)&&this.destroy();a.preventDefault();a.stopPropagation()},onFirstMove:function(a){var b=this.node.style,c,f=this.host;switch(b.position){case "relative":case "absolute":c=Math.round(parseFloat(b.left))||0;b=Math.round(parseFloat(b.top))||0;break;
default:b.position="absolute";b=p.getMarginBox(this.node);c=k.doc.body;var g=h.getComputedStyle(c),e=p.getMarginBox(c,g),g=p.getContentBox(c,g);c=b.l-(g.l-e.l);b=b.t-(g.t-e.t)}this.marginBox.l=c-this.marginBox.l;this.marginBox.t=b-this.marginBox.t;if(f&&f.onFirstMove)f.onFirstMove(this,a);this.events.shift().remove()},destroy:function(){r.forEach(this.events,function(a){a.remove()});var a=this.host;if(a&&a.onMoveStop)a.onMoveStop(this);this.events=this.node=this.host=null}})})},"dojo/dnd/autoscroll":function(){define("../_base/lang ../sniff ../_base/window ../dom-geometry ../dom-style ../window".split(" "),
function(r,l,d,q,k,m){var p={};r.setObject("dojo.dnd.autoscroll",p);p.getViewport=m.getBox;p.V_TRIGGER_AUTOSCROLL=32;p.H_TRIGGER_AUTOSCROLL=32;p.V_AUTOSCROLL_VALUE=16;p.H_AUTOSCROLL_VALUE=16;var h,e=d.doc,c=Infinity,b=Infinity;p.autoScrollStart=function(a){e=a;h=m.getBox(e);a=d.body(e).parentNode;c=Math.max(a.scrollHeight-h.h,0);b=Math.max(a.scrollWidth-h.w,0)};p.autoScroll=function(a){var g=h||m.getBox(e),k=d.body(e).parentNode,n=0,t=0;a.clientX<p.H_TRIGGER_AUTOSCROLL?n=-p.H_AUTOSCROLL_VALUE:a.clientX>
g.w-p.H_TRIGGER_AUTOSCROLL&&(n=Math.min(p.H_AUTOSCROLL_VALUE,b-k.scrollLeft));a.clientY<p.V_TRIGGER_AUTOSCROLL?t=-p.V_AUTOSCROLL_VALUE:a.clientY>g.h-p.V_TRIGGER_AUTOSCROLL&&(t=Math.min(p.V_AUTOSCROLL_VALUE,c-k.scrollTop));window.scrollBy(n,t)};p._validNodes={div:1,p:1,td:1};p._validOverflow={auto:1,scroll:1};p.autoScrollNodes=function(a){for(var b,c,e,h,f,m=0,x=0,w=a.target;w;){if(1==w.nodeType&&w.tagName.toLowerCase()in p._validNodes){e=k.getComputedStyle(w);f=e.overflowX.toLowerCase()in p._validOverflow;
h=e.overflowY.toLowerCase()in p._validOverflow;if(f||h)b=q.getContentBox(w,e),c=q.position(w,!0);if(f){e=Math.min(p.H_TRIGGER_AUTOSCROLL,b.w/2);f=a.pageX-c.x;if(l("webkit")||l("opera"))f+=d.body().scrollLeft;m=0;0<f&&f<b.w&&(f<e?m=-e:f>b.w-e&&(m=e),w.scrollLeft+=m)}if(h){h=Math.min(p.V_TRIGGER_AUTOSCROLL,b.h/2);e=a.pageY-c.y;if(l("webkit")||l("opera"))e+=d.body().scrollTop;x=0;0<e&&e<b.h&&(e<h?x=-h:e>b.h-h&&(x=h),w.scrollTop+=x)}if(m||x)return}try{w=w.parentNode}catch(z){w=null}}p.autoScroll(a)};
return p})},"dojo/dnd/TimedMoveable":function(){define(["../_base/declare","./Moveable"],function(r,l){var d=l.prototype.onMove;return r("dojo.dnd.TimedMoveable",l,{timeout:40,constructor:function(d,k){k||(k={});k.timeout&&"number"==typeof k.timeout&&0<=k.timeout&&(this.timeout=k.timeout)},onMoveStop:function(q){q._timer&&(clearTimeout(q._timer),d.call(this,q,q._leftTop));l.prototype.onMoveStop.apply(this,arguments)},onMove:function(l,k){l._leftTop=k;if(!l._timer){var m=this;l._timer=setTimeout(function(){l._timer=
null;d.call(m,l,l._leftTop)},this.timeout)}}})})},"dijit/_base/manager":function(){define(["dojo/_base/array","dojo/_base/config","dojo/_base/lang","../registry","../main"],function(r,l,d,q,k){var m={};r.forEach("byId getUniqueId findWidgets _destroyAll byNode getEnclosingWidget".split(" "),function(d){m[d]=q[d]});d.mixin(m,{defaultDuration:l.defaultDuration||200});d.mixin(k,m);return k})},"dijit/_CssStateMixin":function(){define("dojo/_base/array dojo/_base/declare dojo/dom dojo/dom-class dojo/has dojo/_base/lang dojo/on dojo/domReady dojo/touch dojo/_base/window ./a11yclick ./registry".split(" "),
function(r,l,d,q,k,m,p,h,e,c,b,a){l=l("dijit._CssStateMixin",[],{hovering:!1,active:!1,_applyAttributes:function(){this.inherited(arguments);r.forEach("disabled readOnly checked selected focused state hovering active _opened".split(" "),function(a){this.watch(a,m.hitch(this,"_setStateClass"))},this);for(var a in this.cssStateNodes||{})this._trackMouseState(this[a],this.cssStateNodes[a]);this._trackMouseState(this.domNode,this.baseClass);this._setStateClass()},_cssMouseEvent:function(a){if(!this.disabled)switch(a.type){case "mouseover":case "MSPointerOver":case "pointerover":this._set("hovering",
!0);this._set("active",this._mouseDown);break;case "mouseout":case "MSPointerOut":case "pointerout":this._set("hovering",!1);this._set("active",!1);break;case "mousedown":case "touchstart":case "MSPointerDown":case "pointerdown":case "keydown":this._set("active",!0);break;case "mouseup":case "dojotouchend":case "MSPointerUp":case "pointerup":case "keyup":this._set("active",!1)}},_setStateClass:function(){function a(a){b=b.concat(r.map(b,function(b){return b+a}),"dijit"+a)}var b=this.baseClass.split(" ");
this.isLeftToRight()||a("Rtl");var c="mixed"==this.checked?"Mixed":this.checked?"Checked":"";this.checked&&a(c);this.state&&a(this.state);this.selected&&a("Selected");this._opened&&a("Opened");this.disabled?a("Disabled"):this.readOnly?a("ReadOnly"):this.active?a("Active"):this.hovering&&a("Hover");this.focused&&a("Focused");var c=this.stateNode||this.domNode,e={};r.forEach(c.className.split(" "),function(a){e[a]=!0});"_stateClasses"in this&&r.forEach(this._stateClasses,function(a){delete e[a]});r.forEach(b,
function(a){e[a]=!0});var f=[],d;for(d in e)f.push(d);c.className=f.join(" ");this._stateClasses=b},_subnodeCssMouseEvent:function(a,b,c){function g(c){q.toggle(a,b+"Active",c)}if(!this.disabled&&!this.readOnly)switch(c.type){case "mouseover":case "MSPointerOver":case "pointerover":q.toggle(a,b+"Hover",!0);break;case "mouseout":case "MSPointerOut":case "pointerout":q.toggle(a,b+"Hover",!1);g(!1);break;case "mousedown":case "touchstart":case "MSPointerDown":case "pointerdown":case "keydown":g(!0);
break;case "mouseup":case "MSPointerUp":case "pointerup":case "dojotouchend":case "keyup":g(!1);break;case "focus":case "focusin":q.toggle(a,b+"Focused",!0);break;case "blur":case "focusout":q.toggle(a,b+"Focused",!1)}},_trackMouseState:function(a,b){a._cssState=b}});h(function(){function g(b,c,g){if(!g||!d.isDescendant(g,c))for(;c&&c!=g;c=c.parentNode)if(c._cssState){var f=a.getEnclosingWidget(c);f&&(c==f.domNode?f._cssMouseEvent(b):f._subnodeCssMouseEvent(c,c._cssState,b))}}var h=c.body(),n;p(h,
e.over,function(a){g(a,a.target,a.relatedTarget)});p(h,e.out,function(a){g(a,a.target,a.relatedTarget)});p(h,b.press,function(a){n=a.target;g(a,n)});p(h,b.release,function(a){g(a,n);n=null});p(h,"focusin, focusout",function(b){var c=b.target;if(c._cssState&&!c.getAttribute("widgetId")){var g=a.getEnclosingWidget(c);g&&g._subnodeCssMouseEvent(c,c._cssState,b)}})});return l})},"dijit/form/_FormMixin":function(){define("dojo/_base/array dojo/_base/declare dojo/_base/kernel dojo/_base/lang dojo/on dojo/window".split(" "),
function(r,l,d,q,k,m){return l("dijit.form._FormMixin",null,{state:"",_getDescendantFormWidgets:function(d){var h=[];r.forEach(d||this.getChildren(),function(e){"value"in e?h.push(e):h=h.concat(this._getDescendantFormWidgets(e.getChildren()))},this);return h},reset:function(){r.forEach(this._getDescendantFormWidgets(),function(d){d.reset&&d.reset()})},validate:function(){var d=!1;return r.every(r.map(this._getDescendantFormWidgets(),function(h){h._hasBeenBlurred=!0;var e=h.disabled||!h.validate||
h.validate();e||d||(m.scrollIntoView(h.containerNode||h.domNode),h.focus(),d=!0);return e}),function(d){return d})},setValues:function(k){d.deprecated(this.declaredClass+"::setValues() is deprecated. Use set('value', val) instead.","","2.0");return this.set("value",k)},_setValueAttr:function(d){var h={};r.forEach(this._getDescendantFormWidgets(),function(a){a.name&&(h[a.name]||(h[a.name]=[])).push(a)});for(var e in h)if(h.hasOwnProperty(e)){var c=h[e],b=q.getObject(e,!1,d);void 0!==b&&(b=[].concat(b),
"boolean"==typeof c[0].checked?r.forEach(c,function(a){a.set("value",-1!=r.indexOf(b,a._get("value")))}):c[0].multiple?c[0].set("value",b):r.forEach(c,function(a,c){a.set("value",b[c])}))}},getValues:function(){d.deprecated(this.declaredClass+"::getValues() is deprecated. Use get('value') instead.","","2.0");return this.get("value")},_getValueAttr:function(){var d={};r.forEach(this._getDescendantFormWidgets(),function(h){var e=h.name;if(e&&!h.disabled){var c=h.get("value");"boolean"==typeof h.checked?
/Radio/.test(h.declaredClass)?!1!==c?q.setObject(e,c,d):(c=q.getObject(e,!1,d),void 0===c&&q.setObject(e,null,d)):(h=q.getObject(e,!1,d),h||(h=[],q.setObject(e,h,d)),!1!==c&&h.push(c)):(h=q.getObject(e,!1,d),"undefined"!=typeof h?q.isArray(h)?h.push(c):q.setObject(e,[h,c],d):q.setObject(e,c,d))}});return d},isValid:function(){return""==this.state},onValidStateChange:function(){},_getState:function(){var d=r.map(this._descendants,function(d){return d.get("state")||""});return 0<=r.indexOf(d,"Error")?
"Error":0<=r.indexOf(d,"Incomplete")?"Incomplete":""},disconnectChildren:function(){},connectChildren:function(d){this._descendants=this._getDescendantFormWidgets();r.forEach(this._descendants,function(d){d._started||d.startup()});d||this._onChildChange()},_onChildChange:function(d){d&&"state"!=d&&"disabled"!=d||this._set("state",this._getState());d&&"value"!=d&&"disabled"!=d&&"checked"!=d||(this._onChangeDelayTimer&&this._onChangeDelayTimer.remove(),this._onChangeDelayTimer=this.defer(function(){delete this._onChangeDelayTimer;
this._set("value",this.get("value"))},10))},startup:function(){this.inherited(arguments);this._descendants=this._getDescendantFormWidgets();this.value=this.get("value");this.state=this._getState();var d=this;this.own(k(this.containerNode,"attrmodified-state, attrmodified-disabled, attrmodified-value, attrmodified-checked",function(h){h.target!=d.domNode&&d._onChildChange(h.type.replace("attrmodified-",""))}));this.watch("state",function(d,e,c){this.onValidStateChange(""==c)})},destroy:function(){this.inherited(arguments)}})})},
"dijit/_DialogMixin":function(){define(["dojo/_base/declare","./a11y"],function(r,l){return r("dijit._DialogMixin",null,{actionBarTemplate:"",execute:function(){},onCancel:function(){},onExecute:function(){},_onSubmit:function(){this.onExecute();this.execute(this.get("value"))},_getFocusItems:function(){var d=l._getTabNavigable(this.domNode);this._firstFocusItem=d.lowest||d.first||this.closeButtonNode||this.domNode;this._lastFocusItem=d.last||d.highest||this._firstFocusItem}})})},"dijit/DialogUnderlay":function(){define("dojo/_base/declare dojo/_base/lang dojo/aspect dojo/dom-attr dojo/dom-style dojo/on dojo/window ./_Widget ./_TemplatedMixin ./BackgroundIframe ./Viewport ./main".split(" "),
function(r,l,d,q,k,m,p,h,e,c,b,a){var g=r("dijit.DialogUnderlay",[h,e],{templateString:"\x3cdiv class\x3d'dijitDialogUnderlayWrapper'\x3e\x3cdiv class\x3d'dijitDialogUnderlay' tabIndex\x3d'-1' data-dojo-attach-point\x3d'node'\x3e\x3c/div\x3e\x3c/div\x3e",dialogId:"","class":"",_modalConnects:[],_setDialogIdAttr:function(a){q.set(this.node,"id",a+"_underlay");this._set("dialogId",a)},_setClassAttr:function(a){this.node.className="dijitDialogUnderlay "+a;this._set("class",a)},postCreate:function(){this.ownerDocumentBody.appendChild(this.domNode);
this.own(m(this.domNode,"keydown",l.hitch(this,"_onKeyDown")));this.inherited(arguments)},layout:function(){var a=this.node.style,b=this.domNode.style;b.display="none";var c=p.getBox(this.ownerDocument);b.top=c.t+"px";b.left=c.l+"px";a.width=c.w+"px";a.height=c.h+"px";b.display="block"},show:function(){this.domNode.style.display="block";this.open=!0;this.layout();this.bgIframe=new c(this.domNode);var a=p.get(this.ownerDocument);this._modalConnects=[b.on("resize",l.hitch(this,"layout")),m(a,"scroll",
l.hitch(this,"layout"))]},hide:function(){this.bgIframe.destroy();delete this.bgIframe;for(this.domNode.style.display="none";this._modalConnects.length;)this._modalConnects.pop().remove();this.open=!1},destroy:function(){for(;this._modalConnects.length;)this._modalConnects.pop().remove();this.inherited(arguments)},_onKeyDown:function(){}});g.show=function(b,c){var e=g._singleton;!e||e._destroyed?e=a._underlay=g._singleton=new g(b):b&&e.set(b);k.set(e.domNode,"zIndex",c);e.open||e.show()};g.hide=function(){var a=
g._singleton;a&&!a._destroyed&&a.hide()};return g})},"dijit/BackgroundIframe":function(){define("require ./main dojo/_base/config dojo/dom-construct dojo/dom-style dojo/_base/lang dojo/on dojo/sniff".split(" "),function(r,l,d,q,k,m,p,h){h.add("config-bgIframe",(h("ie")||h("trident"))&&!/IEMobile\/10\.0/.test(navigator.userAgent));var e=new function(){var c=[];this.pop=function(){var b;c.length?(b=c.pop(),b.style.display=""):(9>h("ie")?(b=d.dojoBlankHtmlUrl||r.toUrl("dojo/resources/blank.html")||'javascript:""',
b=document.createElement("\x3ciframe src\x3d'"+b+"' role\x3d'presentation' style\x3d'position: absolute; left: 0px; top: 0px;z-index: -1; filter:Alpha(Opacity\x3d\"0\");'\x3e")):(b=q.create("iframe"),b.src='javascript:""',b.className="dijitBackgroundIframe",b.setAttribute("role","presentation"),k.set(b,"opacity",.1)),b.tabIndex=-1);return b};this.push=function(b){b.style.display="none";c.push(b)}};l.BackgroundIframe=function(c){if(!c.id)throw Error("no id");if(h("config-bgIframe")){var b=this.iframe=
e.pop();c.appendChild(b);7>h("ie")||h("quirks")?(this.resize(c),this._conn=p(c,"resize",m.hitch(this,"resize",c))):k.set(b,{width:"100%",height:"100%"})}};m.extend(l.BackgroundIframe,{resize:function(c){this.iframe&&k.set(this.iframe,{width:c.offsetWidth+"px",height:c.offsetHeight+"px"})},destroy:function(){this._conn&&(this._conn.remove(),this._conn=null);this.iframe&&(this.iframe.parentNode.removeChild(this.iframe),e.push(this.iframe),delete this.iframe)}});return l.BackgroundIframe})},"dijit/Viewport":function(){define(["dojo/Evented",
"dojo/on","dojo/domReady","dojo/sniff","dojo/window"],function(r,l,d,q,k){var m=new r,p;d(function(){var d=k.getBox();m._rlh=l(window,"resize",function(){var c=k.getBox();if(d.h!=c.h||d.w!=c.w)d=c,m.emit("resize")});if(8==q("ie")){var e=screen.deviceXDPI;setInterval(function(){screen.deviceXDPI!=e&&(e=screen.deviceXDPI,m.emit("resize"))},500)}q("ios")&&(l(document,"focusin",function(c){p=c.target}),l(document,"focusout",function(c){p=null}))});m.getEffectiveBox=function(d){d=k.getBox(d);var e=p&&
p.tagName&&p.tagName.toLowerCase();q("ios")&&p&&!p.readOnly&&("textarea"==e||"input"==e&&/^(color|email|number|password|search|tel|text|url)$/.test(p.type))&&(d.h*=0==orientation||180==orientation?.66:.4,e=p.getBoundingClientRect(),d.h=Math.max(d.h,e.top+e.height));return d};return m})},"dijit/layout/ContentPane":function(){define("dojo/_base/kernel dojo/_base/lang ../_Widget ../_Container ./_ContentPaneResizeMixin dojo/string dojo/html dojo/_base/array dojo/_base/declare dojo/_base/Deferred dojo/dom dojo/dom-attr dojo/dom-construct dojo/_base/xhr dojo/i18n dojo/when dojo/i18n!../nls/loading".split(" "),
function(r,l,d,q,k,m,p,h,e,c,b,a,g,u,n,t){return e("dijit.layout.ContentPane",[d,q,k],{href:"",content:"",extractContent:!1,parseOnLoad:!0,parserScope:r._scopeName,preventCache:!1,preload:!1,refreshOnShow:!1,loadingMessage:"\x3cspan class\x3d'dijitContentPaneLoading'\x3e\x3cspan class\x3d'dijitInline dijitIconLoading'\x3e\x3c/span\x3e${loadingState}\x3c/span\x3e",errorMessage:"\x3cspan class\x3d'dijitContentPaneError'\x3e\x3cspan class\x3d'dijitInline dijitIconError'\x3e\x3c/span\x3e${errorState}\x3c/span\x3e",
isLoaded:!1,baseClass:"dijitContentPane",ioArgs:{},onLoadDeferred:null,_setTitleAttr:null,stopParser:!0,template:!1,markupFactory:function(a,b,c){var f=new c(a,b);return!f.href&&f._contentSetter&&f._contentSetter.parseDeferred&&!f._contentSetter.parseDeferred.isFulfilled()?f._contentSetter.parseDeferred.then(function(){return f}):f},create:function(a,c){if(!(a&&a.template||!c||"href"in a||"content"in a)){c=b.byId(c);for(var f=c.ownerDocument.createDocumentFragment();c.firstChild;)f.appendChild(c.firstChild);
a=l.delegate(a,{content:f})}this.inherited(arguments,[a,c])},postMixInProperties:function(){this.inherited(arguments);var a=n.getLocalization("dijit","loading",this.lang);this.loadingMessage=m.substitute(this.loadingMessage,a);this.errorMessage=m.substitute(this.errorMessage,a)},buildRendering:function(){this.inherited(arguments);this.containerNode||(this.containerNode=this.domNode);this.domNode.removeAttribute("title")},startup:function(){this.inherited(arguments);this._contentSetter&&h.forEach(this._contentSetter.parseResults,
function(a){a._started||a._destroyed||!l.isFunction(a.startup)||(a.startup(),a._started=!0)},this)},_startChildren:function(){h.forEach(this.getChildren(),function(a){a._started||a._destroyed||!l.isFunction(a.startup)||(a.startup(),a._started=!0)});this._contentSetter&&h.forEach(this._contentSetter.parseResults,function(a){a._started||a._destroyed||!l.isFunction(a.startup)||(a.startup(),a._started=!0)},this)},setHref:function(a){r.deprecated("dijit.layout.ContentPane.setHref() is deprecated. Use set('href', ...) instead.",
"","2.0");return this.set("href",a)},_setHrefAttr:function(a){this.cancel();this.onLoadDeferred=new c(l.hitch(this,"cancel"));this.onLoadDeferred.then(l.hitch(this,"onLoad"));this._set("href",a);this.preload||this._created&&this._isShown()?this._load():this._hrefChanged=!0;return this.onLoadDeferred},setContent:function(a){r.deprecated("dijit.layout.ContentPane.setContent() is deprecated.  Use set('content', ...) instead.","","2.0");this.set("content",a)},_setContentAttr:function(a){this._set("href",
"");this.cancel();this.onLoadDeferred=new c(l.hitch(this,"cancel"));this._created&&this.onLoadDeferred.then(l.hitch(this,"onLoad"));this._setContent(a||"");this._isDownloaded=!1;return this.onLoadDeferred},_getContentAttr:function(){return this.containerNode.innerHTML},cancel:function(){this._xhrDfd&&-1==this._xhrDfd.fired&&this._xhrDfd.cancel();delete this._xhrDfd;this.onLoadDeferred=null},destroy:function(){this.cancel();this.inherited(arguments)},destroyRecursive:function(a){this._beingDestroyed||
this.inherited(arguments)},_onShow:function(){this.inherited(arguments);if(this.href&&!this._xhrDfd&&(!this.isLoaded||this._hrefChanged||this.refreshOnShow))return this.refresh()},refresh:function(){this.cancel();this.onLoadDeferred=new c(l.hitch(this,"cancel"));this.onLoadDeferred.then(l.hitch(this,"onLoad"));this._load();return this.onLoadDeferred},_load:function(){this._setContent(this.onDownloadStart(),!0);var a=this,b={preventCache:this.preventCache||this.refreshOnShow,url:this.href,handleAs:"text"};
l.isObject(this.ioArgs)&&l.mixin(b,this.ioArgs);var c=this._xhrDfd=(this.ioMethod||u.get)(b),g;c.then(function(b){g=b;try{return a._isDownloaded=!0,a._setContent(b,!1)}catch(A){a._onError("Content",A)}},function(b){c.canceled||a._onError("Download",b);delete a._xhrDfd;return b}).then(function(){a.onDownloadEnd();delete a._xhrDfd;return g});delete this._hrefChanged},_onLoadHandler:function(a){this._set("isLoaded",!0);try{this.onLoadDeferred.resolve(a)}catch(v){console.error("Error "+this.widgetId+
" running custom onLoad code: "+v.message)}},_onUnloadHandler:function(){this._set("isLoaded",!1);try{this.onUnload()}catch(f){console.error("Error "+this.widgetId+" running custom onUnload code: "+f.message)}},destroyDescendants:function(a){this.isLoaded&&this._onUnloadHandler();var b=this._contentSetter;h.forEach(this.getChildren(),function(b){b.destroyRecursive?b.destroyRecursive(a):b.destroy&&b.destroy(a);b._destroyed=!0});b&&(h.forEach(b.parseResults,function(b){b._destroyed||(b.destroyRecursive?
b.destroyRecursive(a):b.destroy&&b.destroy(a),b._destroyed=!0)}),delete b.parseResults);a||g.empty(this.containerNode);delete this._singleChild},_setContent:function(a,b){a=this.preprocessContent(a);this.destroyDescendants();var c=this._contentSetter;c&&c instanceof p._ContentSetter||(c=this._contentSetter=new p._ContentSetter({node:this.containerNode,_onError:l.hitch(this,this._onError),onContentError:l.hitch(this,function(a){a=this.onContentError(a);try{this.containerNode.innerHTML=a}catch(y){console.error("Fatal "+
this.id+" could not change content due to "+y.message,y)}})}));var f=l.mixin({cleanContent:this.cleanContent,extractContent:this.extractContent,parseContent:!a.domNode&&this.parseOnLoad,parserScope:this.parserScope,startup:!1,dir:this.dir,lang:this.lang,textDir:this.textDir},this._contentSetterParams||{}),f=c.set(l.isObject(a)&&a.domNode?a.domNode:a,f),g=this;return t(f&&f.then?f:c.parseDeferred,function(){delete g._contentSetterParams;b||(g._started&&(g._startChildren(),g._scheduleLayout()),g._onLoadHandler(a))})},
preprocessContent:function(a){return a},_onError:function(a,b,c){this.onLoadDeferred.reject(b);a=this["on"+a+"Error"].call(this,b);c?console.error(c,b):a&&this._setContent(a,!0)},onLoad:function(){},onUnload:function(){},onDownloadStart:function(){return this.loadingMessage},onContentError:function(){},onDownloadError:function(){return this.errorMessage},onDownloadEnd:function(){}})})},"dijit/_Container":function(){define(["dojo/_base/array","dojo/_base/declare","dojo/dom-construct","dojo/_base/kernel"],
function(r,l,d,q){return l("dijit._Container",null,{buildRendering:function(){this.inherited(arguments);this.containerNode||(this.containerNode=this.domNode)},addChild:function(k,l){var m=this.containerNode;if(0<l){for(m=m.firstChild;0<l;)1==m.nodeType&&l--,m=m.nextSibling;m?l="before":(m=this.containerNode,l="last")}d.place(k.domNode,m,l);this._started&&!k._started&&k.startup()},removeChild:function(d){"number"==typeof d&&(d=this.getChildren()[d]);d&&(d=d.domNode)&&d.parentNode&&d.parentNode.removeChild(d)},
hasChildren:function(){return 0<this.getChildren().length},_getSiblingOfChild:function(d,l){var k=this.getChildren(),h=r.indexOf(k,d);return k[h+l]},getIndexOfChild:function(d){return r.indexOf(this.getChildren(),d)}})})},"dijit/layout/_ContentPaneResizeMixin":function(){define("dojo/_base/array dojo/_base/declare dojo/dom-class dojo/dom-geometry dojo/dom-style dojo/_base/lang dojo/query ../registry ../Viewport ./utils".split(" "),function(r,l,d,q,k,m,p,h,e,c){return l("dijit.layout._ContentPaneResizeMixin",
null,{doLayout:!0,isLayoutContainer:!0,startup:function(){if(!this._started){var b=this.getParent();this._childOfLayoutWidget=b&&b.isLayoutContainer;this._needLayout=!this._childOfLayoutWidget;this.inherited(arguments);this._isShown()&&this._onShow();this._childOfLayoutWidget||this.own(e.on("resize",m.hitch(this,"resize")))}},_checkIfSingleChild:function(){if(this.doLayout){var b=[],a=!1;p("\x3e *",this.containerNode).some(function(c){var g=h.byNode(c);g&&g.resize?b.push(g):!/script|link|style/i.test(c.nodeName)&&
c.offsetHeight&&(a=!0)});this._singleChild=1!=b.length||a?null:b[0];d.toggle(this.containerNode,this.baseClass+"SingleChild",!!this._singleChild)}},resize:function(b,a){this._resizeCalled=!0;this._scheduleLayout(b,a)},_scheduleLayout:function(b,a){this._isShown()?this._layout(b,a):(this._needLayout=!0,this._changeSize=b,this._resultSize=a)},_layout:function(b,a){delete this._needLayout;this._wasShown||!1===this.open||this._onShow();b&&q.setMarginBox(this.domNode,b);var g=this.containerNode;if(g===
this.domNode){var e=a||{};m.mixin(e,b||{});"h"in e&&"w"in e||(e=m.mixin(q.getMarginBox(g),e));this._contentBox=c.marginBox2contentBox(g,e)}else this._contentBox=q.getContentBox(g);this._layoutChildren()},_layoutChildren:function(){this._checkIfSingleChild();if(this._singleChild&&this._singleChild.resize){var b=this._contentBox||q.getContentBox(this.containerNode);this._singleChild.resize({w:b.w,h:b.h})}else for(var b=this.getChildren(),a,c=0;a=b[c++];)a.resize&&a.resize()},_isShown:function(){if(this._childOfLayoutWidget)return this._resizeCalled&&
"open"in this?this.open:this._resizeCalled;if("open"in this)return this.open;var b=this.domNode,a=this.domNode.parentNode;return"none"!=b.style.display&&"hidden"!=b.style.visibility&&!d.contains(b,"dijitHidden")&&a&&a.style&&"none"!=a.style.display},_onShow:function(){this._wasShown=!0;this._needLayout&&this._layout(this._changeSize,this._resultSize);this.inherited(arguments)}})})},"dijit/layout/utils":function(){define(["dojo/_base/array","dojo/dom-class","dojo/dom-geometry","dojo/dom-style","dojo/_base/lang"],
function(r,l,d,q,k){function m(e){return e.substring(0,1).toUpperCase()+e.substring(1)}function p(e,c){var b=e.resize?e.resize(c):d.setMarginBox(e.domNode,c);b?k.mixin(e,b):(k.mixin(e,d.getMarginBox(e.domNode)),k.mixin(e,c))}var h={marginBox2contentBox:function(e,c){var b=q.getComputedStyle(e),a=d.getMarginExtents(e,b),g=d.getPadBorderExtents(e,b);return{l:q.toPixelValue(e,b.paddingLeft),t:q.toPixelValue(e,b.paddingTop),w:c.w-(a.w+g.w),h:c.h-(a.h+g.h)}},layoutChildren:function(e,c,b,a,g){c=k.mixin({},
c);l.add(e,"dijitLayoutContainer");b=r.filter(b,function(a){return"center"!=a.region&&"client"!=a.layoutAlign}).concat(r.filter(b,function(a){return"center"==a.region||"client"==a.layoutAlign}));r.forEach(b,function(b){var e=b.domNode,d=b.region||b.layoutAlign;if(!d)throw Error("No region setting for "+b.id);var f=e.style;f.left=c.l+"px";f.top=c.t+"px";f.position="absolute";l.add(e,"dijitAlign"+m(d));e={};a&&a==b.id&&(e["top"==b.region||"bottom"==b.region?"h":"w"]=g);"leading"==d&&(d=b.isLeftToRight()?
"left":"right");"trailing"==d&&(d=b.isLeftToRight()?"right":"left");"top"==d||"bottom"==d?(e.w=c.w,p(b,e),c.h-=b.h,"top"==d?c.t+=b.h:f.top=c.t+c.h+"px"):"left"==d||"right"==d?(e.h=c.h,p(b,e),c.w-=b.w,"left"==d?c.l+=b.w:f.left=c.l+c.w+"px"):"client"!=d&&"center"!=d||p(b,c)})}};k.setObject("dijit.layout.utils",h);return h})},"dojo/html":function(){define("./_base/kernel ./_base/lang ./_base/array ./_base/declare ./dom ./dom-construct ./parser".split(" "),function(r,l,d,q,k,m,p){var h=0,e={_secureForInnerHtml:function(c){return c.replace(/(?:\s*<!DOCTYPE\s[^>]+>|<title[^>]*>[\s\S]*?<\/title>)/ig,
"")},_emptyNode:m.empty,_setNodeContent:function(c,b){m.empty(c);if(b)if("number"==typeof b&&(b=b.toString()),"string"==typeof b&&(b=m.toDom(b,c.ownerDocument)),!b.nodeType&&l.isArrayLike(b))for(var a=b.length,g=0;g<b.length;g=a==b.length?g+1:0)m.place(b[g],c,"last");else m.place(b,c,"last");return c},_ContentSetter:q("dojo.html._ContentSetter",null,{node:"",content:"",id:"",cleanContent:!1,extractContent:!1,parseContent:!1,parserScope:r._scopeName,startup:!0,constructor:function(c,b){l.mixin(this,
c||{});b=this.node=k.byId(this.node||b);this.id||(this.id=["Setter",b?b.id||b.tagName:"",h++].join("_"))},set:function(c,b){void 0!==c&&(this.content=c);"number"==typeof c&&(c=c.toString());b&&this._mixin(b);this.onBegin();this.setContent();var a=this.onEnd();return a&&a.then?a:this.node},setContent:function(){var c=this.node;if(!c)throw Error(this.declaredClass+": setContent given no node");try{c=e._setNodeContent(c,this.content)}catch(a){var b=this.onContentError(a);try{c.innerHTML=b}catch(g){console.error("Fatal "+
this.declaredClass+".setContent could not change content due to "+g.message,g)}}this.node=c},empty:function(){this.parseDeferred&&(this.parseDeferred.isResolved()||this.parseDeferred.cancel(),delete this.parseDeferred);this.parseResults&&this.parseResults.length&&(d.forEach(this.parseResults,function(c){c.destroy&&c.destroy()}),delete this.parseResults);m.empty(this.node)},onBegin:function(){var c=this.content;if(l.isString(c)&&(this.cleanContent&&(c=e._secureForInnerHtml(c)),this.extractContent)){var b=
c.match(/<body[^>]*>\s*([\s\S]+)\s*<\/body>/im);b&&(c=b[1])}this.empty();this.content=c;return this.node},onEnd:function(){this.parseContent&&this._parse();return this.node},tearDown:function(){delete this.parseResults;delete this.parseDeferred;delete this.node;delete this.content},onContentError:function(c){return"Error occurred setting content: "+c},onExecError:function(c){return"Error occurred executing scripts: "+c},_mixin:function(c){var b={},a;for(a in c)a in b||(this[a]=c[a])},_parse:function(){var c=
this.node;try{var b={};d.forEach(["dir","lang","textDir"],function(a){this[a]&&(b[a]=this[a])},this);var a=this;this.parseDeferred=p.parse({rootNode:c,noStart:!this.startup,inherited:b,scope:this.parserScope}).then(function(b){return a.parseResults=b},function(b){a._onError("Content",b,"Error parsing in _ContentSetter#"+this.id)})}catch(g){this._onError("Content",g,"Error parsing in _ContentSetter#"+this.id)}},_onError:function(c,b,a){c=this["on"+c+"Error"].call(this,b);a?console.error(a,b):c&&e._setNodeContent(this.node,
c,!0)}}),set:function(c,b,a){void 0==b&&(console.warn("dojo.html.set: no cont argument provided, using empty string"),b="");"number"==typeof b&&(b=b.toString());return a?(new e._ContentSetter(l.mixin(a,{content:b,node:c}))).set():e._setNodeContent(c,b,!0)}};l.setObject("dojo.html",e);return e})},"esri/Credential":function(){define(["dojo/_base/declare","dojo/has","./kernel","./IdentityManagerBase"],function(r,l,d,q){return r(q.Credential,{})})},"esri/IdentityManagerBase":function(){define("dojo/_base/declare dojo/_base/config dojo/_base/lang dojo/_base/array dojo/_base/Deferred dojo/_base/json dojo/_base/url dojo/sniff dojo/cookie dojo/io-query dojo/regexp ./kernel ./config ./lang ./ServerInfo ./urlUtils ./deferredUtils ./request ./Evented ./OAuthCredential ./arcgis/OAuthInfo".split(" "),
function(r,l,d,q,k,m,p,h,e,c,b,a,g,u,n,t,f,v,x,w,z){var A={},y=function(a){var b=(new p(a.owningSystemUrl)).host;a=(new p(a.server)).host;var c=/.+\.arcgis\.com$/i;return c.test(b)&&c.test(a)},B=function(a,b){return!!(y(a)&&b&&q.some(b,function(b){return b.test(a.server)}))},C,E=r(x,{declaredClass:"esri.IdentityManagerBase",constructor:function(){this._portalConfig=d.getObject("esriGeowConfig");this.serverInfos=[];this.oAuthInfos=[];this.credentials=[];this._soReqs=[];this._xoReqs=[];this._portals=
[];this._getOAuthHash()},defaultOAuthInfo:null,defaultTokenValidity:60,tokenValidity:null,signInPage:null,useSignInPage:!0,normalizeWebTierAuth:!1,_busy:null,_oAuthHash:null,_gwTokenUrl:"/sharing/generateToken",_agsRest:"/rest/services",_agsPortal:/\/sharing(\/|$)/i,_agsAdmin:/https?:\/\/[^\/]+\/[^\/]+\/admin\/?(\/.*)?$/i,_adminSvcs:/\/admin\/services(\/|$)/i,_agolSuffix:".arcgis.com",_gwDomains:[{regex:/https?:\/\/www\.arcgis\.com/i,tokenServiceUrl:"https://www.arcgis.com/sharing/generateToken"},
{regex:/https?:\/\/dev\.arcgis\.com/i,tokenServiceUrl:"https://dev.arcgis.com/sharing/generateToken"},{regex:/https?:\/\/.*dev[^.]*\.arcgis\.com/i,tokenServiceUrl:"https://devext.arcgis.com/sharing/generateToken"},{regex:/https?:\/\/.*qa[^.]*\.arcgis\.com/i,tokenServiceUrl:"https://qaext.arcgis.com/sharing/generateToken"},{regex:/https?:\/\/.*.arcgis\.com/i,tokenServiceUrl:"https://www.arcgis.com/sharing/generateToken"}],_legacyFed:[],_regexSDirUrl:/http.+\/rest\/services\/?/ig,_regexServerType:/(\/(MapServer|GeocodeServer|GPServer|GeometryServer|ImageServer|NAServer|FeatureServer|GeoDataServer|GlobeServer|MobileServer|GeoenrichmentServer|VectorTileServer)).*/ig,
_gwUser:/http.+\/users\/([^\/]+)\/?.*/i,_gwItem:/http.+\/items\/([^\/]+)\/?.*/i,_gwGroup:/http.+\/groups\/([^\/]+)\/?.*/i,_errorCodes:[499,498,403,401],_rePortalTokenSvc:/\/sharing(\/rest)?\/generatetoken/i,_publicUrls:[/\/arcgis\/tokens/i,/\/sharing(\/rest)?\/generatetoken/i,/\/rest\/info/i],_createDefaultOAuthInfo:!0,_hasTestedIfAppIsOnPortal:!1,registerServers:function(a){var b=this.serverInfos;b?(a=q.filter(a,function(a){return!this.findServerInfo(a.server)},this),this.serverInfos=b.concat(a)):
this.serverInfos=a;q.forEach(a,function(a){a.owningSystemUrl&&this._portals.push(a.owningSystemUrl);if(a.hasPortal){this._portals.push(a.server);var b=g.defaults.io.corsEnabledServers,c=this._getOrigin(a.tokenServiceUrl);t.canUseXhr(a.server)||b.push(a.server.replace(/^https?:\/\//i,""));t.canUseXhr(c)||b.push(c.replace(/^https?:\/\//i,""))}},this)},registerOAuthInfos:function(a){var b=this.oAuthInfos;b?(a=q.filter(a,function(a){return!this.findOAuthInfo(a.portalUrl)},this),this.oAuthInfos=b.concat(a)):
this.oAuthInfos=a},registerToken:function(a){var b=this._sanitizeUrl(a.server),c=this.findServerInfo(b),f=!0,e;c||(c=new n,c.server=this._getServerInstanceRoot(b),c.tokenServiceUrl=this._getTokenSvcUrl(b),c.hasPortal=!0,this.registerServers([c]));(e=this.findCredential(b,a.userId))?(d.mixin(e,a),f=!1):(e=new C({userId:a.userId,server:c.server,token:a.token,expires:a.expires,ssl:a.ssl,scope:this._isServerRsrc(b)?"server":"portal"}),e.resources=[b],this.credentials.push(e));e.onTokenChange(!1);f||e.refreshServerTokens()},
toJson:function(){return u.fixJson({serverInfos:q.map(this.serverInfos,function(a){return a.toJson()}),oAuthInfos:q.map(this.oAuthInfos,function(a){return a.toJson()}),credentials:q.map(this.credentials,function(a){return a.toJson()})})},initialize:function(a){if(a){d.isString(a)&&(a=m.fromJson(a));var b=a.serverInfos,c=a.oAuthInfos;a=a.credentials;if(b){var f=[];q.forEach(b,function(a){a.server&&a.tokenServiceUrl&&f.push(a.declaredClass?a:new n(a))});f.length&&this.registerServers(f)}if(c){var e=
[];q.forEach(c,function(a){a.appId&&e.push(a.declaredClass?a:new z(a))});e.length&&this.registerOAuthInfos(e)}a&&q.forEach(a,function(a){a.userId&&a.server&&a.token&&a.expires&&a.expires>(new Date).getTime()&&(a=a.declaredClass?a:new C(a),a.onTokenChange(),this.credentials.push(a))},this)}},findServerInfo:function(a){var b;a=this._sanitizeUrl(a);q.some(this.serverInfos,function(c){this._hasSameServerInstance(c.server,a)&&(b=c);return!!b},this);return b},findOAuthInfo:function(a){var b;a=this._sanitizeUrl(a);
q.some(this.oAuthInfos,function(c){this._hasSameServerInstance(c.portalUrl,a)&&(b=c);return!!b},this);return b},findCredential:function(a,b){var c,f;a=this._sanitizeUrl(a);f=this._isServerRsrc(a)?"server":"portal";b?q.some(this.credentials,function(e){this._hasSameServerInstance(e.server,a)&&b===e.userId&&e.scope===f&&(c=e);return!!c},this):q.some(this.credentials,function(b){this._hasSameServerInstance(b.server,a)&&-1!==this._getIdenticalSvcIdx(a,b)&&b.scope===f&&(c=b);return!!c},this);return c},
getCredential:function(a,b){var c,g,h=!0;u.isDefined(b)&&(d.isObject(b)?(c=!!b.token,g=b.error,h=!1!==b.prompt):c=b);a=this._sanitizeUrl(a);var t=new k(f._dfdCanceller),m=this._isAdminResource(a),p=c&&this._doPortalSignIn(a)?this._getEsriAuthCookie():null;if((c=c?this.findCredential(a):null)&&g&&498===g.code)c.destroy(),p&&p.token===b.token&&e("esri_auth",null,{expires:-1,path:"/",domain:document.domain});else if(p||c)return h=Error("You are currently signed in as: '"+(p&&p.email||c&&c.userId)+"'. You do not have access to this resource: "+
a),h.code="IdentityManagerBase.1",h.httpCode=g&&g.httpCode,h.messageCode=g?g.messageCode:null,h.subcode=g?g.subcode:null,h.details=g?g.details:null,h.log=!!l.isDebug,t.errback(h),t;if(g=this._findCredential(a,b))return t.callback(g),t;g=this.findServerInfo(a);if(g)!g.hasServer&&this._isServerRsrc(a)&&(g._restInfoDfd=this._getTokenSvcUrl(a,!0),g.hasServer=!0);else{p=this._getTokenSvcUrl(a);if(!p)return h=Error("Unknown resource - could not find token service endpoint."),h.code="IdentityManagerBase.2",
h.log=!!l.isDebug,t.errback(h),t;g=new n;g.server=this._getServerInstanceRoot(a);d.isString(p)?(g.tokenServiceUrl=p,g.hasPortal=!0):(g._restInfoDfd=p,g.hasServer=!0);this.registerServers([g])}h&&g.hasPortal&&void 0===g._selfReq&&!this._findOAuthInfo(a)&&(g._selfReq={owningTenant:b&&b.owningTenant,selfDfd:this._getPortalSelf(g.tokenServiceUrl.replace(this._rePortalTokenSvc,"/sharing/rest/portals/self"),a)});return this._enqueue(a,g,b,t,m)},getResourceName:function(a){return this._isRESTService(a)?
a.replace(this._regexSDirUrl,"").replace(this._regexServerType,"")||"":this._gwUser.test(a)&&a.replace(this._gwUser,"$1")||this._gwItem.test(a)&&a.replace(this._gwItem,"$1")||this._gwGroup.test(a)&&a.replace(this._gwGroup,"$1")||""},generateToken:function(b,c,f){var g,e,h,n,k,m,u=this._rePortalTokenSvc.test(b.tokenServiceUrl),q=new p(window.location.href.toLowerCase()),w=this._getEsriAuthCookie(),x,z=!c;n=b.shortLivedTokenValidity;var r;c&&(r=a.id.tokenValidity||n||a.id.defaultTokenValidity,r>n&&
(r=n));f&&(g=f.isAdmin,e=f.serverUrl,h=f.token,m=f.ssl,b.customParameters=f.customParameters);g?n=b.adminTokenServiceUrl:(n=b.tokenServiceUrl,k=new p(n.toLowerCase()),w&&(x=(x=w.auth_tier)&&x.toLowerCase()),("web"===x||b.webTierAuth)&&f&&f.serverUrl&&!m&&"http"===q.scheme&&(t.hasSameOrigin(q.uri,n,!0)||"https"===k.scheme&&q.host===k.host&&"7080"===q.port&&"7443"===k.port)&&(n=n.replace(/^https:/i,"http:").replace(/:7443/i,":7080")),z&&u&&(n=n.replace(/\/rest/i,"")));g=d.mixin({url:n,content:d.mixin({request:"getToken",
username:c&&c.username,password:c&&c.password,serverUrl:e,token:h,expiration:r,referer:g||u?window.location.host:null,client:g?"referer":null,f:"json"},b.customParameters),handleAs:"json",callbackParamName:z?"callback":void 0},f&&f.ioArgs);f={usePost:!z,disableIdentityLookup:!0,useProxy:this._useProxy(b,f)};u||(g.withCredentials=!1);u=v(g,f);u.addCallback(function(a){if(!a||!a.token)return a=Error("Unable to generate token"),a.code="IdentityManagerBase.3",a.log=!!l.isDebug,a;var f=b.server;A[f]||
(A[f]={});c&&(A[f][c.username]=c.password);a.validity=r;return a});u.addErrback(function(a){});return u},isBusy:function(){return!!this._busy},checkSignInStatus:function(a){var b=new k;this.getCredential(a,{prompt:!1}).then(function(a){return a.token?v({url:a.server+("portal"===a.scope?"/sharing/rest":"/rest/services"),content:{f:"json",token:a.token},callbackParamName:"callback"},{disableIdentityLookup:!0}).then(function(){return a}).otherwise(function(b){if(498===b.code)throw a.destroy(),b=Error("User is not signed in."),
b.code="IdentityManagerBase.6",b.log=!!l.isDebug,b;return a}):a}).then(function(a){b.resolve(a)}).otherwise(function(a){b.reject(a)});return b},setRedirectionHandler:function(a){this._redirectFunc=a},setProtocolErrorHandler:function(a){this._protocolFunc=a},signIn:function(){},oAuthSignIn:function(){},onCredentialCreate:function(){},onCredentialsDestroy:function(){},destroyCredentials:function(){if(this.credentials){var a=this.credentials.slice();q.forEach(a,function(a){a.destroy()})}this.onCredentialsDestroy()},
_getOAuthHash:function(){var a=window.location.hash;if(a){"#"===a.charAt(0)&&(a=a.substring(1));var a=c.queryToObject(a),b=!1;a.access_token&&a.expires_in&&a.state&&a.hasOwnProperty("username")?(a.state=m.fromJson(a.state),this._oAuthHash=a,b=!0):a.error&&a.error_description&&(console.log("IdentityManager OAuth Error: ",a.error," - ",a.error_description),"access_denied"===a.error&&(b=!0));b&&(!h("ie")||8<h("ie"))&&(window.location.hash="")}},_findCredential:function(a,b){var c=-1,f,g,e,d,h=b&&b.token;
f=b&&b.resource;var n=this._isServerRsrc(a)?"server":"portal",k=q.filter(this.credentials,function(b){return this._hasSameServerInstance(b.server,a)&&b.scope===n},this);a=f||a;if(k.length)if(1===k.length)if(f=k[0],e=(g=(d=this.findServerInfo(f.server))&&d.owningSystemUrl)&&this.findCredential(g,f.userId),c=this._getIdenticalSvcIdx(a,f),h)-1!==c&&(f.resources.splice(c,1),this._removeResource(a,e));else return-1===c&&f.resources.push(a),this._addResource(a,e),f;else{var t,l;q.some(k,function(b){l=this._getIdenticalSvcIdx(a,
b);return-1!==l?(t=b,e=(g=(d=this.findServerInfo(t.server))&&d.owningSystemUrl)&&this.findCredential(g,t.userId),c=l,!0):!1},this);if(h)t&&(t.resources.splice(c,1),this._removeResource(a,e));else if(t)return this._addResource(a,e),t}},_findOAuthInfo:function(a){var b=this.findOAuthInfo(a);b||q.some(this.oAuthInfos,function(c){this._isIdProvider(c.portalUrl,a)&&(b=c);return!!b},this);return b},_addResource:function(a,b){b&&-1===this._getIdenticalSvcIdx(a,b)&&b.resources.push(a)},_removeResource:function(a,
b){var c=-1;b&&(c=this._getIdenticalSvcIdx(a,b),-1<c&&b.resources.splice(c,1))},_useProxy:function(a,b){return b&&b.isAdmin&&!t.hasSameOrigin(a.adminTokenServiceUrl,window.location.href)||!this._isPortalDomain(a.tokenServiceUrl)&&10.1==a.currentVersion&&!t.hasSameOrigin(a.tokenServiceUrl,window.location.href)},_getOrigin:function(a){a=new p(a);return a.scheme+"://"+a.host+(u.isDefined(a.port)?":"+a.port:"")},_getServerInstanceRoot:function(a){var b=a.toLowerCase(),c=b.indexOf(this._agsRest);-1===
c&&this._isAdminResource(a)&&(c=b.indexOf("/admin"));-1===c&&(c=b.indexOf("/sharing"));-1===c&&"/"===b.substr(-1)&&(c=b.length-1);return-1<c?a.substring(0,c):a},_hasSameServerInstance:function(a,b){"/"===a.substr(-1)&&(a=a.slice(0,-1));a=a.toLowerCase();b=this._getServerInstanceRoot(b).toLowerCase();a=a.substr(a.indexOf(":"));b=b.substr(b.indexOf(":"));return a===b},_sanitizeUrl:function(a){a=t.fixUrl(d.trim(a));var b=(g.defaults.io.proxyUrl||"").toLowerCase(),c=b?a.toLowerCase().indexOf(b+"?"):-1;
-1!==c&&(a=a.substring(c+b.length+1));return t.urlToObject(a).path},_isRESTService:function(a){return-1<a.indexOf(this._agsRest)},_isAdminResource:function(a){return this._agsAdmin.test(a)||this._adminSvcs.test(a)},_isServerRsrc:function(a){return this._isRESTService(a)||this._isAdminResource(a)},_isIdenticalService:function(a,b){var c;if(this._isRESTService(a)&&this._isRESTService(b)){var f=this._getSuffix(a).toLowerCase(),g=this._getSuffix(b).toLowerCase();c=f===g;c||(c=/(.*)\/(MapServer|FeatureServer).*/ig,
c=f.replace(c,"$1")===g.replace(c,"$1"))}else this._isAdminResource(a)&&this._isAdminResource(b)?c=!0:this._isServerRsrc(a)||this._isServerRsrc(b)||!this._isPortalDomain(a)||(c=!0);return c},_isPortalDomain:function(a){a=a.toLowerCase();var b=(new p(a)).authority,c=this._portalConfig,f=-1!==b.indexOf(this._agolSuffix);!f&&c&&(f=this._hasSameServerInstance(this._getServerInstanceRoot(c.restBaseUrl),a));f||(!this._arcgisUrl&&(c=d.getObject("esri.arcgis.utils.arcgisUrl"))&&(this._arcgisUrl=(new p(c)).authority),
this._arcgisUrl&&(f=this._arcgisUrl.toLowerCase()===b));f||(f=q.some(this._portals,function(b){return this._hasSameServerInstance(b,a)},this));return f=f||this._agsPortal.test(a)},_isIdProvider:function(a,b){var c=-1,f=-1;q.forEach(this._gwDomains,function(g,e){-1===c&&g.regex.test(a)&&(c=e);-1===f&&g.regex.test(b)&&(f=e)});var g=!1;if(-1<c&&-1<f)if(0===c||4===c){if(0===f||4===f)g=!0}else if(1===c){if(1===f||2===f)g=!0}else 2===c?2===f&&(g=!0):3===c&&3===f&&(g=!0);if(!g){var e=this.findServerInfo(b),
d=e&&e.owningSystemUrl;d&&y(e)&&this._isPortalDomain(d)&&this._isIdProvider(a,d)&&(g=!0)}return g},_isPublic:function(a){a=this._sanitizeUrl(a);return q.some(this._publicUrls,function(b){return b.test(a)})},_getIdenticalSvcIdx:function(a,b){var c=-1;q.some(b.resources,function(b,f){return this._isIdenticalService(a,b)?(c=f,!0):!1},this);return c},_getSuffix:function(a){return a.replace(this._regexSDirUrl,"").replace(this._regexServerType,"$1")},_getTokenSvcUrl:function(a){var b,c;if((b=this._isRESTService(a))||
this._isAdminResource(a))return c=a.toLowerCase().indexOf(b?this._agsRest:"/admin/"),b=a.substring(0,c)+"/admin/generateToken",a=a.substring(0,c)+"/rest/info",c=v({url:a,content:{f:"json"},handleAs:"json",callbackParamName:"callback"}),c.adminUrl_=b,c;if(this._isPortalDomain(a)){var f="";q.some(this._gwDomains,function(b){b.regex.test(a)&&(f=b.tokenServiceUrl);return!!f});f||q.some(this._portals,function(b){this._hasSameServerInstance(b,a)&&(f=b+this._gwTokenUrl);return!!f},this);f||(c=a.toLowerCase().indexOf("/sharing"),
-1!==c&&(f=a.substring(0,c)+this._gwTokenUrl));f||(f=this._getOrigin(a)+this._gwTokenUrl);f&&(b=(new p(a)).port,/^http:\/\//i.test(a)&&"7080"===b&&(f=f.replace(/:7080/i,":7443")),f=f.replace(/http:/i,"https:"));return f}if(-1!==a.toLowerCase().indexOf("premium.arcgisonline.com"))return"https://premium.arcgisonline.com/server/tokens"},_getPortalSelf:function(a,b){"https:"===window.location.protocol?a=a.replace(/^http:/i,"https:").replace(/:7080/i,":7443"):/^http:/i.test(b)&&(a=a.replace(/^https:/i,
"http:").replace(/:7443/i,":7080"));return v({url:a,content:{f:"json"},handleAs:"json",callbackParamName:"callback"},{crossOrigin:!1,disableIdentityLookup:!0})},_hasPortalSession:function(){return!!this._getEsriAuthCookie()},_getEsriAuthCookie:function(){var a;if(e.isSupported()){var b=this._getAllCookies("esri_auth"),c;for(c=0;c<b.length;c++){var f=m.fromJson(b[c]);if(f.portalApp){a=f;break}}}return a},_getAllCookies:function(a){var c=[],f=document.cookie.match(new RegExp("(?:^|; )"+b.escapeString(a)+
"\x3d([^;]*)","g"));if(f)for(a=0;a<f.length;a++){var g=f[a],e=g.indexOf("\x3d");-1<e&&(g=g.substring(e+1),c.push(decodeURIComponent(g)))}return c},_doPortalSignIn:function(a){if(e.isSupported()){var b=this._getEsriAuthCookie(),c=this._portalConfig,f=window.location.href,g=this.findServerInfo(a);if(this.useSignInPage&&(c||this._isPortalDomain(f)||b)&&(g?g.hasPortal||g.owningSystemUrl&&this._isPortalDomain(g.owningSystemUrl):this._isPortalDomain(a))&&(this._isIdProvider(f,a)||c&&(this._hasSameServerInstance(this._getServerInstanceRoot(c.restBaseUrl),
a)||this._isIdProvider(c.restBaseUrl,a))||t.hasSameOrigin(f,a,!0)))return!0}return!1},_checkProtocol:function(a,b,c,f){var e=!0;f=f?b.adminTokenServiceUrl:b.tokenServiceUrl;0!==d.trim(f).toLowerCase().indexOf("https:")||0===window.location.href.toLowerCase().indexOf("https:")||g.defaults.io.useCors&&(t.canUseXhr(f)||t.canUseXhr(t.getProxyUrl(!0).path))||(e=this._protocolFunc?!!this._protocolFunc({resourceUrl:a,serverInfo:b}):!1,e||(a=Error("Aborted the Sign-In process to avoid sending password over insecure connection."),
a.code="IdentityManagerBase.4",a.log=!!l.isDebug,console.log(a.message),c(a)));return e},_enqueue:function(a,b,c,g,e,d){g||(g=new k(f._dfdCanceller));g.resUrl_=a;g.sinfo_=b;g.options_=c;g.admin_=e;g.refresh_=d;this._busy?this._hasSameServerInstance(this._getServerInstanceRoot(a),this._busy.resUrl_)?(this._oAuthDfd&&this._oAuthDfd.oAuthWin_&&this._oAuthDfd.oAuthWin_.focus(),this._soReqs.push(g)):this._xoReqs.push(g):this._doSignIn(g);return g},_doSignIn:function(a){this._busy=a;var b=this,c=function(c){var f=
a.options_&&a.options_.resource,g=a.resUrl_,e=a.refresh_,d=!1;-1===q.indexOf(b.credentials,c)&&(e&&-1!==q.indexOf(b.credentials,e)?(e.userId=c.userId,e.token=c.token,e.expires=c.expires,e.validity=c.validity,e.ssl=c.ssl,e.creationTime=c.creationTime,d=!0,c=e):b.credentials.push(c));c.resources||(c.resources=[]);c.resources.push(f||g);c.scope=b._isServerRsrc(g)?"server":"portal";c.onTokenChange();var f=b._soReqs,h={};b._soReqs=[];q.forEach(f,function(a){if(!this._isIdenticalService(g,a.resUrl_)){var b=
this._getSuffix(a.resUrl_);h[b]||(h[b]=!0,c.resources.push(a.resUrl_))}},b);a.callback(c);q.forEach(f,function(a){this._hasSameServerInstance(this._getServerInstanceRoot(g),a.resUrl_)?a.callback(c):this._soReqs.push(a)},b);b._busy=a.resUrl_=a.sinfo_=a.refresh_=null;if(!d)b.onCredentialCreate({credential:c});b._soReqs.length?b._doSignIn(b._soReqs.shift()):b._xoReqs.length&&b._doSignIn(b._xoReqs.shift())},f=function(c){a.errback(c);b._busy=a.resUrl_=a.sinfo_=a.refresh_=null;b._soReqs.length?b._doSignIn(b._soReqs.shift()):
b._xoReqs.length&&b._doSignIn(b._xoReqs.shift())},g=function(g,e,d,h){var n=a.sinfo_,k=!a.options_||!1!==a.options_.prompt,t=n.hasPortal&&b._findOAuthInfo(a.resUrl_);b._doPortalSignIn(a.resUrl_)?(g=b._getEsriAuthCookie(),t=b._portalConfig,g?c(new C({userId:g.email,server:n.server,token:g.token,expires:null})):k?(k="",g=window.location.href,k=b.signInPage?b.signInPage:t?t.baseUrl+t.signin:b._isIdProvider(g,a.resUrl_)?b._getOrigin(g)+"/home/signin.html":n.tokenServiceUrl.replace(b._rePortalTokenSvc,
"")+"/home/signin.html",k=k.replace(/http:/i,"https:"),t&&!1===t.useSSL&&(k=k.replace(/https:/i,"http:")),0===g.toLowerCase().replace("https","http").indexOf(k.toLowerCase().replace("https","http"))?(n=Error("Cannot redirect to Sign-In page from within Sign-In page. URL of the resource that triggered this workflow: "+a.resUrl_),n.code="IdentityManagerBase.5",n.log=!!l.isDebug,f(n)):b._redirectFunc?b._redirectFunc({signInPage:k,returnUrlParamName:"returnUrl",returnUrl:g,resourceUrl:a.resUrl_,serverInfo:n}):
window.location=k+"?returnUrl\x3d"+window.escape(g)):(n=Error("User is not signed in."),n.code="IdentityManagerBase.6",n.log=!!l.isDebug,f(n))):g?c(new C({userId:g,server:n.server,token:d,expires:u.isDefined(h)?Number(h):null,ssl:!!e})):t?(g=t._oAuthCred,g||(e=new w(t,window.localStorage),d=new w(t,window.sessionStorage),e.isValid()&&d.isValid()?e.expires>d.expires?(g=e,d.destroy()):(g=d,e.destroy()):g=e.isValid()?e:d,t._oAuthCred=g),g.isValid()?c(new C({userId:g.userId,server:n.server,token:g.token,
expires:g.expires,ssl:g.ssl,_oAuthCred:g})):b._oAuthHash&&b._oAuthHash.state.portalUrl===t.portalUrl?(k=b._oAuthHash,n=new C({userId:k.username,server:n.server,token:k.access_token,expires:(new Date).getTime()+1E3*Number(k.expires_in),ssl:"true"===k.ssl,oAuthState:k.state,_oAuthCred:g}),g.storage=k.persist?window.localStorage:window.sessionStorage,g.token=n.token,g.expires=n.expires,g.userId=n.userId,g.ssl=n.ssl,g.save(),b._oAuthHash=null,c(n)):k?a._pendingDfd=b.oAuthSignIn(a.resUrl_,n,t,a.options_).addCallbacks(c,
f):(n=Error("User is not signed in."),n.code="IdentityManagerBase.6",n.log=!!l.isDebug,f(n))):k?b._checkProtocol(a.resUrl_,n,f,a.admin_)&&(k=a.options_,a.admin_&&(k=k||{},k.isAdmin=!0),a._pendingDfd=b.signIn(a.resUrl_,n,k).addCallbacks(c,f)):(n=Error("User is not signed in."),n.code="IdentityManagerBase.6",n.log=!!l.isDebug,f(n))},e=function(){var g=a.sinfo_,e=g.owningSystemUrl,d=a.options_,h,n,k,t;d&&(h=d.token,n=d.error,k=d.prompt);t=b._findCredential(e,{token:h,resource:a.resUrl_});!t&&y(g)&&q.some(b.credentials,
function(a){this._isIdProvider(e,a.server)&&(t=a);return!!t},b);t?(d=b.findCredential(a.resUrl_,t.userId))?c(d):B(g,b._legacyFed)?(d=t.toJson(),d.server=g.server,d.resources=null,c(new C(d))):(a._pendingDfd=b.generateToken(b.findServerInfo(t.server),null,{serverUrl:a.resUrl_,token:t.token,ssl:t.ssl})).addCallbacks(function(b){c(new C({userId:t.userId,server:g.server,token:b.token,expires:u.isDefined(b.expires)?Number(b.expires):null,ssl:!!b.ssl,isAdmin:a.admin_,validity:b.validity}))},f):(b._busy=
null,h&&(a.options_.token=null),(a._pendingDfd=b.getCredential(e.replace(/\/?$/,"/sharing"),{resource:a.resUrl_,owningTenant:g.owningTenant,token:h,error:n,prompt:k})).addCallbacks(function(c){b._enqueue(a.resUrl_,a.sinfo_,a.options_,a,a.admin_)},function(a){f(a)}))},h=a.sinfo_.owningSystemUrl,n=this._isServerRsrc(a.resUrl_),k=a.sinfo_._restInfoDfd;k?k.addCallbacks(function(c){var f=a.sinfo_;f.adminTokenServiceUrl=f._restInfoDfd.adminUrl_;f._restInfoDfd=null;f.tokenServiceUrl=d.getObject("authInfo.tokenServicesUrl",
!1,c)||d.getObject("authInfo.tokenServiceUrl",!1,c)||d.getObject("tokenServiceUrl",!1,c);f.shortLivedTokenValidity=d.getObject("authInfo.shortLivedTokenValidity",!1,c);f.currentVersion=c.currentVersion;f.owningTenant=c.owningTenant;(c=f.owningSystemUrl=c.owningSystemUrl)&&b._portals.push(c);n&&c?e():g()},function(){a.sinfo_._restInfoDfd=null;var b=Error("Unknown resource - could not find token service endpoint.");b.code="IdentityManagerBase.2";b.log=!!l.isDebug;f(b)}):n&&h?e():a.sinfo_._selfReq?a.sinfo_._selfReq.selfDfd.then(function(c){var f=
{},g,e,d,h;c&&(g=c.user&&c.user.username,f.username=g,f.allSSL=c.allSSL,e=c.supportsOAuth,d=c.currentVersion,"multitenant"===c.portalMode&&(h=c.customBaseUrl));a.sinfo_.webTierAuth=!!g;return g&&b.normalizeWebTierAuth?b.generateToken(a.sinfo_,null,{ssl:f.allSSL}).always(function(a){f.portalToken=a&&a.token;f.tokenExpiration=a&&a.expires;return f}):!g&&e&&4.4<=parseFloat(d)&&!b._doPortalSignIn(a.resUrl_)?b._generateOAuthInfo({portalUrl:a.sinfo_.server,customBaseUrl:h,owningTenant:a.sinfo_._selfReq.owningTenant}).always(function(){return f}):
f}).always(function(b){a.sinfo_._selfReq=null;b?g(b.username,b.allSSL,b.portalToken,b.tokenExpiration):g()}):g()},_generateOAuthInfo:function(a){var b=this,c,f=a.portalUrl,g=a.customBaseUrl,e=a.owningTenant;if(a=!this.defaultOAuthInfo&&this._createDefaultOAuthInfo&&!this._hasTestedIfAppIsOnPortal){c=window.location.href;var d=c.indexOf("?");-1<d&&(c=c.slice(0,d));d=c.search(/\/(apps|home)\//);c=-1<d?c.slice(0,d):null}a&&c?(this._hasTestedIfAppIsOnPortal=!0,a=v({url:c+"/sharing/rest",content:{f:"json"},
handleAs:"json"}).then(function(){b.defaultOAuthInfo=new z({appId:"arcgisonline",popup:!0,popupCallbackUrl:c+"/home/oauth-callback.html"})})):(a=new k,a.resolve(),a=a.promise);return a.then(function(){if(b.defaultOAuthInfo)return f=f.replace(/^http:/i,"https:"),v({url:f+"/sharing/rest/oauth2/validateRedirectUri",content:{accountId:e,client_id:b.defaultOAuthInfo.appId,redirect_uri:t.getAbsoluteUrl(b.defaultOAuthInfo.popupCallbackUrl),f:"json"},handleAs:"json",callbackParamName:"callback"}).then(function(a){if(a.valid){var c=
b.defaultOAuthInfo.clone();c.portalUrl=a.urlKey&&g?"https://"+a.urlKey+"."+g:f;b.oAuthInfos.push(c)}})})}});C=r(x,{declaredClass:"esri.Credential",tokenRefreshBuffer:2,constructor:function(a){d.mixin(this,a);this.resources=this.resources||[];u.isDefined(this.creationTime)||(this.creationTime=(new Date).getTime())},_oAuthCred:null,refreshToken:function(){var b=this,c=this.resources&&this.resources[0],f=a.id.findServerInfo(this.server),g=f&&f.owningSystemUrl,e=!!g&&"server"===this.scope,d=e&&B(f,a.id._legacyFed),
h=e&&a.id.findServerInfo(g),n,k=(n=f.webTierAuth)&&a.id.normalizeWebTierAuth,t=A[this.server],t=t&&t[this.userId],l={username:this.userId,password:t},m;if(!n||k)if(e&&!h&&q.some(a.id.serverInfos,function(b){a.id._isIdProvider(g,b.server)&&(h=b);return!!h}),n=h&&a.id.findCredential(h.server,this.userId),!e||n)if(d)n.refreshToken();else{if(e)m={serverUrl:c,token:n&&n.token,ssl:n&&n.ssl};else if(k)l=null,m={ssl:this.ssl};else if(t)this.isAdmin&&(m={isAdmin:!0});else{var p;c&&(c=a.id._sanitizeUrl(c),
this._enqueued=1,p=a.id._enqueue(c,f,null,null,this.isAdmin,this),p.addCallback(function(){b._enqueued=0;b.refreshServerTokens()}).addErrback(function(){b._enqueued=0}));return p}return a.id.generateToken(e?h:f,e?null:l,m).addCallback(function(a){b.token=a.token;b.expires=u.isDefined(a.expires)?Number(a.expires):null;b.creationTime=(new Date).getTime();b.validity=a.validity;b.onTokenChange();b.refreshServerTokens()}).addErrback(function(){})}},refreshServerTokens:function(){"portal"===this.scope&&
q.forEach(a.id.credentials,function(b){var c=a.id.findServerInfo(b.server),f=c&&c.owningSystemUrl;b!==this&&b.userId===this.userId&&f&&"server"===b.scope&&(a.id._hasSameServerInstance(this.server,f)||a.id._isIdProvider(f,this.server))&&(B(c,a.id._legacyFed)?(b.token=this.token,b.expires=this.expires,b.creationTime=this.creationTime,b.validity=this.validity,b.onTokenChange()):b.refreshToken())},this)},onTokenChange:function(b){clearTimeout(this._refreshTimer);var c=this.server&&a.id.findServerInfo(this.server),
f=(c=c&&c.owningSystemUrl)&&a.id.findServerInfo(c);!1!==b&&(!c||"portal"===this.scope||f&&f.webTierAuth&&!a.id.normalizeWebTierAuth)&&(u.isDefined(this.expires)||u.isDefined(this.validity))&&this._startRefreshTimer()},onDestroy:function(){},destroy:function(){this.userId=this.server=this.token=this.expires=this.validity=this.resources=this.creationTime=null;this._oAuthCred&&(this._oAuthCred.destroy(),this._oAuthCred=null);var b=q.indexOf(a.id.credentials,this);-1<b&&a.id.credentials.splice(b,1);this.onTokenChange();
this.onDestroy()},toJson:function(){return this._toJson()},_toJson:function(){var a=u.fixJson({userId:this.userId,server:this.server,token:this.token,expires:this.expires,validity:this.validity,ssl:this.ssl,isAdmin:this.isAdmin,creationTime:this.creationTime,scope:this.scope}),b=this.resources;b&&0<b.length&&(a.resources=b.slice());return a},_startRefreshTimer:function(){clearTimeout(this._refreshTimer);var a=6E4*this.tokenRefreshBuffer,b=(this.validity?this.creationTime+6E4*this.validity:this.expires)-
(new Date).getTime();0>b&&(b=0);this._refreshTimer=setTimeout(d.hitch(this,this.refreshToken),b>a?b-a:b)}});E.Credential=C;return E})},"esri/ServerInfo":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/has","./kernel","./lang"],function(r,l,d,q,k){return r(null,{declaredClass:"esri.ServerInfo",constructor:function(d){l.mixin(this,d)},toJson:function(){return k.fixJson({server:this.server,tokenServiceUrl:this.tokenServiceUrl,adminTokenServiceUrl:this.adminTokenServiceUrl,shortLivedTokenValidity:this.shortLivedTokenValidity,
owningSystemUrl:this.owningSystemUrl,owningTenant:this.owningTenant,currentVersion:this.currentVersion,hasPortal:this.hasPortal,hasServer:this.hasServer,webTierAuth:this.webTierAuth})}})})},"esri/OAuthCredential":function(){define(["./kernel","dojo/_base/declare","dojo/has","dojo/json"],function(r,l,d,q){return l(null,{declaredClass:"esri.OAuthCredential",oAuthInfo:null,storage:null,expires:null,ssl:null,token:null,userId:null,constructor:function(d,l){this.oAuthInfo=d;this.storage=l;this._init()},
isValid:function(){var d=!1;if(this.oAuthInfo&&this.token&&this.userId){var l=(new Date).getTime();this.expires>l&&(this.expires-l)/1E3>60*this.oAuthInfo.minTimeUntilExpiration&&(d=!0)}return d},save:function(){if(this.storage){var d=this._load(),l=this.oAuthInfo;if(l&&l.authNamespace&&l.portalUrl){var p=d[l.authNamespace];p||(p=d[l.authNamespace]={});p[l.portalUrl]={expires:this.expires,ssl:this.ssl,token:this.token,userId:this.userId};try{this.storage.setItem("esriJSAPIOAuth",q.stringify(d))}catch(h){console.log(h)}}}},
destroy:function(){var d=this._load(),l=this.oAuthInfo;if(l&&l.authNamespace&&l.portalUrl&&this.storage){var p=d[l.authNamespace];if(p){delete p[l.portalUrl];try{this.storage.setItem("esriJSAPIOAuth",q.stringify(d))}catch(h){console.log(h)}}}l&&(this.oAuthInfo=l._oAuthCred=null)},_init:function(){var d=this._load(),l=this.oAuthInfo;l&&l.authNamespace&&l.portalUrl&&(d=d[l.authNamespace])&&(d=d[l.portalUrl])&&(this.expires=d.expires,this.ssl=d.ssl,this.token=d.token,this.userId=d.userId)},_load:function(){var d=
{};if(this.storage){var l=this.storage.getItem("esriJSAPIOAuth");if(l)try{d=q.parse(l)}catch(p){console.log(p)}}return d}})})},"esri/arcgis/OAuthInfo":function(){define(["../kernel","../lang","dojo/_base/declare","dojo/_base/lang","dojo/has"],function(r,l,d,q,k){var m=d(null,{declaredClass:"esri.arcgis.OAuthInfo",constructor:function(d){q.mixin(this,{expiration:20160,minTimeUntilExpiration:30,portalUrl:"https://www.arcgis.com",authNamespace:"/",forceLogin:!1,popup:!1,popupCallbackUrl:"oauth-callback.html",
popupWindowFeatures:"height\x3d480,width\x3d800,location,resizable,scrollbars,status"},d)},_oAuthCred:null,toJson:function(){return l.fixJson({appId:this.appId,expiration:this.expiration,locale:this.locale,minTimeUntilExpiration:this.minTimeUntilExpiration,portalUrl:this.portalUrl,authNamespace:this.authNamespace,forceLogin:this.forceLogin,popup:this.popup,popupCallbackUrl:this.popupCallbackUrl,popupWindowFeatures:this.popupWindowFeatures})},clone:function(){return new m(this.toJson())}});return m})},
"dijit/form/Button":function(){define("require dojo/_base/declare dojo/dom-class dojo/has dojo/_base/kernel dojo/_base/lang dojo/ready ./_FormWidget ./_ButtonMixin dojo/text!./templates/Button.html ../a11yclick".split(" "),function(r,l,d,q,k,m,p,h,e,c){q("dijit-legacy-requires")&&p(0,function(){r(["dijit/form/DropDownButton","dijit/form/ComboButton","dijit/form/ToggleButton"])});p=l("dijit.form.Button"+(q("dojo-bidi")?"_NoBidi":""),[h,e],{showLabel:!0,iconClass:"dijitNoIcon",_setIconClassAttr:{node:"iconNode",
type:"class"},baseClass:"dijitButton",templateString:c,_setValueAttr:"valueNode",_setNameAttr:function(b){this.valueNode&&this.valueNode.setAttribute("name",b)},postCreate:function(){this.inherited(arguments);this._setLabelFromContainer()},_setLabelFromContainer:function(){this.containerNode&&!this.label&&(this.label=m.trim(this.containerNode.innerHTML),this.onLabelSet())},_setShowLabelAttr:function(b){this.containerNode&&d.toggle(this.containerNode,"dijitDisplayNone",!b);this._set("showLabel",b)},
setLabel:function(b){k.deprecated("dijit.form.Button.setLabel() is deprecated.  Use set('label', ...) instead.","","2.0");this.set("label",b)},onLabelSet:function(){this.inherited(arguments);this.showLabel||"title"in this.params||(this.titleNode.title=m.trim(this.containerNode.innerText||this.containerNode.textContent||""))}});q("dojo-bidi")&&(p=l("dijit.form.Button",p,{onLabelSet:function(){this.inherited(arguments);this.titleNode.title&&this.applyTextDir(this.titleNode,this.titleNode.title)},_setTextDirAttr:function(b){this._created&&
this.textDir!=b&&(this._set("textDir",b),this._setLabelAttr(this.label))}}));return p})},"dijit/form/_FormWidget":function(){define("dojo/_base/declare dojo/sniff dojo/_base/kernel dojo/ready ../_Widget ../_CssStateMixin ../_TemplatedMixin ./_FormWidgetMixin".split(" "),function(r,l,d,q,k,m,p,h){l("dijit-legacy-requires")&&q(0,function(){require(["dijit/form/_FormValueWidget"])});return r("dijit.form._FormWidget",[k,p,m,h],{setDisabled:function(e){d.deprecated("setDisabled("+e+") is deprecated. Use set('disabled',"+
e+") instead.","","2.0");this.set("disabled",e)},setValue:function(e){d.deprecated("dijit.form._FormWidget:setValue("+e+") is deprecated.  Use set('value',"+e+") instead.","","2.0");this.set("value",e)},getValue:function(){d.deprecated(this.declaredClass+"::getValue() is deprecated. Use get('value') instead.","","2.0");return this.get("value")},postMixInProperties:function(){this.nameAttrSetting=this.name&&!l("msapp")?'name\x3d"'+this.name.replace(/"/g,"\x26quot;")+'"':"";this.inherited(arguments)}})})},
"dijit/form/_FormWidgetMixin":function(){define("dojo/_base/array dojo/_base/declare dojo/dom-attr dojo/dom-style dojo/_base/lang dojo/mouse dojo/on dojo/sniff dojo/window ../a11y".split(" "),function(r,l,d,q,k,m,p,h,e,c){return l("dijit.form._FormWidgetMixin",null,{name:"",alt:"",value:"",type:"text","aria-label":"focusNode",tabIndex:"0",_setTabIndexAttr:"focusNode",disabled:!1,intermediateChanges:!1,scrollOnFocus:!0,_setIdAttr:"focusNode",_setDisabledAttr:function(b){this._set("disabled",b);/^(button|input|select|textarea|optgroup|option|fieldset)$/i.test(this.focusNode.tagName)?
d.set(this.focusNode,"disabled",b):this.focusNode.setAttribute("aria-disabled",b?"true":"false");this.valueNode&&d.set(this.valueNode,"disabled",b);b?(this._set("hovering",!1),this._set("active",!1),b="tabIndex"in this.attributeMap?this.attributeMap.tabIndex:"_setTabIndexAttr"in this?this._setTabIndexAttr:"focusNode",r.forEach(k.isArray(b)?b:[b],function(a){a=this[a];h("webkit")||c.hasDefaultTabStop(a)?a.setAttribute("tabIndex","-1"):a.removeAttribute("tabIndex")},this)):""!=this.tabIndex&&this.set("tabIndex",
this.tabIndex)},_onFocus:function(b){if("mouse"==b&&this.isFocusable())var a=this.own(p(this.focusNode,"focus",function(){d.remove();a.remove()}))[0],c=h("pointer-events")?"pointerup":h("MSPointer")?"MSPointerUp":h("touch-events")?"touchend, mouseup":"mouseup",d=this.own(p(this.ownerDocumentBody,c,k.hitch(this,function(b){d.remove();a.remove();this.focused&&("touchend"==b.type?this.defer("focus"):this.focus())})))[0];this.scrollOnFocus&&this.defer(function(){e.scrollIntoView(this.domNode)});this.inherited(arguments)},
isFocusable:function(){return!this.disabled&&this.focusNode&&"none"!=q.get(this.domNode,"display")},focus:function(){if(!this.disabled&&this.focusNode.focus)try{this.focusNode.focus()}catch(b){}},compare:function(b,a){return"number"==typeof b&&"number"==typeof a?isNaN(b)&&isNaN(a)?0:b-a:b>a?1:b<a?-1:0},onChange:function(){},_onChangeActive:!1,_handleOnChange:function(b,a){void 0!=this._lastValueReported||null!==a&&this._onChangeActive||(this._resetValue=this._lastValueReported=b);this._pendingOnChange=
this._pendingOnChange||typeof b!=typeof this._lastValueReported||0!=this.compare(b,this._lastValueReported);(this.intermediateChanges||a||void 0===a)&&this._pendingOnChange&&(this._lastValueReported=b,this._pendingOnChange=!1,this._onChangeActive&&(this._onChangeHandle&&this._onChangeHandle.remove(),this._onChangeHandle=this.defer(function(){this._onChangeHandle=null;this.onChange(b)})))},create:function(){this.inherited(arguments);this._onChangeActive=!0},destroy:function(){this._onChangeHandle&&
(this._onChangeHandle.remove(),this.onChange(this._lastValueReported));this.inherited(arguments)}})})},"dijit/form/_ButtonMixin":function(){define(["dojo/_base/declare","dojo/dom","dojo/has","../registry"],function(r,l,d,q){var k=r("dijit.form._ButtonMixin"+(d("dojo-bidi")?"_NoBidi":""),null,{label:"",type:"button",__onClick:function(d){d.stopPropagation();d.preventDefault();this.disabled||this.valueNode.click(d);return!1},_onClick:function(d){if(this.disabled)return d.stopPropagation(),d.preventDefault(),
!1;!1===this.onClick(d)&&d.preventDefault();var k=d.defaultPrevented;if(!k&&"submit"==this.type&&!(this.valueNode||this.focusNode).form)for(var h=this.domNode;h.parentNode;h=h.parentNode){var e=q.byNode(h);if(e&&"function"==typeof e._onSubmit){e._onSubmit(d);d.preventDefault();k=!0;break}}return!k},postCreate:function(){this.inherited(arguments);l.setSelectable(this.focusNode,!1)},onClick:function(){return!0},_setLabelAttr:function(d){this._set("label",d);(this.containerNode||this.focusNode).innerHTML=
d;this.onLabelSet()},onLabelSet:function(){}});d("dojo-bidi")&&(k=r("dijit.form._ButtonMixin",k,{onLabelSet:function(){this.inherited(arguments);this.applyTextDir(this.containerNode||this.focusNode)}}));return k})},"dijit/form/Form":function(){define("dojo/_base/declare dojo/dom-attr dojo/_base/kernel dojo/sniff ../_Widget ../_TemplatedMixin ./_FormMixin ../layout/_ContentPaneResizeMixin".split(" "),function(r,l,d,q,k,m,p,h){return r("dijit.form.Form",[k,m,p,h],{name:"",action:"",method:"",encType:"",
"accept-charset":"",accept:"",target:"",templateString:"\x3cform data-dojo-attach-point\x3d'containerNode' data-dojo-attach-event\x3d'onreset:_onReset,onsubmit:_onSubmit' ${!nameAttrSetting}\x3e\x3c/form\x3e",postMixInProperties:function(){this.nameAttrSetting=this.name?"name\x3d'"+this.name+"'":"";this.inherited(arguments)},execute:function(){},onExecute:function(){},_setEncTypeAttr:function(e){l.set(this.domNode,"encType",e);q("ie")&&(this.domNode.encoding=e);this._set("encType",e)},reset:function(e){var c=
{returnValue:!0,preventDefault:function(){this.returnValue=!1},stopPropagation:function(){},currentTarget:e?e.target:this.domNode,target:e?e.target:this.domNode};!1!==this.onReset(c)&&c.returnValue&&this.inherited(arguments,[])},onReset:function(){return!0},_onReset:function(e){this.reset(e);e.stopPropagation();e.preventDefault();return!1},_onSubmit:function(e){var c=this.constructor.prototype;if(this.execute!=c.execute||this.onExecute!=c.onExecute)d.deprecated("dijit.form.Form:execute()/onExecute() are deprecated. Use onSubmit() instead.",
"","2.0"),this.onExecute(),this.execute(this.getValues());!1===this.onSubmit(e)&&(e.stopPropagation(),e.preventDefault())},onSubmit:function(){return this.isValid()},submit:function(){!1!==this.onSubmit()&&this.containerNode.submit()}})})},"dijit/form/ValidationTextBox":function(){define("dojo/_base/declare dojo/_base/kernel dojo/_base/lang dojo/i18n ./TextBox ../Tooltip dojo/text!./templates/ValidationTextBox.html dojo/i18n!./nls/validate".split(" "),function(r,l,d,q,k,m,p){var h=r("dijit.form.ValidationTextBox",
k,{templateString:p,required:!1,promptMessage:"",invalidMessage:"$_unset_$",missingMessage:"$_unset_$",message:"",constraints:{},pattern:".*",regExp:"",regExpGen:function(){},state:"",tooltipPosition:[],_deprecateRegExp:function(e,c){c!=h.prototype[e]&&(l.deprecated("ValidationTextBox id\x3d"+this.id+", set('"+e+"', ...) is deprecated.  Use set('pattern', ...) instead.","","2.0"),this.set("pattern",c))},_setRegExpGenAttr:function(e){this._deprecateRegExp("regExpGen",e);this._set("regExpGen",this._computeRegexp)},
_setRegExpAttr:function(e){this._deprecateRegExp("regExp",e)},_setValueAttr:function(){this.inherited(arguments);this._refreshState()},validator:function(e,c){return(new RegExp("^(?:"+this._computeRegexp(c)+")"+(this.required?"":"?")+"$")).test(e)&&(!this.required||!this._isEmpty(e))&&(this._isEmpty(e)||void 0!==this.parse(e,c))},_isValidSubset:function(){return 0==this.textbox.value.search(this._partialre)},isValid:function(){return this.validator(this.textbox.value,this.get("constraints"))},_isEmpty:function(e){return(this.trim?
/^\s*$/:/^$/).test(e)},getErrorMessage:function(){var e="$_unset_$"==this.invalidMessage?this.messages.invalidMessage:this.invalidMessage?this.invalidMessage:this.promptMessage,c="$_unset_$"==this.missingMessage?this.messages.missingMessage:this.missingMessage?this.missingMessage:e;return this.required&&this._isEmpty(this.textbox.value)?c:e},getPromptMessage:function(){return this.promptMessage},_maskValidSubsetError:!0,validate:function(e){var c="",b=this.disabled||this.isValid(e);b&&(this._maskValidSubsetError=
!0);var a=this._isEmpty(this.textbox.value),g=!b&&e&&this._isValidSubset();this._set("state",b?"":((!this._hasBeenBlurred||e)&&a||g)&&(this._maskValidSubsetError||g&&!this._hasBeenBlurred&&e)?"Incomplete":"Error");this.focusNode.setAttribute("aria-invalid","Error"==this.state?"true":"false");"Error"==this.state?(this._maskValidSubsetError=e&&g,c=this.getErrorMessage(e)):"Incomplete"==this.state?(c=this.getPromptMessage(e),this._maskValidSubsetError=!this._hasBeenBlurred||e):a&&(c=this.getPromptMessage(e));
this.set("message",c);return b},displayMessage:function(e){e&&this.focused?m.show(e,this.domNode,this.tooltipPosition,!this.isLeftToRight()):m.hide(this.domNode)},_refreshState:function(){this._created&&this.validate(this.focused);this.inherited(arguments)},constructor:function(e){this.constraints=d.clone(this.constraints);this.baseClass+=" dijitValidationTextBox"},startup:function(){this.inherited(arguments);this._refreshState()},_setConstraintsAttr:function(e){!e.locale&&this.lang&&(e.locale=this.lang);
this._set("constraints",e);this._refreshState()},_setPatternAttr:function(e){this._set("pattern",e);this._refreshState()},_computeRegexp:function(e){var c=this.pattern;"function"==typeof c&&(c=c.call(this,e));if(c!=this._lastRegExp){var b="";this._lastRegExp=c;".*"!=c&&c.replace(/\\.|\[\]|\[.*?[^\\]{1}\]|\{.*?\}|\(\?[=:!]|./g,function(a){switch(a.charAt(0)){case "{":case "+":case "?":case "*":case "^":case "$":case "|":case "(":b+=a;break;case ")":b+="|$)";break;default:b+="(?:"+a+"|$)"}});try{"".search(b)}catch(a){b=
this.pattern,console.warn("RegExp error in "+this.declaredClass+": "+this.pattern)}this._partialre="^(?:"+b+")$"}return c},postMixInProperties:function(){this.inherited(arguments);this.messages=q.getLocalization("dijit.form","validate",this.lang);this._setConstraintsAttr(this.constraints)},_setDisabledAttr:function(e){this.inherited(arguments);this._refreshState()},_setRequiredAttr:function(e){this._set("required",e);this.focusNode.setAttribute("aria-required",e);this._refreshState()},_setMessageAttr:function(e){this._set("message",
e);this.displayMessage(e)},reset:function(){this._maskValidSubsetError=!0;this.inherited(arguments)},_onBlur:function(){this.displayMessage("");this.inherited(arguments)},destroy:function(){m.hide(this.domNode);this.inherited(arguments)}});return h})},"dijit/form/TextBox":function(){define("dojo/_base/declare dojo/dom-construct dojo/dom-style dojo/_base/kernel dojo/_base/lang dojo/on dojo/sniff ./_FormValueWidget ./_TextBoxMixin dojo/text!./templates/TextBox.html ../main".split(" "),function(r,l,
d,q,k,m,p,h,e,c,b){h=r("dijit.form.TextBox"+(p("dojo-bidi")?"_NoBidi":""),[h,e],{templateString:c,_singleNodeTemplate:'\x3cinput class\x3d"dijit dijitReset dijitLeft dijitInputField" data-dojo-attach-point\x3d"textbox,focusNode" autocomplete\x3d"off" type\x3d"${type}" ${!nameAttrSetting} /\x3e',_buttonInputDisabled:p("ie")?"disabled":"",baseClass:"dijitTextBox",postMixInProperties:function(){var a=this.type.toLowerCase();if(this.templateString&&"input"==this.templateString.toLowerCase()||("hidden"==
a||"file"==a)&&this.templateString==this.constructor.prototype.templateString)this.templateString=this._singleNodeTemplate;this.inherited(arguments)},postCreate:function(){this.inherited(arguments);9>p("ie")&&this.defer(function(){try{var a=d.getComputedStyle(this.domNode);if(a){var b=a.fontFamily;if(b){var c=this.domNode.getElementsByTagName("INPUT");if(c)for(a=0;a<c.length;a++)c[a].style.fontFamily=b}}}catch(n){}})},_setPlaceHolderAttr:function(a){this._set("placeHolder",a);this._phspan||(this._attachPoints.push("_phspan"),
this._phspan=l.create("span",{className:"dijitPlaceHolder dijitInputField"},this.textbox,"after"),this.own(m(this._phspan,"mousedown",function(a){a.preventDefault()}),m(this._phspan,"touchend, pointerup, MSPointerUp",k.hitch(this,function(){this.focus()}))));this._phspan.innerHTML="";this._phspan.appendChild(this._phspan.ownerDocument.createTextNode(a));this._updatePlaceHolder()},_onInput:function(a){this.inherited(arguments);this._updatePlaceHolder()},_updatePlaceHolder:function(){this._phspan&&
(this._phspan.style.display=this.placeHolder&&!this.textbox.value?"":"none")},_setValueAttr:function(a,b,c){this.inherited(arguments);this._updatePlaceHolder()},getDisplayedValue:function(){q.deprecated(this.declaredClass+"::getDisplayedValue() is deprecated. Use get('displayedValue') instead.","","2.0");return this.get("displayedValue")},setDisplayedValue:function(a){q.deprecated(this.declaredClass+"::setDisplayedValue() is deprecated. Use set('displayedValue', ...) instead.","","2.0");this.set("displayedValue",
a)},_onBlur:function(a){this.disabled||(this.inherited(arguments),this._updatePlaceHolder(),p("mozilla")&&this.selectOnClick&&(this.textbox.selectionStart=this.textbox.selectionEnd=void 0))},_onFocus:function(a){this.disabled||this.readOnly||(this.inherited(arguments),this._updatePlaceHolder())}});9>p("ie")&&(h.prototype._isTextSelected=function(){var a=this.ownerDocument.selection.createRange();return a.parentElement()==this.textbox&&0<a.text.length},b._setSelectionRange=e._setSelectionRange=function(a,
b,c){a.createTextRange&&(a=a.createTextRange(),a.collapse(!0),a.moveStart("character",-99999),a.moveStart("character",b),a.moveEnd("character",c-b),a.select())});p("dojo-bidi")&&(h=r("dijit.form.TextBox",h,{_setPlaceHolderAttr:function(a){this.inherited(arguments);this.applyTextDir(this._phspan)}}));return h})},"dijit/form/_FormValueWidget":function(){define(["dojo/_base/declare","dojo/sniff","./_FormWidget","./_FormValueMixin"],function(r,l,d,q){return r("dijit.form._FormValueWidget",[d,q],{_layoutHackIE7:function(){if(7==
l("ie"))for(var d=this.domNode,m=d.parentNode,p=d.firstChild||d,h=p.style.filter,e=this;m&&0==m.clientHeight;)(function(){var c=e.connect(m,"onscroll",function(){e.disconnect(c);p.style.filter=(new Date).getMilliseconds();e.defer(function(){p.style.filter=h})})})(),m=m.parentNode}})})},"dijit/form/_FormValueMixin":function(){define("dojo/_base/declare dojo/dom-attr dojo/keys dojo/_base/lang dojo/on ./_FormWidgetMixin".split(" "),function(r,l,d,q,k,m){return r("dijit.form._FormValueMixin",m,{readOnly:!1,
_setReadOnlyAttr:function(d){l.set(this.focusNode,"readOnly",d);this._set("readOnly",d)},postCreate:function(){this.inherited(arguments);void 0===this._resetValue&&(this._lastValueReported=this._resetValue=this.value)},_setValueAttr:function(d,h){this._handleOnChange(d,h)},_handleOnChange:function(d,h){this._set("value",d);this.inherited(arguments)},undo:function(){this._setValueAttr(this._lastValueReported,!1)},reset:function(){this._hasBeenBlurred=!1;this._setValueAttr(this._resetValue,!0)}})})},
"dijit/form/_TextBoxMixin":function(){define("dojo/_base/array dojo/_base/declare dojo/dom dojo/sniff dojo/keys dojo/_base/lang dojo/on ../main".split(" "),function(r,l,d,q,k,m,p,h){var e=l("dijit.form._TextBoxMixin"+(q("dojo-bidi")?"_NoBidi":""),null,{trim:!1,uppercase:!1,lowercase:!1,propercase:!1,maxLength:"",selectOnClick:!1,placeHolder:"",_getValueAttr:function(){return this.parse(this.get("displayedValue"),this.constraints)},_setValueAttr:function(c,b,a){var g;void 0!==c&&(g=this.filter(c),
"string"!=typeof a&&(a=null===g||"number"==typeof g&&isNaN(g)?"":this.filter(this.format(g,this.constraints)),0!=this.compare(g,this.filter(this.parse(a,this.constraints)))&&(a=null)));null==a||"number"==typeof a&&isNaN(a)||this.textbox.value==a||(this.textbox.value=a,this._set("displayedValue",this.get("displayedValue")));this.inherited(arguments,[g,b])},displayedValue:"",_getDisplayedValueAttr:function(){return this.filter(this.textbox.value)},_setDisplayedValueAttr:function(c){null==c?c="":"string"!=
typeof c&&(c=String(c));this.textbox.value=c;this._setValueAttr(this.get("value"),void 0);this._set("displayedValue",this.get("displayedValue"))},format:function(c){return null==c?"":c.toString?c.toString():c},parse:function(c){return c},_refreshState:function(){},onInput:function(){},_onInput:function(c){this._lastInputEventValue=this.textbox.value;this._processInput(this._lastInputProducingEvent||c);delete this._lastInputProducingEvent;this.intermediateChanges&&this._handleOnChange(this.get("value"),
!1)},_processInput:function(){this._refreshState();this._set("displayedValue",this.get("displayedValue"))},postCreate:function(){this.textbox.setAttribute("value",this.textbox.value);this.inherited(arguments);this.own(p(this.textbox,"keydown, keypress, paste, cut, compositionend",m.hitch(this,function(c){var b;if("keydown"==c.type&&229!=c.keyCode){b=c.keyCode;switch(b){case k.SHIFT:case k.ALT:case k.CTRL:case k.META:case k.CAPS_LOCK:case k.NUM_LOCK:case k.SCROLL_LOCK:return}if(!c.ctrlKey&&!c.metaKey&&
!c.altKey){switch(b){case k.NUMPAD_0:case k.NUMPAD_1:case k.NUMPAD_2:case k.NUMPAD_3:case k.NUMPAD_4:case k.NUMPAD_5:case k.NUMPAD_6:case k.NUMPAD_7:case k.NUMPAD_8:case k.NUMPAD_9:case k.NUMPAD_MULTIPLY:case k.NUMPAD_PLUS:case k.NUMPAD_ENTER:case k.NUMPAD_MINUS:case k.NUMPAD_PERIOD:case k.NUMPAD_DIVIDE:return}if(65<=b&&90>=b||48<=b&&57>=b||b==k.SPACE)return;b=!1;for(var a in k)if(k[a]===c.keyCode){b=!0;break}if(!b)return}}(b=32<=c.charCode?String.fromCharCode(c.charCode):c.charCode)||(b=65<=c.keyCode&&
90>=c.keyCode||48<=c.keyCode&&57>=c.keyCode||c.keyCode==k.SPACE?String.fromCharCode(c.keyCode):c.keyCode);b||(b=229);if("keypress"==c.type){if("string"!=typeof b)return;if("a"<=b&&"z">=b||"A"<=b&&"Z">=b||"0"<=b&&"9">=b||" "===b)if(c.ctrlKey||c.metaKey||c.altKey)return}var g={faux:!0},e;for(e in c)/^(layer[XY]|returnValue|keyLocation)$/.test(e)||(a=c[e],"function"!=typeof a&&"undefined"!=typeof a&&(g[e]=a));m.mixin(g,{charOrCode:b,_wasConsumed:!1,preventDefault:function(){g._wasConsumed=!0;c.preventDefault()},
stopPropagation:function(){c.stopPropagation()}});this._lastInputProducingEvent=g;!1===this.onInput(g)&&(g.preventDefault(),g.stopPropagation());if(!g._wasConsumed&&9>=q("ie"))switch(c.keyCode){case k.TAB:case k.ESCAPE:case k.DOWN_ARROW:case k.UP_ARROW:case k.LEFT_ARROW:case k.RIGHT_ARROW:break;default:c.keyCode==k.ENTER&&"textarea"!=this.textbox.tagName.toLowerCase()||this.defer(function(){this.textbox.value!==this._lastInputEventValue&&p.emit(this.textbox,"input",{bubbles:!0})})}})),p(this.textbox,
"input",m.hitch(this,"_onInput")),p(this.domNode,"keypress",function(c){c.stopPropagation()}))},_blankValue:"",filter:function(c){if(null===c)return this._blankValue;if("string"!=typeof c)return c;this.trim&&(c=m.trim(c));this.uppercase&&(c=c.toUpperCase());this.lowercase&&(c=c.toLowerCase());this.propercase&&(c=c.replace(/[^\s]+/g,function(b){return b.substring(0,1).toUpperCase()+b.substring(1)}));return c},_setBlurValue:function(){this._setValueAttr(this.get("value"),!0)},_onBlur:function(c){this.disabled||
(this._setBlurValue(),this.inherited(arguments))},_isTextSelected:function(){return this.textbox.selectionStart!=this.textbox.selectionEnd},_onFocus:function(c){this.disabled||this.readOnly||(this.selectOnClick&&"mouse"==c&&(this._selectOnClickHandle=p.once(this.domNode,"mouseup, touchend",m.hitch(this,function(b){this._isTextSelected()||e.selectInputText(this.textbox)})),this.own(this._selectOnClickHandle),this.defer(function(){this._selectOnClickHandle&&(this._selectOnClickHandle.remove(),this._selectOnClickHandle=
null)},500)),this.inherited(arguments),this._refreshState())},reset:function(){this.textbox.value="";this.inherited(arguments)}});q("dojo-bidi")&&(e=l("dijit.form._TextBoxMixin",e,{_setValueAttr:function(){this.inherited(arguments);this.applyTextDir(this.focusNode)},_setDisplayedValueAttr:function(){this.inherited(arguments);this.applyTextDir(this.focusNode)},_onInput:function(){this.applyTextDir(this.focusNode);this.inherited(arguments)}}));e._setSelectionRange=h._setSelectionRange=function(c,b,
a){c.setSelectionRange&&c.setSelectionRange(b,a)};e.selectInputText=h.selectInputText=function(c,b,a){c=d.byId(c);isNaN(b)&&(b=0);isNaN(a)&&(a=c.value?c.value.length:0);try{c.focus(),e._setSelectionRange(c,b,a)}catch(g){}};return e})},"dijit/Tooltip":function(){define("dojo/_base/array dojo/_base/declare dojo/_base/fx dojo/dom dojo/dom-class dojo/dom-geometry dojo/dom-style dojo/_base/lang dojo/mouse dojo/on dojo/sniff ./_base/manager ./place ./_Widget ./_TemplatedMixin ./BackgroundIframe dojo/text!./templates/Tooltip.html ./main".split(" "),
function(r,l,d,q,k,m,p,h,e,c,b,a,g,u,n,t,f,v){function x(){}var w=l("dijit._MasterTooltip",[u,n],{duration:a.defaultDuration,templateString:f,postCreate:function(){this.ownerDocumentBody.appendChild(this.domNode);this.bgIframe=new t(this.domNode);this.fadeIn=d.fadeIn({node:this.domNode,duration:this.duration,onEnd:h.hitch(this,"_onShow")});this.fadeOut=d.fadeOut({node:this.domNode,duration:this.duration,onEnd:h.hitch(this,"_onHide")})},show:function(a,b,c,f,e,d,n){if(!this.aroundNode||this.aroundNode!==
b||this.containerNode.innerHTML!=a)if("playing"==this.fadeOut.status())this._onDeck=arguments;else{this.containerNode.innerHTML=a;e&&this.set("textDir",e);this.containerNode.align=f?"right":"left";var k=g.around(this.domNode,b,c&&c.length?c:z.defaultPosition,!f,h.hitch(this,"orient")),t=k.aroundNodePos;"M"==k.corner.charAt(0)&&"M"==k.aroundCorner.charAt(0)?(this.connectorNode.style.top=t.y+(t.h-this.connectorNode.offsetHeight>>1)-k.y+"px",this.connectorNode.style.left=""):"M"==k.corner.charAt(1)&&
"M"==k.aroundCorner.charAt(1)?this.connectorNode.style.left=t.x+(t.w-this.connectorNode.offsetWidth>>1)-k.x+"px":(this.connectorNode.style.left="",this.connectorNode.style.top="");p.set(this.domNode,"opacity",0);this.fadeIn.play();this.isShowingNow=!0;this.aroundNode=b;this.onMouseEnter=d||x;this.onMouseLeave=n||x}},orient:function(a,c,f,g,e){this.connectorNode.style.top="";var d=g.h;g=g.w;a.className="dijitTooltip "+{"MR-ML":"dijitTooltipRight","ML-MR":"dijitTooltipLeft","TM-BM":"dijitTooltipAbove",
"BM-TM":"dijitTooltipBelow","BL-TL":"dijitTooltipBelow dijitTooltipABLeft","TL-BL":"dijitTooltipAbove dijitTooltipABLeft","BR-TR":"dijitTooltipBelow dijitTooltipABRight","TR-BR":"dijitTooltipAbove dijitTooltipABRight","BR-BL":"dijitTooltipRight","BL-BR":"dijitTooltipLeft"}[c+"-"+f];this.domNode.style.width="auto";var h=m.position(this.domNode);if(b("ie")||b("trident"))h.w+=2;m.setMarginBox(this.domNode,{w:Math.min(Math.max(g,1),h.w)});"B"==f.charAt(0)&&"B"==c.charAt(0)?(a=m.position(a),c=this.connectorNode.offsetHeight,
a.h>d?(this.connectorNode.style.top=d-(e.h+c>>1)+"px",this.connectorNode.style.bottom=""):(this.connectorNode.style.bottom=Math.min(Math.max(e.h/2-c/2,0),a.h-c)+"px",this.connectorNode.style.top="")):(this.connectorNode.style.top="",this.connectorNode.style.bottom="");return Math.max(0,h.w-g)},_onShow:function(){b("ie")&&(this.domNode.style.filter="")},hide:function(a){this._onDeck&&this._onDeck[1]==a?this._onDeck=null:this.aroundNode===a&&(this.fadeIn.stop(),this.isShowingNow=!1,this.aroundNode=
null,this.fadeOut.play());this.onMouseEnter=this.onMouseLeave=x},_onHide:function(){this.domNode.style.cssText="";this.containerNode.innerHTML="";this._onDeck&&(this.show.apply(this,this._onDeck),this._onDeck=null)}});b("dojo-bidi")&&w.extend({_setAutoTextDir:function(a){this.applyTextDir(a);r.forEach(a.children,function(a){this._setAutoTextDir(a)},this)},_setTextDirAttr:function(a){this._set("textDir",a);"auto"==a?this._setAutoTextDir(this.containerNode):this.containerNode.dir=this.textDir}});v.showTooltip=
function(a,b,c,f,g,e,d){c&&(c=r.map(c,function(a){return{after:"after-centered",before:"before-centered"}[a]||a}));z._masterTT||(v._masterTT=z._masterTT=new w);return z._masterTT.show(a,b,c,f,g,e,d)};v.hideTooltip=function(a){return z._masterTT&&z._masterTT.hide(a)};var z=l("dijit.Tooltip",u,{label:"",showDelay:400,hideDelay:400,connectId:[],position:[],selector:"",_setConnectIdAttr:function(a){r.forEach(this._connections||[],function(a){r.forEach(a,function(a){a.remove()})},this);this._connectIds=
r.filter(h.isArrayLike(a)?a:a?[a]:[],function(a){return q.byId(a,this.ownerDocument)},this);this._connections=r.map(this._connectIds,function(a){a=q.byId(a,this.ownerDocument);var b=this.selector,f=b?function(a){return c.selector(b,a)}:function(a){return a},g=this;return[c(a,f(e.enter),function(){g._onHover(this)}),c(a,f("focusin"),function(){g._onHover(this)}),c(a,f(e.leave),h.hitch(g,"_onUnHover")),c(a,f("focusout"),h.hitch(g,"set","state","DORMANT"))]},this);this._set("connectId",a)},addTarget:function(a){a=
a.id||a;-1==r.indexOf(this._connectIds,a)&&this.set("connectId",this._connectIds.concat(a))},removeTarget:function(a){a=r.indexOf(this._connectIds,a.id||a);0<=a&&(this._connectIds.splice(a,1),this.set("connectId",this._connectIds))},buildRendering:function(){this.inherited(arguments);k.add(this.domNode,"dijitTooltipData")},startup:function(){this.inherited(arguments);var a=this.connectId;r.forEach(h.isArrayLike(a)?a:[a],this.addTarget,this)},getContent:function(a){return this.label||this.domNode.innerHTML},
state:"DORMANT",_setStateAttr:function(a){if(!(this.state==a||"SHOW TIMER"==a&&"SHOWING"==this.state||"HIDE TIMER"==a&&"DORMANT"==this.state)){this._hideTimer&&(this._hideTimer.remove(),delete this._hideTimer);this._showTimer&&(this._showTimer.remove(),delete this._showTimer);switch(a){case "DORMANT":this._connectNode&&(z.hide(this._connectNode),delete this._connectNode,this.onHide());break;case "SHOW TIMER":"SHOWING"!=this.state&&(this._showTimer=this.defer(function(){this.set("state","SHOWING")},
this.showDelay));break;case "SHOWING":var b=this.getContent(this._connectNode);if(!b){this.set("state","DORMANT");return}z.show(b,this._connectNode,this.position,!this.isLeftToRight(),this.textDir,h.hitch(this,"set","state","SHOWING"),h.hitch(this,"set","state","HIDE TIMER"));this.onShow(this._connectNode,this.position);break;case "HIDE TIMER":this._hideTimer=this.defer(function(){this.set("state","DORMANT")},this.hideDelay)}this._set("state",a)}},_onHover:function(a){this._connectNode&&a!=this._connectNode&&
this.set("state","DORMANT");this._connectNode=a;this.set("state","SHOW TIMER")},_onUnHover:function(a){this.set("state","HIDE TIMER")},open:function(a){this.set("state","DORMANT");this._connectNode=a;this.set("state","SHOWING")},close:function(){this.set("state","DORMANT")},onShow:function(){},onHide:function(){},destroy:function(){this.set("state","DORMANT");r.forEach(this._connections||[],function(a){r.forEach(a,function(a){a.remove()})},this);this.inherited(arguments)}});z._MasterTooltip=w;z.show=
v.showTooltip;z.hide=v.hideTooltip;z.defaultPosition=["after-centered","before-centered"];return z})},"dijit/place":function(){define("dojo/_base/array dojo/dom-geometry dojo/dom-style dojo/_base/kernel dojo/_base/window ./Viewport ./main".split(" "),function(r,l,d,q,k,m,p){function h(c,b,a,g){var e=m.getEffectiveBox(c.ownerDocument);c.parentNode&&"body"==String(c.parentNode.tagName).toLowerCase()||k.body(c.ownerDocument).appendChild(c);var h=null;r.some(b,function(b){var f=b.corner,d=b.pos,n=0,k=
{w:{L:e.l+e.w-d.x,R:d.x-e.l,M:e.w}[f.charAt(1)],h:{T:e.t+e.h-d.y,B:d.y-e.t,M:e.h}[f.charAt(0)]},t=c.style;t.left=t.right="auto";a&&(n=a(c,b.aroundCorner,f,k,g),n="undefined"==typeof n?0:n);var m=c.style,u=m.display,p=m.visibility;"none"==m.display&&(m.visibility="hidden",m.display="");t=l.position(c);m.display=u;m.visibility=p;u={L:d.x,R:d.x-t.w,M:Math.max(e.l,Math.min(e.l+e.w,d.x+(t.w>>1))-t.w)}[f.charAt(1)];p={T:d.y,B:d.y-t.h,M:Math.max(e.t,Math.min(e.t+e.h,d.y+(t.h>>1))-t.h)}[f.charAt(0)];d=Math.max(e.l,
u);m=Math.max(e.t,p);u=Math.min(e.l+e.w,u+t.w)-d;p=Math.min(e.t+e.h,p+t.h)-m;n+=t.w-u+(t.h-p);if(null==h||n<h.overflow)h={corner:f,aroundCorner:b.aroundCorner,x:d,y:m,w:u,h:p,overflow:n,spaceAvailable:k};return!n});h.overflow&&a&&a(c,h.aroundCorner,h.corner,h.spaceAvailable,g);b=h.y;var t=h.x,f=k.body(c.ownerDocument);/relative|absolute/.test(d.get(f,"position"))&&(b-=d.get(f,"marginTop"),t-=d.get(f,"marginLeft"));f=c.style;f.top=b+"px";f.left=t+"px";f.right="auto";return h}var e={TL:"BR",TR:"BL",
BL:"TR",BR:"TL"};return p.place={at:function(c,b,a,g,d){a=r.map(a,function(a){var c={corner:a,aroundCorner:e[a],pos:{x:b.x,y:b.y}};g&&(c.pos.x+="L"==a.charAt(1)?g.x:-g.x,c.pos.y+="T"==a.charAt(0)?g.y:-g.y);return c});return h(c,a,d)},around:function(c,b,a,g,e){function n(a,b){E.push({aroundCorner:a,corner:b,pos:{x:{L:A,R:A+B,M:A+(B>>1)}[a.charAt(1)],y:{T:y,B:y+C,M:y+(C>>1)}[a.charAt(0)]}})}var k;if("string"==typeof b||"offsetWidth"in b||"ownerSVGElement"in b){if(k=l.position(b,!0),/^(above|below)/.test(a[0])){var f=
l.getBorderExtents(b),m=b.firstChild?l.getBorderExtents(b.firstChild):{t:0,l:0,b:0,r:0},u=l.getBorderExtents(c),p=c.firstChild?l.getBorderExtents(c.firstChild):{t:0,l:0,b:0,r:0};k.y+=Math.min(f.t+m.t,u.t+p.t);k.h-=Math.min(f.t+m.t,u.t+p.t)+Math.min(f.b+m.b,u.b+p.b)}}else k=b;if(b.parentNode)for(f="absolute"==d.getComputedStyle(b).position,b=b.parentNode;b&&1==b.nodeType&&"BODY"!=b.nodeName;){m=l.position(b,!0);u=d.getComputedStyle(b);/relative|absolute/.test(u.position)&&(f=!1);if(!f&&/hidden|auto|scroll/.test(u.overflow)){var p=
Math.min(k.y+k.h,m.y+m.h),z=Math.min(k.x+k.w,m.x+m.w);k.x=Math.max(k.x,m.x);k.y=Math.max(k.y,m.y);k.h=p-k.y;k.w=z-k.x}"absolute"==u.position&&(f=!0);b=b.parentNode}var A=k.x,y=k.y,B="w"in k?k.w:k.w=k.width,C="h"in k?k.h:(q.deprecated("place.around: dijit/place.__Rectangle: { x:"+A+", y:"+y+", height:"+k.height+", width:"+B+" } has been deprecated.  Please use { x:"+A+", y:"+y+", h:"+k.height+", w:"+B+" }","","2.0"),k.h=k.height),E=[];r.forEach(a,function(a){var b=g;switch(a){case "above-centered":n("TM",
"BM");break;case "below-centered":n("BM","TM");break;case "after-centered":b=!b;case "before-centered":n(b?"ML":"MR",b?"MR":"ML");break;case "after":b=!b;case "before":n(b?"TL":"TR",b?"TR":"TL");n(b?"BL":"BR",b?"BR":"BL");break;case "below-alt":b=!b;case "below":n(b?"BL":"BR",b?"TL":"TR");n(b?"BR":"BL",b?"TR":"TL");break;case "above-alt":b=!b;case "above":n(b?"TL":"TR",b?"BL":"BR");n(b?"TR":"TL",b?"BR":"BL");break;default:n(a.aroundCorner,a.corner)}});c=h(c,E,e,{w:B,h:C});c.aroundNodePos=k;return c}}})},
"esri/OAuthSignInHandler":function(){define("./Credential ./domUtils ./lang ./urlUtils dijit/Dialog dijit/registry dojo/_base/config dojo/_base/Deferred dojo/_base/kernel dojo/dom-attr dojo/i18n!./nls/jsapi dojo/io-query dojo/sniff dojo/json dijit/form/Button dojo/query".split(" "),function(r,l,d,q,k,m,p,h,e,c,b,a,g,u){return{_oAuthDfd:null,_oAuthIntervalId:0,_oAuthDialogContent:"\x3cdiv class\x3d'dijitDialogPaneContentArea'\x3e\x3cdiv style\x3d'padding-bottom: 5px; word-wrap: break-word;'\x3e${oAuthInfo}\x3c/div\x3e\x3cdiv style\x3d'margin: 0px; padding: 0px; height: 10px;'\x3e\x3c/div\x3e\x3cdiv class\x3d'esriErrorMsg' style\x3d'display: none; color: white; background-color: #D46464; text-align: center; padding-top: 3px; padding-bottom: 3px;'\x3e${invalidUser}\x3c/div\x3e\x3cdiv style\x3d'margin: 0px; padding: 0px; height: 10px;'\x3e\x3c/div\x3e\x3cdiv class\x3d'dijitDialogPaneActionBar'\x3e\x3cbutton data-dojo-type\x3d'dijit.form.Button' data-dojo-props\x3d'type:\"button\", \"class\":\"esriIdSubmit\"'\x3e${lblOk}\x3c/button\x3e\x3cbutton data-dojo-type\x3d'dijit.form.Button' data-dojo-props\x3d'type:\"button\", \"class\":\"esriIdCancel\"'\x3e${lblCancel}\x3c/button\x3e\x3c/div\x3e",
setOAuthRedirectionHandler:function(a){this._oAuthRedirectFunc=a},oAuthSignIn:function(a,g,f,e){var d=this._oAuthDfd=new h;d.resUrl_=a;d.sinfo_=g;d.oinfo_=f;var n=!e||!1!==e.oAuthPopupConfirmation;if(!f.popup||!n)return this._doOAuthSignIn(a,g,f),d;this._nls||(this._nls=b.identity);this.oAuthDialog||(this.oAuthDialog=this._createOAuthDialog());a=this.oAuthDialog;g=e&&e.error;e=e&&e.token;l.hide(a.errMsg_);g&&403==g.code&&e&&(c.set(a.errMsg_,"innerHTML",this._nls.forbidden),l.show(a.errMsg_));a.show();
return d},setOAuthResponseHash:function(b){var c=this._oAuthDfd;this._oAuthDfd=null;if(c&&b)if(clearInterval(this._oAuthIntervalId),"#"===b.charAt(0)&&(b=b.substring(1)),b=a.queryToObject(b),b.error)b=Error("access_denied"===b.error?"ABORTED":"OAuth: "+b.error+" - "+b.error_description),b.code="IdentityManagerBase.2",b.log=!!p.isDebug,c.errback(b);else{var f=c.oinfo_._oAuthCred,g=new r({userId:b.username,server:c.sinfo_.server,token:b.access_token,expires:(new Date).getTime()+1E3*Number(b.expires_in),
ssl:"true"===b.ssl,_oAuthCred:f});f.storage=b.persist?window.localStorage:window.sessionStorage;f.token=g.token;f.expires=g.expires;f.userId=g.userId;f.ssl=g.ssl;f.save();c.callback(g)}},_createOAuthDialog:function(){var a=this._nls,b=d.substitute(a,this._oAuthDialogContent),c=new k({title:a.title,content:b,"class":"esriOAuthSignInDialog",style:"min-width: 18em;",esriIdMgr_:this,execute_:function(){var a=c.esriIdMgr_._oAuthDfd;c.hide_();c.esriIdMgr_._doOAuthSignIn(a.resUrl_,a.sinfo_,a.oinfo_)},cancel_:function(){var a=
c.esriIdMgr_._oAuthDfd;c.esriIdMgr_._oAuthDfd=null;c.hide_();var b=Error("ABORTED");b.code="IdentityManager.2";b.log=!!p.isDebug;a.errback(b)},hide_:function(){l.hide(c.errMsg_);c.hide();k._DialogLevelManager.hide(c)}}),a=c.domNode;c.btnSubmit_=m.byNode(e.query(".esriIdSubmit",a)[0]);c.btnCancel_=m.byNode(e.query(".esriIdCancel",a)[0]);c.errMsg_=e.query(".esriErrorMsg",a)[0];c.connect(c.btnSubmit_,"onClick",c.execute_);c.connect(c.btnCancel_,"onClick",c.onCancel);c.connect(c,"onCancel",c.cancel_);
return c},_doOAuthSignIn:function(b,c,f){var e=this,d={client_id:f.appId,response_type:"token",state:u.stringify({portalUrl:f.portalUrl}),expiration:f.expiration,locale:f.locale,redirect_uri:f.popup?q.getAbsoluteUrl(f.popupCallbackUrl):window.location.href.replace(/#.*$/,"")};f.forceLogin&&(d.force_login=!0);var h=f.portalUrl.replace(/^http:/i,"https:")+"/sharing/oauth2/authorize",n=h+"?"+a.objectToQuery(d);if(f.popup){var k;7===g("ie")?(k=window.open(f.popupCallbackUrl,"esriJSAPIOAuth",f.popupWindowFeatures),
k.location=n):k=window.open(n,"esriJSAPIOAuth",f.popupWindowFeatures);k?(k.focus(),this._oAuthDfd.oAuthWin_=k,this._oAuthIntervalId=setInterval(function(){if(k.closed){clearInterval(e._oAuthIntervalId);var a=e._oAuthDfd;if(a){var b=Error("ABORTED");b.code="IdentityManager.2";b.log=!!p.isDebug;a.errback(b)}}},500)):(b=Error("ABORTED"),b.code="IdentityManager.2",b.log=!!p.isDebug,this._oAuthDfd.errback(b))}else this._oAuthRedirectFunc?this._oAuthRedirectFunc({authorizeParams:d,authorizeUrl:h,resourceUrl:b,
serverInfo:c,oAuthInfo:f}):window.location=n}}})},"jimu/dijit/Message":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/html dojo/keys dojo/on jimu/dijit/Popup".split(" "),function(r,l,d,q,k,m){return r(m,{baseClass:"jimu-popup jimu-message",declaredClass:"jimu.dijit.Message",type:"message",message:"",autoHeight:!0,maxWidth:350,maxHeight:180,postMixInProperties:function(){this.content=this.message},_createTitleNode:function(){this.titleLabel&&(this.titleNode=d.create("div",{"class":"title"},
this.domNode),this.titleLabeNode=d.create("span",{"class":"title-label jimu-float-leading",innerHTML:this.titleLabel||"\x26nbsp"},this.titleNode),this.closeBtnNode=d.create("div",{"class":"close-btn jimu-float-trailing"},this.titleNode),this.own(k(this.closeBtnNode,"click",l.hitch(this,this.close))))},_preProcessing:function(){0===this.buttons.length&&this.buttons.push({label:window.jimuNls.common.ok,key:q.ENTER,onClick:l.hitch(this,this.close)})},_increaseZIndex:function(){d.setStyle(this.domNode,
"zIndex",501);d.setStyle(this.overlayNode,"zIndex",500)}})})},"jimu/dijit/Popup":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/html dojo/_base/fx dojo/on dojo/sniff dojo/touch dojo/query dojo/dnd/move dijit/_WidgetBase jimu/utils".split(" "),function(r,l,d,q,k,m,p,h,e,c,b,a){var g=0;return r(b,{declaredClass:"jimu.dijit.Popup",baseClass:"jimu-popup",titleLabel:"",content:null,container:null,buttons:[],enabledButtons:[],disabledButtons:[],onClose:null,_fixedHeight:!1,
autoHeight:!1,maxHeight:800,maxWidth:1024,constructor:function(){this.buttons=[];this.enabledButtons=[];this.disabledButtons=[];this.pauseKeyHandles=[];this.container=jimuConfig.layoutId},postCreate:function(){this._preProcessing();this.inherited(arguments);this._initDomNode();this._positioning();q.place(this.domNode,this.container);setTimeout(l.hitch(this,function(){this._moveToMiddle()}),50);this.own(m(window,"resize",l.hitch(this,function(){this._fixedHeight||this.autoHeight?(this._calculatePosition(),
this._moveToMiddle()):this._positioning()})));this.overlayNode=q.create("div",{"class":"jimu-overlay"},this.container);this._increaseZIndex();k.animateProperty({node:this.domNode,properties:{opacity:1},duration:200}).play();this.domNode.focus()},_preProcessing:function(){"number"===typeof this.height&&(this._fixedHeight=!0,this.autoHeight=!1);this.autoHeight&&(this.maxHeight=598)},_createTitleNode:function(){this.titleNode=q.create("div",{"class":"title"},this.domNode);this.titleLabeNode=q.create("span",
{"class":"title-label jimu-float-leading",innerHTML:this.titleLabel||"\x26nbsp"},this.titleNode);this.closeBtnNode=q.create("div",{"class":"close-btn jimu-icon jimu-icon-close jimu-float-trailing"},this.titleNode);var a=null,a="ontouchstart"in document?h.press:"click";this.own(m(this.closeBtnNode,a,l.hitch(this,this.close)))},_initDomNode:function(){this._createTitleNode();this.contentContainerNode=q.create("div",{"class":"content"},this.domNode);this.content&&("string"===typeof this.content?this.contentContainerNode.innerHTML=
this.content:this.content.domNode?(this.content.placeAt(this.contentContainerNode),this.content.popup=this):1===this.content.nodeType&&q.place(this.content,this.contentContainerNode));this.buttonContainer=q.create("div",{"class":"button-container"},this.domNode);0===this.buttons.length&&q.setStyle(this.buttonContainer,"display","none");for(var a=this.buttons.length-1;-1<a;a--)this._createButton(this.buttons[a]),this.buttons[a].disable&&this.disableButton(a)},_limitButtonsMaxWidth:function(){var a=
this.enabledButtons.length;if(0!==a){var b=q.getContentBox(this.buttonContainer),c=q.getMarginExtents(this.enabledButtons[0]),f=q.getPadBorderExtents(this.enabledButtons[0]),g=0,f=8===p("ie")?f.l+f.r:0,g=(b.w-(c.l+c.r+f)*a)/a;0<g&&(d.forEach(this.enabledButtons,l.hitch(this,function(a){q.setStyle(a,"maxWidth",g+"px")})),d.forEach(this.disabledButtons,l.hitch(this,function(a){q.setStyle(a,"maxWidth",g+"px")})))}},_moveableNode:function(a,b){this.moveable&&(this.moveable.destroy(),this.moveable=null);
var g=q.getMarginBox(this.container);g.l=g.l-a+b;g.w+=2*(a-b);this.moveable=new c.boxConstrainedMoveable(this.domNode,{box:g,handle:this.titleNode||this.contentContainerNode,within:!0});this.own(m(this.moveable,"Moving",l.hitch(this,this.onMoving)));this.own(m(this.moveable,"MoveStop",l.hitch(this,this.onMoveStop)))},_getHeaderBox:function(){return 0===e("#header").length?{t:0,l:0,w:0,h:0}:q.getMarginBox("header")},_getFooterBox:function(){return 0===e(".footer",this.container).length?{t:0,l:0,w:0,
h:0}:q.getMarginBox(e(".footer",this.container)[0])},_calculatePosition:function(){var a=q.getContentBox(this.container),b=this._getHeaderBox(),c=this._getFooterBox(),c=a.h-b.h-c.h-40,f=0;f=this._fixedHeight?this.height:this.autoHeight?c-200:this.height=c>this.maxHeight?this.maxHeight:c;c=(c-f)/2+b.h+20;c=c<b.h?b.h:c;this.width=this.width||this.maxWidth;q.setStyle(this.domNode,{left:(a.w-this.width)/2+"px",top:c+"px",width:this.width+"px"})},_calculateHeight:function(){this.autoHeight?(q.setStyle(this.domNode,
"height","auto"),q.addClass(this.contentContainerNode,"content-static"),0===this.buttons.length&&q.setStyle(this.contentContainerNode,{marginBottom:"15px"})):(q.setStyle(this.domNode,"height",this.height+"px"),q.addClass(this.contentContainerNode,"content-absolute"),q.addClass(this.buttonContainer,"button-container-absolute"),0===this.buttons.length&&q.setStyle(this.contentContainerNode,{bottom:"15px"}));this._moveableNode(this.width,100)},_moveToMiddle:function(){if(this.autoHeight){var a=q.getMarginBox(this.domNode),
b=q.getContentBox(this.container),c=this._getHeaderBox(),f=this._getFooterBox(),f=b.h-c.h-f.h-40,g=0,g=a.h||f-200,a=(f-g)/2+c.h+20,a=a<c.h?c.h:a;q.setStyle(this.domNode,{left:(b.w-this.width)/2+"px",top:a+"px",width:this.width+"px"})}},_positioning:function(){this._calculatePosition();this._calculateHeight()},_increaseZIndex:function(){q.setStyle(this.domNode,"zIndex",g+200+1);q.setStyle(this.overlayNode,"zIndex",g+200);g++},setTitleLabel:function(b){this.titleNode.innerHTML=a.stripHTML(b)},onMoving:function(a){q.setStyle(a.node,
"opacity",.9)},onMoveStop:function(a){q.setStyle(a.node,"opacity",1)},close:function(){if(!this.onClose||!1!==this.onClose()){var a=this.domNode.parentNode,b=l.clone(this.domNode);q.setStyle(this.domNode,"display","none");q.destroy(this.overlayNode);this.destroy();this.moveable.destroy();q.place(b,a);k.animateProperty({node:b,properties:{opacity:0},duration:200,onEnd:function(){q.destroy(b)}}).play()}},addButton:function(a){this._createButton(a)},_createButton:function(a){var b=" ";a.classNames&&
0<a.classNames.length&&"function"===typeof a.classNames.join&&(b+=a.classNames.join(" "));var c=q.create("div",{"class":"jimu-btn jimu-popup-action-btn jimu-float-trailing jimu-trailing-margin1 "+b,innerHTML:a.label,title:a.title||a.label},this.buttonContainer);this.enabledButtons.unshift(c);b=q.create("div",{"class":"jimu-btn jimu-state-disabled jimu-float-trailing jimu-trailing-margin1 "+b,title:a.title||a.label,innerHTML:a.label,style:{display:"none"}},this.buttonContainer);this.disabledButtons.unshift(b);
this.own(m(c,"click",l.hitch(this,function(b){if(a.onClick)a.onClick(b);else this.close()})))},setButtonProps:function(a,b){"number"===typeof a&&isFinite(a)||(b=a,a=0);if(b&&0!==this.enabledButtons.length)for(var c in b)"title"===c?(q.setAttr(this.enabledButtons[a],"title",b[c]),q.setAttr(this.disabledButtons[a],"title",b[c])):"label"===c&&(q.setProp(this.enabledButtons[a],"innerHTML",b[c]),q.setProp(this.disabledButtons[a],"innerHTML",b[c]))},enableButton:function(a){"number"===typeof a&&isFinite(a)&&
a<this.enabledButtons.length?(q.setStyle(this.enabledButtons[a],"display","inline-block"),q.setStyle(this.disabledButtons[a],"display","none")):(d.forEach(this.enabledButtons[a],l.hitch(this,function(a){q.setStyle(a,"display","inline-block")})),d.forEach(this.disabledButtons[a],l.hitch(this,function(a){q.setStyle(a,"display","none")})))},disableButton:function(a){"number"===typeof a&&isFinite(a)&&a<this.disabledButtons.length?(q.setStyle(this.disabledButtons[a],"display","inline-block"),q.setStyle(this.enabledButtons[a],
"display","none")):(d.forEach(this.disabledButtons,l.hitch(this,function(a){q.setStyle(a,"display","inline-block")})),d.forEach(this.enabledButtons,l.hitch(this,function(a){q.setStyle(a,"display","none")})))},showButton:function(a){this.enableButton(a)},hideButton:function(a){"number"===typeof a&&isFinite(a)&&a<this.disabledButtons.length?(q.setStyle(this.disabledButtons[a],"display","none"),q.setStyle(this.enabledButtons[a],"display","none")):(d.forEach(this.disabledButtons,l.hitch(this,function(a){q.setStyle(a,
"display","none")})),d.forEach(this.enabledButtons,l.hitch(this,function(a){q.setStyle(a,"display","none")})))}})})},"dojo/dnd/move":function(){define("../_base/declare ../dom-geometry ../dom-style ./common ./Mover ./Moveable".split(" "),function(r,l,d,q,k,m){q=r("dojo.dnd.move.constrainedMoveable",m,{constraints:function(){},within:!1,constructor:function(d,h){h||(h={});this.constraints=h.constraints;this.within=h.within},onFirstMove:function(d){var h=this.constraintBox=this.constraints.call(this,
d);h.r=h.l+h.w;h.b=h.t+h.h;this.within&&(d=l.getMarginSize(d.node),h.r-=d.w,h.b-=d.h)},onMove:function(d,h){var e=this.constraintBox,c=d.node.style;this.onMoving(d,h);h.l=h.l<e.l?e.l:e.r<h.l?e.r:h.l;h.t=h.t<e.t?e.t:e.b<h.t?e.b:h.t;c.left=h.l+"px";c.top=h.t+"px";this.onMoved(d,h)}});k=r("dojo.dnd.move.boxConstrainedMoveable",q,{box:{},constructor:function(d,h){var e=h&&h.box;this.constraints=function(){return e}}});r=r("dojo.dnd.move.parentConstrainedMoveable",q,{area:"content",constructor:function(k,
h){var e=h&&h.area;this.constraints=function(){var c=this.node.parentNode,b=d.getComputedStyle(c),a=l.getMarginBox(c,b);if("margin"==e)return a;var g=l.getMarginExtents(c,b);a.l+=g.l;a.t+=g.t;a.w-=g.w;a.h-=g.h;if("border"==e)return a;g=l.getBorderExtents(c,b);a.l+=g.l;a.t+=g.t;a.w-=g.w;a.h-=g.h;if("padding"==e)return a;g=l.getPadExtents(c,b);a.l+=g.l;a.t+=g.t;a.w-=g.w;a.h-=g.h;return a}}});return{constrainedMoveable:q,boxConstrainedMoveable:k,parentConstrainedMoveable:r}})},"jimu/DataSourceManager":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/topic dojo/Evented dojo/when ./utils jimu/LayerInfos/LayerInfos esri/tasks/query esri/tasks/QueryTask esri/tasks/StatisticDefinition ./Query".split(" "),
function(r,l,d,q,k,m,p,h,e,c,b,a){var g=null,u=r(k,{constructor:function(){this._listeners=[];this._refreshTimers=[];this._dataStore={};this._jimuQueryObject={};this._dataSourceUsage={};window.isBuilder?(q.subscribe("app/mapLoaded",l.hitch(this,this._onMapLoaded)),q.subscribe("app/mapChanged",l.hitch(this,this._onMapChanged))):(q.subscribe("mapLoaded",l.hitch(this,this._onMapLoaded)),q.subscribe("mapChanged",l.hitch(this,this._onMapChanged)));window.isBuilder?(q.subscribe("app/appConfigLoaded",l.hitch(this,
this._onAppConfigLoaded)),q.subscribe("app/appConfigChanged",l.hitch(this,this._onAppConfigChanged))):(q.subscribe("appConfigLoaded",l.hitch(this,this._onAppConfigLoaded)),q.subscribe("appConfigChanged",l.hitch(this,this._onAppConfigChanged)));q.subscribe("updateDataSourceData",l.hitch(this,this._onUpdataDataSourceData));window.isBuilder&&q.subscribe("app/dataSourceDataUpdated",l.hitch(this,this._onDataSourceDataUpdatedInApp))},getData:function(a){return this._dataStore[a]},getDataSourceConfig:function(a){return this.appConfig.dataSource.dataSources[a]},
parseDataSourceId:function(a){var b=a.split("~"),c={};if(2>b.length)return console.error("Bad data source id:",a),c;switch(b[0]){case "map":return c={from:"map",layerId:b[1]};case "widget":return c={from:"widget",widgetId:b[1]};case "external":return c={from:"external"};default:console.error("Bad data source id:",a)}},addDataSourceUsage:function(a,b){this._dataSourceUsage[a]?(0>this._dataSourceUsage[a].indexOf(b)&&this._dataSourceUsage[a].push(b),1===this._dataSourceUsage[a].length&&this._startOneDataSource(this.appConfig.dataSource.dataSources[a])):
(this._dataSourceUsage[a]=[b],this._startOneDataSource(this.appConfig.dataSource.dataSources[a]))},removeDataSourceUsage:function(a,b){this._dataSourceUsage[a]&&0<=this._dataSourceUsage[a].indexOf(b)&&(this._dataSourceUsage[a]=d.filter(this._dataSourceUsage[a],function(a){return a!==b}))},_onUpdataDataSourceData:function(a,b){this.appConfig.dataSource.dataSources[a]?"widget"!==this.parseDataSourceId(a).from?console.error("Please update data source from widget only.",a):this._updateDataSourceData(a,
b):console.error("Not found data source id:",a)},_updateDataSourceData:function(a,b){this._dataStore[a]=b;q.publish("dataSourceDataUpdated",a,b);this.emit("update",a,b)},_onDataSourceDataUpdatedInApp:function(a,b){this._updateDataSourceData(a,b)},_onMapLoaded:function(a){this.map=a;window.isBuilder||this._handleDataSourceConfigChange(this.appConfig,this.appConfig,"mapLoaded")},_onMapChanged:function(a){this.map=a;window.isBuilder||this._handleDataSourceConfigChange(this.appConfig,this.appConfig,"mapChanged")},
_onAppConfigLoaded:function(a){this.appConfig=l.clone(a)},_onAppConfigChanged:function(a,b){var c=l.clone(a);window.isBuilder||("dataSourceChange"===b?this._handleDataSourceConfigChange(this.appConfig,c,b):"mapChange"===b&&this._cleanForConfigChangedDataSource(this.appConfig,c));this.appConfig=c},_handleDataSourceConfigChange:function(a,b,c){a&&(this._removeListeners(),this._removeTimers(),this._cleanForConfigChangedDataSource(a,b));d.forEach(Object.keys(b.dataSource.dataSources),function(a){b.dataSource.dataSources[a].idObj=
this.parseDataSourceId(a)},this);this._listenDataSourceChange(b.dataSource.dataSources);this._startRefreshTimer(b.dataSource,c);this._initStaticDataSource(b.dataSource)},_cleanForConfigChangedDataSource:function(a,b){var c=a.dataSource.dataSources,g=b.dataSource.dataSources;d.forEach(Object.keys(c),function(a){if(!g[a]||g[a]&&!p.isEqual(g[a],c[a]))delete this._jimuQueryObject[a],this._updateDataSourceData(a,{features:[]}),delete this._dataStore[a]},this)},_isGlobalRefresh:function(a){return a.unifiedRefreshInterval&&
0<a.unifiedRefreshInterval},_startOneDataSource:function(a){var b;b=this._isGlobalRefresh(this.appConfig.dataSource.settings)?this.appConfig.dataSource.settings.unifiedRefreshInterval:a.refreshInterval;if("map"===a.idObj.from)this._listenMapDataSourceChange(a);else if("external"===a.idObj.from&&a.filterByExtent){var c={};c.handle=this.map.on("extent-change",l.hitch(this,this._onLayerDataChange,a));c.dsId=a.id;this._listeners.push(c)}if("map"===a.idObj.from||"external"===a.idObj.from)this._refeshDataSource(a),
a.isDynamic&&(c={},c.handle=setInterval(l.hitch(this,this._refeshDataSource,a),6E4*b),c.dsId=a.id,this._refreshTimers.push(c))},_stopAndCleanOneDataSource:function(a){this._listeners=d.filter(this._listeners,function(b){return b.dsId===a.id?(b.handle.remove(),!1):!0},this);this._refreshTimers=d.filter(this._refreshTimers,function(b){return b.dsId===a.id?(clearInterval(b.handle),!1):!0},this);this._updateDataSourceData(a.id,{features:[]})},_listenDataSourceChange:function(a){d.forEach(Object.keys(a),
function(b){b=a[b];if("map"===b.idObj.from)this._listenMapDataSourceChange(b);else if("external"===b.idObj.from&&b.filterByExtent){var c={};c.handle=this.map.on("extent-change",l.hitch(this,this._onLayerDataChange,b));c.dsId=b.id;this._listeners.push(c)}},this)},_listenMapDataSourceChange:function(a){this._getLayerObject(a.idObj.layerId).then(l.hitch(this,function(b){if(b){var c={};c.handle=b.on("edits-complete",l.hitch(this,this._onLayerDataChange,a));c.dsId=a.id;this._listeners.push(c);a.filterByExtent&&
(c={},c.handle=this.map.on("extent-change",l.hitch(this,this._onLayerDataChange,a)),c.dsId=a.id,this._listeners.push(c))}else console.error("Can not find layer that data source depends on.",a.id)}))},_onLayerDataChange:function(a){this._doQueryForDataSource(a)},_doQueryForDataSource:function(a){("config"===this.appConfig.mode||this._dataSourceUsage[a.id]&&0!==this._dataSourceUsage[a.id].length)&&this.doQuery(a).then(l.hitch(this,function(b){this._updateDataSourceData(a.id,{features:b.features})}))},
_getLayerObject:function(a){return(a=h.getInstanceSync().getLayerOrTableInfoById(a))?a.getLayerObject():m(null)},_startRefreshTimer:function(a,b){var c=a.dataSources,g=a.settings;d.forEach(Object.keys(c),function(f){f=c[f];if("widget"!==f.idObj.from&&f.isDynamic&&f.url){var e;e=this._isGlobalRefresh(g)?g.unifiedRefreshInterval:f.refreshInterval;"dataSourceChange"===b?"external"!==f.idObj.from&&"map"!==f.idObj.from||this._refeshDataSource(f):"external"===f.idObj.from&&this._refeshDataSource(f);f={handle:setInterval(l.hitch(this,
this._refeshDataSource,f),6E4*e),dsId:a.id};this._refreshTimers.push(f)}},this)},_initStaticDataSource:function(a){d.forEach(Object.keys(a.dataSources),function(b){b=a.dataSources[b];"widget"!==b.idObj.from&&!b.isDynamic&&b.url&&this._doQueryForDataSource(b)},this)},_refeshDataSource:function(a){this._doQueryForDataSource(a)},_getDataSourceFilter:function(a){if("map"===a.idObj.from){var b=h.getInstanceSync().getLayerOrTableInfoById(a.idObj.layerId),c;b&&(c=b.getFilterOfWebmap());a=a.filter?a.filter.expr:
"1\x3d1";return c?"("+c+") and ("+a+")":a}return a.filter?a.filter.expr:"1\x3d1"},doQuery:function(g){g.idObj||(g.idObj=this.parseDataSourceId(g.id));var d,f;if("Features"===g.type){if("serviceLimitation"===g.resultRecordType)return d=this._getQueryObjectFromDataSource(g),f=new c(g.url),f.execute(d);d=this._jimuQueryObject[g.id];d||(d={},d.url=g.url,d.query=this._getQueryObjectFromDataSource(g),"all"!==g.resultRecordType&&(d.pageSize=g.resultRecordCount),d=new a(d),this._jimuQueryObject[g.id]=d);
return"all"===g.resultRecordType?d.getAllFeatures():d.queryByPage(1)}f=new c(g.url);d=new e;d.where=this._getDataSourceFilter(g);g.dataSchema.groupByFields&&0<g.dataSchema.groupByFields.length&&(d.groupByFieldsForStatistics=g.dataSchema.groupByFields);g.dataSchema.orderByFields&&0<g.dataSchema.orderByFields.length&&(d.orderByFields=g.dataSchema.orderByFields);d.outStatistics=g.dataSchema.statistics.map(function(a){var c=new b;c.statisticType=a.statisticType;c.onStatisticField=a.onStatisticField;c.outStatisticFieldName=
a.outStatisticFieldName;return c});return f.execute(d)},_getQueryObjectFromDataSource:function(a){var b=new e;b.where=this._getDataSourceFilter(a);a.filterByExtent&&(b.geometry=this.map.extent);b.outFields=a.dataSchema.fields.map(function(a){return a.name});a.dataSchema.orderByFields&&0<a.dataSchema.orderByFields.length&&(b.orderByFields=a.dataSchema.orderByFields);b.returnGeometry=!0;b.outSpatialReference=this.map.spatialReference;return b},_removeListeners:function(){this._listeners.forEach(l.hitch(this,
function(a){a.handle.remove()}));this._listeners=[]},_removeTimers:function(){this._refreshTimers.forEach(l.hitch(this,function(a){clearInterval(a.handle)}));this._refreshTimers=[]}});u.getInstance=function(){null===g&&(g=new u,window._datasourceManager=g);return g};return u})},"jimu/LayerInfos/LayerInfos":function(){define("dojo/_base/declare dojo/_base/array dojo/_base/lang dojo/Deferred dojo/on dojo/topic dojo/Evented dojo/promise/all ./LayerInfoFactory".split(" "),function(r,l,d,q,k,m,p,h,e){var c=
r([p],{map:null,_operLayers:null,_layerInfos:null,_finalLayerInfos:null,_tableInfos:null,_finalTableInfos:null,_basemapLayers:null,_unreachableLayersTitleOfWebmap:null,constructor:function(a,b){this._unreachableLayersTitleOfWebmap=[];this._basemapLayers=b.baseMap.baseMapLayers;this._operLayers=b.operationalLayers;this._tables=b.tables;this.map=a;this._initLayerInfos();this._initTablesInfos();this.update();this._bindEvents()},update:function(){this._extraSetLayerInfos();this._clearAddedFlag(this._layerInfos);
this._initFinalTableInfos();this._initFinalLayerInfos(this._layerInfos);this._markFirstOrLastNode()},getLayerInfoArrayOfWebmap:function(){var a=[];l.forEach(this.getLayerInfoArray(),function(b){for(var c=0;c<this._operLayers.length;c++)if(b.id===this._operLayers[c].id){a.push(b);break}c===this._operLayers.length&&0<=this._removedLayerInfoIdsFromFeatureCollection.indexOf(b.id)&&a.push(b)},this);return a},getTableInfoArrayOfWebmap:function(){var a=[];l.forEach(this.getTableInfoArray(),function(b){for(var c=
0;c<this._tables.length;c++)if(b.id===this._tables[c].id){a.push(b);break}},this);return a},getLayerInfoArray:function(){return l.filter(this._finalLayerInfos,function(a){return!a._isTemporaryLayerInfo})},getTableInfoArray:function(){return this._finalTableInfos},addFeatureCollection:function(a,b){var c=this._getUniqueTopLayerInfoId(b),g={layers:[]};l.forEach(a,function(a,b){a.id=c+"_"+b;g.layers.push({id:a.id,layerObject:a})},this);this.map.addLayers(a);var d;try{d=e.getInstance().create({featureCollection:g,
title:b||c,id:c},this.map),d.init()}catch(f){console.warn(f.message),d=null}d&&(d._extraOfWebmapLayerInfo=!0,this._layerInfos.push(d),this.update(),this._onUpdated())},addTable:function(a){var b=[];a=this._addTable(a,this._finalTableInfos);this._tableInfos.push(a);b.push(a);this._onTableChange(b,"added");return a},removeTable:function(a){var b=-1,c=!1;l.forEach(this._tableInfos,function(c,g){a.id===c.id&&(b=g)});0<=b&&(this._tableInfos.splice(b,1),c=!0);b=-1;l.forEach(this._finalTableInfos,function(c,
g){a.id===c.id&&(b=g)});0<=b&&(this._finalTableInfos.splice(b,1),c=!0);c&&this._onTableChange([a],"removed")},_addTable:function(a,b){var c;try{a.layerObject={url:a.url,featureCollectionData:a.featureCollectionData,empty:!0},a.id=this._getUniqueTableId(a.id),a.selfType="table",c=e.getInstance().create(a),c.init()}catch(n){console.warn(n.message),c=null}c&&b&&b.push(c);return c},_getUniqueTableId:function(a){var b=this._tableInfos.concat(this._finalTableInfos||[]);return this._getUniqueLayerOrTableId(a,
b)},_getUniqueTopLayerInfoId:function(a){return this._getUniqueLayerOrTableId(a,this._finalLayerInfos)},_getUniqueLayerOrTableId:function(a,b){var c=1,g;a||(a="table");for(g=a;;){for(var e=0;e<b.length&&b[e].id!==g;e++);if(e===b.length)return g;g=a+"_"+c.toString();c++}},_traversal:function(a,b){for(var c=0;c<b.length;c++)if(b[c].traversal(a))return!0;return!1},traversal:function(a){var b=this.getLayerInfoArray();return this._traversal(a,b)},traversalLayerInfosOfWebmap:function(a){var b=this.getLayerInfoArrayOfWebmap();
return this._traversal(a,b)},traversalAll:function(a){var b=this.getLayerInfoArray(),c=this.getTableInfoArray();return this._traversal(a,b.concat(c))},getLayerInfoById:function(a){return this._findLayerInfoById(a)},getTableInfoById:function(a){var b=null;l.some(this.getTableInfoArray(),function(c){if(c.id===a)return b=c,!0});return b},getLayerOrTableInfoById:function(a){var b=null;this.traversalAll(function(c){if(c.id===a)return b=c,!0});return b},getLayerInfoByTopLayerId:function(a){return this._findTopLayerInfoById(a)},
moveUpLayer:function(a,b){var c=null;b=b?b:1;var g=this._getTopLayerInfoIndexById(a.id);0<=g-b&&(c=this._finalLayerInfos[g-b].obtainLayerIndexesInMap().length,this._finalLayerInfos[g].moveLayerByIndex(this._finalLayerInfos[g-b].obtainLayerIndexesInMap()[c-1].index),c=this._finalLayerInfos[g-b],m.publish("layerInfos/layerReorder",g,b,"moveup"));return c},_reorderLayerInfosArray:function(a,b,c){"moveup"===c?(c=this._finalLayerInfos[a],this._finalLayerInfos.splice(a,1),this._finalLayerInfos.splice(a-
b,0,c)):(c=this._finalLayerInfos[a],this._finalLayerInfos.splice(a+b+1,0,c),this._finalLayerInfos.splice(a,1));this._markFirstOrLastNode()},moveDownLayer:function(a,b){var c=null;b=b?b:1;var g=this._getTopLayerInfoIndexById(a.id);g+b<=this._finalLayerInfos.length-1&&(this._finalLayerInfos[g].moveLayerByIndex(this._finalLayerInfos[g+b].obtainLayerIndexesInMap()[0].index),c=this._finalLayerInfos[g+b],m.publish("layerInfos/layerReorder",g,b,"movedown"));return c},getBasemapLayers:function(){var a=[];
l.forEach(this.map.layerIds.concat(this.map.graphicsLayerIds||[]),function(b){b=this.map.getLayer(b);"basemap"!==b._basemapGalleryLayerType&&"reference"!==b._basemapGalleryLayerType||a.push(b)},this);0===a.length&&(a=this._basemapLayers);return a},getMapNotesLayerInfoArray:function(){return l.filter(this.getLayerInfoArray(),function(a){return a.isMapNotesLayerInfo()},this)},restoreState:function(a){var b=a&&a.layerOptions?a.layerOptions:null;l.forEach(this._finalLayerInfos,function(a){a.resetLayerObjectVisibility(b)},
this)},getUnreachableLayersTitle:function(){return this._unreachableLayersTitleOfWebmap},_initLayerInfos:function(){var a;this._layerInfos=[];l.forEach(this._operLayers,function(b){try{a=e.getInstance().create(b),a.init()}catch(u){console.warn(u.message),a=null,this._unreachableLayersTitleOfWebmap.push(b.title)}a&&this._layerInfos.push(a)},this)},_extraSetLayerInfos:function(){this._removedLayerInfoIdsFromFeatureCollection=[];l.forEach(this._layerInfos,function(a,b){var c;if("esri.layers.GeoRSSLayer"===
a.layerObject.declaredClass||"esri.layers.KMLLayer"===a.layerObject.declaredClass){try{c=e.getInstance().create(a.originOperLayer),c.init()}catch(t){console.warn(t.message),c=null}c&&(a.destroyLayerInfo(),this._layerInfos[b]=c)}else if(a.originOperLayer.featureCollection){var g=[];l.forEach(a.getSubLayers(),function(a){g.push(a.id)});l.forEach(g,function(b){this.map.getLayer(b)||a.removeSubLayerById(b)},this);1===a.getSubLayers().length&&(c=a.getSubLayers()[0],this.map.getLayer(c.id).title=a.title,
a.removeSubLayerById(c.id),this._removedLayerInfoIdsFromFeatureCollection.push(c.id),a.id+="_logically_removed")}},this)},_initFinalLayerInfos:function(a){var b,c;this._finalLayerInfos=[];for(b=this.map.graphicsLayerIds.length-1;0<=b;b--)c=this.map.graphicsLayerIds[b],this._isBasemap(c)||this._addToFinalLayerInfos(this._findLayerInfoByIdAndReturnTopLayer(c,a),c,!0);for(b=this.map.layerIds.length-1;0<=b;b--)c=this.map.layerIds[b],this._isBasemap(c)||this._addToFinalLayerInfos(this._findLayerInfoByIdAndReturnTopLayer(c,
a),c,!1)},_initTablesInfos:function(){this._tableInfos=[];l.forEach(this._tables&&this._tables.reverse(),function(a){this._addTable(a,this._tableInfos)},this)},_initFinalTableInfos:function(){this._finalTableInfos=[];l.forEach(this._tableInfos,function(a){this._finalTableInfos.push(a)},this)},_isBasemap:function(a){for(var b=!1,c=this.getBasemapLayers(),e=0;e<c.length;e++)c[e].id===a&&(b=!0);return b},_addToFinalLayerInfos:function(a,b,c){var g;if(a)a._addedFlag||a.isGraphicLayer()!==c||(this._finalLayerInfos.push(a),
a._addedFlag=!0);else{a=this.map.getLayer(b);if("esri.layers.GraphicsLayer"!==a.declaredClass&&"esri.layers.LabelLayer"!==a.declaredClass){try{var h={layerObject:a,title:this._getLayerTitle(a),id:a.id||" "};d.mixin(h,d.getObject("_wabProperties.originOperLayer",!1,a));g=e.getInstance().create(h,this.map);g.init()}catch(f){console.warn(f.message),g=null}g&&(d.getObject("_wabProperties.isTemporaryLayer",!1,a)&&(g._isTemporaryLayerInfo=!0),this._finalLayerInfos.push(g))}("esri.layers.ArcGISDynamicMapServiceLayer"===
a.declaredClass||"esri.layers.ArcGISTiledMapServiceLayer"===a.declaredClass)&&g&&g._getServiceDefinition().then(d.hitch(this,function(a){var b=[];l.forEach(a.tables,function(a){a.url=g.getUrl()+"/"+a.id;a.id=g.id+"_"+a.id;a.title=this._getLayerTitle(a);(a=this._addTable(a,this._finalTableInfos))&&b.push(a)},this);this._onTableChange(b,"added")}))}},_getLayerTitle:function(a){if(a.title)return a.title;if(d.getObject("_wabProperties.originalLayerName",!1,a))return a.name||a.id;var b=a.label||a.name||
"";if(a.url){var c;c=a.url.indexOf("/FeatureServer");-1===c&&(c=a.url.indexOf("/MapServer"));-1===c&&(c=a.url.indexOf("/service"));-1<c&&(c=a.url.substring(0,c),c=c.substring(c.lastIndexOf("/")+1,c.length),b=b?c+" - "+b:c)}return b||a.id},_findLayerInfoByIdAndReturnTopLayer:function(a,b){var c,e=null;b||(b=this._finalLayerInfos);for(c=0;c<b.length;c++)if(e=b[c].findLayerInfoById(a)){e=b[c];break}return e},_findLayerInfoById:function(a,b){var c,e=null;b||(b=this._finalLayerInfos);for(c=0;c<b.length&&
!(e=b[c].findLayerInfoById(a));c++);return e},_findTopLayerInfoById:function(a){var b,c=null,e=this._finalLayerInfos.concat(this._finalTableInfos);for(b=0;b<e.length;b++)if(e[b].id===a){c=e[b];break}return c},_getTopLayerInfoIndexById:function(a){var b,c=-1;for(b=0;b<this._finalLayerInfos.length;b++)if(this._finalLayerInfos[b].id===a){c=b;break}return c},_clearAddedFlag:function(a){l.forEach(a,function(a){a._addedFlag=!1})},_markFirstOrLastNode:function(){var a;if(this._finalLayerInfos.length){for(a=
0;a<this._finalLayerInfos.length;a++)this._finalLayerInfos[a].isFirst=!1,this._finalLayerInfos[a].isLast=!1;this._finalLayerInfos[0].isFirst=!0;this._finalLayerInfos[this._finalLayerInfos.length-1].isLast=!0;for(a=0;a<this._finalLayerInfos.length;a++)if(!this._finalLayerInfos[a].isGraphicLayer()){a&&(this._finalLayerInfos[a-1].isLast=!0);this._finalLayerInfos[a].isFirst=!0;break}}},_onReceiveBasemapGalleryeData:function(a,b,c){"BasemapGallery"===a&&(this._basemapLayers.length=0,l.forEach(c,d.hitch(this,
function(a){this._basemapLayers.push({layerObject:a,id:a.id})}),this),this.update(),this.emit("layerInfosChanged"))},_onBasemapChange:function(a){var b;for(b=this._basemapLayers.length=0;b<a.layers.length;b++)this._basemapLayers.push({layerObject:a.layer[b],id:a.layers[b].id})},_destroyLayerInfos:function(){l.forEach(this._finalLayerInfos,d.hitch(this,function(a){a.destroyLayerInfo()}))},_bindEvents:function(){var a,b,c,e,h,f,l,p,q;a=k(this.map,"layer-add-result",d.hitch(this,this._onLayersChange,
"added"));b=k(this.map,"layer-remove",d.hitch(this,this._onLayersChange,"removed"));l=m.subscribe("layerInfos/layerReorder",d.hitch(this,this._onLayerReorder));e=m.subscribe("layerInfos/layerInfo/isShowInMapChanged",d.hitch(this,this._onShowInMapChanged));h=m.subscribe("layerInfos/layerInfo/visibleChanged",d.hitch(this,this._onVisibleChanged));f=m.subscribe("layerInfos/layerInfo/filterChanged",d.hitch(this,this._onFilterChanged));p=m.subscribe("layerInfos/layerInfo/rendererChanged",d.hitch(this,this._onRendererChanged));
q=m.subscribe("layerInfos/layerInfo/opacityChanged",d.hitch(this,this._onOpacityChanged));c=k(this.map,"before-unload",d.hitch(this,function(){a.remove();b.remove();l.remove();e.remove();h.remove();f.remove();p.remove();c.remove();q.remove();this._destroyLayerInfos()}))},_emitEvent:function(){try{this.emit.apply(this,arguments)}catch(a){console.error(a)}},_onLayersChange:function(a,b){var c=null,e;b.error||"esri.layers.GraphicsLayer"===b.layer.declaredClass||"esri.layers.LabelLayer"===b.layer.declaredClass||
b.layer._basemapGalleryLayerType||("added"===a?(this.update(),c=this._findTopLayerInfoById(b.layer.id),e=this._findLayerInfoById(b.layer.id)):(c=this._findTopLayerInfoById(b.layer.id),(e=this._findLayerInfoById(b.layer.id))&&e.destroyLayerInfo(),this.update()),this._emitEvent("layerInfosChanged",c,a,e))},_onShowInMapChanged:function(a){this._emitEvent("layerInfosIsShowInMapChanged",a)},_onVisibleChanged:function(a){this._emitEvent("layerInfosIsVisibleChanged",a)},_onFilterChanged:function(a){this._emitEvent("layerInfosFilterChanged",
a)},_onLayerReorder:function(a,b,c){this._reorderLayerInfosArray(a,b,c);this._emitEvent("layerInfosReorder")},_onRendererChanged:function(a){this._emitEvent("layerInfosRendererChanged",a)},_onOpacityChanged:function(a){this._emitEvent("layerInfosOpacityChanged",a)},_onTableChange:function(a,b){this._emitEvent("tableInfosChanged",a,b)},_onUpdated:function(){this._emitEvent("updated")}});c.getLayerInfoArrayByType=function(a,b){var e=new q,g=[],d=[];c.getInstance(a,a.iteminfo).then(function(a){a.traversal(function(a){var b=
a.getLayerType();b.layerInfo=a;g.push(b)});h(g).then(function(a){l.forEach(a,function(a,c){b===a&&d.push(g[c].layerInfo)});e.resolve(d)})});return e};var b={map:null,layerInfos:null};c.getInstance=function(a,b){var e=new q;e.resolve(c.getInstanceSyncForInit(a,b));return e};c.getInstanceSyncForInit=function(a,g){b.map&&b.map!==a&&(b={map:null,layerInfos:null});b.layerInfos||(e.getInstance(a,b),b.layerInfos=new c(a,g.itemData),b.map=a);return b.layerInfos};c.getInstanceSync=function(){return b.layerInfos};
c.setInstance=function(a,c){b.map=a;b.layerInfos=c};return c})},"jimu/LayerInfos/LayerInfoFactory":function(){define("dojo/_base/declare jimu/LayerInfos/LayerInfoForCollection jimu/LayerInfos/LayerInfoForMapService jimu/LayerInfos/LayerInfoForKML jimu/LayerInfos/LayerInfoForGeoRSS jimu/LayerInfos/LayerInfoForDefault jimu/LayerInfos/LayerInfoForWMS jimu/LayerInfos/LayerInfoForDefaultDynamic jimu/LayerInfos/LayerInfoForDefaultTile jimu/LayerInfos/LayerInfoForDefaultWMS jimu/LayerInfos/LayerInfoForDefaultTable jimu/LayerInfos/LayerInfoForDefaultImage jimu/LayerInfos/LayerInfoForDefaultStream".split(" "),
function(r,l,d,q,k,m,p,h,e,c,b,a,g){var u=null,n=r(null,{constructor:function(){},create:function(n){if(n.featureCollection)return new l(n,this.map,this,this.layerInfosInstanceWrap);if("esri.layers.KMLLayer"===n.layerObject.declaredClass)return new q(n,this.map,this,this.layerInfosInstanceWrap);if("esri.layers.GeoRSSLayer"===n.layerObject.declaredClass)return new k(n,this.map,this,this.layerInfosInstanceWrap);if("esri.layers.WMSLayer"!==n.layerObject.declaredClass||n.selfType){if("esri.layers.ArcGISDynamicMapServiceLayer"===
n.layerObject.declaredClass||"esri.layers.ArcGISTiledMapServiceLayer"===n.layerObject.declaredClass)return new d(n,this.map,this,this.layerInfosInstanceWrap);if("esri.layers.ArcGISImageServiceLayer"===n.layerObject.declaredClass||"esri.layers.ArcGISImageServiceVectorLayer"===n.layerObject.declaredClass)return new a(n,this.map,this,this.layerInfosInstanceWrap);if("esri.layers.StreamLayer"===n.layerObject.declaredClass)return new g(n,this.map,this,this.layerInfosInstanceWrap);"Table"===n.layerObject.type&&
(n.selfType="table");switch(n.selfType){case "mapservice_dynamic_group":case "mapservice_dynamic":return new h(n,this.map,this,this.layerInfosInstanceWrap);case "mapservice_tiled_group":case "mapservice_tiled":return new e(n,this.map,this,this.layerInfosInstanceWrap);case "wms":return new c(n,this.map,this,this.layerInfosInstanceWrap);case "table":return new b(n,this.map,this,this.layerInfosInstanceWrap);default:return new m(n,this.map,this,this.layerInfosInstanceWrap)}}else return new p(n,this.map,
this,this.layerInfosInstanceWrap)}});n.getInstance=function(a,b){null===u&&(u=new n);a&&(u.map=a);b&&(u.layerInfosInstanceWrap=b);return u};return n})},"jimu/LayerInfos/LayerInfoForCollection":function(){define("dojo/_base/declare dojo/_base/array dojo/_base/lang esri/graphicsUtils ./LayerInfo esri/lang".split(" "),function(r,l,d,q,k,m){return r(k,{constructor:function(){this.layerObject={declaredClass:"esri.layers.FeatureCollection",type:"FeatureCollection",empty:!0}},getExtent:function(){var d=
[],h;l.forEach(this.originOperLayer.featureCollection.layers,function(e){d=d.concat(e.layerObject.graphics)});0===d.length?h=null:(h=1===d.length?d[0].getLayer().fullExtent:q.graphicsExtent(d),h=this._convertGeometryToMapSpatialRef(h));return h},_resetLayerObjectVisiblity:function(d){var h=d?d[this.id]:null;if(h){var e={},c;for(c in d)d.hasOwnProperty(c)&&"function"!==typeof d[c]&&(e[c]=d[c].visible);this._setSubLayerVisibleByCheckedInfo(e);this._setTopLayerVisible(h.visible)}},_setSubLayerVisibleByCheckedInfo:function(d){l.forEach(this.newSubLayers,
function(h){m.isDefined(d[h.id])&&h.layerObject.setVisibility(d[h.id])},this)},_initVisible:function(){var d=!1,h;for(h=0;h<this.newSubLayers.length;h++)d=d||this.newSubLayers[h].layerObject.visible;d&&(this._visible=!0)},_setTopLayerVisible:function(d){this._visible=d?!0:!1;l.forEach(this.newSubLayers,function(d){d.setLayerVisiblefromTopLayer()},this);this._onVisibilityChanged()},obtainNewSubLayers:function(){var k=[];l.forEach(this.originOperLayer.featureCollection.layers,function(h){this._getLayerIndexesInMapByLayerId(h.layerObject.id)&&
(d.setObject("_wabProperties.originOperLayer.showLegend",this.originOperLayer.featureCollection.showLegend,h.layerObject),h=this._layerInfoFactory.create({layerObject:h.layerObject,title:h.layerObject.label||h.layerObject.title||h.layerObject.name||h.layerObject.id||" ",id:h.id||"-",subId:h.id||"-",collection:{layerInfo:this},selfType:"collection",showLegend:this.originOperLayer.featureCollection.showLegend,parentLayerInfo:this}),k.push(h),h.init())},this);k.reverse();return k},_obtainLayerIndexesInMap:function(){var d=
[],h,e;for(e=0;e<this.newSubLayers.length;e++)(h=this._getLayerIndexesInMapByLayerId(this.newSubLayers[e].layerObject.id))&&d.push(h);return d},moveLeftOfIndex:function(d){var h;for(h=this.newSubLayers.length-1;0<=h;h--)this.map.reorderLayer(this.newSubLayers[h].layerObject,d)},moveRightOfIndex:function(d){var h;for(h=0;h<this.newSubLayers.length;h++)this.map.reorderLayer(this.newSubLayers[h].layerObject,d)},_getShowLegendOfWebmap:function(){return void 0!==this.originOperLayer.featureCollection.showLegend?
this.originOperLayer.featureCollection.showLegend:!0},getScaleRange:function(){var d=this.getSubLayers();return d[0]?d[0].getScaleRange():{minScale:0,maxScale:0}}})})},"jimu/LayerInfos/LayerInfo":function(){define("dojo/_base/declare dojo/_base/array dojo/_base/lang dojo/Deferred dojo/promise/all dojo/dom-construct dojo/topic dojo/aspect jimu/portalUrlUtils jimu/portalUtils ./RequestBuffer esri/request esri/config esri/tasks/ProjectParameters esri/SpatialReference esri/geometry/webMercatorUtils".split(" "),
function(r,l,d,q,k,m,p,h,e,c,b,a,g,u,n,t){var f=r(null,{originOperLayer:null,layerObject:null,map:null,title:null,id:null,subId:null,newSubLayers:null,parentLayerInfo:null,_oldIsShowInMap:null,_oldFilter:null,_eventHandles:null,_subLayerInfoIndex:null,_serviceDefinitionBuffer:null,constructor:function(a,b,c,f){this.originOperLayer=a;this.layerObject=a.layerObject;this.map=b;this.title=this.originOperLayer.title;this.id=this.originOperLayer.id;this.subId=void 0!==this.originOperLayer.subId?this.originOperLayer.subId:
this.id;this.parentLayerInfo=a.parentLayerInfo?a.parentLayerInfo:null;this._eventHandles=[];this._layerInfoFactory=c;this._layerInfosInstanceWrap=f},init:function(){this.newSubLayers=this.obtainNewSubLayers();this._initSubLayerInfoIndex();this._initVisible();this.originOperLayer.popupInfo&&(this.popupVisible=!0);this._oldIsShowInMap=this.isShowInMap();this._initOldFilter();this._initServiceDefinitionBuffer();this._bindEvent()},_initOldFilter:function(){this._oldFilter=null},_initServiceDefinitionBuffer:function(){this._serviceDefinitionBuffer=
new b(d.hitch(this,this._serviceDefinitionRequest))},isGraphicLayer:function(){var a=this._obtainLayerIndexesInMap();return a.length?a[0].isGraphicLayer:!1},obtainLayerIndexesInMap:function(){return this._obtainLayerIndexesInMap()},getExtent:function(){},getOpacity:function(){var a,b=0;for(a=0;a<this.newSubLayers.length;a++)if(this.newSubLayers[a].layerObject.opacity)b=this.newSubLayers[a].layerObject.opacity>b?this.newSubLayers[a].layerObject.opacity:b;else return 1;return b},setOpacity:function(a){l.forEach(this.newSubLayers,
function(b){b.layerObject.setOpacity&&b.layerObject.setOpacity(a)})},moveLayerByIndex:function(a){this.map.reorderLayer(this.layerObject,a)},traversal:function(a){if(a(this))return!0;for(var b=this.getSubLayers(),c=0;c<b.length;c++)if(b[c].traversal(a))return!0},findLayerInfoById:function(a){var b=null,c=0;if(this.id&&this.id===a)return this;for(c=0;c<this.newSubLayers.length&&!(b=this.newSubLayers[c].findLayerInfoById(a));c++);return b},setTopLayerVisible:function(a){this._setTopLayerVisible(a)},
_setTopLayerVisible:function(a){},_setSubLayerVisible:function(a,b){},setLayerVisiblefromTopLayer:function(){},_resetLayerObjectVisiblity:function(){},resetLayerObjectVisibility:function(a){var b=a?a[this.id]:null;this.isRootLayer&&b&&this._resetLayerObjectVisiblity(a)},_initVisible:function(){},isVisible:function(){return this._visible?!0:!1},show:function(){this._setTopLayerVisible(!0)},hide:function(){this._setTopLayerVisible(!1)},_obtainLayerIndexesInMap:function(){var a=[],b;(b=this._getLayerIndexesInMapByLayerId(this.id))&&
a.push(b);return a},_getLayerIndexesInMapByLayerId:function(a){var b;for(b=0;b<this.map.graphicsLayerIds.length;b++)if(this.map.graphicsLayerIds[b]===a)return{isGraphicLayer:!0,index:b};for(b=0;b<this.map.layerIds.length;b++)if(this.map.layerIds[b]===a)return{isGraphicLayer:!1,index:b};return null},_convertGeometryToMapSpatialRef:function(a){var b=new q;if(this.map.spatialReference.equals(a.spatialReference))return b.resolve([a]),b;if(this.map.spatialReference.isWebMercator()&&a.spatialReference.equals(new n(4326)))return b.resolve([t.geographicToWebMercator(a)]),
b;if(this.map.spatialReference.equals(new n(4326))&&a.spatialReference.isWebMercator())return b.resolve([t.webMercatorToGeographic(a)]),b;b=new u;b.geometries=[a];b.outSR=this.map.spatialReference;return g.defaults.geometryService.project(b)},_isShowInMapChanged:function(){var a=!1,b=this.isShowInMap();!1===b&&this.map.infoWindow.hide();this._oldIsShowInMap!==b&&(this._oldIsShowInMap=b,a=!0);return a},_isShowInMapChanged2:function(){var a=[];this.traversal(function(b){b._isShowInMapChanged()&&a.push(b)});
p.publish("layerInfos/layerInfo/isShowInMapChanged",a)},_visibleChanged:function(){p.publish("layerInfos/layerInfo/visibleChanged",[this])},_initSubLayerInfoIndex:function(){var a={};this.isRootLayer()&&this.traversal(function(b){b.isRootLayer()||(a[b.subId]=b)});this._subLayerInfoIndex=a},_getLayerInfosObj:function(){return this._layerInfosInstanceWrap.layerInfos},obtainNewSubLayers:function(){return[]},createLegendsNode:function(){return m.create("div",{"class":"legends-div"})},drawLegends:function(a,
b){},_getLayerTypesOfSupportTable:function(){return"FeatureLayer,CSVLayer,Table,ArcGISImageServiceLayer,StreamLayer,ArcGISImageServiceVectorLayer"},_getShowLegendOfWebmap:function(){return void 0!==this.originOperLayer.showLegend?this.originOperLayer.showLegend:!0},_getServiceDefinition:function(){var a=new q;a.resolve(null);return a},_serviceDefinitionRequest:function(a){return this._normalRequest(a,{f:"json"},"json")},getServiceDefinition:function(){return this._getServiceDefinition()},_normalRequest:function(b,
c,f){return a({url:b,content:c,handleAs:f,callbackParamName:"callback"})},getLayerObject:function(){var a=new q;this.layerObject?a.resolve(this.layerObject):a.resolve(null);return a},getSubLayers:function(){return this.newSubLayers},isLeaf:function(){return 0===this.getSubLayers().length?!0:!1},isRootLayer:function(){return this.parentLayerInfo?!1:!0},getRootLayerInfo:function(){for(var a=this;a.parentLayerInfo;)a=a.parentLayerInfo;return a},isShowInMap:function(){for(var a=!0,b=this;b;)a=a&&b.isVisible(),
b=b.parentLayerInfo;return a},getLayerType:function(){var a=[null],b=new q;this.layerObject.declaredClass&&(a=this.layerObject.declaredClass.split("."));b.resolve(a[a.length-1]);return b},getPopupInfo:function(){return this.originOperLayer.popupInfo},loadInfoTemplate:function(){var a=new q;a.resolve(null);return a},getInfoTemplate:function(){return null},getFilterOfWebmap:function(){return this.originOperLayer.layerDefinition?this.originOperLayer.layerDefinition.definitionExpression:null},getFilter:function(){return null},
setFilter:function(){},getShowLegendOfWebmap:function(){for(var a=this,b=!0;a;)b=b&&a._getShowLegendOfWebmap(),a=a.parentLayerInfo;return b},getUrl:function(){return this.layerObject.url||this.layerObject._url},hasLayerTypes:function(a){},getSupportTableInfo:function(){var a=new q,b={isSupportedLayer:!1,isSupportQuery:!1,layerType:null},c=this.getLayerType(),f=this.getLayerObject();k({type:c,layerObject:f}).then(d.hitch(this,function(c){var f=c.type;c=c.layerObject;b.layerType=f;0<=this._getLayerTypesOfSupportTable().indexOf(f)&&
(b.isSupportedLayer=!0);if(!c)b.isSupportQuery=!1;else if(this.parentLayerInfo&&this.parentLayerInfo.isMapNotesLayerInfo())b.isSupportQuery=!1;else if(!c.url||c.capabilities&&0<=c.capabilities.indexOf("Query"))b.isSupportQuery=!0;a.resolve(b)}),function(){a.resolve(b)});return a},getRelatedTableInfoArray:function(a){a=new q;a.resolve([]);return a},removeSubLayerById:function(a){var b=[];l.forEach(this.newSubLayers,function(c){c.id!==a?b.push(c):c.destroyLayerInfo()});this.newSubLayers=b},destroy:function(){l.forEach(this._eventHandles,
function(a){a.remove()});this.destroyLabelLayer();this.inherited(arguments)},destroyLayerInfo:function(){l.forEach(this.newSubLayers,function(a){a.destroyLayerInfo()});this.destroy()},isMapNotesLayerInfo:function(){return this.originOperLayer.featureCollection&&0===this.id.indexOf("mapNotes_")&&"ArcGISFeatureLayer"===this.originOperLayer.layerType&&!this.map.getLayer(this.id)?!0:!1},getScaleRange:function(){return this.layerObject&&0<=this.layerObject.minScale&&0<=this.layerObject.maxScale?{minScale:this.layerObject.minScale,
maxScale:this.layerObject.maxScale}:{minScale:0,maxScale:0}},isCurrentScaleInTheScaleRange:function(){var a=this.getScaleRange(),b=this.map.getScale();return 0===a.minScale&&0===a.maxScale?!0:(0===a.minScale||a.minScale>b)&&(0===a.maxScale||b>a.maxScale)?!0:!1},isInScale:function(){for(var a=!0,b=this;b&&(a=b.isCurrentScaleInTheScaleRange(),b=b.parentLayerInfo,a););return a},enablePopup:function(){},disablePopup:function(){},isPopupEnabled:function(){return!1},getCapabilitiesOfWebMap:function(){return this.originOperLayer.capabilities},
isItemLayer:function(){return this.originOperLayer.itemId||d.getObject("_wabProperties.itemLayerInfo.itemId",!1,this.layerObject)},getItemInfo:function(){var a=new q,b=this.getRootLayerInfo();if(b.isItemLayer()){var c=new f.ItemInfo(b);c.onLoad().then(d.hitch(this,function(){a.resolve(c)}))}else a.resolve(null);return a},isHostedLayer:function(){var b=new q,c=this.getUrl();c?a({url:c,content:{f:"json"},handleAs:"json",callbackParamName:"callback"}).then(d.hitch(this,function(a){b.resolve(a&&a.serviceItemId?
!0:!1)})):b.resolve(!1);return b},obtainLabelControl:function(){},restoreLabelControl:function(){},destroyRealtedLabelLayer:function(){},destroyLabelLayer:function(){},canShowLabel:function(){},isShowLabels:function(){},showLabels:function(){},hideLabels:function(){},_bindEvent:function(){var a;this.layerObject&&!this.layerObject.empty&&(a=this.layerObject.on("visibility-change",d.hitch(this,this._onVisibilityChanged)),this._eventHandles.push(a),a=h.after(this.layerObject,"setDefinitionExpression",
d.hitch(this,this._onFilterChanged)),this._eventHandles.push(a),a=h.after(this.layerObject,"setRenderer",d.hitch(this,this._onRendererChanged)),this._eventHandles.push(a),this.isRootLayer()&&(a=this.layerObject.on("opacity-change",d.hitch(this,this._onOpacityChanged)),this._eventHandles.push(a)))},_onVisibilityChanged:function(){this._initVisible();this._visibleChanged();this._isShowInMapChanged2()},_onFilterChanged:function(){var a=this._oldFilter?this._oldFilter:null,b=this.layerObject.getDefinitionExpression(),
b=b?b:null;a!==b&&(p.publish("layerInfos/layerInfo/filterChanged",[this]),this._oldFilter=b)},_onRendererChanged:function(){p.publish("layerInfos/layerInfo/rendererChanged",[this])},_onOpacityChanged:function(){p.publish("layerInfos/layerInfo/opacityChanged",[this])}});f.ItemInfo=r(null,{originItemInfo:null,_itemInfoLoadedDef:null,_layerDefinition:null,constructor:function(a){this._itemInfoLoadedDef=new q;if(a=a.isItemLayer()){var b=window.appConfig||window.getAppConfig(),b=e.getStandardPortalUrl(b&&
b.map.portalUrl||window.portalUrl);c.getPortal(b).getItemById(a).then(d.hitch(this,function(a){this.originItemInfo=a;this._itemInfoLoadedDef.resolve(this)}),d.hitch(this,function(a){a&&a.message&&console.log(a.message);this._itemInfoLoadedDef.resolve(this)}))}else this._itemInfoLoadedDef.resolve(this)},onLoad:function(){return this._itemInfoLoadedDef}});return f})},"jimu/LayerInfos/RequestBuffer":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/Deferred"],function(r,l,d){var q=r(null,
{_realRequest:null,_buffer:null,constructor:function(k){this._buffer={};this._realRequest=k?k:function(){return new d}},getRequest:function(d){this._buffer[d]||(this._buffer[d]=new q.RequestProxy(this._realRequest,d));return this._buffer[d]}});q.RequestProxy=r(null,{_key:null,_deferred:null,_realRequest:null,constructor:function(d,l){this._realRequest=d;this._key=l},request:function(){this._deferred||(this._deferred=new d,this._realRequest.apply(null,arguments).then(l.hitch(this,function(d){this._deferred.resolve(d)}),
l.hitch(this,function(d){d&&console.warn(d.message||d);this._deferred.resolve(null);this._deferred=null})));return this._deferred},fakeRequest:function(){this._deferred||(this._deferred=new d);return this._deferred},setResponse:function(k){this._deferred||(this._deferred=new d);null===k||void 0===k?(this._deferred.resolve(null),this._deferred=null):this._deferred.resolve(k)},isResolved:function(){return this._deferred&&this._deferred.isResolved()}});return q})},"jimu/LayerInfos/LayerInfoForMapService":function(){define("dojo/_base/declare dojo/_base/array dojo/_base/lang dojo/Deferred dojo/json dojo/aspect dojo/topic ./LayerInfo esri/request esri/lang".split(" "),
function(r,l,d,q,k,m,p,h,e,c){return r(h,{_legendInfo:null,_sublayerIdent:null,controlPopupInfo:null,_jsapiLayerInfos:null,_oldFilter:null,_subLayerVisible:null,constructor:function(b,a){this._initJsapiLayerInfos();this._initSubLayerVisible();this._initSubLayerIdent();this._initControlPopup()},_initOldFilter:function(){this._oldFilter=this.layerObject&&this.layerObject.layerDefinitions?this.layerObject.layerDefinitions:[]},_initJsapiLayerInfos:function(){var b=l.filter(this.originOperLayer.layers,
function(a){return c.isDefined(a.id)&&c.isDefined(a.name)&&c.isDefined(a.minScale)&&c.isDefined(a.maxScale)&&c.isDefined(a.parentLayerId)&&c.isDefined(a.defaultVisibility)});this._jsapiLayerInfos=0<b.length?b:this.layerObject.layerInfos},_initControlPopup:function(){this.controlPopupInfo={enablePopup:void 0,infoTemplates:d.clone(this.layerObject.infoTemplates)};this.layerObject._infoTemplates=d.clone(this.layerObject.infoTemplates);m.after(this.layerObject,"setInfoTemplates",d.hitch(this,function(){this.layerObject._infoTemplates=
d.clone(this.layerObject.infoTemplates);this.controlPopupInfo.infoTemplates=d.clone(this.layerObject.infoTemplates);this.traversal(function(b){b._afterSetInfoTemplates&&b._afterSetInfoTemplates()})}))},_initSubLayerIdent:function(){this._sublayerIdent={definitions:{},empty:!0,defLoad:new q}},_initSubLayerVisible:function(b){this._subLayerVisible={};for(var a=0;a<this._jsapiLayerInfos.length;a++)this._subLayerVisible[this._jsapiLayerInfos[a].id]=!1;b?l.forEach(b,function(a){this._subLayerVisible[a]=
!0},this):this.originOperLayer.visibleLayers?l.forEach(this.originOperLayer.visibleLayers,function(a){this._subLayerVisible[a]=!0},this):l.forEach(this._jsapiLayerInfos,function(a){a.defaultVisibility&&(this._subLayerVisible[a.id]=!0)},this)},_initVisible:function(){this._visible=this.originOperLayer.layerObject.visible},_setTopLayerVisible:function(b){this.originOperLayer.layerObject.setVisibility(b);this._visible=b},_setSubLayerVisible:function(b){var a=[-1,-1,-1],c,e=[],d=l.filter(this.originOperLayer.layerObject.visibleLayers,
function(a){return-1!==a});l.forEach(d,function(a){if(!this._isGroupLayerBySubId(a)){var b=this._subLayerInfoIndex[a];b&&b._isAllSubLayerVisibleOnPath()&&e.push(a)}},this);var d=e,h;for(h in b)if(b.hasOwnProperty(h)&&"function"!==typeof b[h]){var f=Number(h);b[h]?(c=l.indexOf(d,f),0>c&&d.push(f)):(c=l.indexOf(d,f),0<=c&&d.splice(c,1))}a=a.concat(d);this.originOperLayer.layerObject.setVisibleLayers(a)},_resetLayerObjectVisiblity:function(b){var a=b?b[this.id]:null,c=!1;if(b&&(a&&this.layerObject.setVisibility(a.visible),
"esri.layers.ArcGISDynamicMapServiceLayer"===this.layerObject.declaredClass)){var a={},e;for(e in b)b.hasOwnProperty(e)&&"function"!==typeof b[e]&&(c=!0,a[e]=b[e].visible);c&&this._setSubLayerVisibleByCheckedInfo(a)}},_setSubLayerVisibleByCheckedInfo:function(b){var a=[];l.forEach(this._jsapiLayerInfos,function(e){var g=this.id+"_"+e.id;c.isDefined(b[g])?b[g]&&a.push(e.id):this._subLayerVisible[e.id]&&a.push(e.id)},this);this._initSubLayerVisible(a);this.traversal(function(a){a._initVisible()});var e=
{};this.traversal(function(a){0===a.getSubLayers().length&&(e[a.originOperLayer.mapService.subId]=a._isAllSubLayerVisibleOnPath())});this._setSubLayerVisible(e)},_subLayerVisibleChanged:function(){var b=[];this.traversal(function(a){b.push(a)});p.publish("layerInfos/layerInfo/visibleChanged",b)},obtainNewSubLayers:function(){var b=[],a=this.originOperLayer.layerObject,c=null,c="esri.layers.ArcGISDynamicMapServiceLayer"===a.declaredClass?"dynamic":"tiled";l.forEach(this._jsapiLayerInfos,function(e){var g=
null,g=a.url+"/"+e.id,f=a.id+"_"+e.id;e.subLayerIds&&0<e.subLayerIds.length?(g={url:g,empty:!0},this._addNewSubLayer(b,g,f,e,c+"_group")):(g={url:g,empty:!0},this._addNewSubLayer(b,g,f,e,c))},this);var e=[];l.forEach(this._jsapiLayerInfos,function(a,c){var f=a.parentLayerId;if(-1!==f){for(var e=null,g=0;g<b.length;g++)if(b[g].mapService.subId===f){e=b[g];break}(f=e)&&f.subLayers.push(b[c])}},this);l.forEach(this._jsapiLayerInfos,function(a,c){var f;-1===a.parentLayerId&&(f=this._layerInfoFactory.create(b[c]),
e.push(f),f.init())},this);return e},_addNewSubLayer:function(b,a,c,e,d){b.push({layerObject:a,title:e.name||e.id||" ",id:c||"-",subId:e.id,subLayers:[],mapService:{layerInfo:this,subId:e.id},selfType:"mapservice_"+d,parentLayerInfo:this})},_handleErrorSubLayer:function(b,a,c,e,d,h){b[a]={layerObject:null,title:h.name||h.id||" ",id:c||" ",subLayers:[],mapService:{layerInfo:this,subId:e}}},getExtent:function(){return this._convertGeometryToMapSpatialRef(this.originOperLayer.layerObject.fullExtent||
this.originOperLayer.layerObject.initialExtent)},getOpacity:function(){return this.layerObject.opacity?this.layerObject.opacity:1},setOpacity:function(b){this.layerObject.setOpacity&&this.layerObject.setOpacity(b)},getLegendInfo:function(b){var a=new q;this._legendInfo?a.resolve(this._legendInfo):this._legendRequest(b).then(d.hitch(this,function(b){this._legendInfo=b.layers;a.resolve(this._legendInfo)}),function(){a.reject()});return a},_legendRequest:function(b){return 10.01<=this.layerObject.version?
this._legendRequestServer():this._legendRequestTools(b)},_legendRequestServer:function(){var b=this.layerObject.url+"/legend",a={f:"json"};this.layerObject._params.dynamicLayers&&(a.dynamicLayers=k.stringify(this._createDynamicLayers(this.layerObject)),"[{}]"===a.dynamicLayers&&(a.dynamicLayers="[]"));return e({url:b,content:a,handleAs:"json",callbackParamName:"callback"})},_legendRequestTools:function(b){return e({url:b+"sharing/tools/legend?soapUrl\x3d"+this.layerObject.url,content:{f:"json"},handleAs:"json",
callbackParamName:"callback"})},_createDynamicLayers:function(b){var a=[],c;l.forEach(b.dynamicLayerInfos||b.layerInfos,function(e){c={id:e.id};c.source=e.source&&e.source.toJson();var g;b.layerDefinitions&&b.layerDefinitions[e.id]&&(g=b.layerDefinitions[e.id]);g&&(c.definitionExpression=g);var d;b.layerDrawingOptions&&b.layerDrawingOptions[e.id]&&(d=b.layerDrawingOptions[e.id]);d&&(c.drawingInfo=d.toJson());c.minScale=e.minScale||0;c.maxScale=e.maxScale||0;a.push(c)});return a},_getServiceDefinition:function(){var b=
this.getUrl();return this._serviceDefinitionBuffer.getRequest(this.subId).request(b)},_getSubserviceDefinition:function(b){return 10.11<=this.layerObject.version?this._getAllLayerAndTable(b):this._getLayerAndTable(b)},_getAllLayerAndTable:function(b){var a=this.layerObject.url+"/layers",c=this._serviceDefinitionBuffer.getRequest("_all_layer_and_table_request");c.isResolved()||c.request(a).then(d.hitch(this,function(a){null===a?this.traversal(d.hitch(this,function(a){a.isRootLayer()||this._serviceDefinitionBuffer.getRequest(a.subId).setResponse(null)})):
l.forEach(a.layers,function(a){this._serviceDefinitionBuffer.getRequest(a.id).setResponse(a)},this)}));return this._serviceDefinitionBuffer.getRequest(b).fakeRequest()},_getLayerAndTable:function(b){var a=this.layerObject.url+"/"+b;return this._serviceDefinitionBuffer.getRequest(b).request(a)},_getSublayerSettingOfWebmap:function(b){var a=l.filter(this.originOperLayer.layers,function(a){return a.id===b});return 1===a.length?a[0]:null},_getSublayerShowLegendOfWebmap:function(b){return(b=this._getSublayerSettingOfWebmap(b))?
void 0!==b.showLegend?b.showLegend:!0:!0},_idIsInJsapiLayerInfos:function(b){return null===this._getJsapiLayerInfoById(b)?!1:!0},_getJsapiLayerInfoById:function(b){for(var a=null,c=0;c<this._jsapiLayerInfos.length;c++)if(this._jsapiLayerInfos[c].id===b){a=this._jsapiLayerInfos[c];break}return a},_isGroupLayerBySubId:function(b){return(b=this._getJsapiLayerInfoById(b))&&b.subLayerIds&&0<b.subLayerIds.length?!0:!1},_bindEvent:function(){var b;this.inherited(arguments);this.layerObject&&!this.layerObject.empty&&
(b=this.layerObject.on("visible-layers-change",d.hitch(this,this._onVisibleLayersChanged)),this._eventHandles.push(b),b=m.after(this.layerObject,"setLayerDefinitions",d.hitch(this,this._onFilterChanged)),this._eventHandles.push(b))},_onVisibleLayersChanged:function(b){var a=b.visibleLayers;if(-1===a[0]&&-1===a[1]&&-1===a[2])this._subLayerVisibleChanged(),this._isShowInMapChanged2();else{b=[];var c=[-1,-1,-1],a=this._converVisibleLayers(a);b=a.visibleLayersForUpdateSubLayerVisible;c=c.concat(a.visibleLayersForSetVisibleLayers);
this._initSubLayerVisible(b);this.traversal(function(a){a._initVisible()});this.layerObject.setVisibleLayers(c)}},_converVisibleLayers:function(b){var a={visibleLayersForUpdateSubLayerVisible:[],visibleLayersForSetVisibleLayers:[]};l.forEach(b,function(a){var c=this.findLayerInfoById(this.id+"_"+a);if(this._isGroupLayerBySubId(a))c.traversal(function(a){b.push(a.originOperLayer.mapService.subId)});else for(;c&&c.originOperLayer.mapService;)b.push(c.originOperLayer.mapService.subId),c=c.parentLayerInfo},
this);l.forEach(b,function(b){0<=b&&0>a.visibleLayersForUpdateSubLayerVisible.indexOf(b)&&a.visibleLayersForUpdateSubLayerVisible.push(b)},this);l.forEach(a.visibleLayersForUpdateSubLayerVisible,function(b){this._isGroupLayerBySubId(b)||a.visibleLayersForSetVisibleLayers.push(b)},this);return a},_onFilterChanged:function(){for(var b,a=[],c=this.layerObject.layerDefinitions,e=c.length>this._oldFilter.length?c.length:this._oldFilter.length,d=0;d<e;d++)(c[d]?c[d]:null)!==(this._oldFilter[d]?this._oldFilter[d]:
null)&&(b=this.findLayerInfoById(this.id+"_"+d))&&b.isLeaf()&&a.push(b);0<a.length&&(p.publish("layerInfos/layerInfo/filterChanged",a),this._oldFilter=c)}})})},"jimu/LayerInfos/LayerInfoForKML":function(){define("dojo/_base/declare dojo/_base/array dojo/_base/lang esri/graphicsUtils dojo/aspect ./LayerInfo ./LayerInfoForDefault dojo/Deferred esri/lang".split(" "),function(r,l,d,q,k,m,p,h,e){return r(m,{constructor:function(){},getExtent:function(){var c=this.originOperLayer.layerObject.getLayers(),
b=null,a;l.forEach(c,function(c){a=this._convertGeometryToMapSpatialRef(c.initialExtent);b=b?b.union(a):a},this);return b},_resetLayerObjectVisiblity:function(c){var b=c?c[this.id]:null;if(b){var a={},e;for(e in c)c.hasOwnProperty(e)&&"function"!==typeof c[e]&&(a[e]=c[e].visible);this._setSubLayerVisibleByCheckedInfo(a);this._setTopLayerVisible(b.visible)}},_setSubLayerVisibleByCheckedInfo:function(c){l.forEach(this.newSubLayers,function(b){e.isDefined(c[b.id])&&b.layerObject.setVisibility(c[b.id])},
this)},_initVisible:function(){var c=!1,b;for(b=0;b<this.newSubLayers.length;b++)c=c||this.newSubLayers[b].layerObject.visible;c&&(this._visible=!0)},_setTopLayerVisible:function(c){this._visible=c?!0:!1;l.forEach(this.newSubLayers,function(b){b.setLayerVisiblefromTopLayer()},this);this._onVisibilityChanged()},obtainNewSubLayers:function(){var c=[],b=this.originOperLayer.layerObject.getLayers();l.forEach(b,function(a){this._getLayerIndexesInMapByLayerId(a.id)&&(a=this._layerInfoFactory.create({layerObject:a,
title:a.label||a.title||a.name||a.id||" ",id:a.id||"-",subId:a.id||"-",collection:{layerInfo:this},selfType:"kml",parentLayerInfo:this}),c.push(a),a.init())},this);return c}})})},"jimu/LayerInfos/LayerInfoForDefault":function(){define("dojo/_base/declare dojo/_base/array dojo/_base/lang dojo/Deferred ./LayerInfo dojox/gfx dojo/dom-construct dojo/dom-attr dojo/dom-class dojo/aspect jimu/portalUrlUtils jimu/portalUtils jimu/utils esri/symbols/jsonUtils esri/layers/LabelLayer esri/layers/LabelClass esri/dijit/PopupTemplate esri/dijit/Legend".split(" "),
function(r,l,d,q,k,m,p,h,e,c,b,a,g,u,n,t,f,v){return r(k,{_legendsNode:null,controlPopupInfo:null,constructor:function(){this._initControlPopup();this._updateLayerObjectName();try{this._initToShowLabels()}catch(x){console.warn(x.message)}},_updateLayerObjectName:function(){this.layerObject&&!this.layerObject.empty&&this.layerObject.name&&!d.getObject("_wabProperties.originalLayerName",!1,this.layerObject)&&(d.setObject("_wabProperties.originalLayerName",this.layerObject.name,this.layerObject),this.layerObject.name=
this.title)},_initToShowLabels:function(){var b=d.getObject("_wabProperties.itemLayerInfo",!1,this.layerObject);b&&!this.layerObject.empty&&a.getPortal(b.portalUrl).getItemData(b.itemId).then(d.hitch(this,function(a){var b;a&&a.layers&&(l.some(a.layers,function(a){return a.id===this.layerObject.layerId?(b=a,!0):!1},this),b&&b.showLabels&&((a=d.getObject("layerDefinition.drawingInfo.labelingInfo",!1,b))&&!this.layerObject.labelingInfo&&this.layerObject.setLabelingInfo&&(a=l.map(a,function(a){return new t(a)},
this),this.layerObject.setLabelingInfo(a)),this.showLabels()))}),d.hitch(this,function(a){a&&a.message&&console.log(a.message)}))},_initOldFilter:function(){this._oldFilter=this.layerObject&&!this.layerObject.empty&&this.layerObject.getDefinitionExpression?this.layerObject.getDefinitionExpression():null},_getLayerOptionsForCreateLayerObject:function(){var a={};a.id=this.id;var b=[],c=this.getInfoTemplate();c&&c.info&&c.info.fieldInfos?l.forEach(c.info.fieldInfos,function(a){a.visible&&b.push(a.fieldName)},
this):b=["*"];a.outFields=b;return a},getExtent:function(){var a=this.originOperLayer.layerObject.fullExtent||this.originOperLayer.layerObject.initialExtent;if(a)return this._convertGeometryToMapSpatialRef(a);a=new q;a.resolve(null);return a},_resetLayerObjectVisiblity:function(a){a=a?a[this.id]:null;!this.originOperLayer.collection&&a&&(this.layerObject.setVisibility(a.visible),this._visible=this.layerObject.visible)},_initVisible:function(){var a=!1;if(this.originOperLayer.collection&&this._notFirstInitVisilbeFlag){var a=
this.originOperLayer.collection.layerInfo,b=this.layerObject.visible;if(a._oldIsShowInMap!==a.isShowInMap())return;this._visible=b?!0:!1;a._onVisibilityChanged()}else this._visible=a=this.originOperLayer.layerObject.visible;this._notFirstInitVisilbeFlag=!0},_setTopLayerVisible:function(a){this.originOperLayer.collection?this.originOperLayer.collection.layerInfo._visible?a?(this.layerObject.show(),this._visible=!0):(this.layerObject.hide(),this._visible=!1):a?(this.layerObject.hide(),this._visible=
!0):(this.layerObject.hide(),this._visible=!1):(a?this.layerObject.show():this.layerObject.hide(),this._visible=a)},setLayerVisiblefromTopLayer:function(){this.originOperLayer.collection.layerInfo._visible?this._visible&&this.layerObject.show():this.layerObject.hide()},_prepareCheckedInfoForShowOrHide:function(a){for(var b={},c=this;c.parentLayerInfo;)b[c.id]=a,c=c.parentLayerInfo;return b},show:function(){if(this.isRootLayer())this._setTopLayerVisible(!0);else{var a=this.getRootLayerInfo();if(a._setSubLayerVisibleByCheckedInfo){var b=
this._prepareCheckedInfoForShowOrHide(!0);a._setSubLayerVisibleByCheckedInfo(b);a.show()}}},_initControlPopup:function(){this.controlPopupInfo={enablePopup:this.layerObject.infoTemplate?!0:!1,infoTemplate:this.layerObject.infoTemplate};this.layerObject._infoTemplate=this.layerObject.infoTemplate;c.after(this.layerObject,"setInfoTemplate",d.hitch(this,function(){this.layerObject._infoTemplate=this.layerObject.infoTemplate;this.controlPopupInfo.infoTemplate=this.layerObject.infoTemplate;this.controlPopupInfo.enablePopup||
(this.layerObject.infoTemplate=null)}))},_getServiceDefinition:function(){var a;(a=this.getUrl())&&this.isRootLayer()&&"esri.layers.FeatureLayer"===this.layerObject.declaredClass?a=this._serviceDefinitionBuffer.getRequest(this.subId).request(a):(a=new q,a.resolve(null));return a},createLegendsNode:function(){var a=p.create("div",{"class":"legends-div jimu-legends-div-flag jimu-leading-margin1",legendsDivId:this.id},document.body);p.create("img",{"class":"legends-loading-img",src:require.toUrl("jimu")+
"/images/loading.gif"},a);return a},drawLegends:function(a){this._initLegendsNodeByLegendDijit(a)},_initLegendsNodeByLegendDijit:function(a){if(this.layerObject&&!this.layerObject.empty&&(!this.originOperLayer.subLayer||0===this.originOperLayer.subLayers.length)&&this.layerObject.loaded){p.empty(a);e.remove(a,"jimu-legends-div-flag");var b=new v({map:this.map,layerInfos:[{layer:this.layerObject}],arrangement:v.ALIGN_LEFT,respectCurrentMapScale:!1,respectVisibility:!1},p.create("div",{},a));b.startup();
a._legendDijit=b}},_initLegendsNode:function(a){var b=[],c=this.layerObject;!this.layerObject||this.layerObject.empty||this.originOperLayer.subLayer&&0!==this.originOperLayer.subLayers.length||(p.empty(a),c.renderer&&(c.renderer.infos?b=d.clone(c.renderer.infos):b.push({label:c.renderer.label,symbol:c.renderer.symbol}),c.renderer&&c.renderer.defaultSymbol&&0<b.length&&b.push({label:c.renderer.defaultLabel||"others",symbol:c.renderer.defaultSymbol}),l.forEach(b,function(b){b.legendDiv=p.create("div",
{"class":"legend-div"},a);b.symbolDiv=p.create("div",{"class":"legend-symbol jimu-float-leading"},b.legendDiv);b.labelDiv=p.create("div",{"class":"legend-label jimu-float-leading",innerHTML:b.label||" "},b.legendDiv);if("textsymbol"===b.symbol.type)h.set(b.symbolDiv,"innerHTML",b.symbol.text);else{var c=m.createSurface(b.symbolDiv,50,50);b=u.getShapeDescriptors(b.symbol);c.createShape(b.defaultShape).setFill(b.fill).setStroke(b.stroke).setTransform(m.matrix.translate(25,25))}},this)))},obtainNewSubLayers:function(){var a=
[];l.forEach(this.originOperLayer.subLayers,function(b){b.parentLayerInfo=this;b=this._layerInfoFactory.create(b);a.push(b);b.init()},this);return a},_isAllSubLayerVisibleOnPath:function(){for(var a=!0,b=this;!b.isRootLayer();)a=a&&b.isVisible(),b=b.parentLayerInfo;return a},getOpacity:function(){return this.layerObject.opacity?this.layerObject.opacity:1},setOpacity:function(a){this.layerObject.setOpacity&&this.layerObject.setOpacity(a)},_getCustomPopupInfo:function(a,b){var c=null;a&&a.fields&&(c=
{title:a.name,fieldInfos:[],description:null,showAttachments:!0,mediaInfos:[]},l.forEach(a.fields,function(a){var f=!1;b?l.some(b,d.hitch(this,function(b){return b&&a.name.toLowerCase()===b.toLowerCase()}))&&(f=!0):f=!0;f&&(f=g.getDefaultPortalFieldInfo(a),f.visible=!0,f.isEditable=a.editable,c.fieldInfos.push(f))},this));return c},_getDefaultPopupInfo:function(a){var b=this._getCustomPopupInfo(a);b&&(b.fieldInfos=l.filter(b.fieldInfos,d.hitch(this,function(b){return b.fieldName.toLowerCase()!==a.objectIdField.toLowerCase()&&
"globalid"!==b.fieldName.toLowerCase()&&"shape"!==b.fieldName.toLowerCase()?!0:!1})));return b},_getDefaultPopupTemplate:function(a){var b=null;(a=this.getPopupInfo()||this._getDefaultPopupInfo(a))&&(b=new f(a));return b},enablePopup:function(){return this.loadInfoTemplate().then(d.hitch(this,function(){return this.controlPopupInfo.infoTemplate?(this.controlPopupInfo.enablePopup=!0,this.layerObject.infoTemplate=this.controlPopupInfo.infoTemplate,!0):!1}))},disablePopup:function(){this.controlPopupInfo.enablePopup=
!1;this.layerObject.infoTemplate=null},isPopupEnabled:function(){return this.controlPopupInfo&&this.controlPopupInfo.enablePopup?!0:!1},loadInfoTemplate:function(){var a=new q;this.controlPopupInfo.infoTemplate?a.resolve(this.controlPopupInfo.infoTemplate):this.getLayerObject().then(d.hitch(this,function(){this.controlPopupInfo.infoTemplate=this._getDefaultPopupTemplate(this.layerObject);a.resolve(this.controlPopupInfo.infoTemplate)}),d.hitch(this,function(){a.resolve(null)}));return a},getInfoTemplate:function(){return this.controlPopupInfo.infoTemplate},
_getRelatedUrls:function(a,b){var c=[];if(!a||!a.url||!a.relationships)return c;var f=a.url.lastIndexOf("/"),e=a.url.slice(0,f);l.forEach(a.relationships,function(a){b&&a.role&&b!==a.role||c.push(e+"/"+a.relatedTableId.toString())},this);return c},getRelatedTableInfoArray:function(a){var c=[],f=new q;this.getLayerObject().then(d.hitch(this,function(e){var g=this._getRelatedUrls(e,a);0!==g.length&&this._getLayerInfosObj().traversalAll(d.hitch(this,function(a){var f=-1;if(0===g.length)return!0;l.forEach(g,
function(e,g){d.getObject("layerObject.url",!1,a)&&b.removeProtocol(e.toString().toLowerCase()).replace(/\/+/g,"/")===b.removeProtocol(a.layerObject.url.toString().toLowerCase()).replace(/\/+/g,"/")&&(c.push(a),f=g)},this);0<=f&&g.splice(f,1);return!1}));f.resolve(c)}),d.hitch(this,function(){f.resolve(c)}));return f},getFilter:function(){return this.layerObject&&!this.layerObject.empty&&this.layerObject.getDefinitionExpression?this.layerObject.getDefinitionExpression():null},setFilter:function(a){this.layerObject&&
!this.layerObject.empty&&this.layerObject.setDefinitionExpression&&this.layerObject.setDefinitionExpression(a)},_isAlreadyInLabelLayerOfMap:function(a){var b=!1;a&&(b=l.some(a.getFeatureLayers(),function(a){return this.id===a.id},this));return b},_addToLabelLayerOfMap:function(){var a=this.getLabelLayerOfMap();a&&!this._isAlreadyInLabelLayerOfMap(a)&&(a.addFeatureLayer(this.layerObject),this.map.removeLayer(a),this.map.addLayer(a))},_removeFromLabelLayerOfMap:function(){this.getLabelLayerOfMap().removeFeatureLayer(this.id)},
_isSupportLabelControl:function(){return this.isRootLayer()&&!this.layerObject.empty&&"esri.layers.FeatureLayer"===this.layerObject.declaredClass&&this.layerObject.labelingInfo&&0<this.layerObject.labelingInfo.length?!0:!1},getLabelLayerOfMap:function(){var a;this.map._labels?a=this.map._labels:(a=this.map.getLayer("labels"),a||(a=new n({id:"labels"}),this.map.addLayer(a)));return a},obtainLabelControl:function(){var a=this.id+"_labelLayer",b=this.map.getLayer(a);if(!b&&this._isSupportLabelControl()){var c=
this.getLabelLayerOfMap();c&&this._isAlreadyInLabelLayerOfMap(c)&&(b=new n({id:a}),b.addFeatureLayer(this.layerObject),this.map.addLayer(b),this._removeFromLabelLayerOfMap())}return b?b:null},restoreLabelControl:function(){this._isSupportLabelControl()&&(this.destroyRealtedLabelLayer(),this._addToLabelLayerOfMap())},destroyRealtedLabelLayer:function(){var a=this.map.getLayer(this.id+"_labelLayer");a&&this.map.removeLayer(a)},destroyLabelLayer:function(){this.map.getLayer(this.id)||(this._removeFromLabelLayerOfMap(),
this.destroyRealtedLabelLayer())},canShowLabel:function(){return this._isSupportLabelControl()},isShowLabels:function(){var a=this.map.getLayer(this.id+"_labelLayer"),b=this.getLabelLayerOfMap();return this._isSupportLabelControl()&&(a||b&&this._isAlreadyInLabelLayerOfMap(b))?this.layerObject.showLabels:!1},showLabels:function(){this._isSupportLabelControl()&&this.layerObject.setShowLabels&&(this.map.getLayer(this.id+"_labelLayer")||this._addToLabelLayerOfMap(),this.layerObject.setShowLabels(!0))},
hideLabels:function(){this._isSupportLabelControl()&&this.layerObject.setShowLabels&&this.layerObject.setShowLabels(!1)}})})},"esri/layers/LabelLayer":function(){define("require dojo/_base/declare dojo/_base/lang dojo/number dojo/i18n!dojo/cldr/nls/number dojo/_base/array dojo/_base/connect dojo/has dojox/gfx/_base ../kernel ../lang ../graphic ../PopupInfo ./labelLayerUtils/DynamicLabelClass ./labelLayerUtils/StaticLabelClass ../symbols/TextSymbol ../symbols/ShieldLabelSymbol ../geometry/Extent ../geometry/Point ../geometry/webMercatorUtils ./GraphicsLayer ./LabelClass ../renderers/SimpleRenderer ../renderers/arcadeUtils".split(" "),
function(r,l,d,q,k,m,p,h,e,c,b,a,g,u,n,t,f,v,x,w,z,A,y,B){function C(a){return"sizeInfo"===a.type}return l(z,{declaredClass:"esri.layers.LabelLayer",constructor:function(a){this._refreshLabels=d.hitch(this,this._refreshLabels);this.id="labels";this.featureLayers=[];this._featureLayerInfos=[];this._preparedLabels=[];this._engineType="STATIC";this._mapEventHandlers=[];a&&(a.id&&(this.id=a.id),a.mode&&(this._engineType="DYNAMIC"===a.mode.toUpperCase()?"DYNAMIC":"STATIC"))},_setMap:function(a){this._mapEventHandlers.push(a.on("extent-change",
d.hitch(this,"_handleLevelChange")));var b=this.inherited(arguments);this.refresh();return b},_unsetMap:function(){var a;for(a=0;a<this._mapEventHandlers.length;a++)p.disconnect(this._mapEventHandlers[a]);this.refresh();clearTimeout(this._refreshHandle);this._refreshHandle=null;this.inherited(arguments)},setAlgorithmType:function(a){this._engineType=a&&"DYNAMIC"===a.toUpperCase()?"DYNAMIC":"STATIC";this.refresh()},addFeatureLayer:function(a,b,c,f){if(!this.getFeatureLayer(a.layerId)){var e=[];e.push(a.on("update-end",
d.hitch(this,"refresh")));e.push(a.on("suspend",d.hitch(this,"refresh")));e.push(a.on("resume",d.hitch(this,"refresh")));e.push(a.on("edits-complete",d.hitch(this,"refresh")));e.push(a.on("labeling-info-change",d.hitch(this,"refresh")));e.push(a.on("time-extent-change",d.hitch(this,"refresh")));e.push(a.on("show-labels-change",d.hitch(this,"refresh")));this._featureLayerInfos.push({FeatureLayer:a,LabelExpressionInfo:c,LabelingOptions:f,LabelRenderer:b,EventHandlers:e});this.featureLayers.push(a);
this.refresh()}},getFeatureLayer:function(a){var b,c;for(b=0;b<this.featureLayers.length;b++)if(c=this.featureLayers[b],void 0!==c&&c.id==a)return c;return null},removeFeatureLayer:function(a){var b;a=this.getFeatureLayer(a);if(void 0!==a&&(b=m.indexOf(this.featureLayers,a),-1<b)){this.featureLayers.splice(b,1);for(a=0;a<this._featureLayerInfos[b].EventHandlers.length;a++)p.disconnect(this._featureLayerInfos[b].EventHandlers[a]);this._featureLayerInfos.splice(b,1);this.refresh()}},removeAllFeatureLayers:function(){var a;
for(a=0;a<this.featureLayers.length;a++){for(var b=0;b<this._featureLayerInfos[a].EventHandlers.length;b++)p.disconnect(this._featureLayerInfos[a].EventHandlers[b]);this.featureLayers=[];this._featureLayerInfos=[]}this.refresh()},getFeatureLayers:function(){return this.featureLayers},getFeatureLayerInfo:function(a){var b,c;for(b=0;b<this.featureLayers.length;b++)if(c=this.featureLayers[b],void 0!==c&&c.id==a)return this._featureLayerInfos[b];return null},refresh:function(){null==this._refreshHandle&&
(this._refreshHandle=setTimeout(this._refreshLabels,0))},_handleLevelChange:function(a){a.levelChange&&this.clear();this.refresh()},_refreshLabels:function(a){this._refreshHandle=null;var b,c,f,e,g,d=[],h,k="DYNAMIC"===this._engineType?new u:new n;if(this._map){k.setMap(this._map,this);this._preparedLabels=[];for(a=0;a<this.featureLayers.length;a++)if(c=this.featureLayers[a],c.visible&&c.showLabels&&c.visibleAtMapScale&&!c._suspended)if(b=this._featureLayerInfos[a],g=this._convertOptions(null),b.LabelRenderer){if(d=
c.labelingInfo)if(h=d[0])e=this._getLabelExpression(h),g=this._convertOptions(h);f=b.LabelRenderer;b.LabelExpressionInfo&&(e=b.LabelExpressionInfo);b.LabelingOptions&&(g=this._convertOptions(null),void 0!==b.LabelingOptions.pointPriorities&&(d=b.LabelingOptions.pointPriorities,g.pointPriorities="above-center"==d||"AboveCenter"==d||"esriServerPointLabelPlacementAboveCenter"==d?"AboveCenter":"above-left"==d||"AboveLeft"==d||"esriServerPointLabelPlacementAboveLeft"==d?"AboveLeft":"above-right"==d||"AboveRight"==
d||"esriServerPointLabelPlacementAboveRight"==d?"AboveRight":"below-center"==d||"BelowCenter"==d||"esriServerPointLabelPlacementBelowCenter"==d?"BelowCenter":"below-left"==d||"BelowLeft"==d||"esriServerPointLabelPlacementBelowLeft"==d?"BelowLeft":"below-right"==d||"BelowRight"==d||"esriServerPointLabelPlacementBelowRight"==d?"BelowRight":"center-center"==d||"CenterCenter"==d||"esriServerPointLabelPlacementCenterCenter"==d?"CenterCenter":"center-left"==d||"CenterLeft"==d||"esriServerPointLabelPlacementCenterLeft"==
d?"CenterLeft":"center-right"==d||"CenterRight"==d||"esriServerPointLabelPlacementCenterRight"==d?"CenterRight":"AboveRight"),void 0!==b.LabelingOptions.lineLabelPlacement&&(g.lineLabelPlacement=b.LabelingOptions.lineLabelPlacement),void 0!==b.LabelingOptions.lineLabelPosition&&(g.lineLabelPosition=b.LabelingOptions.lineLabelPosition),void 0!==b.LabelingOptions.labelRotation&&(g.labelRotation=b.LabelingOptions.labelRotation),void 0!==b.LabelingOptions.howManyLabels&&(g.howManyLabels=b.LabelingOptions.howManyLabels));
f instanceof A&&(e=this._getLabelExpression(f),f=new y(f.symbol),g=this._convertOptions(f));this._addLabels(c,f,e,g)}else if(d=c.labelingInfo)for(b=d.length-1;0<=b;b--)if(h=d[b])f=new A(h instanceof A?h.toJson():h),e=this._getLabelExpression(h),g=this._convertOptions(h),this._addLabels(c,f,e,g);e=k._process(this._preparedLabels);this.clear();this.drawLabels(this._map,e)}},drawLabels:function(b,c){this._scale=(b.extent.xmax-b.extent.xmin)/b.width;var f;for(f=0;f<c.length;f++){var e=c[f],g=e.x,d=e.y,
h=e.text,n=e.angle,k=e.layer.labelSymbol;"polyline"==e.layer.geometry.type&&e.layer.options.labelRotation&&k.setAngle(180/Math.PI*n);k.setText(h);e=g;k instanceof t&&(g=k.getHeight(),e-=.25*g*this._scale*Math.sin(n),d-=.33*g*this._scale);n=new a(new x(e,d,b.extent.spatialReference));n.setSymbol(k);this.add(n)}},_addLabels:function(a,b,c,f){var e,g,d,h;if(this._isWithinScaleRange(b.minScale,b.maxScale)&&c&&""!==c){var n=this._map,k=!a.url&&!n.spatialReference.equals(a.spatialReference);for(e=0;e<a.graphics.length;e++)if(g=
a.graphics[e],!1!==g.visible){d=g.geometry;if(k){if(!w.canProject(d,n))continue;d=w.project(d,n)}d&&this._isWhere(b.where,g.attributes)&&this._isWithinScreenArea(d)&&(h=this._buildLabelText(c,g,a.fields,f),this._addLabel(h,b,a.renderer,g,f,d,n))}}},_isWithinScreenArea:function(a){a="point"===a.type?new v(a.x,a.y,a.x,a.y,a.spatialReference):a.getExtent();if(void 0===a)return!1;a=this._intersects(this._map,a);return null===a||0===a.length?!1:!0},_isWithinScaleRange:function(a,b){var c=this._map.getScale();
return 0<a&&c>=a||0<b&&c<=b?!1:!0},_isWhere:function(a,b){try{if(!a)return!0;if(a){var c=a.split(" ");if(3===c.length)return this._sqlEquation(b[this._removeQuotes(c[0])],c[1],this._removeQuotes(c[2]));if(7===c.length){var f=this._sqlEquation(b[this._removeQuotes(c[0])],c[1],this._removeQuotes(c[2])),e=c[3],g=this._sqlEquation(b[this._removeQuotes(c[4])],c[5],this._removeQuotes(c[6]));switch(e){case "AND":return f&&g;case "OR":return f||g}}}return!1}catch(M){console.log("Error.: can't parse \x3d "+
a)}},_sqlEquation:function(a,b,c){switch(b){case "\x3d":return a==c?!0:!1;case "\x3c\x3e":return a!=c?!0:!1;case "\x3e":return a>c?!0:!1;case "\x3e\x3d":return a>=c?!0:!1;case "\x3c":return a<c?!0:!1;case "\x3c\x3d":return a<=c?!0:!1}return!1},_removeQuotes:function(a){var b=a.indexOf('"'),c=a.lastIndexOf('"');if(-1!=b&&-1!=c)return a.substr(1,a.length-2);b=a.indexOf("'");c=a.lastIndexOf("'");return-1!=b&&-1!=c?a.substr(1,a.length-2):a},_getSizeInfo:function(a){return a?a.sizeInfo||m.filter(a.visualVariables,
C)[0]:null},_addLabel:function(a,b,c,g,h,n,k){var l,m,p,u;if(a&&""!==d.trim(a)&&b){a=a.replace(/\s+/g," ");l=b.getSymbol(g);l instanceof t?(l=new t(l.toJson()),l.setVerticalAlignment("baseline"),l.setHorizontalAlignment("center")):l=l instanceof f?new f(l.toJson()):new t;l.setText(a);b.symbol=l;if(p=this._getProportionalSize(b.sizeInfo,g.attributes))l instanceof t?l.setSize(p):l instanceof f&&(l.setWidth(p),l.setHeight(p));u=p=0;if(c){m=c.getSymbol(g);var q=this._getSizeInfo(c),w;q&&(w=c.getSize(g,
{sizeInfo:q,resolution:k.getResolutionInMeters()}));if(w&&null!==w)p=u=w;else if(m)if("simplemarkersymbol"==m.type)u=p=m.size;else if("picturemarkersymbol"==m.type)p=m.width,u=m.height;else if("simplelinesymbol"==m.type||"cartographiclinesymbol"==m.type)p=m.width}c={};c.graphic=g;c.options=h;c.geometry=n;c.labelRenderer=b;c.labelSymbol=l;c.labelWidth=l.getWidth()/2;c.labelHeight=l.getHeight()/2;c.symbolWidth=e.normalizedLength(p)/2;c.symbolHeight=e.normalizedLength(u)/2;c.text=a;c.angle=l.angle;this._preparedLabels.push(c)}},
_buildLabelText:function(a,c,f,e){if(e.hasExpression)return a=B.executeFunction(e.compiledFunc,B.createExecContext(c,c._getViewInfo())),b.isDefined(a)?""+a:"";var h=c.attributes;return a.replace(/{[^}]*}/g,function(a){var c,n=a;for(c=0;c<f.length;c++)if("{"+f[c].name+"}"==a){var n=h[f[c].name],l=f[c].domain;if(l&&d.isObject(l)){if("codedValue"==l.type&&e.useCodedValues)for(c=n,a=0;a<l.codedValues.length;a++){if(l.codedValues[a].code==c){n=l.codedValues[a].name;break}}else"range"==l.type&&l.minValue<=
n&&n<=l.maxValue&&(n=l.name);break}l=f[c].type;if(e.fieldInfos){var t=e.fieldInfos;for(c=0;c<t.length;c++)if("{"+t[c].fieldName+"}"==a){a=t[c].format;"esriFieldTypeDate"==l?(a="DateFormat"+g.prototype._dateFormats[a.dateFormat?a.dateFormat:"shortDate"])&&(n=b.substitute({myKey:n},"${myKey:"+a+"}")):"esriFieldTypeInteger"!=l&&"esriFieldTypeSingle"!=l&&"esriFieldTypeSmallInteger"!=l&&"esriFieldTypeLong"!=l&&"esriFieldTypeDouble"!=l||!a||(n=q.format(n,{places:a.places}),a.digitSeparator||k.group&&(n=
n.replace(new RegExp("\\"+k.group,"g"),"")));break}}break}else n="";return null==n?"":n})},_getLabelExpression:function(a){var b="";a.labelExpressionInfo?b=a.labelExpressionInfo.value||a.labelExpressionInfo.expression:this._validSyntax(a.labelExpression)&&(b=this._convertLabelExpression(a.labelExpression));return b},_validSyntax:function(a){return/^(\s*\[[^\]]+\]\s*)+$/i.test(a)},_convertLabelExpression:function(a){return a.replace(RegExp("\\[","g"),"{").replace(RegExp("\\]","g"),"}")},_getProportionalSize:function(a,
c){if(!a)return null;var f=b.substitute(c,"${"+a.field+"}",{first:!0});return!(a.minSize&&a.maxSize&&a.minDataValue&&a.maxDataValue&&f)||0>=a.maxDataValue-a.minDataValue?null:(a.maxSize-a.minSize)/(a.maxDataValue-a.minDataValue)*(f-a.minDataValue)+a.minSize},_convertOptions:function(a){var b=!0,c="shortDate",f=null,e=null,g="",d=!0,h,n;if(a&&(a.format&&(c=a.format.dateFormat,f={places:a.format.places,digitSeparator:a.format.digitSeparator}),e=a.fieldInfos,g=a.labelPlacement,null!=a.useCodedValues&&
(b=a.useCodedValues),a=a.labelExpressionInfo)){var k=a.expression;k&&!a.value&&(n=!0,h=B.createFunction(k))}if("always-horizontal"==g||"esriServerPolygonPlacementAlwaysHorizontal"==g)d=!1;return{useCodedValues:b,dateFormat:c,numberFormat:f,fieldInfos:e,pointPriorities:"above-center"==g||"esriServerPointLabelPlacementAboveCenter"==g?"AboveCenter":"above-left"==g||"esriServerPointLabelPlacementAboveLeft"==g?"AboveLeft":"above-right"==g||"esriServerPointLabelPlacementAboveRight"==g?"AboveRight":"below-center"==
g||"esriServerPointLabelPlacementBelowCenter"==g?"BelowCenter":"below-left"==g||"esriServerPointLabelPlacementBelowLeft"==g?"BelowLeft":"below-right"==g||"esriServerPointLabelPlacementBelowRight"==g?"BelowRight":"center-center"==g||"esriServerPointLabelPlacementCenterCenter"==g?"CenterCenter":"center-left"==g||"esriServerPointLabelPlacementCenterLeft"==g?"CenterLeft":"center-right"==g||"esriServerPointLabelPlacementCenterRight"==g?"CenterRight":"AboveRight",lineLabelPlacement:"above-start"==g||"below-start"==
g||"center-start"==g?"PlaceAtStart":"above-end"==g||"below-end"==g||"center-end"==g?"PlaceAtEnd":"PlaceAtCenter",lineLabelPosition:"above-after"==g||"esriServerLinePlacementAboveAfter"==g||"above-along"==g||"esriServerLinePlacementAboveAlong"==g||"above-before"==g||"esriServerLinePlacementAboveBefore"==g||"above-start"==g||"esriServerLinePlacementAboveStart"==g||"above-end"==g||"esriServerLinePlacementAboveEnd"==g?"Above":"below-after"==g||"esriServerLinePlacementBelowAfter"==g||"below-along"==g||
"esriServerLinePlacementBelowAlong"==g||"below-before"==g||"esriServerLinePlacementBelowBefore"==g||"below-start"==g||"esriServerLinePlacementBelowStart"==g||"below-end"==g||"esriServerLinePlacementBelowEnd"==g?"Below":"center-after"==g||"esriServerLinePlacementCenterAfter"==g||"center-along"==g||"esriServerLinePlacementCenterAlong"==g||"center-before"==g||"esriServerLinePlacementCenterBefore"==g||"center-start"==g||"esriServerLinePlacementCenterStart"==g||"center-end"==g||"esriServerLinePlacementCenterEnd"==
g?"OnLine":"Above",labelRotation:d,howManyLabels:"OneLabel",hasExpression:n,compiledFunc:h}}})})},"esri/layers/labelLayerUtils/DynamicLabelClass":function(){define("dojo/_base/declare dojo/_base/lang dojo/has ../../kernel ../../geometry/Extent ../../geometry/Polygon".split(" "),function(r,l,d,q,k,m){return r(null,{declaredClass:"esri.layers.labelLayerUtils.DynamicLabelClass",constructor:function(){this._preparedLabels=[];this._placedLabels=[];this._extent=null;this._y1=this._x1=this._y0=this._x0=
this._ymax=this._ymin=this._xmax=this._xmin=0;this._scale=1},setMap:function(d,h){this._labelLayer=h;this._xmin=d.extent.xmin;this._xmax=d.extent.xmax;this._ymin=d.extent.ymin;this._ymax=d.extent.ymax;this._scale=(this._xmax-this._xmin)/d.width},_process:function(d){this._preparedLabels=d;this._placedLabels=[];var h;for(d=this._preparedLabels.length-1;0<=d;d--){var e=this._preparedLabels[d],c=Math.min(e.labelWidth,e.labelHeight),b=e.labelWidth+0*c,c=e.labelHeight+0*c,a=(h=e.options)&&void 0!==h.lineLabelPlacement?
h.lineLabelPlacement:"PlaceAtCenter",g=h&&void 0!==h.lineLabelPosition?h.lineLabelPosition:"Above",k=h&&void 0!==h.pointPriorities?h.pointPriorities:"AboveRight",n=[2,2,1,3,0,2,3,3,2];"AboveLeft"==k?n=[1,2,2,2,0,3,2,3,3]:"AboveCenter"==k?n=[2,1,2,2,0,2,3,3,3]:"AboveRight"==k?n=[2,2,1,3,0,2,3,3,2]:"CenterLeft"==k?n=[2,2,3,1,0,3,2,2,3]:"CenterCenter"==k?n=[0,0,0,0,1,0,0,0,0]:"CenterRight"==k?n=[3,2,2,3,0,1,3,2,2]:"BelowLeft"==k?n=[2,3,3,2,0,3,1,2,2]:"BelowCenter"==k?n=[3,3,3,2,0,2,2,1,2]:"BelowRight"==
k&&(n=[3,3,2,3,0,2,2,2,1]);var l=h&&void 0!==h.labelRotation?h.labelRotation:!0,k=Math.PI/180*e.angle;h=h&&void 0!==h.howManyLabels?h.howManyLabels:"OneLabel";if("point"==e.geometry.type)this._generatePointPositions(e,e.geometry.x,e.geometry.y,e.text,k,b,c,e.symbolWidth,e.symbolHeight,n);else if("multipoint"==e.geometry.type)for(a=e.geometry,g=0;g<a.points.length;g++)this._generatePointPositions(e,a.points[g][0],a.points[g][1],e.text,k,b,c,e.symbolWidth,e.symbolHeight,n);else"polyline"==e.geometry.type?
this._generateLinePositions(e,e.geometry,e.text,b,c,2*e.symbolHeight+c,a,g,l):"polygon"==e.geometry.type&&this._generatePolygonPositions(e,h,e.geometry,e.text,k,b,c)}return this._placedLabels},_generatePointPositions:function(d,h,e,c,b,a,g,k,n,l){k=(k+a)*this._scale;n=(n+g)*this._scale;var f,t;for(f=1;3>=f;f++)for(t=1;9>=t;t++)if(l[t-1]==f)switch(t){case 1:if(this._findPlace(d,c,h-k,e+n,b,a,g))return;break;case 2:if(this._findPlace(d,c,h,e+n,b,a,g))return;break;case 3:if(this._findPlace(d,c,h+k,e+
n,b,a,g))return;break;case 4:if(this._findPlace(d,c,h-k,e,b,a,g))return;break;case 5:if(this._findPlace(d,c,h,e,b,a,g))return;break;case 6:if(this._findPlace(d,c,h+k,e,b,a,g))return;break;case 7:if(this._findPlace(d,c,h-k,e-n,b,a,g))return;break;case 8:if(this._findPlace(d,c,h,e-n,b,a,g))return;break;case 9:if(this._findPlace(d,c,h+k,e-n,b,a,g))return}},_generateLinePositions:function(d,h,e,c,b,a,g,k,n){var l=c*this._scale*c*this._scale,f,m,p;for(f=0;f<h.paths.length;f++){var u=h.paths[f],q=u.length,
r=Math.floor((q-1)/2),y=0!==(q-1)%2?1:-1;"PlaceAtStart"==g&&(r=0,y=1);"PlaceAtEnd"==g&&(r=q-2,y=-1);for(;0<=r&&r<q-1;){for(m=r;m<q;m++){var B=u[r][0],C=u[r][1],E=u[m][0]-B,D=u[m][1]-C;if(E*E+D*D>l){for(var F=Math.atan2(D,E);F>Math.PI/2;)F-=Math.PI;for(;F<-(Math.PI/2);)F+=Math.PI;var G=Math.sin(F),J=Math.cos(F),N=0,M=0;"Above"==k&&(N=a*G*this._scale,M=a*J*this._scale);"Below"==k&&(N=-a*G*this._scale,M=-a*J*this._scale);if(1==m-r){if(this._clipLine(B,C,u[m][0],u[m][1])&&(B=this._x1-this._x0,p=this._y1-
this._y0,B*B+p*p>l&&(m=Math.atan2(p,B),E=c/2+2*b,C=E*this._scale*Math.cos(m),E=E*this._scale*Math.sin(m),"PlaceAtStart"==g?(B=this._x0+C,p=this._y0+E):"PlaceAtEnd"==g?(B=this._x1-C,p=this._y1-E):(B=this._x0+B/2,p=this._y0+p/2),this._findPlace(d,e,B-N,p+M,n?-m:0,c,b))))return}else{var L=0;for(p=r;p<=m;p++)L=Math.max(L,Math.abs((u[p][1]-C)*J-(u[p][0]-B)*G));if(L<b&&this._findPlace(d,e,B+E/2-N,C+D/2+M,n?-F:0,c,b))return}break}}r+=y}}},_generatePolygonPositions:function(d,h,e,c,b,a,g){var k;if("ManyLabels"==
h)for(h=0;h<e.rings.length;h++)k=e.rings[h],m.prototype.isClockwise(k)&&(k=this._findCentroid(k,this._xmin,this._ymin,this._xmax,this._ymax),this._findPlace(d,c,k[0],k[1],b,a,g));else{k=this._findCentroidForFeature(e,this._xmin,this._ymin,this._xmax,this._ymax);var n=k[1],l=0;for(h=0;10>h;h++){l+=g/4;k=this._findCentroidForFeature(e,this._xmin,n+(l-g/4),this._xmax,n+(l+g/4));if(this._findPlace(d,c,k[0],k[1],b,a,g))break;k=this._findCentroidForFeature(e,this._xmin,n-(l+g/4),this._xmax,n-(l-g/4));if(this._findPlace(d,
c,k[0],k[1],b,a,g))break}}},_findCentroid:function(d,h,e,c,b){var a=d.length,g=[0,0],k=0,n=d[0][0],l=d[0][1];n>c&&(n=c);n<h&&(n=h);l>b&&(l=b);l<e&&(l=e);for(var f=1;f<a-1;f++){var m=d[f][0],p=d[f][1],q=d[f+1][0],z=d[f+1][1];m>c&&(m=c);m<h&&(m=h);p>b&&(p=b);p<e&&(p=e);q>c&&(q=c);q<h&&(q=h);z>b&&(z=b);z<e&&(z=e);var r=(m-n)*(z-l)-(q-n)*(p-l);g[0]+=r*(n+m+q);g[1]+=r*(l+p+z);k+=r}g[0]/=3*k;g[1]/=3*k;if(isNaN(g[0])||isNaN(g[1]))return g;e=[];this._fillBuffer(d,e,g);g[0]=this._sortBuffer(e,g[0],h,c);return g},
_findCentroidForFeature:function(d,h,e,c,b){for(var a,g=0,k=[0,0],n=0;n<d.rings.length;n++){var l=d.rings[n],f=l.length,m=l[0][0],p=l[0][1];m>c&&(m=c);m<h&&(m=h);p>b&&(p=b);p<e&&(p=e);for(a=1;a<f-1;a++){var q=l[a][0],z=l[a][1],r=l[a+1][0],y=l[a+1][1];q>c&&(q=c);q<h&&(q=h);z>b&&(z=b);z<e&&(z=e);r>c&&(r=c);r<h&&(r=h);y>b&&(y=b);y<e&&(y=e);var B=(q-m)*(y-p)-(r-m)*(z-p);k[0]+=B*(m+q+r);k[1]+=B*(p+z+y);g+=B}}k[0]/=3*g;k[1]/=3*g;if(isNaN(k[0])||isNaN(k[1]))return k;e=[];for(a=0;a<d.rings.length;a++)this._fillBuffer(d.rings[a],
e,k);k[0]=this._sortBuffer(e,k[0],h,c);return k},_fillBuffer:function(d,h,e){for(var c=d.length-1,b=d[0][1]>=d[c][1]?1:-1,a=0;a<=c;a++){var g=a,k=a+1;a==c&&(k=0);var n=d[g][0],g=d[g][1],l=d[k][0],k=d[k][1],f=k>=g?1:-1;if(g<=e[1]&&e[1]<=k||k<=e[1]&&e[1]<=g)e[1]!=g&&e[1]!=k?(h.push((e[1]-g)*(l-n)/(k-g)+n),b=f):e[1]==g&&e[1]!=k?(b!=f&&h.push(n),b=f):e[1]!=g&&e[1]==k?(h.push(l),b=f):e[1]==g&&e[1]==k&&(1==b&&h.push(n),h.push(l),b=f)}},_sortBuffer:function(d,h,e,c){var b=d.length;d.sort();if(0<b){for(var a=
0,g=h=0;g<b-1;g+=2){var k=Math.abs(d[g+1]-d[g]);!(d[g]<=e&&d[g+1]<=e||d[g]>=c&&d[g+1]>=c)&&k>a&&(a=k,h=g)}b=d[h];d=d[h+1];b>c&&(b=c);b<e&&(b=e);d>c&&(d=c);d<e&&(d=e);h=(b+d)/2}return h},_findPlace:function(d,h,e,c,b,a,g){if(isNaN(e)||isNaN(c))return!1;for(var l=0;l<this._placedLabels.length;l++){var n=this._placedLabels[l].angle,t=this._placedLabels[l].width*this._scale,f=this._placedLabels[l].height*this._scale,p=this._placedLabels[l].x-e,q=this._placedLabels[l].y-c;if(0===b&&0===n){if(this._findPlace2(-a*
this._scale,-g*this._scale,a*this._scale,g*this._scale,p-t,q-f,p+t,q+f))return!1}else{var w=new k(-a*this._scale,-g*this._scale,a*this._scale,g*this._scale,null),z=0,r=1;0!==b&&(z=Math.sin(b),r=Math.cos(b));var y=p*r-q*z,p=p*z+q*r,n=n-b,z=Math.sin(n),r=Math.cos(n),B=-t*r- -f*z,q=-t*z+-f*r,n=+t*r- -f*z,C=+t*z+-f*r,t=y+B,f=p-q,z=y+n,r=p-C,B=y-B,q=p+q,y=y-n,p=p+C,n=new m;n.addRing([[t,f],[z,r],[B,q],[y,p],[t,f]]);if(w.intersects(n))return!1}}for(;b>Math.PI/2;)b-=Math.PI;for(;b<-(Math.PI/2);)b+=Math.PI;
l={};l.layer=d;l.text=h;l.angle=b;l.x=e;l.y=c;l.width=a;l.height=g;this._placedLabels.push(l);return!0},_findPlace2:function(d,h,e,c,b,a,g,k){return(d>=b&&d<=g||e>=b&&e<=g||d<=b&&e>=g)&&(h>=a&&h<=k||c>=a&&c<=k||h<=a&&c>=k)?!0:!1},_clipLine:function(d,h,e,c){for(var b=this._code(d,h),a=this._code(e,c);0!==b||0!==a;){if(0!==(b&a))return!1;var g=e-d,k=c-h;0!==b?(d<this._xmin?(h+=k*(this._xmin-d)/g,d=this._xmin):d>this._xmax?(h+=k*(this._xmax-d)/g,d=this._xmax):h<this._ymin?(d+=g*(this._ymin-h)/k,h=this._ymin):
h>this._ymax&&(d+=g*(this._ymax-h)/k,h=this._ymax),b=this._code(d,h)):(e<this._xmin?(c+=k*(this._xmin-e)/g,e=this._xmin):e>this._xmax?(c+=k*(this._xmax-e)/g,e=this._xmax):c<this._ymin?(e+=g*(this._ymin-c)/k,c=this._ymin):c>this._ymax&&(e+=g*(this._ymax-c)/k,c=this._ymax),a=this._code(e,c))}this._x0=d;this._y0=h;this._x1=e;this._y1=c;return!0},_code:function(d,h){var e=0;d<this._xmin&&(e+=8);d>this._xmax&&(e+=4);h<this._ymin&&(e+=2);h>this._ymax&&(e+=1);return e}})})},"esri/layers/labelLayerUtils/StaticLabelClass":function(){define("dojo/_base/declare dojo/_base/lang dojo/has ../../kernel ../../geometry/Extent ../../geometry/Point ../../geometry/Polygon".split(" "),
function(r,l,d,q,k,m,p){return r(null,{declaredClass:"esri.layers.labelLayerUtils.StaticLabel",constructor:function(){this._preparedLabels=[];this._placedLabels=[];this._extent=null;this._ymax=this._ymin=this._xmax=this._xmin=0;this._scale=1;this._LINE_STEP_CONST=1.5;this._POLYGON_X_STEP_CONST=1;this._POLYGON_Y_STEP_CONST=.75;this._OVERRUN=2},setMap:function(d,e){this._labelLayer=e;this._map=d;this._xmin=d.extent.xmin;this._xmax=d.extent.xmax;this._ymin=d.extent.ymin;this._ymax=d.extent.ymax;this._scale=
(this._xmax-this._xmin)/d.width},_process:function(d){var e,c,b,a,g,h,n,k,f;this._preparedLabels=d;this._placedLabels=[];for(d=this._preparedLabels.length-1;0<=d;d--){e=this._preparedLabels[d];g=e.labelWidth;h=e.labelHeight;k=(n=e.options)&&n.lineLabelPlacement?n.lineLabelPlacement:"PlaceAtCenter";f=n&&n.lineLabelPosition?n.lineLabelPosition:"Above";c=n&&n.labelRotation?n.labelRotation:!0;b=Math.PI/180*e.angle;a=n&&n.howManyLabels?n.howManyLabels:"OneLabel";var l=[];if("point"===e.geometry.type)this._generatePointPositions(e.geometry.x,
e.geometry.y,e.text,b,g,h,e.symbolWidth,e.symbolHeight,n,l);else if("multipoint"===e.geometry.type)for(c=0;c<e.geometry.points.length;c++)this._generatePointPositions(e.geometry.points[c][0],e.geometry.points[c][1],e.text,b,g,h,e.symbolWidth,e.symbolHeight,n,l);else if("polyline"===e.geometry.type)if("PlaceAtStart"===k)this._generateLinePositionsPlaceAtStart(e.geometry,!0,e.text,g,h,2*e.symbolHeight+h,k,f,c,l);else if("PlaceAtEnd"===k)this._generateLinePositionsPlaceAtEnd(e.geometry,!0,e.text,g,h,
2*e.symbolHeight+h,k,f,c,l);else{n=[];var q=e.geometry.getExtent(),w=this._map.extent;if(q.getWidth()<g*this._scale/this._OVERRUN&&q.getHeight()<g*this._scale/this._OVERRUN)continue;else.5*q.getWidth()<w.getWidth()&&.5*q.getHeight()<w.getHeight()?this._generateLinePositionsPlaceAtCenter(e.geometry,!1,.1*Math.min(this._map.width,this._map.height)*this._scale,e.text,g,h,2*e.symbolHeight+h,k,f,c,n):this._generateLinePositionsPlaceAtCenter(e.geometry,!0,.2*Math.min(this._map.width,this._map.height)*this._scale,
e.text,g,h,2*e.symbolHeight+h,k,f,c,n);this._postSorting(w,n,l)}else if("polygon"===e.geometry.type){k=[];for(c=0;c<e.geometry.rings.length;c++)f=e.geometry.rings[c],1<e.geometry.rings.length&&!p.prototype.isClockwise(f)||(n=this._calcRingExtent(f),n.xmax-n.xmin<4*g*this._scale/this._OVERRUN&&n.ymax-n.ymin<4*h*this._scale/this._OVERRUN||k.push(f));k.sort(function(a,b){return b.length-a.length});for(c=0;c<k.length;c++)this._generatePolygonPositionsForManyLabels(k[c],e.geometry.spatialReference,e.text,
b,g,h,l)}for(c=0;c<l.length&&(k=l[c].x,f=l[c].y,void 0!==l[c].angle&&(b=l[c].angle),n=this._findPlace(e,e.text,k,f,b,g,h),"OneLabel"!==a||!n||!this._labelLayer._isWithinScreenArea(new m(k,f,e.geometry.spatialReference)));c++);}return this._placedLabels},_generatePointPositions:function(d,e,c,b,a,g,k,n,l,f){c=l&&l.pointPriorities?l.pointPriorities:"AboveRight";a=(k+a)*this._scale;g=(n+g)*this._scale;switch(c.toLowerCase()){case "aboveleft":d-=a;e+=g;break;case "abovecenter":e+=g;break;case "aboveright":d+=
a;e+=g;break;case "centerleft":d-=a;break;case "centercenter":break;case "centerright":d+=a;break;case "belowleft":d-=a;e-=g;break;case "belowcenter":e-=g;break;case "belowright":d+=a;e-=g;break;default:return}f.push({x:d,y:e})},_generateLinePositionsPlaceAtStart:function(d,e,c,b,a,g,k,n,l,f){k=b*this._scale;var h=this._LINE_STEP_CONST*Math.min(this._map.width,this._map.height)*this._scale,m,t,p,u,q,r,C,E;for(m=0;m<d.paths.length;m++){var D=d.paths[m],F=k,G=0;for(t=0;t<D.length-1;t++)p=D[t][0],u=
D[t][1],q=D[t+1][0],r=D[t+1][1],C=q-p,E=r-u,C=Math.sqrt(C*C+E*E),G+C>F?(G=this._generatePositionsOnLine(d.spatialReference,e,F,h,G,p,u,q,r,c,b,a,g,n,l,f),F=h):G+=C}},_generateLinePositionsPlaceAtEnd:function(d,e,c,b,a,g,k,n,l,f){k=b*this._scale;var h=this._LINE_STEP_CONST*Math.min(this._map.width,this._map.height)*this._scale,m,t,p,u,q,r,C,E;for(m=0;m<d.paths.length;m++){var D=d.paths[m],F=k,G=0;for(t=D.length-2;0<=t;t--)p=D[t+1][0],u=D[t+1][1],q=D[t][0],r=D[t][1],C=q-p,E=r-u,C=Math.sqrt(C*C+E*E),
G+C>F?(G=this._generatePositionsOnLine(d.spatialReference,e,F,h,G,p,u,q,r,c,b,a,g,n,l,f),F=h):G+=C}},_generateLinePositionsPlaceAtCenter:function(d,e,c,b,a,g,k,n,l,f,m){var h,t,p,u,q,v,r,E;for(n=0;n<d.paths.length;n++){var D=d.paths[n];if(!(2>D.length)){if(2==D.length){u=D[0];h=D[1];p=u[0];u=u[1];D=h[0];v=h[1];q=(D-p)*(D-p)+(v-u)*(v-u);r=Math.atan2(v-u,D-p);v=Math.cos(r);r=Math.sin(r);D=[];E=p;for(var F=u;(E-p)*(E-p)+(F-u)*(F-u)<q;)D.push([E,F]),E+=c/2*v,F+=c/2*r;D.push(h)}var G=0;for(h=0;h<D.length-
1;h++)p=D[h][0],u=D[h][1],q=D[h+1][0],v=D[h+1][1],r=q-p,E=v-u,G+=Math.sqrt(r*r+E*E);for(h=F=0;h<D.length-1;h++){p=D[h][0];u=D[h][1];q=D[h+1][0];v=D[h+1][1];r=q-p;E=v-u;r=Math.sqrt(r*r+E*E);if(F+r>G/2)break;F+=r}h==D.length-1&&h--;p=D[h][0];u=D[h][1];q=D[h+1][0];v=D[h+1][1];r=q-p;E=v-u;F=G/2-F;r=Math.atan2(E,r);E=p+F*Math.cos(r);r=u+F*Math.sin(r);p=this._angleAndShifts(p,u,q,v,k,l,f);m.push({x:E+p.shiftX,y:r+p.shiftY,angle:p.angle});var G=E,J=r,F=0;for(t=h;t<D.length-1;t++)t==h?(p=G,u=J):(p=D[t][0],
u=D[t][1]),q=D[t+1][0],v=D[t+1][1],r=q-p,E=v-u,r=Math.sqrt(r*r+E*E),F=F+r>c?this._generatePositionsOnLine(d.spatialReference,e,c,c,F,p,u,q,v,b,a,g,k,l,f,m):F+r;F=0;for(t=h;0<=t;t--)t==h?(p=G,u=J):(p=D[t+1][0],u=D[t+1][1]),q=D[t][0],v=D[t][1],r=q-p,E=v-u,r=Math.sqrt(r*r+E*E),F=F+r>c?this._generatePositionsOnLine(d.spatialReference,e,c,c,F,p,u,q,v,b,a,g,k,l,f,m):F+r}}},_generatePositionsOnLine:function(d,e,c,b,a,g,l,n,m,f,p,q,w,z,r,y){f=Math.atan2(m-l,n-g);p=g;q=l;var h=p,t=q;do if(a=c-a,p+=a*Math.cos(f),
q+=a*Math.sin(f),this._belongs(p,q,g,l,n,m))a=this._angleAndShifts(g,l,n,m,w,z,r),c=p+a.shiftX,t=q+a.shiftY,e?this._labelLayer._isWithinScreenArea(new k(c,t,c,t,d))&&y.push({x:c,y:t,angle:a.angle}):y.push({x:c,y:t,angle:a.angle}),h=p,t=q,a=0,c=b;else return d=n-h,m-=t,Math.sqrt(d*d+m*m);while(1)},_postSorting:function(d,e,c){if(d&&0<e.length){var b=.5*(d.xmin+d.xmax);d=.5*(d.ymin+d.ymax);for(var a=e[0].x,g=e[0].y,h=Math.sqrt((a-b)*(a-b)+(g-d)*(g-d)),n=e[0].angle,k=0;k<e.length;k++){var f=e[k].x,l=
e[k].y,m=Math.sqrt((f-b)*(f-b)+(l-d)*(l-d));m<h&&(a=f,g=l,h=m,n=e[k].angle)}c.push({x:a,y:g,angle:n})}},_belongs:function(d,e,c,b,a,g){if(a==c&&g==b)return!1;if(a>c){if(d>a||d<c)return!1}else if(d<a||d>c)return!1;if(g>b){if(e>g||e<b)return!1}else if(e<g||e>b)return!1;return!0},_angleAndShifts:function(d,e,c,b,a,g,k){for(d=Math.atan2(b-e,c-d);d>Math.PI/2;)d-=Math.PI;for(;d<-(Math.PI/2);)d+=Math.PI;b=Math.sin(d);var h=Math.cos(d);c=e=0;"Above"==g&&(e=a*b*this._scale,c=a*h*this._scale);"Below"==g&&(e=
-a*b*this._scale,c=-a*h*this._scale);a=[];a.angle=k?-d:0;a.shiftX=-e;a.shiftY=c;return a},_generatePolygonPositionsForManyLabels:function(d,e,c,b,a,g,k){a=this._findCentroidForRing(d);b=a[0];var h=a[1],l=this._calcRingExtent(d);a=l.xmin;g=l.ymin;var f=l.xmax,l=l.ymax,m=(l-g)/(this._map.height*this._scale);if(!(10<(f-a)/(this._map.width*this._scale)&&10<m)){var p=!0;if(f-a>this._map.width*this._scale||l-g>this._map.height*this._scale)p=!1;var m=this._map.width*this._scale*(p?.1875:.5),p=this._map.height*
this._scale*(p?.1875:.5),u=!0,q=!0,r=0;do{h+=(r%2?-1:1)*r*p;if(this._scanRingByX(c,e,d,b,h,a,f,m,k))break;h<g&&(u=!1);h>l&&(q=!1);r++}while(u||q)}},_scanRingByX:function(d,e,c,b,a,g,l,n,m){var f=!0,h=!0,t=0,p=1E3;do{b+=(t%2?-1:1)*t*n;var u=this._movePointInsideRing(c,b,a),q=this._labelLayer._isWithinScreenArea(new k(u,a,u,a,e)),r=this._isPointWithinRing(d,c,u,a);if(q&&r)return m.push({x:u,y:a}),!0;b<g&&(f=!1);b>l&&(h=!1);t++;p--;if(0>=p)return!0}while(f||h);return!1},_movePointInsideRing:function(d,
e,c){for(var b=[],a=d.length-1,g=d[0][1]>=d[a][1]?1:-1,h=0;h<=a;h++){var n=h,k=h+1;h==a&&(k=0);var f=d[n][0],n=d[n][1],l=d[k][0],k=d[k][1],m=k>=n?1:-1;if(n<=c&&c<=k||k<=c&&c<=n)c!=n&&c!=k?(b.push((c-n)*(l-f)/(k-n)+f),g=m):c==n&&c!=k?(g!=m&&b.push(f),g=m):c!=n&&c==k?(b.push(l),g=m):c==n&&c==k&&(1==g&&b.push(f),b.push(l),g=m)}b.sort(function(a,b){return a-b});d=b.length;if(0<d){for(h=c=e=0;h<d-1;h+=2)a=Math.abs(b[h+1]-b[h]),a>e&&(e=a,c=h);e=(b[c]+b[c+1])/2}return e},_calcRingExtent:function(d){var e,
c;c=new k;for(e=0;e<d.length-1;e++){var b=d[e][0],a=d[e][1];if(void 0===c.xmin||b<c.xmin)c.xmin=b;if(void 0===c.ymin||a<c.ymin)c.ymin=a;if(void 0===c.xmax||b>c.xmax)c.xmax=b;if(void 0===c.ymax||a>c.ymax)c.ymax=a}return c},_isPointWithinPolygon:function(d,e,c,b){var a;for(a=0;a<e.rings.length;a++)if(this._isPointWithinRing(d,e.rings[a],c,b))return!0;return!1},_isPointWithinRing:function(d,e,c,b){var a,g,h,n,k=[],f=e.length;for(d=0;d<f-1;d++)if(a=e[d][0],g=e[d][1],h=e[d+1][0],n=e[d+1][1],a!=h||g!=n){if(g==
n)if(b==g)k.push(a);else continue;a==h?(g<n&&b>=g&&b<n&&k.push(a),g>n&&b<=g&&b>n&&k.push(a)):(g=(h-a)/(n-g)*(b-g)+a,a<h&&g>=a&&g<h&&k.push(g),a>h&&g<=a&&g>h&&k.push(g))}k.sort(function(a,b){return a-b});for(d=0;d<k.length-1;d++)if(a=k[d],h=k[d+1],c>=a&&c<h)if(d%2)break;else return!0;return!1},_findCentroidForRing:function(d){for(var e=d.length,c=[0,0],b=0,a=d[0][0],g=d[0][1],h=1;h<e-1;h++){var n=d[h][0],k=d[h][1],f=d[h+1][0],l=d[h+1][1],m=(n-a)*(l-g)-(f-a)*(k-g);c[0]+=m*(a+n+f);c[1]+=m*(g+k+l);b+=
m}c[0]/=3*b;c[1]/=3*b;return c},_findCentroidForFeature:function(d){for(var e=0,c=[0,0],b=0;b<d.rings.length;b++)for(var a=d.rings[b],g=a.length,h=a[0][0],n=a[0][1],k=1;k<g-1;k++){var f=a[k][0],l=a[k][1],m=a[k+1][0],p=a[k+1][1],q=(f-h)*(p-n)-(m-h)*(l-n);c[0]+=q*(h+f+m);c[1]+=q*(n+l+p);e+=q}c[0]/=3*e;c[1]/=3*e;return c},_findPlace:function(d,e,c,b,a,g,l){if(isNaN(c)||isNaN(b))return!1;for(var h=0;h<this._placedLabels.length;h++){var m=this._placedLabels[h].angle,f=this._placedLabels[h].width*this._scale,
q=this._placedLabels[h].height*this._scale,u=this._placedLabels[h].x-c,w=this._placedLabels[h].y-b;if(0===a&&0===m){if(this._findPlace2(-g*this._scale,-l*this._scale,g*this._scale,l*this._scale,u-f,w-q,u+f,w+q))return!1}else{var z=new k(-g*this._scale,-l*this._scale,g*this._scale,l*this._scale,null),r=0,y=1;0!==a&&(r=Math.sin(a),y=Math.cos(a));var B=u*y-w*r,u=u*r+w*y,m=m-a,r=Math.sin(m),y=Math.cos(m),C=-f*y- -q*r,w=-f*r+-q*y,m=+f*y- -q*r,E=+f*r+-q*y,f=B+C,q=u-w,r=B+m,y=u-E,C=B-C,w=u+w,B=B-m,u=u+E,
m=new p;m.addRing([[f,q],[r,y],[C,w],[B,u],[f,q]]);if(z.intersects(m))return!1}}for(;a>Math.PI/2;)a-=Math.PI;for(;a<-(Math.PI/2);)a+=Math.PI;h={};h.layer=d;h.text=e;h.angle=a;h.x=c;h.y=b;h.width=g;h.height=l;this._placedLabels.push(h);return!0},_findPlace2:function(d,e,c,b,a,g,k,n){return(d>=a&&d<=k||c>=a&&c<=k||d<=a&&c>=k)&&(e>=g&&e<=n||b>=g&&b<=n||e<=g&&b>=n)?!0:!1}})})},"esri/dijit/Legend":function(){define("dojo/_base/kernel dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/connect dojo/_base/json dojo/_base/Color dojo/debounce dojo/has dojo/sniff dojo/Deferred dojo/DeferredList dojo/json dojo/dom dojo/dom-construct dojo/dom-style dojo/dom-class dijit/_Widget dojox/gfx dojox/gfx/matrix dojox/html/entities ../kernel ../config ../request ../lang ../numberUtils ../renderers/utils ../renderers/SimpleRenderer ../renderers/UniqueValueRenderer ../renderers/ClassBreaksRenderer ../renderers/ScaleDependentRenderer ../renderers/DotDensityRenderer ../renderers/TemporalRenderer ../renderers/VectorFieldRenderer ../renderers/HeatmapRenderer ../symbols/PictureFillSymbol ../symbols/SimpleLineSymbol ../symbols/jsonUtils ../renderers/jsonUtils ./_EventedWidget dojo/i18n!../nls/jsapi".split(" "),
function(r,l,d,q,k,m,p,h,e,c,b,a,g,u,n,t,f,v,x,w,z,A,y,B,C,E,D,F,G,J,N,M,L,K,W,R,ba,O,Q,U,ia){var Y=l([U,v],{declaredClass:"esri.dijit.Legend",widgetsInTemplate:!1,layers:null,alignRight:!1,hoverLabelShowing:!1,_preserveCacheOnDestroy:!1,dotDensitySwatchSize:26,dotCoverage:75,gradientHeight:30,transparencyRampColor:new p([64,64,64]),defaultText:"Aa",sizeRampLightColor:new p([255,255,255]),sizeRampDarkColor:new p([128,128,128]),layerConnects:[],gradientWidth:34,colorRampBorder:"1px solid",_specialChars:{lt:"\x3c",
gt:"\x3e"},_ieTimer:100,_isRightToLeft:!1,_align:null,_legendAlign:null,constructor:function(a,b){d.mixin(this,ia.widgets.legend);this._i18n=ia.widgets.legend;a=a||{};a.map?b?(this.map=a.map,this.layerInfos=a.layerInfos,this._respectCurrentMapScale=!1===a.respectCurrentMapScale?!1:!0,this._respectVisibility=!1===a.respectVisibility?!1:!0,this._preserveCacheOnDestroy=a.preserveCacheOnDestroy?!0:!1,this.arrangement=a.arrangement===Y.ALIGN_RIGHT?Y.ALIGN_RIGHT:Y.ALIGN_LEFT,this.arrangement===Y.ALIGN_RIGHT&&
(this.alignRight=!0),this.autoUpdate=!1===a.autoUpdate?!1:!0,this._surfaceItems=[],this.hideLayersInLegend={},this.refresh=h(this.refresh,0)):console.error("esri.dijit.Legend: must specify a container for the legend"):console.error("esri.dijit.Legend: unable to find the 'map' property in parameters")},postMixInProperties:function(){this.inherited(arguments);var a=["ar","he"],b,c;for(b=0;b<a.length;b+=1)c=a[b],r.locale&&-1!==r.locale.indexOf(c)&&(-1!==r.locale.indexOf("-")?-1!==r.locale.indexOf(c+
"-")&&(this._isRightToLeft=!0):this._isRightToLeft=!0);this._isRightToLeft?(this._align=this.alignRight?"left":"right",this._legendAlign=this.alignRight?"esriLegendLeft":"esriLegendRight"):(this._align=this.alignRight?"right":"left",this._legendAlign=this.alignRight?"esriLegendRight":"esriLegendLeft")},startup:function(){this.inherited(arguments);this._initialize();9>e("ie")&&(this._repaintItems=d.hitch(this,this._repaintItems),setTimeout(this._repaintItems,this._ieTimer))},destroy:function(){this._deactivate();
this._removeCachedLegendResponses();this._removeHoverHandlers();this.inherited(arguments)},_removeCachedLegendResponses:function(){this._preserveCacheOnDestroy||q.forEach(this.layers,function(a){delete a.legendResponse})},refresh:function(a){if(this.domNode){a?(this.layerInfos=a,this.layers=[],q.forEach(this.layerInfos,function(a){this._isSupportedLayerType(a.layer)&&(a.title&&(a.layer._titleForLegend=a.title),a.layer._hideDefaultSymbol=!1===a.defaultSymbol?!0:!1,a.hideLayers?(this.hideLayersInLegend[a.layer.id]=
a.hideLayers,this._addSubLayersToHide(a)):this.hideLayersInLegend[a.layer.id]=[],a.hoverLabel&&(a.layer._hoverLabel=a.hoverLabel),a.hoverLabels&&(a.layer._hoverLabels=a.hoverLabels),this.layers.push(a.layer))},this)):this.useAllMapLayers&&(this.layers=this.layerInfos=null);for(a=this.domNode.children.length-1;0<=a;a--)n.destroy(this.domNode.children[a]);this._removeHoverHandlers();this.startup()}},_legendUrl:"http://utility.arcgis.com/sharing/tools/legend",_initialize:function(){this.layerInfos&&
(this.layers=[],q.forEach(this.layerInfos,function(a){this._isSupportedLayerType(a.layer)&&(a.title&&(a.layer._titleForLegend=a.title),a.layer._hideDefaultSymbol=!1===a.defaultSymbol?!0:!1,a.hideLayers?(this.hideLayersInLegend[a.layer.id]=a.hideLayers,this._addSubLayersToHide(a)):this.hideLayersInLegend[a.layer.id]=[],a.hoverLabel&&(a.layer._hoverLabel=a.hoverLabel),a.hoverLabels&&(a.layer._hoverLabels=a.hoverLabels),this.layers.push(a.layer))},this));this.useAllMapLayers=!1;if(!this.layers){this.useAllMapLayers=
!0;this.layers=[];var a=[],b=[];q.forEach(this.map.layerIds,function(c){c=this.map.getLayer(c);var f;this._isSupportedLayerType(c)&&(c.arcgisProps&&c.arcgisProps.title&&(c._titleForLegend=c.arcgisProps.title),this.layers.push(c));"esri.layers.KMLLayer"==c.declaredClass&&(f=c.getLayers(),q.forEach(f,function(b){a.push(b.id)},this));"esri.layers.GeoRSSLayer"==c.declaredClass&&(f=c.getFeatureLayers(),q.forEach(f,function(a){b.push(a.id)},this))},this);q.forEach(this.map.graphicsLayerIds,function(c){var f=
this.map.getLayer(c);-1==q.indexOf(a,c)&&-1==q.indexOf(b,c)&&this._isSupportedLayerType(f)&&this._isLayerDrawingEnabled(f)&&(f.arcgisProps&&f.arcgisProps.title&&(f._titleForLegend=f.arcgisProps.title),this.layers.push(f))},this)}this._createLegend()},_isLayerDrawingEnabled:function(a){return a&&(a._params&&a._params.drawMode||a.isAggregationEnabled&&a.isAggregationEnabled())},_activate:function(){this._deactivate();this.autoUpdate&&(this._respectCurrentMapScale&&(this._ozeConnect=k.connect(this.map,
"onZoomEnd",this,"_refreshLayers")),this.useAllMapLayers&&(this._olaConnect=k.connect(this.map,"onLayerAdd",this,"_updateAllMapLayers"),this._olrConnect=k.connect(this.map,"onLayerRemove",this,"_updateAllMapLayers"),this._olroConnect=k.connect(this.map,"onLayersReordered",this,"_updateAllMapLayers")),q.forEach(this.layers,function(a){var b={};b.oarcConnect=k.connect(a,"onAggregationRendererChange",this,"_refreshLayers");b.oaicConnect=k.connect(a,"onAggregationInfoChange",this,"_refreshLayers");b.ovcConnect=
k.connect(a,"onVisibilityChange",this,"_refreshLayers");b.oocConnect=k.connect(a,"onOpacityChange",this,"_refreshLayers");b.oscConnect=k.connect(a,"onScaleRangeChange",this,"_refreshLayers");"esri.layers.ArcGISDynamicMapServiceLayer"===a.declaredClass&&a.supportsDynamicLayers&&(b.odcConnect=k.connect(a,"_onDynamicLayersChange",d.hitch(this,"_updateDynamicLayers",a)));"esri.layers.ArcGISImageServiceLayer"===a.declaredClass&&(b.oirConnect=k.connect(a,"onRenderingChange",d.partial(this._updateImageServiceLayers,
this,a)),b.oivrConnect=k.connect(a,"onRendererChange",d.partial(this._updateImageServiceLayers,this,a)));"esri.layers.ArcGISImageServiceVectorLayer"===a.declaredClass&&(b.oivrConnect=k.connect(a,"onRendererChange",d.hitch(this,"_refreshLayers")));this.layerConnects[a.id]=b},this))},_deactivate:function(){this._ozeConnect&&k.disconnect(this._ozeConnect);this._olaConnect&&k.disconnect(this._olaConnect);this._olroConnect&&k.disconnect(this._olroConnect);this._olrConnect&&k.disconnect(this._olrConnect);
q.forEach(this.layers,function(a){a=this.layerConnects[a.id]||{};a.oarcConnect&&k.disconnect(a.oarcConnect);a.oaicConnect&&k.disconnect(a.oaicConnect);a.ovcConnect&&k.disconnect(a.ovcConnect);a.oocConnect&&k.disconnect(a.oocConnect);a.oscConnect&&k.disconnect(a.oscConnect);a.odcConnect&&k.disconnect(a.odcConnect);a.oirConnect&&k.disconnect(a.oirConnect);a.oivrConnect&&k.disconnect(a.oivrConnect)},this);this.layerConnects=[]},_updateDynamicLayers:function(a){delete a.legendResponse;this._refreshLayers()},
_updateImageServiceLayers:function(a,b){delete b.legendResponse;a._refreshLayers()},_refreshLayers:function(){this.refresh()},_updateAllMapLayers:function(){this.layers=[];q.forEach(this.map.layerIds,function(a){a=this.map.getLayer(a);this._isSupportedLayerType(a)&&this.layers.push(a)},this);q.forEach(this.map.graphicsLayerIds,function(a){a=this.map.getLayer(a);this._isSupportedLayerType(a)&&this._isLayerDrawingEnabled(a)&&this.layers.push(a)},this);this.refresh()},_createLegend:function(){var b=
!1,c=!1;t.set(this.domNode,"position","relative");n.create("div",{id:this.id+"_msg",className:"esriLegendMsg",innerHTML:this.NLS_creatingLegend+"..."},this.domNode);var f=[];q.forEach(this.layers,function(a){if("esri.layers.KMLLayer"==a.declaredClass||"esri.layers.GeoRSSLayer"==a.declaredClass){var e;a.loaded?("esri.layers.KMLLayer"==a.declaredClass?e=a.getLayers():"esri.layers.GeoRSSLayer"==a.declaredClass&&(e=a.getFeatureLayers(),this.hideLayersInLegend[a.id]&&(e=q.filter(e,function(b){return-1==
q.indexOf(this.hideLayersInLegend[a.id],b.id)},this))),q.forEach(e,function(b){"esri.layers.FeatureLayer"==b.declaredClass&&a._titleForLegend&&(b._titleForLegend=a._titleForLegend+" - ","esriGeometryPoint"==b.geometryType?b._titleForLegend+=this.NLS_points:"esriGeometryPolyline"==b.geometryType?b._titleForLegend+=this.NLS_lines:"esriGeometryPolygon"==b.geometryType&&(b._titleForLegend+=this.NLS_areas),f.push(b))},this)):k.connect(a,"onLoad",d.hitch(this,function(){this.refresh(this.layerInfos)}))}else if("esri.layers.WMSLayer"===
a.declaredClass)if(!a.loaded)k.connect(a,"onLoad",d.hitch(this,function(){this.refresh(this.layerInfos)}));else{if((!this._respectVisibility||this._respectVisibility&&a.visible)&&0<a.layerInfos.length&&q.some(a.layerInfos,function(a){return a.legendURL})){var g=!1;q.forEach(a.layerInfos,function(c){if(c.legendURL&&-1<q.indexOf(a.visibleLayers,c.name)){g||(n.create("div",{innerHTML:"\x3cspan class\x3d'esriLegendServiceLabel'\x3e"+(a._titleForLegend||a.name||a.id)+"\x3c/span\x3e"},this.domNode),g=!0);
var f;c=c.legendURL;if(a.customParameters||a.customLayerParameters){var e=d.clone(a.customParameters||{});d.mixin(e,a.customLayerParameters||{});for(f in e)c+=(-1===c.indexOf("?")?"?":"\x26")+f+"\x3d"+e[f]}n.create("div",{innerHTML:"\x3cimg src\x3d'"+c+"'/\x3e"},this.domNode);b=!0}},this)}}else"esri.layers.WFSLayer"!==a.declaredClass||a.renderer?f.push(a):(e=n.create("div",{id:this.id+"_"+a.id,"class":"esriLegendService"}),n.create("span",{innerHTML:this._getServiceTitle(a),"class":"esriLegendServiceLabel"},
n.create("td",{align:this._align},n.create("tr",{},n.create("tbody",{},n.create("table",{width:"95%"},e))))),n.place(e,this.id,"first"),e=n.create("table",{cellpadding:0,cellspacing:0,width:"95%","class":"esriLegendLayer"},e),e=n.create("tbody",{},e),"esriGeometryComplex"===a.geometryType?(this._buildRow_Renderer(a,a._pointSymbol,null,this.NLS_points,null,e),this._buildRow_Renderer(a,a._lineSymbol,null,this.NLS_lines,null,e),this._buildRow_Renderer(a,a._polygonSymbol,null,this.NLS_areas,null,e)):
"esriGeometryPoint"===a.geometryType?this._buildRow_Renderer(a,a._pointSymbol,null,"",null,e):"esriGeometryPolyline"===a.geometryType?this._buildRow_Renderer(a,a._lineSymbol,null,"",null,e):"esriGeometryPolygon"===a.geometryType&&this._buildRow_Renderer(a,a._polygonSymbol,null,"",null,e),c=!0)},this);var e=[];q.forEach(f,function(a){if(!a.loaded)var b=k.connect(a,"onLoad",this,function(a){k.disconnect(b);b=null;this.refresh()});else if((!this._respectVisibility||this._respectVisibility&&a.visible)&&
(a.layerInfos||a.renderer||"esri.layers.ArcGISImageServiceLayer"==a.declaredClass)){var c=n.create("div",{id:this.id+"_"+a.id,style:{display:"none"},"class":"esriLegendService"});n.create("span",{innerHTML:this._getServiceTitle(a),"class":"esriLegendServiceLabel"},n.create("td",{align:this._align},n.create("tr",{},n.create("tbody",{},n.create("table",{width:"95%"},c)))));n.place(c,this.id,"first");a.legendResponse||a.renderer&&"esri.renderer.StretchRenderer"!==a.renderer.declaredClass?this._createLegendForLayer(a):
this.isHostedTileService(a)?this._getLayerInfos(a).then(d.hitch(this,function(a){this._createLegendForLayer(a)}),d.hitch(this,function(a){e.push(this._legendRequest(a))})):e.push(this._legendRequest(a))}},this);0!==e.length||b||c?(new a(e)).addCallback(d.hitch(this,function(a){b||c?u.byId(this.id+"_msg").innerHTML="":u.byId(this.id+"_msg").innerHTML=this.NLS_noLegend;this._activate()})):(u.byId(this.id+"_msg").innerHTML=this.NLS_noLegend,this._activate())},_createLegendForLayer:function(a){if(a.legendResponse||
a.renderer||this.isHostedTileService(a)){var b=!1;if(a.legendResponse||this.isHostedTileService(a)){var c=a.dynamicLayerInfos||a.layerInfos;c&&c.length?q.forEach(c,function(c,f){if(!this.hideLayersInLegend[a.id]||-1===q.indexOf(this.hideLayersInLegend[a.id],c.id)){var e=this._buildLegendItems(a,c,f);b=b||e}},this):"esri.layers.ArcGISImageServiceLayer"==a.declaredClass&&(b=this._buildLegendItems(a,{id:0,name:null,title:a.name,subLayerIds:null,parentLayerId:-1},0))}else a.renderer&&(c=a.url?a.url.substring(a.url.lastIndexOf("/")+
1,a.url.length):"fc_"+a.id,b=this._buildLegendItems(a,{id:c,name:null,subLayerIds:null,parentLayerId:-1},0));b&&(t.set(u.byId(this.id+"_"+a.id),"display","block"),t.set(u.byId(this.id+"_msg"),"display","none"))}},_legendRequest:function(a){if(a.loaded)return 10.01<=a.version?this._legendRequestServer(a):this._legendRequestTools(a);k.connect(a,"onLoad",d.hitch(this,"_legendRequest"))},_legendRequestServer:function(a){var b=a.url,c=b.indexOf("?"),b=-1<c?b.substring(0,c)+"/legend"+b.substring(c):b+"/legend";
(c=a._getToken())&&(b+="?token\x3d"+c);var f=d.hitch(this,"_processLegendResponse"),e={f:"json"};a._params.dynamicLayers&&(e.dynamicLayers=g.stringify(this._createDynamicLayers(a)),"[{}]"===e.dynamicLayers&&(e.dynamicLayers="[]"));a._params.bandIds&&(e.bandIds=a._params.bandIds);a._params.renderingRule?e.renderingRule=a._params.renderingRule:a.rasterFunctionInfos&&0<a.rasterFunctionInfos.length&&q.forEach(a.rasterFunctionInfos,function(a){a&&a.name&&"none"===a.name.toLowerCase()&&(e.renderingRule=
g.stringify({rasterFunction:a.name}))});return B({url:b,content:e,callbackParamName:"callback",load:function(b,c){f(a,b,c)},error:y.defaults.io.errorHandler})},_legendRequestTools:function(a){var b=a.url.toLowerCase().indexOf("/rest/"),b=a.url.substring(0,b)+a.url.substring(b+5,a.url.length),b=this._legendUrl+"?soapUrl\x3d"+window.escape(b);if(!e("ie")||8<e("ie"))b+="\x26returnbytes\x3dtrue";var c=d.hitch(this,"_processLegendResponse");return B({url:b,content:{f:"json"},callbackParamName:"callback",
load:function(b,f){c(a,b,f)},error:y.defaults.io.errorHandler})},_processLegendResponse:function(a,b){b&&b.layers?(a.legendResponse=b,u.byId(this.id+"_"+a.id)&&n.empty(u.byId(this.id+"_"+a.id)),n.create("span",{innerHTML:this._getServiceTitle(a),"class":"esriLegendServiceLabel"},n.create("td",{align:this._align},n.create("tr",{},n.create("tbody",{},n.create("table",{width:"95%"},u.byId(this.id+"_"+a.id)))))),this._createLegendForLayer(a)):console.log("Legend could not get generated for "+a.url+": "+
m.toJson(b))},_buildLegendItems:function(a,b,c){var f=!1,e=u.byId(this.id+"_"+a.id),d=b.parentLayerId;if(b.subLayerIds)a=n.create("div",{id:this.id+"_"+a.id+"_"+b.id+"_group",style:{display:"none"},"class":-1==d?0<c?"esriLegendGroupLayer":"":this._legendAlign},-1==d?e:u.byId(this.id+"_"+a.id+"_"+d+"_group")),n.create("td",{innerHTML:z.encode(b.name),align:this._align},n.create("tr",{},n.create("tbody",{},n.create("table",{width:"95%","class":"esriLegendLayerLabel"},a))));else{if(this._respectVisibility&&
a.visibleLayers)if(c=a.dynamicLayerInfos||a.layerInfos)if(a._params&&a._params.layers){if(-1===q.indexOf(a.visibleLayers,b.id))return f}else{if(c=this._getReallyVisibleLayers(c,a.visibleLayers),-1===q.indexOf(c,b.id))return f}else if(-1===q.indexOf(a.visibleLayers,b.id))return f;e=n.create("div",{id:this.id+"_"+a.id+"_"+b.id,style:{display:"none"},"class":-1<d?this._legendAlign:""},-1==d?e:u.byId(this.id+"_"+a.id+"_"+d+"_group"));n.create("td",{innerHTML:z.encode(b.name)||"",align:this._align},n.create("tr",
{},n.create("tbody",{},n.create("table",{width:"95%","class":"esriLegendLayerLabel"},e))));c=a.dynamicLayerInfos||a.layerInfos;d=!1;c&&c.length&&(d=q.some(c,function(a){return!!a.drawingInfo}));if(a.legendResponse)f=f||this._buildLegendItems_Tools(a,b,e);else if(a.renderer||d)f=f||this._buildLegendItems_Renderer(a,b,e)}return f},_getReallyVisibleLayers:function(a,b){if(!a||!b||!b.length)return[];var c=[],f=[],e;for(e=0;e<a.length;e++)if(a[e].subLayerIds){if(-1===q.indexOf(b,a[e].id)||-1<q.indexOf(f,
a[e].id))f=f.concat(a[e].subLayerIds)}else-1<q.indexOf(b,a[e].id)&&-1===q.indexOf(f,a[e].id)&&c.push(a[e].id);return c},_buildLegendItems_Tools:function(a,b,c){var f=b.parentLayerId,e=this.map.getScale(),d=!1,g=function(a,b){var c,f;for(c=0;c<a.length;c++)if(b.dynamicLayerInfos)for(f=0;f<b.dynamicLayerInfos[f].length;f++){if(b.dynamicLayerInfos[f].mapLayerId==a[c].layerId)return a[c]}else if(b.id==a[c].layerId)return a[c];return{}};if(!this._respectCurrentMapScale||this._respectCurrentMapScale&&this._isLayerInScale(a,
b,e)){var h=!0;if(this._respectCurrentMapScale&&("esri.layers.ArcGISDynamicMapServiceLayer"===a.declaredClass||"esri.layers.ArcGISMapServiceLayer"===a.declaredClass)){var k=this._getEffectiveScale(a,b);if(k.minScale&&k.minScale<e||k.maxScale&&k.maxScale>e)h=!1}if(h){var e=g(a.legendResponse.layers,b),l=e.legendType,m=e.layerType,p=e.legend;if(p){"esri.layers.ArcGISImageServiceLayer"!==a.declaredClass&&this._sanitizeLegendResponse(a,e,b);c=n.create("table",{cellpadding:0,cellspacing:0,width:"95%",
"class":"esriLegendLayer"},c);var w=n.create("tbody",{},c);(a._hoverLabel||a._hoverLabels)&&this._createHoverAction(c,a,b);q.forEach(p,function(c){if(!(10.1<=a.version&&!c.values&&1<p.length)||!a._hideDefaultSymbol&&"\x3call other values\x3e"!==c.label&&(c.label||"esri.layers.ArcGISImageServiceLayer"===a.declaredClass&&10.3<=a.version||"Raster Layer"===m))if(c.url&&0===c.url.indexOf("http")||c.imageData&&0<c.imageData.length)d=!0,this._buildRow_Tools(c,w,a,b.id,l)},this)}}}d&&(t.set(u.byId(this.id+
"_"+a.id+"_"+b.id),"display","block"),-1<f&&(t.set(u.byId(this.id+"_"+a.id+"_"+f+"_group"),"display","block"),this._findParentGroup(a.id,a,f)));return d},_getLayerInfos:function(a){var c=new b,f=a.dynamicLayerInfos||a.layerInfos;if(f&&f.length)if(q.some(f,function(a){return!!a.drawingInfo}))c.resolve(a);else{var e=a.url,d=e.indexOf("?"),e=-1==d?e+"/layers":e.substring(0,d)+"/layers"+e.substring(d,e.length);B({url:e,content:{f:"json"},callbackParamName:"callback",load:function(b,e){b.layers?(q.forEach(f,
function(a){var c=q.filter(b.layers,function(b){return a.source?b.id===a.source.mapLayerId:b.id===a.id});c&&c[0]&&c[0].drawingInfo&&(a.drawingInfo=c[0].drawingInfo,a.fields=c[0].fields)}),c.resolve(a)):c.reject(a)},error:function(b){c.reject(a)}})}return c},_sanitizeLegendResponse:function(a,b,c){var f=b.legend;if(10.1<=a.version&&1<f.length&&!b._sanitized){a=d.getObject("layerDefinition.drawingInfo.renderer",!1,c);var e,g;a||(a=d.getObject("drawingInfo.renderer",!1,c));q.some(f,function(a){if(a.values)return!0})&&
q.some(f,function(a,b){a.values||(g=b,e=a);return!!e});a?"uniqueValue"===a.type?e&&(f.splice(g,1),f.push(e)):"classBreaks"===a.type&&(e&&f.splice(g,1),f.reverse(),e&&f.push(e)):e&&(f.splice(g,1),f.push(e));b._sanitized=!0}},_buildRow_Tools:function(a,b,c,f,d){var g=n.create("tr",{},b),h;this.alignRight?(b=n.create("td",{align:this._isRightToLeft?"left":"right"},g),h=n.create("td",{align:this._isRightToLeft?"left":"right",width:35},g)):(h=n.create("td",{width:35,align:"center"},g),b=n.create("td",
{},g));g=a.url;(!e("ie")||9<=e("ie")||9>e("ie")&&"esri.layers.ArcGISImageServiceLayer"===c.declaredClass)&&a.imageData&&0<a.imageData.length?g="data:image/png;base64,"+a.imageData:0!==a.url.indexOf("http")&&(g=c.url+"/"+f+"/images/"+a.url,(f=c._getToken())&&(g+="?token\x3d"+f));f=n.create("img",{src:g,border:0,style:"opacity:"+c.opacity},h);a=n.create("td",{innerHTML:z.encode(a.label),align:this._align},n.create("tr",{},n.create("tbody",{},n.create("table",{width:"95%",dir:"ltr"},b))));d&&"Stretched"===
d&&10.3<=c.version&&"esri.layers.ArcGISImageServiceLayer"===c.declaredClass&&(a.style.verticalAlign="top",a.style.lineHeight="1",f.style.marginBottom="-1px",f.style.display="block",b.style.verticalAlign="top");9>e("ie")&&(f.style.filter="alpha(opacity\x3d"+100*c.opacity+")")},_getVariable:function(a,b,c){var f;a&&(f=(a=a.getVisualVariablesForType(b,c))&&a[0]);return f},_getVariables:function(a,b,c){a=[this._getVariable(a,"colorInfo",!1),this._getVariable(a,"opacityInfo",!1),this._getVariable(a,"sizeInfo",
!1)];return b?q.filter(a,function(a){return!(!a||a.field!==b||a.normalizationField!=c)}):a},_getFieldAlias:function(a,b,c){var f=b.infoTemplate||(b.infoTemplates&&c&&b.infoTemplates[c.id]?b.infoTemplates[c.id].infoTemplate:null),f=f&&f.getFieldInfo&&f.getFieldInfo(a);a=d.isFunction(a)?null:this.getField(b,a,c);b=f||a;c="";b&&(c=f&&f.label||a&&a.alias||b.name||b.fieldName);return c},_getRampTitle:function(a,b,c){var f,e=a.field,g=a.normalizationField,h=!1,n=!1,k=!1,e=d.isFunction(e)?null:e,g=d.isFunction(g)?
null:g;if(a.legendOptions&&a.legendOptions.title)f=a.legendOptions.title;else if(a.valueExpressionTitle)f=a.valueExpressionTitle;else{if(b.renderer&&b.renderer.authoringInfo&&b.renderer.authoringInfo.visualVariables){var l=b.renderer.authoringInfo.visualVariables;for(a=0;a<l.length;a++){var m=l[a];if("colorInfo"===m.type&&"ratio"===m.style){h=!0;break}else if("colorInfo"===m.type&&"percent"===m.style){n=!0;break}else if("colorInfo"===m.type&&"percentTotal"===m.style){k=!0;break}}}(h=k&&"showRatioPercentTotal"||
n&&"showRatioPercent"||h&&"showRatio"||g&&"showNormField"||e&&"showField"||null)&&(f=C.substitute({field:e&&this._getFieldAlias(e,b,c),normField:g&&this._getFieldAlias(g,b,c)},this._i18n[h]))}return f},_getRendererTitle:function(a,b,c){var f;if(a){var e,g,h;"esri.renderer.ClassBreaksRenderer"===a.declaredClass&&(e=a.attributeField,g=a.normalizationField,h="percent-of-total"===a.normalizationType);e=d.isFunction(e)?null:e;g=d.isFunction(g)?null:g;a.legendOptions&&a.legendOptions.title?f=a.legendOptions.title:
a.valueExpressionTitle?f=a.valueExpressionTitle:(a=g&&"showNormField"||(h?"showNormPct":null)||e&&"showField"||null)&&(f=C.substitute({field:e&&this._getFieldAlias(e,b,c),normField:g&&this._getFieldAlias(g,b,c)},this._i18n[a]))}return f},_buildLegendItems_Renderer:function(a,b,c){var f=b.parentLayerId,e=this.map,g=e.getScale(),h,k=!1;if(!this._respectCurrentMapScale||this._isLayerInScale(a,b,g)){var l,m,p,w,v,r,x,A;p="esri.layers.ArcGISImageServiceVectorLayer"===a.declaredClass?a.renderer.renderer:
b&&b.drawingInfo?Q.fromJson(d.clone(b.drawingInfo.renderer)):a.isAggregationEnabled&&a.isAggregationEnabled()?a.getAggregationRenderer():a.renderer;if("esri.renderer.ScaleDependentRenderer"===p.declaredClass&&(p=(p="zoom"===p.rangeType?p.getRendererInfoByZoom(e.getZoom()):p.getRendererInfoByScale(g))&&p.renderer,!p))return!1;var y=this._getVariables(p),B=q.filter(y,function(a){return!!a}).length,g=y[0],e=y[1],y=y[2],C,M,E,G,D;g&&(w=this._getMedianColor(p,g),g.field&&(r=d.isFunction(g.field)?null:
this.getField(a,g.field,b)),C=!(g.legendOptions&&!1===g.legendOptions.showLegend));e&&(e.field&&(A=d.isFunction(e.field)?null:this.getField(a,e.field,b)),M=!(e.legendOptions&&!1===e.legendOptions.showLegend));y&&(y.field&&(x=d.isFunction(y.field)?null:this.getField(a,y.field,b)),E=!(y.legendOptions&&!1===y.legendOptions.showLegend));if("esri.renderer.HeatmapRenderer"===p.declaredClass)h=k=!0,this._showHeatRamp(a,b,p,c);else if("esri.renderer.DotDensityRenderer"===p.declaredClass)h=k=!0,this._showDotDensityLegend(a,
b,p,c);else if("esri.renderer.TemporalRenderer"===p.declaredClass)h=k=!0,m=n.create("table",{cellpadding:0,cellspacing:0,width:"95%","class":"esriLegendLayer"},c),l=n.create("tbody",{},m),(a._hoverLabel||a._hoverLabels)&&this._createHoverAction(m,a,b),p.latestObservationRenderer&&"esri.renderer.SimpleRenderer"===p.latestObservationRenderer.declaredClass&&this._buildRow_Renderer(a,p.latestObservationRenderer.symbol,w,z.encode(p.latestObservationRenderer.label)||this.NLS_currentObservations,null,l),
p.observationRenderer&&"esri.renderer.SimpleRenderer"===p.observationRenderer.declaredClass&&this._buildRow_Renderer(a,p.observationRenderer.symbol,w,z.encode(p.observationRenderer.label)||this.NLS_previousObservations,null,l);else if("esri.renderer.UniqueValueRenderer"===p.declaredClass){if(p.infos&&0<p.infos.length){h=k=!0;if(p.legendOptions&&p.legendOptions.title||p.valueExpressionTitle)m=n.create("table",{cellpadding:0,cellspacing:0,width:"95%","class":"esriLegendLayer"},c),l=n.create("tbody",
{},m),B=p.legendOptions&&p.legendOptions.title?p.legendOptions.title:p.valueExpressionTitle,this._buildRow_Renderer(a,null,w,z.encode(B),null,l);m=n.create("table",{cellpadding:0,cellspacing:0,width:"95%","class":"esriLegendLayer"},c);l=n.create("tbody",{},m);(a._hoverLabel||a._hoverLabels)&&this._createHoverAction(m,a,b);p.attributeField&&y&&this._addSubHeader(l,this._getFieldAlias(p.attributeField,a,b));var L=[];q.forEach(p.infos,function(b){var c=null;a._editable&&a.types&&(c=this._getTemplateFromTypes(a.types,
b.value));var f=b.label;null==f&&(f=b.value);-1===q.indexOf(L,f)&&(L.push(f),this._buildRow_Renderer(a,b.symbol,w,z.encode(f),c,l))},this)}D=this._displayDefaultSymbol(a,p,c)}else if("esri.renderer.ClassBreaksRenderer"===p.declaredClass){if(p.infos&&0<p.infos.length||"esri.layers.ArcGISImageServiceVectorLayer"===a.declaredClass)h=k=!0,G=this._isUnclassedRenderer(p),g||1!==p.infos.length||(v=(v=p.infos[0])&&v.symbol),G||(m=n.create("table",{cellpadding:0,cellspacing:0,width:"95%","class":"esriLegendLayer"},
c),l=n.create("tbody",{},m),B=this._getRendererTitle(p,a,b),this._buildRow_Renderer(a,null,w,z.encode(B),null,l)),m=n.create("table",{cellpadding:0,cellspacing:0,width:"95%","class":"esriLegendLayer"},c),l=n.create("tbody",{},m),(a._hoverLabel||a._hoverLabels)&&this._createHoverAction(m,a,b),G&&y&&E||(B=p.infos.slice(0).reverse(),q.forEach(B,function(b){var c=b.label;null!=c||G||(c=b.minValue+" - "+b.maxValue);this._buildRow_Renderer(a,b.symbol,w,z.encode(c),null,l)},this)),"esri.layers.ArcGISImageServiceVectorLayer"!==
a.declaredClass||a.renderer.style!==K.STYLE_SCALAR&&a.renderer.style!==K.STYLE_SINGLE_ARROW||(this._buildRow_Renderer(a,p.defaultSymbol,null,"",null,l),a._hideDefaultSymbol=!0);G||(D=this._displayDefaultSymbol(a,p,c))}else"esri.renderer.SimpleRenderer"===p.declaredClass&&(h=k=!0,m=n.create("table",{cellpadding:0,cellspacing:0,width:"95%","class":"esriLegendLayer"},c),l=n.create("tbody",{},m),(a._hoverLabel||a._hoverLabels)&&this._createHoverAction(m,a,b),v=null,a._editable&&a.templates&&0<a.templates.length&&
(v=a.templates[0]),m=1<B?null:r&&C||A&&M||x&&E,this._buildRow_Renderer(a,p.symbol,w,z.encode(m?this._getRampTitle(1<B?null:g||e||y,a,b):p.label),v,l),v=g?null:p.symbol,m&&(r=A=x=null));h&&(g&&C&&(g.field||g.valueExpression)&&this._showGradientRamp(a,b,p,null,c,g,r,null,y&&E?!0:!1),y&&E&&(y.field||y.valueExpression)&&(h=g&&C||"esri.renderer.UniqueValueRenderer"===p.declaredClass?!1:!0,this._showSizeLegend(a,b,p,y,w,c,x,null,h)),e&&M&&(e.field||e.valueExpression)&&this._showGradientRamp(a,b,p,v&&!v.url&&
v.color?v.color:this.transparencyRampColor,c,e,A,null,!1));D||G&&!C&&!E&&!M||(D=this._displayDefaultSymbol(a,p,c));k=k||D}k&&(t.set(u.byId(this.id+"_"+a.id+"_"+b.id),"display","block"),-1<f&&(t.set(u.byId(this.id+"_"+a.id+"_"+f+"_group"),"display","block"),this._findParentGroup(a.id,f)));return k},_isUnclassedRenderer:function(a,b){var c;if("esri.renderer.ClassBreaksRenderer"===a.declaredClass&&a.infos&&1===a.infos.length){c=a.attributeField;var f=a.normalizationField;c=b?c===b:!!this._getVariables(a,
c,f).length}return c},_displayDefaultSymbol:function(a,b,c){var f;!a._hideDefaultSymbol&&b.defaultSymbol&&(f=!0,c=n.create("table",{cellpadding:0,cellspacing:0,width:"95%","class":"esriLegendLayer"},c),c=n.create("tbody",{},c),this._buildRow_Renderer(a,b.defaultSymbol,null,z.encode(b.defaultLabel)||"others",null,c));return f},_showGradientRamp:function(a,b,c,f,e,g,h,k,l){l=n.create("table",{cellpadding:0,cellspacing:0,width:"95%","class":"esriLegendLayer"+(l?"":" esriLegendSubFragment")},e);e=n.create("tbody",
{},l);(a._hoverLabel||a._hoverLabels||k)&&this._createHoverAction(l,a,b,k);(h||g.valueExpression||g.legendOptions&&g.legendOptions.title)&&this._addSubHeader(e,this._getRampTitle(g,a,b));h=g.field;var m;h&&(m=d.isFunction(h)?null:this.getField(a,h,b));(b=this._getRampStops(c,g,f,m&&"esriFieldTypeDate"===m.type))&&b.length&&this._drawGradientRamp(e,b,!0,a,this._getRampBorderColor(c),!!f)},_getMedianColor:function(a,b){var c,f;b.colors?(c=b.minDataValue,f=b.maxDataValue):b.stops&&(c=b.stops[0].value,
f=b.stops[b.stops.length-1].value);return a.getColor(c+(f-c)/2,{colorInfo:b})},_getRampStops:function(a,b,c,f){var e,d,g,h,n=!1;b.colors||b.opacityValues?(d=b.maxDataValue-b.minDataValue,e=q.map([0,.25,.5,.75,1],function(a){g=b.minDataValue+a*d;return Number(g.toFixed(6))}),this._checkPrecision(0,4,e)):b.stops&&(e=q.map(b.stops,function(a){return a.value}),(n=q.some(b.stops,function(a){return!!a.label}))&&(h=q.map(b.stops,function(a){return a.label})));var k=e[0],l,m;d=e[e.length-1]-k;return q.map(e,
function(g,t){c?(l=new p(c.toRgba()),m=a.getOpacity(g,{opacityInfo:b}),null!=m&&(l.a=m)):l=a.getColor(g,{colorInfo:b});var q="";if(n)q=h[t];else{var q=f?D.formatDate(g,D.timelineDateFormatOptions):E.format(g),u="";0===t?u=this._specialChars.lt+" ":t===e.length-1&&(u=this._specialChars.gt+" ");q=u+q}return{value:g,color:l,offset:1-(g-k)/d,label:q}},this).reverse()},_checkPrecision:function(a,b,c){var f=a+(b-a)/2,e=c[a],d=c[f],g=c[b],h=Math.floor(e),n=Math.floor(d),k=Math.floor(g);h===e&&k===g&&n!==
d&&h!==n&&k!==n&&(c[f]=n);a+1!==f&&this._checkPrecision(a,f,c);f+1!==b&&this._checkPrecision(f,b,c)},_getRampBorderColor:function(a){var b;if("esri.renderer.SimpleRenderer"===a.declaredClass)b=a.symbol;else if("esri.renderer.UniqueValueRenderer"===a.declaredClass||"esri.renderer.ClassBreaksRenderer"===a.declaredClass)b=a.infos[0].symbol;return(a=b&&-1===b.type.indexOf("linesymbol")?b.getStroke():null)&&a.color},_drawGradientRamp:function(a,b,c,f,d,g){var h=n.create("tr",{},a),k,l,m,u,w,v=b.length-
1,r;u=0;this.alignRight?(a=n.create("td",{align:this._isRightToLeft?"left":"right"},h),k=n.create("td",{align:this._isRightToLeft?"left":"right",width:this.gradientWidth},h)):(k=n.create("td",{width:this.gradientWidth,align:"center"},h),a=n.create("td",{},h));h=d&&0<d.a&&!(240<=d.r&&240<=d.g&&240<=d.b);l=n.create("div",{"class":h?"":"esriLegendBorderLessColorRamp",style:"position: relative; width:"+this.gradientWidth+"px;"},k);k=n.create("div",{"class":"esriLegendColorRamp"+(g?" esriLegendTransparencyRamp":
"")},l);g=t.get(k,"width");h&&(d=9>e("ie")?d.toHex():"rgba("+d.toRgba().join(",")+")",t.set(k,"border",this.colorRampBorder+" "+d));c?(d=this.gradientHeight*v,t.set(k,"height",d+"px")):d=t.get(k,"height");t.set(l,"height",d+"px");h=x.createSurface(k,g,d);9>e("ie")&&(u=h.getEventSource(),t.set(u,"position","relative"),t.set(u.parentNode,"position","relative"),u=1);try{c&&q.forEach(b,function(a,b){a.offset=b/v}),w=h.createRect({x:-u,y:-u,width:g+u,height:d+u}),w.setFill({type:"linear",x1:0,y1:0,x2:0,
y2:d,colors:b}).setStroke(null),h.createRect({width:g,height:d}).setFill(new p([255,255,255,1-f.opacity])).setStroke(null),this._surfaceItems.push(h)}catch(za){h.clear(),h.destroy()}q.forEach(b,function(a,c){if(a.label){r="top:"+100*a.offset+"%;";var f="";0===c&&(f+=" esriLegendColorRampTickFirst");c===b.length-1&&(f+=" esriLegendColorRampTickLast");n.create("div",{"class":"esriLegendColorRampTick"+f,innerHTML:"\x26nbsp;",style:r},l)}});m=n.create("div",{"class":"esriLegendColorRampLabels",style:{height:d+
this.gradientHeight+"px"}},a);c?q.forEach(b,function(a){n.create("div",{"class":"esriLegendColorRampLabel",innerHTML:z.encode(a.label)||"\x26nbsp;"},m)}):(n.create("div",{"class":"esriLegendColorRampLabel",innerHTML:this._i18n.high},m),n.create("div",{"class":"esriLegendColorRampLabel",innerHTML:this._i18n.low,style:"top: "+(d+this.gradientHeight-2*this.gradientHeight)+"px;"},m))},_showHeatRamp:function(a,b,c,f,e){var d,g=c.field;d=n.create("table",{cellpadding:0,cellspacing:0,width:"95%","class":"esriLegendLayer"},
f);f=n.create("tbody",{},d);(a._hoverLabel||a._hoverLabels||e)&&this._createHoverAction(d,a,b,e);(g=g&&this.getField(a,g,b))&&this._addSubHeader(f,this._getFieldAlias(g.name,a,b));b=this._getHeatmapStops(c);b.length&&this._drawGradientRamp(f,b,!1,a)},_getHeatmapStops:function(a){var b=a.colorStops;a=a.colors;var c,f,e,d;b&&b[0]?(c=b.length-1,(a=b[0]&&null!=b[0].ratio)?(a=b[c])&&1!==a.ratio&&(b=b.slice(0),b.push({ratio:1,color:a.color}),c++):(f=b[0].value,e=b[c].value-f,b=q.map(b,function(a){return{color:a.color,
ratio:(a.value-f)/e}}))):a&&a[0]&&(c=a.length-1,d=1/(a.length-1),b=q.map(a,function(a,b){return{color:a,ratio:b*d}}));b=q.map(b,function(a,b){var f="";0===b?f="Low":b===c&&(f="High");return{color:a.color,label:f,offset:1-a.ratio}});return b.reverse()},_showDotDensityLegend:function(a,b,c,f){var e=c.legendOptions,g,h,k,l,m,t,p,u=this.dotDensitySwatchSize,w=Math.round(u/2);e&&(h=e.backgroundColor,k=e.outline,l=e.valueUnit,m=e.dotCoverage);m=(m||this.dotCoverage)/100;p=Math.round(u*u/Math.pow(c.dotSize,
2)*m);f=n.create("table",{cellpadding:0,cellspacing:0,width:"95%","class":"esriLegendLayer"},f);t=n.create("tbody",{},f);(a._hoverLabel||a._hoverLabels)&&this._createHoverAction(f,a,b);this._addSubHeader(t,C.substitute({value:c.dotValue,unit:l||""},this.NLS_dotValue));q.forEach(c.fields,function(f){f=d.mixin({},f);f.numPoints=p;g=new R(c._generateImageSrc(u,u,[f],{x:0,y:0},{x:u,y:u},h),k||c.outline,u,u);f=this.getField(a,f.name,b)||f;this._buildRow_Renderer(a,g,null,z.encode(this._getFieldAlias(f.name,
a,b)),null,t,{type:"path",path:"M "+-w+","+-w+" L "+w+","+-w+" L "+w+","+w+" L "+-w+","+w+" L "+-w+","+-w+" E"})},this)},_showSizeLegend:function(a,b,c,f,e,g,h,k,l){var m=f.legendOptions,m=m&&m.customValues;e=this._getSizeSymbol(c,e);if((!f.valueUnit||"unknown"===f.valueUnit)&&e&&(m||null!=f.minSize&&null!=f.maxSize&&null!=f.minDataValue&&null!=f.maxDataValue||f.stops&&!(1>=f.stops.length))){l=n.create("table",{cellpadding:0,cellspacing:0,width:"95%","class":"esriLegendLayer"+(l?"":" esriLegendSubFragment")},
g);g=n.create("tbody",{},l);(a._hoverLabel||a._hoverLabels||k)&&this._createHoverAction(l,a,b,k);(h||f.valueExpression||f.legendOptions&&f.legendOptions.title)&&this._addSubHeader(g,this._getRampTitle(f,a,b));h=f.field;var t;h&&(t=d.isFunction(h)?null:this.getField(a,h,b));b=t&&"esriFieldTypeDate"===t.type;m=m||this._getDataValues(c,e,f,b);for(t=l=m.length-1;0<=t;t--)h=m[t],e=O.fromJson(e.toJson()),this._applySize(e,c,f,h),h=b?D.formatDate(h,D.timelineDateFormatOptions):E.format(h),k="",t===l?k=this._specialChars.gt+
" ":0===t&&(k=this._specialChars.lt+" "),k="\x3cspan class\x3d'esriLegendSizeRampLabel'\x3e"+z.encode(k+h)+"\x3c/span\x3e",this._buildRow_Renderer(a,e,null,k,null,g)}},_getSizeSymbol:function(a,b){var c,f;if("esri.renderer.SimpleRenderer"===a.declaredClass)c=a.symbol;else if("esri.renderer.VectorFieldRenderer"===a.declaredClass)c=a.defaultSymbol;else if("esri.renderer.UniqueValueRenderer"===a.declaredClass||"esri.renderer.ClassBreaksRenderer"===a.declaredClass)c=a.infos[0].symbol,f=1<a.infos.length;
if(c=c&&-1!==c.type.indexOf("fillsymbol")?null:c)if(c=O.fromJson(c.toJson()),b||f)-1!==c.type.indexOf("linesymbol")?c.setColor(new p(this.sizeRampDarkColor)):(c.setColor(new p(this.sizeRampLightColor)),c.setOutline&&(f=new ba,f.setColor(new p(this.sizeRampDarkColor)),f.setWidth(1.5),c.setOutline(f)));return c},_getDataValues:function(a,b,c,f,e,d){e=null==e?5:e;d=null==d?20:d;var g=a.getSizeRangeAtScale(c,this.map.getScale());e=this._interpolateSizeRange(g,e);var h=this._getDataRange(c),n=q.map(e,
function(a){return this._getDataValueFromSize(a,h,g)},this);if(!f){var k,n=E.round(n);for(f=1;f<n.length-1;f++)if(k=this._roundDataValue(a,b,c,n[f],n[f-1],d))n[f]=k[0],e[f]=k[1]}return n},_getDataRange:function(a){var b=a.stops;return b?{min:b[0].value,max:b[b.length-1].value}:{min:a.minDataValue,max:a.maxDataValue}},_interpolateSizeRange:function(a,b){var c=a.minSize,f=(a.maxSize-c)/(b-1),e,d=[];for(e=0;e<b;e++)d.push(c+f*e);return d},_getDataValueFromSize:function(a,b,c){var f=c.minSize;c=c.maxSize;
var e=b.min;b=b.max;return a<=f?e:a>=c?b:(a-f)/(c-f)*(b-e)+e},_roundDataValue:function(a,b,c,f,e,d){var g=this._getSize(b,a,c,f);e=this._getSize(b,a,c,e);var h,n=E.getDigits(f),k=n.integer,n=n.fractional,l,m,t,p,u,q,w,v,z,r,x;0<f&&1>f&&(h=Math.pow(10,n),f*=h,k=E.getDigits(f).integer);for(--k;0<=k&&(l=Math.pow(10,k),n=Math.floor(f/l)*l,l*=Math.ceil(f/l),null!=h&&(n/=h,l/=h),m=(n+l)/2,m=E.round([n,m,l],{indexes:[1]})[1],t=this._getSize(b,a,c,n),p=this._getSize(b,a,c,l),u=this._getSize(b,a,c,m),q=E.getPctChange(g,
t,e,null),w=E.getPctChange(g,p,e,null),v=E.getPctChange(g,u,e,null),z=q.prev<=d,r=w.prev<=d,z&&r&&(q.prev<=w.prev?(z=!0,r=!1):(r=!0,z=!1)),z?x=[n,t]:r?x=[l,p]:v.prev<=d&&(x=[m,u]),!x);k--);return x},_applySize:function(a,b,c,f){var e=a.type;b=this._getSize(a,b,c,f);switch(e){case "simplemarkersymbol":a.setSize(b);break;case "picturemarkersymbol":e=a.width;c=a.height;a.setHeight(b);a.setWidth(e/c*b);break;case "simplelinesymbol":case "cartographiclinesymbol":a.setWidth(b);break;case "textsymbol":a.font&&
a.font.setSize(b)}},_getSize:function(a,b,c,f){return b.getSize(f,{sizeInfo:c,scale:this.map.getScale(),shape:-1!==a.type.indexOf("markersymbol")?a.style:null})},_buildRow_Renderer:function(a,b,c,f,e,d,g){var h=n.create("tr",{},d),k;this.alignRight?(d=n.create("td",{align:this._isRightToLeft?"left":"right"},h),b&&(k=n.create("td",{align:this._isRightToLeft?"left":"right",width:35},h))):(b&&(k=n.create("td",{width:35,align:"center"},h)),d=n.create("td",{},h));var l=h=30,m;if(b){if("simplemarkersymbol"==
b.type)h=Math.min(Math.max(h,b.size+12),125),l=Math.min(Math.max(l,b.size+12),125);else if("picturemarkersymbol"==b.type)h=Math.min(Math.max(h,b.width),125),l=Math.min(b.height||l,125);else if("textsymbol"==b.type){var t,p;b.text||(t=b.text,p=!0,b.setText(this.defaultText));h=Math.min(Math.max(h,b.getWidth()+12),125);l=Math.min(Math.max(l,b.getHeight()+12),125);p&&b.setText(t)}m=n.create("div",{style:"width:"+h+"px;height:"+l+"px;"},k)}C.isDefined(f)&&"number"===typeof f&&(f=""+f);n.create("td",{innerHTML:f||
"",align:this._align},n.create("tr",{},n.create("tbody",{},n.create("table",{width:"95%"},d))));b&&(a=this._drawSymbol(m,b,c,h,l,e,a,g),this._surfaceItems.push(a))},_addSubHeader:function(a,b){var c=n.create("tr",{},a),c=n.create("td",{align:this._align,colspan:2},c);n.create("td",{innerHTML:z.encode(b)||"",align:this._align},n.create("tr",{},n.create("tbody",{},n.create("table",{width:"95%"},c))))},_drawSymbol:function(a,b,c,f,g,h,n,k){b=O.fromJson(b.toJson());var l=n.opacity;c&&b.setColor(new p(c.toRgba()));
if("simplelinesymbol"===b.type||"cartographiclinesymbol"===b.type||"textsymbol"===b.type){if(!b.color)return;c=b.color.toRgba();c[3]*=l;b.color.setColor(c)}else"simplemarkersymbol"===b.type||"simplefillsymbol"===b.type?(b.color&&(c=b.color.toRgba(),c[3]*=l,b.color.setColor(c)),b.outline&&b.outline.color&&(c=b.outline.color.toRgba(),c[3]*=l,b.outline.color.setColor(c))):"picturemarkersymbol"===b.type&&(a.style.opacity=l,a.style.filter="alpha(opacity\x3d("+100*l+"))");a=x.createSurface(a,f,g);9>e("ie")&&
(c=a.getEventSource(),t.set(c,"position","relative"),t.set(c.parentNode,"position","relative"));h=this._getDrawingToolShape(b,h)||O.getShapeDescriptors(b);var m,l=(c=h.defaultShape)&&"text"===c.type;try{l&&!c.text&&(c.text=this.defaultText),m=a.createShape(k||c).setFill(h.fill).setStroke(h.stroke),l&&m.setFont(h.font)}catch(Aa){a.clear();a.destroy();return}var u=m.getBoundingBox();k=u.width;h=u.height;var l=-(u.x+k/2),q=-(u.y+h/2);c=a.getDimensions();l={dx:l+c.width/2,dy:q+c.height/2};if("simplemarkersymbol"===
b.type&&"path"===b.style)f=n._getScaleMatrix(u,b.size),m.applyTransform(w.scaleAt(f.xx,f.yy,{x:c.width/2,y:c.height/2}));else if(k>f||h>g)n=k/f>h/g,f=((n?f:g)-5)/(n?k:h),d.mixin(l,{xx:f,yy:f});m.applyTransform(l);return a},_getDrawingToolShape:function(a,b){var c;switch(b?b.drawingTool||null:null){case "esriFeatureEditToolArrow":c={type:"path",path:"M 10,1 L 3,8 L 3,5 L -15,5 L -15,-2 L 3,-2 L 3,-5 L 10,1 Z"};break;case "esriFeatureEditToolTriangle":c={type:"path",path:"M -10,14 L 2,-10 L 14,14 L -10,14 Z"};
break;case "esriFeatureEditToolRectangle":c={type:"path",path:"M -10,-10 L 10,-10 L 10,10 L -10,10 L -10,-10 Z"};break;case "esriFeatureEditToolCircle":c={type:"circle",cx:0,cy:0,r:10};break;case "esriFeatureEditToolEllipse":c={type:"ellipse",cx:0,cy:0,rx:10,ry:5};break;default:return null}return{defaultShape:c,fill:a.getFill(),stroke:a.getStroke()}},_repaintItems:function(){q.forEach(this._surfaceItems,function(a){this._repaint(a)},this)},_repaint:function(a){if(a){a.getStroke&&a.setStroke&&a.setStroke(a.getStroke());
try{a.getFill&&a.setFill&&a.setFill(a.getFill())}catch(H){}a.children&&d.isArray(a.children)&&q.forEach(a.children,this._repaint,this)}},_createHoverAction:function(a,b,c,f){if(f=b._hoverLabel||b._hoverLabels&&b._hoverLabels[c.id]||f)f=z.encode(f),b.mouseMoveHandler=b.mouseMoveHandler||{},b.mouseMoveHandler[c.id]=k.connect(a,"onmousemove",d.hitch(this,function(a,b){this.mouseX=b.clientX;this.mouseY=b.clientY;this.hoverLabelShowing&&(this.hoverLabelShowing=!1,t.set(u.byId(this.id+"_hoverLabel"),"display",
"none"));setTimeout(d.hitch(this,function(a,b,c){if(a==this.mouseX&&b==this.mouseY&&!this.hoverLabelShowing)if(this.hoverLabelShowing=!0,u.byId(this.id+"_hoverLabel")){var f=u.byId(this.id+"_hoverLabel");f.innerHTML="\x3cspan\x3e"+c+"\x3c/span\x3e";t.set(f,"top",b+"px");t.set(f,"left",a+15+"px");t.set(f,"display","")}else n.create("div",{innerHTML:"\x3cspan\x3e"+c+"\x3c/span\x3e",id:this.id+"_hoverLabel","class":"esriLegendHoverLabel",style:{top:b+"px",left:a+15+"px"}},document.body)},b.clientX,b.clientY,
a),500)},f)),b.mouseOutHandler=b.mouseOutHandler||{},b.mouseOutHandler[c.id]=k.connect(a,"onmouseout",d.hitch(this,function(a){this.mouseY=this.mouseX=-1;this.hoverLabelShowing&&(this.hoverLabelShowing=!1,t.set(u.byId(this.id+"_hoverLabel"),"display","none"))}))},_removeHoverHandlers:function(){var a;q.forEach(this.layers,function(b){if(b.mouseMoveHandler)for(a in b.mouseMoveHandler)k.disconnect(b.mouseMoveHandler[a]);if(b.mouseOutHandler)for(a in b.mouseOutHandler)k.disconnect(b.mouseOutHandler[a])})},
_createDynamicLayers:function(a){var b=[],c;q.forEach(a.dynamicLayerInfos||a.layerInfos,function(f){c={id:f.id};c.source=f.source&&f.source.toJson();var e;a.layerDefinitions&&a.layerDefinitions[f.id]&&(e=a.layerDefinitions[f.id]);e&&(c.definitionExpression=e);var d;a.layerDrawingOptions&&a.layerDrawingOptions[f.id]&&(d=a.layerDrawingOptions[f.id]);d&&(c.drawingInfo=d.toJson());c.minScale=f.minScale||0;c.maxScale=f.maxScale||0;b.push(c)});return b},_getTemplateFromTypes:function(a,b){var c;for(c=0;c<
a.length;c++)if(a[c].id==b&&a[c].templates&&0<a[c].templates.length)return a[c].templates[0];return null},_findParentGroup:function(a,b,c){var f,e=b.dynamicLayerInfos||b.layerInfos;for(f=0;f<e.length;f++)if(c==e[f].id){-1<e[f].parentLayerId&&(t.set(u.byId(this.id+"_"+a+"_"+e[f].parentLayerId+"_group"),"display","block"),this._findParentGroup(a,b,e[f].parentLayerId));break}},_addSubLayersToHide:function(a){function b(c,f){var e=a.layer.dynamicLayerInfos||a.layer.layerInfos,d,g;for(d=0;d<e.length;d++)if(e[d].id===
c&&e[d].subLayerIds)for(g=0;g<e[d].subLayerIds.length;g++){var h=e[d].subLayerIds[g];-1===q.indexOf(f,h)&&(f.push(h),b(h,f))}}a.layer.layerInfos&&q.forEach(this.hideLayersInLegend[a.layer.id],function(c){b(c,this.hideLayersInLegend[a.layer.id])},this)},_isLayerInScale:function(a,b,c){var f,e=!0;if(a.legendResponse&&a.legendResponse.layers)for(f=0;f<a.legendResponse.layers.length;f++){var d=a.legendResponse.layers[f];if(b.id==d.layerId){var g,h;!a.minScale&&0!==a.minScale||!a.maxScale&&0!==a.maxScale?
(0==d.minScale&&a.tileInfo&&(g=a.tileInfo.lods[0].scale),0==d.maxScale&&a.tileInfo&&(h=a.tileInfo.lods[a.tileInfo.lods.length-1].scale)):(g=Math.min(a.minScale,d.minScale)||a.minScale||d.minScale,h=Math.max(a.maxScale,d.maxScale));if(0<g&&g<c||h>c)e=!1;break}}else if(a.minScale||a.maxScale)if(a.minScale&&a.minScale<c||a.maxScale&&a.maxScale>c)e=!1;return e},_getServiceTitle:function(a){var b=a._titleForLegend;b||(b=a.url,a.url?-1<a.url.indexOf("/MapServer")?(b=a.url.substring(0,a.url.indexOf("/MapServer")),
b=b.substring(b.lastIndexOf("/")+1,b.length)):-1<a.url.indexOf("/ImageServer")?(b=a.url.substring(0,a.url.indexOf("/ImageServer")),b=b.substring(b.lastIndexOf("/")+1,b.length)):-1<a.url.indexOf("/FeatureServer")&&(b=a.url.substring(0,a.url.indexOf("/FeatureServer")),b=b.substring(b.lastIndexOf("/")+1,b.length)):b="",a.name&&(b=0<b.length?b+(" - "+a.name):a.name));"esri.layers.ArcGISImageServiceVectorLayer"===a.declaredClass&&a.vectorFieldPixelFilter&&(a=a.vectorFieldPixelFilter.outputUnit?this["NLS_"+
a.vectorFieldPixelFilter.outputUnit]:this["NLS_"+a.vectorFieldPixelFilter.inputUnit],C.isDefined(a)&&(b+=" ("+a+")"));return z.encode(b)},_getEffectiveScale:function(a,b){var c=b.minScale,f=b.maxScale;if(C.isDefined(b.parentLayerId)){var e=a.layerInfos,d=b.parentLayerId,g;for(g=e.length-1;0<=g;g--)if(e[g].id==d)if(0==c&&0<e[g].minScale?c=e[g].minScale:0<c&&0==e[g].minScale||0<c&&0<e[g].minScale&&(c=Math.min(c,e[g].minScale)),f=Math.max(f||0,e[g].maxScale||0),-1<e[g].parentLayerId)d=e[g].parentLayerId;
else break}return{minScale:c,maxScale:f}},_isSupportedLayerType:function(a){return a&&("esri.layers.ArcGISDynamicMapServiceLayer"===a.declaredClass||"esri.layers.ArcGISImageServiceLayer"===a.declaredClass&&10.2<=a.version||"esri.layers.ArcGISImageServiceVectorLayer"===a.declaredClass||"esri.layers.ArcGISTiledMapServiceLayer"===a.declaredClass||"esri.layers.FeatureLayer"===a.declaredClass||"esri.layers.StreamLayer"===a.declaredClass||"esri.layers.KMLLayer"===a.declaredClass||"esri.layers.GeoRSSLayer"===
a.declaredClass||"esri.layers.WMSLayer"===a.declaredClass||"esri.layers.WFSLayer"===a.declaredClass||"esri.layers.CSVLayer"===a.declaredClass)?!0:!1},isHostedTileService:function(a){var b=/(https?:)?\/\/services.*\.arcgis\.com/i;return"esri.layers.ArcGISTiledMapServiceLayer"===a.declaredClass&&b.test(a.url)?!0:!1},getField:function(a,b,c){if(a.getField)return a.getField(b);if(c&&c.fields){var f;q.forEach(c.fields,function(a){a.name===b&&(f=a)});return f}return null}});d.mixin(Y,{ALIGN_LEFT:0,ALIGN_RIGHT:1});
return Y})},"dojo/debounce":function(){define([],function(){return function(r,l){var d;return function(){d&&clearTimeout(d);var q=this,k=arguments;d=setTimeout(function(){r.apply(q,k)},l)}}})},"esri/numberUtils":function(){define(["dojo/has","dojo/number","dojo/i18n!dojo/cldr/nls/number","./kernel"],function(r,l,d,q){var k=function(d,h){return d-h},m={_reNumber:/^-?(\d+)(\.(\d+))?$/i,getDigits:function(d){var h=String(d),e=h.match(m._reNumber);d={integer:0,fractional:0};e&&e[1]?(d.integer=e[1].split("").length,
d.fractional=e[3]?e[3].split("").length:0):-1<h.toLowerCase().indexOf("e")&&(e=h.split("e"),h=e[0],e=e[1],h&&e&&(h=Number(h),e=Number(e),(d=0<e)||(e=Math.abs(e)),h=m.getDigits(h),d?(h.integer+=e,h.fractional=e>h.fractional?0:h.fractional-e):(h.fractional+=e,h.integer=e>h.integer?1:h.integer-e),d=h));return d},getFixedNumbers:function(d,h){var e,c;e=Number(d.toFixed(h));e<d?c=e+1/Math.pow(10,h):(c=e,e-=1/Math.pow(10,h));e=Number(e.toFixed(h));c=Number(c.toFixed(h));return[e,c]},getPctChange:function(d,
h,e,c){var b={prev:null,next:null},a;null!=e&&(a=d-e,b.prev=Math.floor(Math.abs(100*(h-e-a)/a)));null!=c&&(a=c-d,b.next=Math.floor(Math.abs(100*(c-h-a)/a)));return b},round:function(d,h){var e=d.slice(0),c,b,a,g,l,n,t,f,p,q=h&&null!=h.tolerance?h.tolerance:2,w=h&&h.indexes,z=h&&null!=h.strictBounds?h.strictBounds:!1;if(w)w.sort(k);else for(w=[],n=0;n<e.length;n++)w.push(n);for(n=0;n<w.length;n++)if(p=w[n],c=e[p],b=0===p?null:e[p-1],a=p===e.length-1?null:e[p+1],g=m.getDigits(c),g=g.fractional){t=0;
for(f=!1;t<=g&&!f;)l=m.getFixedNumbers(c,t),l=z&&0===n?l[1]:l[0],f=m.hasMinimalChange(c,l,b,a,q),t++;f&&(e[p]=l)}return e},hasMinimalChange:function(d,h,e,c,b){d=m.getPctChange(d,h,e,c);h=null==d.prev||d.prev<=b;e=null==d.next||d.next<=b;return h&&e||d.prev+d.next<=2*b},_reAllZeros:new RegExp("\\"+d.decimal+"0+$","g"),_reSomeZeros:RegExp("(\\d)0*$","g"),format:function(d,h){h=h||{places:20,round:-1};var e=l.format(d,h);e&&(e=e.replace(m._reSomeZeros,"$1").replace(m._reAllZeros,""));return e}};return m})},
"esri/renderers/utils":function(){define("dojo/_base/lang dojo/_base/array dojo/has dojo/date/locale ../kernel ../numberUtils ../Color dojo/i18n!../nls/jsapi dojo/i18n!dojo/cldr/nls/gregorian".split(" "),function(r,l,d,q,k,m,p,h,e){function c(a){return a&&l.map(a,function(a){return new p(a)})}function b(a,b,c){var f="";0===b?f=g.lt+" ":b===c&&(f=g.gt+" ");return f+a}var a={},g={lte:"\x3c\x3d",gte:"\x3e\x3d",lt:"\x3c",gt:"\x3e",pct:"%"},u={millisecond:0,second:1,minute:2,hour:3,day:4,month:5,year:6},
n={millisecond:{dateOptions:{formatLength:"long"},timeOptions:{formatLength:"medium"}},second:{dateOptions:{formatLength:"long"},timeOptions:{formatLength:"medium"}},minute:{dateOptions:{formatLength:"long"},timeOptions:{formatLength:"short"}},hour:{dateOptions:{formatLength:"long"},timeOptions:{formatLength:"short"}},day:{selector:"date",dateOptions:{formatLength:"long"}},month:{selector:"date",dateOptions:{formatLength:"long"}},year:{selector:"date",dateOptions:{selector:"year"}}},t={formatLength:"short",
fullYear:!0},f={formatLength:"short"};r.mixin(a,{timelineDateFormatOptions:{selector:"date",dateOptions:{formatLength:"short",fullYear:!0}},formatDate:function(a,b){var c,d=[];null==a||a instanceof Date||(a=new Date(a));b=b||{};b=r.mixin({},b);var g=b.selector?b.selector.toLowerCase():null;c=!g||-1<g.indexOf("time");g=!g||-1<g.indexOf("date");c&&(b.timeOptions=b.timeOptions||f,b.timeOptions&&(b.timeOptions=r.mixin({},b.timeOptions),b.timeOptions.selector=b.timeOptions.selector||"time",d.push(b.timeOptions)));
g&&(b.dateOptions=b.dateOptions||t,b.dateOptions&&(b.dateOptions=r.mixin({},b.dateOptions),b.dateOptions.selector=b.dateOptions.selector||"date",d.push(b.dateOptions)));d&&d.length?(d=l.map(d,function(b){return q.format(a,b)}),c=1==d.length?d[0]:e["dateTimeFormat-medium"].replace(/\'/g,"").replace(/\{(\d+)\}/g,function(a,b){return d[b]})):c=q.format(a);return c},createColorStops:function(c){var f=c.values,e=c.colors,d=c.labelIndexes,g=c.isDate,h=c.dateFormatOptions;c=[];return c=l.map(f,function(c,
n){var k=null;if(!d||-1<l.indexOf(d,n)){var t;(t=g?a.formatDate(c,h):m.format(c))&&(k=b(t,n,f.length-1))}return{value:c,color:e[n],label:k}})},updateColorStops:function(c){var f=c.stops,e=c.changes,d=c.isDate,g=c.dateFormatOptions,h=[],n,k=l.map(f,function(a){return a.value});l.forEach(e,function(a){h.push(a.index);k[a.index]=a.value});n=m.round(k,{indexes:h});l.forEach(f,function(c,e){c.value=k[e];if(null!=c.label){var h,l=null;(h=d?a.formatDate(n[e],g):m.format(n[e]))&&(l=b(h,e,f.length-1));c.label=
l}})},createClassBreakLabel:function(a){var b=a.minValue,c=a.maxValue,f=a.isFirstBreak?"":g.gt+" ";a="percent-of-total"===a.normalizationType?g.pct:"";b=null==b?"":m.format(b);c=null==c?"":m.format(c);return f+b+a+" "+h.smartMapping.minToMax+" "+c+a},setLabelsForClassBreaks:function(b){var c=b.classBreaks,f=b.classificationMethod,e=b.normalizationType,d=[];c&&c.length&&("standard-deviation"===f?console.log("setLabelsForClassBreaks: cannot set labels for class breaks generated using 'standard-deviation' method."):
b.round?(d.push(c[0].minValue),l.forEach(c,function(a){d.push(a.maxValue)}),d=m.round(d),l.forEach(c,function(b,c){b.label=a.createClassBreakLabel({minValue:0===c?d[0]:d[c],maxValue:d[c+1],isFirstBreak:0===c,normalizationType:e})})):l.forEach(c,function(b,c){b.label=a.createClassBreakLabel({minValue:b.minValue,maxValue:b.maxValue,isFirstBreak:0===c,normalizationType:e})}))},updateClassBreak:function(b){var c=b.classBreaks,f=b.normalizationType,e=b.change,d=e.index,e=e.value,g=-1,h=-1,n=c.length;"standard-deviation"===
b.classificationMethod?console.log("updateClassBreak: cannot update labels for class breaks generated using 'standard-deviation' method."):(0===d?g=d:d===n?h=d-1:(h=d-1,g=d),-1<g&&g<n&&(b=c[g],b.minValue=e,b.label=a.createClassBreakLabel({minValue:b.minValue,maxValue:b.maxValue,isFirstBreak:0===g,normalizationType:f})),-1<h&&h<n&&(b=c[h],b.maxValue=e,b.label=a.createClassBreakLabel({minValue:b.minValue,maxValue:b.maxValue,isFirstBreak:0===h,normalizationType:f})))},calculateDateFormatInterval:function(a){var b,
c,f=a.length,e,d,g,h,n,k,m=Infinity,t;a=l.map(a,function(a){return new Date(a)});for(b=0;b<f-1;b++){e=a[b];g=[];n=Infinity;k="";for(c=b+1;c<f;c++)d=a[c],d=e.getFullYear()!==d.getFullYear()&&"year"||e.getMonth()!==d.getMonth()&&"month"||e.getDate()!==d.getDate()&&"day"||e.getHours()!==d.getHours()&&"hour"||e.getMinutes()!==d.getMinutes()&&"minute"||e.getSeconds()!==d.getSeconds()&&"second"||"millisecond",h=u[d],h<n&&(n=h,k=d),g.push(d);n<m&&(m=n,t=k)}return t},createUniqueValueLabel:function(b){var c=
b.value,f=b.fieldInfo,e=b.domain;b=b.dateFormatInterval;var d=String(c);(e=e&&e.codedValues?e.getName(c):null)?d=e:"number"===typeof c&&(d=f&&"esriFieldTypeDate"===f.type?a.formatDate(c,b&&n[b]):m.format(c));return d},cloneColorInfo:function(a){var b;a&&(b=r.mixin({},a),b.colors=c(b.colors),b.stops=b.stops&&l.map(b.stops,function(a){a=r.mixin({},a);a.color&&(a.color=new p(a.color));return a}),b.legendOptions&&(b.legendOptions=r.mixin({},b.legendOptions)));return b},cloneOpacityInfo:function(a){var b;
if(a){b=r.mixin({},a);if(a=b.opacityValues)b.opacityValues=a.slice(0);if(a=b.stops)b.stops=l.map(a,function(a){return r.mixin({},a)});if(a=b.legendOptions)b.legendOptions=r.mixin({},a)}return b},cloneSizeInfo:function(b){var c;b&&(c=r.mixin({},b),c.stops&&(c.stops=l.map(c.stops,function(a){return r.mixin({},a)})),(b=c.minSize)&&"object"===typeof b&&(c.minSize=a.cloneSizeInfo(b)),(b=c.maxSize)&&"object"===typeof b&&(c.maxSize=a.cloneSizeInfo(b)),b=c.legendOptions)&&(c.legendOptions=r.mixin({},b),b=
b.customValues)&&(c.legendOptions.customValues=b.slice(0));return c}});return a})},"jimu/LayerInfos/LayerInfoForGeoRSS":function(){define(["dojo/_base/declare","dojo/_base/array","esri/graphicsUtils","./LayerInfo","esri/lang"],function(r,l,d,q,k){return r(q,{constructor:function(){},getExtent:function(){var k=this.layerObject.items;if(0===k.length)return null;k=d.graphicsExtent(k);return this._convertGeometryToMapSpatialRef(k)},_resetLayerObjectVisiblity:function(d){var k=d?d[this.id]:null;if(k){var h=
{},e;for(e in d)d.hasOwnProperty(e)&&"function"!==typeof d[e]&&(h[e]=d[e].visible);this._setSubLayerVisibleByCheckedInfo(h);this._setTopLayerVisible(k.visible)}},_setSubLayerVisibleByCheckedInfo:function(d){l.forEach(this.newSubLayers,function(l){k.isDefined(d[l.id])&&l.layerObject.setVisibility(d[l.id])},this)},_initVisible:function(){var d=!1,k;for(k=0;k<this.newSubLayers.length;k++)d=d||this.newSubLayers[k].layerObject.visible;d&&(this._visible=!0)},_setTopLayerVisible:function(d){this._visible=
d?!0:!1;l.forEach(this.newSubLayers,function(d){d.setLayerVisiblefromTopLayer()},this);this._onVisibilityChanged()},obtainNewSubLayers:function(){var d=[],k=this.layerObject.getFeatureLayers();l.forEach(k,function(h){h=this._layerInfoFactory.create({layerObject:h,title:h.label||h.title||h.name||h.id||" ",id:h.id||" ",subId:h.id||" ",collection:{layerInfo:this},selfType:"geo_rss",parentLayerInfo:this});d.push(h);h.init()},this);return d},_obtainLayerIndexesInMap:function(){var d=[],k,h;for(h=0;h<this.newSubLayers.length;h++)(k=
this._getLayerIndexesInMapByLayerId(this.newSubLayers[h].layerObject.id))&&d.push(k);return d},moveLeftOfIndex:function(d){var k;for(k=this.newSubLayers.length-1;0<=k;k--)this.map.reorderLayer(this.newSubLayers[k].layerObject,d)},moveRightOfIndex:function(d){var k;for(k=0;k<this.newSubLayers.length;k++)this.map.reorderLayer(this.newSubLayers[k].layerObject,d)}})})},"jimu/LayerInfos/LayerInfoForWMS":function(){define("dojo/_base/declare dojo/_base/array dojo/_base/lang dojo/topic dojo/Deferred esri/graphicsUtils dojo/aspect ./LayerInfo ./LayerInfoForDefaultWMS esri/layers/FeatureLayer esri/lang".split(" "),
function(r,l,d,q,k,m,p,h,e,c,b){return r(h,{constructor:function(a,b){},getExtent:function(){return this._convertGeometryToMapSpatialRef(this.originOperLayer.layerObject.extent)},_initVisible:function(){this._visible=this.layerObject.visible},_setTopLayerVisible:function(a){this._visible=a;this.layerObject.setVisibility(a)},_setSubLayerVisible:function(a){var b=[],c,b=d.clone(this.originOperLayer.layerObject.visibleLayers),e;for(e in a)if(a.hasOwnProperty(e)&&"function"!==typeof a[e]){var h=a[e],
f=e.toString();c=l.indexOf(b,f);h?0>c&&b.push(f):0<=c&&b.splice(c,1)}this._setVisibleLayersBySelfFlag=!0;this.layerObject.setVisibleLayers(b)},_resetLayerObjectVisiblity:function(a){var b=a?a[this.id]:null,c=!1;if(a){b&&this.layerObject.setVisibility(b.visible);var b={},e;for(e in a)a.hasOwnProperty(e)&&"function"!==typeof a[e]&&(c=!0,b[e]=a[e].visible);c&&this._setSubLayerVisibleByCheckedInfo(b)}},_setSubLayerVisibleByCheckedInfo:function(a){var c={};this.traversal(function(c){c.isRootLayer()||b.isDefined(a[c.id])&&
c._setVisible(a[c.id])});this.traversal(function(a){0===a.getSubLayers().length&&(c[a.subId]=a._isAllSubLayerVisibleOnPath())});this._setSubLayerVisible(c)},_getServiceDefinition:function(){var a=this.getUrl();return this._serviceDefinitionBuffer.getRequest(this.subId).request(a)},_serviceDefinitionRequest:function(a){return this._normalRequest(a,{SERVICE:"WMS",REQUEST:"GetCapabilities"},"xml")},obtainNewSubLayers:function(){var a=[];l.forEach(this.layerObject.layerInfos,function(b,c){var e;e=this._getOperLayerFromWMSLayerInfo(b,
this);e=this._layerInfoFactory.create(e);a.push(e);e.init()},this);return a},_getOperLayerFromWMSLayerInfo:function(a,b){return{layerObject:this.layerObject,title:a.label||a.title||a.name||" ",id:this.id+"_"+(a.name||"-"),subId:a.name||"-",wms:{layerInfo:this,subId:a.name||"-",wmsLayerInfo:a},selfType:"wms",parentLayerInfo:b}},_bindEvent:function(){this.inherited(arguments);this.layerObject&&!this.layerObject.empty&&p.after(this.layerObject,"setVisibleLayers",d.hitch(this,this._onVisibleLayersChanged))},
_onVisibleLayersChanged:function(){var a=[];this._setVisibleLayersBySelfFlag||(this.traversal(function(a){a.isRootLayer()||a._initVisible()}),this._setVisibleLayersBySelfFlag=!1);this.traversal(function(b){b.isRootLayer()||a.push(b)});this._setVisibleLayersBySelfFlag=!1;q.publish("layerInfos/layerInfo/visibleChanged",a);this._isShowInMapChanged2()}})})},"jimu/LayerInfos/LayerInfoForDefaultWMS":function(){define("dojo/_base/declare dojo/_base/array dojo/_base/html dojo/dom-construct dojo/on ./LayerInfoForDefault".split(" "),
function(r,l,d,q,k,m){return r(m,{constructor:function(d,h){this.layerObject=d.layerObject},getExtent:function(){},_resetLayerObjectVisiblity:function(){},_initVisible:function(){var d=!1;this.traversal(function(h){if(0<=l.indexOf(h.layerObject.visibleLayers,h.subId))return d=!0});this._visible=d},_setVisible:function(d){this._visible=d?!0:!1},_setTopLayerVisible:function(d){var h=this.originOperLayer.wms;this._visible=d?!0:!1;var e={};this.traversal(function(c){0===c.getSubLayers().length&&(e[c.subId]=
c._isAllSubLayerVisibleOnPath())});h.layerInfo._setSubLayerVisible(e)},_getServiceDefinition:function(){var d=this.getUrl();return this._serviceDefinitionBuffer.getRequest(this.subId).request(d)},_serviceDefinitionRequest:function(d){return this._normalRequest(d,{SERVICE:"WMS",REQUEST:"GetCapabilities"},"xml")},obtainNewSubLayers:function(){var d=[],h=this.originOperLayer.wms;l.forEach(h.wmsLayerInfo.subLayers,function(e){e=h.layerInfo._getOperLayerFromWMSLayerInfo(e,this);e=this._layerInfoFactory.create(e);
d.push(e);e.init()},this);return d},drawLegends:function(d){this._initLegendsNode(d)},_initLegendsNode:function(l){if(this.originOperLayer.wms.wmsLayerInfo.legendURL){var h=q.create("img",{"class":"legend-div-image",src:this.originOperLayer.wms.wmsLayerInfo.legendURL});k(h,"load",function(){q.empty(l);var e=q.create("div",{"class":"legend-div"},l);d.place(h,e)})}else q.empty(l)},getOpacity:function(){},setOpacity:function(d){},_bindEvent:function(){},_onVisibleLayersChanged:function(){},getScaleRange:function(){return this.originOperLayer.wms.layerInfo.getScaleRange()}})})},
"jimu/LayerInfos/LayerInfoForDefaultDynamic":function(){define(["dojo/_base/declare","./LayerInfoForDefaultService"],function(r,l){return r(l,{constructor:function(d,l){},_initVisible:function(){var d=!1,l=this.originOperLayer.mapService;l&&l.layerInfo._subLayerVisible[l.subId]&&(d=!0);this._visible=d},_setTopLayerVisible:function(d){var l=this.originOperLayer.mapService;if(l){l.layerInfo._subLayerVisible[l.subId]=d?!0:!1;this._visible=d;var k={};this.traversal(function(d){0===d.getSubLayers().length&&
(k[d.originOperLayer.mapService.subId]=d._isAllSubLayerVisibleOnPath())});l.layerInfo._setSubLayerVisible(k)}}})})},"jimu/LayerInfos/LayerInfoForDefaultService":function(){define("dojo/_base/declare dojo/_base/array dojo/_base/lang dojo/Deferred dojo/dom-construct ./LayerInfoForDefault ./LayerObjectFacory".split(" "),function(r,l,d,q,k,m,p){return r(m,{_legendsNode:null,_layerObjectFacory:null,constructor:function(){this._layerObjectFacory=new p(this)},_resetLayerObjectVisiblity:function(){},_loadLegends:function(h){var e=
new q;this.originOperLayer.mapService.layerInfo.getLegendInfo(h).then(d.hitch(this,function(c){e.resolve(c)}));return e},drawLegends:function(h,e){this._loadLegends(e).then(d.hitch(this,function(c){this._initLegendsNode(c,h)}))},_initLegendsNode:function(d,e){var c=this.originOperLayer.mapService;if(d){k.empty(e);for(var b=null,a=0;a<d.length;a++)if(d[a].layerId===c.subId){b=d[a];break}if(b){var g=k.create("table",{"class":"legend-table",style:"font-size: 12px"},e);l.forEach(b.legend,function(a){if("\x3call other values\x3e"!==
a.label){var b=k.create("tr",{"class":"legend-tr",style:"border: 1px solid"},g),c=k.create("td",{"class":"legend-symbol-td",style:""},b),f=null,f=a.imageData?"data:"+a.contentType+";base64,"+a.imageData:a.url;k.create("img",{"class":"legend-symbol-image",style:"overflow:auto;margin:auto;top:0;left:0;bottom:0;right:0",src:f},c);k.create("td",{"class":"legend-label-td",innerHTML:a.label||" ",style:"padding-left: 5px"},b)}},this)}}},_initControlPopup:function(){var d=this.originOperLayer.mapService.layerInfo.layerObject,
e=this.originOperLayer.mapService.subId;this.controlPopupInfo={enablePopup:d.infoTemplates&&d.infoTemplates[e]?!0:!1,infoTemplates:void 0}},_afterSetInfoTemplates:function(){var d=this.originOperLayer.mapService.layerInfo.layerObject,e=this.originOperLayer.mapService.subId;!this.controlPopupInfo.enablePopup&&d.infoTemplates&&delete d.infoTemplates[e]},_getShowLegendOfWebmap:function(){return this.originOperLayer.mapService.layerInfo._getSublayerShowLegendOfWebmap(this.originOperLayer.mapService.subId)},
_getServiceDefinition:function(){return this.originOperLayer.mapService.layerInfo._getSubserviceDefinition(this.subId)},_getLayerObject:function(){var h=new q;this._layerObjectFacory.getLayerObject().then(d.hitch(this,function(e){this.layerObject.empty&&e&&(this.layerObject=e);h.resolve(e)}));return h},getLayerObject:function(){return this._getLayerObject()},getPopupInfo:function(){var d=null,e=this.originOperLayer.mapService.layerInfo.originOperLayer.layers;if(e)for(var c=0;c<e.length;c++)if(e[c].id===
this.originOperLayer.mapService.subId){d=e[c].popupInfo;break}return d},getFilterOfWebmap:function(){var d=null,e=this.originOperLayer.mapService.layerInfo.originOperLayer.layers;if(e)for(var c=0;c<e.length;c++)if(e[c].id===this.originOperLayer.mapService.subId){d=e[c].layerDefinition?e[c].layerDefinition.definitionExpression:null;break}return d},getFilter:function(){var d=this.originOperLayer.mapService;return d.layerInfo.layerObject&&d.layerInfo.layerObject.layerDefinitions?d.layerInfo.layerObject.layerDefinitions[d.subId]:
null},setFilter:function(d){var e,c=this.originOperLayer.mapService;c.layerInfo.layerObject&&c.layerInfo.layerObject.setLayerDefinitions&&(e=c.layerInfo.layerObject.layerDefinitions?l.map(c.layerInfo.layerObject.layerDefinitions,function(b){return b}):[],e[c.subId]=d,c.layerInfo.layerObject.setLayerDefinitions(e))},getLayerType:function(){var h=new q;0<this.getSubLayers().length?h.resolve("GroupLayer"):this._getServiceDefinition().then(d.hitch(this,function(e){e?h.resolve(e.type.replace(/\ /g,"")):
h.resolve(null)}),function(){h.resolve(null)});return h},getSupportTableInfo:function(){var h=new q,e={isSupportedLayer:!1,isSupportQuery:!1,layerType:null};this.getLayerType().then(d.hitch(this,function(c){e.layerType=c;0<=this._getLayerTypesOfSupportTable().indexOf(c)&&(e.isSupportedLayer=!0);this._getServiceDefinition().then(d.hitch(this,function(b){b&&0<=b.capabilities.indexOf("Data")&&(e.isSupportQuery=!0);h.resolve(e)}),function(){h.resolve(e)})}),function(){h.resolve(e)});return h},enablePopup:function(){var h=
this.originOperLayer.mapService.layerInfo,e=h.layerObject,c=this.originOperLayer.mapService.subId;return this.loadInfoTemplate().then(d.hitch(this,function(){return h.controlPopupInfo.infoTemplates&&h.controlPopupInfo.infoTemplates[c]?(this.controlPopupInfo.enablePopup=!0,e.infoTemplates||(e.infoTemplates={}),e.infoTemplates[c]=h.controlPopupInfo.infoTemplates[c],!0):!1}))},disablePopup:function(){var d=this.originOperLayer.mapService.layerInfo.layerObject,e=this.originOperLayer.mapService.subId;
this.controlPopupInfo.enablePopup=!1;d.infoTemplates&&delete d.infoTemplates[e]},loadInfoTemplate:function(){var h=new q,e=this.originOperLayer.mapService.layerInfo,c=this.originOperLayer.mapService.subId;e.controlPopupInfo.infoTemplates&&e.controlPopupInfo.infoTemplates[c]&&e.controlPopupInfo.infoTemplates[c].infoTemplate?h.resolve(e.controlPopupInfo.infoTemplates[c].infoTemplate):(e.controlPopupInfo.infoTemplates||(e.controlPopupInfo.infoTemplates={}),this.getLayerObject().then(d.hitch(this,function(b){b=
this._getDefaultPopupTemplate(b);e.controlPopupInfo.infoTemplates[c]={infoTemplate:b,layerUrl:null};h.resolve(b)}),d.hitch(this,function(){h.resolve(null)})));return h},getInfoTemplate:function(){var d=this.originOperLayer.mapService.layerInfo,e=this.originOperLayer.mapService.subId;return d.controlPopupInfo.infoTemplates&&d.controlPopupInfo.infoTemplates[e]&&d.controlPopupInfo.infoTemplates[e].infoTemplate?d.controlPopupInfo.infoTemplates[e].infoTemplate:null},getScaleRange:function(){var d=this.originOperLayer.mapService;
return(d=d.layerInfo._getJsapiLayerInfoById(d.subId))&&0<=d.minScale&&0<=d.maxScale?{minScale:d.minScale,maxScale:d.maxScale}:{minScale:0,maxScale:0}},_onVisibilityChanged:function(){}})})},"jimu/LayerInfos/LayerObjectFacory":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/Deferred ./RequestBuffer esri/layers/FeatureLayer esri/layers/RasterLayer esri/layers/StreamLayer esri/layers/ArcGISImageServiceLayer esri/layers/ArcGISImageServiceVectorLayer".split(" "),function(r,
l,d,q,k,m,p,h,e,c){return r(null,{_layerInfo:null,_layerObjectBuffer:null,constructor:function(b){this._layerInfo=b;this._initLayerObjectBuffer()},_initLayerObjectBuffer:function(){this._layerObjectBuffer=new k(l.hitch(this,this._getLayerObject))},getLayerObject:function(){return this._layerObjectBuffer.getRequest(this._layerInfo.subId).request()},_getLayerObject:function(){var b,a=new q,d=this._layerInfo.getUrl();this._layerInfo.getLayerType().then(l.hitch(this,function(g){var n=l.mixin(this._getLayerOptionsForCreateLayerObject(),
this._layerInfo.originOperLayer.options||{})||{};switch(g){case "FeatureLayer":b=new m(d,n);break;case "RasterLayer":b=new p(d);break;case "StreamLayer":b=new h(d);break;case "ArcGISImageServiceLayer":b=new e(d);break;case "ArcGISImageServiceVectorLayer":b=new c(d);break;case "Table":if(this._layerInfo.layerObject&&this._layerInfo.layerObject.url)b=new m(d,n);else return this._layerInfo.layerObject&&this._layerInfo.layerObject.featureCollectionData?(b=new m(this._layerInfo.layerObject.featureCollectionData,
n),a.resolve(b)):a.resolve(null),a;break;case "GroupLayer":return a=this._getGroupLayerObject();default:return a.resolve(null),a}var k=b.on("load",l.hitch(this,function(){this._setLayerObjectProperties(b);a.resolve(b);k.remove&&k.remove()})),f=b.on("error",l.hitch(this,function(b){a.reject(b);f.remove&&f.remove()}))}),l.hitch(this,function(){a.reject()}));return a},_getGroupLayerObject:function(){var b=new q;this._layerInfo._getServiceDefinition().then(l.hitch(this,function(a){if(null===a)b.reject();
else{var c=this._layerInfo.getUrl();a.url=c;a.id=this._layerInfo.id;b.resolve(a)}}));return b},_getLayerOptionsForCreateLayerObject:function(){var b={},a=[],c=this._layerInfo.getInfoTemplate();c&&c.info&&c.info.fieldInfos?d.forEach(c.info.fieldInfos,function(b){b.visible&&a.push(b.fieldName)},this):a=["*"];b.outFields=a;return b},_setLayerObjectProperties:function(b){b.name&&!l.getObject("_wabProperties.originalLayerName",!1,b)&&(l.setObject("_wabProperties.originalLayerName",b.name,b),b.name=this._layerInfo.title);
b.id=this._layerInfo.id}})})},"esri/layers/RasterLayer":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/connect dojo/_base/array dojo/sniff dojo/dom-construct dojo/dom-style dojo/number ../lang ../domUtils ./BaseRasterLayer ./ImageServiceLayerMixin ./pixelFilters/StretchFilter ../SpatialReference ../geometry/Point".split(" "),function(r,l,d,q,k,m,p,h,e,c,b,a,g,u,n){return r([b,a],{declaredClass:"esri.layers.RasterLayer",constructor:function(a,b){this.pixelData=null;null!==this.format&&
void 0!==this.format||this.setImageFormat("LERC",!0)},_setDefaultFilter:function(){if(this.loaded&&this.drawType&&!this._isVectorData()&&(!this.pixelFilter||this._isDefaultPixelFilter))if("jpeg"===this.format.toLowerCase()||"jpg"===this.format.toLowerCase()||-1<this.format.toLowerCase().indexOf("png"))this._isDefaultPixelFilter&&(this.pixelFilter=null,this._isDefaultPixelFilter=!1);else{var a,b;if(this.minValues&&this.maxValues&&this.stdvValues&&this.meanValues){a=[];for(b=0;b<this.minValues.length;b++)a.push([this.minValues[b],
this.maxValues[b],this.meanValues[b],this.stdvValues[b]]);this.bandCount!==a.length&&(a=null)}b=0;var c=!1;"U8"===this.pixelType?(b=5,c=a?!1:!0):a?(b=5,c=!1):(b=6,c=!0);this.renderingRule&&(b=5,c=!0);this.pixelFilter=(new g({stretchType:b,min:0,max:255,dra:c,minPercent:.25,maxPercent:.25,useGamma:!1,computeGamma:!1,statistics:a,numberOfStandardDeviations:2.5})).filter;this._isDefaultPixelFilter=!0}}})})},"esri/layers/BaseRasterLayer":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/connect dojo/_base/array dojo/sniff dojo/dom-construct dojo/dom-style dojox/gfx/matrix ../kernel ../config ../lang ../domUtils ../geometry/Point ./layer".split(" "),
function(r,l,d,q,k,m,p,h,e,c,b,a,g,u){var n=c.defaults.map.zoomDuration;return r([u],{declaredClass:"esri.layers.BaseRasterLayer",managedSuspension:!0,opacity:1,constructor:function(a,b){this.drawMode=b&&void 0!==b.drawMode?b.drawMode:!0;this.drawType=b&&b.drawType?b.drawType:"2d";this.pixelData=null;this._initialize(a,b)},setDrawMode:function(a){this.drawMode=a},setOpacity:function(a){this.opacity!==a&&(this.opacity=a,this.onOpacityChange(a))},onOpacityChange:function(){},refresh:function(){if(!this._canDraw()||
10>k("ie"))this.onError(Error("Unable to refresh. This layer is not supported in the current browser."));else this._map&&this._extentChangeHandler(this._map.extent)},clear:function(){this._canDraw()&&"2d"===this.drawType&&this._context.clearRect(0,0,this._mapWidth,this._mapHeight)},getContext:function(){return this._context},onResume:function(){this.inherited(arguments);this._toggleTime();if("css-transforms"===this._map.navigationMode){var a=this._map.__visibleDelta;this._left=this._tdx=a.x;this._top=
this._tdy=a.y;p.set(this._div,e._css.names.transform,e._css.translate(this._left,this._top))}this._displayTimer=this._displayTimer||setTimeout(l.hitch(this,function(){this._extentChangeHandler(this._map.extent,null,!0)}),0)},onSuspend:function(){this.inherited(arguments);this._toggleTime();clearTimeout(this._displayTimer);this._displayTimer=null},redraw:function(){this.hasDataChanged=!1;this._setPixelData(this.originalPixelData)},getCurrentResolution:function(){var a=this._map.extent;return new g((a.xmax-
a.xmin)/this._map.width,(a.ymax-a.ymin)/this._map.height,a.spatialReference)},setPixelFilter:function(a,b){this.pixelFilter=a;b||this.redraw()},_toggleTime:function(){},_setMap:function(a,c){this.inherited(arguments);this._dragOrigin={x:0,y:0};var f=this._div=m.create("div",null,c),g={width:a.width+"px",height:a.height+"px",position:"absolute"};"css-transforms"===a.navigationMode?(g[e._css.names.transform]=e._css.translate(a.__visibleDelta.x,a.__visibleDelta.y),this._left=a.__visibleDelta.x,this._top=
a.__visibleDelta.y):this._left=this._top=0;p.set(f,g);this._canvas=m.create("canvas",{id:"canvas",width:a.width+"px",height:a.height+"px",style:"position: absolute;"},f);b.isDefined(this.opacity)&&p.set(f,"opacity",this.opacity);(this._context=this._canvas.getContext(this.drawType))||console.error("Unable to create the context. This browser might not support \x3ccanvas\x3e elements.");this._mapWidth=a.width;this._mapHeight=a.height;this._connects=[];this._connects.push(d.connect(a,"onPan",this,this._panHandler));
this._connects.push(d.connect(a,"onPanEnd",this,this._panEndHandler));"css-transforms"===a.navigationMode?this._connects.push(d.connect(a,"onScale",this,this._onScaleHandler)):(this._connects.push(d.connect(a,"onZoom",this,this._onZoomHandler)),this._connects.push(d.connect(a,"onZoomEnd",this,this._onZoomEndHandler)));this._connects.push(d.connect(a,"onResize",this,this._onResizeHandler));this._connects.push(d.connect(a,"onExtentChange",this,this._extentChangeHandler));this._connects.push(d.connect(this,
"onVisibilityChange",this,this._visibilityChangeHandler));this._connects.push(d.connect(this,"onOpacityChange",this,this._opacityChangeHandler));this._startRect={left:0,top:0,width:a.width,height:a.height};this.evaluateSuspension();if(this.suspended&&!a.loaded)var h=d.connect(a,"onLoad",this,function(){d.disconnect(h);h=null;this.evaluateSuspension()});return f},_unsetMap:function(a,b){q.forEach(this._connects,d.disconnect,this);var c=this._div;c&&(b.removeChild(c),m.destroy(c));this._map=this._canvas=
this._context=this.data=this._connects=null;clearTimeout(this._displayTimer);this._displayTimer=null;this.inherited(arguments)},_canDraw:function(){return!!(this._map&&this._canvas&&this._context)},_requestDataErrorHandler:function(a){"CancelError"!==a.name&&(this.clear(),this.onError(a))},_drawPixelData:function(){this._startRect={left:0,top:0,width:this._map.width,height:this._map.height};var a=this._useBrowserDecoding();!a&&this.drawMode||"css-transforms"!==this._map.navigationMode||(this._tdx=
this._left,this._tdy=this._top,this._multiply=null,p.set(this._div,e._css.names.transform,e._css.translate(this._left,this._top)),p.set(this._canvas,e._css.names.transform,e._css.translate(-this._left,-this._top)),this._dragOrigin={x:0,y:0});if(this._canDraw&&this.drawMode)if(a)this._fireUpdateEnd();else if(this.drawMode)if(this.pixelData&&this.pixelData.pixelBlock){var a=this.pixelData.pixelBlock,b=this._context,c=b.createImageData(a.width,a.height);c.data.set(a.getAsRGBA());var d=this.pixelData.extent,
g=this._map.extent,h=this.getCurrentResolution(),n=0,k=0;Math.abs(d.xmin-g.xmin)>h.x&&(n=Math.round((d.xmin-g.xmin)/h.x));Math.abs(g.ymax-d.ymax)>h.y&&(k=Math.round((g.ymax-d.ymax)/h.y));this.clear();"css-transforms"===this._map.navigationMode?(this._tdx=this._left,this._tdy=this._top,this._multiply=null,p.set(this._div,e._css.names.transform,e._css.translate(this._left,this._top)),p.set(this._canvas,e._css.names.transform,e._css.translate(-this._left,-this._top))):(p.set(this._div,{left:"0px",top:"0px",
width:this._map.width+"px",height:this._map.height+"px"}),p.set(this._canvas,{left:"0px",top:"0px",width:this._map.width+"px",height:this._map.height+"px"}));this._dragOrigin={x:0,y:0};b.putImageData(c,n,k,0,0,a.width,a.height);this._fireUpdateEnd()}else this.clear()},_panHandler:function(a,b){"css-transforms"===this._map.navigationMode?(this._left=this._map.__visibleDelta.x+b.x,this._top=this._map.__visibleDelta.y+b.y,p.set(this._div,e._css.names.transform,e._css.translate(this._left,this._top))):
p.set(this._div,{left:this._startRect.left+b.x+"px",top:this._startRect.top+b.y+"px"})},_panEndHandler:function(a,b){b&&(this._startRect.left+=b.x,this._startRect.top+=b.y)},_onScaleHandler:function(a,b){var c={},f=e._css.names;p.set(this._canvas,f.transition,b?"none":f.transformName+" "+n+"ms ease");this._matrix=a;a=this._multiply?h.multiply(a,this._multiply):a;if(this._tdx||this._tdy)a=h.multiply(a,{xx:1,xy:0,yx:0,yy:1,dx:-this._tdx,dy:-this._tdy});c[f.transform]=e._css.matrix(a);p.set(this._canvas,
c)},_onZoomHandler:function(a,b,c){var f=this._startRect;a=f.width*b;b*=f.height;var e=f.left-(a-f.width)*(c.x-f.left)/f.width;c=f.top-(b-f.height)*(c.y-f.top)/f.height;p.set(this._canvas,{left:e+"px",top:c+"px",width:a+"px",height:b+"px"});this._endRect={left:e,top:c,width:a,height:b}},_onZoomEndHandler:function(){this._endRect&&(this._startRect=this._endRect)},_onResizeHandler:function(a,b,c){p.set(this._div,{width:b+"px",height:c+"px"});p.set(this._canvas,{width:b+"px",height:c+"px"});this._startRect.width=
this._canvas.width=b;this._startRect.height=this._canvas.height=c},_extentChangeHandler:function(a,b,c,d){this.suspended||b&&0===b.x&&0===b.y&&!c||("css-transforms"===this._map.navigationMode&&(b&&(this._dragOrigin.x+=b.x,this._dragOrigin.y+=b.y),c||(this._left=this._map.__visibleDelta.x,this._top=this._map.__visibleDelta.y,p.set(this._div,e._css.names.transform,e._css.translate(this._left,this._top))),c&&(p.set(this._canvas,e._css.names.transition,"none"),this._multiply=this._multiply?h.multiply(this._matrix,
this._multiply):this._matrix)),this._fireUpdateStart(),a=this._map,this._requestData(a.extent,a.width,a.height))},_visibilityChangeHandler:function(b){b?a.show(this._div):a.hide(this._div)},_opacityChangeHandler:function(a){p.set(this._div,"opacity",a)}})})},"esri/layers/ImageServiceLayerMixin":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/Deferred dojo/_base/array dojo/_base/json dojo/_base/config dojo/_base/connect dojo/has dojo/io-query dojo/DeferredList ../kernel ../config ../lang ../request ../deferredUtils ../urlUtils ../geometry/Extent ../geometry/Point ../geometry/Polygon ./MosaicRule ./RasterFunction ./DimensionalDefinition ./Raster ./PixelBlock ./pixelFilters/VectorFieldPixelFilter ./rasterFormats/ImageCanvasDecoder ./TimeInfo ./Field ../graphic ../tasks/ImageServiceIdentifyTask ../tasks/ImageServiceIdentifyParameters".split(" "),
function(r,l,d,q,k,m,p,h,e,c,b,a,g,u,n,t,f,v,x,w,z,A,y,B,C,E,D,F,G,J,N){return r(null,{declaredClass:"esri.layers.ImageServiceLayerMixin",_rasterFieldPrefix:"Raster.",_renderingRuleFieldSubPrefix:"ServicePixelValue.",_rasterFunctionServiceInfoProps:"bandCount pixelType hasRasterAttributeTable hasHistograms minValues maxValues meanValues stdvValues".split(" "),_rasterFunctionTemplateInfos:{},_eventMap:{"rendering-change":!0,"mosaic-rule-change":!0,"spatial-reference-change":!0,"renderer-change":!0},
constructor:function(a,b){this.useMapTime=b&&b.hasOwnProperty("useMapTime")?!!b.useMapTime:!0},_initialize:function(a,b){this._url=t.urlToObject(a);this.raster=new y(this._url.path);this.infoTemplate=b&&b.infoTemplate;var c=b&&b.imageServiceParameters;this.format=c&&c.format;this.compressionTolerance=c&&c.compressionTolerance?c.compressionTolerance:.01;this.interpolation=c?c.interpolation:null;this.compressionQuality=c?c.compressionQuality:null;this.bandIds=c?c.bandIds:null;this.mosaicRule=c?c.mosaicRule:
null;this.renderingRule=c?c.renderingRule:null;this.renderer=c?c.renderer:null;this.useMapDimensionValue=b&&b.hasOwnProperty("useMapDimensionValue")?!!b.useMapDimensionValue:!0;this.activeMapDimensions=b&&b.activeMapDimensions;this._params=l.mixin({},this._url.query,{f:"image",interpolation:this.interpolation,format:this.format,compressionQuality:this.compressionQuality,bandIds:this.bandIds?this.bandIds.join(","):null},c?c.toJson():{});this.pixelFilter=b&&b.pixelFilter;this.originalPixelData=this.pixelData=
null;this.hasDataChanged=!0;this._requestDataHandler=l.hitch(this,this._requestDataHandler);this._requestDataErrorHandler=l.hitch(this,this._requestDataErrorHandler);this._rasterReadPromise=null;this._initLayer=l.hitch(this,this._initLayer);this._queryVisibleRastersHandler=l.hitch(this,this._queryVisibleRastersHandler);this._visibleRasters=[];this._rasterAttributeTableFields=[];this._rasterAttributeTableFeatures=[];this._renderingRuleAttributeTable={};this._useRenderingRuleAttributeTable=!1;this._loadCallback=
b&&b.loadCallback;(c=b&&b.resourceInfo)?this._initLayer(c):u({url:this._url.path,content:l.mixin({f:"json"},this._url.query),callbackParamName:"callback",load:this._initLayer,error:this._errorHandler});this.registerConnectEvents()},disableClientCaching:!1,_initLayer:function(a,b){if(null!==a&&void 0!==a){this._findCredential();(this.credential&&this.credential.ssl||a&&a._ssl)&&this._useSSL();var c=this.minScale,e=this.maxScale;l.mixin(this,a);this.minScale=c;this.maxScale=e;this.initialExtent=this.fullExtent=
this.extent=new f(a.extent);this.spatialReference=this.initialExtent.spatialReference;this.pixelSizeX=parseFloat(this.pixelSizeX);this.pixelSizeY=parseFloat(this.pixelSizeY);for(var d=this.minValues,h=this.maxValues,n=this.meanValues,k=this.stdvValues,m=this.bands=[],c=0,e=this.bandCount;c<e;c++)m[c]={min:d[c],max:h[c],mean:n[c],stddev:k[c]};this.timeInfo=(c=this.timeInfo)&&c.timeExtent?new D(c):null;e=this.fields=[];if(d=a.fields)for(c=0;c<d.length;c++)e.push(new F(d[c]));this.version=a.currentVersion;
this.version||(this.version="fields"in a||"objectIdField"in a||"timeInfo"in a?10:9.3);g.isDefined(a.minScale)&&!this._hasMin&&this.setMinScale(a.minScale);g.isDefined(a.maxScale)&&!this._hasMax&&this.setMaxScale(a.maxScale);c={};a.defaultMosaicMethod?(c.method=a.defaultMosaicMethod,c.operation=a.mosaicOperator,c.sortField=a.sortField,c.sortValue=a.sortValue):c.method=w.METHOD_NONE;this.defaultMosaicRule=new w(c);this.defaultMosaicRule.ascending=!0;this._useRenderingRuleAttributeTable=10<this.version&&
"esriImageServiceDataTypeThematic"===this.serviceDataType&&!this.hasRasterAttributeTable;this._setDefaultRenderingRule(!0);this._isScientificData()&&(!this.mosaicRule||this.mosaicRule&&!this.mosaicRule.multidimensionalDefinition)&&this._setDefaultMultidimensionalDefinition(!0);10<this.version&&this.hasRasterAttributeTable&&this.getRasterAttributeTable().then(l.hitch(this,function(a){a&&(a.features&&a.fields&&(this.rasterAttributeTable=l.clone(a)),a.features&&0<a.features.length&&(this._rasterAttributeTableFeatures=
l.clone(a.features)),a.fields&&0<a.fields.length&&(this._rasterAttributeTableFields=l.clone(a.fields)),!this.renderer||"esri.renderer.ClassBreaksRenderer"!==this.renderer.declaredClass&&"esri.renderer.UniqueValueRenderer"!==this.renderer.declaredClass||this.refresh())}));this._isVectorData()&&!g.isDefined(this.pixelFilter)&&(this.vectorFieldPixelFilter=new C,this.vectorFieldPixelFilter.isDataUV="esriImageServiceDataTypeVector-UV"===this.serviceDataType,this.pixelFilter=this.vectorFieldPixelFilter.computeMagnitudeAndDirection,
this.getKeyProperties().then(l.hitch(this,this._setFlowRepresentation)));this.loaded=!0;this._setDefaultFilter();this.onLoad(this);if(c=this._loadCallback)delete this._loadCallback,c(this)}},getKeyProperties:function(){var a=this._url.path+"/keyProperties",b=new d(n._dfdCanceller);10<this.version?(b._pendingDfd=u({url:a,content:{f:"json"},handleAs:"json",callbackParamName:"callback"}),b._pendingDfd.then(function(a){b.callback(a)},function(a){b.errback(a)})):(a=Error("Layer does not have key properties"),
a.log=!!m.isDebug,b.errback(a));return b},getRasterAttributeTable:function(a){var b=this._url.path+"/rasterAttributeTable",c=new d(n._dfdCanceller),f={f:"json"},e=this.hasRasterAttributeTable;a&&a.renderingRule&&(f.renderingRule=k.toJson(a.renderingRule.toJson()),e=!0);10<this.version&&e?(c._pendingDfd=u({url:b,content:f,handleAs:"json",callbackParamName:"callback"}),c._pendingDfd.then(function(a){c.callback(a)},function(a){c.errback(a)})):(a=Error("Layer does not support raster attribute table"),
a.log=!!m.isDebug,c.errback(a));return c},getRenderingRuleAttributeTable:function(a){var b=new d(n._dfdCanceller);if(!a||!a.renderingRule)return b.errback(Error("Rendering rule is not specified")),b;a=a.renderingRule;var c=a.functionName;this._renderingRuleAttributeTable&&c&&this._renderingRuleAttributeTable.hasOwnProperty(c)?b.resolve(this._renderingRuleAttributeTable[c]):b=this.getRasterAttributeTable({renderingRule:a}).then(l.hitch(this,function(a){var b;a&&a.features&&a.features.length&&a.fields&&
a.fields.length&&(b={features:l.clone(a.features),fields:l.clone(a.fields)},c&&(this._renderingRuleAttributeTable[c]=b));return b}));return b},_getRasterAttributeTableFeatures:function(){var a=new d;if(this._rasterAttributeTableFeatures&&0<this._rasterAttributeTableFeatures.length)return a.resolve(this._rasterAttributeTableFeatures),a;if(10<this.version&&this.hasRasterAttributeTable)return a=this.getRasterAttributeTable(),a.then(l.hitch(this,function(a){a&&a.features&&0<a.features.length&&(this._rasterAttributeTableFeatures=
l.clone(a.features))})),a;a.resolve(this._rasterAttributeTableFeatures);return a},_getRenderingRuleAttributeTableFeatures:function(a){a=a&&a.renderingRule;return a?this.getRenderingRuleAttributeTable({renderingRule:a}).then(function(a){return a&&a.features}):(a=new d,a.errback(Error("Rendering rule is not specified")),a)},getCustomRasterFields:function(a){var b=a?a.rasterAttributeTableFieldPrefix:this._rasterFieldPrefix;a=10.3<=this.version?"esriFieldTypeDouble":"esriFieldTypeString";var c={name:this._rasterFieldPrefix+
"ItemPixelValue",alias:"Item Pixel Value",domain:null,editable:!1,length:50,type:a},f={name:this._rasterFieldPrefix+"ServicePixelValue",alias:"Service Pixel Value",domain:null,editable:!1,length:50,type:a},e={name:this._rasterFieldPrefix+"ServicePixelValue.Raw",alias:"Raw Service Pixel Value",domain:null,editable:!1,length:50,type:"esriFieldTypeDouble"},d=this.fields?l.clone(this.fields):[];a=d.length;d[a]=f;10.4<=this.version&&"esri.layers.ArcGISImageServiceLayer"===this.declaredClass&&(!this.rasterFunctionInfos||
!this.rasterFunctionInfos.length||this._isRasterFunctionInfoAvailable("none"))&&(a++,d[a]=e);if(this.capabilities&&-1<this.capabilities.toLowerCase().indexOf("catalog")||this.fields&&0<this.fields.length)a++,d[a]=c;!g.isDefined(this.pixelFilter)||"esriImageServiceDataTypeVector-UV"!==this.serviceDataType&&"esriImageServiceDataTypeVector-MagDir"!==this.serviceDataType||(c={name:this._rasterFieldPrefix+"Magnitude",alias:"Magnitude",domain:null,editable:!1,type:"esriFieldTypeDouble"},f={name:this._rasterFieldPrefix+
"Direction",alias:"Direction",domain:null,editable:!1,type:"esriFieldTypeDouble"},a++,d[a]=c,a++,d[a]=f);a=this._rasterAttributeTableFields;(c=this.renderingRule&&this.renderingRule.functionName)&&this._renderingRuleAttributeTable&&this._renderingRuleAttributeTable.hasOwnProperty(c)&&(a=this._renderingRuleAttributeTable[c].fields);a&&0<a.length&&(a=q.filter(a,function(a){return"esriFieldTypeOID"!==a.type&&"value"!==a.name.toLowerCase()}),a=q.map(a,function(a){var c=l.clone(a);c.name=b+a.name;return c}),
d=d.concat(a));var h=this._rasterFieldPrefix+this._renderingRuleFieldSubPrefix;10.4<=this.version&&this.rasterFunctionInfos&&q.forEach(this.rasterFunctionInfos,function(a){a&&a.name&&"none"!==a.name.toLowerCase()&&(a={name:h+a.name.replace(/ /gi,"_"),alias:a.name,domain:null,editable:!1,type:"esriFieldTypeDouble"},d.push(a))});return d},_prepareGetImageParameters:function(a,b,c,f){f=g.isDefined(f)?f:this._params;if(this.renderer){var e=this.getExportImageRenderingRule();f.renderingRule=e?k.toJson(e.toJson()):
null}e=a.spatialReference.wkid||k.toJson(a.spatialReference.toJson(!1));delete f._ts;l.mixin(f,{bbox:a.xmin+","+a.ymin+","+a.xmax+","+a.ymax,imageSR:e,bboxSR:e,size:b+","+c},this.disableClientCaching?{_ts:(new Date).getTime()}:{});delete f.compressionTolerance;f.format&&"LERC"===f.format.toUpperCase()&&(f.compressionTolerance=this.compressionTolerance);f.token=this._getToken()},getImageUrl:function(b,c,f,d,h){h=g.isDefined(h)?h:this._params;this._prepareGetImageParameters(b,c,f,h);b=l.clone(h);this._cleanupRequestParams(b);
c=this._url.path+"/exportImage?";f=t.addProxy(c+e.objectToQuery(l.mixin(b,{f:"image"})));var n=b.token;f.length>a.defaults.io.postLength||this.useMapImage?this._jsonRequest=u({url:c,content:l.mixin(b,{f:"json"}),callbackParamName:"callback",load:function(a,b){var c=a.href;n&&(c+=-1===c.indexOf("?")?"?token\x3d"+n:"\x26token\x3d"+n);d(t.addProxy(c))},error:this._errorHandler}):d(f)},onRenderingChange:function(){},onMosaicRuleChange:function(){},onRendererChange:function(){},setInterpolation:function(a,
b){this.interpolation=this._params.interpolation=a;b||this.refresh(!0)},setCompressionQuality:function(a,b){this.compressionQuality=this._params.compressionQuality=a;b||this.refresh(!0)},setCompressionTolerance:function(a,b){this.compressionTolerance=a;b||this.refresh(!0)},setBandIds:function(a,b){var c=!1;this.bandIds!==a&&(c=!0);this.bandIds=a;this._params.bandIds=a.join(",");if(c&&!b)this.onRenderingChange();b||this.refresh(!0)},setDefaultBandIds:function(a){this.bandIds=this._params.bandIds=null;
a||this.refresh(!0)},setDisableClientCaching:function(a){this.disableClientCaching=a},setMosaicRule:function(a,b){var c=!1;this.mosaicRule!==a&&(c=!0);this.mosaicRule=a;this._params.mosaicRule=k.toJson(a.toJson());if(c&&!b)this.onMosaicRuleChange();b||this.refresh(!0)},setRenderingRule:function(a,b){var c=!1;this.renderingRule!==a&&(c=!0);this.renderingRule=a;this._params.renderingRule=a?k.toJson(a.toJson()):null;this._useRenderingRuleAttributeTable&&this.getRenderingRuleAttributeTable({renderingRule:a});
if(c)this.onRenderingChange();this._setDefaultFilter();b||this.refresh(!0)},setImageFormat:function(a,b){this.format=this._params.format=a;this._setDefaultFilter();b||this.refresh(!0)},setInfoTemplate:function(a){this.infoTemplate=a},setDefinitionExpression:function(a,b){var c=this.mosaicRule?this.mosaicRule.toJson():{};this.mosaicRule||(this.defaultMosaicRule?c=this.defaultMosaicRule.toJson():c.method=w.METHOD_NONE);c.where=a;c=new w(c);this.setMosaicRule(c,b);return this},getDefinitionExpression:function(){return this.mosaicRule?
this.mosaicRule.where:null},setPixelFilter:function(a){this.pixelFilter=a;this._isDefaultPixelFilter=!1},getPixelData:function(a){return a?(this._useBrowserDecoding()&&(this.originalPixelData={pixelBlock:this._getPixelBlockFromCanvas(this._context,this._map.width,this._map.height),extent:this._map.extent}),this.originalPixelData):this.pixelData},getExportImageRenderingRule:function(){return this._combineRenderingRule(this._convertRendererToRenderingRule(this.renderer),this.renderingRule)},redraw:function(){this.hasDataChanged=
!1;this._setPixelData(this.originalPixelData)},getHistograms:function(){var a=new d(n._dfdCanceller);if(this.hasHistograms)a._pendingDfd=u({url:this._url.path+"/histograms",content:{f:"json"},handleAs:"json",callbackParamName:"callback"}),a._pendingDfd.then(function(b){a.callback(b)},function(b){a.errback(b)});else{var b=Error("Layer does not have histograms.");b.log=!!m.isDebug;a.errback(b)}return a},computeHistograms:function(a){var b=new d(n._dfdCanceller);if(10.1<=this.currentVersion){a=a||{};
var c=a.geometry||this.fullExtent,f=(a.geometry||this.fullExtent).toJson(),c="extent"===c.type?"esriGeometryEnvelope":"esriGeometryPolygon",e=a.renderingRule||this.renderingRule||this.defaultRenderingRule,e=e?e.toJson():null,g=a.mosaicRule||this.mosaicRule||this.defaultMosaicRule,g=g?g.toJson():null;a=a.pixelSize||{x:this.pixelSizeX,y:this.pixelSizeY};b._pendingDfd=u({url:this._url.path+"/computeHistograms",content:l.mixin({f:"json",geometry:JSON.stringify(f),geometryType:c,renderingRule:JSON.stringify(e),
mosaicRule:JSON.stringify(g),pixelSize:JSON.stringify(a),callbackParamName:"callback"}),handleAs:"json"});b._pendingDfd.then(function(a){b.callback(a)},function(a){b.errback(a)})}else f=Error("Layer doesn't support computeHistograms."),f.log=!!m.isDebug,b.errback(f);return b},getRenderingRuleServiceInfo:function(a){var b=new n._fixDfd(new d(n._dfdCanceller));if(!a)return b.errback(Error("Rendering rule is not specified")),b;var c=a&&a.functionName&&!a.functionArguments?a.functionName:null;return c&&
this._rasterFunctionTemplateInfos[c]?(b.resolve(this._rasterFunctionTemplateInfos[c]),b):u({url:this._url.path,content:l.mixin(l.mixin({f:"json",renderingRule:JSON.stringify(a.toJson())},this._url.query)),callbackParamName:"callback",load:l.hitch(this,function(a){var b={};q.forEach(this._rasterFunctionServiceInfoProps,function(c){b[c]=a[c]});return this._rasterFunctionTemplateInfos[c]=b}),error:this._errorHandler})},queryVisibleRasters:function(a,b,c,f){var e=this._map,g=n._fixDfd(new d(n._dfdCanceller));
this._visibleRasters=[];var h,k,m=!0,t=this.infoTemplate?this.infoTemplate.info:null,p=t?l.clone(this.infoTemplate.info.fieldInfos):null;b=b||{};if(t&&this.infoTemplate.info.mediaInfos&&this.infoTemplate.info.mediaInfos.length){var u=[];q.forEach(this.infoTemplate.info.mediaInfos,function(a){u=u.concat(a&&a.value&&a.value.fields||[])});u.length&&q.forEach(p,function(a){a&&-1<u.indexOf(a.fieldName)&&(a.visible=!0)})}if(p&&0<p.length)for(m=!1,h=0;h<p.length;h++)if((k=p[h])&&k.fieldName.toLowerCase()!==
this._rasterFieldPrefix.toLowerCase()+"servicepixelvalue"&&(k.visible||t.title&&-1<t.title.toLowerCase().indexOf(k.fieldName.toLowerCase()))){m=!0;break}var w=(k=this._removeVisualizationStretchFunction(this.renderingRule))&&k.functionName,r=[];if(10.4<=this.version){var A=!1;if(this.rasterFunctionInfos&&p){var x=this._rasterFieldPrefix+this._renderingRuleFieldSubPrefix;q.forEach(this.rasterFunctionInfos,function(a){var b=x+a.name.replace(/ /gi,"_");q.some(p,function(a){return a.visible&&a.fieldName===
b})&&(A=A||w&&w===a.name,r.push(new z({rasterFunction:a.name})))})}k&&!A&&r.push(k)}h=new N;h.geometry=a.geometry;h.returnGeometry=this._map.spatialReference.equals(this.spatialReference);h.returnCatalogItems=m;h.timeExtent=a.timeExtent;this._params.time&&this.mosaicRule?(a=l.clone(this.mosaicRule),a=this._filterOutTimeDimension(a),h.mosaicRule=a):h.mosaicRule=this.mosaicRule||null;h.renderingRule=10.4>this.version&&k||null;h.renderingRules=r||null;e&&(e=new v((e.extent.xmax-e.extent.xmin)/e.width,
(e.extent.ymax-e.extent.ymin)/e.height,e.extent.spatialReference),h.pixelSize=e);b.requestParams=h;var y=this,e=new J(this.url);(g._pendingDfd=e.execute(h)).addCallbacks(function(a){y._queryVisibleRastersHandler(a,b,c,f,g)},function(a){y._resolve([a],null,f,g,!0)});return g},_queryVisibleRastersHandler:function(a,b,c,e,d){function h(){var a=this.getCustomRasterFields(b),e=this._getDomainFields(a),h=b?b.returnDomainValues:!1,k=b&&b.rasterAttributeTableFieldPrefix,u,w,v,z,r,A,x,y,E,G;this._useRenderingRuleAttributeTable&&
this.renderingRule?(a=this._getRenderingRuleAttributeTableFeatures({renderingRule:this.renderingRule}),G=n):a=this._getRasterAttributeTableFeatures();a.then(l.hitch(this,function(a){for(u=0;u<p.length;u++){K=p[u];K.setInfoTemplate(this.infoTemplate);K._layer=this;if(n){E=n.replace(/ /gi,"").split(",");w=n;v=E;t&&t.length>=u&&(w=t[u].replace(/ /gi,", "),v=t[u].split(" "));K.attributes[this._rasterFieldPrefix+"ItemPixelValue"]=v;K.attributes[this._rasterFieldPrefix+"ServicePixelValue"]=E;m&&(K.attributes[this._rasterFieldPrefix+
"ServicePixelValue.Raw"]=m.replace(/ /gi,"").split(","));if(this.pixelFilter){var b=new B({height:1,width:1,pixelType:"F32",pixels:[],statistics:[]});q.forEach(v,function(a){b.addData({pixels:[a],statistics:{minValue:a,maxValue:a,noDataValue:null}})});this.pixelFilter({pixelBlock:b,extent:new f(0,0,0,0,this._map.spatialReference)});if("esriImageServiceDataTypeVector-UV"===this.serviceDataType||"esriImageServiceDataTypeVector-MagDir"===this.serviceDataType)K.attributes[this._rasterFieldPrefix+"Magnitude"]=
b.pixels[0][0],K.attributes[this._rasterFieldPrefix+"Direction"]=b.pixels[1][0]}q.forEach(C,function(a){K.attributes[a.name]=a.value});var D=G||w;if(a&&0<a.length&&(z=q.filter(a,function(a){if(a&&a.attributes)return a.attributes.hasOwnProperty("Value")?a.attributes.Value==D:a.attributes.VALUE==D}),0<z.length&&(r=l.clone(z[0]),k&&r))){y={};for(A in r.attributes)r.attributes.hasOwnProperty(A)&&(x=k+A,y[x]=r.attributes[A]);r.attributes=y;K.attributes=l.mixin(K.attributes,r.attributes)}}h&&e&&0<e.length&&
q.forEach(e,function(a){if(a){var b=K.attributes[a.name];g.isDefined(b)&&(b=this._getDomainValue(a.domain,b),g.isDefined(b)&&(K.attributes[a.name]=b))}},this);W.push(K);this._visibleRasters.push(K)}this._resolve([W,null,!0],null,c,d)}))}var n=a.value,m=a.value,t,p,w=0,v=0,z=this,r=this.objectIdField,A,y,C=[];e=b.requestParams.renderingRules;var E=a.processedValues,D=this.renderingRule&&k.toJson(this._removeVisualizationStretchFunction(this.renderingRule).toJson());if(e&&E&&e.length===E.length){var M=
this._rasterFieldPrefix+this._renderingRuleFieldSubPrefix;q.forEach(e,function(a,b){if(a.functionName){var c={name:M+a.functionName.replace(/ /gi,"_"),value:E[b].replace(/ /gi,"").split(",")};C.push(c);D&&D===k.toJson(a.toJson())&&(n=E[b])}})}e=this.infoTemplate&&this.infoTemplate.info&&this.infoTemplate.info.layerOptions&&this.infoTemplate.info.layerOptions.hasOwnProperty("showNoDataRecords")?this.infoTemplate.info.layerOptions.showNoDataRecords:!0;if(a.catalogItems){var F=0,N,J,L=a.catalogItems.features.length;
y=0;p=Array(L);t=Array(L);A=Array(L);for(w=0;w<L;w++)-1<a.properties.Values[w].toLowerCase().indexOf("nodata")&&y++;N=L-y;for(w=0;w<L;w++)y=!0,-1<a.properties.Values[w].toLowerCase().indexOf("nodata")?(J=N++,e||(y=!1,p.length--,t.length--,A.length--)):J=F++,y&&(p[J]=a.catalogItems.features[w],t[J]=a.properties.Values[w],A[J]=p[J].attributes[r])}this._visibleRasters=[];var K;(a=-1<n.toLowerCase().indexOf("nodata"))&&!e&&(p=[],t=[],A=[]);!n||p||a||(r="ObjectId",p=[],K=new G(new f(this.fullExtent),null,
{ObjectId:0}),p.push(K));var W=[];p?!this._map.spatialReference.equals(this.spatialReference)&&A&&0<A.length?u({url:this._url.path+"/query",content:{f:"json",objectIds:A.join(","),returnGeometry:!0,outSR:k.toJson(z._map.spatialReference.toJson()),outFields:r},handleAs:"json",callbackParamName:"callback",load:function(a){if(0===a.features.length)z._resolve([W,null,null],null,c,d);else{for(w=0;w<a.features.length;w++)for(v=0;v<p.length;v++)p[v].attributes[r]==a.features[w].attributes[r]&&(p[v].geometry=
new x(a.features[w].geometry),p[v].geometry.setSpatialReference(z._map.spatialReference));h.call(z)}},error:function(a){z._resolve([W,null,null],null,c,d)}}):h.call(this):this._resolve([W,null,null],null,c,d)},getVisibleRasters:function(){var a=this._visibleRasters,b=[],c;for(c in a)a.hasOwnProperty(c)&&b.push(a[c]);return b},_getDomainFields:function(a){if(a){var b=[];q.forEach(a,function(a){if(a.domain){var c={};c.name=a.name;c.domain=a.domain;b.push(c)}});return b}},_getDomainValue:function(a,
b){if(a&&a.codedValues){var c;q.some(a.codedValues,function(a){return a.code===b?(c=a.name,!0):!1});return c}},_requestData:function(a,b,c){this._rasterReadPromise&&this._rasterReadPromise.cancel();a=l.clone(a);var f=a._normalize(!0);this._prepareGetImageParameters(f,b,c);b=l.clone(this._params);this._cleanupRequestParams(b);b.extent=a;b.format=b.format||(10.3<=this.version?"lerc":"jpgpng");"lerc"===b.format.toLowerCase()&&!b.lercVersion&&10.5<=this.version&&(b.lercVersion=2);c=null;this._useBrowserDecoding()&&
(c=new E({ctx:this._context}));b={imageServiceParameters:b,nBands:Math.min(this.bandCount,3),pixelType:this.pixelType,decodeFunc:c?l.hitch(c,"decode"):null};this._rasterReadPromise=this.raster.read(b,this._requestDataHandler,this._requestDataErrorHandler)},_requestDataHandler:function(a){this._rasterReadPromise&&this._rasterReadPromise.isCanceled()||(this.originalPixelData=a,this.hasDataChanged=!0,this._setPixelData(a))},_setPixelData:function(a){a=this._clonePixelData(a);this.pixelFilter&&this.pixelFilter(a);
this.pixelData=a;this._rasterReadPromise&&this._rasterReadPromise.isCanceled()||(this._drawPixelData(),this._rasterReadPromise=null)},_clonePixelData:function(a){if(null===a||void 0===a)return a;var b={};a.extent&&(b.extent=l.clone(a.extent));a=a.pixelBlock;if(null===a||void 0===a)return b;b.pixelBlock=a.clone();return b},_setDefaultFilter:function(){},_getPixelBlockFromCanvas:function(a,b,c){a=a.getImageData(0,0,b,c).data;for(var f=b*c,e=0,d=0,g=new Uint8Array(f),h=new Uint8Array(f),n=new Uint8Array(f),
k=new Uint8Array(f),l=Infinity,m=Infinity,t=Infinity,p=-Infinity,q=-Infinity,u=-Infinity,w,v,z,e=0;e<f;e++)w=a[d++],v=a[d++],z=a[d++],l=l<w?l:w,p=p>w?p:w,m=m<v?m:v,q=q>v?q:v,t=t<z?t:z,u=u>z?u:z,g[e]=w,h[e]=v,n[e]=z,k[e]=a[d++]&1;return new B({width:b,height:c,pixels:[g,h,n],pixelType:"U8",mask:k,statistics:[{minValue:l,maxValue:p},{minValue:m,maxValue:q},{minValue:t,maxValue:u}]})},_useBrowserDecoding:function(){return(void 0===this.pixelFilter||null===this.pixelFilter)&&("jpeg"===this.format.toLowerCase()||
"jpg"===this.format.toLowerCase()||-1<this.format.toLowerCase().indexOf("png"))},getMultidimensionalInfo:function(){var a=this._url.path+"/multiDimensionalInfo",b=new d(n._dfdCanceller);if(this._multidimensionalInfo)return b.resolve(this._multidimensionalInfo),b;10.3<=this.version&&this.hasMultidimensions?(b._pendingDfd=u({url:a,content:{f:"json"},handleAs:"json",callbackParamName:"callback"}),b._pendingDfd.then(l.hitch(this,function(a){this._multidimensionalInfo=a.multidimensionalInfo;b.callback(a.multidimensionalInfo)}),
function(a){b.errback(a)})):(a=Error("Layer does not support multidimensional info"),a.log=!!m.isDebug,b.errback(a));return b},getDefaultMultidimensionalDefinition:function(){var a,b,c,f=[],e=new d(n._dfdCanceller),g;if(this._defaultMultidimensionalDefinition)return e.resolve(this._defaultMultidimensionalDefinition),e;e._pendingDfd=this.getMultidimensionalInfo();e._pendingDfd.then(l.hitch(this,function(d){a=d;b=a.variables[0].dimensions;for(c in b)b.hasOwnProperty(c)&&"StdTime"!==b[c].name&&(g=b[c],
f.push(new A({variableName:"",dimensionName:g.name,isSlice:!g.hasRanges,values:[this._getDefaultDimensionValue(g)]})));this._defaultMultidimensionalDefinition=f;e.callback(f)}),function(a){e.errback(a)});return e},_getDefaultDimensionValue:function(a){if(a&&a.values&&a.values.length){var b,c,f=Infinity,e,d;if(a.hasRanges)return a.values[0];if(a.name&&"stdz"===a.name.toLowerCase()){for(d=0;d<a.values.length&&(e=a.values[d],c=Math.abs(e-0),c<f&&(f=c,b=e),0!==c);d++);return b}return a.extent[0]}},_setDefaultMultidimensionalDefinition:function(a){var b,
c={};this.getDefaultMultidimensionalDefinition().then(l.hitch(this,function(f){b=f;0<b.length&&(this.mosaicRule?(c=l.clone(this.mosaicRule),c.multidimensionalDefinition=b):this.defaultMosaicRule?(c=l.clone(this.defaultMosaicRule),c.multidimensionalDefinition=b):c=new w({multidimensionalDefinition:b}),this.setMosaicRule(c,a))}))},_setDefaultRenderingRule:function(a){var b={};if(!this.renderingRule&&"esri.layers.ArcGISImageServiceVectorLayer"!==this.declaredClass&&!this.bandIds&&this.rasterFunctionInfos&&
this.rasterFunctionInfos.length&&"none"!==this.rasterFunctionInfos[0].name.toLowerCase())b.rasterFunction=this.rasterFunctionInfos[0].name;else if(!this.renderingRule&&"esri.layers.ArcGISImageServiceVectorLayer"===this.declaredClass&&10.3<this.version){var c="esriImageServiceDataTypeVector-UV"===this.serviceDataType?7:10;b.rasterFunction="Resample";b.rasterFunctionArguments={ResamplingType:c,InputCellSize:{x:this.pixelSizeX,y:this.pixelSizeY}}}b.hasOwnProperty("rasterFunction")&&(this.defaultRenderingRule=
new z(b),this.setRenderingRule(this.defaultRenderingRule,a))},_cleanupRequestParams:function(a){if(!a)return a;if(a.time&&a.mosaicRule){var b=new w(k.fromJson(a.mosaicRule)),b=this._filterOutTimeDimension(b);a.mosaicRule=k.toJson(b.toJson())}var b="displayOnPan drawMode styling id opacity visible resourceInfo useMapDimensionValue extent renderer".split(" "),c;for(c in b)a.hasOwnProperty(b[c])&&delete a[b[c]];return a},_filterOutTimeDimension:function(a){if(a&&a.multidimensionalDefinition&&0<a.multidimensionalDefinition.length){var b=
q.filter(a.multidimensionalDefinition,function(a){return"StdTime"!==a.dimensionName});a.multidimensionalDefinition=b}return a},_removeVisualizationStretchFunction:function(a){var b=a&&a.functionName;if(!b||"stretch"!==b.toLowerCase())return a;var c=a.functionArguments.Raster;return c&&c.functionName&&q.some(this.rasterFunctionInfos,function(a){return c.functionName===a.name})?c:a},_isScientificData:function(){return"esriImageServiceDataTypeVector-UV"===this.serviceDataType||"esriImageServiceDataTypeVector-MagDir"===
this.serviceDataType||"esriImageServiceDataTypeScientific"===this.serviceDataType},_isVectorData:function(){return"esriImageServiceDataTypeVector-UV"===this.serviceDataType||"esriImageServiceDataTypeVector-MagDir"===this.serviceDataType},_isRasterFunctionInfoAvailable:function(a){return q.some(a&&(this.rasterFunctionInfos||[]),function(b){return b&&b.name&&b.name.toLowerCase()===a.toLowerCase()})},_createPixelData:function(a){a=new B({width:2,height:2,pixels:a,pixelType:this.pixelType,statistics:a});
var b=this.fullExtent.getCenter(),b=new f(b.x,b.y,b.x+this.pixelSizeX,b.y+this.pixelSizeY,this.spatialReference);return{pixelBlock:a,extent:b}},_convertRendererToRenderingRule:function(a){var b=a&&a.declaredClass;if(!b||"esri.renderer.UniqueValueRenderer"!==b&&"esri.renderer.ClassBreaksRenderer"!==b&&"esri.renderer.StretchRenderer"!==b)return null;var c=null;"esri.renderer.StretchRenderer"===b?c=a.toRenderingRule():"esri.renderer.ClassBreaksRenderer"===b?c=this._convertClassifyRenderer(a):"esri.renderer.UniqueValueRenderer"===
b&&(c=this._convertUniqueValueRenderer(a));return c},_getValueField:function(a){if(a&&a.length){var b,c;q.some(a,function(a){if((c=a.name)&&"value"===c.toLowerCase())return b=c,!0});return b}},_convertClassifyRenderer:function(a){var b,c=[],f=[],e=[],d;b=this.renderingRule&&this.renderingRule.functionName;var g,h,n=this.hasRasterAttributeTable,k;b&&(n=this._rasterFunctionTemplateInfos[b]?this._rasterFunctionTemplateInfos[b].hasRasterAttributeTable:this.hasRasterAttributeTable,h=this._renderingRuleAttributeTable[b]);
g=h&&h.features?h.features:this._rasterAttributeTableFeatures;k=this._getValueField(h&&h.fields?h.fields:this._rasterAttributeTableFields);n&&g?(q.forEach(a.infos,function(b,c){var f,d=b.symbol.color;d.a&&q.forEach(g,function(g){f=g.attributes[a.attributeField];(f>=b.minValue&&f<b.maxValue||c===a.infos.length-1&&f>=b.minValue)&&e.push([g.attributes[k],d.r,d.g,d.b])},this)},this),b=new z,b.functionName="Colormap",b.functionArguments={},b.functionArguments.Colormap=e,b.variableName="Raster"):(q.forEach(a.infos,
function(a,b){d=a.symbol&&a.symbol.color;d.a&&(c.push.call(c,a.minValue,a.maxValue),f.push(b),e.push([b,d.r,d.g,d.b]))}),b=new z,b.functionName="Remap",b.functionArguments={InputRanges:c,OutputValues:f},b.variableName="Raster",h=new z,h.functionName="Colormap",h.functionArguments={Colormap:e,Raster:b},b=h);return b},_convertUniqueValueRenderer:function(a){var b=[],c=this.renderingRule&&this.renderingRule.functionName,f,e,d;c&&(e=this._renderingRuleAttributeTable[c]);f=e&&e.features?e.features:this._rasterAttributeTableFeatures;
d=this._getValueField(e&&e.fields?e.fields:this._rasterAttributeTableFields);q.forEach(a.infos,function(c){var e=c.symbol.color;e.a&&(a.attributeField!==d&&f?q.forEach(f,function(f){f.attributes[a.attributeField]==c.value&&b.push([f.attributes[d],e.r,e.g,e.b])},this):b.push([c.value,e.r,e.g,e.b]))},this);c=new z;c.functionName="Colormap";c.functionArguments={};c.functionArguments.Colormap=b;c.variableName="Raster";return c},_combineRenderingRule:function(a,b){if(!a||!b)return a||b;var c=function(a){var b=
a.Raster;return b=b&&"esri.layers.RasterFunction"===b.declaredClass?c(b.functionArguments):a},f=l.clone(a);c(f.functionArguments).Raster=b;return f},_resolve:function(a,b,c,f,e){b&&this[b].apply(this,a);c&&c.apply(null,a);f&&n._resDfd(f,a,e)},_toggleTime:function(){var a=this._map;this.timeInfo&&this.useMapTime&&a&&!this.suspended?(this._timeConnect||(this._timeConnect=p.connect(a,"onTimeExtentChange",this,this._onTimeExtentChangeHandler)),this._setTime(a.timeExtent)):(p.disconnect(this._timeConnect),
this._timeConnect=null,this._setTime(null))},setUseMapTime:function(a,b){this.useMapTime=a;this._toggleTime();!b&&this._map&&this.refresh(!0)},_setTime:function(a){this._params&&(this._params.time=a?a.toJson().join(","):null)},_onTimeExtentChangeHandler:function(a){this.suspended||(this._setTime(a),this.refresh(!0))},handleSpatialReferenceChange:function(){this.onSpatialReferenceChange()}})})},"esri/layers/MosaicRule":function(){define("dojo/_base/declare dojo/_base/lang dojo/has ../kernel ../lang ../geometry/Point".split(" "),
function(r,l,d,q,k,m){var p=r(null,{declaredClass:"esri.layers.MosaicRule",method:null,where:null,sortField:null,sortValue:null,ascending:!1,lockRasterIds:null,viewpoint:null,objectIds:null,operation:null,multidimensionalDefinition:[],constructor:function(d){l.isObject(d)&&(l.mixin(this,d),d.mosaicMethod&&(this.method=d.mosaicMethod),this.method&&"esri"!==this.method.toLowerCase().substring(0,4)&&(this.method=this._getMethodEnum(this.method)),d.mosaicOperation&&(this.operation=d.mosaicOperation),
this.operation&&"MT_"!==this.operation.toUpperCase().substring(0,3)&&(this.operation=this._getOperatorEnum(this.operation)),d.fids&&(this.objectIds=d.fids),d.viewpoint&&(this.viewpoint=new m(d.viewpoint)),this.multidimensionalDefinition=d.multidimensionalDefinition||[])},toJson:function(){var d=null,e=this.multidimensionalDefinition?this.multidimensionalDefinition.length:0;if(e)for(var d=[],c=0;c<e;c++)d.push("esri.layers.DimensionalDefinition"===this.multidimensionalDefinition[c].declaredClass?this.multidimensionalDefinition[c].toJson():
this.multidimensionalDefinition[c]);d={mosaicMethod:this.method,where:this.where,sortField:this.sortField,sortValue:this.sortValue,ascending:this.ascending,lockRasterIds:this.lockRasterIds,viewpoint:this.viewpoint?this.viewpoint.toJson():null,fids:this.objectIds,mosaicOperation:this.operation,multidimensionalDefinition:d};return k.filter(d,function(b){if(null!==b)return!0})},_getMethodEnum:function(d){if(d){var e=p.METHOD_NONE;switch(d.toLowerCase()){case "byattribute":e=p.METHOD_ATTRIBUTE;break;
case "center":e=p.METHOD_CENTER;break;case "lockraster":e=p.METHOD_LOCKRASTER;break;case "nadir":e=p.METHOD_NADIR;break;case "northwest":e=p.METHOD_NORTHWEST;break;case "seamline":e=p.METHOD_SEAMLINE;break;case "viewpoint":e=p.METHOD_VIEWPOINT}return e}},_getOperatorEnum:function(d){if(d)switch(d.toLowerCase()){case "first":return p.OPERATION_FIRST;case "last":return p.OPERATION_LAST;case "max":return p.OPERATION_MAX;case "min":return p.OPERATION_MIN;case "blend":return p.OPERATION_BLEND;case "mean":return p.OPERATION_MEAN;
case "sum":return p.OPERATION_SUM}}});l.mixin(p,{METHOD_NONE:"esriMosaicNone",METHOD_CENTER:"esriMosaicCenter",METHOD_NADIR:"esriMosaicNadir",METHOD_VIEWPOINT:"esriMosaicViewpoint",METHOD_ATTRIBUTE:"esriMosaicAttribute",METHOD_LOCKRASTER:"esriMosaicLockRaster",METHOD_NORTHWEST:"esriMosaicNorthwest",METHOD_SEAMLINE:"esriMosaicSeamline",OPERATION_FIRST:"MT_FIRST",OPERATION_LAST:"MT_LAST",OPERATION_MIN:"MT_MIN",OPERATION_MAX:"MT_MAX",OPERATION_MEAN:"MT_MEAN",OPERATION_BLEND:"MT_BLEND",OPERATION_SUM:"MT_SUM"});
return p})},"esri/layers/DimensionalDefinition":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/has","../kernel","../lang"],function(r,l,d,q,k){return r(null,{declaredClass:"esri.layers.DimensionalDefinition",variableName:null,dimensionName:null,values:[],isSlice:!1,constructor:function(d){l.isObject(d)&&l.mixin(this,d)},toJson:function(){return k.filter({variableName:this.variableName,dimensionName:this.dimensionName,values:this.values,isSlice:this.isSlice},function(d){return null!==
d})}})})},"esri/layers/Raster":function(){define("require dojo/_base/declare dojo/_base/lang dojo/_base/Deferred dojo/_base/array dojo/_base/config dojo/json dojo/sniff ../kernel ../Evented ../request ../geometry/Extent ../SpatialReference ../deferredUtils ./PixelBlock ./rasterFormats/LercCodec ./rasterFormats/Lerc2Codec".split(" "),function(r,l,d,q,k,m,p,h,e,c,b,a,g,u,n,t,f){var v,x,w,z,A,y,B=null,C=null,E=function(a){if("U1"===a||"U2"===a||"U4"===a||"U8"===a)return C=Math.pow(2,8)-1,B=Uint8Array,
"U8";"U16"===a?(C=C||Math.pow(2,16)-1,B=Uint16Array):"U32"===a?(C=C||Math.pow(2,32)-1,B=Uint32Array):"S8"===a?(C=C||0-Math.pow(2,7),B=Int8Array):"S16"===a?(C=C||0-Math.pow(2,15),B=Int16Array):"S32"===a?(C=C||0-Math.pow(2,31),B=Int32Array):B=Float32Array;return a},D=function(a,b){return a.height!==b.height||a.width!==b.width?!1:!0};return l(c,{declaredClass:"esri.layers.Raster",imageServiceUrl:null,validPixelTypes:"U1 U2 U4 U8 U16 U32 S8 S16 S32 F32".split(" "),validFormats:"lerc jpeg jpg jpgpng png png8 png24 png32 bip bsq tiff".split(" "),
_eventMap:{"raster-read-complete":["pixelData","params"]},constructor:function(a){this.imageServiceUrl=a;this.registerConnectEvents();this._loadRasterFormatModules()},read:function(a,c,f){var e=this,g=new q(u._dfdCanceller);if(10>h("ie"))throw"This browser is not supported.";if(!a.imageServiceParameters)throw"Insufficient parameters to read data";var n=d.clone(a.imageServiceParameters),l=a.pixelType;k.some(this.validPixelTypes,function(a){return a===l})||(n.pixelType="F32");k.some(this.validFormats,
function(a){return a.toLowerCase()===n.format.toLowerCase()})||(n.format="lerc");var m=a.decodeFunc,t;this._prepareGetImageParameters(n);var p=n.width,w=n.height,v=n.extent;delete n.width;delete n.height;delete n.extent;g._pendingDfd=b({url:this.imageServiceUrl+"/exportImage",handleAs:"arraybuffer",content:d.mixin(n,{f:"image"}),load:function(a){e.decode(a,{width:p,height:w,planes:null,pixelType:l,noDataValue:n.noData,format:n.format,decodeFunc:m}).then(function(a){t={pixelBlock:a,extent:v};e._resolve([t,
n],"onRasterReadComplete",c,g)},function(a){e._resolve([a],null,f,g,!0)})},error:function(a){e._resolve([a],null,f,g,!0)}});return g.promise},decode:function(a,b){if(void 0===b||null===b)throw"missing decode options";var c,f;b.format&&(c=b.format.toUpperCase());"BSQ"!==c&&"BIP"!==c&&(c=this._getFormat(a));f=b.decodeFunc;if(void 0===f||null===f)f=this._getFormatDecoderDfd(c);return f(a,b)},onRasterReadComplete:function(){},_prepareGetImageParameters:function(b){if(b.size&&b.bbox){var c=b.size.split(",");
b.width=parseFloat(c[0]);b.height=parseFloat(c[1]);b.extent||(c=b.bbox.split(","),b.extent=new a(parseFloat(c[0]),parseFloat(c[1]),parseFloat(c[2]),parseFloat(c[3]),new g(b.bboxSR)))}else{if(!b.width||Math.floor(b.width)!==b.width||!b.height||Math.floor(b.height)!==b.height)throw"Incorrect Image Dimensions";if(!b.extent||"esri.geometry.Extent"!==b.extent.declaredClass)throw"Incorrect extent";var c=b.extent,f=c.spatialReference.wkid||p.toJson(c.spatialReference.toJson());delete b._ts;d.mixin(b,{bbox:c.xmin+
","+c.ymin+","+c.xmax+","+c.ymax,imageSR:f,bboxSR:f,size:b.width+","+b.height},b.disableClientCaching?{_ts:(new Date).getTime()}:{})}},_adjustExtent:function(a,b,c){var f=a.ymax-a.ymin,e=a.xmax-a.xmin;c>=b?a.ymax=a.ymin+e*b/c:a.xmax=a.xmin+f*c/b;return a},_resolve:function(a,b,c,f,e){b&&this[b].apply(this,a);c&&c.apply(null,a);f&&u._resDfd(f,a,e)},_getFormatDecoderDfd:function(a){var b=null;switch(a){case "LERC":b=this._decodeLerc;break;case "LERC2":b=this._decodeLerc2;break;case "JPEG":b=this._decodeJpeg;
break;case "PNG":b=this._decodePng;break;case "BSQ":b=this._decodeBsq;break;case "BIP":b=this._decodeBip;break;case "TIFF":b=this._decodeTiff;break;default:b=function(a,b){throw"The raster format is not supported";}}b=d.hitch(this,b);return function(c,f){var e=new q;try{var d;"LERC"===a||!0===A?(d=b(c,f),e.resolve(d)):y.then(function(){d=b(c,f);e.resolve(d)})}catch(K){e.reject(K)}return e}},_getFormat:function(a){a=new Uint8Array(a,0,10);var b="";if(255===a[0]&&216===a[1])b="JPEG";else if(137===a[0]&&
80===a[1]&&78===a[2]&&71===a[3])b="PNG";else if(67===a[0]&&110===a[1]&&116===a[2]&&90===a[3]&&73===a[4]&&109===a[5]&&97===a[6]&&103===a[7]&&101===a[8]&&32===a[9])b="LERC";else if(76===a[0]&&101===a[1]&&114===a[2]&&99===a[3]&&50===a[4]&&32===a[5])b="LERC2";else if(-1<String.fromCharCode.apply(null,a).toLowerCase().indexOf("error"))b="ERROR";else if(73===a[0]&&73===a[1]&&42===a[2]&&0===a[3]||77===a[0]&&77===a[1]&&0===a[2]&&42===a[3])b="TIFF";return b},_validateDecodeParams:function(a){if(!a.height||
Math.floor(a.height)!==a.height)throw"Height not provided.";if(!a.width||Math.floor(a.width)!==a.width)throw"Width not provided.";},_decodeJpeg:function(a,b){if(!v)throw"The jpeg decoder module is not loaded.";this._validateDecodeParams(b);var c=(new v).decode(a);if(!D(c,b))throw"The decoded image dimensions are incorrect.";var f=[],e,d;for(e=0;e<c.pixels.length;e++)d=c.pixels[e],f.push(this._calculateBandStatistics(d));return new n({width:c.width,height:c.height,pixels:c.pixels,pixelType:"U8",mask:c.mask,
statistics:f})},_decodePng:function(a,b){if(!x)throw"The png decoder module is not loaded.";this._validateDecodeParams(b);var c=new Uint8Array(a),f=new x(c),c=new Uint8Array(b.width*b.height*4);f.copyToImageData(c,f.decodePixels());for(var e=f=0,d,e=new Uint8Array(b.width*b.height),f=0;f<b.width*b.height;f++)e[f]=c[4*f+3];for(var g=new n({width:b.width,height:b.height,pixels:[],pixelType:"U8",mask:e,statistics:[]}),f=0;3>f;f++){d=new Uint8Array(b.width*b.height);for(e=0;e<b.width*b.height;e++)d[e]=
c[4*e+f];g.addData({pixels:d,statistics:this._calculateBandStatistics(d)})}return g},_decodeBsq:function(a,b){if(!w)throw"The bsq decoder module is not loaded.";this._validateDecodeParams(b);C=b.noDataValue;b.pixelType=E(b.pixelType);var c=w.decodeBSQ(a,{bandCount:b.planes,width:b.width,height:b.height,pixelType:B,noDataValue:C}),f=[],e,d=null;for(e=0;e<c.pixels.length;e++)d=c.pixels[e],f.push(this._calculateBandStatistics(d));return new n({width:b.width,height:b.height,pixels:c.pixels,pixelType:b.pixelType,
mask:c.maskData,statistics:f})},_decodeBip:function(a,b){this._validateDecodeParams(b);C=b.noDataValue;b.pixelType=E(b.pixelType);var c=w.decodeBIP(a,{bandCount:b.planes,width:b.width,height:b.height,pixelType:B,noDataValue:C}),f=[],e,d=null;for(e=0;e<c.pixels.length;e++)d=c.pixels[e],f.push(this._calculateBandStatistics(d));return new n({width:b.width,height:b.height,pixels:c.pixels,pixelType:b.pixelType,mask:c.maskData,statistics:f})},_decodeTiff:function(a,b){this._validateDecodeParams(b);C=b.noDataValue;
b.pixelType=E(b.pixelType);var c=z.decode(a),f=[],e,d=null;for(e=0;e<c.pixels.length;e++)d=c.pixels[e],f.push(this._calculateBandStatistics(d,c.maskData));return new n({width:c.width,height:c.height,pixels:c.pixels,pixelType:c.pixelType,mask:c.maskData,statistics:f})},_decodeLerc:function(a,b){this._validateDecodeParams(b);C=b.noDataValue;b.pixelType=E(b.pixelType);for(var c=0,f,e=0,d,g=a.byteLength-10;e<g;){var h=t.decode(a,{inputOffset:e,encodedMaskData:f,returnMask:0===c?!0:!1,returnEncodedMask:0===
c?!0:!1,returnFileInfo:!0,pixelType:B,noDataValue:C}),e=h.fileInfo.eofOffset;0===c&&(f=h.encodedMaskData,d=new n({width:b.width,height:b.height,pixels:[],pixelType:b.pixelType,mask:h.maskData,statistics:[]}));c++;if(!D(h,b))throw"The decoded image dimensions are incorrect";d.addData({pixels:h.pixelData,statistics:{minValue:h.minValue,maxValue:h.maxValue,noDataValue:h.noDataValue}})}return d},_decodeLerc2:function(a,b){this._validateDecodeParams(b);C=b.noDataValue;b.pixelType=E(b.pixelType);for(var c=
0,e,d,g=0,h,k=a.byteLength-10;g<k;){d=f.decode(a,{inputOffset:g,maskData:e,returnFileInfo:!0});g=d.fileInfo.eofOffset;0===c&&(e=d.maskData,h=new n({width:b.width,height:b.height,pixels:[],pixelType:d.fileInfo.pixelType,mask:d.maskData,statistics:[]}));c++;if(!D(d,b))throw"The decoded image dimensions are incorrect";h.addData({pixels:d.pixelData,statistics:{minValue:d.minValue,maxValue:d.maxValue,noDataValue:d.noDataValue}})}return h},_calculateBandStatistics:function(a,b){var c=Infinity,f=-Infinity,
e=a.length,d,g=0;if(b)for(d=0;d<e;d++)b[d]&&(g=a[d],c=g<c?g:c,f=g>f?g:f);else for(d=0;d<e;d++)g=a[d],c=g<c?g:c,f=g>f?g:f;return{minValue:c,maxValue:f}},_loadRasterFormatModules:function(){A||(y||(y=new q),10>h("ie")?y.isRejected()||y.reject("unsupported browser version"):r(["./rasterFormats/JpgPlus","./rasterFormats/Png","./rasterFormats/Raw","./rasterFormats/TiffDecoder","./rasterFormats/Zlib"],function(a,b,c,f){v=a;x=b;w=c;z=f;A=!0;y.isResolved()||y.resolve(!0)}))}})})},"esri/layers/PixelBlock":function(){define(["dojo/_base/declare",
"dojo/_base/lang","dojo/has","../kernel"],function(r,l,d,q){return r([],{declaredClass:"esri.layers.PixelBlock",planes:null,width:null,height:null,pixelType:null,pixels:[],statistics:[],constructor:function(d){if(d){if(!d.width||Math.floor(d.width)!==d.width)throw"PixelBlock: incorrect width";if(!d.height||Math.floor(d.height)!==d.height)throw"PixelBlock: incorrect height";if(!d.pixels||!d.statistics)throw"PixelBlock: pixel data or statistics not present";this.width=d.width;this.height=d.height;this.pixels=
d.pixels;this.pixelType=d.pixelType||null;this.statistics=d.statistics;this.mask=d.mask||null}},getPlaneCount:function(){return this.pixels.length!==this.statistics.length?console.error("Inconsistent pixel data and statistics"):this.statistics.length},addData:function(d){if(!d.pixels||!d.statistics)throw"Pixel data or statistics are not present";if(d.pixels.length!==this.width*this.height)throw"Inconsistent pixel data size";this.statistics.push(d.statistics);this.pixels.push(d.pixels)},getAsRGBA:function(){var d=
new ArrayBuffer(this.width*this.height*4);switch(this.pixelType){case "S8":case "S16":case "U16":case "S32":case "U32":case "F32":case "F64":this._fillFromNon8Bit(d);break;default:this._fillFrom8Bit(d)}return new Uint8ClampedArray(d)},getAsRGBAFloat:function(){var d=new Float32Array(this.width*this.height*4);this._fillFrom32Bit(d);return d},clone:function(){var d=new this.constructor;d.width=this.width;d.height=this.height;d.pixelType=this.pixelType;this.mask&&(d.mask=new Uint8Array(this.mask));var m,
p;if(this.pixels)for(d.pixels=[],p=this.pixels.length,m=0;m<p;m++)d.pixels[m]=new Float32Array(this.pixels[m]);if(this.statistics)for(d.statistics=[],p=this.statistics.length,m=0;m<p;m++)d.statistics[m]=l.clone(this.statistics[m]);return d},_fillFrom8Bit:function(d){var k=this.pixels,l=this.mask;if(!d||!k||!k.length)return console.error("Unable to convert to RGBA. The input pixel block is empty.");var h,e,c;h=e=c=k[0];3<=k.length&&(e=k[1],c=k[2]);var k=new Uint32Array(d),b=this.width*this.height;
if(h.length!==b)return console.error("Unable to convert to RGBA. The pixelblock is invalid.");if(l&&l.length===b)for(d=0;d<b;d++)l[d]&&(k[d]=-16777216|c[d]<<16|e[d]<<8|h[d]);else for(d=0;d<b;d++)k[d]=-16777216|c[d]<<16|e[d]<<8|h[d]},_fillFromNon8Bit:function(d){var k=this.pixels,l=this.mask,h=this.statistics;if(!d||!k||!k.length)return console.error("Unable to convert to RGBA. The input pixel block is empty.");var e=1,c=0;h&&0<h.length?(c=h[0].minValue,e=255/(h[0].maxValue-h[0].minValue)):(e=255,
"S8"===this.pixelType?(c=-128,e=127):"U16"===this.pixelType?e=65535:"S16"===this.pixelType?(c=-32768,e=32767):"U32"===this.pixelType?e=4294967295:"S32"===this.pixelType?(c=-2147483648,e=2147483647):"F32"===this.pixelType?(c=-3.4*1E39,e=3.4*1E39):"F64"===this.pixelType&&(c=-Number.MAX_VALUE,e=Number.MAX_VALUE),e=255/(e-c));d=new Uint32Array(d);var h=this.width*this.height,b,a,g;b=k[0];if(b.length!==h)return console.error("Unable to convert to RGBA. The pixelblock is invalid.");if(3<=k.length)if(a=
k[1],g=k[2],l&&l.length===h)for(k=0;k<h;k++)l[k]&&(d[k]=-16777216|(g[k]-c)*e<<16|(a[k]-c)*e<<8|(b[k]-c)*e);else for(k=0;k<h;k++)d[k]=-16777216|(g[k]-c)*e<<16|(a[k]-c)*e<<8|(b[k]-c)*e;else if(l&&l.length===h)for(k=0;k<h;k++)a=(b[k]-c)*e,l[k]&&(d[k]=-16777216|a<<16|a<<8|a);else for(k=0;k<h;k++)a=(b[k]-c)*e,d[k]=-16777216|a<<16|a<<8|a},_fillFrom32Bit:function(d){var k=this.pixels,l=this.mask;if(!d||!k||!k.length)return console.error("Unable to convert to RGBA. The input pixel block is empty.");var h,
e,c;h=e=c=k[0];3<=k.length&&(e=k[1],c=k[2]);var b=this.width*this.height;if(h.length!==b)return console.error("Unable to convert to RGBA. The pixelblock is invalid.");var a=0;if(l&&l.length===b)for(k=0;k<b;k++)d[a++]=h[k],d[a++]=e[k],d[a++]=c[k],d[a++]=l[k];else for(k=0;k<b;k++)d[a++]=h[k],d[a++]=e[k],d[a++]=c[k],d[a++]=255}})})},"esri/layers/rasterFormats/LercCodec":function(){define([],function(){var r={defaultNoDataValue:-3.4027999387901484E38,decode:function(d,q){var k;q=q||{};var m=q.inputOffset||
0,p=q.encodedMaskData||null===q.encodedMaskData,h={},e=new Uint8Array(d,m,10);h.fileIdentifierString=String.fromCharCode.apply(null,e);if("CntZImage"!=h.fileIdentifierString.trim())throw"Unexpected file identifier string: "+h.fileIdentifierString;m+=10;e=new DataView(d,m,24);h.fileVersion=e.getInt32(0,!0);h.imageType=e.getInt32(4,!0);h.height=e.getUint32(8,!0);h.width=e.getUint32(12,!0);h.maxZError=e.getFloat64(16,!0);m+=24;if(!p)if(e=new DataView(d,m,16),h.mask={},h.mask.numBlocksY=e.getUint32(0,
!0),h.mask.numBlocksX=e.getUint32(4,!0),h.mask.numBytes=e.getUint32(8,!0),h.mask.maxValue=e.getFloat32(12,!0),m+=16,0<h.mask.numBytes){var p=new Uint8Array(Math.ceil(h.width*h.height/8)),e=new DataView(d,m,h.mask.numBytes),c=e.getInt16(0,!0),b=2,a=0;do{if(0<c)for(;c--;)p[a++]=e.getUint8(b++);else for(var g=e.getUint8(b++),c=-c;c--;)p[a++]=g;c=e.getInt16(b,!0);b+=2}while(b<h.mask.numBytes);if(-32768!==c||a<p.length)throw"Unexpected end of mask RLE encoding";h.mask.bitset=p;m+=h.mask.numBytes}else 0===
(h.mask.numBytes|h.mask.numBlocksY|h.mask.maxValue)&&(p=new Uint8Array(Math.ceil(h.width*h.height/8)),h.mask.bitset=p);e=new DataView(d,m,16);h.pixels={};h.pixels.numBlocksY=e.getUint32(0,!0);h.pixels.numBlocksX=e.getUint32(4,!0);h.pixels.numBytes=e.getUint32(8,!0);h.pixels.maxValue=e.getFloat32(12,!0);m+=16;p=h.pixels.numBlocksX;e=h.pixels.numBlocksY;p+=0<h.width%p?1:0;c=e+(0<h.height%e?1:0);h.pixels.blocks=Array(p*c);for(a=b=0;a<c;a++)for(g=0;g<p;g++){var u=0,e=new DataView(d,m,Math.min(10,d.byteLength-
m)),n={};h.pixels.blocks[b++]=n;var t=e.getUint8(0);u++;n.encoding=t&63;if(3<n.encoding)throw"Invalid block encoding ("+n.encoding+")";if(2===n.encoding)m++;else{if(0!==t&&2!==t){t>>=6;n.offsetType=t;if(2===t)n.offset=e.getInt8(1),u++;else if(1===t)n.offset=e.getInt16(1,!0),u+=2;else if(0===t)n.offset=e.getFloat32(1,!0),u+=4;else throw"Invalid block offset type";if(1===n.encoding)if(t=e.getUint8(u),u++,n.bitsPerPixel=t&63,t>>=6,n.numValidPixelsType=t,2===t)n.numValidPixels=e.getUint8(u),u++;else if(1===
t)n.numValidPixels=e.getUint16(u,!0),u+=2;else if(0===t)n.numValidPixels=e.getUint32(u,!0),u+=4;else throw"Invalid valid pixel count type";}m+=u;if(3!=n.encoding)if(0===n.encoding){t=(h.pixels.numBytes-1)/4;if(t!==Math.floor(t))throw"uncompressed block has invalid length";e=new ArrayBuffer(4*t);u=new Uint8Array(e);u.set(new Uint8Array(d,m,4*t));e=new Float32Array(e);n.rawData=e;m+=4*t}else 1===n.encoding&&(t=Math.ceil(n.numValidPixels*n.bitsPerPixel/8),e=new ArrayBuffer(4*Math.ceil(t/4)),u=new Uint8Array(e),
u.set(new Uint8Array(d,m,t)),n.stuffedData=new Uint32Array(e),m+=t)}}h.eofOffset=m;var m=null!=q.noDataValue?q.noDataValue:r.defaultNoDataValue,c=q.encodedMaskData,f=q.returnMask,b=0,a=h.pixels.numBlocksX,g=h.pixels.numBlocksY,n=Math.floor(h.width/a),u=Math.floor(h.height/g),t=2*h.maxZError,e=Number.MAX_VALUE,v,c=c||(h.mask?h.mask.bitset:null),x,p=new (q.pixelType||Float32Array)(h.width*h.height);f&&c&&(x=new Uint8Array(h.width*h.height));for(var f=new Float32Array(n*u),w,z,A=0;A<=g;A++){var y=A!==
g?u:h.height%g;if(0!==y)for(var B=0;B<=a;B++){var C=B!==a?n:h.width%a;if(0!==C){var E=A*h.width*u+B*n,D=h.width-C,F=h.pixels.blocks[b],G,J;if(2>F.encoding){if(0===F.encoding)G=F.rawData;else{G=F.stuffedData;J=F.bitsPerPixel;v=F.numValidPixels;w=F.offset;z=t;var N=f,M=h.pixels.maxValue,L=(1<<J)-1,K=0,W=void 0,R=0,ba=void 0,O=void 0,Q=Math.ceil((M-w)/z);G[G.length-1]<<=8*(4*G.length-Math.ceil(J*v/8));for(W=0;W<v;W++)0===R&&(O=G[K++],R=32),R>=J?(ba=O>>>R-J&L,R-=J):(R=J-R,ba=(O&L)<<R&L,O=G[K++],R=32-
R,ba+=O>>>R),N[W]=ba<Q?w+ba*z:M;G=f}J=0}else k=2===F.encoding?0:F.offset;var U;if(c)for(z=0;z<y;z++){E&7&&(U=c[E>>3],U<<=E&7);for(w=0;w<C;w++)E&7||(U=c[E>>3]),U&128?(x&&(x[E]=1),v=2>F.encoding?G[J++]:k,e=e>v?v:e,p[E++]=v):(x&&(x[E]=0),p[E++]=m),U<<=1;E+=D}else if(2>F.encoding)for(z=0;z<y;z++){for(w=0;w<C;w++)v=G[J++],e=e>v?v:e,p[E++]=v;E+=D}else for(e=e>k?k:e,z=0;z<y;z++){for(w=0;w<C;w++)p[E++]=k;E+=D}if(1===F.encoding&&J!==F.numValidPixels)throw"Block and Mask do not match";b++}}}k=x;x={width:h.width,
height:h.height,pixelData:p,minValue:e,maxValue:h.pixels.maxValue,noDataValue:m};k&&(x.maskData=k);q.returnEncodedMask&&h.mask&&(x.encodedMaskData=h.mask.bitset?h.mask.bitset:null);if(q.returnFileInfo&&(x.fileInfo=l(h),q.computeUsedBitDepths)){k=x.fileInfo;U=h.pixels.numBlocksX*h.pixels.numBlocksY;G={};for(J=0;J<U;J++)m=h.pixels.blocks[J],0===m.encoding?G.float32=!0:1===m.encoding?G[m.bitsPerPixel]=!0:G[0]=!0;h=Object.keys(G);k.bitDepths=h}return x}},l=function(d){return{fileIdentifierString:d.fileIdentifierString,
fileVersion:d.fileVersion,imageType:d.imageType,height:d.height,width:d.width,maxZError:d.maxZError,eofOffset:d.eofOffset,mask:d.mask?{numBlocksX:d.mask.numBlocksX,numBlocksY:d.mask.numBlocksY,numBytes:d.mask.numBytes,maxValue:d.mask.maxValue}:null,pixels:{numBlocksX:d.pixels.numBlocksX,numBlocksY:d.pixels.numBlocksY,numBytes:d.pixels.numBytes,maxValue:d.pixels.maxValue,noDataValue:this.noDataValue}}};return r})},"esri/layers/rasterFormats/Lerc2Codec":function(){define([],function(){var r={unstuff:function(d,
k,l,p,h,e,c,b){var a=(1<<l)-1,g=0,m,n=0,t,f;d[d.length-1]<<=8*(4*d.length-Math.ceil(l*p/8));if(h)for(m=0;m<p;m++)0===n&&(f=d[g++],n=32),n>=l?(t=f>>>n-l&a,n-=l):(n=l-n,t=(f&a)<<n&a,f=d[g++],n=32-n,t+=f>>>n),k[m]=h[t];else for(h=Math.ceil((b-e)/c),m=0;m<p;m++)0===n&&(f=d[g++],n=32),n>=l?(t=f>>>n-l&a,n-=l):(n=l-n,t=(f&a)<<n&a,f=d[g++],n=32-n,t+=f>>>n),k[m]=t<h?e+t*c:b},unstuffLUT:function(d,k,l,p,h,e){var c=(1<<k)-1,b=0,a=0,g=0,m=g=0,n,t=[];d[d.length-1]<<=8*(4*d.length-Math.ceil(k*l/8));for(var f=Math.ceil((e-
p)/h),a=0;a<l;a++)0===g&&(n=d[b++],g=32),g>=k?(m=n>>>g-k&c,g-=k):(g=k-g,m=(n&c)<<g&c,n=d[b++],g=32-g,m+=n>>>g),t[a]=m<f?p+m*h:e;t.unshift(p);return t},unstuff2:function(d,k,l,p,h,e,c,b){var a=(1<<l)-1,g=0,m,n=0,t=0,f,q,r;if(h)for(m=0;m<p;m++)0===n&&(q=d[g++],n=32,t=0),n>=l?(f=q>>>t&a,n-=l,t+=l):(r=l-n,f=q>>>t&a,q=d[g++],n=32-r,f|=(q&(1<<r)-1)<<l-r,t=r),k[m]=h[f];else for(h=Math.ceil((b-e)/c),m=0;m<p;m++)0===n&&(q=d[g++],n=32,t=0),n>=l?(f=q>>>t&a,n-=l,t+=l):(r=l-n,f=q>>>t&a,q=d[g++],n=32-r,f|=(q&(1<<
r)-1)<<l-r,t=r),k[m]=f<h?e+f*c:b;return k},unstuffLUT2:function(d,k,l,p,h,e){for(var c=(1<<k)-1,b=0,a=0,g=0,m=0,n=0,t=0,f,q=[],r=Math.ceil((e-p)/h),a=0;a<l;a++)0===m&&(f=d[b++],m=32,t=0),m>=k?(n=f>>>t&c,m-=k,t+=k):(g=k-m,n=f>>>t&c,f=d[b++],m=32-g,n|=(f&(1<<g)-1)<<k-g,t=g),q[a]=n<r?p+n*h:e;q.unshift(p);return q},originalUnstuff:function(d,k,l,p){var h=(1<<l)-1,e=0,c,b=0,a,g;d[d.length-1]<<=8*(4*d.length-Math.ceil(l*p/8));for(c=0;c<p;c++)0===b&&(g=d[e++],b=32),b>=l?(a=g>>>b-l&h,b-=l):(b=l-b,a=(g&h)<<
b&h,g=d[e++],b=32-b,a+=g>>>b),k[c]=a;return k},originalUnstuff2:function(d,k,l,p){var h=(1<<l)-1,e=0,c,b=0,a=0,g,m,n;for(c=0;c<p;c++)0===b&&(m=d[e++],b=32,a=0),b>=l?(g=m>>>a&h,b-=l,a+=l):(n=l-b,g=m>>>a&h,m=d[e++],b=32-n,g|=(m&(1<<n)-1)<<l-n,a=n),k[c]=g;return k}},l={HUFFMAN_LUT_BITS_MAX:12,computeChecksumFletcher32:function(d){for(var k=65535,l=65535,p=d.length,h=Math.floor(p/2),e=0;h;){var c=359<=h?359:h,h=h-c;do k+=d[e++]<<8,l+=k+=d[e++];while(--c);k=(k&65535)+(k>>>16);l=(l&65535)+(l>>>16)}p&1&&
(l+=k+=d[e]<<8);return((l&65535)+(l>>>16)<<16|(k&65535)+(k>>>16))>>>0},readHeaderInfo:function(d,k){var l=k.ptr,p=new Uint8Array(d,l,6),h={};h.fileIdentifierString=String.fromCharCode.apply(null,p);if(0!==h.fileIdentifierString.lastIndexOf("Lerc2",0))throw"Unexpected file identifier string (expect Lerc2 ): "+h.fileIdentifierString;l+=6;p=new DataView(d,l,52);h.fileVersion=p.getInt32(0,!0);l+=4;3<=h.fileVersion&&(h.checksum=p.getUint32(4,!0),l+=4);p=new DataView(d,l,48);h.height=p.getUint32(0,!0);
h.width=p.getUint32(4,!0);h.numValidPixel=p.getUint32(8,!0);h.microBlockSize=p.getInt32(12,!0);h.blobSize=p.getInt32(16,!0);h.imageType=p.getInt32(20,!0);h.maxZError=p.getFloat64(24,!0);h.zMin=p.getFloat64(32,!0);h.zMax=p.getFloat64(40,!0);l+=48;k.headerInfo=h;k.ptr=l;if(3<=h.fileVersion&&(l=this.computeChecksumFletcher32(new Uint8Array(d,l-48,h.blobSize-14)),l!==h.checksum))throw"Checksum failed.";return!0},readMask:function(d,k){var l=k.ptr,p=k.headerInfo,h=p.width*p.height,e=p.numValidPixel,c=
new DataView(d,l,4),p={};p.numBytes=c.getUint32(0,!0);l+=4;if((0===e||h===e)&&0!==p.numBytes)throw"invalid mask";if(0===e)e=new Uint8Array(Math.ceil(h/8)),p.bitset=e,c=new Uint8Array(h),k.pixels.resultMask=c,l+=p.numBytes;else if(0<p.numBytes){var e=new Uint8Array(Math.ceil(h/8)),c=new DataView(d,l,p.numBytes),b=c.getInt16(0,!0),a=2,g=0,q=0;do{if(0<b)for(;b--;)e[g++]=c.getUint8(a++);else for(q=c.getUint8(a++),b=-b;b--;)e[g++]=q;b=c.getInt16(a,!0);a+=2}while(a<p.numBytes);if(-32768!==b||g<e.length)throw"Unexpected end of mask RLE encoding";
c=new Uint8Array(h);for(a=a=b=0;a<h;a++)a&7?(b=e[a>>3],b<<=a&7):b=e[a>>3],b&128&&(c[a]=1);k.pixels.resultMask=c;p.bitset=e;l+=p.numBytes}k.ptr=l;k.mask=p;return!0},readDataOneSweep:function(d,k,m){var p=k.ptr,h=k.headerInfo,e=h.width*h.height,h=h.numValidPixel*l.getDateTypeSize(h.imageType);if(m===Uint8Array)d=new Uint8Array(d,p,h);else{var c=new ArrayBuffer(h);(new Uint8Array(c)).set(new Uint8Array(d,p,h));d=new m(c)}if(d.length===e)k.pixels.resultPixels=d;else for(k.pixels.resultPixels=new m(e),
c=c=m=0;c<e;c++)k.pixels.resultMask[c]&&(k.pixels.resultPixels[c]=d[m++]);k.ptr=p+h;return!0},readHuffman:function(q,k,m){var p=k.headerInfo,h=p.width*p.height,e=this.HUFFMAN_LUT_BITS_MAX,p=new DataView(q,k.ptr,16);k.ptr+=16;if(2>p.getInt32(0,!0))throw"unsupported Huffman version";var c=p.getInt32(4,!0),b=p.getInt32(8,!0),a=p.getInt32(12,!0);if(b>=a)return!1;var g=new Uint32Array(a-b);l.decodeBits(q,k,g);for(var u=[],n,t,p=b;p<a;p++)n=p-(p<c?0:c),u[n]={first:g[p-b],second:null};p=q.byteLength-k.ptr;
g=new ArrayBuffer(4*Math.ceil(p/4));(new Uint8Array(g)).set(new Uint8Array(q,k.ptr,p));q=new Uint32Array(g);var g=0,f,v=0;f=q[0];for(p=b;p<a;p++)n=p-(p<c?0:c),t=u[n].first,0<t&&(u[n].second=f<<g>>>32-t,32-g>=t?(g+=t,32===g&&(g=0,v++,f=q[v])):(g+=t-32,v++,f=q[v],u[n].second|=f>>>32-g));for(var r=0===k.headerInfo.imageType?128:0,w=k.headerInfo.height,z=k.headerInfo.width,A=0,y=0,B=new d,p=0;p<u.length;p++)void 0!==u[p]&&(A=Math.max(A,u[p].first));y=A>=e?e:A;30<=A&&console.log("WARning, large NUM LUT BITS IS "+
A);for(var e=[],C,p=b;p<a;p++)if(n=p-(p<c?0:c),t=u[n].first,0<t)if(f=[t,n],t<=y)for(n=u[n].second<<y-t,C=1<<y-t,b=0;b<C;b++)e[n|b]=f;else for(n=u[n].second,C=B,b=t-1;0<=b;b--)(t=n>>>b&1)?(C.right||(C.right=new d),C=C.right):(C.left||(C.left=new d),C=C.left),0!==b||C.val||(C.val=f[1]);var c=k.pixels.resultMask,E,u=a=0;0<g&&(v++,g=0);f=q[v];m=new m(h);if(k.headerInfo.numValidPixel===z*w)for(p=b=0;p<w;p++)for(n=0;n<z;n++,b++){h=0;u=E=f<<g>>>32-y;32-g<y&&(u=E|=q[v+1]>>>64-g-y);if(e[u])h=e[u][1],g+=e[u][0];
else for(u=E=f<<g>>>32-A,32-g<A&&(u=E|=q[v+1]>>>64-g-A),C=B,u=0;u<A;u++)if(C=(t=E>>>A-u-1&1)?C.right:C.left,!C.left&&!C.right){h=C.val;g=g+u+1;break}32<=g&&(g-=32,v++,f=q[v]);h-=r;h=0<n?h+a:0<p?h+m[b-z]:h+a;h&=255;a=m[b]=h}else for(p=b=0;p<w;p++)for(n=0;n<z;n++,b++)if(c[b]){h=0;u=E=f<<g>>>32-y;32-g<y&&(u=E|=q[v+1]>>>64-g-y);if(e[u])h=e[u][1],g+=e[u][0];else for(u=E=f<<g>>>32-A,32-g<A&&(u=E|=q[v+1]>>>64-g-A),C=B,u=0;u<A;u++)if(C=(t=E>>>A-u-1&1)?C.right:C.left,!C.left&&!C.right){h=C.val;g=g+u+1;break}32<=
g&&(g-=32,v++,f=q[v]);h-=r;h=0<n&&c[b-1]?h+a:0<p&&c[b-z]?h+m[b-z]:h+a;h&=255;a=m[b]=h}k.pixels.resultPixels=m;k.ptr=k.ptr+4*(v+1)+(0<g?4:0)},decodeBits:function(d,k,l,p){var h=k.headerInfo.fileVersion,e=0,c=new DataView(d,k.ptr,5),b=c.getUint8(0);e++;var a=b>>6,g=0===a?4:3-a,m=0<(b&32)?!0:!1,a=b&31,b=0;if(1===g)b=c.getUint8(e),e++;else if(2===g)b=c.getUint16(e,!0),e+=2;else if(4===g)b=c.getUint32(e,!0),e+=4;else throw"Invalid valid pixel count type";var g=2*k.headerInfo.maxZError,n,t,f;if(m){k.counter.lut++;
f=c.getUint8(e);e++;m=Math.ceil((f-1)*a/8);n=Math.ceil(m/4);n=new ArrayBuffer(4*n);t=new Uint8Array(n);k.ptr+=e;t.set(new Uint8Array(d,k.ptr,m));e=new Uint32Array(n);k.ptr+=m;for(c=0;f-1>>>c;)c++;m=Math.ceil(b*c/8);n=Math.ceil(m/4);n=new ArrayBuffer(4*n);t=new Uint8Array(n);t.set(new Uint8Array(d,k.ptr,m));d=new Uint32Array(n);k.ptr+=m;k=3<=h?r.unstuffLUT2(e,a,f-1,p,g,k.headerInfo.zMax):r.unstuffLUT(e,a,f-1,p,g,k.headerInfo.zMax);3<=h?r.unstuff2(d,l,c,b,k):r.unstuff(d,l,c,b,k)}else k.counter.bitstuffer++,
c=a,k.ptr+=e,0<c&&(m=Math.ceil(b*c/8),n=Math.ceil(m/4),n=new ArrayBuffer(4*n),t=new Uint8Array(n),t.set(new Uint8Array(d,k.ptr,m)),d=new Uint32Array(n),k.ptr+=m,3<=h?null==p?r.originalUnstuff2(d,l,c,b):r.unstuff2(d,l,c,b,!1,p,g,k.headerInfo.zMax):null==p?r.originalUnstuff(d,l,c,b):r.unstuff(d,l,c,b,!1,p,g,k.headerInfo.zMax))},readTiles:function(d,k,m){var p=k.headerInfo,h=p.width,e=p.height,c=p.microBlockSize,p=p.imageType,b=Math.ceil(h/c),a=Math.ceil(e/c);k.pixels.numBlocksY=a;k.pixels.numBlocksX=
b;for(var g=k.pixels.ptr=0,q=0,n=0,t=0,f=0,v=0,r=0,w=0,z=g=0,A=0,y=0,r=r=g=r=0,B,C=new m(c*c),e=e%c||c,E=h%c||c,n=0;n<a;n++)for(f=n!==a-1?c:e,t=0;t<b;t++){v=t!==b-1?c:E;A=n*h*c+t*c;y=h-v;r=d.byteLength-k.ptr;q=new DataView(d,k.ptr,Math.min(10,r));B={};r=0;w=q.getUint8(0);r++;g=w>>6&255;z=w>>2&15;if(z!==(t*c>>3&15))throw"integrity issue";w&=3;if(3<w)throw k.ptr+=r,"Invalid block encoding ("+w+")";if(2===w)k.counter.constant++,k.ptr+=r;else if(0===w){k.counter.uncompressed++;k.ptr+=r;r=f*v*l.getDateTypeSize(p);
g=d.byteLength-k.ptr;r=r<g?r:g;g=new ArrayBuffer(r);q=new Uint8Array(g);q.set(new Uint8Array(d,k.ptr,r));B=new m(g);r=0;if(k.pixels.resultMask)for(g=0;g<f;g++){for(q=0;q<v;q++)k.pixels.resultMask[A]&&(k.pixels.resultPixels[A]=B[r++]),A++;A+=y}else for(g=0;g<f;g++){for(q=0;q<v;q++)k.pixels.resultPixels[A++]=B[r++];A+=y}k.ptr+=r*l.getDateTypeSize(p)}else if(g=l.getDataTypeUsed(p,g),B=l.getOnePixel(B,r,g,q),r+=l.getDateTypeSize(g),3===w)if(k.ptr+=r,k.counter.constantoffset++,k.pixels.resultMask)for(g=
0;g<f;g++){for(q=0;q<v;q++)k.pixels.resultMask[A]&&(k.pixels.resultPixels[A]=B),A++;A+=y}else for(g=0;g<f;g++){for(q=0;q<v;q++)k.pixels.resultPixels[A++]=B;A+=y}else if(k.ptr+=r,l.decodeBits(d,k,C,B),r=0,k.pixels.resultMask)for(g=0;g<f;g++){for(q=0;q<v;q++)k.pixels.resultMask[A]&&(k.pixels.resultPixels[A]=C[r++]),A++;A+=y}else for(g=0;g<f;g++){for(q=0;q<v;q++)k.pixels.resultPixels[A++]=C[r++];A+=y}}},formatFileInfo:function(d){return{fileIdentifierString:d.headerInfo.fileIdentifierString,fileVersion:d.headerInfo.fileVersion,
imageType:d.headerInfo.imageType,height:d.headerInfo.height,width:d.headerInfo.width,numValidPixel:d.headerInfo.numValidPixel,microBlockSize:d.headerInfo.microBlockSize,blobSize:d.headerInfo.blobSize,maxZError:d.headerInfo.maxZError,pixelType:l.getPixelType(d.headerInfo.imageType),eofOffset:d.eofOffset,mask:d.mask?{numBytes:d.mask.numBytes}:null,pixels:{numBlocksX:d.pixels.numBlocksX,numBlocksY:d.pixels.numBlocksY,maxValue:d.headerInfo.zMax,minValue:d.headerInfo.zMin,noDataValue:d.noDataValue}}},
constructConstantSurface:function(d){var k=d.headerInfo.zMax,l=d.headerInfo.height*d.headerInfo.width,p=0;if(d.pixels.resultMask)for(p=0;p<l;p++)d.pixels.resultMask[p]&&(d.pixels.resultPixels[p]=k);else for(p=0;p<l;p++)d.pixels.resultPixels[p]=k},getDataTypeArray:function(d){switch(d){case 0:d=Int8Array;break;case 1:d=Uint8Array;break;case 2:d=Int16Array;break;case 3:d=Uint16Array;break;case 4:d=Int32Array;break;case 5:d=Uint32Array;break;case 6:d=Float32Array;break;case 7:d=Float64Array;break;default:d=
Float32Array}return d},getPixelType:function(d){switch(d){case 0:d="S8";break;case 1:d="U8";break;case 2:d="S16";break;case 3:d="U16";break;case 4:d="S32";break;case 5:d="U32";break;case 6:d="F32";break;case 7:d="F64";break;default:d="F32"}return d},isValidPixelValue:function(d,k){if(null===k||void 0===k)return!1;var l;switch(d){case 0:l=-128<=k&&127>=k;break;case 1:l=0<=k&&255>=k;break;case 2:l=-32768<=k&&32767>=k;break;case 3:l=0<=k&&65536>=k;break;case 4:l=-2147483648<=k&&2147483647>=k;break;case 5:l=
0<=k&&4294967296>=k;break;case 6:l=-3.4027999387901484E38<=k&&3.4027999387901484E38>=k;break;case 7:l=4.9E-324<=k&&1.7976931348623157E308>=k;break;default:l=!1}return l},getDateTypeSize:function(d){var k=0;switch(d){case 0:case 1:k=1;break;case 2:case 3:k=2;break;case 4:case 5:case 6:k=4;break;case 7:k=8;break;default:k=d}return k},getDataTypeUsed:function(d,k){var l=d;switch(d){case 2:case 4:l=d-k;break;case 3:case 5:l=d-2*k;break;case 6:l=0===k?d:1===k?2:1;break;case 7:l=0===k?d:d-2*k+1;break;default:l=
d}return l},getOnePixel:function(d,k,l,p){d=0;switch(l){case 0:d=p.getInt8(k);break;case 1:d=p.getUint8(k);break;case 2:d=p.getInt16(k,!0);break;case 3:d=p.getUint16(k,!0);break;case 4:d=p.getInt32(k,!0);break;case 5:d=p.getUInt32(k,!0);break;case 6:d=p.getFloat32(k,!0);break;case 7:d=p.getFloat64(k,!0);break;default:throw"the decoder does not understand this pixel type";}return d}},d=function(d,k,l){this.val=d;this.left=k;this.right=l};return{decode:function(d,k){k=k||{};var m=k.maskData||null===
k.maskData,p=k.noDataValue,h=0,e={};e.ptr=k.inputOffset||0;e.pixels={};if(l.readHeaderInfo(d,e)){var h=e.headerInfo,c=l.getDataTypeArray(h.imageType);if(m)e.pixels.resultMask=k.maskData,e.ptr+=4;else if(!l.readMask(d,e))return;m=h.width*h.height;e.pixels.resultPixels=new c(m);e.counter={onesweep:0,uncompressed:0,lut:0,bitstuffer:0,constant:0,constantoffset:0};if(0!==h.numValidPixel)if(h.zMax===h.zMin)l.constructConstantSurface(e);else{var b=new DataView(d,e.ptr,2),a=b.getUint8(0,!0);e.ptr++;a?l.readDataOneSweep(d,
e,c):1<h.fileVersion&&1>=h.imageType&&1E-5>Math.abs(h.maxZError-.5)?(b=b.getUint8(1,!0),e.ptr++,b?l.readHuffman(d,e,c):l.readTiles(d,e,c)):l.readTiles(d,e,c)}e.eofOffset=e.ptr;k.inputOffset?(c=e.headerInfo.blobSize+k.inputOffset-e.ptr,1<=Math.abs(c)&&(e.eofOffset=k.inputOffset+e.headerInfo.blobSize)):(c=e.headerInfo.blobSize-e.ptr,1<=Math.abs(c)&&(e.eofOffset=e.headerInfo.blobSize));c={width:h.width,height:h.height,pixelData:e.pixels.resultPixels,minValue:h.zMin,maxValue:h.zMax,maskData:e.pixels.resultMask};
if(e.pixels.resultMask&&l.isValidPixelValue(h.imageType,p)){b=e.pixels.resultMask;for(h=0;h<m;h++)b[h]||(c.pixelData[h]=p);c.noDataValue=p}e.noDataValue=p;k.returnFileInfo&&(c.fileInfo=l.formatFileInfo(e));return c}},getBandCount:function(d){for(var k=0,m=0,p={ptr:0,pixels:{}};m<d.byteLength-58;)l.readHeaderInfo(d,p),m+=p.headerInfo.blobSize,k++,p.ptr=m;return k}}})},"esri/layers/pixelFilters/VectorFieldPixelFilter":function(){define("dojo/_base/declare dojo/_base/lang dojo/has ../../kernel ../../lang dojo/_base/array".split(" "),
function(r,l,d,q,k,m){return r(null,{declaredClass:"esri.layers.pixelFilters.VectorFieldPixelFilter",speedUnits:["esriMetersPerSecond","esriKilometersPerHour","esriKnots","esriFeetPerSecond","esriMilesPerHour"],constructor:function(d){l.mixin(this,d);this.isDataUV=d&&d.isDataUV?d.isDataUV:!1;this.computeMagnitudeAndDirection=l.hitch(this,this.computeMagnitudeAndDirection);this.unitConversionFactor=1;this._updateUnitConvFactor()},setUnits:function(d,h){this.inputUnit=d;this.outputUnit=h;this.unitConversionFactor=
1;this._updateUnitConvFactor()},_updateUnitConvFactor:function(){var d=m.indexOf(this.speedUnits,this.inputUnit),h=m.indexOf(this.speedUnits,this.outputUnit);if(this.inputUnit&&this.outputUnit&&0<=d&&0<=h){var e=[1,.277778,.514444,.3048,.44704,0];this.unitConversionFactor=e[d]/e[h]}},computeMagnitudeAndDirection:function(d){if(!k.isDefined(d))throw"Could not compute magnitude and direction. No pixel data is available.";var h=d.pixelBlock;if(!k.isDefined(h)||2!==h.getPlaneCount())throw"Could not compute magnitude and direction. Pixel data does not contain two bands.";
var e=d.extent,c=(e.xmax-e.xmin)/h.width,b=(e.ymax-e.ymin)/h.height,a=e.xmin+c/2,e=e.ymax-b/2;h.statistics[0].minValue=0;h.statistics[0].maxValue=0;var g=180/Math.PI,l=[],n=0,m=0,f=0,p=!k.isDefined(h.mask),q,w,r,A,y,B,C,E;y=C=Infinity;B=E=-Infinity;for(n=0;n<h.height;n++)for(m=0;m<h.width;m++,f++)if(l.push([a+c*m,e-b*n]),p||h.mask[f])r=q=h.pixels[0][f]*this.unitConversionFactor,A=w=h.pixels[1][f],this.isDataUV&&(r=Math.sqrt(q*q+w*w),A=90-g*Math.atan2(w,q),h.pixels[0][f]=r*this.unitConversionFactor,
h.pixels[1][f]=A),r>B&&(B=r),r<y&&(y=r),A>E&&(E=A),A<C&&(C=A);h.statistics[0].maxValue=B;h.statistics[0].minValue=y;h.statistics[1].maxValue=E;h.statistics[1].minValue=C;d.locations=l;return d}})})},"esri/layers/rasterFormats/ImageCanvasDecoder":function(){define(["require","dojo/_base/declare","dojo/Deferred","dojo/sniff"],function(r,l,d,q){var k;return l(null,{constructor:function(d){this.ctx=d.ctx;this._loadRasterFormatModule()},decode:function(k,l){if(!l.width||!l.height)throw"Native decoding requires the image format, width and height";
var h=new d,e,c=new Uint8Array(k),b=this._getFormat(k);if("error"===b)throw"invalid format";"jpeg"===b&&(e=this._getMask(c,l));var a="",g,m;for(g=0;g<c.length;g+=65535)m=c.subarray(g,g+65535>c.length-1?c.length-1:g+65535),a+=String.fromCharCode.apply(null,m);var c="data:image/"+b+";base64,"+window.btoa(a),n=new Image,t;n.src=c;var f=this;n.onload=function(){f.ctx.clearRect(0,0,l.width,l.height);f.ctx.drawImage(n,0,0);var a=f.ctx.getImageData(0,0,n.width,n.height);t=a.data;if(e)for(g=0;g<e.length;g++)t[4*
g+3]=e[g]?255:0;f.ctx.putImageData(a,0,0);h.resolve(null)};n.onerror=function(){h.reject("cannot load image")};return h},_getFormat:function(d){d=new Uint8Array(d,0,10);var k="error";255===d[0]&&216===d[1]?k="jpeg":137===d[0]&&80===d[1]&&78===d[2]&&71===d[3]&&(k="png");return k},_getMask:function(d,l){var h;try{if(!k)throw"The zlib decoder module is not loaded.";var e=0,c=0,b=Math.round(d.length/2);1===b%2&&(b+=1);for(var a=d.length-2,e=b;e<a&&(255!==d[e]||217!==d[e+1]);e++);b=e+=2;if(b<d.length-
1){var g=(new k(d.subarray(b))).getBytes();h=new Uint8Array(l.width*l.height);for(e=b=0;e<g.length;e++)for(c=7;0<=c;c--)h[b++]=g[e]>>c&1}}catch(u){}return h},_loadRasterFormatModule:function(){10>q("ie")||r(["./Zlib"],function(d){k=d})}})})},"esri/tasks/ImageServiceIdentifyTask":function(){define("dojo/_base/declare dojo/_base/lang dojo/has ../kernel ../request ../geometry/normalizeUtils ./Task ./ImageServiceIdentifyResult".split(" "),function(r,l,d,q,k,m,p,h){r=r(p,{declaredClass:"esri.tasks.ImageServiceIdentifyTask",
constructor:function(d){this._url.path+="/identify";this._handler=l.hitch(this,this._handler)},__msigns:[{n:"execute",c:3,a:[{i:0,p:["geometry"]}],e:2}],_handler:function(d,c,b,a,g){try{var e=new h(d);this._successHandler([e],"onComplete",b,g)}catch(n){this._errorHandler(n,a,g)}},execute:function(d,c,b,a){var e=a.assembly;d=this._encode(l.mixin({},this._url.query,{f:"json"},d.toJson(e&&e[0])));var h=this._handler,n=this._errorHandler;return k({url:this._url.path,content:d,callbackParamName:"callback",
load:function(d,f){h(d,f,c,b,a.dfd)},error:function(c){n(c,b,a.dfd)}})},onComplete:function(){}});m._createWrappers(r);return r})},"esri/tasks/ImageServiceIdentifyResult":function(){define("dojo/_base/declare dojo/_base/lang dojo/has ../kernel ../geometry/jsonUtils ./FeatureSet".split(" "),function(r,l,d,q,k,m){return r(null,{declaredClass:"esri.tasks.ImageServiceIdentifyResult",constructor:function(d){d.catalogItems&&(this.catalogItems=new m(d.catalogItems));d.location&&(this.location=k.fromJson(d.location));
this.catalogItemVisibilities=d.catalogItemVisibilities;this.name=d.name;this.objectId=d.objectId;this.value=d.value;this.processedValues=d.processedValues;this.properties=d.properties}})})},"esri/tasks/ImageServiceIdentifyParameters":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/json dojo/_base/array dojo/has ../kernel ../lang ../geometry/jsonUtils".split(" "),function(r,l,d,q,k,m,p,h){return r(null,{declaredClass:"esri.tasks.ImageServiceIdentifyParameters",geometry:null,mosaicRule:null,
renderingRule:null,renderingRules:null,pixelSizeX:null,pixelSizeY:null,pixelSize:null,returnGeometry:!1,returnCatalogItems:!0,timeExtent:null,toJson:function(e){var c=e&&e.geometry||this.geometry;e={geometry:c,returnGeometry:this.returnGeometry,returnCatalogItems:this.returnCatalogItems,mosaicRule:this.mosaicRule?d.toJson(this.mosaicRule.toJson()):null,renderingRule:this.renderingRule?d.toJson(this.renderingRule.toJson()):null};c&&(e.geometryType=h.getJsonType(c));c=this.timeExtent;e.time=c?c.toJson().join(","):
null;p.isDefined(this.pixelSizeX)&&p.isDefined(this.pixelSizeY)?e.pixelSize=d.toJson({x:parseFloat(this.pixelSizeX),y:parseFloat(this.pixelSizeY)}):this.pixelSize&&(e.pixelSize=this.pixelSize?d.toJson(this.pixelSize.toJson()):null);this.renderingRules&&(e.renderingRules=d.toJson(q.map(this.renderingRules,function(b){return b.toJson()})));return e}})})},"esri/layers/pixelFilters/StretchFilter":function(){define(["dojo/_base/declare","dojo/_base/lang","../PixelBlock"],function(r,l,d){var q;return r(null,
{stretchType:0,min:0,max:255,numberOfStandardDeviations:2,statistics:null,histograms:null,dra:!1,minPercent:.25,maxPercent:.5,useGamma:!1,gamma:null,raster:null,outputPixelType:"U8",computeGamma:!1,constructor:function(d){this.stretchType=d.stretchType||d.StretchType||this.stretchType;this.min=d.min||d.Min||this.min;this.max=d.max||d.Max||this.max;this.numberOfStandardDeviations=d.numberOfStandardDeviations||d.NumberOfStandardDeviations||this.numberOfStandardDeviations;this.statistics=d.statistics||
d.Statistics||this.statistics;this.dra=d.dra||d.DRA||d.dRA||this.dra;this.minPercent=d.minPercent||d.MinPercent||this.minPercent;this.maxPercent=d.maxPercent||d.MaxPercent||this.maxPercent;this.useGamma=d.useGamma||d.UseGamma||this.useGamma;this.gamma=d.gamma||d.Gamma||this.gamma;this.computeGamma=d.computeGamma||d.ComputeGamma||this.computeGamma;this.raster=d.raster||d.Raster||this.raster;this.outputPixelType=d.outputPixelType||d.OutputPixelType||this.outputPixelType;this.raster=d.raster||d.Raster||
this.raster;q=this},filter:function(d){if(null!==d&&null!==d.pixelBlock&&null!==d.pixelBlock.pixels){var k=d.pixelBlock,l=k.pixels,h=k.width*k.height,e=l.length,c;(c=6===q.stretchType||3===q.stretchType&&q.dra)&&q._calculateStatisticsHistograms(d);if(q.dra)if(c)q._statistics=k.statistics,q._histograms=k.histograms;else{var b=k.statistics;q._statistics=[];for(c=0;c<e;c++)q._statistics[c]=[b[c].minValue,b[c].maxValue,0,0]}else q._statistics=q.statistics,q._histograms=q.histograms;q.computeGamma&&(q.gamma=
q._computeGammaValues(k.pixelType),q.useGamma=!0);q._createLUT(d);if(void 0===q.LUT||null===q.LUT)return q._filterNoLUT(d);var b=q.LUT,a=q.LUTOffset,g,u;for(c=0;c<e;c++)for(u=b[c],k=0;k<h;k++)g=l[c][k],l[c][k]=u[g-a];d.pixelBlock.pixelType="U8";return d}},_calculateStatisticsHistograms:function(d){d=d.pixelBlock;var k=d.pixelType,p=d.pixels,h=d.mask,e=p.length,c,b,a,g,u=function(a){this.min=-.5;this.max=255.5;this.size=256;l.mixin(this,a);this.counts=this.counts||new Uint32Array(this.size)},n=[],
t,f,q,r,w,z;for(a=0;a<e;a++){t=new u;f=t.counts;r=p[a];if("U8"===k)if(h)for(g=0;g<d.width*d.height;g++)h[g]&&f[r[g]]++;else for(g=0;g<d.width*d.height;g++)f[r[g]]++;else{c=d.statistics[a].minValue;b=d.statistics[a].maxValue;t.min=c;t.max=b;b=(b-c)/256;q=new Uint32Array(257);if(h)for(g=0;g<d.width*d.height;g++)h[g]&&q[Math.floor((r[g]-c)/b)]++;else for(g=0;g<d.width*d.height;g++)q[Math.floor((r[g]-c)/b)]++;for(g=0;255>g;g++)f[g]=q[g];f[255]=q[255]+q[256]}n.push(t);r=[];c=d.statistics[a].minValue;b=
d.statistics[a].maxValue;for(g=z=w=q=0;g<t.size;g++)q+=f[g],w+=g*f[g];w/=q;for(g=0;g<t.size;g++)z+=f[g]*Math.pow(g-w,2);f=Math.sqrt(z/(q-1));g=(w+.5)*(t.max-t.min)/t.size+t.min;t=f*(t.max-t.min)/t.size;r.push(c);r.push(b);r.push(g);r.push(t);d.statistics[a]=r}d.histograms=n},_getCutOffPoints:function(d){d=d.pixelBlock.pixels.length;var k=[],l=[],h,e,c,b,a,g;switch(q.stretchType){case 5:for(a=0;a<d;a++)k[a]=q._statistics[a][0],l[a]=q._statistics[a][1];break;case 3:for(a=0;a<d;a++)k[a]=q._statistics[a][2]-
q.numberOfStandardDeviations*q._statistics[a][3],l[a]=q._statistics[a][2]+q.numberOfStandardDeviations*q._statistics[a][3],k[a]<q._statistics[a][0]&&(k[a]=q._statistics[a][0]),l[a]>q._statistics[a][1]&&(l[a]=q._statistics[a][1]);break;case 6:for(a=0;a<d;a++){h=q._histograms[a];b=new Uint32Array(h.size);c=h.counts;for(g=e=0;g<h.size;g++)e+=c[g],b[g]=e;c=q.minPercent*e/100;for(g=1;g<h.size;g++)if(b[g]>c){k[a]=h.min+(h.max-h.min)/h.size*(g-.5);break}c=(1-q.maxPercent/100)*e;for(g=h.size-2;0<=g;g--)if(b[g]<
c){l[a]=h.min+(h.max-h.min)/h.size*(g+.5);break}}break;default:for(a=0;a<d;a++)k[a]=0,l[a]=255}return{minCutOff:k,maxCutOff:l}},_createLUT:function(d){var k=d.pixelBlock,l=k.pixelType;if("U8"===l||"U16"===l||"S8"===l||"S16"===l){if(q._LUTSignature&&(l=q._computeLutSignature(),l.length===q._LUTSignature.length&&!l.some(function(a,b){return a!==q._LUTSignature[b]})))return;var l=k.pixels.length,h=[],e=[],c=[],b,a,g,u=q.max,n=q.min,t=q.gamma,f=u-n,v=q._getCutOffPoints(d);d=v.minCutOff;var v=v.maxCutOff,
r=0,w=256,z;"S8"===k.pixelType?r=-127:"S16"===k.pixelType&&(r=-32767);if("U16"===k.pixelType||"S16"===k.pixelType)w=65536;for(k=0;k<l;k++)h[k]=v[k]-d[k];if(q.useGamma&&null!==t&&t.length===l)for(k=0;k<l;k++)c[k]=1<t[k]?2<t[k]?6.5+Math.pow(t[k]-2,2.5):6.5+100*Math.pow(2-t[k],4):1;if(q.useGamma)for(var A,k=0;k<l;k++){z=[];for(b=0;b<w;b++)a=b+r,A=(a-d[k])/h[k],g=1,1<t[k]&&(g-=Math.pow(1/f,A*c[k])),a<v[k]&&a>d[k]?z[b]=Math.floor(g*f*Math.pow(A,1/t[k]))+n:a>v[k]?z[b]=u:a<d[k]&&(z[b]=n);e[k]=z}else for(k=
0;k<l;k++){z=[];for(b=0;b<w;b++)a=b+r,z[b]=a<d[k]?n:a>v[k]?u:Math.floor((a-d[k])/h[k]*f)+n;e[k]=z}q.LUT=e;q.LUTOffset=r;q._LUTSignature=q._computeLutSignature()}},_computeLutSignature:function(){var d=[],l,p;d.push(q.stretchType);d.push(q.min);d.push(q.max);d.push(q.numberOfStandardDeviations);if(q._statistics)for(l=0;l<q._statistics.length;l++)for(p=0;p<q._statistics[l].length;p++)d.push(q._statistics[l][p]);d.push(q.dra?1:0);d.push(q.minPercent);d.push(q.maxPercent);if(q.gamma)for(l=0;l<q._statistics.length;l++)d.push(q.gamma[l]);
d.push(q.useGamma?1:0);return d},_filterNoLUT:function(d){if(null!==d&&null!==d.pixelBlock&&null!==d.pixelBlock.pixels){var k=d.pixelBlock,l=k.pixels,h=k.mask,k=k.width*k.height,e=l.length,c=[],b=[],a,g,u,n,t,f=q.max,v=q.min,r=q.gamma,w=f-v;a=q._getCutOffPoints(d);var z=a.minCutOff,A=a.maxCutOff;for(a=0;a<e;a++)c[a]=A[a]-z[a];if(q.useGamma&&null!==r&&r.length===e)for(a=0;a<e;a++)b[a]=1<r[a]?2<r[a]?6.5+Math.pow(r[a]-2,2.5):6.5+100*Math.pow(2-r[a],4):1;if(q.useGamma)if(void 0!==h&&null!==h)for(g=0;g<
k;g++){if(h[g])for(a=0;a<e;a++)u=l[a][g],t=(u-z[a])/c[a],n=1,1<r[a]&&(n-=Math.pow(1/w,t*b[a])),u<A[a]&&u>z[a]?l[a][g]=Math.floor(n*w*Math.pow(t,1/r[a]))+v:u>A[a]?l[a][g]=f:u<z[a]&&(l[a][g]=v)}else for(g=0;g<k;g++)for(a=0;a<e;a++)u=l[a][g],t=(u-z[a])/c[a],n=1,1<r[a]&&(n-=Math.pow(1/w,t*b[a])),u<A[a]&&u>z[a]?l[a][g]=Math.floor(n*w*Math.pow(t,1/r[a]))+v:u>A[a]?l[a][g]=f:u<z[a]&&(l[a][g]=v);else if(void 0!==h&&null!==h)for(g=0;g<k;g++){if(h[g])for(a=0;a<e;a++)u=l[a][g],u<A[a]&&u>z[a]?l[a][g]=Math.floor((u-
z[a])/c[a]*w)+v:u>A[a]?l[a][g]=f:u<z[a]&&(l[a][g]=v)}else for(g=0;g<k;g++)for(a=0;a<e;a++)u=l[a][g],u<A[a]&&u>z[a]?l[a][g]=Math.floor((u-z[a])/c[a]*w)+v:u>A[a]?l[a][g]=f:u<z[a]&&(l[a][g]=v);d.pixelBlock.pixelType="U8";return d}},_computeGammaValues:function(d){var k=this._statistics.length,l,h=[],e;for(l=0;l<k;l++)e=this._statistics[l][2],"U8"!==d&&(e=255*(e-this._statistics[l][0])/(this._statistics[l][1]-this._statistics[l][0])),h.push(this._computeGammaValue(e));return h},_computeGammaValue:function(d){if(0!==
d&&!(255<d||0>d)){var k=0;0<d&&150!=d&&255>d&&(k=150>=d?45*Math.cos(.01047*d):17*Math.sin(.021*d));k=Math.log((d+k)/255);if(0!==k&&(d=Math.log(d/255)/k,!isNaN(d)))return Math.min(9.9,Math.max(.01,d))}}})})},"esri/layers/StreamLayer":function(){define("dojo/_base/declare dojo/_base/connect dojo/_base/array dojo/_base/Color dojo/_base/lang dojo/has dojo/io-query dojo/on dojo/aspect ../kernel ../request ../graphic ./FeatureLayer ./StreamMode ./StreamTrackManager ../geometry/jsonUtils ../symbols/SimpleFillSymbol ../symbols/SimpleLineSymbol ../symbols/SimpleMarkerSymbol ../renderers/SimpleRenderer ./PurgeOptions".split(" "),
function(r,l,d,q,k,m,p,h,e,c,b,a,g,u,n,t,f,v,x,w,z){return r([g],{declaredClass:"esri.layers.StreamLayer",_preventInit:!0,constructor:function(a,c){c=c||{};c.mode&&c.mode!==g.MODE_STREAM||(this._isStream=!0,this.currentMode=this.mode=g.MODE_STREAM,this._mode=new u(this));this.purgeOptions=new z(this,c.purgeOptions||{});this.purgeInterval=c.purgeInterval||0;this._reconnectAttempts=0;this.maxReconnectAttempts=10;this.socket=this._reconnectTimeoutId=null;this._keepLatestQueried=!1;this._keepLatestUrl=
null;this._relatedQueried=!1;this._joinField=this._relatedUrl=null;this._refreshing=!1;this._attemptReconnect=k.hitch(this,this._attemptReconnect);this._purge=k.hitch(this,this._purge);this._processServiceJson=k.hitch(this,this._processServiceJson);if(k.isObject(a)&&a.layerDefinition)this._initFeatureLayer(a,c);else{var d=this;b({url:a,content:k.mixin({f:"json"}),callbackParamName:"callback"}).then(function(a){d._processServiceJson(a,c)},function(a){d._errorHandler(a)})}},_processServiceJson:function(a,
c){var f=this;a.relatedFeatures&&a.relatedFeatures.featuresUrl&&a.relatedFeatures.joinField?(this._relatedUrl=a.relatedFeatures.featuresUrl,this.objectIdField=this._joinField=a.relatedFeatures.joinField,b({url:this._relatedUrl,content:{f:"json"},callbackParamName:"callback"}).then(function(b){b=b.fields||[];var e=d.map(a.fields,function(a){return a.name.toLowerCase()});d.forEach(b,function(b){-1===d.indexOf(e,b.name.toLowerCase())&&a.fields.push(b)});c.resourceInfo=a;f._initFeatureLayer(f._url,c)},
function(a){f.onError({error:a})})):(c.resourceInfo=a,this._initFeatureLayer(this._url,c))},_initLayer:function(a,b){this.inherited(arguments);if(a){var c;if(a.layerDefinition)this.purgeOptions=new z(this,this._params.purgeOptions||{}),this.socketUrl=this._params.socketUrl||a.layerDefinition.socketUrl||void 0;else{if(this._params.socketUrl)this.socketUrl=this._params.socketUrl;else{var d=this._getWebsocketConnectionInfo(a),f=d.urls;f&&f.length?(this._socketUrls=f,this.socketUrl=f[0],this.socketDirection=
"broadcast"===this._params.socketDirection?"broadcast":"subscribe",this.socketUrl+="/"+this.socketDirection,this._websocketToken=d.token,f.length>this.maxReconnectAttempts&&(this.maxReconnectAttempts=f.length)):(this.socketUrl=void 0,d="No web socket urls were retrieved from the Stream Service. Layer will not attempt to connect.","https:"===location.protocol&&(d+=" An insecure web socket connection cannot be made from a secure web page."),this.onError(Error(d)))}if(this._params.filter)try{this._filter=
c=this._makeFilter(this._params.filter)}catch(D){this.onError(Error("Error trying to create filter object: "+D+". Layer will not have filter applied")),this._filter=null}if(this._params.geometryDefinition||this._outFields||this._defnExpr){c=c||{};c.geometry=this._params.geometryDefinition;c.outFields=this._outFields;c.where=this._defnExpr;try{this._filter=c=this._makeFilter(c)}catch(D){this.onError(Error("Error trying to create filter object: "+D+". Layer will not have filter applied")),this._filter=
null}}}this.maximumTrackPoints=this._params.maximumTrackPoints||0===this._params.maximumTrackPoints?this._params.maximumTrackPoints:1;(this._params.refreshRate||0===this._params.refreshRate)&&this._mode&&this._mode._setRefreshRate&&this._mode._setRefreshRate(this._params.refreshRate);this._keepLatestUrl=a.keepLatestArchive?a.keepLatestArchive.featuresUrl:null;a.relatedFeatures&&a.relatedFeatures.featuresUrl&&a.relatedFeatures.joinField&&(this._relatedUrl=a.relatedFeatures.featuresUrl,this.objectIdField=
this._joinField=a.relatedFeatures.joinField);this.objectIdField||this._makeObjectIdField();this._map&&this.socketUrl&&!this._connected&&this.connect()}},_setMap:function(a){var b=this.inherited(arguments),c=this._getRenderer();this.timeInfo&&(this._trackIdField||c&&(c.latestObservationRenderer||c.trackRenderer))&&(this._trackManager=new n(this),this._trackManager.initialize(a));this.socketUrl&&!this._connected&&this._map&&this.connect();return b},_unsetMap:function(a,b){d.forEach(this._connects,l.disconnect);
(this._connected||this._reconnecting||this.socket)&&this.disconnect();this._togglePurgeT();this.inherited(arguments);this._map=null},_suspend:function(){this._togglePurgeT();this.inherited(arguments)},_resume:function(){this.inherited(arguments);this._togglePurgeT(!0)},clear:function(){try{this._mode&&this._mode._clearDrawBuffer&&this._mode._clearDrawBuffer(),this._mode&&this._mode._clearTimeBin&&this._mode._clearTimeBin(),this._mode&&this._mode._clearFeatureMap&&this._mode._clearFeatureMap(),this._trackManager&&
this._trackManager.clearTracks()}catch(A){}this.inherited(arguments)},redraw:function(){this._mode&&this._mode._flushDrawBuffer&&this._mode._flushDrawBuffer();this.inherited(arguments)},setDefinitionExpression:function(a){this.setFilter({where:a})},getDefinitionExpression:function(){var a;this._filter&&(a=this._filter.where);return a},destroy:function(){this.disconnect();this.inherited(arguments)},onResume:function(a){this.inherited(arguments)},setGeometryDefinition:function(a){this.setFilter({geometry:a})},
getGeometryDefinition:function(){var a;this._filter&&(a=this._filter.geometry);return a},connect:function(a){var b=this,c={},d=this._filter,f,e,g=this.socketUrl,h;try{if(!this._connected){if(this._map){var n;if(this._relatedUrl&&!this._relatedQueried&&this._mode._fetchArchive)return n=this.on("update-end",function(a){b._relatedQueried=!0;n.remove();n=null;a&&a.error?console.log("Not connecting. Error fetching related features"):b.connect()}),this._mode._fetchArchive(this._relatedUrl),!1;if(this._keepLatestUrl&&
!this._keepLatestQueried&&this._mode._fetchArchive)return n=this.on("update-end",function(a){b._keepLatestQueried=!0;n.remove();n=null;a&&a.error?console.log("Not connecting. Error fetching archived features"):b.connect()}),this._mode._fetchArchive(this._keepLatestUrl),!1}this._websocketToken&&(c.token=this._websocketToken);this._map&&this._map.spatialReference&&this.spatialReference&&this._map.spatialReference.wkid!==this.spatialReference.wkid&&(c.outSR=this._map.spatialReference.wkid);if(d)for(e in d)null!==
d[e]&&(f="geometry"===e?JSON.stringify(d[e]):d[e],c[e]=f);g+="?"+p.objectToQuery(c);return h=this._createConnection(g,a)}}catch(N){console.log("Error connecting to data stream: ",N),a&&a(N,!1),this.onConnectionError({error:N})}},disconnect:function(a){var b=this._refreshing?"Disconnecting as part of layer refresh cycle":"Connection closed from client",c=this._refreshing?!0:!1;this._reconnectTimeoutId&&clearTimeout(this._reconnectTimeoutId);this._refreshing=this._reconnecting=this._connected=!1;this.socket&&
this.socket.close();this.onDisconnect({willReconnect:c,message:b});a&&a(null,!0)},setFilter:function(a){var b,c;if(this._collection)return this.onError("Filter can only be set when the source of the layer is a Stream Service"),!1;try{if(void 0!==a.outFields)return c=Error("Outfields property cannot be changed after layer is created"),this.onFilterChange({filter:this.getFilter(),error:c}),!1;b=this._makeFilter(a)}catch(C){return c=Error(C),this.onFilterChange({filter:this.getFilter(),error:c}),!1}if(this.socket)a=
{filter:b},this.socket.send(JSON.stringify(a));else h.once(this,"connect",function(a){this.setFilter(b)});return!0},getFilter:function(){var a=this._filter,b={},c=["geometry","outFields","where"];a&&d.forEach(c,function(c){var d=a[c];d&&("geometry"===c?d=t.fromJson(d):"outFields"===c&&(d=d.split(",")),b[c]=d)});return b},setMaximumTrackPoints:function(a){if(!a&&0!==a)return!1;this.maximumTrackPoints=a;this._mode.propertyChangeHandler(3)},getUniqueValues:function(a){var b,c={},f=[];b=this._getField(a,
!0);if(!b)return f;a=b.name;d.forEach(this.graphics||[],function(b){b=(b.attributes||{})[a];void 0===b||c[b]||(c[b]=1,f.push(b))});f.sort(function(a,b){return a<b?-1:a>b?1:0});return f},getLatestObservations:function(){var a=[];return a=this._trackManager?this._trackManager.getLatestObservations():this.graphics},setPurgeInterval:function(a){var b=this.purgeInterval;this.purgeInterval=a;this._togglePurgeT();a&&this._togglePurgeT(!0);if(b!==a)this.onPurgeIntervalChange();return this},_togglePurgeT:function(a){if(a&&
this.purgeInterval){var b=this;clearTimeout(this._purgeT);this._mode&&this._mode._flushDrawBuffer&&(this._purgeT=setTimeout(function(){b.updating||b.suspended||(b._mode._flushDrawBuffer(),b._togglePurgeT(!0))},6E4*this.purgeInterval))}else this._purgeT&&(clearTimeout(this._purgeT),this._refreshT=null)},onMessage:function(){},onConnect:function(){},onDisconnect:function(){},onFilterChange:function(){},onAttemptReconnect:function(){},onConnectionError:function(){},onPurgeIntervalChange:function(){},
_createConnection:function(a,b){var c=this,d=new WebSocket(a);d.onopen=function(){c.socket=d;c._connected=!0;c._reconnecting=!1;c._reconnectAttempts=0;c._bind();c.onConnect();b&&b(null,!0)};d.onclose=function(a){var b,d=!0,f=c._connected,e=null;if(c._connected||c._reconnecting){if(a.code)if(b="Connection failed: ",1001===a.code)b+=a.reason||"Service is going away.",d=!1;else if(4400===a.code)b+=a.reason||"Invalid url parameters. Check filter properties.",d=!1;else if(4404===a.code)b+="Service not found",
d=!1;else if(4401===a.code||4403===a.code)b+="Not authorized",d=!1;d&&(c._reconnectAttempts+=1,c._reconnectAttempts>c.maxReconnectAttempts&&(b="Maximum reconnect attempts exceeded",d=!1,f=!0));c._connected=!1;f&&(b&&(e=Error(b)),c.onDisconnect({error:e,willReconnect:d}));d?c._attemptReconnect():c.socket=null}else c.socket||(e=Error("Could not make connection to service"),c.onConnectionError({error:e})),c.socket=null,c._connected=!1};d.onerror=function(a){console.log("Socket error")};return d},_purge:function(){var a,
b=[],c;if(this.purgeOptions.displayCount&&this.graphics.length>this.purgeOptions.displayCount)for(a=0;a<this.graphics.length-this.purgeOptions.displayCount;a++)c=this.graphics[a],b.push(c);0<b.length&&(this._mode._removeFeatures(b),this._trackManager&&this._trackManager.removeFeatures(b))},_bind:function(){var a=this;this.socket.onmessage=function(b){a._onMessage(JSON.parse(b.data))}},_onMessage:function(a){var b=this;this.onMessage(a);var c={create:function(a){b._create(a)},update:function(a){b._update(a)},
"delete":function(a){b._delete(a)}};if(a.type)c[a.type](a.feature);else a.hasOwnProperty("filter")?b._handleFilterMessage(a):this._create(a)},_create:function(b){function c(b){if(!d._featureHasOID(b,f)){if(!b.geometry)return!1;b.attributes=b.attributes||{};b.attributes[f]=d._nextId++}b=b.declaredClass?b:new a(b);d._mode.drawFeature(b)}var d=this,f=d.objectIdField;b.length?b.forEach(function(a){a&&c(a)}):b&&c(b)},_delete:function(a){var b=this,c=a[b.objectIdField]||a.attributes[b.objectIdField],d=
!1;this.graphics.forEach(function(a){a.attributes[b.objectIdField]==c&&(d=a)});d&&this.remove(d)},_update:function(a){var b=this,c=!1;this.graphics.forEach(function(d){d.attributes[b.objectIdField]==a.attributes[b.objectIdField]&&(c=d)});c&&(a.attributes&&c.setAttributes(a.attributes),a.geometry&&c.setGeometry(t.fromJson(a.geometry)))},_makeFilter:function(a){var b,c=null;a=a||{};if(void 0!==a.geometry)if(c=c||{},null===a.geometry)c.geometry=null;else{b="string"===typeof a.geometry?t.fromJson(JSON.parse(a.geometry)):
a.geometry.declaredClass?a.geometry:t.fromJson(a.geometry);if(!b||"point"===b.type)throw"Query object contains invalid geometry";"extent"!==b.type&&(b=b.getExtent());if(!b||0===b.getHeight()&&0===b.getWidth())throw"Invalid filter geometry: Extent cannot have a height and width of 0";c.spatialRel="esriSpatialRelIntersects";c.geometryType="esriGeometryEnvelope";c.geometry=b.toJson()}void 0!==a.where&&(c=c||{},c.where=a.where);if(void 0!==a.outFields&&(c=c||{},a="string"===typeof a.outFields?"*"===a.outFields?
null:a.outFields.replace(/,\s+/g,",").split(","):null===a.outFields?null:a.outFields,a=this._makeOutFields(a))){if(a.errors&&0<a.errors.length)throw"Invalid filter outFields. "+a.errors.join(",");c.outFields=a.fields?a.fields.join(","):null}return c},_makeOutFields:function(a){var b=this,c=[],f=[],e={fields:null};if(!a||0===a.length)return e;d.forEach(a,function(a){if("*"===a)return e;var d=b._getField(a,!0);d?c.push(d.name):f.push("Field named "+a+" not found in schema.")});a=b._getOutFields();d.forEach(a,
function(a){b._getField(a)&&-1===d.indexOf(c,a)&&c.push(a)});e.fields=c;e.errors=f;return e},_handleFilterMessage:function(a){a.error?(a=Error(a.error.join(",")),this.onFilterChange({filter:this.getFilter(),error:a})):(a=a.filter,a.geometry&&"string"===typeof a.geometry&&(a.geometry=JSON.parse(a.geometry)),this._filter=a,this.onFilterChange({filter:this.getFilter()}))},_getWebsocketConnectionInfo:function(a){var b={urls:[]},c,f=[],e=[],g,h,n;a.streamUrls&&d.forEach(a.streamUrls,function(a){"ws"===
a.transport&&(c=a.urls,b.token=a.token)});if(!c)return b;d.forEach(c,function(a){0===a.lastIndexOf("wss",0)?e.push(a):f.push(a)});a="https:"===location.protocol||0===this.url.lastIndexOf("https:",0)?e:0===f.length?e:f;if(1<a.length)for(g=0;g<a.length-1;g++)h=g+Math.floor(Math.random()*(a.length-g)),n=a[h],a[h]=a[g],a[g]=n;b.urls=a;return b},_attemptReconnect:function(){var a=this,b;this._reconnectTimeoutId=null;a._connected=!1;if(!a._socketUrls)return!1;if(!a._collection&&!a._reconnecting&&a.socket&&
a.credential)return a._reconnecting=!0,a._getServiceConnectionMetadata(a._attemptReconnect),!1;a._reconnecting=!0;a.socket=null;if(a._reconnectAttempts>a.maxReconnectAttempts)return a._reconnecting=!1;a.socketUrl=a._socketUrls[a._reconnectAttempts>a._socketUrls.length-1?a._reconnectAttempts%a._socketUrls.length:a._reconnectAttempts];a.socketUrl+="/"+a.socketDirection;b=a._randomIntFromInterval(0,1E3);this._reconnectTimeoutId=setTimeout(function(){a.onAttemptReconnect({count:a._reconnectAttempts,url:a.socketUrl});
a.connect()},1E3*a._reconnectAttempts+b)},_getServiceConnectionMetadata:function(a){var c=this,d=c._url.path;a="function"===typeof a?a:null;b({url:d,content:k.mixin({f:"json"},this._url.query),callbackParamName:"callback"}).then(function(b){b=c._getWebsocketConnectionInfo(b);c._websocketToken=b.token;a&&a()},function(a){c.onError(Error(a))})},_setDefaultRenderer:function(){var a=this.geometryType,b=new q([5,112,176,.8]),c=new q([255,255,255]),c=new v(v.STYLE_SOLID,c,1),d;if("esriGeometryPoint"===
a||"esriGeometryMultipoint"===a)d=new x(x.STYLE_CIRCLE,10,c,b);else if("esriGeometryPolyline"===a)d=new v(v.STYLE_SOLID,b,2);else if("esriGeometryPolygon"===a||"esriGeometryEnvelope"===a)b=new q([5,112,176,.2]),c=new q([5,112,176,.8]),c=new v(v.STYLE_SOLID,c,1),d=new f(f.STYLE_SOLID,c,b);d&&this.setRenderer(new w(d))},_makeObjectIdField:function(){var a=1,b,c,f=[];if(!this.objectIdField){b=this.fields.length;for(c=0;c<b;c++)f.push(this.fields[c].name.toLowerCase());for(;-1!==d.indexOf(f,"objectid_"+
a);)a+=1;this.objectIdField="objectid_"+a;this.fields.push({name:"objectid_"+a,type:"esriFieldTypeOID",alias:"objectid_"+a,nullable:!1})}},_featureHasOID:function(a,b){return a.attributes&&(a.attributes[b]||0===a.attributes[b])},_randomIntFromInterval:function(a,b){return Math.floor(Math.random()*(b-a+1)+a)}})})},"esri/layers/StreamTrackManager":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/has ../kernel ../graphic ../geometry/Polyline ./TrackManager".split(" "),function(r,
l,d,q,k,m,p,h){return r([h],{declaredClass:"esri.layers._StreamTrackManager",constructor:function(d){this.inherited(arguments)},initialize:function(d){this.inherited(arguments)},addFeatures:function(e,c){function b(b,c){var d,f,e,g;a[b]||(a[b]=[]);d=a[b];0<n&&(c.length>n&&c.splice(0,c.length-n),e=c.length+d.length,e>n&&(f=d.splice(0,e-n)));e=c.length;for(g=0;g<e;g+=1)d.push(c[g]);return{deletes:f,adds:c}}var a,g,h,n,k={},f={},l;if(c)return this.inherited(arguments),k;a=this.trackMap;g=this.layer;
h=g._trackIdField;n=g.maximumTrackPoints||0;d.forEach(e,function(a){var b=a.attributes[h];a.visible&&(f[b]||(f[b]=[]),f[b].push(a))});for(l in f)f.hasOwnProperty(l)&&(g=b(l,f[l]),k[l]=g);return k},removeFeatures:function(e){var c=[],b=this.layer.objectIdField,a=this.layer._trackIdField;e&&(d.forEach(e,function(e){var g,h,k,f;h=e.attributes[a];g=e.attributes[b];if(k=this.trackMap[h])for(e=0;e<k.length;e+=1)if(f=k[e],f.attributes[b]===g){this.trackMap[h].splice(e,1);-1===d.indexOf(h)&&c.push(h);break}},
this),0<e.length&&this.refreshTracks(c))},drawTracks:function(e){function c(c){var d=g[c],f=d&&1<d.length,e,k,l;(l=b.trackLineMap[c])&&!f&&(a.remove(l),delete b.trackLineMap[c],l=null);if(!f)return!1;f=[];for(e=d.length-1;0<=e;--e)(k=d[e].geometry)&&f.push([k.x,k.y]);d={};d[n]=c;1<f.length&&(l?(c=l.geometry,c.removePath(0),c.addPath(f),l.setGeometry(c)):(l=new m(new p({paths:[f],spatialReference:h}),null,d),a.add(l),b.trackLineMap[c]=l))}var b=this,a=this.container,g,h,n,k;if(a)if(g=this.trackMap,
h=this.map.spatialReference,n=this.layer._trackIdField,e)d.forEach(e,function(a){c(a)});else for(k in g)g.hasOwnProperty(k)&&c(k)},refreshTracks:function(e){function c(c){var d,e;c=b[c]||[];d=c.length;for(e=0;e<d;e++)a._repaint(c[e],null,!0)}var b=this.trackMap,a=this.layer;a._getRenderer();var g;this.drawTracks(e);if(e)d.forEach(e,function(a){c(a)});else for(g in b)b.hasOwnProperty(g)&&c(g)},getLatestObservations:function(){var d,c,b=this.trackMap,a=[];for(d in b)b.hasOwnProperty(d)&&(c=b[d],a.push(c[c.length-
1]));return a},destroy:function(){this.inherited(arguments);this.trackLineMap=null}})})},"esri/layers/PurgeOptions":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/Stateful","dojo/has","../kernel"],function(r,l,d,q,k){return r([d],{declaredClass:"esri.layers.PurgeOptions",constructor:function(d,k){this.parent=d;for(var h in k)this[h]=k[h]},_displayCountSetter:function(d){this.displayCount=d;this.parent.refresh()}})})},"esri/layers/ArcGISImageServiceLayer":function(){define("dojo/_base/declare dojo/_base/lang dojo/has ../kernel ../config ./DynamicMapServiceLayer ./ImageServiceLayerMixin".split(" "),
function(r,l,d,q,k,m,p){return r([m,p],{declaredClass:"esri.layers.ArcGISImageServiceLayer",constructor:function(d,e){this._initialize(d,e);this.useMapImage=e&&e.useMapImage||!1},refresh:function(d){if(d)this.inherited(arguments);else{var e=this.disableClientCaching;this.disableClientCaching=!0;this.inherited(arguments);this.disableClientCaching=e}},setRenderer:function(d,e){this.renderer=d;this.onRendererChange();e||this.refresh(!0)},exportMapImage:function(d,e){var c=k.defaults.map,c=l.mixin({size:c.width+
","+c.height},this._params,d?d.toJson(this.normalization):{},{f:"json"});delete c._ts;this._exportMapImage(this._url.path+"/exportImage",c,e)}})})},"esri/layers/DynamicMapServiceLayer":function(){define("dojo/_base/declare dojo/_base/connect dojo/_base/lang dojo/dom-construct dojo/dom-style dojox/gfx/matrix ../kernel ../config ../sniff ../request ../domUtils ./layer ./MapImage".split(" "),function(r,l,d,q,k,m,p,h,e,c,b,a,g){var u=h.defaults.map.zoomDuration;return r(a,{declaredClass:"esri.layers.DynamicMapServiceLayer",
_eventMap:{"map-image-export":["mapImage"]},constructor:function(a,b){this.useMapTime=b&&b.hasOwnProperty("useMapTime")?!!b.useMapTime:!0;this.extentProcessor=b&&b.extentProcessor;var c=d.hitch;this._exportMapImageHandler=c(this,this._exportMapImageHandler);this._imgSrcFunc=c(this,this._imgSrcFunc);this._divAlphaImageFunc=c(this,this._divAlphaImageFunc);this._tileLoadHandler=c(this,this._tileLoadHandler);this._tileErrorHandler=c(this,this._tileErrorHandler);this.registerConnectEvents()},opacity:1,
isPNG32:!1,_setMap:function(a,b,c){this.inherited(arguments);this._map=a;var d=this._div=q.create("div",null,b),f=p._css.names,g={position:"absolute",width:a.width+"px",height:a.height+"px",overflow:"visible",opacity:this.opacity},h=e("ie"),n=l.connect,m=a.__visibleDelta;8===h&&delete g.opacity;"css-transforms"===a.navigationMode?(this._isChildLayer||(g[f.transform]=p._css.translate(m.x,m.y),k.set(d,g)),this._left=m.x,this._top=m.y):(g.left="0px",g.top="0px",k.set(d,g),this._left=this._top=0);k.set(d,
g);this._onResizeHandler_connect=n(a,"onResize",this,"_onResizeHandler");this._opacityChangeHandler_connect=n(this,"onOpacityChange",this,"_opacityChangeHandler");this._img_loading=null;this._dragOrigin={x:0,y:0};this.evaluateSuspension();if(this.suspended&&!a.loaded)var t=l.connect(a,"onLoad",this,function(){l.disconnect(t);t=null;this.evaluateSuspension()});this.extentProcessor&&(this._panEndEvalHandle=l.connect(a,"onPanEnd",this,this.evaluateSuspension),this._zoomEndEvalHandle=l.connect(a,"onZoomEnd",
this,this.evaluateSuspension));return d},_unsetMap:function(a,b){this._img&&this._clearEventListeners(this._img);this._img_loading&&this._clearEventListeners(this._img_loading);q.destroy(this._div);this._map=this._div=this._img=this._img_loading=null;var c=l.disconnect;c(this._onResizeHandler_connect);c(this._opacityChangeHandler_connect);c(this._panEndEvalHandle);c(this._zoomEndEvalHandle);this._panEndEvalHandle=this._zoomEndEvalHandle=this._onResizeHandler_connect=this._opacityChangeHandler_connect=
null;this._fireUpdateEnd();this._toggleTime();clearTimeout(this._wakeTimer);this._wakeTimer=null;this._disableDrawConnectors();this.inherited(arguments)},_onResizeHandler:function(a,b,c){k.set(this._div,{width:b+"px",height:c+"px"});this._onExtentChangeHandler(a)},onSuspend:function(){this.inherited(arguments);this._fireUpdateEnd();this._toggleTime();b.hide(this._div);clearTimeout(this._wakeTimer);this._wakeTimer=null;this._disableDrawConnectors()},onResume:function(){this.inherited(arguments);var a=
this._map;this._toggleTime();"css-transforms"===a.navigationMode&&(a=a.__visibleDelta,this._left=a.x,this._top=a.y,this._isChildLayer||k.set(this._div,p._css.names.transform,p._css.translate(this._left,this._top)));this._enableDrawConnectors();this._wakeTimer=this._wakeTimer||setTimeout(d.hitch(this,function(){this.suspended||this._onExtentChangeHandler(this._map.extent,null,!0)}),0)},canResume:function(){var a=this.inherited(arguments);if(a){var b=this._map.extent;this.extentProcessor&&b&&(a=!!this.extentProcessor({layer:this,
extent:b,width:this._map.width}).extent)}return a},_enableDrawConnectors:function(){var a=l.connect,b=this._map;b&&(this._onPanHandler_connect=a(b,"onPan",this,"_onPanHandler"),this._onExtentChangeHandler_connect=a(b,"onExtentChange",this,"_onExtentChangeHandler"),"css-transforms"===b.navigationMode?this._onScaleHandler_connect=a(b,"onScale",this,this._onScaleHandler):this._onZoomHandler_connect=a(b,"onZoom",this,"_onZoomHandler"))},_disableDrawConnectors:function(){var a=l.disconnect;a(this._onPanHandler_connect);
a(this._onExtentChangeHandler_connect);a(this._onZoomHandler_connect);a(this._onScaleHandler_connect);this._onPanHandler_connect=this._onExtentChangeHandler_connect=this._onZoomHandler_connect=this._onScaleHandler_connect=null},_toggleTime:function(){var a=this._map;this.timeInfo&&this.useMapTime&&a&&!this.suspended?(this._timeConnect||(this._timeConnect=l.connect(a,"onTimeExtentChange",this,this._onTimeExtentChangeHandler)),this._setTime(a.timeExtent)):(l.disconnect(this._timeConnect),this._timeConnect=
null,this._setTime(null))},_setTime:function(a){this._params&&(this._params.time=a?a.toJson().join(","):null)},_onPanHandler:function(a,b){this._panDx=b.x;this._panDy=b.y;var c=this._dragOrigin,d=this._map.__visibleDelta,e=this._img;e&&("css-transforms"===this._map.navigationMode?(this._left=d.x+b.x,this._top=d.y+b.y,this._isChildLayer||k.set(this._div,p._css.names.transform,p._css.translate(this._left,this._top))):k.set(e,{left:c.x+b.x+"px",top:c.y+b.y+"px"}))},_onExtentChangeHandler:function(a,
b,c){if(!this.suspended){clearTimeout(this._wakeTimer);this._wakeTimer=null;var d=this._map,f=this._img,g=f&&f.style,h=this._dragOrigin;!b||c||!f||b.x===this._panDx&&b.y===this._panDy||("css-transforms"===d.navigationMode?(b=d.__visibleDelta,this._left=b.x,this._top=b.y,this._isChildLayer||k.set(this._div,p._css.names.transform,p._css.translate(this._left,this._top))):k.set(f,{left:h.x+b.x+"px",top:h.y+b.y+"px"}));f?(h.x=parseInt(g.left,10),h.y=parseInt(g.top,10)):h.x=h.y=0;"css-transforms"===d.navigationMode&&
c&&f&&(k.set(f,p._css.names.transition,"none"),f._multiply=f._multiply?m.multiply(f._matrix,f._multiply):f._matrix);this._fireUpdateStart();if(c=this._img_loading)if(this._clearEventListeners(c),q.destroy(c),this._img_loading=null,c=this._jsonRequest){try{c.cancel()}catch(F){}this._jsonRequest=null}var n=d.width;c=d.height;b=n;var t=0;10<=this.version&&d.wrapAround180&&(a=a._normalize(!0));this.extentProcessor&&(t=this.extentProcessor({layer:this,extent:a,width:b}),a=t.extent,b=t.width,t=t.marginLeft||
0);if(this.isPNG32)f=this._img_loading=q.create("div"),f.id=d.id+"_"+this.id+"_"+(new Date).getTime(),k.set(f,{position:"absolute",left:"0px",top:"0px",width:b+"px",height:c+"px"}),d=f.appendChild(q.create("div")),k.set(d,{opacity:0,width:b+"px",height:c+"px"}),this.getImageUrl(a,b,c,this._divAlphaImageFunc),f=null;else{var r=this._img_loading=q.create("img"),C=p._css.names,E=e("ie"),D={position:"absolute",width:b+"px",height:c+"px"};8===E&&(D.opacity=this.opacity);null!=t&&0!==t&&(D.marginLeft=t+
"px");"css-transforms"===d.navigationMode?(D[C.transform]=p._css.translate(-this._left,-this._top),r._tdx=-this._left,r._tdy=-this._top,D[C.transition]=C.transformName+" "+u+"ms ease",this.extentProcessor&&(D[C.origin]=n/2-t+"px "+c/2+"px")):(D.left="0px",D.top="0px");r.id=d.id+"_"+this.id+"_"+(new Date).getTime();k.set(r,D);r._onload_connect=l.connect(r,"onload",this,"_onLoadHandler");r._onerror_connect=l.connect(r,"onerror",this,"_onErrorHandler");r._onabort_connect=l.connect(r,"onabort",this,"_onErrorHandler");
this._startRect={left:h.x,top:h.y,width:f?parseInt(g.width,10):b,height:f?parseInt(g.height,10):c,marginLeft:f?parseInt(g.marginLeft||"0",10):t,zoom:g&&g.zoom?parseFloat(g.zoom):1};this.getImageUrl(a,b,c,this._imgSrcFunc);r=null}}},_onTimeExtentChangeHandler:function(a){this.suspended||(this._setTime(a),this.refresh(!0))},getImageUrl:function(a,b,c,d){},_imgSrcFunc:function(a){this._img_loading.src=a},_divAlphaImageFunc:function(a){k.set(this._img_loading,"filter","progid:DXImageTransform.Microsoft.AlphaImageLoader(src\x3d'"+
a+"', sizingMethod\x3d'scale')");this._onLoadHandler({currentTarget:this._img_loading})},_onLoadHandler:function(a){a=a.currentTarget;var c=this._map;this._clearEventListeners(a);!c||c.__panning||c.__zooming?q.destroy(a):(this._img&&this._div.removeChild(this._img),this._img=a,c=a.style,this._startRect={left:0,top:0,width:parseInt(c.width,10),height:parseInt(c.height,10),marginLeft:parseInt(c.marginLeft||"0",10),zoom:1},this._div.appendChild(a),this.suspended||b.show(this._div),this._img_loading=
null,a=this._dragOrigin,a.x=a.y=0,this.onUpdate());this._fireUpdateEnd()},_onErrorHandler:function(a){a=a.currentTarget;k.set(a,"visibility","hidden");this._clearEventListeners(a);a=Error("Unable to load image: "+a.src);this.onError(a);this._fireUpdateEnd(a)},_clearEventListeners:function(a){l.disconnect(a._onload_connect);l.disconnect(a._onerror_connect);l.disconnect(a._onabort_connect);a._onload_connect=a._onerror_connect=a._onabort_connect=null},setUseMapTime:function(a,b){this.useMapTime=a;this._toggleTime();
b||this.refresh(!0)},refresh:function(){this._map&&this._onExtentChangeHandler(this._map.extent)},_onScaleHandler:function(a,b){var c={},d=p._css.names,e=this._img;if(e){k.set(e,d.transition,b?"none":d.transformName+" "+u+"ms ease");e._matrix=a;a=e._multiply?m.multiply(a,e._multiply):a;if(e._tdx||e._tdy)a=m.multiply(a,{xx:1,xy:0,yx:0,yy:1,dx:e._tdx,dy:e._tdy});c[d.transform]=p._css.matrix(a);k.set(e,c)}},_onZoomHandler:function(a,b,c){a=this._startRect;var d=a.width*b,f=a.height*b,g=a.marginLeft*
b,h=this._img,n=e("ie");h&&(n&&8>n?k.set(h,{left:a.left-(d-a.width)*(c.x-a.left)/a.width+"px",top:a.top-(f-a.height)*(c.y-a.top)/a.height+"px",zoom:b*a.zoom}):k.set(h,{left:a.left-(d-a.width)*(c.x-a.left)/a.width+"px",top:a.top-(f-a.height)*(c.y-a.top)/a.height+"px",width:d+"px",height:f+"px"}),null!=g&&0!==g&&k.set(h,{marginLeft:g+"px"}))},_exportMapImage:function(a,b,d){var e=this._exportMapImageHandler;b.token=this._getToken();c({url:a,content:b,callbackParamName:"callback",load:function(a,b){e(a,
b,d)},error:h.defaults.io.errorHandler})},_exportMapImageHandler:function(a,b,c){a=new g(a);this.onMapImageExport(a);c&&c(a)},onMapImageExport:function(){},setOpacity:function(a){if(this.opacity!=a)this.onOpacityChange(this.opacity=a)},onOpacityChange:function(){},_opacityChangeHandler:function(a){var b=8===e("ie")?this._img:this._div;k.set(b,"opacity",a)}})})},"esri/layers/ArcGISImageServiceVectorLayer":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/connect dojo/_base/json dojo/sniff ../kernel ../lang ./GraphicsLayer ./ImageServiceLayerMixin ../renderers/VectorFieldRenderer ../geometry/Point ../geometry/Extent ../graphic dojox/gfx".split(" "),
function(r,l,d,q,k,m,p,h,e,c,b,a,g,u){return r([h,e],{declaredClass:"esri.layers.ArcGISImageServiceVectorLayer",constructor:function(a,b){this.symbolTileSize=b&&b.symbolTileSize?b.symbolTileSize:50;this._maxMag=this._minMag=null;var d=l.clone(this._params);delete d.imageServiceParameters;delete d.pixelFilter;delete d.rendererStyle;delete d.symbolTileSize;this._initialize(a,b);this.renderer||this.setVectorRendererStyle(b&&b.rendererStyle?b.rendererStyle:c.STYLE_SINGLE_ARROW);this.geometryType="esriGeometryPoint";
this.symbolTileSizeUnits="Pixels";l.mixin(this._params,d)},getField:function(a){return this._getField(a,!0)},setVectorRendererStyle:function(a){this.rendererStyle=a;this._updateVectorFieldRenderer();this.useDefaultRenderer=!0},setRenderer:function(){this.useDefaultRenderer=!1;this.inherited(arguments)},getFlowRepresentation:function(){return this._vectorFlowRepresentation},onResume:function(){this.inherited(arguments);this._toggleTime()},onSuspend:function(){this.inherited(arguments);this._toggleTime()},
_refresh:function(a){if(10>k("ie"))this.onError(Error("Unable to refresh. This layer is not supported in the current browser."));else if(!1===this.hasMultidimensions)this.onError(Error("Unable to refresh. This layer does not have multi-dimensional info."));else{this.setImageFormat("LERC",!0);a=this.fullExtent&&this.fullExtent.xmin;var b=this.fullExtent&&this.fullExtent.ymax,c=l.clone(this._map.extent),d=1/this.symbolTileSize*this._map.width,d=d?Math.ceil(d):50,e=1/this.symbolTileSize*this._map.height,
e=e?Math.ceil(e):Math.ceil((c.ymax-c.ymin)/(c.xmax-c.xmin)*d),g=(c.xmax-c.xmin)/d,h=(c.ymax-c.ymin)/e;c.xmin=a+Math.floor((c.xmin-a)/g)*g;c.xmax=a+Math.ceil((c.xmax-a)/g)*g;c.ymin=b+Math.floor((c.ymin-b)/h)*h;c.ymax=b+Math.ceil((c.ymax-b)/h)*h;this._requestData(c,d,e)}},_drawPixelData:function(){this.clear();if(this.pixelData){var c=this.pixelData.pixelBlock,d=this.pixelData.extent,e=this.pixelData.locations,h=p.isDefined(c.mask)&&0<c.mask.length;if(c&&d&&e){if(this.useDefaultRenderer&&this.renderer&&
(!p.isDefined(this._minMag)||!p.isDefined(this._maxMag))){var k=this._getServiceMinMaxStats();k?(this._minMag=k.min,this._maxMag=k.max):(this._minMag=c.statistics[0].minValue,this._maxMag=c.statistics[0].maxValue);var k={type:"sizeInfo",minSize:u.px2pt(.2*this.symbolTileSize),maxSize:u.px2pt(.8*this.symbolTileSize),minDataValue:this._minMag,maxDataValue:this._maxMag},l=[];l.push(k);l.push({type:"colorInfo"});this.renderer.setVisualVariables(l)}for(var m=l=k=0,r,y=d.spatialReference?d.spatialReference._getInfo():
null,k=0;k<c.height;k++)for(l=0;l<c.width;l++,m++)if(r=e[m],(!h||c.mask[m])&&r&&2===r.length){r=new b(r[0],r[1],d.spatialReference);y&&(r.x=a.prototype._normalizeX(r.x,y).x);var B={Magnitude:c.pixels[0][m],Direction:c.pixels[1][m],Location:q.toJson(r.toJson())};r=new g(r,null,B);this.add(r)}}}},_getServiceMinMaxStats:function(){if(!p.isDefined(this.minValues)||!p.isDefined(this.maxValues)||2>this.minValues.length||2>this.maxValues.length)return null;var a=this.minValues[0],b=this.maxValues[0],c=this.minValues[1],
d=this.maxValues[1];if(this.pixelFilter&&a&&b&&c&&d){var e=[];e.push([a,b]);e.push([c,d]);c=this._createPixelData(e);this.pixelFilter(c);c&&c.pixelBlock&&c.pixelBlock.pixels&&0<c.pixelBlock.pixels.length&&(a=c.pixelBlock.pixels[0][0],b=c.pixelBlock.pixels[0][1])}return a&&b?{min:a,max:b}:null},_updateVectorFieldRenderer:function(){var a={type:"sizeInfo",minSize:u.px2pt(.2*this.symbolTileSize),maxSize:u.px2pt(.8*this.symbolTileSize),minDataValue:this._minMag,maxDataValue:this._maxMag},b=[];b.push(a);
a=new c({style:this.rendererStyle,visualVariables:b,flowRepresentation:this._vectorFlowRepresentation});this.setRenderer(a)},_getField:function(a,b){if(p.isDefined(a))return b&&(a=a.toLowerCase()),"magnitude"!==a&&"direction"!==a?null:{name:a,alias:a,domain:null,editable:!1,length:50,type:"esriFieldTypeDouble"}},_requestDataErrorHandler:function(a){"CancelError"!==a.name&&(this.clear(),this.onError(a))},_setFlowRepresentation:function(a){a&&this.renderer&&p.isDefined(a.FlowDirection)&&(this._vectorFlowRepresentation=
"oceanographic"===a.FlowDirection.toLowerCase()?this.renderer.FLOW_TO:this.renderer.FLOW_FROM);this.renderer&&(this.renderer.flowRepresentation=this._vectorFlowRepresentation)}})})},"jimu/LayerInfos/LayerInfoForDefaultTile":function(){define(["dojo/_base/declare","./LayerInfoForDefaultService"],function(r,l){return r(l,{constructor:function(d,l){this.noLegend=!0},getExtent:function(){},_initVisible:function(){},_setTopLayerVisible:function(d){},setLayerVisiblefromTopLayer:function(){},getOpacity:function(){},
setOpacity:function(d){},isShowInMap:function(){return this.originOperLayer.mapService.layerInfo.layerObject.visible}})})},"jimu/LayerInfos/LayerInfoForDefaultTable":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/html dojo/Deferred dojo/aspect ./LayerInfoForDefault ./LayerObjectFacory esri/dijit/PopupTemplate".split(" "),function(r,l,d,q,k,m,p,h){return r(m,{isTable:null,_layerObjectFacory:null,constructor:function(){this.newSubLayers=[];this.isTable=!0;this._layerObjectFacory=new p(this)},
init:function(){},_getLayerObject:function(){var d=new q;this._layerObjectFacory.getLayerObject().then(l.hitch(this,function(c){this.layerObject.empty&&c&&(this.layerObject=c);d.resolve(c)}));return d},getLayerObject:function(){return this._getLayerObject()},getLayerType:function(){var d=new q;d.resolve("Table");return d},isVisible:function(){return!1},isLeaf:function(){return!0},isRootLayer:function(){return!1},createLegendsNode:function(){return d.create("div",{"class":"legends-div"})},_initControlPopup:function(){this.inherited(arguments);
this.controlPopupInfo={enablePopup:this.originOperLayer.popupInfo?!0:!1,infoTemplate:this.originOperLayer.popupInfo?new h(this.originOperLayer.popupInfo):null}},_bindEventAfterLayerObjectLoaded:function(){var d=k.after(this.layerObject,"setDefinitionExpression",l.hitch(this,this._onFilterChanged));this._eventHandles.push(d)},getFilter:function(){return this.layerObject&&!this.layerObject.empty&&this.layerObject.getDefinitionExpression?this.layerObject.getDefinitionExpression():this.getFilterOfWebmap()},
setFilter:function(){var d=arguments;return this.getLayerObject().then(l.hitch(this,function(){this.inherited(d)}))}})})},"jimu/LayerInfos/LayerInfoForDefaultImage":function(){define("dojo/_base/declare dojo/dom-construct dojo/_base/array dojo/_base/lang dojo/Deferred dojo/promise/all dojo/aspect esri/request ./LayerInfoForDefault".split(" "),function(r,l,d,q,k,m,p,h,e){return r(e,{constructor:function(){this._addImageServiceLayerType()},_addImageServiceLayerType:function(){this.layerObject.type=
!this.layerObject.serviceDataType||"esriImageServiceDataTypeVector-UV"!==this.layerObject.serviceDataType&&"esriImageServiceDataTypeVector-MagDir"!==this.layerObject.serviceDataType?"ArcGISImageServiceLayer":"ArcGISImageServiceVectorLayer"},_initLegendsNode:function(c){10.2<=this.layerObject.version?this._legendRequestServer().then(q.hitch(this,function(b){l.empty(c);d.forEach(b.layers,function(a){d.forEach(a.legend,function(a){if("\x3call other values\x3e"!==a.label){var b=l.create("div",{"class":"legend-div"},
c),d=l.create("div",{"class":"legend-symbol jimu-float-leading",style:"width:50px;height:50px;position:relative"},b),e=null,e=a.imageData?"data:"+a.contentType+";base64,"+a.imageData:a.url;l.create("img",{"class":"legend-symbol-image",style:"overflow:auto;margin:auto;position:absolute;top:0;left:0;bottom:0;right:0",src:e},d);l.create("div",{"class":"legend-label jimu-float-leading",innerHTML:a.label||" "},b)}},this)},this)}),q.hitch(this,function(){l.empty(c)})):l.empty(c)},_legendRequestServer:function(){var c=
this.layerObject.url+"/legend",b={f:"json"};this.layerObject._params.bandIds&&(b.bandIds=this.layerObject._params.bandIds);this.layerObject._params.renderingRule&&(b.renderingRule=this.layerObject._params.renderingRule);return h({url:c,content:b,handleAs:"json",callbackParamName:"callback"})},getSupportTableInfo:function(){var c=new k,b={isSupportedLayer:!1,isSupportQuery:!1,layerType:null},a=this.getLayerType(),d=this.getLayerObject();m({type:a,layerObject:d}).then(q.hitch(this,function(a){var d=
a.type;a=a.layerObject;b.layerType=d;0<=this._getLayerTypesOfSupportTable().indexOf(d)&&(b.isSupportedLayer=!0);a.capabilities&&0<=a.capabilities.indexOf("Catalog")?b.isSupportQuery=!0:b.isSupportedLayer=!1;c.resolve(b)}),function(){c.resolve(b)});return c},_getServiceDefinition:function(){var c=this.getUrl();return this._serviceDefinitionBuffer.getRequest(this.subId).request(c)},_bindEvent:function(){var c;this.inherited(arguments);this.layerObject&&!this.layerObject.empty&&(c=p.after(this.layerObject,
"setRenderingRule",q.hitch(this,this._onRendererChanged)),this._eventHandles.push(c))}})})},"jimu/LayerInfos/LayerInfoForDefaultStream":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/Deferred","dojo/promise/all","./LayerInfoForDefault"],function(r,l,d,q,k){return r(k,{getSupportTableInfo:function(){var k=new d,p={isSupportedLayer:!1,isSupportQuery:!0,layerType:null,otherReasonCanNotSupport:!0},h=this.getLayerType(),e=this.getLayerObject();q({type:h,layerObject:e}).then(l.hitch(this,
function(c){var b=c.type;c=c.layerObject;p.layerType=b;0<=this._getLayerTypesOfSupportTable().indexOf(b)&&(p.isSupportedLayer=!0);(b=c.getLatestObservations())&&0<b.length&&(p.otherReasonCanNotSupport=!1);k.resolve(p)}),function(){k.resolve(p)});return k}})})},"jimu/Query":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/promise/all dojo/Deferred jimu/utils jimu/ServiceDefinitionManager esri/tasks/query esri/tasks/QueryTask".split(" "),function(r,l,d,q,k,m,p,h,e){var c=
r(null,{queryType:0,nextPageIndex:1,pageSizeOption:null,layerDefinition:null,layerDefinitionDef:null,type1CountDef:null,type2ObjectIdsDef:null,type3QueryDef:null,sdf:null,url:null,query:null,pageSize:1E3,constructor:function(b){this.sdf=p.getInstance();this.url=b.url;this.query=b.query;this.pageSizeOption=b.pageSize;this.query.outFields&&0!==this.query.outFields.length||(this.query.outFields=["*"]);this.pageSize=0<b.pageSize?b.pageSize:1E3;this.getFeatureCount()},getFeatureCount:function(){return this._getQueryType().then(l.hitch(this,
function(b){return 1===b?this._getCountForQueryType1():2===b?this._getCountForQueryType2():this._getCountForQueryType3()}))},getPageCount:function(){return this.getFeatureCount().then(l.hitch(this,function(b){return 0===b?0:3===this.queryType?1:Math.ceil(b/this.pageSize)}))},getAllFeatures:function(){return this.getPageCount().then(l.hitch(this,function(b){if(0<b){for(var a=[],c=1;c<=b;c++)a.push(this.queryByPage(c));return q(a).then(l.hitch(this,function(a){for(var b=[],c=0;c<a.length;c++)a[c].features&&
0<a[c].features.length&&(b=b.concat(a[c].features));a=a[0];a.features=b;return a}))}return null}))},getCurrentPageIndex:function(){return this.nextPageIndex},queryNextPage:function(){var b=this.nextPageIndex;this.nextPageIndex++;return this.queryByPage(b)},queryByPage:function(b){var a=null;0>=b?(a=new k,a.resolve(null)):a=this.getPageCount().then(l.hitch(this,function(a){return b>a?null:1===this.queryType?this._queryPageForType1(b):2===this.queryType?this._queryPageForType2(b):this._queryPageForType3(b)}));
return a},_getQueryType:function(){var b=new k;if(0<this.queryType)b.resolve(this.queryType);else return this._getLayerDefinition().then(l.hitch(this,function(a){return this.queryType=c.getQueryType(a)}));return b},_getDefStatus:function(b){return b?b.isFulfilled()?b.isResolved()?2:-1:1:0},_getLayerDefinition:function(){0>=this._getDefStatus(this.layerDefinitionDef)&&(this.layerDefinitionDef=this.sdf.getServiceDefinition(this.url).then(l.hitch(this,function(b){this.layerDefinition=b;var a=b.maxRecordCount;
0<a&&(!(0<this.pageSizeOption)||this.pageSize>b.maxRecordCount)&&(this.pageSize=a);return this.layerDefinition})));return this.layerDefinitionDef},_getCountForQueryType1:function(){0>=this._getDefStatus(this.type1CountDef)&&(this.type1CountDef=this._queryCount());return this.type1CountDef},_getCountForQueryType2:function(){return this._getObjectIdsForQueryType2().then(l.hitch(this,function(b){return b.length}))},_getObjectIdsForQueryType2:function(){0>=this._getDefStatus(this.type2ObjectIdsDef)&&
(this.type2ObjectIdsDef=this._queryIds());return this.type2ObjectIdsDef},_getCountForQueryType3:function(){return this._doQueryForQueryType3().then(l.hitch(this,function(b){return(b.features||[]).length}))},_doQueryForQueryType3:function(){0>=this._getDefStatus(this.type3QueryDef)&&(this.type3QueryDef=this._query());return this.type3QueryDef},_queryPageForType1:function(b){return this._queryWithPaginationAndOrder((b-1)*this.pageSize)},_queryPageForType2:function(b){return this._getObjectIdsForQueryType2().then(l.hitch(this,
function(a){var c=(b-1)*this.pageSize;a=a.slice(c,c+this.pageSize);return this._queryByObjectIds(a)}))},_queryPageForType3:function(b){return this._doQueryForQueryType3().then(l.hitch(this,function(a){var c=l.mixin({},a);c.features=[];var d=(b-1)*this.pageSize;c.features=(a.features||[]).slice(d,d+this.pageSize);return c}))},_tryLocaleNumber:function(b){var a=m.localizeNumber(b);if(null===a||void 0===a)a=b;return a},_tryLocaleDate:function(b){var a=m.localizeDate(b);a||(a=b.toLocaleDateString());
return a},_getLayerIndexByLayerUrl:function(b){var a=b.lastIndexOf("/");b=b.slice(a+1,b.length);return parseInt(b,10)},_getServiceUrlByLayerUrl:function(b){var a=b.lastIndexOf("/");return b.slice(0,a)},_isImageServiceLayer:function(b){return-1<b.indexOf("/ImageServer")},_isTable:function(b){return"Table"===b.type},_getObjectIdField:function(){return this.layerDefinition.objectIdField},_query:function(b){var a=new h;a.where=b||this.query.where;a.geometry=this.query.geometry;a.outSpatialReference=this.map.spatialReference;
a.returnGeometry=this.query.returnGeometry;a.spatialRelationship=this.query.spatialRelationship;a.outFields=this.query.outFields;return(new e(this.url)).execute(a)},_queryIds:function(){var b=new h;b.where=this.query.where;b.geometry=this.query.geometry;b.returnGeometry=!1;b.spatialRelationship=this.query.spatialRelationship;b.outSpatialReference=this.query.outSpatialReference;return(new e(this.url)).executeForIds(b).then(l.hitch(this,function(a){a||(a=[]);return a}))},_queryByObjectIds:function(b){var a=
new k,c=new h;c.returnGeometry=this.query.returnGeometry;c.outSpatialReference=this.query.outSpatialReference;c.spatialRelationship=this.query.spatialRelationship;c.outFields=this.query.outFields;c.objectIds=b;(new e(this.url)).execute(c).then(l.hitch(this,function(b){a.resolve(b)}),l.hitch(this,function(c){if(400===c.code){var e=this._getObjectIdField(),g="",f=b.length;d.forEach(b,l.hitch(this,function(a,b){g+=e+" \x3d "+a;b!==f-1&&(g+=" OR ")}));this._query(g).then(l.hitch(this,function(b){a.resolve(b)}),
l.hitch(this,function(b){a.reject(b)}))}else a.reject(c)}));return a},_queryCount:function(){var b=new h;b.where=this.query.where;b.geometry=this.query.geometry;b.outSpatialReference=this.query.outSpatialReference;b.spatialRelationship=this.query.spatialRelationship;b.returnGeometry=!1;return(new e(this.url)).executeForCount(b)},_queryWithPaginationAndOrder:function(b){var a=new h;a.where=this.query.where;a.geometry=this.query.geometry;a.outSpatialReference=this.query.outSpatialReference;a.returnGeometry=
this.query.returnGeometry;a.spatialRelationship=this.query.spatialRelationship;a.outFields=this.query.outFields;a.start=b;a.num=this.pageSize;(b=this.query.orderByFields)&&0<b.length&&(a.orderByFields=b,b=d.map(b,l.hitch(this,function(a){return a.split(" ")[0]})),d.forEach(b,l.hitch(this,function(b){0>a.outFields.indexOf(b)&&a.outFields.push(b)})));return(new e(this.url)).execute(a)}});c._isServiceSupportsOrderBy=function(b){var a=!1;b.advancedQueryCapabilities&&b.advancedQueryCapabilities.supportsOrderBy&&
(a=!0);return a};c._isServiceSupportsPagination=function(b){var a=!1;b.advancedQueryCapabilities&&b.advancedQueryCapabilities.supportsPagination&&(a=!0);return a};c._isSupportObjectIds=function(b){var a=0;b.currentVersion&&(a=parseFloat(b.currentVersion));return 10<=a||b.hasOwnProperty("typeIdField")};c.getQueryType=function(b){var a=-1;return a=c._isServiceSupportsOrderBy(b)&&c._isServiceSupportsPagination(b)?1:c._isSupportObjectIds(b)?2:3};return c})},"jimu/ServiceDefinitionManager":function(){define(["dojo/_base/declare",
"esri/request"],function(r,l){var d=null,q=r(null,{cache:{},getServiceDefinition:function(d,m){m||(m="json");var k=this.cache[d];0>=this._getDefStatus(k)&&(k=l({url:d,handleAs:m,content:{f:m},callbackParamName:"callback"}),this.cache[d]=k);return k},_getDefStatus:function(d){return d?d.isFulfilled()?d.isResolved()?2:-1:1:0}});q.getInstance=function(){d||(d=new q,window._serviceDefinitionManager=d);return d};return q})},"builder/tokenUtils":function(){define(["jimu/tokenUtils"],function(r){return r})},
"builder/utils":function(){define(["dojo/request/xhr","dojo/cookie","jimu/portalUrlUtils","jimu/utils"],function(r,l,d,q){return{appendParamsToAppPath:function(d,l){var k=d,h;for(h in l)l.hasOwnProperty(h)&&(k=0>k.indexOf("?")?k+"?"+h+"\x3d"+l[h]:k+"\x26"+h+"\x3d"+l[h]);return k},removeActionFromUrl:function(d){return q.url.removeQueryParamFromUrl(d,"action")},checkProtocolAndUpdateSigninInfo:function(k,m){var p=m.portalUrl,h=p,e="https"===d.getProtocol(p),c=!!k.allSSL;e!==c&&c&&(h=d.setHttpsProtocol(p));
m.portalUrl=h;return r("/webappbuilder/rest/signininfo/setsignininfo",{handleAs:"json",data:m,method:"POST"}).then(function(b){b.success&&(l("wab_portalurl",h,{path:"/webappbuilder"}),l("wab_portalurl",h,{path:"/webappviewer"}),l("wab_portalurl_persistent",h,{path:"/",expires:365}));return b})}}})},"builder/PluginManager":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/html dojo/Deferred dojo/Evented dojo/aspect dojo/promise/all jimu/utils".split(" "),function(r,
l,d,q,k,m,p,h,e){var c=null,b=r(m,{constructor:function(a){this.loaded=[];a&&(this.pluginsMeta=a)},loadPlugin:function(a){var b=new k,c;a=l.clone(a);if(c=this.getPluginByName(a.name))b.resolve(c);else{if(!1===a.properties.hasClass)return c={name:a.name},this.loaded.push(c),b.resolve(c),b;this.loadPluginClass(a).then(l.hitch(this,function(c){this.loadPluginResources(a).then(l.hitch(this,function(d){try{var e=this.createPlugin(a,c,d)}catch(v){console.log("create ["+a.uri+"] error:"+v.stack),b.reject(v)}setTimeout(l.hitch(this,
function(){b.resolve(e);this.emit("pluginCreated",e)}),50)}),function(a){b.reject(a)})}),function(a){b.reject(a)})}return b},getExtensions:function(a){var b=[],c;for(c in this.pluginsMeta)for(var d=this.pluginsMeta[c],e=0;e<d.extensions.length;e++){var f=d.extensions[e];f.point===a&&b.push(f)}return b},getStemappInfo:function(a){for(var b=this.getExtensions("startup.stemapps"),c={},d=0;d<b.length;d++){var e=b[d];if(e.parameters.appType===a){var f=this.pluginsMeta[e.pluginName];c.appPath=e.parameters.appPath?
f.folderUrl+e.parameters.appPath:f.folderUrl;c.appVersionManager=e.parameters.appVersionManager;c.appType=a;c.thumbnail=c.appPath+"images/thumbnail.png"}}return c},loadPluginClass:function(a){var b=new k;require([a.uri],l.hitch(this,function(a){b.resolve(a)}));return b},loadPluginResources:function(a){var b=new k,c,d,e=[];c=this.loadPluginI18n(a);d=this.loadPluginStyle(a);a=this.loadPluginTemplate(a);e.push(c);e.push(a);e.push(d);h(e).then(l.hitch(this,function(a){var c={};c.i18n=a[0];c.template=
a[1];c.style=a[2];b.resolve(c)}),function(a){b.reject(a)});return b},createPlugin:function(a,b,c){if(this.getPluginByName(a.name))return this.getPluginByName(a.name);a.nls=c.i18n||{};c.template&&(a.templateString=c.template);a["class"]="builder-plugin";a.pluginsMeta=this.pluginsMeta;a.pluginManager=this;a=new b(a);p.before(a,"destroy",l.hitch(this,this._onDestroyPlugin,a));this.loaded.push(a);return a},getAllPlugins:function(){return this.loaded},destroyAllPlugins:function(){var a=d.map(this.loaded,
function(a){return a.id});d.forEach(a,function(a){this.destroyPlugin(a)},this);this.loaded=[]},getPluginByName:function(a){var b;d.some(this.loaded,function(c){if(c.name===a)return b=c,!0},this);return b},loadPluginStyle:function(a){var b="plugin/style/"+a.uri,c=new k;if(!1===a.properties.hasStyle)return c.resolve(null),c;b=this._replaceId(b);return q.byId(b)?(c.resolve("load"),c):e.loadStyleLink(b,a.amdFolder+"css/style.css")},loadPluginI18n:function(a){var b=new k;if(!1===a.properties.hasLocale)return b.resolve(null),
b;require(["dojo/i18n!"+a.amdFolder+"nls/strings"],function(a){b.resolve(a)});return b},loadPluginTemplate:function(a){var b=new k;if(!1===a.properties.hasUIFile)return b.resolve(null),b;require(["dojo/text!"+a.amdFolder+"Plugin.html"],function(a){b.resolve(a)});return b},removePluginStyle:function(a){q.destroy(this._replaceId("plugin/style/"+a.uri))},_remove:function(a){return d.some(this.loaded,function(b,c){if(b.id===a)return this.loaded.splice(c,1),!0},this)},_replaceId:function(a){return a.replace(/\//g,
"_").replace(/\./g,"_")},_onDestroyPlugin:function(a){"closed"!==a.state&&this.closePlugin(a);this._removePlugin(a)},_removePlugin:function(a){if("string"===typeof a&&(a=this.getPluginByName(a),!a))return;this.removePluginStyle(a);this._remove(a.id)}});b.getInstance=function(a){null===c?c=new b(a):a&&(c.pluginsMeta=a);return c};return b})},"builder/plugins/_build-generate_plugins_module":function(){define("builder/plugins/app-actions/launch-app/_build-generate_module builder/plugins/app-actions/preview-app/_build-generate_module builder/plugins/app-actions/save-app/_build-generate_module builder/plugins/app-actions/to-template-config/_build-generate_module builder/plugins/app-config/_build-generate_module builder/plugins/app-config-configpart/_build-generate_module builder/plugins/app-config-morepreview-selectionpart/_build-generate_module builder/plugins/app-config-template-configpart/_build-generate_module builder/plugins/app-config-templateconfig/_build-generate_module builder/plugins/app-list/_build-generate_module builder/plugins/attribute-config/_build-generate_module builder/plugins/creation-entry/_build-generate_module builder/plugins/header/_build-generate_module builder/plugins/map-config/_build-generate_module builder/plugins/popup-actions/configmode-switch/_build-generate_module builder/plugins/popup-actions/popup-agoltemplate/_build-generate_module builder/plugins/popup-actions/popup-saveas/_build-generate_module builder/plugins/popup-actions/popup-share/_build-generate_module builder/plugins/startup/_build-generate_module builder/plugins/stemapps/web2d/_build-generate_module builder/plugins/stemapps/web3d/_build-generate_module builder/plugins/theme-config/_build-generate_module builder/plugins/widget-config/_build-generate_module".split(" "),
function(){})},"builder/plugins/app-actions/launch-app/_build-generate_module":function(){define(["builder/plugins/app-actions/launch-app/Plugin","dojo/text!builder/plugins/app-actions/launch-app/css/style.css","dojo/i18n!builder/plugins/app-actions/launch-app/nls/strings"],function(){})},"builder/plugins/app-actions/launch-app/Plugin":function(){define("dojo/_base/declare dojo/_base/lang dojo/on dojo/topic builder/BasePlugin dojo/_base/html jimu/portalUrlUtils jimu/utils builder/utils".split(" "),
function(r,l,d,q,k,m,p,h,e){return r([k],{baseClass:"plugin-app-actions-launch-app",postCreate:function(){this.inherited(arguments);var c;if(window.isXT)c=window.appInfo.appPath;else{var b=h.urlToObject(window.location.href).query||{};c="HTML3D"===window.appInfo.appType?"webappviewer3d":"webappviewer";var a=window.appInfo.id;"HTML"===a?a="stemapp":"HTML3D"===a&&(a="stemapp3d");c=b.appid?window.portalUrl+"apps/"+c+"/index.html?appid\x3d"+a:window.portalUrl+"apps/"+c+"/index.html?id\x3d"+a;delete b.id;
delete b.appid;delete b.apiurl;delete b.apiurl3d;delete b.edit;delete b.folderid;c=e.appendParamsToAppPath(c,b)}b=m.create("a",{href:c,target:"_blank"},this.domNode);m.create("div",{"class":"footer-button",title:this.nls.label,innerHTML:this.nls.label},b);this._bindEvent()},_bindEvent:function(){this.own(q.subscribe("app/appConfigLoaded",l.hitch(this,this._setAppConfig)));this.own(q.subscribe("app/appConfigChanged",l.hitch(this,this._setAppConfig)))},_setAppConfig:function(c){this.appConfig=c;this.visible=
!c.templateConfig||c.isTemplateApp||c._appData?!0:!1}})})},"builder/BasePlugin":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/topic dijit/_WidgetBase dijit/_TemplatedMixin".split(" "),function(r,l,d,q,k,m){return r([k,m],{id:void 0,folderUrl:null,state:"closed",windowState:"normal",started:!1,name:"",baseClass:null,templateString:"\x3cdiv\x3e\x3c/div\x3e",constructor:function(){this.extensions={};this.own(q.subscribe("publishData",l.hitch(this,this._onReceiveData)));
this.own(q.subscribe("dataFetched",l.hitch(this,this._onReceiveData)));this.own(q.subscribe("noData",l.hitch(this,this._onNoData)))},getPluginsMetaByExtensionPoint:function(k){var h=[];d.forEach(this.extensionPoints[k].extensions,function(d){h.push(this.pluginsMeta[d.pluginName])},this);return h},filterExtensionsByAppType:function(k,h){if(!this.extensionPoints[k].parameters||!this.extensionPoints[k].parameters.supportAppTypes)return this.extensionPoints[k].extensions;var e=[];d.forEach(this.extensionPoints[k].extensions,
function(c){("all"===c.parameters.supportAppTypes||-1<c.parameters.supportAppTypes.indexOf(h))&&e.push(c)},this);return e},onOpen:function(){},onClose:function(){},onNormalize:function(){},onMinimize:function(){},onMaximize:function(){},onSignIn:function(d){},onSignOut:function(){},setState:function(d){this.state=d},setWindowState:function(d){this.windowState=d},resize:function(){},publishData:function(d,h){"undefined"===typeof h&&(h=!1);q.publish("publishData",this.name,this.id,d,h)},fetchData:function(k){k?
q.publish("fetchData",k):0!==this.listenWidgetIds.length?d.forEach(this.listenWidgetIds,function(d){q.publish("fetchData",d)},this):q.publish("fetchData")},fetchDataByName:function(k){k=this.widgetManager.getWidgetsByName(k);d.forEach(k,function(d){this.fetchData(d.id)},this)},_onReceiveData:function(d,h,e,c){if(h!==this.id&&!(0!==this.listenWidgetIds.length&&0>this.listenWidgetIds.indexOf(h)))this.onReceiveData(d,h,e,c)},onReceiveData:function(d,h,e,c){},_onNoData:function(d,h){if(!(0!==this.listenWidgetIds.length&&
0>this.listenWidgetIds.indexOf(h)))this.onNoData(d,h)},onNoData:function(d,h){}})})},"builder/plugins/app-actions/preview-app/_build-generate_module":function(){define(["builder/plugins/app-actions/preview-app/Plugin","dojo/text!builder/plugins/app-actions/preview-app/Plugin.html","dojo/text!builder/plugins/app-actions/preview-app/css/style.css","dojo/i18n!builder/plugins/app-actions/preview-app/nls/strings"],function(){})},"builder/plugins/app-actions/preview-app/Plugin":function(){define("dojo/_base/declare dojo/_base/lang builder/BasePlugin dojo/_base/html dojo/on dojo/topic".split(" "),
function(r,l,d,q,k,m){return r([d],{baseClass:"plugin-app-actions-preview-app",postCreate:function(){this.inherited(arguments);this.own(k(this.domNode,"click",l.hitch(this,this._onClick)));this._bindEvent();this.mode="config"},_onClick:function(){var d=this.pluginManager.getPluginByName("app-config"),h=this.pluginManager.getPluginByName("popup-actions.configmode-switch");"none"===q.getStyle(this.btnConfig,"display")?(d.switchToPreviewMore(),h.visible=!1,q.setStyle(this.btnPreview,"display","none"),
q.setStyle(this.btnConfig,"display","inline-block"),this.mode="preview"):(h.visible=this.appConfig.templateConfig&&this.appConfig.isTemplateApp||this.appConfig.templateConfig&&this.appConfig._appData?!0:!1,h.isAdvance?d.switchToPreviewConfig():d.switchToTemplateConfigPart(),q.setStyle(this.btnPreview,"display","inline-block"),q.setStyle(this.btnConfig,"display","none"),this.mode="config")},_bindEvent:function(){this.own(m.subscribe("app/appConfigLoaded",l.hitch(this,this._setAppConfig)));this.own(m.subscribe("app/appConfigChanged",
l.hitch(this,this._setAppConfig)))},_setAppConfig:function(d){this.appConfig=d}})})},"builder/plugins/app-actions/save-app/_build-generate_module":function(){define(["builder/plugins/app-actions/save-app/Plugin","dojo/text!builder/plugins/app-actions/save-app/Plugin.html","dojo/text!builder/plugins/app-actions/save-app/css/style.css","dojo/i18n!builder/plugins/app-actions/save-app/nls/strings"],function(){})},"builder/plugins/app-actions/save-app/Plugin":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/html dojo/topic dojo/Deferred dojo/on dojo/promise/all jimu/utils jimu/dijit/Message jimu/dijit/Popup builder/BasePlugin builder/serviceUtils jimu/portalUrlUtils builder/portalUtils".split(" "),
function(r,l,d,q,k,m,p,h,e,c,b,a,g,u){return r([b],{baseClass:"plugin-app-actions-save-app",lastAppConfig:null,disabled:null,boxNodeOfMainAppActionPlugin:null,boxNodeOfSaveAppPluginInConfigTemplatePage:null,_user:null,_itemGroups:null,postMixInProperties:function(){this.inherited(arguments);this.nls=l.mixin(this.nls,builderNls)},postCreate:function(){this.inherited(arguments);var b=g.getStandardPortalUrl(window.portalUrl),c=u.getPortal(b);"HTML"===window.appInfo.id||"HTML3D"===window.appInfo.id?this._blockSaveButton():
(b=c.getUser(),window.isXT?(c=new k,c.resolve()):c=c.getItemById(window.appInfo.id).then(l.hitch(this,function(a){return a.getItemGroups()})),p({user:b,itemGroups:c}).then(l.hitch(this,function(b){this._user=b.user;this._itemGroups=b.itemGroups;a.canSaveApp(this._user,window.appInfo.appOwner,this._itemGroups)||this._blockSaveButton()}),l.hitch(this,function(a){this._blockSaveButton();console.log(a)})));this.own(q.subscribe("app/appConfigChanged",l.hitch(this,this._onAppConfigChanged)));this.own(q.subscribe("app/appConfigLoaded",
l.hitch(this,this._onAppConfigLoaded)));this.own(q.subscribe("closeAppConfigPage",l.hitch(this,this._onLeavePage)));this.own(m(this.domNode,"click",l.hitch(this,this._onClick)));this.label=this.nls.label},_onClick:function(){this.saveApp()},_enableSaveButton:function(){d.addClass(this.actionNode,"save-enable");d.removeClass(this.actionNode,"save-disabled");d.setStyle(this.domNode,"cursor","pointer");d.setAttr(this.actionNode,"innerHTML",this.nls.save);d.setAttr(this.actionNode,"title",this.nls.save);
this.disabled=!1},_disableSaveButton:function(){d.removeClass(this.actionNode,"save-enable");d.addClass(this.actionNode,"save-disabled");d.setStyle(this.domNode,"cursor","default");d.setAttr(this.actionNode,"innerHTML",this.nls.saved);d.setAttr(this.actionNode,"title",this.nls.saved);this.disabled=!0},_blockSaveButton:function(){d.addClass(this.actionNode,"save-block");d.setStyle(this.domNode,"cursor","default")},_onAppConfigLoaded:function(a){this.lastAppConfig=l.clone(a);this._setAppConfig(a)},
_onAppConfigChanged:function(a){this.lastAppConfig||(this.lastAppConfig=l.clone(a));this._setAppConfig(a)},_setAppConfig:function(a){this.appConfig=l.clone(a);this._appHasChanged()?(this._enableSaveButton(),this._enableUnloadDlg()):(this._disableSaveButton(),this._disableUnloadDlg())},_appHasChanged:function(){if(!a.canSaveApp(this._user,window.appInfo.appOwner,this._itemGroups)||!this.appConfig)return!1;var b=l.clone(this.appConfig.getCleanConfig()),c=l.clone(this.lastAppConfig.getCleanConfig());
b.theme&&b.theme.styles&&c.theme&&c.theme.styles&&(b.theme.styles.splice(1,b.theme.styles.length),c.theme.styles.splice(1,c.theme.styles.length));return!h.isEqual(b,c)},saveApp:function(){var a=new k;this._appHasChanged()?(d.setAttr(this.actionNode,"innerHTML",this.nls.saving),d.setAttr(this.actionNode,"title",this.nls.saving),this._saveApp().then(l.hitch(this,function(b){b.success?(this._disableSaveButton(),this._disableUnloadDlg(),a.resolve()):a.reject()}),l.hitch(this,function(b){this._enableSaveButton();
a.reject(b)}))):a.resolve();return a},_saveApp:function(){var b=new k,c=this.appConfig;a.saveApp(window.appInfo.id,c.getCleanConfig()).then(l.hitch(this,function(a){a.success?(this.lastAppConfig=l.clone(c),b.resolve(a),(a=this.pluginManager.getPluginByName("app-list"))&&window.isXT&&a.refreshAppPage()):(new e({message:this.nls.saveFailedMeg+": "+a.message}),b.reject())}),l.hitch(this,function(a){new e({message:this.nls.saveFailedMeg});console.error(a);b.reject()}));return b},_enableUnloadDlg:function(){window.onbeforeunload=
l.hitch(this,function(){return this.nls.theApp+' "'+this.options.name+'" '+this.nls.unloadMessage})},_disableUnloadDlg:function(){window.onbeforeunload=null},_onLeavePage:function(a){var b=this.pluginManager.getPluginByName("header");if(this._appHasChanged())var d=new c({content:"\x3cdiv style\x3d'font-size: 14px'\x3e\x3cimg class\x3d'alert-image jimu-float-leading'  src\x3d'"+this.folderUrl+"css/images/alert.png'  style\x3d'margin-left:20px;margin-right:20px;'\x3e\x3c/img\x3e\x3cspan style\x3d'display:inline-block;width:285px'\x3e"+
this.nls.unSaveMegBegin+this.options.name+this.nls.unSaveMegEnd+"\x3c/span\x3e\x3c/div\x3e",titleLabel:this.nls.toHomeTitle,width:525,height:180,buttons:[{label:this.nls.save,onClick:l.hitch(this,function(){this._saveApp().then(l.hitch(this,function(c){d.close();c.success&&(window.onbeforeunload=null,b.setAppName(""),a())}),l.hitch(this,function(a){console.error(this.nls.saveFailedMeg,a)}))})},{label:this.nls.doNotSave,onClick:l.hitch(this,function(){d.close();window.onbeforeunload=null;b.setAppName("");
a()})},{label:this.nls.cancel,classNames:["jimu-btn-vacation"],onClick:l.hitch(this,function(){d.close()})}]});else window.onbeforeunload=null,a()}})})},"builder/serviceUtils":function(){define("dojo/_base/lang dojo/request/xhr dojo/Deferred dojo/json dojo/_base/array jimu/utils jimu/portalUrlUtils jimu/portalUtils jimu/ConfigLoader jimu/Role builder/portalUtils dojo/promise/all builder/tokenUtils".split(" "),function(r,l,d,q,k,m,p,h,e,c,b,a,g){function u(a){return l("/webappbuilder/rest/signininfo/getsignininfo",
{query:{portalUrl:a},handleAs:"json"})}function n(a){var b=[];a&&0<a.length&&k.forEach(a,function(a){a&&"string"===typeof a&&(a=p.getServerByUrl(a),b.push(a))});return b}function t(a,b,c,d,e,f){b.title=a.name;b.isWebTier=f;b.authorizedCrossOriginDomains=n(e.authorizedCrossOriginDomains);b.portalUrl=c;b.map.itemId=d;b.geometryService=e.helperServices.geometry.url;b.map.mapOptions||(b.map.mapOptions={});"HTML"!==a.appType||a.webmap||(b.map.mapOptions.extent=e.defaultExtent);a="/proxy.js";window.isXT||
(a=p.getPortalProxyUrl(b.portalUrl),a=p.removeProtocol(a));b.httpProxy={useProxy:!0,url:a};e.portalProperties&&e.portalProperties.sharedTheme?(a=e.portalProperties.sharedTheme.header.background?!0:!1,e=e.portalProperties.sharedTheme.logo.small?!0:!1,b.theme?(b.theme.sharedTheme={isPortalSupport:!0,useHeader:a,useLogo:e},a&&(e=b.theme.styles.pop(),b.theme.styles.unshift(e))):b.theme={sharedTheme:{isPortalSupport:!0,useHeader:a,useLogo:e}}):b.theme?b.theme.sharedTheme={isPortalSupport:!1,useHeader:!1,
useLogo:!1}:b.theme={sharedTheme:{isPortalSupport:!1,useHeader:!1,useLogo:!1}}}function f(a,c,e){var f=new d,g=new d,h={title:a.name,type:"Web Mapping Application",typeKeywords:"Web AppBuilder, Ready To Use, JavaScript, "+("HTML"===a.appType?"WAB2D":"WAB3D"),text:q.stringify(c),snippet:a.description,tags:a.tags},n=p.getStandardPortalUrl(window.portalUrl),k=b.getPortal(n);k.getUser().then(function(b){a.folderId===b.username&&(a.folderId="");var c={q:"owner:"+b.username+" title:"+h.title+' type:"Web Mapping Application"'};
e?g.resolve(b):k.queryItems(c).then(function(a){0<a.total?(g.reject(),f.resolve({success:!1,unsuccessCode:"01-01"})):g.resolve(b)},function(a){g.reject();f.reject(a)})},function(a){g.reject();f.reject(a)});g.then(function(b){b.addItem(h,a.folderId).then(function(d){if(d.success){if(d.user=b,f.resolve(d),!(c.appConfig&&c.appConfig.templateConfig&&c.appConfig._appData)){var e=p.getStandardPortalUrl(window.portalUrl),e=p.getItemUrl(e,d.id),e=p.removeProtocol(e);b.addItem({title:a.name,type:"Code Attachment",
typeKeywords:"Code, Web Mapping Application, Javascript",relationshipType:"WMA2Code",originItemId:d.id,url:e+"/package"},a.folderId).then(function(a){a.success||console.error(builderNls.createCodeAttachmentError)},function(a){console.error(builderNls.createCodeAttachmentError,a.message)})}}else f.resolve(d)},function(a){f.reject(a)})});return f}function v(a,b,c,d){a.getRegisteredAppInfoWithXhr(b,c).then(function(a){a.client_id||(console.log("registering app..."),x(b,d))},function(a){a&&a.message&&
"Not a registered app"===a.message&&(console.log("registering app..."),x(b,d))})}function x(a,c){var d=p.getStandardPortalUrl(window.portalUrl),d=b.getPortal(d),e="http:"+p.removeProtocol(c),f="https:"+p.removeProtocol(c);d.registerApp(a,"browser",[e,f]).then(function(a){a.client_id||console.warn("The app is successfully created, but failed to register")},function(a){console.warn("The app is successfully created, but failed to register",a.message||a)})}function w(a){var b=new d;l(window.stemappInfo.name+
"/"+a+"/list.json",{handleAs:"json"}).then(function(c){return z(c,a).then(function(a){b.resolve({success:!0,manifests:a})})},function(a){b.reject({success:!1,message:a.message})});return b}function z(b,c){var e=[],f=new d;b._buildInfo&&b._buildInfo.manifestsMerged?l(window.stemappInfo.name+"/"+c+"/"+c+"-manifest-builder.json",{handleAs:"json"}).then(function(d){var g=[];k.forEach(b[c],function(a){var b;(b="themes"===c?d["themes/"+a+"/main"]:d["widgets/"+a+"/Widget"])?g.push(b):e.push(l(window.stemappInfo.name+
"/"+c+"/"+a+"/manifest.json",{handleAs:"json"}))});a(e).then(function(a){g=g.concat(a);A(g,c).then(function(){f.resolve(g)})})}):(k.forEach(b[c],function(a){e.push(l(window.stemappInfo.name+"/"+c+"/"+a+"/manifest.json",{handleAs:"json"}))}),a(e).then(function(a){A(a,c).then(function(){f.resolve(a)})}));return f}function A(b,c){var e=[],f=new d;k.forEach(b,function(a){a.isRemote||(a.category="widgets"===c?"widget":"theme",r.mixin(a,m.getUriInfo(a.category+"s/"+a.name+"/Widget.js")));e.push(y(a))});
a(e).then(function(){f.resolve()},function(a){f.reject(a)});return f}function y(a){return m.manifest.addI18NLabel(a).then(function(){m.manifest.addManifestProperies(a);m.manifest.processManifestLabel(a,window.dojoConfig.locale);return a})}var B={},C=["HTML","HTML3D"];B.checkAppVersion=function(a,b){var c=new d;l("/webappbuilder/rest/apps/checkVersion",{method:"POST",data:{appConfig:q.stringify(a),appType:b.appType},handleAs:"json"}).then(r.hitch(this,function(a){a.success?c.resolve(a):c.reject(a)}),
r.hitch(this,function(a){c.reject(a)}));return c.promise};B.importPortalApp=function(a,b){var c=new d;delete a.agolTemplateInfo;l("/webappbuilder/rest/apps/importportalapp",{method:"POST",handleAs:"json",data:{appConfig:q.stringify(a),appInfo:q.stringify(b)}}).then(r.hitch(this,function(a){a.success?c.resolve(a):c.reject(a)}),r.hitch(this,function(a){c.reject(a)}));return c.promise};B.getTemplateList=function(a){var c=new d,e=p.getStandardPortalUrl(window.portalUrl),f;isXT?(f=b.getPortal(e),f.getUser().then(function(b){l((a?
"/webappbuilder/rest/apps/templatelist?portalUrl\x3d"+e:"/webappbuilder/rest/apps/templatelist?username\x3d"+b.username+"\x26portalUrl\x3d"+e)+"\x26locale\x3d"+dojoConfig.locale,{handleAs:"json"}).then(function(a){c.resolve(a)},function(a){c.reject(a)})},function(a){c.reject(a)})):c.resolve([]);return c};B.getAppList=function(){var a=new d,c=p.getStandardPortalUrl(window.portalUrl),e;isXT?(e=b.getPortal(c),e.getUser().then(function(b){l("/webappbuilder/rest/apps/list?username\x3d"+b.username+"\x26portalUrl\x3d"+
c,{handleAs:"json"}).then(function(b){a.resolve(b)},function(b){a.reject(b)})},function(b){a.reject(b)})):(e=b.getPortal(c))?e.getUser().then(function(b){b.getItemsByKeywords("Web AppBuilder").then(function(b){var c=[];(b=b&&b.results)&&0<b.length&&(c=k.map(b,function(a){return{name:a.title,description:a.description,id:a.id}}));a.resolve(c)},function(b){console.error(b);a.reject({success:!1,message:""})})},function(b){console.error(b);a.reject({success:!1,message:""})}):a.reject({success:!1,message:""});
return a};B.getAppInfo=function(a){var c=new d;if(isXT)return-1<C.indexOf(a)?(c.resolve({id:a,appType:a,name:"stem app"}),c):l("/webappbuilder/rest/apps/"+a,{handleAs:"json"});var e=p.getStandardPortalUrl(window.portalUrl);if(-1<C.indexOf(a))return c.resolve({id:a,appType:a,name:"stem app"}),c;b.getPortal(e).getItemById(a).then(function(a){var b;b=0<=a.typeKeywords.indexOf("Web AppBuilder")?0<=a.typeKeywords.indexOf("WAB3D")?"HTML3D":"HTML":a.url&&0<=a.url.indexOf("webappviewer3d")?"HTML3D":"HTML";
c.resolve({name:a.title,description:a.description,id:a.id,owner:a.owner,appType:b})});return c};B.updateApp=function(a){var c=new d,e=p.getStandardPortalUrl(window.portalUrl);isXT?b.getPortal(e).getUser().then(function(b){l("/webappbuilder/rest/apps/updateapp",{handleAs:"json",method:"POST",data:{id:a.id,name:a.name,description:a.description,modified:b.username||"",creator:a.creator,thumbnail:a.thumbnail,icon:a.icon,portalUrl:e}}).then(function(a){c.resolve(a)},function(a){c.reject(a)})},function(a){c.reject(a)}):
c.resolve({success:!0});return c};B.createApp=function(c){var e=new d,h,n=p.getStandardPortalUrl(window.portalUrl),k=b.getPortal(n);h=k.loadSelfInfo();var m=k.getUser(),k=null;c.webmap?(k=new d,k.resolve(c.webmap)):c.webscene?(k=new d,k.resolve(c.webscene)):k="HTML3D"===c.appType?b.getDefaultWebScene(n):b.getDefaultWebMap(n);if(isXT){var q=u(n);h=[h,m,k,q];a(h).then(function(a){var b=a[0],d=a[1],f=a[2];a=a[3];var g={map:{}};t(c,g,p.getStandardPortalUrl(a.info.portalUrl),f,b,a.info.isWebTier?!0:!1);
l("/webappbuilder/rest/apps/createapp",{handleAs:"json",method:"POST",data:{name:c.name,description:c.description,creator:d.username||"",modified:d.username||"",extraPropertyOfAppConfig:JSON.stringify(g),portalUrl:n,fromAppId:c.fromAppId,icon:c.icon,thumbnail:c.thumbnail}}).then(function(a){e.resolve(a)},function(a){e.reject(a)})},function(a){console.error(a);e.reject({success:!1,message:builderNls.createError})})}else m=B.getPredefinedAppConfig(),q=g.isWebTierPortal(n),h=[h,m,k,q],a(h).then(function(a){var b=
a[1];t(c,b,n,a[2],a[0],a[3]);f(c,b,!0).then(function(a){var b=p.getStandardPortalUrl(window.portalUrl);if(a.success)e.resolve({success:!0,newAppId:a.id}),setTimeout(r.hitch(this,function(){var d;d="HTML3D"===c.appType?b+"/apps/webappviewer3d/index.html?id\x3d"+a.id:b+"/apps/webappviewer/index.html?id\x3d"+a.id;v(a.user,a.id,c.folderId,d);a.user.updateItem(a.id,{url:d}).then(function(a){a.success||console.error(builderNls.createUrlError)},function(a){console.error(builderNls.createUrlError,a.message||
"")})}),2E3);else{var d=builderNls.titleExist.replace("${TITLE}",c.name),f;f=c.webmap?b+"/home/webmap/viewer.html?webmap\x3d"+c.webmap:c.webscene?b+"/home/webscene/viewer.html?webmap\x3d"+c.webscene:b+"/home/content.html";switch(a.unsuccessCode){case "01-01":e.resolve({success:!1,message:d,href:f});console.error(builderNls.createError,d);break;default:e.resolve({success:!1,message:builderNls.createError,href:f}),console.error(builderNls.createError,builderNls.addItemUnsuccess)}}},function(a){e.reject({success:!1,
message:builderNls.createError});console.error(builderNls.createError,a.message||"")})},function(a){e.reject({success:!1,message:builderNls.createError});console.error(builderNls.createError,a.message||"")});return e};B.duplicateApp=function(a){var c=new d,e=p.getStandardPortalUrl(window.portalUrl);isXT?b.getPortal(e).getUser().then(function(b){l("/webappbuilder/rest/apps/duplicateapp",{handleAs:"json",method:"POST",data:{fromAppId:a.fromAppId,creator:b.username||"",modified:b.username||"",portalUrl:e}}).then(function(a){c.resolve(a)},
function(a){c.reject(a)})},function(a){console.error(builderNls.createError,a);c.reject({message:builderNls.createError})}):c.resolve();return c};B.saveAs=function(c,e){var g=new d,h=p.getStandardPortalUrl(window.portalUrl),n=b.getPortal(h);if(isXT)b.getPortal(h).getUser().then(function(a){l("/webappbuilder/rest/apps/"+c.fromAppId+"/saveas",{handleAs:"json",method:"POST",data:{name:c.name,description:c.description,fromAppId:c.fromAppId,creator:a.username||"",modified:a.username||"",portalUrl:h,appConfig:q.stringify(e),
saveAsTemplate:c.saveAsTemplate,thumbnail:c.thumbnail}}).then(function(a){g.resolve(a)},function(a){g.reject(a)})},function(a){console.error(builderNls.createError,a);g.reject({message:builderNls.createError})});else{var k=r.clone(e).getCleanConfig();delete k.agolTemplateInfo;var m=B.switchImageFormatOfAppConfig({appConfig:k}),t=new d,u=p.getStandardPortalUrl(window.portalUrl),w;e.templateConfig&&e._appData?n.getItemData(c.fromAppId).then(function(a){w="HTML3D"===c.appType?u+"/apps/webappviewer3d/index.html?appid\x3d":
u+"/apps/webappviewer/index.html?appid\x3d";a.appConfig=k;a.values.app_title=k.title;a.values.app_subtitle=k.subtitle;a.values.webmap=k.map.itemId;t.resolve(a)},function(a){t.reject({success:!1,message:a.message})}):(w="HTML3D"===c.appType?u+"/apps/webappviewer3d/index.html?id\x3d":u+"/apps/webappviewer/index.html?id\x3d",t.resolve(k));n=n.getItemById(c.fromAppId);a({itemData:t,item:n}).then(function(a){var b=a.itemData,d=a.item;f(c,b).then(function(a){if(a.success)B.AddResourcesToItem(m.result,a.id).then(function(){g.resolve({success:!0,
newAppId:a.id})},function(a){g.reject({success:!1,message:builderNls.saveAsError});console.error(builderNls.saveAsError,a.message||"")}),setTimeout(r.hitch(this,function(){w+=a.id;b.appItemId=a.id;v(a.user,a.id,c.folderId,w);a.user.updateItem(a.id,{url:w,typeKeywords:d.typeKeywords.join(","),text:q.stringify(b)}).then(function(a){},function(a){console.error(builderNls.duplicateUrlError,a.message||"")})}),2E3);else{var e=builderNls.titleExist.replace("${TITLE}",c.name);switch(a.unsuccessCode){case "01-01":g.resolve({success:!1,
message:e});console.error(builderNls.saveAsError,e);break;default:g.resolve({success:!1,message:builderNls.saveAsError}),console.error(builderNls.saveAsError,builderNls.addItemUnsuccess)}}},function(a){g.reject({success:!1,message:builderNls.saveAsError});console.error(builderNls.saveAsError,a.message||"")})},function(a){g.reject({success:!1,message:builderNls.saveAsError});console.error(builderNls.saveAsError,a.message||"")})}return g};B.removeApp=function(a){if(isXT)return l("/webappbuilder/rest/apps/removeapp",
{handleAs:"json",method:"POST",data:{id:a}})};B.saveApp=function(c,e){var f=new d,g=p.getStandardPortalUrl(window.portalUrl),h=b.getPortal(g),m=h.getUser(),t;e.authorizedCrossOriginDomains=n(h.authorizedCrossOriginDomains);isXT?(t=u(g),a({user:m,signininfo:t}).then(function(a){e.portalUrl=p.getStandardPortalUrl(a.signininfo.info.portalUrl);l("/webappbuilder/rest/apps/"+c+"/saveconfig",{data:{appConfig:q.stringify(e),modified:a.user.username},method:"POST",handleAs:"json"}).then(function(a){f.resolve(a)},
function(a){f.reject(a)})},function(a){f.reject(a)})):m.then(function(a){h.getItemData(c).then(function(b){var d,h;e.templateConfig&&e._appData?(d=b.appConfig,h=b,h.appConfig=e,h.values.app_title=e.title,h.values.app_subtitle=e.subtitle,h.values.webmap=e.map.itemId):(d=b,h=e);b=B.switchImageFormatOfAppConfig({appConfig:h});var n=[],l=[];k.forEach(b.result,function(a){a.b64&&l.push(a);n.push(a.resUrl)});B.AddResourcesToItem(l,window.appInfo.id).then(r.hitch(this,function(){B.removeUnusedResources(n).then(r.hitch(this,
function(){e.agolTemplateInfo=d?d.agolTemplateInfo:null;e.portalUrl=g;h.appItemId=c;a.updateItem(c,{text:q.stringify(h)}).then(function(a){f.resolve({success:!0,newAppId:a.id})})}),function(a){f.reject({success:!1,message:a.message})})}),function(a){f.reject({success:!1,message:a.message})})});h.getItemById(c,!0).then(r.hitch(this,function(b){var d;b.url&&""!==b.url?d=b.url:(d=p.getStandardPortalUrl(window.portalUrl),d="HTML3D"===window.appInfo.appType?d+"/apps/webappviewer3d/index.html?id\x3d"+c:
d+"/apps/webappviewer/index.html?id\x3d"+c,a.updateItem(c,{url:d}).then(function(a){}));v(a,c,b.ownerFolder,d)}))},function(a){f.reject({success:!1,message:a.message})});return f};B.getPredefinedAppConfig=function(){return l(window.stemappInfo.name+"/predefined-apps/default/config.json",{handleAs:"json"})};B.copyThemeToApp=function(a,b,c){if(isXT)return-1<C.indexOf(a)?(a=new d,a.resolve({success:!0}),a):l("/webappbuilder/rest/apps/"+a+"/copytheme",{handleAs:"json",method:"POST",data:{themeName:b,
layoutConfig:JSON.stringify(c)}});a=new d;a.resolve({success:!0});return a};B.copyWidgetToApp=function(a,b){var c=new d;if(b.isRemote)return c.resolve({success:!0}),c;if(isXT)return-1<C.indexOf(a)?(c=new d,c.resolve({success:!0}),c):l.post("/webappbuilder/rest/apps/"+a+"/copywidget",{data:{widgetName:b.name},handleAs:"json"});c=new d;c.resolve({success:!0});return c};B.getAllThemes=function(){if(isXT)return l("/webappbuilder/rest/themes/search?q\x3d"+JSON.stringify({platform:window.stemappInfo.appType}),
{handleAs:"json"}).then(function(a){k.forEach(a.themes,function(a){m.manifest.processManifestLabel(a,window.dojoConfig.locale)},this);return a});var a=new d;w("themes").then(function(b){k.forEach(b.manifests,function(a){m.manifest.processManifestLabel(a,window.dojoConfig.locale)},this);a.resolve({success:!0,themes:b.manifests})},function(b){a.reject(b)});return a};B.searchWidgets=function(a){if(isXT)return l("/webappbuilder/rest/widgets/search?q\x3d"+JSON.stringify(a),{handleAs:"json"}).then(function(a){a.widgets&&
a.widgets.forEach(function(a){r.mixin(a,m.getUriInfo("widgets/"+a.name+"/Widget"));m.manifest.processManifestLabel(a,window.dojoConfig.locale)});if(!p.isOnline(window.portalUrl)){var b=!0;window.portalVersion&&0<=h.comparePortalVersion(window.portalVersion,"3.10")&&(b=!1);var c=k.filter(a.widgets,function(a){return"Analysis"===a.name&&b?!1:!0});a.widgets=c}return a});var b=new d;w("widgets").then(function(c){var d=[];k.forEach(c.manifests,function(b){if("undefined"===typeof a["properties.inPanel"]||
a["properties.inPanel"]===b.properties.inPanel)a.support2D!==b.support2D&&a.support3D!==b.support3D||d.push(b)});b.resolve({success:!0,widgets:d})},function(a){b.reject(a)});return b};B.getManifestFromItem=function(a){var b=m.widgetJson.getFolderUrlFromItem(a)+"manifest.json";return l(b,{handleAs:"json",headers:{"X-Requested-With":null}}).then(function(b){b.isRemote=!0;b.category="widget";b.itemId=a.id;r.mixin(b,m.getUriInfo(m.widgetJson.getUriFromItem(a)));return y(b)})};B.saveAgolTemplate=function(a,
c){var e=new d,f=p.getStandardPortalUrl(window.portalUrl);if(isXT)l("/webappbuilder/rest/apps/updateagoltemplateinapp",{handleAs:"json",method:"POST",data:{id:a.id,agolTemplateInfo:q.stringify(c)}}).then(r.hitch(this,function(a){!0===a.success?e.resolve():(console.error("The response of save agol template is 'unsuccess'!"),e.reject("The response of save agol template is 'unsuccess'!"))}),function(a){console.error(a.message||a);e.reject("Save AGOLTemplate failed!")});else{var g=b.getPortal(f);g.getUser().then(function(b){g.getItemData(a.id).then(function(d){delete d.agolTemplateJson;
d.agolTemplateInfo=c;b.updateItem(a.id,{text:q.stringify(d)}).then(function(){e.resolve()},function(a){console.error(a.message||a);e.reject("Save AGOLTemplate failed when updateItem!")})},function(a){console.error(a.message||a);e.reject("Save AGOLTemplate failed when get app's itemData!")})},function(a){console.error(a.message||a);e.reject("Save AGOLTemplate failed when get current user!")})}return e};B.canSaveApp=function(a,b,d){var e=!1;if(a){var f=new c({id:a.roleId?a.roleId:a.role,role:a.role});
a.privileges&&f.setPrivileges(a.privileges);if(window.isXT)f.isAdmin()?e=!0:a.username===b&&(e=!0);else if(f.isAdmin())e=!0;else if(a.username===b&&f.canCreateItem())e=!0;else if(f.canCreateItem()){var g;g=d?[].concat(d.admin,d.member,d.other):[];k.some(a.groups,function(a){return-1<a.capabilities.indexOf("updateitemcontrol")?k.some(g,function(b){return a.id===b.id?e=!0:!1}):!1})}}return e};B.AddResourcesToItem=function(c,e){c=c||[];if(0===c.length){var f=new d;f.resolve(c);return f}f=k.map(c,function(a){var b=
a.resUrl.split("resources/")[1],c=new d;a.b64?(a=m.b64toBlob(a.b64),c.resolve({blob:a,fileName:b.split("/")[1],prefixName:b.split("/")[0]})):(a=a.resUrl,0<a.indexOf("${itemId}")&&(a=a.replace("${itemId}",e)),m.resourcesUrlToBlob(a).then(function(a){c.resolve({blob:a,fileName:b.split("/")[1],prefixName:b.split("/")[0]},function(a){console.error(a.message||a);c.reject(a)})}));return c});return a(f).then(function(c){if(c instanceof Array&&0<c.length)return c=k.map(c,function(a){return b.addResource(e,
a.blob,a.fileName,a.prefixName)}),a(c).then(function(a){return a},function(a){console.error(a.message||a);return a})},function(a){console.error(a.message||a);return a})};B.switchImageFormatOfAppConfig=function(a,c){function d(a){var b=a.obj,c=a.key,d={obj:b,key:c};"number"===typeof a.i?(d.i=a.i,d.value=b[c][a.i]):d.value=b[c];return d}function f(a,b){var c=a.obj,d=a.key;"number"===typeof a.i?c[d][a.i]=b:c[d]=b}function g(a){return/^https?:\/\/(.)+\/sharing\/rest\/content\/items/.test(a)}function h(a,
b){b=d(b);var c=e.getInstance().processItemIdAndTokenOfResources(b.value,a);return m.getBase64Data(c).then(function(a){f(b,a)})}var n=a.appConfig,k=a.appId?a.appId:window.appInfo.id,l=p.getStandardPortalUrl(window.portalUrl),t={},q={appId:k,portalUrl:l};if("import"===c)return t={test:g,func:r.hitch(this,h,q)},b.getPortal(l).getItemById(k).then(r.hitch(this,function(a){q.isPublic="public"===a.access;return m.processItemResourceOfAppConfig(n,t)}));t={test:function(a){return/^data:image\/(png|jpg|jpeg|gif);base64,/.test(a)||
/^https?:\/\/(.)+\/sharing\/rest\/content\/items/.test(a)},func:r.hitch(this,function(a,b){b=d(b);if(/^data:image\/(png|jpg|jpeg|gif);base64,/.test(b.value)){var c=b.value.match(/^data:image\/(png|jpg|jpeg|gif)/)[1],c="."+c,e=m.getRandomString(),c=p.getItemResourceUrl(a.portalUrl,"${itemId}","inConfig/"+(e+c));f(b,c);return{resUrl:c,b64:b.value}}if(/^https?:\/\/(.)+\/sharing\/rest\/content\/items/.test(b.value))return c=b.value,/(\?|\&)token=.+/.test(c)&&(c=c.replace(/(\?|\&)token=.+/,"")),f(b,c.replace(/items\/.+\/resources/,
"items/${itemId}/resources")),{resUrl:c}},q)};return m.processItemResourceOfAppConfig(n,t)};B.removeUnusedResources=function(c){c=c?c:[];0!==c.length&&(c=k.map(c,function(a){/(\?|\&)token=.+/.test(a)&&(a=a.replace(/(\?|\&)token=.+/,""));return a.split("resources/")[1]}));return b.getItemResources().then(function(e){e=k.map(e,function(a){return a.resource});e=m.subtractionArray(e,c);if(0===e.length)return e=new d,e.resolve(),e;if(e instanceof Array&&0<e.length)return e=k.map(e,function(a){return b.removeResources(a)}),
a(e).then(function(a){if(a instanceof Array&&0<a.length&&a[0].success)return a},function(a){console.error(a.message||a);return a})})};return B})},"jimu/ConfigLoader":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/html dojo/_base/config dojo/cookie dojo/Deferred dojo/promise/all dojo/request/xhr ./utils ./WidgetManager ./shared/utils ./tokenUtils ./portalUtils ./portalUrlUtils ./AppStateManager esri/IdentityManager esri/config esri/urlUtils esri/arcgis/utils".split(" "),
function(r,l,d,q,k,m,p,h,e,c,b,a,g,u,n,t,f,v,x,w){var z=null,A;A=r(null,{urlParams:null,appConfig:null,rawAppConfig:null,configFile:null,_configLoaded:!1,portalSelf:null,constructor:function(a,c){this._removeHash(a);this.urlParams=a||{};this.widgetManager=b.getInstance();l.mixin(this,c)},loadConfig:function(){console.time("Load Config");return this._tryLoadConfig().then(l.hitch(this,function(a){var b=this.checkConfig(a);if(b)throw Error(b);this.rawAppConfig=l.clone(a);t.getInstance().setRawAppConfig(this.rawAppConfig);
a=this._upgradeAppConfig(a);this._processAfterTryLoad(a);this.appConfig=a;if(this.urlParams.id)return this.loadWidgetsManifest(a).then(l.hitch(this,function(){return this.loadAndUpgradeAllWidgetsConfig(a)})).then(l.hitch(this,function(a){return this.processResourceInAppConfigForConfigLoader(a,this.urlParams.id)})).then(l.hitch(this,function(){this._configLoaded=!0;this._setDocumentTitle(a);this._readAndSetSharedTheme(a);return this.getAppConfig()}));g.setPortalUrl(a.portalUrl);w.arcgisUrl=n.getBaseItemUrl(a.portalUrl);
return this._proesssWebTierAndSignin(a).then(l.hitch(this,function(){return this.urlParams.appid?window.appInfo.isRunInPortal?this._getAppConfigFromTemplateAppId(a.portalUrl,this.urlParams.appid).then(l.hitch(this,function(a){this._tryUpdateAppConfigByLocationUrl(a);return this._processInPortalAppProtocol(a)})):this._processNotInPortalAppProtocol(a).then(l.hitch(this,function(a){return this._getAppDataAddTemplateDataFromTemplateAppId(a.portalUrl,this.urlParams.appid).then(l.hitch(this,function(b){b.appData.appConfig&&
(a=b.appData.appConfig);a._appData=b.appData;a.templateConfig=b.templateData;a.isTemplateApp=!0;return a}))})):this._processNotInPortalAppProtocol(a)})).then(l.hitch(this,function(a){this._processAfterTryLoad(a);this.appConfig=a;return a.map.itemId?a:(a.map["3D"]?u.getDefaultWebScene(a.portalUrl):u.getDefaultWebMap(a.portalUrl)).then(function(b){a.map.itemId=b;return a})})).then(l.hitch(this,function(a){return this.loadWidgetsManifest(a)})).then(l.hitch(this,function(a){return a._appData?a._appData.values&&
a._appData.values.webmap?u.getPortal(a.portalUrl).getItemById(a._appData.values.webmap).then(l.hitch(this,function(b){return c.template.mergeTemplateAppConfigToAppConfig(a,a._appData,b)})):c.template.mergeTemplateAppConfigToAppConfig(a,a._appData):a})).then(l.hitch(this,function(a){return this.loadAndUpgradeAllWidgetsConfig(a)})).then(l.hitch(this,function(a){return a._wabAppId?this.processResourceInAppConfigForConfigLoader(a,a._wabAppId):a.appItemId&&-1<window.JSON.stringify(a).indexOf("${itemId}")?
this.processResourceInAppConfigForConfigLoader(a,a.appItemId):a})).then(l.hitch(this,function(a){this._configLoaded=!0;this._setDocumentTitle(a);this._readAndSetSharedTheme(a);return this.getAppConfig()}))}),l.hitch(this,function(a){this.showError(a);var b=new p;b.reject(a);return b}))},processResourceInAppConfigForConfigLoader:function(a,b){function d(a){return/^https?:\/\/(.)+\/sharing\/rest\/content\/items/.test(a)}function e(a,b){var c=b,d=c.obj,e=c.key,f={obj:d,key:e};"number"===typeof c.i?(f.i=
c.i,f.value=d[e][c.i]):f.value=d[e];b=f;c=g.processItemIdAndTokenOfResources(b.value,a);d=b.obj;e=b.key;"number"===typeof b.i?d[e][b.i]=c:d[e]=c;return!0}var f=a.portalUrl,g=this;return u.getPortal(f).getItemById(b).then(l.hitch(this,function(g){g={test:d,func:l.hitch(this,e,{appId:b,isPublic:"public"===g.access,portalUrl:f})};return c.processItemResourceOfAppConfig(a,g).appConfig}))},processItemIdAndTokenOfResources:function(a,b){0<a.indexOf("${itemId}")&&(a=a.replace("${itemId}",b.appId));/(\?|\&)token=.+/.test(a)&&
(a=a.replace(/(\?|\&)token=.+/,""));if(!b.isPublic){var c=g.getPortalCredential(b.portalUrl);c&&(a+="?token\x3d"+c.token)}return a},_setDocumentTitle:function(a){!window.isBuilder&&a&&a.title&&(document.title=c.stripHTML(a.title))},getAppConfig:function(){var a=l.clone(this.appConfig);a.getConfigElementById=function(a){return c.getConfigElementById(this,a)};a.getConfigElementsByName=function(a){return c.getConfigElementsByName(this,a)};a.visitElement=function(a){c.visitElement(this,a)};this._addAuthorizedCrossOriginDomains(this.portalSelf,
a);return a},_addAuthorizedCrossOriginDomains:function(a,b){a&&a.authorizedCrossOriginDomains&&g.addAuthorizedCrossOriginDomains(a.authorizedCrossOriginDomains);b&&b.authorizedCrossOriginDomains&&g.addAuthorizedCrossOriginDomains(b.authorizedCrossOriginDomains)},checkConfig:function(){return!1},processProxy:function(a){v.defaults.io.alwaysUseProxy=a.httpProxy&&a.httpProxy.useProxy&&a.httpProxy.alwaysUseProxy;v.defaults.io.proxyUrl="";v.defaults.io.proxyRules=[];a.httpProxy&&a.httpProxy.useProxy&&
a.httpProxy.url&&(v.defaults.io.proxyUrl=a.httpProxy.url);a.httpProxy&&a.httpProxy.useProxy&&a.httpProxy.rules&&d.forEach(a.httpProxy.rules,function(a){x.addProxyRule(a)})},addNeedValues:function(a){this._processNoUriWidgets(a);this._processEmptyGroups(a);this._addElementId(a);this._fixRepeatedId(a)},showError:function(a){a&&a.message&&q.create("div",{"class":"app-error",innerHTML:c.sanitizeHTML(a.message)},document.body)},_tryLoadConfig:function(){"stemapp"===this.urlParams.id&&(this.urlParams.config=
window.appInfo.appPath+"config.json",delete this.urlParams.id);if(this.urlParams.config)return this.configFile=this.urlParams.config,e(this.configFile,{handleAs:"json",headers:{"X-Requested-With":null}}).then(l.hitch(this,function(a){g.setPortalUrl(a.portalUrl);a.portalUrl&&(window.portalUrl=a.portalUrl);return this.urlParams.token?g.registerToken(this.urlParams.token).then(function(){return a}):a}));if(this.urlParams.id){window.appInfo.isRunInPortal=!0;var a=n.getPortalUrlFromLocation(),b=new p;
g.setPortalUrl(a);window.portalUrl=a;w.arcgisUrl=n.getBaseItemUrl(a);var c;this.urlParams.token?c=g.registerToken(this.urlParams.token):(c=new p,c.resolve());c.then(l.hitch(this,function(){u.getPortal(a).loadSelfInfo().then(l.hitch(this,function(c){this.portalSelf=c;c.allSSL&&"http:"===window.location.protocol?(console.log("redirect from http to https"),window.location.href=n.setHttpsProtocol(window.location.href),b.reject()):this._processSignIn(a).then(l.hitch(this,function(){this._getAppConfigFromAppId(a,
this.urlParams.id).then(l.hitch(this,function(a){this._tryUpdateAppConfigByLocationUrl(a);return this._processInPortalAppProtocol(a)})).then(function(a){b.resolve(a)},function(a){b.reject(a)})}))}))}),l.hitch(this,function(a){this.showError(a)}));return b}this.configFile="config.json";return e(this.configFile,{handleAs:"json"}).then(l.hitch(this,function(a){g.setPortalUrl(a.portalUrl);a.portalUrl&&(window.portalUrl=a.portalUrl);return this.urlParams.token?g.registerToken(this.urlParams.token).then(function(){return a}):
a}))},_upgradeAppConfig:function(a){var b=window.wabVersion,c=a.wabVersion;a.configWabVersion=a.wabVersion;if(b===c)return a;var d=this.versionManager.getVersionIndex(c),e=this.versionManager.getVersionIndex(b);if(d>e)throw Error("Bad version number, "+c);a=this.versionManager.upgrade(a,c,b);a.wabVersion=b;return a},loadAndUpgradeAllWidgetsConfig:function(b){var c=new p,d=[];a.visitElement(b,l.hitch(this,function(a){a.uri&&(a=this.widgetManager.tryLoadWidgetConfig(a),d.push(a))}));h(d).then(l.hitch(this,
function(){c.resolve(b)}),function(a){c.reject(a)});return c},_processAfterTryLoad:function(a){this._setPortalUrl(a);this._tryUpdateAppConfigByLocationUrl(a);this._processUrlParams(a);this.addNeedValues(a);this.processProxy(a);f.tokenValidity=10080;return a},_readAndSetSharedTheme:function(a){a.theme.sharedTheme||(a.theme.sharedTheme={useHeader:!1,useLogo:!1},a.theme.sharedTheme.isPortalSupport=this.portalSelf.portalProperties&&this.portalSelf.portalProperties.sharedTheme?!0:!1);a.theme.sharedTheme.useHeader&&
(a.theme.sharedTheme.isPortalSupport&&this.portalSelf.portalProperties?(a.theme.customStyles={mainBackgroundColor:this.portalSelf.portalProperties.sharedTheme.header.background},a.titleColor=this.portalSelf.portalProperties.sharedTheme.header.text):console.error("Portal does not support sharedTheme."));a.theme.sharedTheme.useLogo&&(a.theme.sharedTheme.isPortalSupport&&this.portalSelf.portalProperties?(a.logo=this.portalSelf.portalProperties.sharedTheme.logo.small?this.portalSelf.portalProperties.sharedTheme.logo.small:
"images/app-logo.png",!a.logoLink&&this.portalSelf.portalProperties.sharedTheme.logo.link&&(a.logoLink=this.portalSelf.portalProperties.sharedTheme.logo.link)):(console.error("Portal does not support sharedTheme, use default logo."),a.logo="images/app-logo.png"))},_tryUpdateAppConfigByLocationUrl:function(a){if(!(this.urlParams.config&&-1<this.urlParams.config.indexOf("arcgis.com/sharing/rest/content/items/"))){var b=n.getPortalUrlFromLocation(),b=n.getStandardPortalUrl(b);n.isOnline(b)&&(b=n.updateUrlProtocolByOtherUrl(b,
a.portalUrl),a.map.portalUrl&&n.isSamePortalUrl(a.portalUrl,a.map.portalUrl)&&(a.map.portalUrl=b),a.portalUrl=b,a.httpProxy&&a.httpProxy.url&&(a.httpProxy.url=n.getPortalProxyUrl(b)))}},_processWidgetJsons:function(b){a.visitElement(b,function(a,b){b.isWidget&&a.uri&&c.widgetJson.processWidgetJson(a)})},_processNoUriWidgets:function(b){var c=0;a.visitElement(b,function(a,b){b.isWidget&&!a.uri&&(c++,a.placeholderIndex=c)})},_processEmptyGroups:function(a){var b=0;a.widgetOnScreen.groups&&d.forEach(a.widgetOnScreen.groups,
function(a){if(!a.widgets||a.widgets&&0===a.widgets.length)b++,a.placeholderIndex=b})},_addElementId:function(b){var c=0,d;a.visitElement(b,function(a){if(a.id){a.id=a.id.replace(/\//g,"_");var b=a.id.lastIndexOf("_");-1<b&&(d=a.id.substr(b+1),c=Math.max(c,d))}});a.visitElement(b,function(a){a.id||(c++,a.id=a.itemId?a.itemId+"_"+c:a.uri?a.uri.replace(/\//g,"_")+"_"+c:"_"+c)})},_setPortalUrl:function(a){if(a.portalUrl){var b=n.getPortalUrlFromLocation(),c=n.isOnline(b);n.isSamePortalUrl(a.portalUrl,
b)||c||(window.appInfo.isRunInPortal=!1)}else window.isXT&&m("wab_portalurl")?a.portalUrl=m("wab_portalurl"):(window.appInfo.isRunInPortal=!0,a.portalUrl=n.getPortalUrlFromLocation())},_changePortalUrlProtocol:function(a,b){a.portalUrl=n.setProtocol(a.portalUrl,b);a.map.portalUrl&&(a.map.portalUrl=n.setProtocol(a.map.portalUrl,b));a.httpProxy&&(a.httpProxy.url=n.setProtocol(a.httpProxy.url,b),a.httpProxy&&a.httpProxy.rules&&d.forEach(a.httpProxy.rules,l.hitch(this,function(a){a.proxyUrl=n.setProtocol(a.proxyUrl,
b)})))},_processInPortalAppProtocol:function(a){var b=new p,c=u.getPortal(a.portalUrl),d=l.hitch(this,function(c){if("https:"===window.location.protocol)this._changePortalUrlProtocol(a,"https");else{if(c){console.log("redirect from http to https");window.location.href=n.setHttpsProtocol(window.location.href);b.reject();return}this._changePortalUrlProtocol(a,"http")}this._checkLocale();b.resolve(a)});c.loadSelfInfo().then(l.hitch(this,function(b){this.portalSelf=b;"private"===b.access?(b=0===a.portalUrl.toLowerCase().indexOf("https://"),
d(b)):d(b.allSSL)}),l.hitch(this,function(a){b.reject(a)}));return b},_processNotInPortalAppProtocol:function(a){var b=new p;a.portalUrl?u.getPortal(a.portalUrl).loadSelfInfo().then(l.hitch(this,function(c){this.portalSelf=c;var d="https:"===window.location.protocol;(c.allSSL||d)&&this._changePortalUrlProtocol(a,"https");0!==a.portalUrl.toLowerCase().indexOf("https://")||d||g.isInConfigOrPreviewWindow()?b.resolve(a):(console.log("redirect from http to https"),window.location.href=n.setHttpsProtocol(window.location.href),
b.reject())}),l.hitch(this,function(a){b.reject(a)})):b.resolve(a);return b},_proesssWebTierAndSignin:function(a){var b=new p,c=!1,d=a.portalUrl;this._processWebTier(a).then(l.hitch(this,function(a){c=a;return u.getPortal(d).loadSelfInfo()})).then(l.hitch(this,function(a){this.portalSelf=a;return this._processSignIn(d,c)})).then(l.hitch(this,function(){b.resolve()}),function(a){b.reject(a)});return b},_processWebTier:function(a){var b=new p,c=a.portalUrl;a.isWebTier?(g.addAuthorizedCrossOriginDomains([c]),
g.isWebTierPortal(c).then(l.hitch(this,function(){var d=g.getPortalCredential(c);d&&d.ssl&&"http:"===window.location.protocol&&!g.isInConfigOrPreviewWindow()?(console.log("redirect from http to https"),window.location.href=n.setHttpsProtocol(window.location.href)):b.resolve(a.isWebTier)}),l.hitch(this,function(a){b.reject(a)}))):b.resolve(!1);return b},_processSignIn:function(a,b){var c=new p,d=u.getPortal(a),e=n.getSharingUrl(a);window.appInfo.isRunInPortal?(e=f.checkSignInStatus(e),e.promise.always(l.hitch(this,
function(){c.resolve()}))):(!g.isInBuilderWindow()&&!g.isInConfigOrPreviewWindow()&&this.portalSelf.supportsOAuth&&this.rawAppConfig&&this.rawAppConfig.appId&&!b&&g.registerOAuthInfo(a,this.rawAppConfig.appId),e=f.checkSignInStatus(e),e.promise.always(l.hitch(this,function(){g.xtGetCredentialFromCookie(a);d.loadSelfInfo().then(l.hitch(this,function(a){this.portalSelf=a;this._checkLocale();c.resolve()}))})));return c},_checkLocale:function(){if(!g.isInConfigOrPreviewWindow()){var a=this.portalSelf.user&&
this.portalSelf.user.culture||k.locale,a=a.toLowerCase();!this.urlParams.locale&&c.isLocaleChanged(k.locale,a)&&(m("wab_app_locale",a),window.location.reload())}},_getAppConfigFromTemplateAppId:function(a,b){var c=u.getPortal(a);return this._getWabAppIdAndDataFromTemplateAppId(a,b).then(l.hitch(this,function(b){var d=b.appId,e=b.appData;return h([this._getAppConfigFromAppId(a,d),c.getItemData(e.source)]).then(l.hitch(this,function(a){var b;e.appConfig?(b=e.appConfig,delete e.appConfig):b=a[0];b=this._upgradeAppConfig(b);
a=a[1];b._appData=e;b._wabAppId=d;b.templateConfig=a;b.isTemplateApp=!0;return b}))}))},_getAppDataAddTemplateDataFromTemplateAppId:function(a,b){var c=u.getPortal(a);return c.getItemData(b).then(function(a){return c.getItemData(a.source).then(function(b){return{appData:a,templateData:b}})})},_getWabAppIdAndDataFromTemplateAppId:function(a,b){var c=new p,d=u.getPortal(a);d.getItemData(b).then(l.hitch(this,function(a){d.getItemById(a.source).then(l.hitch(this,function(b){b=x.urlToObject(b.url);c.resolve({appId:b.query.id,
appData:a})}))}),function(a){c.reject(a)});return c},_getAppConfigFromAppId:function(a,b){return u.getPortal(a).getItemData(b)},_removeHash:function(a){for(var b in a)a[b]&&(a[b]=a[b].replace("#",""))},loadWidgetsManifest:function(b){function d(a,d,f){function h(c){return a.loadWidgetManifest(c).then(function(a){return a},function(a){console.log("Widget failed to load, it is removed.",c.name);a.stack?console.error(a.stack):console.log(a);e(b,c)})}return d.itemId?u.getPortal(f).getItemById(d.itemId).then(function(a){var f;
f=c.isEsriDomain(a.url)?!0:g.getPortalCredential(b.portalUrl)?!0:!1;if(f)return d.uri=c.widgetJson.getUriFromItem(a),h(d);console.log("Widget is not useable, it is removed.",d.name);e(b,d)},function(a){console.log("Widget is not loaded, it is removed.",d.name,a);e(b,d)}):h(d)}function e(a,b){function c(c){a[c]&&a[c].widgets&&(a[c].widgets=a[c].widgets.filter(function(a){if(b)return a.id!==b.id;a.uri&&!a.manifest&&console.error("Widget is removed because it is not loaded successfully.",a.uri);return a.manifest}));
a[c]&&a[c].groups&&a[c].groups.forEach(function(a){a.widgets&&(a.widgets=a.widgets.filter(function(a){if(b)return a.id!==b.id;a.uri&&!a.manifest&&console.error("Widget is removed because it is not loaded successfully.",a.uri);return a.manifest}))})}c("widgetOnScreen");c("widgetPool")}var f=[],n=new p;b._buildInfo&&b._buildInfo.widgetManifestsMerged?this._loadMergedWidgetManifests().then(l.hitch(this,function(e){a.visitElement(b,l.hitch(this,function(a){a.widgets||!a.uri&&!a.itemId||(a.uri&&e[a.uri]?
(this._addNeedValuesForManifest(e[a.uri],a.uri),c.widgetJson.addManifest2WidgetJson(a,e[a.uri])):f.push(d(this.widgetManager,a,b.portalUrl)))}));h(f).then(function(){n.resolve(b)})})):(a.visitElement(b,l.hitch(this,function(a){a.widgets||!a.uri&&!a.itemId||f.push(d(this.widgetManager,a,b.portalUrl))})),h(f).then(function(){n.resolve(b)}));setTimeout(function(){n.isResolved()||(e(b),n.resolve(b))},6E4);return n},_addNeedValuesForManifest:function(a,b){l.mixin(a,c.getUriInfo(b));c.manifest.addManifestProperies(a);
c.manifest.processManifestLabel(a,k.locale)},_loadMergedWidgetManifests:function(){return e(window.appInfo.appPath+"widgets/widgets-manifest.json",{handleAs:"json"})},_fixRepeatedId:function(b){var c=[];a.visitElement(b,function(a){0<=c.indexOf(a.id)&&(a.id+="_");c.push(a.id)})},_processUrlParams:function(a){var b=this.urlParams.itemid||this.urlParams.webmap;b&&a.map.itemId!==b&&(a.map.mapOptions&&c.deleteMapOptions(a.map.mapOptions),a.map.itemId=b);this.urlParams.mode&&(a.mode=this.urlParams.mode);
a.map.mapOptions||(a.map.mapOptions={});this.urlParams.scale&&(a.map.mapOptions.scale=this.urlParams.scale);if(this.urlParams.level||this.urlParams.zoom)a.map.mapOptions.zoom=this.urlParams.level||this.urlParams.zoom}});A.getInstance=function(a,b){null===z?z=new A(a,b):(z.urlParams=a,z.options=b);return z};return A})},"jimu/WidgetManager":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/html dojo/Deferred dojo/topic dojo/Evented dojo/on dojo/aspect dojo/json dojo/query dojo/request/xhr dojo/promise/all dijit/registry ./utils jimu/tokenUtils ./dijit/Message ./DataSourceManager".split(" "),
function(r,l,d,q,k,m,p,h,e,c,b,a,g,u,n,t,f,v){var x=null,w=r(p,{constructor:function(){this.loaded=[];this.missedActions=[];this.activeWidget=null;window.isBuilder?(m.subscribe("app/mapLoaded",l.hitch(this,this._onMapLoaded)),m.subscribe("app/mapChanged",l.hitch(this,this._onMapChanged))):(m.subscribe("mapLoaded",l.hitch(this,this._onMapLoaded)),m.subscribe("mapChanged",l.hitch(this,this._onMapChanged)));window.isBuilder?(m.subscribe("app/sceneViewLoaded",l.hitch(this,this._onSceneViewLoaded)),m.subscribe("app/sceneViewChanged",
l.hitch(this,this._onSceneViewChanged))):(m.subscribe("sceneViewLoaded",l.hitch(this,this._onSceneViewLoaded)),m.subscribe("sceneViewChanged",l.hitch(this,this._onSceneViewChanged)));window.isBuilder?(m.subscribe("app/appConfigLoaded",l.hitch(this,this._onAppConfigLoaded)),m.subscribe("app/appConfigChanged",l.hitch(this,this._onAppConfigChanged))):(m.subscribe("appConfigLoaded",l.hitch(this,this._onAppConfigLoaded)),m.subscribe("appConfigChanged",l.hitch(this,this._onAppConfigChanged)));m.subscribe("userSignIn",
l.hitch(this,this._onUserSignIn));m.subscribe("userSignOut",l.hitch(this,this._onUserSignOut));m.subscribe("builder/actionTriggered",l.hitch(this,this._onActionTriggered));m.subscribe("/dnd/move/start",l.hitch(this,this._onMoveStart))},loadWidget:function(a){var b=new k,c;a=l.clone(a);(c=this.getWidgetById(a.id))?b.resolve(c):g([this.loadWidgetClass(a),this.loadWidgetManifest(a)]).then(l.hitch(this,function(a){var c=a[0],d=a[1];this.loadWidgetResources(d).then(l.hitch(this,function(a){try{var e=this.createWidget(d,
c,a);q.setAttr(e.domNode,"data-widget-name",d.name);console.log("widget ["+d.uri+"] created.")}catch(G){console.log("create ["+d.uri+"] error:"+G.stack),new f({message:window.jimuNls.widgetManager.createWidgetError+": "+d.uri}),u.byId(d.id)&&u.byId(d.id).destroy(),b.reject(G)}setTimeout(l.hitch(this,function(){b.resolve(e);this.emit("widget-created",e);m.publish("widgetCreated",e)}),50)}),function(a){b.reject(a)})}),function(a){b.reject(a)});return b},loadWidgetClass:function(a){var b=new k,c;c=a.isRemote?
a.uri+".js":a.uri;require(n.getRequireConfig(),[c],l.hitch(this,function(a){b.resolve(a)}));n.checkError(a.uri,b);return b},loadWidgetResources:function(a){var b=new k,c,d,e,f=[];e=l.clone(a);a=this.tryLoadWidgetConfig(e);c=this._tryLoadResource(e,"i18n");d=this._tryLoadResource(e,"style");e=this._tryLoadResource(e,"template");f.push(a);f.push(c);f.push(e);f.push(d);g(f).then(l.hitch(this,function(a){var c={};c.config=a[0];c.i18n=a[1];c.template=a[2];c.style=a[3];b.resolve(c)}),function(a){b.reject(a)});
return b},loadWidgetManifest:function(b){var c=new k,d=n.getUriInfo(b.uri),d=d.isRemote?d.folderUrl+"manifest.json?f\x3djson":d.folderUrl+"manifest.json";if(b.manifest)return c.resolve(b),c;a(d,{handleAs:"json",headers:{"X-Requested-With":null}}).then(l.hitch(this,function(a){if(a.error&&a.error.code)return c.reject(a.error);a.category="widget";l.mixin(a,n.getUriInfo(b.uri));n.manifest.addI18NLabel(a).then(l.hitch(this,function(){this._processManifest(a);n.widgetJson.addManifest2WidgetJson(b,a);c.resolve(b)}))}),
function(a){c.reject(a)});return c},getWidgetMarginBox:function(a){if("string"===typeof a&&(a=this.getWidgetById(a),!a))return{};if(a._marginBox)return a._marginBox;a.setPosition({left:-9999,top:-9999,relativeTo:a.position.relativeTo});this.openWidget(a);a._marginBox=a.getMarginBox();this.closeWidget(a);return a._marginBox},_processManifest:function(a){n.manifest.addManifestProperies(a);n.manifest.processManifestLabel(a,window.dojoConfig.locale)},createWidget:function(a,b,c){if(this.getWidgetById(a.id))return this.getWidgetById(a.id);
c.config&&c.i18n&&(c.config=n.replacePlaceHolder(c.config,c.i18n));a.rawConfig=a.config;a.config=c.config||{};this.appConfig._appData&&this._mergeAgolConfig(a);a.nls=c.i18n||{};c.template&&(a.templateString=c.template);a["class"]="jimu-widget";a.label||(a.label=a.name);this.map&&(a.map=this.map);a.appConfig=this.appConfig;c={};for(var d in a)a.hasOwnProperty(d)&&(c[d]=a[d]);c.widgetManager=this;a=new b(c);a.clazz=b;e.after(a,"startup",l.hitch(this,this._postWidgetStartup,a));e.before(a,"destroy",
l.hitch(this,this._onDestroyWidget,a));h(a.domNode,"click",l.hitch(this,this._onClickWidget,a));this.loaded.push(a);return a},getAllWidgets:function(){return this.loaded},destroyAllWidgets:function(){var a=d.map(this.loaded,function(a){return a.id});d.forEach(a,function(a){this.destroyWidget(a)},this);this.loaded=[]},loadWidgetSettingPage:function(a){var b=new k;a=l.clone(a);a.id+="_setting";g([this.loadWidgetSettingClass(a)]).then(l.hitch(this,function(c){var d=c[0];this.loadWidgetSettingPageResources(a).then(l.hitch(this,
function(c){var g;c={nls:c.i18n,templateString:c.template,appConfig:this.appConfig,"class":"jimu-widget-setting"};"HTML3D"===window.appInfo.appType?c.sceneView=this.sceneView:c.map=this.map;for(var h in a)a.hasOwnProperty(h)&&(c[h]=a[h]);try{g=new d(c),q.setAttr(g.domNode,"data-widget-name-setting",c.name),e.before(g,"destroy",l.hitch(this,this._onDestroyWidgetSetting,g)),b.resolve(g)}catch(F){new f({message:window.jimuNls.widgetManager.createWidgetSettingPageError+":"+a.uri}),u.byId(c.id)&&u.byId(c.id).destroy(),
b.reject(F)}}),function(a){console.log(a)})}),function(a){b.reject(a)});return b},loadWidgetSettingClass:function(a){var b=new k,c;c=a.isRemote?a.folderUrl+"setting/Setting.js":a.amdFolder+"setting/Setting";require(n.getRequireConfig(),[c],l.hitch(this,function(a){b.resolve(a)}));n.checkError(a.folderUrl+"setting/Setting.js",b);return b},loadWidgetSettingPageResources:function(a){var b=new k,c,d,e=[];a=l.clone(a);c=this._tryLoadResource(a,"settingI18n");d=this._tryLoadResource(a,"settingTemplate");
a=this._tryLoadResource(a,"settingStyle");e.push(c);e.push(d);e.push(a);g(e).then(l.hitch(this,function(a){var c={};c.i18n=a[0]||{};c.template=a[1];c.style=a[2];b.resolve(c)}),function(a){console.log(a)});return b},getWidgetById:function(a){var b;d.some(this.loaded,function(c){if(c.id===a)return b=c,!0},this);return b},getWidgetByLabel:function(a){var b;d.some(this.loaded,function(c){if(c.label===a)return b=c,!0},this);return b},getWidgetsByName:function(a){var b=[];d.some(this.loaded,function(c){c.name===
a&&b.push(c)},this);return b},changeWindowStateTo:function(a,b){"normal"===b?this.normalizeWidget(a):"minimized"===b?this.minimizeWidget(a):"maximized"===b?this.maximizeWidget(a):console.log("error state: "+b)},closeWidget:function(a){if("string"===typeof a&&(a=this.getWidgetById(a),!a))return;if("closed"!==a.state){this.activeWidget&&this.activeWidget.id===a.id&&(this.activeWidget.onDeActive(),this.activeWidget=null);q.setStyle(a.domNode,"display","none");a.setState("closed");try{a.onClose()}catch(A){console.log(console.error("fail to close widget "+
a.name+". "+A.stack))}}this.appConfig.mode||this._removeDataSourceUsage(a)},openWidget:function(a){if("string"===typeof a&&(a=this.getWidgetById(a),!a))return;if(!a.started)try{a.started=!0,a.startup()}catch(A){console.error("fail to startup widget "+a.name+". "+A.stack)}if("closed"===a.state){q.setStyle(a.domNode,"display","");a.setState("opened");try{a.onOpen()}catch(A){console.error("fail to open widget "+a.name+". "+A.stack)}}this.appConfig.mode||this._addDataSourceUsage(a)},activateWidget:function(a){if("string"===
typeof a&&(a=this.getWidgetById(a),!a))return;"opened"===a.state&&this._activeWidget(a)},maximizeWidget:function(a){if("string"===typeof a&&(a=this.getWidgetById(a),!a))return;"closed"===a.state&&this.openWidget(a);a.setWindowState("maximized");try{a.onMaximize()}catch(A){console.log(console.error("fail to maximize widget "+a.name+". "+A.stack))}},minimizeWidget:function(a){if("string"===typeof a&&(a=this.getWidgetById(a),!a))return;"closed"===a.state&&this.openWidget(a);a.setWindowState("minimized");
try{a.onMinimize()}catch(A){console.log(console.error("fail to minimize widget "+a.name+". "+A.stack))}},normalizeWidget:function(a){if("string"===typeof a&&(a=this.getWidgetById(a),!a))return;"closed"===a.state&&this.openWidget(a);a.setWindowState("normal");try{a.onNormalize()}catch(A){console.log(console.error("fail to normalize widget "+a.name+". "+A.stack))}},destroyWidget:function(a){if("string"===typeof a&&(a=this.getWidgetById(a),!a))return;this._removeWidget(a);try{a.destroy()}catch(A){console.log(console.error("fail to destroy widget "+
a.name+". "+A.stack))}},tryLoadWidgetConfig:function(a){return this._tryLoadWidgetConfig(a).then(l.hitch(this,function(b){return this._upgradeWidgetConfig(a,b).then(function(b){return a.config=b})}))},triggerWidgetOpen:function(a){function b(a){var b=e.after(a,"onOpen",function(){b.remove();c.resolve(a)})}var c=new k,d=this.getWidgetById(a);if(d){if("closed"!==d.state)return c.resolve(d),c;b(d)}else var f=m.subscribe("widgetCreated",l.hitch(this,function(b){b.id===a&&(f.remove(),c.resolve(b))}));
m.publish("openWidget",a);return c},_tryLoadWidgetConfig:function(b){var d=new k;if(b.config&&l.isObject(b.config))return d.resolve(b.config),d;if(b.config){if(require.cache["url:"+b.config])return d.resolve(c.parse(require.cache["url:"+b.config])),d;d=n.processUrlInAppConfig(b.config);d=d.split("/");d[d.length-1]=encodeURIComponent(d[d.length-1]);d=d.join("/");return a(d,{handleAs:"json",headers:{"X-Requested-With":null}})}return this._tryLoadResource(b,"config").then(function(a){b.isDefaultConfig=
!0;return a})},_upgradeWidgetConfig:function(a,b){var c=new k,d=a.manifest.version,e=a.version,f;if(d===e)return c.resolve(b),c;if(!1===a.hasVersionManager)return a.version=d,c.resolve(b),c;require(n.getRequireConfig(),[a.amdFolder+"VersionManager"],l.hitch(this,function(g){g=new g;var h=g.getVersionIndex(e),n=g.getVersionIndex(d);if(h>n)c.reject("Bad widget version number, "+a.name+","+e);else try{f=g.upgrade(b,e,d),a.version=d,c.resolve(f)}catch(J){console.log("Read widget ["+a.name+"] old config error,"+
J.stack),c.resolve(b)}}));return c},loadWidgetStyle:function(a){var b=this._getStyleIdFromWidgetJson(a,!1),c=new k;return q.byId(b)?(c.resolve("load"),c):n.loadStyleLink(b,a.styleFile,"theme_"+this.appConfig.theme.name+"_style_common")},loadWidgetSettingStyle:function(a){var b=this._getStyleIdFromWidgetJson(a,!0),c=new k;return q.byId(b)?(c.resolve("load"),c):n.loadStyleLink(b,a.settingStyleFile)},loadWidgetConfig:function(b){b=require(n.getRequireConfig()).toUrl(b.configFile);if(require.cache["url:"+
b]){var d=new k;d.resolve(c.parse(require.cache["url:"+b]));return d}return a(b,{handleAs:"json",headers:{"X-Requested-With":null}})},loadWidgetI18n:function(a){var b=new k;require(n.getRequireConfig(),["dojo/i18n!"+a.i18nFile],function(a){b.resolve(a)});return b},loadWidgetSettingI18n:function(a){var b=new k;require(n.getRequireConfig(),["dojo/i18n!"+a.settingI18nFile],function(a){b.resolve(a)});return b},loadWidgetTemplate:function(a){var b=new k;require(n.getRequireConfig(),["dojo/text!"+a.templateFile],
function(a){b.resolve(a)});n.checkError(a.templateFile,b);return b},loadWidgetSettingTemplate:function(a){var b=new k;require(n.getRequireConfig(),["dojo/text!"+a.settingTemplateFile],function(a){b.resolve(a)});n.checkError(a.settingTemplateFile,b);return b},removeWidgetStyle:function(a){this._removeStyle(this._getStyleIdFromWidgetJson(a,!1))},removeWidgetSettingStyle:function(a){this._removeStyle(this._getStyleIdFromWidgetJson(a,!0))},_removeStyle:function(a){if(q.byId(a)){var b=q.attr(a,"data-import-styles");
if(b)for(var c=0;c<parseInt(b,10);c++)q.destroy(a+"_import_"+c);q.destroy(a)}},_getStyleIdFromWidgetJson:function(a,b){return this._replaceId("widget/style/"+(a.itemId?a.itemId:a.uri)+(b?"/setting":""))},getControllerWidgets:function(){return d.filter(this.loaded,function(a){return a.isController})},getOffPanelWidgets:function(){return d.filter(this.loaded,function(a){return!a.inPanel})},getOnScreenOffPanelWidgets:function(){return d.filter(this.loaded,function(a){return a.isOnScreen&&!a.inPanel})},
closeOtherWidgetsInTheSameGroup:function(a){if("string"===typeof a&&(a=this.getWidgetById(a),!a))return;for(var b=0;b<this.loaded.length;b++)this.loaded[b].gid===a.gid&&this.loaded[b].id!==a.id&&this.closeWidget(this.loaded[b])},closeAllWidgetsInGroup:function(a){for(var b=0;b<this.loaded.length;b++)this.loaded[b].gid===a&&this.closeWidget(this.loaded[b])},_addDataSourceUsage:function(a){d.forEach(this._getUsedDataSourceIdFromWidget(a),function(b){v.getInstance().addDataSourceUsage(b,a.id)})},_removeDataSourceUsage:function(a){d.forEach(this._getUsedDataSourceIdFromWidget(a),
function(b){v.getInstance().removeDataSourceUsage(b,a.id)})},_getUsedDataSourceIdFromWidget:function(a){if((a=this.appConfig.getConfigElementById(a.id))&&a.config){var b=c.stringify(a.config);return d.filter(Object.keys(this.appConfig.dataSource.dataSources),function(a){return-1<b.indexOf(a)},this)}},_mergeAgolConfig:function(a){var b=this.appConfig._appData.values,c="widgets["+a.id+"]",d;for(d in b){var e=d.replace(/\//g,"_").indexOf(c+"_config");0<=e&&n.template.setConfigValue(a,d.replace(/\//g,
"_").substr(e,d.length).replace(c,"widget"),b[d])}},_onUserSignIn:function(a){d.forEach(this.loaded,function(b){b.onSignIn(a)},this)},_onUserSignOut:function(){d.forEach(this.loaded,function(a){a.onSignOut()},this)},_activeWidget:function(a){if(this.activeWidget){if(this.activeWidget.id===a.id){!1===this.activeWidget.inPanel&&this.activeWidget.moveTopOnActive&&q.setStyle(this.activeWidget.domNode,"zIndex",101);return}"active"===this.activeWidget.state&&(this.activeWidget.setState("opened"),!1===this.activeWidget.inPanel&&
q.setStyle(a.domNode,"zIndex","zIndex"in a.position?a.position.zIndex:"auto"),this.activeWidget.onDeActive())}this.activeWidget=a;"opened"===this.activeWidget.state&&(this.activeWidget.setState("active"),!1===this.activeWidget.inPanel&&this.activeWidget.moveTopOnActive&&q.setStyle(this.activeWidget.domNode,"zIndex",101),this.activeWidget.onActive(),m.publish("widgetActived",a))},_onClickWidget:function(a,c){var d=b(".jimu-widget",a.domNode);if(0<d.length)for(var e=0;e<d.length;e++)if(c.target===d[e]||
q.isDescendant(c.target,d[e]))return;this._activeWidget(a)},_onMoveStart:function(a){d.forEach(this.loaded,function(b){b.domNode===a.node&&this._activeWidget(b)},this)},_onAppConfigLoaded:function(a){this.appConfig=a=l.clone(a);t.setPortalUrl(a.portalUrl)},_onMapLoaded:function(a){this.map=a},_onMapChanged:function(a){this.map=a},_onSceneViewLoaded:function(a){this.sceneView=a},_onSceneViewChanged:function(a){this.sceneView=a},_onAppConfigChanged:function(a,b,c,e){var f=l.clone(a);this.appConfig=
f;d.forEach(this.loaded,function(a){a&&(a.onAppConfigChanged(f,b,c,e),"widgetChange"===b&&this._onConfigChanged(c.id,c.config,e))},this)},_onConfigChanged:function(a,b){var c=this.getWidgetById(a);c&&(c.onConfigChanged(b),l.mixin(c.config,b))},_onActionTriggered:function(a){if("map"!==a.elementId&&"app"!==a.elementId){var b=this.getWidgetById(a.elementId);if(b)b.onAction(a.action,a.data);else this.missedActions.push({id:a.elementId,action:{name:a.action,data:a.data}});d.forEach(this.getControllerWidgets(),
function(b){if(b.widgetIsControlled(a.elementId))b.onAction(a.action,{widgetId:a.elementId,data:a.data})},this)}},_postWidgetStartup:function(a){a.started=!0;n.setVerticalCenter(a.domNode);e.after(a,"resize",l.hitch(this,n.setVerticalCenter,a.domNode));this.openWidget(a);var b=t.getPortalCredential(this.appConfig.portalUrl);if(b)a.onSignIn(b);else a.onSignOut();this._triggerMissedAction(a)},_triggerMissedAction:function(a){this.missedActions.forEach(function(b){if(b.id===a.id)a.onAction(b.action.name,
b.action.data)})},_remove:function(a){return d.some(this.loaded,function(b,c){if(b.id===a)return this.loaded.splice(c,1),!0},this)},_tryLoadResource:function(a,b){var c,d=new k;if("config"===b)c=a.amdFolder+"config.json",a.configFile=c,c="hasConfig";else if("style"===b)c=a.amdFolder+"css/style.css",a.styleFile=c,c="hasStyle";else if("i18n"===b)c=a.amdFolder+"nls/strings.js",a.i18nFile=a.isRemote?c:a.amdFolder+"nls/strings",c="hasLocale";else if("template"===b)c=a.amdFolder+"Widget.html",a.templateFile=
c,c="hasUIFile";else if("settingTemplate"===b)c=a.amdFolder+"setting/Setting.html",a.settingTemplateFile=c,c="hasSettingUIFile";else if("settingI18n"===b)c=a.amdFolder+"setting/nls/strings.js",a.settingI18nFile=a.isRemote?c:a.amdFolder+"setting/nls/strings",c="hasSettingLocale";else if("settingStyle"===b)c=a.amdFolder+"setting/css/style.css",a.settingStyleFile=c,c="hasSettingStyle";else return d;a[c]?function(){var c;if("config"===b)c=this.loadWidgetConfig(a);else if("style"===b)c=this.loadWidgetStyle(a);
else if("i18n"===b)c=this.loadWidgetI18n(a);else if("template"===b)c=this.loadWidgetTemplate(a);else if("settingTemplate"===b)c=this.loadWidgetSettingTemplate(a);else if("settingStyle"===b)c=this.loadWidgetSettingStyle(a);else if("settingI18n"===b)c=this.loadWidgetSettingI18n(a);else return d;c.then(function(a){d.resolve(a)},function(b){new f({message:window.jimuNls.widgetManager.loadWidgetResourceError+": "+a.uri});d.reject(b)})}.apply(this):d.resolve(null);return d},_replaceId:function(a){return a.replace(/\//g,
"_").replace(/\./g,"_")},_onDestroyWidget:function(a){"closed"!==a.state&&this.closeWidget(a);this._removeWidget(a);this.emit("widget-destroyed",a.id);m.publish("widgetDestroyed",a.id);console.log("destroy widget ["+a.uri+"].")},_onDestroyWidgetSetting:function(a){this.removeWidgetSettingStyle(a)},_removeWidget:function(a){if("string"===typeof a&&(a=this.getWidgetById(a),!a))return;this.activeWidget&&this.activeWidget.id===a.id&&(this.activeWidget=null);this._remove(a.id);0===this.getWidgetsByName(a.name).length&&
this.removeWidgetStyle(a)}});w.getInstance=function(a){null===x&&(x=new w(a),window._widgetManager=x);return x};return w})},"jimu/AppStateManager":function(){define("dojo/_base/declare dojo/_base/lang dojo/Deferred dojo/json esri/geometry/Extent esri/SpatialReference libs/storejs/store libs/md5/md5 jimu/tokenUtils".split(" "),function(r,l,d,q,k,m,p,h,e){var c=null,b=r(null,{rawAppConfig:null,mapMd5:null,appStateKey:null,setRawAppConfig:function(a){this.rawAppConfig=a},_getAppStateMd5:function(){if("string"!==
typeof this.mapMd5){var a=q.stringify(this.rawAppConfig.map);this.mapMd5=h(a)}return this.mapMd5},_getAppStateKey:function(){return this.appStateKey?this.appStateKey:this.appStateKey="wab_appstate_"+this.urlParams.id||this.urlParams.appid||window.path},getWabAppState:function(){var a=new d,b={};if(e.isInConfigOrPreviewWindow()||!this.rawAppConfig||!this.rawAppConfig.map)return a.resolve(b),a;var c=this._getAppStateKey(),h=p.get(c);h&&h.appStateMd5===this._getAppStateMd5()?(c=h.map&&h.map.extent,h=
h.map&&h.map.layers,c&&(b.extent=new k(c.xmin,c.ymin,c.xmax,c.ymax,new m(c.spatialReference))),h&&(b.layers=h)):p.remove(c);a.resolve(b);return a},saveWabAppState:function(a,b){if(a&&!e.isInConfigOrPreviewWindow()){var c=this._getAppStateKey(),d={extent:{xmin:a.extent.xmin,xmax:a.extent.xmax,ymin:a.extent.ymin,ymax:a.extent.ymax,spatialReference:{wkid:a.extent.spatialReference.wkid,wkt:a.extent.spatialReference.wkt}},layers:{}};b&&b.traversal&&b.traversal(l.hitch(this,function(a){d.layers[a.id]={visible:a.isVisible()}}));
p.set(c,{map:d,appStateMd5:this._getAppStateMd5()})}}});b.getInstance=function(a){null===c&&(c=new b);c.urlParams=a;return c};return b})},"libs/storejs/store":function(){(function(r){var l={},d=r.document,q;l.disabled=!1;l.set=function(c,b){};l.get=function(c){};l.remove=function(c){};l.clear=function(){};l.transact=function(c,b,a){var d=l.get(c);null==a&&(a=b,b=null);"undefined"==typeof d&&(d=b||{});a(d);l.set(c,d)};l.getAll=function(){};l.forEach=function(){};l.serialize=function(c){return JSON.stringify(c)};
l.deserialize=function(c){if("string"==typeof c)try{return JSON.parse(c)}catch(b){return c||void 0}};var k;try{k="localStorage"in r&&r.localStorage}catch(c){k=!1}if(k)q=r.localStorage,l.set=function(c,b){if(void 0===b)return l.remove(c);q.setItem(c,l.serialize(b));return b},l.get=function(c){return l.deserialize(q.getItem(c))},l.remove=function(c){q.removeItem(c)},l.clear=function(){q.clear()},l.getAll=function(){var c={};l.forEach(function(b,a){c[b]=a});return c},l.forEach=function(c){for(var b=
0;b<q.length;b++){var a=q.key(b);c(a,l.get(a))}};else if(d.documentElement.addBehavior){var m=function(c){return c.replace(/^d/,"___$\x26").replace(e,"___")};k=function(c){return function(){var b=Array.prototype.slice.call(arguments,0);b.unshift(q);p.appendChild(q);q.addBehavior("#default#userData");q.load("localStorage");b=c.apply(l,b);p.removeChild(q);return b}};var p,h;try{h=new ActiveXObject("htmlfile"),h.open(),h.write('\x3cscript\x3edocument.w\x3dwindow\x3c/script\x3e\x3ciframe src\x3d"/favicon.ico"\x3e\x3c/iframe\x3e'),
h.close(),p=h.w.frames[0].document,q=p.createElement("div")}catch(c){q=d.createElement("div"),p=d.body}var e=RegExp("[!\"#$%\x26'()*+,/\\\\:;\x3c\x3d\x3e?@[\\]^`{|}~]","g");l.set=k(function(c,b,a){b=m(b);if(void 0===a)return l.remove(b);c.setAttribute(b,l.serialize(a));c.save("localStorage");return a});l.get=k(function(c,b){b=m(b);return l.deserialize(c.getAttribute(b))});l.remove=k(function(c,b){b=m(b);c.removeAttribute(b);c.save("localStorage")});l.clear=k(function(c){var b=c.XMLDocument.documentElement.attributes;
c.load("localStorage");for(var a=0,d;d=b[a];a++)c.removeAttribute(d.name);c.save("localStorage")});l.getAll=function(c){var b={};l.forEach(function(a,c){b[a]=c});return b};l.forEach=k(function(c,b){for(var a=c.XMLDocument.documentElement.attributes,d=0,e;e=a[d];++d)b(e.name,l.deserialize(c.getAttribute(e.name)))})}try{l.set("__storejs__","__storejs__"),"__storejs__"!=l.get("__storejs__")&&(l.disabled=!0),l.remove("__storejs__")}catch(c){l.disabled=!0}l.enabled=!l.disabled;"undefined"!=typeof module&&
module.exports&&this.module!==module?module.exports=l:"function"===typeof define&&define.amd?define(l):r.store=l})(Function("return this")())},"libs/md5/md5":function(){(function(r){function l(a,b){var c=(a&65535)+(b&65535);return(a>>16)+(b>>16)+(c>>16)<<16|c&65535}function d(a,b,c,d,e,g){a=l(l(b,a),l(d,g));return l(a<<e|a>>>32-e,c)}function q(a,b,c,e,g,h,k){return d(b&c|~b&e,a,b,g,h,k)}function k(a,b,c,e,g,h,k){return d(b&e|c&~e,a,b,g,h,k)}function m(a,b,c,e,g,h,k){return d(c^(b|~e),a,b,g,h,k)}function p(a,
b){a[b>>5]|=128<<b%32;a[(b+64>>>9<<4)+14]=b;var c,e,g,h,n,p=1732584193,u=-271733879,r=-1732584194,B=271733878;for(c=0;c<a.length;c+=16)e=p,g=u,h=r,n=B,p=q(p,u,r,B,a[c],7,-680876936),B=q(B,p,u,r,a[c+1],12,-389564586),r=q(r,B,p,u,a[c+2],17,606105819),u=q(u,r,B,p,a[c+3],22,-1044525330),p=q(p,u,r,B,a[c+4],7,-176418897),B=q(B,p,u,r,a[c+5],12,1200080426),r=q(r,B,p,u,a[c+6],17,-1473231341),u=q(u,r,B,p,a[c+7],22,-45705983),p=q(p,u,r,B,a[c+8],7,1770035416),B=q(B,p,u,r,a[c+9],12,-1958414417),r=q(r,B,p,u,a[c+
10],17,-42063),u=q(u,r,B,p,a[c+11],22,-1990404162),p=q(p,u,r,B,a[c+12],7,1804603682),B=q(B,p,u,r,a[c+13],12,-40341101),r=q(r,B,p,u,a[c+14],17,-1502002290),u=q(u,r,B,p,a[c+15],22,1236535329),p=k(p,u,r,B,a[c+1],5,-165796510),B=k(B,p,u,r,a[c+6],9,-1069501632),r=k(r,B,p,u,a[c+11],14,643717713),u=k(u,r,B,p,a[c],20,-373897302),p=k(p,u,r,B,a[c+5],5,-701558691),B=k(B,p,u,r,a[c+10],9,38016083),r=k(r,B,p,u,a[c+15],14,-660478335),u=k(u,r,B,p,a[c+4],20,-405537848),p=k(p,u,r,B,a[c+9],5,568446438),B=k(B,p,u,r,
a[c+14],9,-1019803690),r=k(r,B,p,u,a[c+3],14,-187363961),u=k(u,r,B,p,a[c+8],20,1163531501),p=k(p,u,r,B,a[c+13],5,-1444681467),B=k(B,p,u,r,a[c+2],9,-51403784),r=k(r,B,p,u,a[c+7],14,1735328473),u=k(u,r,B,p,a[c+12],20,-1926607734),p=d(u^r^B,p,u,a[c+5],4,-378558),B=d(p^u^r,B,p,a[c+8],11,-2022574463),r=d(B^p^u,r,B,a[c+11],16,1839030562),u=d(r^B^p,u,r,a[c+14],23,-35309556),p=d(u^r^B,p,u,a[c+1],4,-1530992060),B=d(p^u^r,B,p,a[c+4],11,1272893353),r=d(B^p^u,r,B,a[c+7],16,-155497632),u=d(r^B^p,u,r,a[c+10],23,
-1094730640),p=d(u^r^B,p,u,a[c+13],4,681279174),B=d(p^u^r,B,p,a[c],11,-358537222),r=d(B^p^u,r,B,a[c+3],16,-722521979),u=d(r^B^p,u,r,a[c+6],23,76029189),p=d(u^r^B,p,u,a[c+9],4,-640364487),B=d(p^u^r,B,p,a[c+12],11,-421815835),r=d(B^p^u,r,B,a[c+15],16,530742520),u=d(r^B^p,u,r,a[c+2],23,-995338651),p=m(p,u,r,B,a[c],6,-198630844),B=m(B,p,u,r,a[c+7],10,1126891415),r=m(r,B,p,u,a[c+14],15,-1416354905),u=m(u,r,B,p,a[c+5],21,-57434055),p=m(p,u,r,B,a[c+12],6,1700485571),B=m(B,p,u,r,a[c+3],10,-1894986606),r=
m(r,B,p,u,a[c+10],15,-1051523),u=m(u,r,B,p,a[c+1],21,-2054922799),p=m(p,u,r,B,a[c+8],6,1873313359),B=m(B,p,u,r,a[c+15],10,-30611744),r=m(r,B,p,u,a[c+6],15,-1560198380),u=m(u,r,B,p,a[c+13],21,1309151649),p=m(p,u,r,B,a[c+4],6,-145523070),B=m(B,p,u,r,a[c+11],10,-1120210379),r=m(r,B,p,u,a[c+2],15,718787259),u=m(u,r,B,p,a[c+9],21,-343485551),p=l(p,e),u=l(u,g),r=l(r,h),B=l(B,n);return[p,u,r,B]}function h(a){var b,c="";for(b=0;b<32*a.length;b+=8)c+=String.fromCharCode(a[b>>5]>>>b%32&255);return c}function e(a){var b,
c=[];c[(a.length>>2)-1]=void 0;for(b=0;b<c.length;b+=1)c[b]=0;for(b=0;b<8*a.length;b+=8)c[b>>5]|=(a.charCodeAt(b/8)&255)<<b%32;return c}function c(a){return h(p(e(a),8*a.length))}function b(a,b){var c,d=e(a),g=[],k=[];g[15]=k[15]=void 0;16<d.length&&(d=p(d,8*a.length));for(c=0;16>c;c+=1)g[c]=d[c]^909522486,k[c]=d[c]^1549556828;c=p(g.concat(e(b)),512+8*b.length);return h(p(k.concat(c),640))}function a(a){var b="",c,d;for(d=0;d<a.length;d+=1)c=a.charCodeAt(d),b+="0123456789abcdef".charAt(c>>>4&15)+
"0123456789abcdef".charAt(c&15);return b}function g(d,e,g){e?g?d=b(unescape(encodeURIComponent(e)),unescape(encodeURIComponent(d))):(d=b(unescape(encodeURIComponent(e)),unescape(encodeURIComponent(d))),d=a(d)):d=g?c(unescape(encodeURIComponent(d))):a(c(unescape(encodeURIComponent(d))));return d}"function"===typeof define&&define.amd?define(function(){return g}):r.md5=g})(this)},"builder/portalUtils":function(){define(["jimu/portalUtils"],function(r){return r})},"builder/plugins/app-actions/to-template-config/_build-generate_module":function(){define(["builder/plugins/app-actions/to-template-config/Plugin",
"dojo/text!builder/plugins/app-actions/to-template-config/css/style.css","dojo/i18n!builder/plugins/app-actions/to-template-config/nls/strings"],function(){})},"builder/plugins/app-actions/to-template-config/Plugin":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/topic","dojo/on","builder/BasePlugin"],function(r,l,d,q,k){return r([k],{baseClass:"plugin-app-actions-to-template-config",templateString:'\x3cdiv\x3e\x3cdiv class\x3d"footer-button" title\x3d"${nls.label}" data-dojo-attach-point\x3d"actionNode"\x3e${nls.label}\x3c/div\x3e\x3c/div\x3e',
postCreate:function(){this.inherited(arguments);this.visible=!1;this.own(q(this.domNode,"click",l.hitch(this,this._onClick)));this._bindEvent()},_bindEvent:function(){this.own(d.subscribe("app/appConfigLoaded",l.hitch(this,this._setAppConfig)));this.own(d.subscribe("app/appConfigChanged",l.hitch(this,this._setAppConfig)))},_onClick:function(){this.pluginManager.getPluginByName("app-config").switchToConfigTemplate()},_setAppConfig:function(d){this.appConfig=d;this.visible=!d.templateConfig||d.isTemplateApp||
d._appData?!1:!0}})})},"builder/plugins/app-config/_build-generate_module":function(){define(["builder/plugins/app-config/Plugin","dojo/text!builder/plugins/app-config/Plugin.html","dojo/text!builder/plugins/app-config/css/style.css"],function(){})},"builder/plugins/app-config/Plugin":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/html dojo/on dojo/topic dojo/promise/all dojo/query builder/utils jimu/utils jimu/WidgetManager jimu/dijit/ViewStack jimu/dijit/LoadingShelter jimu/dijit/AGOLLoading jimu/ConfigLoader jimu/LayerInfos/LayerInfos esri/tasks/GeometryService esri/config builder/BasePlugin".split(" "),
function(r,l,d,q,k,m,p,h,e,c,b,a,g,u,n,t,f,v,x){return r([x],{baseClass:"plugin-config-app",_PreviewMoreIframeSrc:"",_isPortrait:!0,_deviceInfo:null,appId:null,postCreate:function(){this.inherited(arguments);this.atLoading=new u({loadingText:window.jimuNls.loadingShelter.loading+"..."});this.atLoading.placeAt(this.domNode);this.atLoading.show();this.optsLoading=new g({loadingText:"",hidden:!0,showLoading:!1});this.optsLoading.placeAt(this.leftPaneNode);this.republishEvents=[];this.pluginsLoadDefs=
[];this._createAppTemplateViewStack();this._createOptsViewStack();this._createPreviewViewStack();this._bindEvent();this.saveTemplatePluginBox=this.saveAppPluginBox=null},startup:function(){this.pluginsLoadDefs.push(this._loadConfigOptsPlugin());this.pluginsLoadDefs.push(this._loadMorePreviewOptsPlugin());this.pluginsLoadDefs.push(this._loadTemplateConfigOptsPlugin());this.pluginsLoadDefs.push(this._loadConfigTemplatePlugin());this.pluginsLoadDefs.push(this._createMainAppActions());this.pluginsLoadDefs.push(this._createPopupAppActions());
this.widgetManager=b.getInstance();this._defineSetConfigViewerTopicFunction();this._defineSetPreviewViewerTopicFunction();this._updateAppId()},addRepublishEvent:function(a){a=a.replace(/\s/g,"");-1<this.republishEvents.indexOf(a)||(this.republishEvents.push(a),this.own(m.subscribe(a,l.hitch(this,function(b){window.verboseLog&&("actionTriggered"!==a||"actionTriggered"===a&&"editLayout"===b.action)&&console.log("Builer event:","builder/"+a,b);this.configViewerTopic.publish("builder/"+a,b)}))))},showLoadingCover:function(){this.optsLoading.show()},
hideLoadingCover:function(){this.optsLoading.hide()},switchToPreviewConfig:function(){this.optsViewStack.switchView(this.configOptsPaneNode);this.previewViewStack.switchView(this.previewConfig);this.pluginManager.getPluginByName("app-config-template-configpart").visible=!1},switchToTemplateConfigPart:function(){this.optsViewStack.switchView(this.templateOptsPaneNode);this.previewViewStack.switchView(this.previewConfig);var a=this.pluginManager.getPluginByName("app-config-template-configpart");a.visible=
!0;a.refresh()},switchToPreviewMore:function(){this.optsViewStack.switchView(this.morePreviewOptsPaneNode);this.previewViewStack.switchView(this.previewMore);this._showPreviewMore()},switchToConfigApp:function(a){q.setStyle(this.configAppNode,"visibility","visible");a=a||this.appConfig;this.atViewStack.switchView(this.configAppNode);a.templateConfig&&a.isTemplateApp||a.templateConfig&&a._appData?this.switchToTemplateConfigPart():(a=this.pluginManager.getPluginByName("app-actions.preview-app"))&&"config"!==
a.mode?this.switchToPreviewMore():this.switchToPreviewConfig();(a=this.pluginManager.getPluginByName("app-actions.save-app"))&&this.saveAppPluginBox&&q.place(a.domNode,this.saveAppPluginBox);this.pluginManager.getPluginByName("app-config-templateconfig").visible=!1},switchToConfigTemplate:function(){q.setStyle(this.configAppNode,"visibility","hidden");this.atViewStack.switchView(this.configTemplateNode);this.switchToPreviewConfig();var a=this.pluginManager.getPluginByName("app-actions.save-app");
a&&this.saveTemplatePluginBox&&q.place(a.domNode,this.saveTemplatePluginBox);a=this.pluginManager.getPluginByName("app-config-templateconfig");a.visible=!0;a.refresh()},_bindEvent:function(){this.own(m.subscribe("app/preloadWidgetsLoaded",l.hitch(this,this._onPreloadWidgetsLoaded)));this.own(m.subscribe("app/mapCreatedFailed",l.hitch(this,this._onMapCreatedFailed)));this.own(k(this.btnPortrait,"click",l.hitch(this,function(){this._resizePreviewMore(!0)})));this.own(k(this.btnLandscape,"click",l.hitch(this,
function(){this._resizePreviewMore(!1)})));this.own(k(document.body,"click",l.hitch(this,function(){q.setStyle(this.popupActionsMenu,"display","none")})));this.own(m.subscribe("iframeClick",l.hitch(this,function(){q.setStyle(this.popupActionsMenu,"display","none")})));this._bindFrameEvent()},_bindFrameEvent:function(){this.own(k(this.previewConfigFrameNode,"load",l.hitch(this,function(){window.configWindow=this.previewConfigFrameNode.contentWindow;this.own(k(this.previewConfigFrameNode.contentWindow.document.body,
"click",l.hitch(this,function(a){m.publish("iframeClick",a)})))})));this.own(k(this.previewMoreFrameNode,"load",l.hitch(this,function(){window.previewWindow=this.previewMoreFrameNode.contentWindow;this.own(k(this.previewMoreFrameNode.contentWindow.document.body,"click",l.hitch(this,function(a){m.publish("iframeClick",a)})))})))},_createAppTemplateViewStack:function(){this.atViewStack=new a({viewType:"dom",views:[this.configAppNode,this.configTemplateNode]},this.atViewStackNode)},_createOptsViewStack:function(){this.optsViewStack=
new a({viewType:"dom",views:[this.configOptsPaneNode,this.morePreviewOptsPaneNode,this.templateOptsPaneNode]},this.optsViewStackNode)},_createPreviewViewStack:function(){this.previewViewStack=new a({viewType:"dom",views:[this.previewConfig,this.previewMore]},this.rightPreviewSection)},_defineSetConfigViewerTopicFunction:function(){window.setConfigViewerTopic=l.hitch(this,function(a){this.configViewerTopic=a;this.own(this.configViewerTopic.subscribe("appConfigLoaded",l.hitch(this,this.onAppConfigLoaded)));
this.own(this.configViewerTopic.subscribe("appConfigChanged",l.hitch(this,this.onAppConfigChanged)));this.own(this.configViewerTopic.subscribe("mapLoaded",l.hitch(this,this.onMapLoaded)));this.own(this.configViewerTopic.subscribe("mapChanged",l.hitch(this,this.onMapChanged)));this.own(this.configViewerTopic.subscribe("sceneViewLoaded",l.hitch(this.onSceneViewLoaded)));this.own(this.configViewerTopic.subscribe("sceneViewChanged",l.hitch(this.onSceneViewChanged)));this.own(this.configViewerTopic.subscribe("preloadWidgetsLoaded",
l.hitch(this,this.onPreloadWidgetsLoaded)));this.own(this.configViewerTopic.subscribe("mapCreatedFailed",l.hitch(this,this.onMapCreatedFailed)));this.own(this.configViewerTopic.subscribe("layoutDefinitionChanged",l.hitch(this,this.onLayoutDefinitionChanged)));this.own(this.configViewerTopic.subscribe("editLayoutCancelled",l.hitch(this,this.onEditLayoutCancelled)));this.own(this.configViewerTopic.subscribe("dataSourceDataUpdated",l.hitch(this,this.onDataSourceDataUpdated)));this.own(this.configViewerTopic.subscribe("editLayout",
l.hitch(this,this.onEditLayout)));this._onConfigViewerLoaded()})},_defineSetPreviewViewerTopicFunction:function(){window.setPreviewViewerTopic=l.hitch(this,function(a){this.previewViewerTopic=a;a=l.clone(this.appConfig);a.mode="preview";this.previewViewerTopic.publish("builder/setAppConfig",a);this.own(this.previewViewerTopic.subscribe("mapLoaded",l.hitch(this,function(){this._syncPreviewMapExtentWithConfigMapExtent()})));this.own(this.previewViewerTopic.subscribe("sceneViewLoaded",l.hitch(this,function(){this._syncPreviewViewpointWithConfigViewpoint()})));
this._onPreviewViewerLoaded()})},_loadConfigOptsPlugin:function(){var a=this.filterExtensionsByAppType("config-part",this.options.appInfo.appType),a=this.pluginsMeta[a[0].pluginName];a.options=this.options;return this.pluginManager.loadPlugin(a).then(l.hitch(this,function(a){q.place(a.domNode,this.configOptsPaneNode);a.startup();return a}))},_loadMorePreviewOptsPlugin:function(){var a=this.filterExtensionsByAppType("morepreview-selction-part",this.options.appInfo.appType);if(0!==a.length)return this.pluginManager.loadPlugin(this.pluginsMeta[a[0].pluginName]).then(l.hitch(this,
function(a){q.place(a.domNode,this.morePreviewOptsPaneNode);a.startup();return a}))},_updateAppId:function(){window.jimuConfig.widgetsPackage={name:"widgets",location:window.appInfo.appPath+"widgets"};window.jimuConfig.themesPackage={name:"themes",location:window.appInfo.appPath+"themes"};window.jimuConfig.configsPackage={name:"configs",location:window.appInfo.appPath+"configs"};var a=c.urlToObject(window.location.href).query||{},b=window.appInfo.appPath+"index.html";delete a.id;window.isXT||a.appid||
(b=b+"?id\x3d"+window.appInfo.id);a.mode="preview";this._PreviewMoreIframeSrc=e.appendParamsToAppPath(b,a);a.mode="config";q.attr(this.previewConfigFrameNode,"src",e.appendParamsToAppPath(b,a))},_onConfigViewerLoaded:function(){p(this.pluginsLoadDefs).then(l.hitch(this,function(){window.stemappInfo.appVersionManager?require([window.appInfo.appPath+window.stemappInfo.appVersionManager],l.hitch(this,function(a){this._loadAppConfig(a)})):this._loadAppConfig()}))},_loadAppConfig:function(a){var b=c.urlToObject(window.location.href).query||
{};window.isXT?(delete b.id,b.config=window.appInfo.appPath+"config.json"):(b.appid&&(b.config=window.path+"stemapp/config.json"),"stemapp"===b.id&&(b.config=window.path+"stemapp/config.json",delete b.id));b.mode="config";n.getInstance(b,{versionManager:a?new a:null}).loadConfig().then(l.hitch(this,function(a){this.atLoading.hide();this.showLoadingCover();a.templateConfig&&a.isTemplateApp||a.templateConfig&&a._appData||!a.templateConfig?(this.switchToConfigApp(a),a.templateConfig?p(this._loadWidgetConfigsInTemplateConfig(a)).then(l.hitch(this,
function(){this.configViewerTopic.publish("builder/setAppConfig",a)})):this.configViewerTopic.publish("builder/setAppConfig",a)):(this.switchToConfigTemplate(),this.configViewerTopic.publish("builder/setAppConfig",a))}))},_loadWidgetConfigsInTemplateConfig:function(a){var b=c.template.getConfigedWidgetsByTemplateConfig(a.templateConfig),e=[];d.forEach(b,function(b){b=a.getConfigElementById(b);e.push(this.widgetManager.tryLoadWidgetConfig(b))},this);return e},_onPreviewViewerLoaded:function(){},previewOnDevice:function(a,
b){this._deviceInfo=a;q.setStyle(this.previewMoreDes,"display","block");this.previewMoreDes.innerHTML=b?a.width+" x "+a.height:a.title+" "+a.width+" x "+a.height;this._resizePreviewMore(this._isPortrait)},_createMainAppActions:function(){var a=this.filterExtensionsByAppType("main-app-actions",window.appInfo.appType),b=360/a.length;a.sort(function(a,b){return a.parameters.index-b.parameters.index});d.forEach(a,function(a,c){this._createMainAppActionNode(a,c,b)},this);return p([])},_createMainAppActionNode:function(a,
b,c){0<b&&q.create("div",{"class":"seprate jimu-float-leading"},this.mainActionBoxNode);var d=q.create("div",{"class":"footer-button-box jimu-float-leading",pname:a.pluginName},this.mainActionBoxNode);q.setStyle(d,"width",c+"px");b=this.pluginsMeta[a.pluginName];b.options=this.options.appInfo;return this.pluginManager.loadPlugin(b).then(l.hitch(this,function(b){"app-actions.save-app"===a.pluginName&&(this.saveAppPluginBox=d);q.place(b.domNode,d);b.startup();return b}))},_refreshAppActions:function(){var a=
this.filterExtensionsByAppType("main-app-actions",window.appInfo.appType),b=0;d.forEach(a,function(a){var c=this.pluginManager.getPluginByName(a.pluginName);a=h('div[pname\x3d"'+a.pluginName+'"]',this.mainActionBoxNode)[0];!1===c.visible?q.setStyle(a,"display","none"):(q.setStyle(a,"display",""),b++)},this);var c=360/b,a=h(".footer-button-box",this.mainActionBoxNode);d.forEach(a,function(a){q.setStyle(a,"width",c+"px")})},_createPopupAppActions:function(){var a=this.filterExtensionsByAppType("popup-app-actions",
window.appInfo.appType);a.sort(function(a,b){return a.parameters.index-b.parameters.index});if(0===a.length)q.setStyle(this.btnArrow,"display","none");else{q.setStyle(this.popupActionsMenu,"top",-30*a.length+"px");var b=[];d.forEach(a,function(a){b.push(this._createPopupAppActionNode(a))},this);return p(b)}},_createPopupAppActionNode:function(a){var b=a.parameters,c=q.create("div",{id:a.pluginName},this.popupActionsMenu);return this.pluginManager.loadPlugin(this.pluginsMeta[a.pluginName]).then(l.hitch(this,
function(a){c.innerHTML=a.label;this.own(k(c,"click",l.hitch(a,a[b.onClickAction])));return a}))},_onBtnArrowClick:function(a){if("none"===q.getStyle(this.popupActionsMenu,"display")){q.setStyle(this.popupActionsMenu,"display","block");var b=this.filterExtensionsByAppType("popup-app-actions",window.appInfo.appType),c=0;d.forEach(b,function(a){var b=this.pluginManager.getPluginByName(a.pluginName);a=h('div[id\x3d"'+a.pluginName+'"]',this.popupActionsMenu)[0];a.innerHTML=b.label;!1===b.visible?q.setStyle(a,
"display","none"):(q.setStyle(a,"display",""),c++);b.disabled?q.addClass(a,"disable"):a&&q.removeClass(a,"disable")},this);q.setStyle(this.popupActionsMenu,"top",-30*c+"px")}else q.setStyle(this.popupActionsMenu,"display","none");a.stopPropagation()},_getGeomtryServiceByAppConfig:function(a){return new f(a.geometryService)},onAppConfigLoaded:function(a){a=this._processAppConfig(a);m.publish("app/appConfigLoaded",a);this._refreshAppActions()},onMapLoaded:function(a,b){t.setInstance(a,b);m.publish("app/mapLoaded",
a)},onMapChanged:function(a,b){t.setInstance(a,b);m.publish("app/mapChanged",a)},onSceneViewLoaded:function(a){m.publish("app/sceneViewLoaded",a)},onSceneViewChanged:function(a){m.publish("app/sceneViewChanged",a)},onAppConfigChanged:function(a,b,c){a=this._processAppConfig(a);m.publish("app/appConfigChanged",a,b,c);this._refreshAppActions()},onPreloadWidgetsLoaded:function(){m.publish("app/preloadWidgetsLoaded")},onMapCreatedFailed:function(){m.publish("app/mapCreatedFailed")},onDataSourceDataUpdated:function(a,
b){m.publish("app/dataSourceDataUpdated",a,b)},onLayoutDefinitionChanged:function(a){this.hideLoadingCover();m.publish("layoutDefinitionChanged",a)},onEditLayoutCancelled:function(){this.hideLoadingCover()},onEditLayout:function(){m.publish("app/editLayout")},_processAppConfig:function(a){a=c.reCreateObject(a);v.defaults.geometryService=this._getGeomtryServiceByAppConfig(a);this.appConfig=a;return window.appConfig=a},_showPreviewMore:function(){this.previewViewStack.switchView(this.previewMore);if(!this.previewMoreFrameNode.src&&
this._PreviewMoreIframeSrc)this._initPreviewMoreViewerPosition(),q.attr(this.previewMoreFrameNode,"src",this._PreviewMoreIframeSrc);else{var a=l.clone(this.appConfig);a.mode="preview";this._syncPreviewMapExtentWithConfigMapExtent();this.previewViewerTopic.publish("builder/setAppConfig",a)}},_syncPreviewMapExtentWithConfigMapExtent:function(){var a=window.configWindow&&window.configWindow._viewerMap,b=window.previewWindow&&window.previewWindow._viewerMap;a&&b&&this.previewViewerTopic&&this.previewViewerTopic.publish("builder/syncExtent",
a)},_syncPreviewViewpointWithConfigViewpoint:function(){var a=window.configWindow&&window.configWindow._sceneView,b=window.previewWindow&&window.previewWindow._sceneView;a&&b&&this.previewViewerTopic&&this.previewViewerTopic.publish("builder/syncViewpoint",a.viewpoint)},_initPreviewMoreViewerPosition:function(){var a=q.getMarginBox(this.previewMore);q.setStyle(this.previewMoreContainer,{width:a.w-220+"px",height:a.h-130+"px"});q.setStyle(this.previewMoreIframeSection,"marginTop","50px")},_setPreviewMoreViewerPosition:function(){var a=
q.getMarginBox(this.previewMore).h,b=q.getMarginBox(this.previewMoreContainer),c=q.getStyle(this.previewMoreContainer,"paddingTop"),d=q.getStyle(this.previewMoreContainer,"paddingBottom"),a=(a-(b.h+c+d))/2;0>a&&(a=0);q.setStyle(this.previewMoreIframeSection,"marginTop",a+"px")},_resizePreviewMore:function(a){a?this._showPortrait():this._showLandscape();setTimeout(l.hitch(this,function(){this._syncPreviewMapExtentWithConfigMapExtent()}),500)},_showPortrait:function(){this._deviceInfo&&(this._isPortrait=
!0,q.setStyle(this.previewMoreContainer,{width:this._deviceInfo.width+44+"px",height:this._deviceInfo.height+44+"px"}),q.addClass(this.btnPortrait,"selected"),q.removeClass(this.btnLandscape,"selected"),this._setPreviewMoreViewerPosition())},_showLandscape:function(){this._deviceInfo&&(this._isPortrait=!1,q.setStyle(this.previewMoreContainer,{width:this._deviceInfo.height+44+"px",height:this._deviceInfo.width+44+"px"}),q.removeClass(this.btnPortrait,"selected"),q.addClass(this.btnLandscape,"selected"),
this._setPreviewMoreViewerPosition())},_onPreloadWidgetsLoaded:function(){this.hideLoadingCover()},_onMapCreatedFailed:function(){this.hideLoadingCover()},_loadTemplateConfigOptsPlugin:function(){var a=this.filterExtensionsByAppType("template-config-part",this.options.appInfo.appType);if(0!==a.length)return this.pluginManager.loadPlugin(this.pluginsMeta[a[0].pluginName]).then(l.hitch(this,function(a){q.place(a.domNode,this.templateOptsPaneNode);a.startup();return a}))},_loadConfigTemplatePlugin:function(){var a=
this.filterExtensionsByAppType("config-template",this.options.appInfo.appType);if(0!==a.length)return this.pluginManager.loadPlugin(this.pluginsMeta[a[0].pluginName]).then(l.hitch(this,function(a){q.place(a.domNode,this.configTemplateNode);a.startup();this.saveTemplatePluginBox=a.savePluginNode;return a}))}})})},"jimu/dijit/ViewStack":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/_base/html","dojo/_base/array","dijit/_WidgetBase"],function(r,l,d,q,k){return r(k,{baseClass:"jimu-viewstack",
declaredClass:"jimu.dijit.ViewStack",_currentView:null,postCreate:function(){this.inherited(arguments);this.views||(this.views=[]);q.forEach(this.views,l.hitch(this,function(k){1===k.nodeType?(d.place(k,this.domNode),d.addClass(k,"view"),d.setStyle(k,"display","none")):k.domNode&&(d.place(k.domNode,this.domNode),d.addClass(k.domNode,"view"),d.setStyle(k.domNode,"display","none"))}))},startup:function(){this.inherited(arguments);0<this.views.length&&this.switchView(0)},getSelectedView:function(){return this._currentView},
getSelectedLabel:function(){var d="",k=this.getSelectedView();k&&(d=k.label);return d},getViewByLabel:function(d){for(var k=0;k<this.views.length;k++)if(d===this.views[k].label)return this.views[k];return null},addView:function(k){this.views.push(k);1===k.nodeType?(d.place(k,this.domNode),d.addClass(k,"view")):k.domNode&&(d.place(k.domNode,this.domNode),d.addClass(k.domNode,"view"))},removeView:function(k){var l=this.views.length;this.views=q.filter(this.views,function(d){return k!==d});l!==this.views.length&&
(1===k.nodeType?d.destroy(k):k.domNode&&k.destroyRecursive())},switchView:function(k){var m,h;m="number"===typeof k?this.views[k]:"string"===typeof k?this.getViewByLabel(k):k;this.views.forEach(l.hitch(this,function(e){if(e)if(1===e.nodeType?h=e:e.domNode&&(h=e.domNode),e===m){if(d.setStyle(h,"display","block"),e.domNode)if(!e._started)e.startup(),e._started=!0;else if("function"===typeof e.onShown)e.onShown()}else if(d.setStyle(h,"display","none"),e.domNode&&"function"===typeof e.onHidden)e.onHidden()}));
this._currentView=m;this.onViewSwitch(m)},onViewSwitch:function(){}})})},"jimu/dijit/LoadingShelter":function(){define(["dojo/_base/declare","dijit/_WidgetBase","dijit/_TemplatedMixin","dojo/text!./templates/LoadingShelter.html","dojo/_base/html"],function(r,l,d,q,k){return r([l,d],{baseClass:"jimu-loading-shelter",declaredClass:"jimu.dijit.LoadingShelter",templateString:q,loadingText:null,hidden:!1,showLoading:!0,postMixInProperties:function(){this.nls=window.jimuNls.loadingShelter},postCreate:function(){this.inherited(arguments);
this.hidden&&k.setStyle(this.domNode,"display","none");k.setStyle(this.domNode,{width:"100%",height:"100%"});this.showLoading||k.setStyle(this.loadingNode,"display","none");"string"===typeof this.loadingText&&(this.textNode.innerHTML=this.loadingText)},show:function(d){this.domNode&&this.hidden&&("string"===typeof d&&(this.textNode.innerHTML=d),k.setStyle(this.domNode,"display","block"),this.hidden=!1)},hide:function(){this.domNode&&!this.hidden&&(k.setStyle(this.domNode,"display","none"),this.hidden=
!0)}})})},"jimu/dijit/AGOLLoading":function(){define(["dojo/_base/declare","dijit/_WidgetBase","dijit/_TemplatedMixin","dojo/text!./templates/AGOLLoading.html","dojo/_base/html"],function(r,l,d,q,k){return r([l,d],{baseClass:"jimu-agol-loading",declaredClass:"jimu.dijit.AGOLLoading",templateString:q,loadingText:null,hidden:!1,showLoading:!0,postMixInProperties:function(){this.nls=window.jimuNls.loadingShelter},postCreate:function(){this.inherited(arguments);this.hidden&&k.setStyle(this.domNode,"display",
"none");k.setStyle(this.domNode,{width:"100%",height:"100%"});this.showLoading||k.setStyle(this.imgDiv,"display","none");"string"===typeof this.loadingText&&(this.textNode.innerHTML=this.loadingText)},show:function(d){this.domNode&&this.hidden&&("string"===typeof d&&(this.textNode.innerHTML=d),k.setStyle(this.domNode,"display","block"),this.hidden=!1)},hide:function(){this.domNode&&!this.hidden&&(k.setStyle(this.domNode,"display","none"),this.hidden=!0)}})})},"builder/plugins/app-config-configpart/_build-generate_module":function(){define(["builder/plugins/app-config-configpart/Plugin",
"dojo/text!builder/plugins/app-config-configpart/Plugin.html","dojo/text!builder/plugins/app-config-configpart/css/style.css","dojo/i18n!builder/plugins/app-config-configpart/nls/strings"],function(){})},"builder/plugins/app-config-configpart/Plugin":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/promise/all ./TabContainer2 builder/BasePlugin".split(" "),function(r,l,d,q,k,m){return r([m],{baseClass:"plugin-appconfig-configpart",postCreate:function(){this.inherited(arguments);
this.plugins=[];this.republishEvents=[]},startup:function(){this._createConfigTab();this._addRepublishEvents()},_addRepublishEvents:function(){var k=this.pluginManager.getPluginByName("app-config");d.forEach(this.republishEvents,function(d){k.addRepublishEvent(d)},this)},_createConfigTab:function(){var m=this.filterExtensionsByAppType("config-sections",window.appInfo.appType);d.some(m,l.hitch(this,function(d){return"map-config"===d.pluginName?(d.parameters.label="HTML3D"===window.appInfo.appType?
window.jimuNls.common.scene:window.jimuNls.common.map,!0):!1}));var h=[];d.forEach(m,function(d){h.push(this.pluginManager.loadPlugin(this.pluginsMeta[d.pluginName]));d=d.parameters.republishEvents.split(",");this.republishEvents=this.republishEvents.concat(d)},this);q(h).then(l.hitch(this,function(e){var c=[];d.forEach(e,function(b,a){var d=m[a];this.plugins.push(b);c.push({title:d.parameters.label,icon:d.parameters.icon,selectedIcon:d.parameters.selectedIcon,content:b,index:d.parameters.index})},
this);c.sort(function(b,a){return b.index-a.index});this.tab=new k({tabs:c,selected:c[0].title},this.tabsNode);this.tab.startup()}),l.hitch(this,function(d){console.error(d)}))},_onMapChanged:function(d){this.map=d}})})},"builder/plugins/app-config-configpart/TabContainer2":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/html dojo/on dojo/Evented dojo/query dijit/_WidgetBase dijit/_TemplatedMixin dojo/text!./TabContainer2.html jimu/dijit/ViewStack".split(" "),function(r,
l,d,q,k,m,p,h,e,c,b){return r([h,e,m],{templateString:c,_controlNodes:null,selected:"",tabs:null,"class":"jimu-tab2",postCreate:function(){this.inherited(arguments);this._controlNodes=[];this.viewStack=new b(null,this.containerNode);d.forEach(this.tabs,function(a){this._createTab(a)},this)},startup:function(){this.selected?this.selectTab(this.selected):0<this.tabs.length&&this.selectTab(this.tabs[0].title)},_createTab:function(a){var b=q.toDom('\x3ctd\x3e\x3cdiv class\x3d"tab-item-div"\x3e\x3cdiv class\x3d"tab-item-icon"\x3e\x3c/div\x3e\x3cdiv class\x3d"tab-item-title"\x3e\x3c/div\x3e\x3c/div\x3e\x3c/td\x3e');
q.place(b,this.tabTr);var c=p(".tab-item-div",b)[0],d=p(".tab-item-icon",b)[0];p(".tab-item-title",b)[0].innerHTML=a.title||"";q.setAttr(c,"title",a.title||"");q.setStyle(d,"backgroundImage","url("+a.icon+")");this.viewStack.viewType=a.content.domNode?"dijit":"dom";c.tabConfig=a;c.iconNode=d;a.content.label=a.title;this.viewStack.addView(a.content);this.own(k(c,"click",l.hitch(this,this.onSelect,a.title)));this._controlNodes.push(c)},onSelect:function(a){this.selectTab(a)},selectTab:function(a){d.forEach(this._controlNodes,
l.hitch(this,function(b){var c="";b.tabConfig.title===a?(q.addClass(b,"selected-tab-item-div"),c=b.tabConfig.selectedIcon):(q.removeClass(b,"selected-tab-item-div"),c=b.tabConfig.icon);q.setStyle(b.iconNode,"backgroundImage","url("+c+")")}));this.viewStack.switchView(a);this.emit("tabChanged",a)}})})},"builder/plugins/app-config-morepreview-selectionpart/_build-generate_module":function(){define(["builder/plugins/app-config-morepreview-selectionpart/Plugin","dojo/text!builder/plugins/app-config-morepreview-selectionpart/Plugin.html",
"dojo/text!builder/plugins/app-config-morepreview-selectionpart/css/style.css","dojo/i18n!builder/plugins/app-config-morepreview-selectionpart/nls/strings"],function(){})},"builder/plugins/app-config-morepreview-selectionpart/Plugin":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/html dojo/on dojo/query builder/BasePlugin jimu/portalUrlUtils jimu/dijit/QRCode".split(" "),function(r,l,d,q,k,m,p,h){return r([m],{baseClass:"plugin-appconfig-morepreview-selectionpart",postCreate:function(){this.inherited(arguments);
this._bindEvents();this._appConfigPlugin=this.pluginManager.getPluginByName("app-config")},startup:function(){this.inherited(arguments);this._initPreviewItems();this._initQRCode()},_bindEvents:function(){this.own(q(this.customWidth,"blur",l.hitch(this,this._onCustomSizeChanged)));this.own(q(this.customHeight,"blur",l.hitch(this,this._onCustomSizeChanged)))},_initPreviewItems:function(){d.empty(this.previewTbody);var e=[];e.push({"class":"iPhone6-plus",title:"iPhone 7 Plus / 6s Plus / 6 Plus",width:414,
height:736});e.push({"class":"iPhone6",title:"iPhone 7 / 6s / 6",width:375,height:667});e.push({"class":"iPhone5",title:"iPhone SE / 5 / 5C / 5S",width:320,height:568});e.push({"class":"iPhone4",title:"iPhone 4s / 4",width:320,height:480});e.push({"class":"xiaomi-3",title:"LG G5 / G4 / G3",width:360,height:640});e.push({"class":"xiaomi-3",title:"Huawei Mate 9",width:360,height:640});e.push({"class":"xiaomi-3",title:"Lenovo Z2 Pro",width:360,height:640});e.push({"class":"xiaomi-3",title:"Xiaomi Mi 5",
width:360,height:640});e.push({"class":"htc-one",title:"HTC 10",width:360,height:640});e.push({"class":"Samsung-Galaxy-S4",title:"Samsung Galaxy S7, S7 edge",width:360,height:640});e.push({"class":"Samsung-Note-3",title:"Samsung Galaxy Note 4",width:360,height:640});e.push({"class":"new-iPad",title:"Google Nexus 10",width:800,height:1280});e.push({"class":"new-iPad",title:"Google Nexus 7",width:600,height:960});e.push({"class":"Nexus-5",title:"Google Nexus 6",width:412,height:732});e.push({"class":"Nexus-4",
title:"Google Nexus 5",width:360,height:640});e.push({"class":"iPad-Air",title:"iPad Pro",width:1024,height:1366});e.push({"class":"iPad-Air",title:"iPad 3 / 4 / Air / Air2",width:768,height:1024});e.push({"class":"iPad-mini",title:"iPad mini 2 / 3",width:768,height:1024});e.push({"class":"new-iPad",title:"Surface Pro 3",width:1024,height:1440});e.push({"class":"new-iPad",title:"Surface Pro / Pro 2",width:720,height:1280});var c=Math.ceil(e.length/4),b;for(b=0;b<c;b++){var a=d.toDom("\x3ctr\x3e\x3ctd\x3e\x3c/td\x3e\x3ctd\x3e\x3c/td\x3e\x3ctd\x3e\x3c/td\x3e\x3ctd\x3e\x3c/td\x3e\x3c/tr\x3e");
d.place(a,this.previewTbody)}c=k("td",this.previewTbody);for(b=0;b<e.length;b++){var a=c[b],g=this._createPreviewItem(e[b]);d.place(g,a)}},_createPreviewItem:function(e){var c=d.toDom('\x3cdiv class\x3d"preview-item"\x3e\x3cdiv class\x3d"preview-item-bg"\x3e\x3cdiv class\x3d"preview-item-thumbnail"\x3e\x3c/div\x3e\x3cdiv class\x3d"preview-selected-icon"\x3e\x3c/div\x3e\x3c/div\x3e\x3cspan class\x3d"preview-item-title"\x3e\x3c/span\x3e\x3c/div\x3e');c.args=e;var b=k(".preview-item-bg",c)[0],a=k(".preview-item-thumbnail",
c)[0],g=k(".preview-item-title",c)[0];this.own(q(b,"click",l.hitch(this,this._onPreviewItemBgClick)));e["class"]&&d.addClass(a,e["class"]);g.innerHTML=e.title||"";return c},_onPreviewItemBgClick:function(e){e=e.target||e.srcElement;d.hasClass(e,"preview-item-thumbnail")&&(e=e.parentNode,k(".preview-item-bg",this.previewTbody).removeClass("selected"),d.addClass(e,"selected"),e=e.parentNode.args,this.customWidth.value=e.width,this.customHeight.value=e.height,this._appConfigPlugin.previewOnDevice(e,
!1))},_onCustomSizeChanged:function(){var d=function(a){var b=!1;isNaN(a)||isNaN(parseFloat(a))||0<parseInt(a,10)&&(b=!0);return b},c=this.customWidth.value,b=this.customHeight.value;d(c)&&d(b)&&(k(".preview-item-bg",this.previewTbody).removeClass("selected"),c=parseInt(c,10),b=parseInt(b,10),this._appConfigPlugin.previewOnDevice({width:c,height:b},!0))},_initQRCode:function(){var e="";window.isXT?e=window.location.protocol+"//"+window.location.host+path+"apps/"+window.appInfo.id:(e=p.getStandardPortalUrl(window.portalUrl),
e=p.setProtocol(e,window.location.protocol),e=window.queryObject.appid?e+"/apps/webappviewer/index.html?appid\x3d"+window.appInfo.id:e+"/apps/webappviewer/index.html?id\x3d"+window.appInfo.id);new h({text:e,width:75,height:75},this.qrcodeImage);d.setAttr(this.qrcodeDescription,"innerHTML",this.nls.qrcodeDesc);setTimeout(function(){k(".qrcode-image table").style("margin","0px")},100)}})})},"jimu/dijit/QRCode":function(){define(["dojo/_base/declare","dijit/_WidgetBase","libs/qrcode"],function(r,l){return r([l],
{baseClass:"jimu-qrcode",declaredClass:"jimu.dijit.QRCode",postCreate:function(){new QRCode(this.domNode,{text:this.text,width:this.width||128,height:this.height||128,colorDark:this.colorDark||" #000000",colorLight:this.colorLight||"#ffffff",correctLevel:this.correctLevel||QRCode.CorrectLevel.L})}})})},"libs/qrcode":function(){define(["dojo","dijit","dojox"],function(r,l,d){var q;(function(){function d(a){this.mode=b.MODE_8BIT_BYTE;this.data=a;this.parsedData=[];a=0;for(var c=this.data.length;a<c;a++){var d=
[],e=this.data.charCodeAt(a);65536<e?(d[0]=240|(e&1835008)>>>18,d[1]=128|(e&258048)>>>12,d[2]=128|(e&4032)>>>6,d[3]=128|e&63):2048<e?(d[0]=224|(e&61440)>>>12,d[1]=128|(e&4032)>>>6,d[2]=128|e&63):128<e?(d[0]=192|(e&1984)>>>6,d[1]=128|e&63):d[0]=e;this.parsedData.push(d)}this.parsedData=Array.prototype.concat.apply([],this.parsedData);this.parsedData.length!=this.data.length&&(this.parsedData.unshift(191),this.parsedData.unshift(187),this.parsedData.unshift(239))}function l(a,b){this.typeNumber=a;this.errorCorrectLevel=
b;this.modules=null;this.moduleCount=0;this.dataCache=null;this.dataList=[]}function p(a,b){if(void 0==a.length)throw Error(a.length+"/"+b);for(var c=0;c<a.length&&0==a[c];)c++;this.num=Array(a.length-c+b);for(var d=0;d<a.length-c;d++)this.num[d]=a[d+c]}function h(a,b){this.totalCount=a;this.dataCount=b}function e(){this.buffer=[];this.length=0}function c(){var a=!1,b=navigator.userAgent;/android/i.test(b)&&(a=!0,(aMat=b.toString().match(/android ([0-9]\.[0-9])/i))&&aMat[1]&&(a=parseFloat(aMat[1])));
return a}d.prototype={getLength:function(a){return this.parsedData.length},write:function(a){for(var b=0,c=this.parsedData.length;b<c;b++)a.put(this.parsedData[b],8)}};l.prototype={addData:function(a){a=new d(a);this.dataList.push(a);this.dataCache=null},isDark:function(a,b){if(0>a||this.moduleCount<=a||0>b||this.moduleCount<=b)throw Error(a+","+b);return this.modules[a][b]},getModuleCount:function(){return this.moduleCount},make:function(){this.makeImpl(!1,this.getBestMaskPattern())},makeImpl:function(a,
b){this.moduleCount=4*this.typeNumber+17;this.modules=Array(this.moduleCount);for(var c=0;c<this.moduleCount;c++){this.modules[c]=Array(this.moduleCount);for(var d=0;d<this.moduleCount;d++)this.modules[c][d]=null}this.setupPositionProbePattern(0,0);this.setupPositionProbePattern(this.moduleCount-7,0);this.setupPositionProbePattern(0,this.moduleCount-7);this.setupPositionAdjustPattern();this.setupTimingPattern();this.setupTypeInfo(a,b);7<=this.typeNumber&&this.setupTypeNumber(a);null==this.dataCache&&
(this.dataCache=l.createData(this.typeNumber,this.errorCorrectLevel,this.dataList));this.mapData(this.dataCache,b)},setupPositionProbePattern:function(a,b){for(var c=-1;7>=c;c++)if(!(-1>=a+c||this.moduleCount<=a+c))for(var d=-1;7>=d;d++)-1>=b+d||this.moduleCount<=b+d||(this.modules[a+c][b+d]=0<=c&&6>=c&&(0==d||6==d)||0<=d&&6>=d&&(0==c||6==c)||2<=c&&4>=c&&2<=d&&4>=d?!0:!1)},getBestMaskPattern:function(){for(var a=0,b=0,c=0;8>c;c++){this.makeImpl(!0,c);var d=g.getLostPoint(this);if(0==c||a>d)a=d,b=
c}return b},createMovieClip:function(a,b,c){a=a.createEmptyMovieClip(b,c);this.make();for(b=0;b<this.modules.length;b++){c=1*b;for(var d=0;d<this.modules[b].length;d++){var e=1*d;this.modules[b][d]&&(a.beginFill(0,100),a.moveTo(e,c),a.lineTo(e+1,c),a.lineTo(e+1,c+1),a.lineTo(e,c+1),a.endFill())}}return a},setupTimingPattern:function(){for(var a=8;a<this.moduleCount-8;a++)null==this.modules[a][6]&&(this.modules[a][6]=0==a%2);for(a=8;a<this.moduleCount-8;a++)null==this.modules[6][a]&&(this.modules[6][a]=
0==a%2)},setupPositionAdjustPattern:function(){for(var a=g.getPatternPosition(this.typeNumber),b=0;b<a.length;b++)for(var c=0;c<a.length;c++){var d=a[b],e=a[c];if(null==this.modules[d][e])for(var f=-2;2>=f;f++)for(var h=-2;2>=h;h++)this.modules[d+f][e+h]=-2==f||2==f||-2==h||2==h||0==f&&0==h?!0:!1}},setupTypeNumber:function(a){for(var b=g.getBCHTypeNumber(this.typeNumber),c=0;18>c;c++){var d=!a&&1==(b>>c&1);this.modules[Math.floor(c/3)][c%3+this.moduleCount-8-3]=d}for(c=0;18>c;c++)d=!a&&1==(b>>c&1),
this.modules[c%3+this.moduleCount-8-3][Math.floor(c/3)]=d},setupTypeInfo:function(a,b){for(var c=g.getBCHTypeInfo(this.errorCorrectLevel<<3|b),d=0;15>d;d++){var e=!a&&1==(c>>d&1);6>d?this.modules[d][8]=e:8>d?this.modules[d+1][8]=e:this.modules[this.moduleCount-15+d][8]=e}for(d=0;15>d;d++)e=!a&&1==(c>>d&1),8>d?this.modules[8][this.moduleCount-d-1]=e:9>d?this.modules[8][15-d-1+1]=e:this.modules[8][15-d-1]=e;this.modules[this.moduleCount-8][8]=!a},mapData:function(a,b){for(var c=-1,d=this.moduleCount-
1,e=7,f=0,h=this.moduleCount-1;0<h;h-=2)for(6==h&&h--;;){for(var k=0;2>k;k++)if(null==this.modules[d][h-k]){var n=!1;f<a.length&&(n=1==(a[f]>>>e&1));g.getMask(b,d,h-k)&&(n=!n);this.modules[d][h-k]=n;e--; -1==e&&(f++,e=7)}d+=c;if(0>d||this.moduleCount<=d){d-=c;c=-c;break}}}};l.PAD0=236;l.PAD1=17;l.createData=function(a,b,c){b=h.getRSBlocks(a,b);for(var d=new e,f=0;f<c.length;f++){var k=c[f];d.put(k.mode,4);d.put(k.getLength(),g.getLengthInBits(k.mode,a));k.write(d)}for(f=a=0;f<b.length;f++)a+=b[f].dataCount;
if(d.getLengthInBits()>8*a)throw Error("code length overflow. ("+d.getLengthInBits()+"\x3e"+8*a+")");for(d.getLengthInBits()+4<=8*a&&d.put(0,4);0!=d.getLengthInBits()%8;)d.putBit(!1);for(;!(d.getLengthInBits()>=8*a);){d.put(l.PAD0,8);if(d.getLengthInBits()>=8*a)break;d.put(l.PAD1,8)}return l.createBytes(d,b)};l.createBytes=function(a,b){for(var c=0,d=0,e=0,f=Array(b.length),h=Array(b.length),k=0;k<b.length;k++){var n=b[k].dataCount,l=b[k].totalCount-n,d=Math.max(d,n),e=Math.max(e,l);f[k]=Array(n);
for(var m=0;m<f[k].length;m++)f[k][m]=255&a.buffer[m+c];c+=n;m=g.getErrorCorrectPolynomial(l);n=(new p(f[k],m.getLength()-1)).mod(m);h[k]=Array(m.getLength()-1);for(m=0;m<h[k].length;m++)l=m+n.getLength()-h[k].length,h[k][m]=0<=l?n.get(l):0}for(m=k=0;m<b.length;m++)k+=b[m].totalCount;c=Array(k);for(m=n=0;m<d;m++)for(k=0;k<b.length;k++)m<f[k].length&&(c[n++]=f[k][m]);for(m=0;m<e;m++)for(k=0;k<b.length;k++)m<h[k].length&&(c[n++]=h[k][m]);return c};for(var b={MODE_NUMBER:1,MODE_ALPHA_NUM:2,MODE_8BIT_BYTE:4,
MODE_KANJI:8},a={L:1,M:0,Q:3,H:2},g={PATTERN_POSITION_TABLE:[[],[6,18],[6,22],[6,26],[6,30],[6,34],[6,22,38],[6,24,42],[6,26,46],[6,28,50],[6,30,54],[6,32,58],[6,34,62],[6,26,46,66],[6,26,48,70],[6,26,50,74],[6,30,54,78],[6,30,56,82],[6,30,58,86],[6,34,62,90],[6,28,50,72,94],[6,26,50,74,98],[6,30,54,78,102],[6,28,54,80,106],[6,32,58,84,110],[6,30,58,86,114],[6,34,62,90,118],[6,26,50,74,98,122],[6,30,54,78,102,126],[6,26,52,78,104,130],[6,30,56,82,108,134],[6,34,60,86,112,138],[6,30,58,86,114,142],
[6,34,62,90,118,146],[6,30,54,78,102,126,150],[6,24,50,76,102,128,154],[6,28,54,80,106,132,158],[6,32,58,84,110,136,162],[6,26,54,82,110,138,166],[6,30,58,86,114,142,170]],G15:1335,G18:7973,G15_MASK:21522,getBCHTypeInfo:function(a){for(var b=a<<10;0<=g.getBCHDigit(b)-g.getBCHDigit(g.G15);)b^=g.G15<<g.getBCHDigit(b)-g.getBCHDigit(g.G15);return(a<<10|b)^g.G15_MASK},getBCHTypeNumber:function(a){for(var b=a<<12;0<=g.getBCHDigit(b)-g.getBCHDigit(g.G18);)b^=g.G18<<g.getBCHDigit(b)-g.getBCHDigit(g.G18);
return a<<12|b},getBCHDigit:function(a){for(var b=0;0!=a;)b++,a>>>=1;return b},getPatternPosition:function(a){return g.PATTERN_POSITION_TABLE[a-1]},getMask:function(a,b,c){switch(a){case 0:return 0==(b+c)%2;case 1:return 0==b%2;case 2:return 0==c%3;case 3:return 0==(b+c)%3;case 4:return 0==(Math.floor(b/2)+Math.floor(c/3))%2;case 5:return 0==b*c%2+b*c%3;case 6:return 0==(b*c%2+b*c%3)%2;case 7:return 0==(b*c%3+(b+c)%2)%2;default:throw Error("bad maskPattern:"+a);}},getErrorCorrectPolynomial:function(a){for(var b=
new p([1],0),c=0;c<a;c++)b=b.multiply(new p([1,u.gexp(c)],0));return b},getLengthInBits:function(a,c){if(1<=c&&10>c)switch(a){case b.MODE_NUMBER:return 10;case b.MODE_ALPHA_NUM:return 9;case b.MODE_8BIT_BYTE:return 8;case b.MODE_KANJI:return 8;default:throw Error("mode:"+a);}else if(27>c)switch(a){case b.MODE_NUMBER:return 12;case b.MODE_ALPHA_NUM:return 11;case b.MODE_8BIT_BYTE:return 16;case b.MODE_KANJI:return 10;default:throw Error("mode:"+a);}else if(41>c)switch(a){case b.MODE_NUMBER:return 14;
case b.MODE_ALPHA_NUM:return 13;case b.MODE_8BIT_BYTE:return 16;case b.MODE_KANJI:return 12;default:throw Error("mode:"+a);}else throw Error("type:"+c);},getLostPoint:function(a){for(var b=a.getModuleCount(),c=0,d=0;d<b;d++)for(var e=0;e<b;e++){for(var f=0,g=a.isDark(d,e),h=-1;1>=h;h++)if(!(0>d+h||b<=d+h))for(var k=-1;1>=k;k++)0>e+k||b<=e+k||0==h&&0==k||g!=a.isDark(d+h,e+k)||f++;5<f&&(c+=3+f-5)}for(d=0;d<b-1;d++)for(e=0;e<b-1;e++)if(f=0,a.isDark(d,e)&&f++,a.isDark(d+1,e)&&f++,a.isDark(d,e+1)&&f++,
a.isDark(d+1,e+1)&&f++,0==f||4==f)c+=3;for(d=0;d<b;d++)for(e=0;e<b-6;e++)a.isDark(d,e)&&!a.isDark(d,e+1)&&a.isDark(d,e+2)&&a.isDark(d,e+3)&&a.isDark(d,e+4)&&!a.isDark(d,e+5)&&a.isDark(d,e+6)&&(c+=40);for(e=0;e<b;e++)for(d=0;d<b-6;d++)a.isDark(d,e)&&!a.isDark(d+1,e)&&a.isDark(d+2,e)&&a.isDark(d+3,e)&&a.isDark(d+4,e)&&!a.isDark(d+5,e)&&a.isDark(d+6,e)&&(c+=40);for(e=f=0;e<b;e++)for(d=0;d<b;d++)a.isDark(d,e)&&f++;return c+Math.abs(100*f/b/b-50)/5*10}},u={glog:function(a){if(1>a)throw Error("glog("+a+
")");return u.LOG_TABLE[a]},gexp:function(a){for(;0>a;)a+=255;for(;256<=a;)a-=255;return u.EXP_TABLE[a]},EXP_TABLE:Array(256),LOG_TABLE:Array(256)},n=0;8>n;n++)u.EXP_TABLE[n]=1<<n;for(n=8;256>n;n++)u.EXP_TABLE[n]=u.EXP_TABLE[n-4]^u.EXP_TABLE[n-5]^u.EXP_TABLE[n-6]^u.EXP_TABLE[n-8];for(n=0;255>n;n++)u.LOG_TABLE[u.EXP_TABLE[n]]=n;p.prototype={get:function(a){return this.num[a]},getLength:function(){return this.num.length},multiply:function(a){for(var b=Array(this.getLength()+a.getLength()-1),c=0;c<this.getLength();c++)for(var d=
0;d<a.getLength();d++)b[c+d]^=u.gexp(u.glog(this.get(c))+u.glog(a.get(d)));return new p(b,0)},mod:function(a){if(0>this.getLength()-a.getLength())return this;for(var b=u.glog(this.get(0))-u.glog(a.get(0)),c=Array(this.getLength()),d=0;d<this.getLength();d++)c[d]=this.get(d);for(d=0;d<a.getLength();d++)c[d]^=u.gexp(u.glog(a.get(d))+b);return(new p(c,0)).mod(a)}};h.RS_BLOCK_TABLE=[[1,26,19],[1,26,16],[1,26,13],[1,26,9],[1,44,34],[1,44,28],[1,44,22],[1,44,16],[1,70,55],[1,70,44],[2,35,17],[2,35,13],
[1,100,80],[2,50,32],[2,50,24],[4,25,9],[1,134,108],[2,67,43],[2,33,15,2,34,16],[2,33,11,2,34,12],[2,86,68],[4,43,27],[4,43,19],[4,43,15],[2,98,78],[4,49,31],[2,32,14,4,33,15],[4,39,13,1,40,14],[2,121,97],[2,60,38,2,61,39],[4,40,18,2,41,19],[4,40,14,2,41,15],[2,146,116],[3,58,36,2,59,37],[4,36,16,4,37,17],[4,36,12,4,37,13],[2,86,68,2,87,69],[4,69,43,1,70,44],[6,43,19,2,44,20],[6,43,15,2,44,16],[4,101,81],[1,80,50,4,81,51],[4,50,22,4,51,23],[3,36,12,8,37,13],[2,116,92,2,117,93],[6,58,36,2,59,37],[4,
46,20,6,47,21],[7,42,14,4,43,15],[4,133,107],[8,59,37,1,60,38],[8,44,20,4,45,21],[12,33,11,4,34,12],[3,145,115,1,146,116],[4,64,40,5,65,41],[11,36,16,5,37,17],[11,36,12,5,37,13],[5,109,87,1,110,88],[5,65,41,5,66,42],[5,54,24,7,55,25],[11,36,12],[5,122,98,1,123,99],[7,73,45,3,74,46],[15,43,19,2,44,20],[3,45,15,13,46,16],[1,135,107,5,136,108],[10,74,46,1,75,47],[1,50,22,15,51,23],[2,42,14,17,43,15],[5,150,120,1,151,121],[9,69,43,4,70,44],[17,50,22,1,51,23],[2,42,14,19,43,15],[3,141,113,4,142,114],[3,
70,44,11,71,45],[17,47,21,4,48,22],[9,39,13,16,40,14],[3,135,107,5,136,108],[3,67,41,13,68,42],[15,54,24,5,55,25],[15,43,15,10,44,16],[4,144,116,4,145,117],[17,68,42],[17,50,22,6,51,23],[19,46,16,6,47,17],[2,139,111,7,140,112],[17,74,46],[7,54,24,16,55,25],[34,37,13],[4,151,121,5,152,122],[4,75,47,14,76,48],[11,54,24,14,55,25],[16,45,15,14,46,16],[6,147,117,4,148,118],[6,73,45,14,74,46],[11,54,24,16,55,25],[30,46,16,2,47,17],[8,132,106,4,133,107],[8,75,47,13,76,48],[7,54,24,22,55,25],[22,45,15,13,
46,16],[10,142,114,2,143,115],[19,74,46,4,75,47],[28,50,22,6,51,23],[33,46,16,4,47,17],[8,152,122,4,153,123],[22,73,45,3,74,46],[8,53,23,26,54,24],[12,45,15,28,46,16],[3,147,117,10,148,118],[3,73,45,23,74,46],[4,54,24,31,55,25],[11,45,15,31,46,16],[7,146,116,7,147,117],[21,73,45,7,74,46],[1,53,23,37,54,24],[19,45,15,26,46,16],[5,145,115,10,146,116],[19,75,47,10,76,48],[15,54,24,25,55,25],[23,45,15,25,46,16],[13,145,115,3,146,116],[2,74,46,29,75,47],[42,54,24,1,55,25],[23,45,15,28,46,16],[17,145,115],
[10,74,46,23,75,47],[10,54,24,35,55,25],[19,45,15,35,46,16],[17,145,115,1,146,116],[14,74,46,21,75,47],[29,54,24,19,55,25],[11,45,15,46,46,16],[13,145,115,6,146,116],[14,74,46,23,75,47],[44,54,24,7,55,25],[59,46,16,1,47,17],[12,151,121,7,152,122],[12,75,47,26,76,48],[39,54,24,14,55,25],[22,45,15,41,46,16],[6,151,121,14,152,122],[6,75,47,34,76,48],[46,54,24,10,55,25],[2,45,15,64,46,16],[17,152,122,4,153,123],[29,74,46,14,75,47],[49,54,24,10,55,25],[24,45,15,46,46,16],[4,152,122,18,153,123],[13,74,
46,32,75,47],[48,54,24,14,55,25],[42,45,15,32,46,16],[20,147,117,4,148,118],[40,75,47,7,76,48],[43,54,24,22,55,25],[10,45,15,67,46,16],[19,148,118,6,149,119],[18,75,47,31,76,48],[34,54,24,34,55,25],[20,45,15,61,46,16]];h.getRSBlocks=function(a,b){var c=h.getRsBlockTable(a,b);if(void 0==c)throw Error("bad rs block @ typeNumber:"+a+"/errorCorrectLevel:"+b);for(var d=c.length/3,e=[],f=0;f<d;f++)for(var g=c[3*f+0],k=c[3*f+1],n=c[3*f+2],l=0;l<g;l++)e.push(new h(k,n));return e};h.getRsBlockTable=function(b,
c){switch(c){case a.L:return h.RS_BLOCK_TABLE[4*(b-1)+0];case a.M:return h.RS_BLOCK_TABLE[4*(b-1)+1];case a.Q:return h.RS_BLOCK_TABLE[4*(b-1)+2];case a.H:return h.RS_BLOCK_TABLE[4*(b-1)+3]}};e.prototype={get:function(a){return 1==(this.buffer[Math.floor(a/8)]>>>7-a%8&1)},put:function(a,b){for(var c=0;c<b;c++)this.putBit(1==(a>>>b-c-1&1))},getLengthInBits:function(){return this.length},putBit:function(a){var b=Math.floor(this.length/8);this.buffer.length<=b&&this.buffer.push(0);a&&(this.buffer[b]|=
128>>>this.length%8);this.length++}};var t=[[17,14,11,7],[32,26,20,14],[53,42,32,24],[78,62,46,34],[106,84,60,44],[134,106,74,58],[154,122,86,64],[192,152,108,84],[230,180,130,98],[271,213,151,119],[321,251,177,137],[367,287,203,155],[425,331,241,177],[458,362,258,194],[520,412,292,220],[586,450,322,250],[644,504,364,280],[718,560,394,310],[792,624,442,338],[858,666,482,382],[929,711,509,403],[1003,779,565,439],[1091,857,611,461],[1171,911,661,511],[1273,997,715,535],[1367,1059,751,593],[1465,1125,
805,625],[1528,1190,868,658],[1628,1264,908,698],[1732,1370,982,742],[1840,1452,1030,790],[1952,1538,1112,842],[2068,1628,1168,898],[2188,1722,1228,958],[2303,1809,1283,983],[2431,1911,1351,1051],[2563,1989,1423,1093],[2699,2099,1499,1139],[2809,2213,1579,1219],[2953,2331,1663,1273]],n=function(){var a=function(a,b){this._el=a;this._htOption=b};a.prototype.draw=function(a){function b(a,b){var c=document.createElementNS("http://www.w3.org/2000/svg",a),d;for(d in b)b.hasOwnProperty(d)&&c.setAttribute(d,
b[d]);return c}var c=this._htOption,d=this._el,e=a.getModuleCount();this.clear();var f=b("svg",{viewBox:"0 0 "+String(e)+" "+String(e),width:"100%",height:"100%",fill:c.colorLight});f.setAttributeNS("http://www.w3.org/2000/xmlns/","xmlns:xlink","http://www.w3.org/1999/xlink");d.appendChild(f);f.appendChild(b("rect",{fill:c.colorDark,width:"1",height:"1",id:"template"}));for(c=0;c<e;c++)for(d=0;d<e;d++)if(a.isDark(c,d)){var g=b("use",{x:String(c),y:String(d)});g.setAttributeNS("http://www.w3.org/1999/xlink",
"href","#template");f.appendChild(g)}};a.prototype.clear=function(){for(;this._el.hasChildNodes();)this._el.removeChild(this._el.lastChild)};return a}(),f="svg"===document.documentElement.tagName.toLowerCase()?n:"undefined"==typeof CanvasRenderingContext2D?function(){var a=function(a,b){this._el=a;this._htOption=b};a.prototype.draw=function(a){for(var b=this._htOption,c=this._el,d=a.getModuleCount(),e=Math.floor(b.width/d),f=Math.floor(b.height/d),g=['\x3ctable style\x3d"border:0;border-collapse:collapse;"\x3e'],
h=0;h<d;h++){g.push("\x3ctr\x3e");for(var k=0;k<d;k++)g.push('\x3ctd style\x3d"border:0;border-collapse:collapse;padding:0;margin:0;width:'+e+"px;height:"+f+"px;background-color:"+(a.isDark(h,k)?b.colorDark:b.colorLight)+';"\x3e\x3c/td\x3e');g.push("\x3c/tr\x3e")}g.push("\x3c/table\x3e");c.innerHTML=g.join("");a=c.childNodes[0];c=(b.width-a.offsetWidth)/2;b=(b.height-a.offsetHeight)/2;0<c&&0<b&&(a.style.margin=b+"px "+c+"px")};a.prototype.clear=function(){this._el.innerHTML=""};return a}():function(){function a(){this._elImage.src=
this._elCanvas.toDataURL("image/png");this._elImage.style.display="block";this._elCanvas.style.display="none"}function b(a,b){var c=this;c._fFail=b;c._fSuccess=a;if(null===c._bSupportDataURI){var d=document.createElement("img"),e=function(){c._bSupportDataURI=!1;c._fFail&&_fFail.call(c)};d.onabort=e;d.onerror=e;d.onload=function(){c._bSupportDataURI=!0;c._fSuccess&&c._fSuccess.call(c)};d.src="data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAUAAAAFCAYAAACNbyblAAAAHElEQVQI12P4//8/w38GIAXDIBKE0DHxgljNBAAO9TXL0Y4OHwAAAABJRU5ErkJggg\x3d\x3d"}else!0===
c._bSupportDataURI&&c._fSuccess?c._fSuccess.call(c):!1===c._bSupportDataURI&&c._fFail&&c._fFail.call(c)}if(this._android&&2.1>=this._android){var d=1/window.devicePixelRatio,e=CanvasRenderingContext2D.prototype.drawImage;CanvasRenderingContext2D.prototype.drawImage=function(a,b,c,f,g,h,k,n,l){if("nodeName"in a&&/img/i.test(a.nodeName))for(var m=arguments.length-1;1<=m;m--)arguments[m]*=d;else"undefined"==typeof n&&(arguments[1]*=d,arguments[2]*=d,arguments[3]*=d,arguments[4]*=d);e.apply(this,arguments)}}var f=
function(a,b){this._bIsPainted=!1;this._android=c();this._htOption=b;this._elCanvas=document.createElement("canvas");this._elCanvas.width=b.width;this._elCanvas.height=b.height;a.appendChild(this._elCanvas);this._el=a;this._oContext=this._elCanvas.getContext("2d");this._bIsPainted=!1;this._elImage=document.createElement("img");this._elImage.alt="Scan me!";this._elImage.style.display="none";this._el.appendChild(this._elImage);this._bSupportDataURI=null};f.prototype.draw=function(a){var b=this._elImage,
c=this._oContext,d=this._htOption,e=a.getModuleCount(),f=d.width/e,g=d.height/e,h=Math.round(f),k=Math.round(g);b.style.display="none";this.clear();for(b=0;b<e;b++)for(var n=0;n<e;n++){var l=a.isDark(b,n),m=n*f,p=b*g;c.strokeStyle=l?d.colorDark:d.colorLight;c.lineWidth=1;c.fillStyle=l?d.colorDark:d.colorLight;c.fillRect(m,p,f,g);c.strokeRect(Math.floor(m)+.5,Math.floor(p)+.5,h,k);c.strokeRect(Math.ceil(m)-.5,Math.ceil(p)-.5,h,k)}this._bIsPainted=!0};f.prototype.makeImage=function(){this._bIsPainted&&
b.call(this,a)};f.prototype.isPainted=function(){return this._bIsPainted};f.prototype.clear=function(){this._oContext.clearRect(0,0,this._elCanvas.width,this._elCanvas.height);this._bIsPainted=!1};f.prototype.round=function(a){return a?Math.floor(1E3*a)/1E3:a};return f}();q=function(b,d){this._htOption={width:256,height:256,typeNumber:4,colorDark:"#000000",colorLight:"#ffffff",correctLevel:a.H};"string"===typeof d&&(d={text:d});if(d)for(var e in d)this._htOption[e]=d[e];"string"==typeof b&&(b=document.getElementById(b));
this._android=c();this._el=b;this._oQRCode=null;this._oDrawing=new f(this._el,this._htOption);this._htOption.text&&this.makeCode(this._htOption.text)};q.prototype.makeCode=function(b){var c=this._htOption.correctLevel,d=1,e;e=encodeURI(b).toString().replace(/\%[0-9a-fA-F]{2}/g,"a");e=e.length+(e.length!=b?3:0);for(var f=0,g=t.length;f<=g;f++){var h=0;switch(c){case a.L:h=t[f][0];break;case a.M:h=t[f][1];break;case a.Q:h=t[f][2];break;case a.H:h=t[f][3]}if(e<=h)break;else d++}if(d>t.length)throw Error("Too long data");
this._oQRCode=new l(d,this._htOption.correctLevel);this._oQRCode.addData(b);this._oQRCode.make();this._el.title=b;this._oDrawing.draw(this._oQRCode);this.makeImage()};q.prototype.makeImage=function(){"function"==typeof this._oDrawing.makeImage&&(!this._android||3<=this._android)&&this._oDrawing.makeImage()};q.prototype.clear=function(){this._oDrawing.clear()};q.CorrectLevel=a;window.QRCode=q})()})},"dojox/main":function(){define(["dojo/_base/kernel"],function(r){return r.dojox})},"builder/plugins/app-config-template-configpart/_build-generate_module":function(){define(["builder/plugins/app-config-template-configpart/Plugin",
"dojo/text!builder/plugins/app-config-template-configpart/Plugin.html","dojo/text!builder/plugins/app-config-template-configpart/css/style.css","dojo/i18n!builder/plugins/app-config-template-configpart/nls/strings"],function(){})},"builder/plugins/app-config-template-configpart/Plugin":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/Deferred dojo/_base/html dojo/promise/all dojo/_base/array dojo/topic builder/BasePlugin jimu/utils builder/dijit/TemplateAttributes".split(" "),function(r,
l,d,q,k,m,p,h,e,c){return r([h],{baseClass:"plugin-appconfig-template-configpart",_appConfig:null,_appConfigLoadDef:null,postCreate:function(){this.inherited(arguments);this._appConfigLoadDef=new d;this._updateDom();this._bindEvent()},startup:function(){this.inherited(arguments);this.isAdvance=!1;k({appConfig:this._appConfigLoadDef}).then(l.hitch(this,function(){this._init()}))},_updateDom:function(){"HTML3D"===window.appInfo.appType&&(q.setAttr(this.mapTitle,"innerHTML",this.nls.scene),q.setAttr(this.selectMapBtn,
"innerHTML",this.nls.chooseWebScene))},_init:function(){if(this.visible&&this._appConfig){var b=this._getCleanTemplateConfigByAppConfig(this._appConfig.templateConfig);this.agoltempAttrs&&this.agoltempAttrs.destroy();this.agoltempAttrs=(new c({templateConfig:b})).placeAt(this.configPart);this.agoltempAttrs.on("fieldChanged",l.hitch(this,this._onAGOLTemplateAttributeChanged))}},_getCleanTemplateConfigByAppConfig:function(b){var a={configurationSettings:[],values:{}};if(b)return m.forEach(b.configurationSettings,
function(b){var c={category:b.category,fields:[]};m.forEach(b.fields,function(b){if(b.fieldName){var d=e.template.getConfigValueWithId(this._appConfig,b.fieldName);void 0!==d&&(c.fields.push(b),a.values[b.fieldName]=d)}},this);0<c.fields.length&&a.configurationSettings.push(c)},this),a},_getTemplateAppConfigByTemplateConfig:function(b,a){var c=this._getDefaultTemplateAppConfig();if(a)return m.forEach(a.configurationSettings,function(a){m.forEach(a.fields,function(a){if(a.fieldName){var d=e.template.getConfigValueWithId(b,
a.fieldName);void 0!==d&&(c.values[a.fieldName]=d)}},this)},this),c},_getChangedTemplateAppConfigFromTemplateAttirbuts:function(b){var a=this._getDefaultTemplateAppConfig(),c=this.agoltempAttrs.getElementDijits(),d;for(d in c)if(c.hasOwnProperty(d)&&"function"!==typeof c[d]){var h=e.template.getConfigValueWithId(b,d);void 0!==h&&h!==c[d].getDijitValue()&&(a.values[d]=h)}return a},_getDefaultTemplateConfig:function(){return{configurationSettings:[{category:"",fields:[]}],values:{}}},_getDefaultTemplateAppConfig:function(){return{source:null,
folderId:null,values:{}}},_onAGOLTemplateAttributeChanged:function(b){e.template.setConfigValueWithId(this._appConfig,b.fieldName,b.value);"Attribute"===b.categoryName?p.publish("appAttributeChanged",{title:this._appConfig.title,subtitle:this._appConfig.subtitle,links:this._appConfig.links,logo:this._appConfig.logo}):(b=e.template.getKeyInfo(b.fieldName),"widget"===b.type?(b=this._appConfig.getConfigElementById(b.id),p.publish("widgetChanged",b)):"group"===b.type?(b=this._appConfig.getConfigElementById(b.id),
p.publish("groupChanged",b)):console.errror("errror"))},_bindEvent:function(){this.own(p.subscribe("app/appConfigLoaded",l.hitch(this,this._onAppConfigLoaded)));this.own(p.subscribe("app/appConfigChanged",l.hitch(this,this._onAppConfigChanged)));this.own(p.subscribe("new-webmap-item-selected",l.hitch(this,this._onWebmapItemSelected)));this.own(p.subscribe("app/mapLoaded",l.hitch(this,this._onMapLoaded)))},_onAppConfigLoaded:function(b){this._appConfig=l.clone(b);this._appConfigLoadDef.resolve(this._appConfig)},
_onAppConfigChanged:function(b){this._appConfig=l.clone(b)},_onSelectMapClick:function(){var b=this.pluginManager.getPluginByName("map-config");b&&b.showMapSelector()},_onWebmapItemSelected:function(b){q.setAttr(this.mapName,"innerHTML",b.title);q.setAttr(this.mapName,"title",b.title)},_onMapLoaded:function(b){q.setAttr(this.mapName,"innerHTML",b.itemInfo.item.title);q.setAttr(this.mapName,"title",b.itemInfo.item.title)},refresh:function(){this._init()}})})},"builder/dijit/TemplateAttributes":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/Deferred dojo/_base/html dojo/on dojo/promise/all dojo/Evented jimu/utils dijit/_WidgetBase dijit/_TemplatedMixin dijit/form/_FormMixin dijit/Tooltip dijit/form/CheckBox dijit/form/NumberTextBox dijit/form/Select dijit/form/ValidationTextBox dijit/form/SimpleTextarea dijit/Editor esri/dijit/ColorPicker dijit/_editor/plugins/TextColor dijit/_editor/plugins/LinkDialog".split(" "),
function(r,l,d,q,k,m,p,h,e,c,b,a,g,u,n,t,f,v,x,w){var z=r([c,b,a,h],{templateString:'\x3cdiv dojoAttachPoint\x3d"containerNode"\x3e\x3c/div\x3e',baseClass:"agoltemplate-attributes",item:null,itemTitle:null,defaultMaxSelectHeight:"150px",defaultTextAreaSize:5,_appConfig:null,_templateConfig:null,_templateAppConfig:null,_elementDijits:null,constructor:function(a){this.nls=l.mixin(this.nls,builderNls);this._init(a.templateConfig,a.templateAppConfig)},destroy:function(){d.forEach(this.tooltips,function(a){a.destroy()});
this.inherited(arguments)},startup:function(){this.buildConfigurationPanel();this.inherited(arguments)},update:function(a){for(var b in a.values)a.values.hasOwnProperty(b)&&"function"!==typeof a.values[b]&&this._elementDijits[b].setDijitValue(a.values[b])},getElementDijits:function(){return this._elementDijits},getTemplateAppConfig:function(){var a=this._getValuesObjOfElementDijits();l.mixin(this._templateAppConfig.values,a);return this._templateAppConfig},onFieldChange:function(a,b,c){this.emit("fieldChanged",
{categoryName:a,fieldName:b,value:c})},_init:function(a,b){this._templateConfig=a||{configurationSettings:{},values:{}};this._templateAppConfig=b||{source:null,folderId:null,values:{webmap:null}};l.mixin(this._templateConfig.values,this._templateAppConfig.values);this._elementDijits={};this._templateConfig.configurationSettings&&this._templateAppConfig.values||console.error("AGOLTemplate config page: please provide correct parameters in the constructor");this.tooltips=[];this.originalItem={id:this._templateConfig.values.webmap||
this._templateConfig.values.group,type:this._templateConfig.values.webmap?"webmap":"group"}},_getWebmapOrGroupItem:function(a,b){var c=new q;try{"webmap"===b?this.portal.queryItems({q:"id:"+a}).then(l.hitch(this,function(a){0<a.results.length&&(this.item=a=a.results[0],this.itemTitle=a.title);c.resolve()})):this.portal.queryGroups({q:"id:"+a}).then(l.hitch(this,function(a){0<a.results.length&&(this.item=a=a.results[0],this.itemTitle=a.title);c.resolve()}))}catch(C){c.resolve()}return c.promise},buildConfigurationPanel:function(){var a=
[];d.forEach(this._templateConfig.configurationSettings,l.hitch(this,function(b){var c=b.category,e=b.fields,f=k.create("fieldset",{},this.containerNode);k.create("legend",l.mixin(b.params||{},{innerHTML:c}),f);d.forEach(e,l.hitch(this,function(b){a.push(this._createField(b,c).then(l.hitch(this,function(a){d.forEach(a.nodes,function(a){k.place(a.domNode||a,f)});k.create("br",{},f);"paragraph"!==a.type&&null!==a.fieldDijit&&b.tooltip&&b.tooltip.length&&this.tooltips.push(new g({connectId:[a.fieldDijit.id],
label:b.tooltip}))})))}))}));p(a).then(l.hitch(this,function(){}))},_createField:function(a,b){var c=new q,d=null,f=a.type&&a.type.toLowerCase()||"string",g=[],h=k.create("layerandfieldselector"===f?"p":"label",{innerHTML:e.stripHTML(a.label)||"",id:f+"_"+a.fieldName,"class":f},null);g.push(h);"boolean"===f?(g.splice(0,0,d=this._createBooleanField(a,b)),k.addClass(h,"checkout-box-label")):"number"===f?g.push(d=this._createNumberField(a,b)):"paragraph"===f?g.splice(0,1,d=this._createParagraph(a)):
a.options?g.push(d=this._createOptionsField(a,b)):"color"===f?g.push(d=this._createColor(a,b)):g.push(d=this._createStringField(a,b));k.setAttr(h,"for",d.id);c.resolve({nodes:g,fieldDijit:d,type:f});return c.promise},_createBooleanField:function(a,b){var c=l.mixin({value:!0,name:a.fieldName},a),d=this._templateConfig.values;c.checked=d&&void 0!==d[a.fieldName]?d[a.fieldName]:!0;c=new u(c);this._afterCreateNormalField(c,b,a.fieldName);return c},_createNumberField:function(a,b){var c=l.mixin({name:a.fieldName,
"class":"field-input"},a),d=this._templateConfig.values;c.value=d&&void 0!==d[a.fieldName]?d[a.fieldName]:a.min||NaN;c=new n(c);this._afterCreateNormalField(c,b,a.fieldName);return c},_createParagraph:function(a){var b=l.mixin({name:a.fieldName||""},a);b.innerHTML=a.value||"";return k.create("p",b)},_createOptionsField:function(a,b){var c={maxHeight:this.defaultMaxSelectHeight,name:a.fieldName,"class":"field-input"},c=l.mixin(c,a),e=-1,f=d.some(c.options,l.hitch(this,function(b,c){e=c;return b.value===
this._templateConfig.values[a.fieldName]?c:!1}));c.options[f?e:0].selected=!0;c=new t(c);this._afterCreateNormalField(c,b,a.fieldName);return c},_createStringField:function(a,b){var c=null,c={regExp:".*",constraints:{},trim:!0,name:a.fieldName,value:(this._templateConfig.values[a.fieldName]||"").toString(),"class":" "},c=l.mixin(c,a);a.stringFieldOption&&a.stringFieldOption===z.STRING_FIELD_OPTION_TEXTAREA?(c["class"]+=" field-input text-area-field",c.rows=a.rows||this.defaultTextAreaSize,c.columns=
a.columns||this.defaultTextAreaSize,c=new v(c)):a.stringFieldOption&&a.stringFieldOption===z.STRING_FIELD_OPTION_RICHTEXT?(c["class"]+=" rich-text-field",c.plugins="bold italic underline foreColor hiliteColor removeFormat | justifyLeft indent outdent | insertOrderedList insertUnorderedList |".split(" "),c.extraPlugins=["createLink","unlink","insertImage"],c=new x(c)):(c["class"]+=" field-input",c=new f(c));this._afterCreateNormalField(c,b,a.fieldName);return c},_createColor:function(a,b){var c=new w({name:a.fieldName,
required:!0,showTransparencySlider:!1,showRecentColors:!1,"class":"color-picker-field"});this._templateConfig.values[a.fieldName]&&c.set("color",this._templateConfig.values[a.fieldName]);c.setDijitValue=l.hitch(c,function(a){this.set("color",a,!1)});c.getDijitValue=l.hitch(c,function(){this.get("color")});this._elementDijits[a.fieldName]=c;c.on("color-change",l.hitch(this,function(c){if(c&&c.color)this.onFieldChange(b,a.fieldName,c.color.toHex())}));return c},_afterCreateNormalField:function(a,b,
c){a.setDijitValue=l.hitch(a,function(a){this.set("value",a,!1)});a.getDijitValue=l.hitch(a,function(){return this.get("value")});this._elementDijits[c]=a;this.own(m(a,"change",l.hitch(this,this.onFieldChange,b,c)))},_getValuesObjOfElementDijits:function(){var a={},b=this.getElementDijits(),c;for(c in b)b.hasOwnProperty(c)&&"function"!==typeof b[c]&&(a[c]=b[c].getDijitValue());return a}});l.mixin(z,{STRING_FIELD_OPTION_TEXTBOX:"textbox",STRING_FIELD_OPTION_TEXTAREA:"textarea",STRING_FIELD_OPTION_RICHTEXT:"richtext"});
return z})},"dijit/form/CheckBox":function(){define("require dojo/_base/declare dojo/dom-attr dojo/has dojo/query dojo/ready ./ToggleButton ./_CheckBoxMixin dojo/text!./templates/CheckBox.html dojo/NodeList-dom ../a11yclick".split(" "),function(r,l,d,q,k,m,p,h,e){q("dijit-legacy-requires")&&m(0,function(){r(["dijit/form/RadioButton"])});return l("dijit.form.CheckBox",[p,h],{templateString:e,baseClass:"dijitCheckBox",_setValueAttr:function(c,b){"string"==typeof c&&(this.inherited(arguments),c=!0);
this._created&&this.set("checked",c,b)},_getValueAttr:function(){return this.checked&&this._get("value")},_setIconClassAttr:null,_setNameAttr:"focusNode",postMixInProperties:function(){this.inherited(arguments);this.checkedAttrSetting=""},_fillContent:function(){},_onFocus:function(){this.id&&k("label[for\x3d'"+this.id+"']").addClass("dijitFocusedLabel");this.inherited(arguments)},_onBlur:function(){this.id&&k("label[for\x3d'"+this.id+"']").removeClass("dijitFocusedLabel");this.inherited(arguments)}})})},
"dijit/form/ToggleButton":function(){define(["dojo/_base/declare","dojo/_base/kernel","./Button","./_ToggleButtonMixin"],function(r,l,d,q){return r("dijit.form.ToggleButton",[d,q],{baseClass:"dijitToggleButton",setChecked:function(d){l.deprecated("setChecked("+d+") is deprecated. Use set('checked',"+d+") instead.","","2.0");this.set("checked",d)}})})},"dijit/form/_ToggleButtonMixin":function(){define(["dojo/_base/declare","dojo/dom-attr"],function(r,l){return r("dijit.form._ToggleButtonMixin",null,
{checked:!1,_aria_attr:"aria-pressed",_onClick:function(d){var l=this.checked;this._set("checked",!l);var k=this.inherited(arguments);this.set("checked",k?this.checked:l);return k},_setCheckedAttr:function(d,q){this._set("checked",d);var k=this.focusNode||this.domNode;this._created&&l.get(k,"checked")!=!!d&&l.set(k,"checked",!!d);k.setAttribute(this._aria_attr,String(d));this._handleOnChange(d,q)},postCreate:function(){this.inherited(arguments);var d=this.focusNode||this.domNode;this.checked&&d.setAttribute("checked",
"checked");void 0===this._resetValue&&(this._lastValueReported=this._resetValue=this.checked)},reset:function(){this._hasBeenBlurred=!1;this.set("checked",this.params.checked||!1)}})})},"dijit/form/_CheckBoxMixin":function(){define(["dojo/_base/declare","dojo/dom-attr"],function(r,l){return r("dijit.form._CheckBoxMixin",null,{type:"checkbox",value:"on",readOnly:!1,_aria_attr:"aria-checked",_setReadOnlyAttr:function(d){this._set("readOnly",d);l.set(this.focusNode,"readOnly",d)},_setLabelAttr:void 0,
_getSubmitValue:function(d){return null==d||""===d?"on":d},_setValueAttr:function(d){d=this._getSubmitValue(d);this._set("value",d);l.set(this.focusNode,"value",d)},reset:function(){this.inherited(arguments);this._set("value",this._getSubmitValue(this.params.value));l.set(this.focusNode,"value",this.value)},_onClick:function(d){return this.readOnly?(d.stopPropagation(),d.preventDefault(),!1):this.inherited(arguments)}})})},"dijit/form/NumberTextBox":function(){define("dojo/_base/declare dojo/_base/lang dojo/i18n dojo/string dojo/number ./RangeBoundTextBox".split(" "),
function(r,l,d,q,k,m){var p=function(e){e=e||{};var c=d.getLocalization("dojo.cldr","number",d.normalizeLocale(e.locale)),b=e.pattern?e.pattern:c[(e.type||"decimal")+"Format"];e="number"==typeof e.places?e.places:"string"===typeof e.places&&0<e.places.length?e.places.replace(/.*,/,""):-1!=b.indexOf(".")?b.split(".")[1].replace(/[^#0]/g,"").length:0;return{sep:c.decimal,places:e}},h=r("dijit.form.NumberTextBoxMixin",null,{pattern:function(d){return"("+(this.focused&&this.editOptions?this._regExpGenerator(l.delegate(d,
this.editOptions))+"|":"")+this._regExpGenerator(d)+")"},value:NaN,editOptions:{pattern:"#.######"},_formatter:k.format,_regExpGenerator:k.regexp,_decimalInfo:p(),postMixInProperties:function(){this.inherited(arguments);this._set("type","text")},_setConstraintsAttr:function(d){var c="number"==typeof d.places?d.places:0;c&&c++;"number"!=typeof d.max&&(d.max=9*Math.pow(10,15-c));"number"!=typeof d.min&&(d.min=-9*Math.pow(10,15-c));this.inherited(arguments,[d]);this.focusNode&&this.focusNode.value&&
!isNaN(this.value)&&this.set("value",this.value);this._decimalInfo=p(d)},_onFocus:function(){if(!this.disabled&&!this.readOnly){var d=this.get("value");"number"!=typeof d||isNaN(d)||(d=this.format(d,this.constraints),void 0!==d&&(this.textbox.value=d));this.inherited(arguments)}},format:function(d,c){var b=String(d);if("number"!=typeof d)return b;if(isNaN(d))return"";if(!("rangeCheck"in this&&this.rangeCheck(d,c))&&!1!==c.exponent&&/\de[-+]?\d/i.test(b))return b;this.editOptions&&this.focused&&(c=
l.mixin({},c,this.editOptions));return this._formatter(d,c)},_parser:k.parse,parse:function(d,c){var b=l.mixin({},c,this.editOptions&&this.focused?this.editOptions:{});if(this.focused&&null!=b.places){var a=b.places,a="number"===typeof a?a:Number(a.split(",").pop());b.places="0,"+a}b=this._parser(d,b);this.editOptions&&this.focused&&isNaN(b)&&(b=this._parser(d,c));return b},_getDisplayedValueAttr:function(){var d=this.inherited(arguments);return isNaN(d)?this.textbox.value:d},filter:function(d){if(null==
d||"string"==typeof d&&""==d)return NaN;"number"!=typeof d||isNaN(d)||0==d||(d=k.round(d,this._decimalInfo.places));return this.inherited(arguments,[d])},serialize:function(d,c){return"number"!=typeof d||isNaN(d)?"":this.inherited(arguments)},_setBlurValue:function(){var d=l.hitch(l.delegate(this,{focused:!0}),"get")("value");this._setValueAttr(d,!0)},_setValueAttr:function(d,c,b){if(void 0!==d&&void 0===b)if(b=String(d),"number"==typeof d)if(isNaN(d))b="";else{if("rangeCheck"in this&&this.rangeCheck(d,
this.constraints)||!1===this.constraints.exponent||!/\de[-+]?\d/i.test(b))b=void 0}else d?d=void 0:(b="",d=NaN);this.inherited(arguments,[d,c,b])},_getValueAttr:function(){var d=this.inherited(arguments);if(isNaN(d)&&""!==this.textbox.value){if(!1!==this.constraints.exponent&&/\de[-+]?\d/i.test(this.textbox.value)&&(new RegExp("^"+k._realNumberRegexp(l.delegate(this.constraints))+"$")).test(this.textbox.value))return d=Number(this.textbox.value),isNaN(d)?void 0:d}else return d},isValid:function(d){if(!this.focused||
this._isEmpty(this.textbox.value))return this.inherited(arguments);var c=this.get("value");return!isNaN(c)&&this.rangeCheck(c,this.constraints)?!1!==this.constraints.exponent&&/\de[-+]?\d/i.test(this.textbox.value)?!0:this.inherited(arguments):!1},_isValidSubset:function(){var d="number"==typeof this.constraints.min,c="number"==typeof this.constraints.max,b=this.get("value");if(isNaN(b)||!d&&!c)return this.inherited(arguments);var a=b|0,g=0>b,h=-1!=this.textbox.value.indexOf(this._decimalInfo.sep),
k=(this.maxLength||20)-this.textbox.value.length,l=h?this.textbox.value.split(this._decimalInfo.sep)[1].replace(/[^0-9]/g,""):"",a=h?a+"."+l:a+"",k=q.rep("9",k),h=b;g?h=Number(a+k):b=Number(a+k);return!(d&&b<this.constraints.min||c&&h>this.constraints.max)}});r=r("dijit.form.NumberTextBox",[m,h],{baseClass:"dijitTextBox dijitNumberTextBox"});r.Mixin=h;return r})},"dijit/form/RangeBoundTextBox":function(){define(["dojo/_base/declare","dojo/i18n","./MappedTextBox","dojo/i18n!./nls/validate"],function(r,
l,d){return r("dijit.form.RangeBoundTextBox",d,{rangeMessage:"",rangeCheck:function(d,k){return("min"in k?0<=this.compare(d,k.min):!0)&&("max"in k?0>=this.compare(d,k.max):!0)},isInRange:function(){return this.rangeCheck(this.get("value"),this.constraints)},_isDefinitelyOutOfRange:function(){var d=this.get("value");if(null==d)return!1;var k=!1;"min"in this.constraints&&(k=this.constraints.min,k=0>this.compare(d,"number"==typeof k&&0<=k&&0!=d?0:k));!k&&"max"in this.constraints&&(k=this.constraints.max,
k=0<this.compare(d,"number"!=typeof k||0<k?k:0));return k},_isValidSubset:function(){return this.inherited(arguments)&&!this._isDefinitelyOutOfRange()},isValid:function(d){return this.inherited(arguments)&&(this._isEmpty(this.textbox.value)&&!this.required||this.isInRange(d))},getErrorMessage:function(d){var k=this.get("value");return null==k||""===k||"number"==typeof k&&isNaN(k)||this.isInRange(d)?this.inherited(arguments):this.rangeMessage},postMixInProperties:function(){this.inherited(arguments);
this.rangeMessage||(this.messages=l.getLocalization("dijit.form","validate",this.lang),this.rangeMessage=this.messages.rangeMessage)}})})},"dijit/form/MappedTextBox":function(){define(["dojo/_base/declare","dojo/sniff","dojo/dom-construct","./ValidationTextBox"],function(r,l,d,q){return r("dijit.form.MappedTextBox",q,{postMixInProperties:function(){this.inherited(arguments);this.nameAttrSetting=""},_setNameAttr:"valueNode",serialize:function(d){return d.toString?d.toString():""},toString:function(){var d=
this.filter(this.get("value"));return null!=d?"string"==typeof d?d:this.serialize(d,this.constraints):""},validate:function(){this.valueNode.value=this.toString();return this.inherited(arguments)},buildRendering:function(){this.inherited(arguments);this.valueNode=d.place("\x3cinput type\x3d'hidden'"+(this.name&&!l("msapp")?' name\x3d"'+this.name.replace(/"/g,"\x26quot;")+'"':"")+"/\x3e",this.textbox,"after")},reset:function(){this.valueNode.value="";this.inherited(arguments)}})})},"dijit/form/Select":function(){define("dojo/_base/array dojo/_base/declare dojo/dom-attr dojo/dom-class dojo/dom-geometry dojo/i18n dojo/keys dojo/_base/lang dojo/on dojo/sniff ./_FormSelectWidget ../_HasDropDown ../DropDownMenu ../MenuItem ../MenuSeparator ../Tooltip ../_KeyNavMixin ../registry dojo/text!./templates/Select.html dojo/i18n!./nls/validate".split(" "),
function(r,l,d,q,k,m,p,h,e,c,b,a,g,u,n,t,f,v,x){function w(a){return function(b){this._isLoaded?this.inherited(a,arguments):this.loadDropDown(h.hitch(this,a,b))}}var z=l("dijit.form._SelectMenu",g,{autoFocus:!0,buildRendering:function(){this.inherited(arguments);this.domNode.setAttribute("role","listbox")},postCreate:function(){this.inherited(arguments);this.own(e(this.domNode,"selectstart",function(a){a.preventDefault();a.stopPropagation()}))},focus:function(){var a=!1,b=this.parentWidget.value;
h.isArray(b)&&(b=b[b.length-1]);b&&r.forEach(this.parentWidget._getChildren(),function(c){c.option&&b===c.option.value&&(a=!0,this.focusChild(c,!1))},this);a||this.inherited(arguments)}});k=l("dijit.form.Select"+(c("dojo-bidi")?"_NoBidi":""),[b,a,f],{baseClass:"dijitSelect dijitValidationTextBox",templateString:x,_buttonInputDisabled:c("ie")?"disabled":"",required:!1,state:"",message:"",tooltipPosition:[],emptyLabel:"\x26#160;",_isLoaded:!1,_childrenLoaded:!1,labelType:"html",_fillContent:function(){this.inherited(arguments);
if(this.options.length&&!this.value&&this.srcNodeRef){var a=this.srcNodeRef.selectedIndex||0;this._set("value",this.options[0<=a?a:0].value)}this.dropDown=new z({id:this.id+"_menu",parentWidget:this});q.add(this.dropDown.domNode,this.baseClass.replace(/\s+|$/g,"Menu "))},_getMenuItemForOption:function(a){if(a.value||a.label){var b=h.hitch(this,"_setValueAttr",a);a=new u({option:a,label:("text"===this.labelType?(a.label||"").toString().replace(/&/g,"\x26amp;").replace(/</g,"\x26lt;"):a.label)||this.emptyLabel,
onClick:b,ownerDocument:this.ownerDocument,dir:this.dir,textDir:this.textDir,disabled:a.disabled||!1});a.focusNode.setAttribute("role","option");return a}return new n({ownerDocument:this.ownerDocument})},_addOptionItem:function(a){this.dropDown&&this.dropDown.addChild(this._getMenuItemForOption(a))},_getChildren:function(){return this.dropDown?this.dropDown.getChildren():[]},focus:function(){if(!this.disabled&&this.focusNode.focus)try{this.focusNode.focus()}catch(A){}},focusChild:function(a){a&&this.set("value",
a.option)},_getFirst:function(){var a=this._getChildren();return a.length?a[0]:null},_getLast:function(){var a=this._getChildren();return a.length?a[a.length-1]:null},childSelector:function(a){return(a=v.byNode(a))&&a.getParent()==this.dropDown},onKeyboardSearch:function(a,b,c,d){a&&this.focusChild(a)},_loadChildren:function(a){if(!0===a)if(this.dropDown&&(delete this.dropDown.focusedChild,this.focusedChild=null),this.options.length)this.inherited(arguments);else{r.forEach(this._getChildren(),function(a){a.destroyRecursive()});
var b=new u({ownerDocument:this.ownerDocument,label:this.emptyLabel});this.dropDown.addChild(b)}else this._updateSelection();this._isLoaded=!1;this._childrenLoaded=!0;this._loadingStore||this._setValueAttr(this.value,!1)},_refreshState:function(){this._started&&this.validate(this.focused)},startup:function(){this.inherited(arguments);this._refreshState()},_setValueAttr:function(a){this.inherited(arguments);d.set(this.valueNode,"value",this.get("value"));this._refreshState()},_setNameAttr:"valueNode",
_setDisabledAttr:function(a){this.inherited(arguments);this._refreshState()},_setRequiredAttr:function(a){this._set("required",a);this.focusNode.setAttribute("aria-required",a);this._refreshState()},_setOptionsAttr:function(a){this._isLoaded=!1;this._set("options",a)},_setDisplay:function(a){a=("text"===this.labelType?(a||"").replace(/&/g,"\x26amp;").replace(/</g,"\x26lt;"):a)||this.emptyLabel;this.containerNode.innerHTML='\x3cspan role\x3d"option" aria-selected\x3d"true" class\x3d"dijitReset dijitInline '+
this.baseClass.replace(/\s+|$/g,"Label ")+'"\x3e'+a+"\x3c/span\x3e"},validate:function(a){a=this.disabled||this.isValid(a);this._set("state",a?"":this._hasBeenBlurred?"Error":"Incomplete");this.focusNode.setAttribute("aria-invalid",a?"false":"true");var b=a?"":this._missingMsg;b&&this.focused&&this._hasBeenBlurred?t.show(b,this.domNode,this.tooltipPosition,!this.isLeftToRight()):t.hide(this.domNode);this._set("message",b);return a},isValid:function(){return!this.required||0===this.value||!/^\s*$/.test(this.value||
"")},reset:function(){this.inherited(arguments);t.hide(this.domNode);this._refreshState()},postMixInProperties:function(){this.inherited(arguments);this._missingMsg=m.getLocalization("dijit.form","validate",this.lang).missingMessage},postCreate:function(){this.inherited(arguments);this.own(e(this.domNode,"selectstart",function(a){a.preventDefault();a.stopPropagation()}));this.domNode.setAttribute("aria-expanded","false");var a=this._keyNavCodes;delete a[p.LEFT_ARROW];delete a[p.RIGHT_ARROW]},_setStyleAttr:function(a){this.inherited(arguments);
q.toggle(this.domNode,this.baseClass.replace(/\s+|$/g,"FixedWidth "),!!this.domNode.style.width)},isLoaded:function(){return this._isLoaded},loadDropDown:function(a){this._loadChildren(!0);this._isLoaded=!0;a()},destroy:function(a){this.dropDown&&!this.dropDown._destroyed&&(this.dropDown.destroyRecursive(a),delete this.dropDown);t.hide(this.domNode);this.inherited(arguments)},_onFocus:function(){this.validate(!0)},_onBlur:function(){t.hide(this.domNode);this.inherited(arguments);this.validate(!1)}});
c("dojo-bidi")&&(k=l("dijit.form.Select",k,{_setDisplay:function(a){this.inherited(arguments);this.applyTextDir(this.containerNode)}}));k._Menu=z;k.prototype._onContainerKeydown=w("_onContainerKeydown");k.prototype._onContainerKeypress=w("_onContainerKeypress");return k})},"dijit/form/_FormSelectWidget":function(){define("dojo/_base/array dojo/_base/Deferred dojo/aspect dojo/data/util/sorter dojo/_base/declare dojo/dom dojo/dom-class dojo/_base/kernel dojo/_base/lang dojo/query dojo/when dojo/store/util/QueryResults ./_FormValueWidget".split(" "),
function(r,l,d,q,k,m,p,h,e,c,b,a,g){return k("dijit.form._FormSelectWidget",g,{multiple:!1,options:null,store:null,_setStoreAttr:function(a){this._created&&this._deprecatedSetStore(a)},query:null,_setQueryAttr:function(a){this._created&&this._deprecatedSetStore(this.store,this.selectedValue,{query:a})},queryOptions:null,_setQueryOptionsAttr:function(a){this._created&&this._deprecatedSetStore(this.store,this.selectedValue,{queryOptions:a})},labelAttr:"",onFetch:null,sortByLabel:!0,loadChildrenOnOpen:!1,
onLoadDeferred:null,getOptions:function(a){var b=this.options||[];if(null==a)return b;if(e.isArrayLike(a))return r.map(a,"return this.getOptions(item);",this);e.isString(a)&&(a={value:a});e.isObject(a)&&(r.some(b,function(b,c){for(var d in a)if(!(d in b)||b[d]!=a[d])return!1;a=c;return!0})||(a=-1));return 0<=a&&a<b.length?b[a]:null},addOption:function(a){r.forEach(e.isArrayLike(a)?a:[a],function(a){a&&e.isObject(a)&&this.options.push(a)},this);this._loadChildren()},removeOption:function(a){a=this.getOptions(e.isArrayLike(a)?
a:[a]);r.forEach(a,function(a){a&&(this.options=r.filter(this.options,function(b){return b.value!==a.value||b.label!==a.label}),this._removeOptionItem(a))},this);this._loadChildren()},updateOption:function(a){r.forEach(e.isArrayLike(a)?a:[a],function(a){var b=this.getOptions({value:a.value}),c;if(b)for(c in a)b[c]=a[c]},this);this._loadChildren()},setStore:function(a,b,c){h.deprecated(this.declaredClass+"::setStore(store, selectedValue, fetchArgs) is deprecated. Use set('query', fetchArgs.query), set('queryOptions', fetchArgs.queryOptions), set('store', store), or set('value', selectedValue) instead.",
"","2.0");this._deprecatedSetStore(a,b,c)},_deprecatedSetStore:function(c,g,h){var f=this.store;h=h||{};if(f!==c){for(var k;k=this._notifyConnections.pop();)k.remove();c.get||(e.mixin(c,{_oldAPI:!0,get:function(a){var b=new l;this.fetchItemByIdentity({identity:a,onItem:function(a){b.resolve(a)},onError:function(a){b.reject(a)}});return b.promise},query:function(b,c){var d=new l(function(){f.abort&&f.abort()});d.total=new l;var f=this.fetch(e.mixin({query:b,onBegin:function(a){d.total.resolve(a)},
onComplete:function(a){d.resolve(a)},onError:function(a){d.reject(a)}},c));return new a(d)}}),c.getFeatures()["dojo.data.api.Notification"]&&(this._notifyConnections=[d.after(c,"onNew",e.hitch(this,"_onNewItem"),!0),d.after(c,"onDelete",e.hitch(this,"_onDeleteItem"),!0),d.after(c,"onSet",e.hitch(this,"_onSetItem"),!0)]));this._set("store",c)}this.options&&this.options.length&&this.removeOption(this.options);this._queryRes&&this._queryRes.close&&this._queryRes.close();this._observeHandle&&this._observeHandle.remove&&
(this._observeHandle.remove(),this._observeHandle=null);h.query&&this._set("query",h.query);h.queryOptions&&this._set("queryOptions",h.queryOptions);c&&c.query&&(this._loadingStore=!0,this.onLoadDeferred=new l,this._queryRes=c.query(this.query,this.queryOptions),b(this._queryRes,e.hitch(this,function(a){if(this.sortByLabel&&!h.sort&&a.length)if(c.getValue)a.sort(q.createSortFunction([{attribute:c.getLabelAttributes(a[0])[0]}],c));else{var b=this.labelAttr;a.sort(function(a,c){return a[b]>c[b]?1:c[b]>
a[b]?-1:0})}h.onFetch&&(a=h.onFetch.call(this,a,h));r.forEach(a,function(a){this._addOptionForItem(a)},this);this._queryRes.observe&&(this._observeHandle=this._queryRes.observe(e.hitch(this,function(a,b,c){b==c?this._onSetItem(a):(-1!=b&&this._onDeleteItem(a),-1!=c&&this._onNewItem(a))}),!0));this._loadingStore=!1;this.set("value","_pendingValue"in this?this._pendingValue:g);delete this._pendingValue;this.loadChildrenOnOpen?this._pseudoLoadChildren(a):this._loadChildren();this.onLoadDeferred.resolve(!0);
this.onSetStore()}),e.hitch(this,function(a){console.error("dijit.form.Select: "+a.toString());this.onLoadDeferred.reject(a)})));return f},_setValueAttr:function(a,b){this._onChangeActive||(b=null);if(this._loadingStore)this._pendingValue=a;else if(null!=a){a=e.isArrayLike(a)?r.map(a,function(a){return e.isObject(a)?a:{value:a}}):e.isObject(a)?[a]:[{value:a}];a=r.filter(this.getOptions(a),function(a){return a&&a.value});var c=this.getOptions()||[];this.multiple||a[0]&&a[0].value||!c.length||(a[0]=
c[0]);r.forEach(c,function(b){b.selected=r.some(a,function(a){return a.value===b.value})});c=r.map(a,function(a){return a.value});if("undefined"!=typeof c&&"undefined"!=typeof c[0]){var d=r.map(a,function(a){return a.label});this._setDisplay(this.multiple?d:d[0]);this.inherited(arguments,[this.multiple?c:c[0],b]);this._updateSelection()}}},_getDisplayedValueAttr:function(){var a=r.map([].concat(this.get("selectedOptions")),function(a){return a&&"label"in a?a.label:a?a.value:null},this);return this.multiple?
a:a[0]},_setDisplayedValueAttr:function(a){this.set("value",this.getOptions("string"==typeof a?{label:a}:a))},_loadChildren:function(){this._loadingStore||(r.forEach(this._getChildren(),function(a){a.destroyRecursive()}),r.forEach(this.options,this._addOptionItem,this),this._updateSelection())},_updateSelection:function(){this.focusedChild=null;this._set("value",this._getValueFromOpts());var a=[].concat(this.value);if(a&&a[0]){var b=this;r.forEach(this._getChildren(),function(c){var d=r.some(a,function(a){return c.option&&
a===c.option.value});d&&!b.multiple&&(b.focusedChild=c);p.toggle(c.domNode,this.baseClass.replace(/\s+|$/g,"SelectedOption "),d);c.domNode.setAttribute("aria-selected",d?"true":"false")},this)}},_getValueFromOpts:function(){var a=this.getOptions()||[];if(!this.multiple&&a.length){var b=r.filter(a,function(a){return a.selected})[0];if(b&&b.value)return b.value;a[0].selected=!0;return a[0].value}return this.multiple?r.map(r.filter(a,function(a){return a.selected}),function(a){return a.value})||[]:""},
_onNewItem:function(a,b){b&&b.parent||this._addOptionForItem(a)},_onDeleteItem:function(a){this.removeOption({value:this.store.getIdentity(a)})},_onSetItem:function(a){this.updateOption(this._getOptionObjForItem(a))},_getOptionObjForItem:function(a){var b=this.store,c=this.labelAttr&&this.labelAttr in a?a[this.labelAttr]:b.getLabel(a);return{value:c?b.getIdentity(a):null,label:c,item:a}},_addOptionForItem:function(a){var b=this.store;b.isItemLoaded&&!b.isItemLoaded(a)?b.loadItem({item:a,onItem:function(a){this._addOptionForItem(a)},
scope:this}):(a=this._getOptionObjForItem(a),this.addOption(a))},constructor:function(a){this._oValue=(a||{}).value||null;this._notifyConnections=[]},buildRendering:function(){this.inherited(arguments);m.setSelectable(this.focusNode,!1)},_fillContent:function(){this.options||(this.options=this.srcNodeRef?c("\x3e *",this.srcNodeRef).map(function(a){return"separator"===a.getAttribute("type")?{value:"",label:"",selected:!1,disabled:!1}:{value:a.getAttribute("data-"+h._scopeName+"-value")||a.getAttribute("value"),
label:String(a.innerHTML),selected:a.getAttribute("selected")||!1,disabled:a.getAttribute("disabled")||!1}},this):[]);this.value?this.multiple&&"string"==typeof this.value&&this._set("value",this.value.split(",")):this._set("value",this._getValueFromOpts())},postCreate:function(){this.inherited(arguments);d.after(this,"onChange",e.hitch(this,"_updateSelection"));var a=this.store;a&&(a.getIdentity||a.getFeatures()["dojo.data.api.Identity"])&&(this.store=null,this._deprecatedSetStore(a,this._oValue,
{query:this.query,queryOptions:this.queryOptions}));this._storeInitialized=!0},startup:function(){this._loadChildren();this.inherited(arguments)},destroy:function(){for(var a;a=this._notifyConnections.pop();)a.remove();this._queryRes&&this._queryRes.close&&this._queryRes.close();this._observeHandle&&this._observeHandle.remove&&(this._observeHandle.remove(),this._observeHandle=null);this.inherited(arguments)},_addOptionItem:function(){},_removeOptionItem:function(){},_setDisplay:function(){},_getChildren:function(){return[]},
_getSelectedOptionsAttr:function(){return this.getOptions({selected:!0})},_pseudoLoadChildren:function(){},onSetStore:function(){}})})},"dojo/data/util/sorter":function(){define(["../../_base/lang"],function(r){var l={};r.setObject("dojo.data.util.sorter",l);l.basicComparator=function(d,l){var k=-1;null===d&&(d=void 0);null===l&&(l=void 0);if(d==l)k=0;else if(d>l||null==d)k=1;return k};l.createSortFunction=function(d,q){function k(a,b,c,d){return function(e,g){var f=d.getValue(e,a),h=d.getValue(g,
a);return b*c(f,h)}}for(var m=[],p,h=q.comparatorMap,e=l.basicComparator,c=0;c<d.length;c++){p=d[c];var b=p.attribute;if(b){p=p.descending?-1:1;var a=e;h&&("string"!==typeof b&&"toString"in b&&(b=b.toString()),a=h[b]||e);m.push(k(b,p,a,q))}}return function(a,b){for(var c=0;c<m.length;){var d=m[c++](a,b);if(0!==d)return d}return 0}};return l})},"dijit/_HasDropDown":function(){define("dojo/_base/declare dojo/_base/Deferred dojo/dom dojo/dom-attr dojo/dom-class dojo/dom-geometry dojo/dom-style dojo/has dojo/keys dojo/_base/lang dojo/on dojo/touch ./registry ./focus ./popup ./_FocusMixin".split(" "),
function(r,l,d,q,k,m,p,h,e,c,b,a,g,u,n,t){return r("dijit._HasDropDown",t,{_buttonNode:null,_arrowWrapperNode:null,_popupStateNode:null,_aroundNode:null,dropDown:null,autoWidth:!0,forceWidth:!1,maxHeight:-1,dropDownPosition:["below","above"],_stopClickEvents:!0,_onDropDownMouseDown:function(d){this.disabled||this.readOnly||("MSPointerDown"!=d.type&&d.preventDefault(),this.own(b.once(this.ownerDocument,a.release,c.hitch(this,"_onDropDownMouseUp"))),this.toggleDropDown())},_onDropDownMouseUp:function(a){var b=
this.dropDown,c=!1;if(a&&this._opened){var d=m.position(this._buttonNode,!0);if(!(a.pageX>=d.x&&a.pageX<=d.x+d.w&&a.pageY>=d.y&&a.pageY<=d.y+d.h)){for(d=a.target;d&&!c;)k.contains(d,"dijitPopup")?c=!0:d=d.parentNode;if(c){d=a.target;if(b.onItemClick){for(var e;d&&!(e=g.byNode(d));)d=d.parentNode;if(e&&e.onClick&&e.getParent)e.getParent().onItemClick(e,a)}return}}}this._opened?b.focus&&(!1!==b.autoFocus||"mouseup"==a.type&&!this.hovering)&&(this._focusDropDownTimer=this.defer(function(){b.focus();
delete this._focusDropDownTimer})):this.focus&&this.defer("focus")},_onDropDownClick:function(a){this._stopClickEvents&&(a.stopPropagation(),a.preventDefault())},buildRendering:function(){this.inherited(arguments);this._buttonNode=this._buttonNode||this.focusNode||this.domNode;this._popupStateNode=this._popupStateNode||this.focusNode||this._buttonNode;var a={after:this.isLeftToRight()?"Right":"Left",before:this.isLeftToRight()?"Left":"Right",above:"Up",below:"Down",left:"Left",right:"Right"}[this.dropDownPosition[0]]||
this.dropDownPosition[0]||"Down";k.add(this._arrowWrapperNode||this._buttonNode,"dijit"+a+"ArrowButton")},postCreate:function(){this.inherited(arguments);var d=this.focusNode||this.domNode;this.own(b(this._buttonNode,a.press,c.hitch(this,"_onDropDownMouseDown")),b(this._buttonNode,"click",c.hitch(this,"_onDropDownClick")),b(d,"keydown",c.hitch(this,"_onKey")),b(d,"keyup",c.hitch(this,"_onKeyUp")))},destroy:function(){this._opened&&this.closeDropDown(!0);this.dropDown&&(this.dropDown._destroyed||this.dropDown.destroyRecursive(),
delete this.dropDown);this.inherited(arguments)},_onKey:function(a){if(!this.disabled&&!this.readOnly){var b=this.dropDown,c=a.target;b&&this._opened&&b.handleKey&&!1===b.handleKey(a)?(a.stopPropagation(),a.preventDefault()):b&&this._opened&&a.keyCode==e.ESCAPE?(this.closeDropDown(),a.stopPropagation(),a.preventDefault()):!this._opened&&(a.keyCode==e.DOWN_ARROW||(a.keyCode==e.ENTER||a.keyCode==e.SPACE&&(!this._searchTimer||a.ctrlKey||a.altKey||a.metaKey))&&("input"!==(c.tagName||"").toLowerCase()||
c.type&&"text"!==c.type.toLowerCase()))&&(this._toggleOnKeyUp=!0,a.stopPropagation(),a.preventDefault())}},_onKeyUp:function(){if(this._toggleOnKeyUp){delete this._toggleOnKeyUp;this.toggleDropDown();var a=this.dropDown;a&&a.focus&&this.defer(c.hitch(a,"focus"),1)}},_onBlur:function(){this.closeDropDown(!1);this.inherited(arguments)},isLoaded:function(){return!0},loadDropDown:function(a){a()},loadAndOpenDropDown:function(){var a=new l,b=c.hitch(this,function(){this.openDropDown();a.resolve(this.dropDown)});
this.isLoaded()?b():this.loadDropDown(b);return a},toggleDropDown:function(){this.disabled||this.readOnly||(this._opened?this.closeDropDown(!0):this.loadAndOpenDropDown())},openDropDown:function(){var a=this.dropDown,b=a.domNode,d=this._aroundNode||this.domNode,e=this,g=n.open({parent:this,popup:a,around:d,orient:this.dropDownPosition,maxHeight:this.maxHeight,onExecute:function(){e.closeDropDown(!0)},onCancel:function(){e.closeDropDown(!0)},onClose:function(){q.set(e._popupStateNode,"popupActive",
!1);k.remove(e._popupStateNode,"dijitHasDropDownOpen");e._set("_opened",!1)}});if(this.forceWidth||this.autoWidth&&d.offsetWidth>a._popupWrapper.offsetWidth){var d=d.offsetWidth-a._popupWrapper.offsetWidth,h={w:a.domNode.offsetWidth+d};this._origStyle=b.style.cssText;c.isFunction(a.resize)?a.resize(h):m.setMarginBox(b,h);"R"==g.corner[1]&&(a._popupWrapper.style.left=a._popupWrapper.style.left.replace("px","")-d+"px")}q.set(this._popupStateNode,"popupActive","true");k.add(this._popupStateNode,"dijitHasDropDownOpen");
this._set("_opened",!0);this._popupStateNode.setAttribute("aria-expanded","true");this._popupStateNode.setAttribute("aria-owns",a.id);"presentation"===b.getAttribute("role")||b.getAttribute("aria-labelledby")||b.setAttribute("aria-labelledby",this.id);return g},closeDropDown:function(a){this._focusDropDownTimer&&(this._focusDropDownTimer.remove(),delete this._focusDropDownTimer);this._opened&&(this._popupStateNode.setAttribute("aria-expanded","false"),a&&this.focus&&this.focus(),n.close(this.dropDown),
this._opened=!1);this._origStyle&&(this.dropDown.domNode.style.cssText=this._origStyle,delete this._origStyle)}})})},"dijit/popup":function(){define("dojo/_base/array dojo/aspect dojo/_base/declare dojo/dom dojo/dom-attr dojo/dom-construct dojo/dom-geometry dojo/dom-style dojo/has dojo/keys dojo/_base/lang dojo/on ./place ./BackgroundIframe ./Viewport ./main dojo/touch".split(" "),function(r,l,d,q,k,m,p,h,e,c,b,a,g,u,n,t){function f(){this._popupWrapper&&(m.destroy(this._popupWrapper),delete this._popupWrapper)}
d=d(null,{_stack:[],_beginZIndex:1E3,_idGen:1,_repositionAll:function(){if(this._firstAroundNode){var a=this._firstAroundPosition,c=p.position(this._firstAroundNode,!0),d=c.x-a.x,a=c.y-a.y;if(d||a)for(this._firstAroundPosition=c,c=0;c<this._stack.length;c++){var e=this._stack[c].wrapper.style;e.top=parseFloat(e.top)+a+"px";"auto"==e.right?e.left=parseFloat(e.left)+d+"px":e.right=parseFloat(e.right)-d+"px"}this._aroundMoveListener=setTimeout(b.hitch(this,"_repositionAll"),d||a?10:50)}},_createWrapper:function(b){var c=
b._popupWrapper,d=b.domNode;c||(c=m.create("div",{"class":"dijitPopup",style:{display:"none"},role:"region","aria-label":b["aria-label"]||b.label||b.name||b.id},b.ownerDocumentBody),c.appendChild(d),d=d.style,d.display="",d.visibility="",d.position="",d.top="0px",b._popupWrapper=c,l.after(b,"destroy",f,!0),"ontouchend"in document&&a(c,"touchend",function(a){/^(input|button|textarea)$/i.test(a.target.tagName)||a.preventDefault()}),c.dojoClick=!0);return c},moveOffScreen:function(a){var b=this._createWrapper(a);
a=p.isBodyLtr(a.ownerDocument);var c={visibility:"hidden",top:"-9999px",display:""};c[a?"left":"right"]="-9999px";c[a?"right":"left"]="auto";h.set(b,c);return b},hide:function(a){var b=this._createWrapper(a);h.set(b,{display:"none",height:"auto",overflowY:"visible",border:""});a=a.domNode;"_originalStyle"in a&&(a.style.cssText=a._originalStyle)},getTopPopup:function(){for(var a=this._stack,b=a.length-1;0<b&&a[b].parent===a[b-1].widget;b--);return a[b]},open:function(d){for(var f=this._stack,l=d.popup,
m=l.domNode,t=d.orient||["below","below-alt","above","above-alt"],r=d.parent?d.parent.isLeftToRight():p.isBodyLtr(l.ownerDocument),v=d.around,C=d.around&&d.around.id?d.around.id+"_dropdown":"popup_"+this._idGen++;f.length&&(!d.parent||!q.isDescendant(d.parent.domNode,f[f.length-1].widget.domNode));)this.close(f[f.length-1].widget);var E=this.moveOffScreen(l);l.startup&&!l._started&&l.startup();var D,F=p.position(m);if("maxHeight"in d&&-1!=d.maxHeight)D=d.maxHeight||Infinity;else{D=n.getEffectiveBox(this.ownerDocument);
var G=v?p.position(v,!1):{y:d.y-(d.padding||0),h:2*(d.padding||0)};D=Math.floor(Math.max(G.y,D.h-(G.y+G.h)))}F.h>D&&(F=h.getComputedStyle(m),h.set(E,{overflowY:"scroll",height:D+"px",border:F.borderLeftWidth+" "+F.borderLeftStyle+" "+F.borderLeftColor}),m._originalStyle=m.style.cssText,m.style.border="none");k.set(E,{id:C,style:{zIndex:this._beginZIndex+f.length},"class":"dijitPopup "+(l.baseClass||l["class"]||"").split(" ")[0]+"Popup",dijitPopupParent:d.parent?d.parent.id:""});0==f.length&&v&&(this._firstAroundNode=
v,this._firstAroundPosition=p.position(v,!0),this._aroundMoveListener=setTimeout(b.hitch(this,"_repositionAll"),50));e("config-bgIframe")&&!l.bgIframe&&(l.bgIframe=new u(E));C=l.orient?b.hitch(l,"orient"):null;t=v?g.around(E,v,t,r,C):g.at(E,d,"R"==t?["TR","BR","TL","BL"]:["TL","BL","TR","BR"],d.padding,C);E.style.visibility="visible";m.style.visibility="visible";m=[];m.push(a(E,"keydown",b.hitch(this,function(a){if(a.keyCode==c.ESCAPE&&d.onCancel)a.stopPropagation(),a.preventDefault(),d.onCancel();
else if(a.keyCode==c.TAB&&(a.stopPropagation(),a.preventDefault(),(a=this.getTopPopup())&&a.onCancel))a.onCancel()})));l.onCancel&&d.onCancel&&m.push(l.on("cancel",d.onCancel));m.push(l.on(l.onExecute?"execute":"change",b.hitch(this,function(){var a=this.getTopPopup();if(a&&a.onExecute)a.onExecute()})));f.push({widget:l,wrapper:E,parent:d.parent,onExecute:d.onExecute,onCancel:d.onCancel,onClose:d.onClose,handlers:m});if(l.onOpen)l.onOpen(t);return t},close:function(a){for(var b=this._stack;a&&r.some(b,
function(b){return b.widget==a})||!a&&b.length;){var c=b.pop(),d=c.widget,e=c.onClose;d.bgIframe&&(d.bgIframe.destroy(),delete d.bgIframe);if(d.onClose)d.onClose();for(var f;f=c.handlers.pop();)f.remove();d&&d.domNode&&this.hide(d);e&&e()}0==b.length&&this._aroundMoveListener&&(clearTimeout(this._aroundMoveListener),this._firstAroundNode=this._firstAroundPosition=this._aroundMoveListener=null)}});return t.popup=new d})},"dijit/DropDownMenu":function(){define(["dojo/_base/declare","dojo/keys","dojo/text!./templates/Menu.html",
"./_MenuBase"],function(r,l,d,q){return r("dijit.DropDownMenu",q,{templateString:d,baseClass:"dijitMenu",_onUpArrow:function(){this.focusPrev()},_onDownArrow:function(){this.focusNext()},_onRightArrow:function(d){this._moveToPopup(d);d.stopPropagation();d.preventDefault()},_onLeftArrow:function(d){if(this.parentMenu)if(this.parentMenu._isMenuBar)this.parentMenu.focusPrev();else this.onCancel(!1);else d.stopPropagation(),d.preventDefault()}})})},"dijit/_MenuBase":function(){define("dojo/_base/array dojo/_base/declare dojo/dom dojo/dom-attr dojo/dom-class dojo/_base/lang dojo/mouse dojo/on dojo/window ./a11yclick ./registry ./_Widget ./_CssStateMixin ./_KeyNavContainer ./_TemplatedMixin".split(" "),
function(r,l,d,q,k,m,p,h,e,c,b,a,g,u,n){return l("dijit._MenuBase",[a,n,u,g],{selected:null,_setSelectedAttr:function(a){this.selected!=a&&(this.selected&&(this.selected._setSelected(!1),this._onChildDeselect(this.selected)),a&&a._setSelected(!0),this._set("selected",a))},activated:!1,_setActivatedAttr:function(a){k.toggle(this.domNode,"dijitMenuActive",a);k.toggle(this.domNode,"dijitMenuPassive",!a);this._set("activated",a)},parentMenu:null,popupDelay:500,passivePopupDelay:Infinity,autoFocus:!1,
childSelector:function(a){var c=b.byNode(a);return a.parentNode==this.containerNode&&c&&c.focus},postCreate:function(){var a=this,d="string"==typeof this.childSelector?this.childSelector:m.hitch(this,"childSelector");this.own(h(this.containerNode,h.selector(d,p.enter),function(){a.onItemHover(b.byNode(this))}),h(this.containerNode,h.selector(d,p.leave),function(){a.onItemUnhover(b.byNode(this))}),h(this.containerNode,h.selector(d,c),function(c){a.onItemClick(b.byNode(this),c);c.stopPropagation()}),
h(this.containerNode,h.selector(d,"focusin"),function(){a._onItemFocus(b.byNode(this))}));this.inherited(arguments)},onKeyboardSearch:function(a,b,c,d){this.inherited(arguments);if(a&&(-1==d||a.popup&&1==d))this.onItemClick(a,b)},_keyboardSearchCompare:function(a,b){return a.shortcutKey?b==a.shortcutKey.toLowerCase()?-1:0:this.inherited(arguments)?1:0},onExecute:function(){},onCancel:function(){},_moveToPopup:function(a){if(this.focusedChild&&this.focusedChild.popup&&!this.focusedChild.disabled)this.onItemClick(this.focusedChild,
a);else(a=this._getTopMenu())&&a._isMenuBar&&a.focusNext()},_onPopupHover:function(){this.set("selected",this.currentPopupItem);this._stopPendingCloseTimer()},onItemHover:function(a){this.activated?(this.set("selected",a),!a.popup||a.disabled||this.hover_timer||(this.hover_timer=this.defer(function(){this._openItemPopup(a)},this.popupDelay))):Infinity>this.passivePopupDelay&&(this.passive_hover_timer&&this.passive_hover_timer.remove(),this.passive_hover_timer=this.defer(function(){this.onItemClick(a,
{type:"click"})},this.passivePopupDelay));this._hoveredChild=a;a._set("hovering",!0)},_onChildDeselect:function(a){this._stopPopupTimer();this.currentPopupItem==a&&(this._stopPendingCloseTimer(),this._pendingClose_timer=this.defer(function(){this.currentPopupItem=this._pendingClose_timer=null;a._closePopup()},this.popupDelay))},onItemUnhover:function(a){this._hoveredChild==a&&(this._hoveredChild=null);this.passive_hover_timer&&(this.passive_hover_timer.remove(),this.passive_hover_timer=null);a._set("hovering",
!1)},_stopPopupTimer:function(){this.hover_timer&&(this.hover_timer=this.hover_timer.remove())},_stopPendingCloseTimer:function(){this._pendingClose_timer&&(this._pendingClose_timer=this._pendingClose_timer.remove())},_getTopMenu:function(){for(var a=this;a.parentMenu;a=a.parentMenu);return a},onItemClick:function(a,b){this.passive_hover_timer&&this.passive_hover_timer.remove();this.focusChild(a);if(a.disabled)return!1;if(a.popup){this.set("selected",a);this.set("activated",!0);var c=/^key/.test(b._origType||
b.type)||0==b.clientX&&0==b.clientY;this._openItemPopup(a,c)}else this.onExecute(),a._onClick?a._onClick(b):a.onClick(b)},_openItemPopup:function(a,b){if(a!=this.currentPopupItem){this.currentPopupItem&&(this._stopPendingCloseTimer(),this.currentPopupItem._closePopup());this._stopPopupTimer();var c=a.popup;c.parentMenu=this;this.own(this._mouseoverHandle=h.once(c.domNode,"mouseover",m.hitch(this,"_onPopupHover")));var d=this;a._openPopup({parent:this,orient:this._orient||["after","before"],onCancel:function(){b&&
d.focusChild(a);d._cleanUp()},onExecute:m.hitch(this,"_cleanUp",!0),onClose:function(){d._mouseoverHandle&&(d._mouseoverHandle.remove(),delete d._mouseoverHandle)}},b);this.currentPopupItem=a}},onOpen:function(){this.isShowingNow=!0;this.set("activated",!0)},onClose:function(){this.set("activated",!1);this.set("selected",null);this.isShowingNow=!1;this.parentMenu=null},_closeChild:function(){this._stopPopupTimer();this.currentPopupItem&&(this.focused&&(q.set(this.selected.focusNode,"tabIndex",this.tabIndex),
this.selected.focusNode.focus()),this.currentPopupItem._closePopup(),this.currentPopupItem=null)},_onItemFocus:function(a){if(this._hoveredChild&&this._hoveredChild!=a)this.onItemUnhover(this._hoveredChild);this.set("selected",a)},_onBlur:function(){this._cleanUp(!0);this.inherited(arguments)},_cleanUp:function(a){this._closeChild();"undefined"==typeof this.isShowingNow&&this.set("activated",!1);a&&this.set("selected",null)}})})},"dijit/_KeyNavContainer":function(){define("dojo/_base/array dojo/_base/declare dojo/dom-attr dojo/_base/kernel dojo/keys dojo/_base/lang ./registry ./_Container ./_FocusMixin ./_KeyNavMixin".split(" "),
function(r,l,d,q,k,m,p,h,e,c){return l("dijit._KeyNavContainer",[e,c,h],{connectKeyNavHandlers:function(b,a){var c=this._keyNavCodes={},d=m.hitch(this,"focusPrev"),e=m.hitch(this,"focusNext");r.forEach(b,function(a){c[a]=d});r.forEach(a,function(a){c[a]=e});c[k.HOME]=m.hitch(this,"focusFirstChild");c[k.END]=m.hitch(this,"focusLastChild")},startupKeyNavChildren:function(){q.deprecated("startupKeyNavChildren() call no longer needed","","2.0")},startup:function(){this.inherited(arguments);r.forEach(this.getChildren(),
m.hitch(this,"_startupChild"))},addChild:function(b,a){this.inherited(arguments);this._startupChild(b)},_startupChild:function(b){b.set("tabIndex","-1")},_getFirst:function(){var b=this.getChildren();return b.length?b[0]:null},_getLast:function(){var b=this.getChildren();return b.length?b[b.length-1]:null},focusNext:function(){this.focusChild(this._getNextFocusableChild(this.focusedChild,1))},focusPrev:function(){this.focusChild(this._getNextFocusableChild(this.focusedChild,-1),!0)},childSelector:function(b){return(b=
p.byNode(b))&&b.getParent()==this}})})},"dijit/_KeyNavMixin":function(){define("dojo/_base/array dojo/_base/declare dojo/dom-attr dojo/keys dojo/_base/lang dojo/on dijit/registry dijit/_FocusMixin".split(" "),function(r,l,d,q,k,m,p,h){return l("dijit._KeyNavMixin",h,{tabIndex:"0",childSelector:null,postCreate:function(){this.inherited(arguments);d.set(this.domNode,"tabIndex",this.tabIndex);if(!this._keyNavCodes){var e=this._keyNavCodes={};e[q.HOME]=k.hitch(this,"focusFirstChild");e[q.END]=k.hitch(this,
"focusLastChild");e[this.isLeftToRight()?q.LEFT_ARROW:q.RIGHT_ARROW]=k.hitch(this,"_onLeftArrow");e[this.isLeftToRight()?q.RIGHT_ARROW:q.LEFT_ARROW]=k.hitch(this,"_onRightArrow");e[q.UP_ARROW]=k.hitch(this,"_onUpArrow");e[q.DOWN_ARROW]=k.hitch(this,"_onDownArrow")}var c=this,e="string"==typeof this.childSelector?this.childSelector:k.hitch(this,"childSelector");this.own(m(this.domNode,"keypress",k.hitch(this,"_onContainerKeypress")),m(this.domNode,"keydown",k.hitch(this,"_onContainerKeydown")),m(this.domNode,
"focus",k.hitch(this,"_onContainerFocus")),m(this.containerNode,m.selector(e,"focusin"),function(b){c._onChildFocus(p.getEnclosingWidget(this),b)}))},_onLeftArrow:function(){},_onRightArrow:function(){},_onUpArrow:function(){},_onDownArrow:function(){},focus:function(){this.focusFirstChild()},_getFirstFocusableChild:function(){return this._getNextFocusableChild(null,1)},_getLastFocusableChild:function(){return this._getNextFocusableChild(null,-1)},focusFirstChild:function(){this.focusChild(this._getFirstFocusableChild())},
focusLastChild:function(){this.focusChild(this._getLastFocusableChild())},focusChild:function(d,c){d&&(this.focusedChild&&d!==this.focusedChild&&this._onChildBlur(this.focusedChild),d.set("tabIndex",this.tabIndex),d.focus(c?"end":"start"))},_onContainerFocus:function(d){d.target!==this.domNode||this.focusedChild||this.focus()},_onFocus:function(){d.set(this.domNode,"tabIndex","-1");this.inherited(arguments)},_onBlur:function(e){d.set(this.domNode,"tabIndex",this.tabIndex);this.focusedChild&&(this.focusedChild.set("tabIndex",
"-1"),this.lastFocusedChild=this.focusedChild,this._set("focusedChild",null));this.inherited(arguments)},_onChildFocus:function(d){d&&d!=this.focusedChild&&(this.focusedChild&&!this.focusedChild._destroyed&&this.focusedChild.set("tabIndex","-1"),d.set("tabIndex",this.tabIndex),this.lastFocused=d,this._set("focusedChild",d))},_searchString:"",multiCharSearchDuration:1E3,onKeyboardSearch:function(d,c,b,a){d&&this.focusChild(d)},_keyboardSearchCompare:function(d,c){var b=d.domNode,b=(d.label||(b.focusNode?
b.focusNode.label:"")||b.innerText||b.textContent||"").replace(/^\s+/,"").substr(0,c.length).toLowerCase();return c.length&&b==c?-1:0},_isFormElement:function(d){return"INPUT"===d.tagName||"TEXTAREA"===d.tagName||"SELECT"===d.tagName||"BUTTON"===d.tagName},_onContainerKeydown:function(d){if(!this._isFormElement(document.activeElement)){var c=this._keyNavCodes[d.keyCode];c?(c(d,this.focusedChild),d.stopPropagation(),d.preventDefault(),this._searchString=""):d.keyCode!=q.SPACE||!this._searchTimer||
d.ctrlKey||d.altKey||d.metaKey||(d.stopImmediatePropagation(),d.preventDefault(),this._keyboardSearch(d," "))}},_onContainerKeypress:function(d){this._isFormElement(document.activeElement)||d.charCode<=q.SPACE||d.ctrlKey||d.altKey||d.metaKey||(d.preventDefault(),d.stopPropagation(),this._keyboardSearch(d,String.fromCharCode(d.charCode).toLowerCase()))},_keyboardSearch:function(d,c){var b=null,a,e=0;k.hitch(this,function(){this._searchTimer&&this._searchTimer.remove();this._searchString+=c;var d=/^(.)\1*$/.test(this._searchString)?
1:this._searchString.length;a=this._searchString.substr(0,d);this._searchTimer=this.defer(function(){this._searchTimer=null;this._searchString=""},this.multiCharSearchDuration);var g=this.focusedChild||null;if(1==d||!g)if(g=this._getNextFocusableChild(g,1),!g)return;d=g;do{var h=this._keyboardSearchCompare(g,a);h&&0==e++&&(b=g);if(-1==h){e=-1;break}g=this._getNextFocusableChild(g,1)}while(g&&g!=d)})();this.onKeyboardSearch(b,d,a,e)},_onChildBlur:function(){},_getNextFocusableChild:function(d,c){var b=
d;do{if(d)d=this._getNext(d,c);else if(d=this[0<c?"_getFirst":"_getLast"](),!d)break;if(null!=d&&d!=b&&d.isFocusable())return d}while(d!=b);return null},_getFirst:function(){return null},_getLast:function(){return null},_getNext:function(d,c){if(d)for(d=d.domNode;d;)if((d=d[0>c?"previousSibling":"nextSibling"])&&"getAttribute"in d){var b=p.byNode(d);if(b)return b}return null}})})},"dijit/MenuItem":function(){define("dojo/_base/declare dojo/dom dojo/dom-attr dojo/dom-class dojo/_base/kernel dojo/sniff dojo/_base/lang ./_Widget ./_TemplatedMixin ./_Contained ./_CssStateMixin dojo/text!./templates/MenuItem.html".split(" "),
function(r,l,d,q,k,m,p,h,e,c,b,a){p=r("dijit.MenuItem"+(m("dojo-bidi")?"_NoBidi":""),[h,e,c,b],{templateString:a,baseClass:"dijitMenuItem",label:"",_setLabelAttr:function(a){this._set("label",a);var b="",c;c=a.search(/{\S}/);if(0<=c){var b=a.charAt(c+1),d=a.substr(0,c);a=a.substr(c+3);c=d+b+a;a=d+'\x3cspan class\x3d"dijitMenuItemShortcutKey"\x3e'+b+"\x3c/span\x3e"+a}else c=a;this.domNode.setAttribute("aria-label",c+" "+this.accelKey);this.containerNode.innerHTML=a;this._set("shortcutKey",b)},iconClass:"dijitNoIcon",
_setIconClassAttr:{node:"iconNode",type:"class"},accelKey:"",disabled:!1,_fillContent:function(a){!a||"label"in this.params||this._set("label",a.innerHTML)},buildRendering:function(){this.inherited(arguments);d.set(this.containerNode,"id",this.id+"_text");this.accelKeyNode&&d.set(this.accelKeyNode,"id",this.id+"_accel");l.setSelectable(this.domNode,!1)},onClick:function(){},focus:function(){try{8==m("ie")&&this.containerNode.focus(),this.focusNode.focus()}catch(g){}},_setSelected:function(a){q.toggle(this.domNode,
"dijitMenuItemSelected",a)},setLabel:function(a){k.deprecated("dijit.MenuItem.setLabel() is deprecated.  Use set('label', ...) instead.","","2.0");this.set("label",a)},setDisabled:function(a){k.deprecated("dijit.Menu.setDisabled() is deprecated.  Use set('disabled', bool) instead.","","2.0");this.set("disabled",a)},_setDisabledAttr:function(a){this.focusNode.setAttribute("aria-disabled",a?"true":"false");this._set("disabled",a)},_setAccelKeyAttr:function(a){this.accelKeyNode&&(this.accelKeyNode.style.display=
a?"":"none",this.accelKeyNode.innerHTML=a,d.set(this.containerNode,"colSpan",a?"1":"2"));this._set("accelKey",a)}});m("dojo-bidi")&&(p=r("dijit.MenuItem",p,{_setLabelAttr:function(a){this.inherited(arguments);"auto"===this.textDir&&this.applyTextDir(this.textDirNode)}}));return p})},"dijit/_Contained":function(){define(["dojo/_base/declare","./registry"],function(r,l){return r("dijit._Contained",null,{_getSibling:function(d){var l=this.getParent();return l&&l._getSiblingOfChild&&l._getSiblingOfChild(this,
"previous"==d?-1:1)||null},getPreviousSibling:function(){return this._getSibling("previous")},getNextSibling:function(){return this._getSibling("next")},getIndexInParent:function(){var d=this.getParent();return d&&d.getIndexOfChild?d.getIndexOfChild(this):-1}})})},"dijit/MenuSeparator":function(){define("dojo/_base/declare dojo/dom ./_WidgetBase ./_TemplatedMixin ./_Contained dojo/text!./templates/MenuSeparator.html".split(" "),function(r,l,d,q,k,m){return r("dijit.MenuSeparator",[d,q,k],{templateString:m,
buildRendering:function(){this.inherited(arguments);l.setSelectable(this.domNode,!1)},isFocusable:function(){return!1}})})},"dijit/form/SimpleTextarea":function(){define(["dojo/_base/declare","dojo/dom-class","dojo/sniff","./TextBox"],function(r,l,d,q){return r("dijit.form.SimpleTextarea",q,{baseClass:"dijitTextBox dijitTextArea",rows:"3",cols:"20",templateString:"\x3ctextarea ${!nameAttrSetting} data-dojo-attach-point\x3d'focusNode,containerNode,textbox' autocomplete\x3d'off'\x3e\x3c/textarea\x3e",
postMixInProperties:function(){!this.value&&this.srcNodeRef&&(this.value=this.srcNodeRef.value);this.inherited(arguments)},buildRendering:function(){this.inherited(arguments);d("ie")&&this.cols&&l.add(this.textbox,"dijitTextAreaCols")},filter:function(d){d&&(d=d.replace(/\r/g,""));return this.inherited(arguments)},_onInput:function(k){if(this.maxLength){var l=parseInt(this.maxLength),p=this.textbox.value.replace(/\r/g,""),l=p.length-l;if(0<l){var h=this.textbox;if(h.selectionStart){var e=h.selectionStart,
c=0;d("opera")&&(c=(this.textbox.value.substring(0,e).match(/\r/g)||[]).length);this.textbox.value=p.substring(0,e-l-c)+p.substring(e-c);h.setSelectionRange(e-l,e-l)}else this.ownerDocument.selection&&(h.focus(),p=this.ownerDocument.selection.createRange(),p.moveStart("character",-l),p.text="",p.select())}}this.inherited(arguments)}})})},"dijit/Editor":function(){define("require dojo/_base/array dojo/_base/declare dojo/Deferred dojo/i18n dojo/dom-attr dojo/dom-class dojo/dom-geometry dojo/dom-style dojo/keys dojo/_base/lang dojo/sniff dojo/string dojo/topic ./_Container ./Toolbar ./ToolbarSeparator ./layout/_LayoutWidget ./form/ToggleButton ./_editor/_Plugin ./_editor/plugins/EnterKeyHandling ./_editor/html ./_editor/range ./_editor/RichText ./main dojo/i18n!./_editor/nls/commands".split(" "),
function(r,l,d,q,k,m,p,h,e,c,b,a,g,u,n,t,f,v,x,w,z,A,y,B,C){function E(a){return new w({command:a.name})}function D(a){return new w({buttonClass:x,command:a.name})}d=d("dijit.Editor",B,{plugins:null,extraPlugins:null,constructor:function(){b.isArray(this.plugins)||(this.plugins=["undo","redo","|","cut","copy","paste","|","bold","italic","underline","strikethrough","|","insertOrderedList","insertUnorderedList","indent","outdent","|","justifyLeft","justifyRight","justifyCenter","justifyFull",z]);this._plugins=
[];this._editInterval=1E3*this.editActionInterval;if(a("ie")||a("trident")||a("edge"))this.events.push("onBeforeDeactivate"),this.events.push("onBeforeActivate")},postMixInProperties:function(){this.setValueDeferred=new q;this.inherited(arguments)},postCreate:function(){this.inherited(arguments);this._steps=this._steps.slice(0);this._undoedSteps=this._undoedSteps.slice(0);b.isArray(this.extraPlugins)&&(this.plugins=this.plugins.concat(this.extraPlugins));this.commands=k.getLocalization("dijit._editor",
"commands",this.lang);a("webkit")&&e.set(this.domNode,"KhtmlUserSelect","none")},startup:function(){this.inherited(arguments);this.toolbar||(this.toolbar=new t({ownerDocument:this.ownerDocument,dir:this.dir,lang:this.lang,"aria-label":this.id}),this.header.appendChild(this.toolbar.domNode));l.forEach(this.plugins,this.addPlugin,this);this.setValueDeferred.resolve(!0);p.add(this.iframe.parentNode,"dijitEditorIFrameContainer");p.add(this.iframe,"dijitEditorIFrame");m.set(this.iframe,"allowTransparency",
!0);this.toolbar.startup();this.onNormalizedDisplayChanged()},destroy:function(){l.forEach(this._plugins,function(a){a&&a.destroy&&a.destroy()});this._plugins=[];this.toolbar.destroyRecursive();delete this.toolbar;this.inherited(arguments)},addPlugin:function(a,c){var d=b.isString(a)?{name:a}:b.isFunction(a)?{ctor:a}:a;if(!d.setEditor){var e={args:d,plugin:null,editor:this};d.name&&(w.registry[d.name]?e.plugin=w.registry[d.name](d):u.publish(C._scopeName+".Editor.getPlugin",e));if(!e.plugin)try{var f=
d.ctor||b.getObject(d.name)||r(d.name);f&&(e.plugin=new f(d))}catch(L){throw Error(this.id+": cannot find plugin ["+d.name+"]");}if(!e.plugin)throw Error(this.id+": cannot find plugin ["+d.name+"]");a=e.plugin}1<arguments.length?this._plugins[c]=a:this._plugins.push(a);a.setEditor(this);b.isFunction(a.setToolbar)&&a.setToolbar(this.toolbar)},resize:function(a){a&&v.prototype.resize.apply(this,arguments)},layout:function(){var a=this._contentBox.h-(this.getHeaderHeight()+this.getFooterHeight()+h.getPadBorderExtents(this.iframe.parentNode).h+
h.getMarginExtents(this.iframe.parentNode).h);this.editingArea.style.height=a+"px";this.iframe&&(this.iframe.style.height="100%");this._layoutMode=!0},_onIEMouseDown:function(a){var b,c=this.document.body,d=c.clientWidth,e=c.clientHeight,f=c.clientLeft,g=c.offsetWidth,h=c.offsetHeight,k=c.offsetLeft;/^rtl$/i.test(c.dir||"")?d<g&&a.x>d&&a.x<g&&(b=!0):a.x<f&&a.x>k&&(b=!0);b||e<h&&a.y>e&&a.y<h&&(b=!0);b||(delete this._cursorToStart,delete this._savedSelection,"BODY"==a.target.tagName&&this.defer("placeCursorAtEnd"),
this.inherited(arguments))},onBeforeActivate:function(){this._restoreSelection()},onBeforeDeactivate:function(a){this.customUndo&&this.endEditing(!0);"BODY"!=a.target.tagName&&this._saveSelection()},customUndo:!0,editActionInterval:3,beginEditing:function(a){this._inEditing||(this._inEditing=!0,this._beginEditing(a));0<this.editActionInterval&&(this._editTimer&&this._editTimer.remove(),this._editTimer=this.defer("endEditing",this._editInterval))},_steps:[],_undoedSteps:[],execCommand:function(a){if(!this.customUndo||
"undo"!=a&&"redo"!=a){this.customUndo&&(this.endEditing(),this._beginEditing());var b=this.inherited(arguments);this.customUndo&&this._endEditing();return b}return this[a]()},_pasteImpl:function(){return this._clipboardCommand("paste")},_cutImpl:function(){return this._clipboardCommand("cut")},_copyImpl:function(){return this._clipboardCommand("copy")},_clipboardCommand:function(b){var c;try{if(c=this.document.execCommand(b,!1,null),a("webkit")&&!c)throw{};}catch(J){c=g.substitute,alert(c(this.commands.systemShortcut,
[this.commands[b],c(this.commands[a("mac")?"appleKey":"ctrlKey"],[{cut:"X",copy:"C",paste:"V"}[b]])])),c=!1}return c},queryCommandEnabled:function(a){return!this.customUndo||"undo"!=a&&"redo"!=a?this.inherited(arguments):"undo"==a?1<this._steps.length:0<this._undoedSteps.length},_moveToBookmark:function(c){var d=c.mark,e=c.mark;c=c.isCollapsed;var f,g,h;e&&(9>a("ie")||9===a("ie")&&a("quirks")?b.isArray(e)?(d=[],l.forEach(e,function(a){d.push(y.getNode(a,this.editNode))},this),this.selection.moveToBookmark({mark:d,
isCollapsed:c})):e.startContainer&&e.endContainer&&(h=y.getSelection(this.window))&&h.removeAllRanges&&(h.removeAllRanges(),c=y.create(this.window),f=y.getNode(e.startContainer,this.editNode),g=y.getNode(e.endContainer,this.editNode),f&&g&&(c.setStart(f,e.startOffset),c.setEnd(g,e.endOffset),h.addRange(c))):(h=y.getSelection(this.window))&&h.removeAllRanges&&(h.removeAllRanges(),c=y.create(this.window),f=y.getNode(e.startContainer,this.editNode),g=y.getNode(e.endContainer,this.editNode),f&&g&&(c.setStart(f,
e.startOffset),c.setEnd(g,e.endOffset),h.addRange(c))))},_changeToStep:function(a,b){this.setValue(b.text);var c=b.bookmark;c&&this._moveToBookmark(c)},undo:function(){var a=!1;if(!this._undoRedoActive){this._undoRedoActive=!0;this.endEditing(!0);var b=this._steps.pop();b&&0<this._steps.length&&(this.focus(),this._changeToStep(b,this._steps[this._steps.length-1]),this._undoedSteps.push(b),this.onDisplayChanged(),delete this._undoRedoActive,a=!0);delete this._undoRedoActive}return a},redo:function(){var a=
!1;if(!this._undoRedoActive){this._undoRedoActive=!0;this.endEditing(!0);var b=this._undoedSteps.pop();b&&0<this._steps.length&&(this.focus(),this._changeToStep(this._steps[this._steps.length-1],b),this._steps.push(b),this.onDisplayChanged(),a=!0);delete this._undoRedoActive}return a},endEditing:function(a){this._editTimer&&(this._editTimer=this._editTimer.remove());this._inEditing&&(this._endEditing(a),this._inEditing=!1)},_getBookmark:function(){var c=this.selection.getBookmark(),d=[];if(c&&c.mark){var e=
c.mark;if(9>a("ie")||9===a("ie")&&a("quirks")){var f=y.getSelection(this.window);if(b.isArray(e))l.forEach(c.mark,function(a){d.push(y.getIndex(a,this.editNode).o)},this),c.mark=d;else if(f){var g;f.rangeCount&&(g=f.getRangeAt(0));c.mark=g?g.cloneRange():this.selection.getBookmark()}}try{c.mark&&c.mark.startContainer&&(d=y.getIndex(c.mark.startContainer,this.editNode).o,c.mark={startContainer:d,startOffset:c.mark.startOffset,endContainer:c.mark.endContainer===c.mark.startContainer?d:y.getIndex(c.mark.endContainer,
this.editNode).o,endOffset:c.mark.endOffset})}catch(L){c.mark=null}}return c},_beginEditing:function(){0===this._steps.length&&this._steps.push({text:A.getChildrenHtml(this.editNode),bookmark:this._getBookmark()})},_endEditing:function(){var a=A.getChildrenHtml(this.editNode);this._undoedSteps=[];this._steps.push({text:a,bookmark:this._getBookmark()})},onKeyDown:function(b){a("ie")||this.iframe||b.keyCode!=c.TAB||this.tabIndent||this._saveSelection();if(this.customUndo){var d=b.keyCode;if(b.ctrlKey&&
!b.shiftKey&&!b.altKey){if(90==d||122==d){b.stopPropagation();b.preventDefault();this.undo();return}if(89==d||121==d){b.stopPropagation();b.preventDefault();this.redo();return}}this.inherited(arguments);switch(d){case c.ENTER:case c.BACKSPACE:case c.DELETE:this.beginEditing();break;case 88:case 86:if(b.ctrlKey&&!b.altKey&&!b.metaKey){this.endEditing();88==b.keyCode?this.beginEditing("cut"):this.beginEditing("paste");this.defer("endEditing",1);break}default:if(!b.ctrlKey&&!b.altKey&&!b.metaKey&&(b.keyCode<
c.F1||b.keyCode>c.F15)){this.beginEditing();break}case c.ALT:this.endEditing();break;case c.UP_ARROW:case c.DOWN_ARROW:case c.LEFT_ARROW:case c.RIGHT_ARROW:case c.HOME:case c.END:case c.PAGE_UP:case c.PAGE_DOWN:this.endEditing(!0);case c.CTRL:case c.SHIFT:case c.TAB:}}else this.inherited(arguments)},_onBlur:function(){this.inherited(arguments);this.endEditing(!0)},_saveSelection:function(){try{this._savedSelection=this._getBookmark()}catch(F){}},_restoreSelection:function(){this._savedSelection&&
(delete this._cursorToStart,this.selection.isCollapsed()&&this._moveToBookmark(this._savedSelection),delete this._savedSelection)},onClick:function(){this.endEditing(!0);this.inherited(arguments)},replaceValue:function(a){this.customUndo?this.isClosed?this.setValue(a):(this.beginEditing(),a||(a="\x26#160;"),this.setValue(a),this.endEditing()):this.inherited(arguments)},_setDisabledAttr:function(a){this.setValueDeferred.then(b.hitch(this,function(){!this.disabled&&a||!this._buttonEnabledPlugins&&a?
l.forEach(this._plugins,function(a){a.set("disabled",!0)}):this.disabled&&!a&&l.forEach(this._plugins,function(a){a.set("disabled",!1)})}));this.inherited(arguments)},_setStateClass:function(){try{this.inherited(arguments),this.document&&this.document.body&&e.set(this.document.body,"color",e.get(this.iframe,"color"))}catch(F){}}});b.mixin(w.registry,{undo:E,redo:E,cut:E,copy:E,paste:E,insertOrderedList:E,insertUnorderedList:E,indent:E,outdent:E,justifyCenter:E,justifyFull:E,justifyLeft:E,justifyRight:E,
"delete":E,selectAll:E,removeFormat:E,unlink:E,insertHorizontalRule:E,bold:D,italic:D,underline:D,strikethrough:D,subscript:D,superscript:D,"|":function(){return new w({setEditor:function(a){this.editor=a;this.button=new f({ownerDocument:a.ownerDocument})}})}});return d})},"dijit/Toolbar":function(){define("require dojo/_base/declare dojo/has dojo/keys dojo/ready ./_Widget ./_KeyNavContainer ./_TemplatedMixin".split(" "),function(r,l,d,q,k,m,p,h){d("dijit-legacy-requires")&&k(0,function(){r(["dijit/ToolbarSeparator"])});
return l("dijit.Toolbar",[m,h,p],{templateString:'\x3cdiv class\x3d"dijit" role\x3d"toolbar" tabIndex\x3d"${tabIndex}" data-dojo-attach-point\x3d"containerNode"\x3e\x3c/div\x3e',baseClass:"dijitToolbar",_onLeftArrow:function(){this.focusPrev()},_onRightArrow:function(){this.focusNext()}})})},"dijit/ToolbarSeparator":function(){define(["dojo/_base/declare","dojo/dom","./_Widget","./_TemplatedMixin"],function(r,l,d,q){return r("dijit.ToolbarSeparator",[d,q],{templateString:'\x3cdiv class\x3d"dijitToolbarSeparator dijitInline" role\x3d"presentation"\x3e\x3c/div\x3e',
buildRendering:function(){this.inherited(arguments);l.setSelectable(this.domNode,!1)},isFocusable:function(){return!1}})})},"dijit/layout/_LayoutWidget":function(){define("dojo/_base/lang ../_Widget ../_Container ../_Contained ../Viewport dojo/_base/declare dojo/dom-class dojo/dom-geometry dojo/dom-style".split(" "),function(r,l,d,q,k,m,p,h,e){return m("dijit.layout._LayoutWidget",[l,d,q],{baseClass:"dijitLayoutContainer",isLayoutContainer:!0,_setTitleAttr:null,buildRendering:function(){this.inherited(arguments);
p.add(this.domNode,"dijitContainer")},startup:function(){if(!this._started){this.inherited(arguments);var c=this.getParent&&this.getParent();c&&c.isLayoutContainer||(this.resize(),this.own(k.on("resize",r.hitch(this,"resize"))))}},resize:function(c,b){var a=this.domNode;c&&h.setMarginBox(a,c);var d=b||{};r.mixin(d,c||{});"h"in d&&"w"in d||(d=r.mixin(h.getMarginBox(a),d));var k=e.getComputedStyle(a),n=h.getMarginExtents(a,k),l=h.getBorderExtents(a,k),d=this._borderBox={w:d.w-(n.w+l.w),h:d.h-(n.h+l.h)},
n=h.getPadExtents(a,k);this._contentBox={l:e.toPixelValue(a,k.paddingLeft),t:e.toPixelValue(a,k.paddingTop),w:d.w-n.w,h:d.h-n.h};this.layout()},layout:function(){},_setupChild:function(c){p.add(c.domNode,this.baseClass+"-child "+(c.baseClass?this.baseClass+"-"+c.baseClass:""))},addChild:function(c,b){this.inherited(arguments);this._started&&this._setupChild(c)},removeChild:function(c){p.remove(c.domNode,this.baseClass+"-child"+(c.baseClass?" "+this.baseClass+"-"+c.baseClass:""));this.inherited(arguments)}})})},
"dijit/_editor/_Plugin":function(){define(["dojo/_base/connect","dojo/_base/declare","dojo/_base/lang","../Destroyable","../form/Button"],function(r,l,d,q,k){l=l("dijit._editor._Plugin",q,{constructor:function(k){this.params=k||{};d.mixin(this,this.params);this._attrPairNames={}},editor:null,iconClassPrefix:"dijitEditorIcon",button:null,command:"",useDefaultCommand:!0,buttonClass:k,disabled:!1,getLabel:function(d){return this.editor.commands[d]},_initButton:function(){if(this.command.length){var k=
this.getLabel(this.command),l=this.editor,h=this.iconClassPrefix+" "+this.iconClassPrefix+this.command.charAt(0).toUpperCase()+this.command.substr(1);this.button||(k=d.mixin({label:k,ownerDocument:l.ownerDocument,dir:l.dir,lang:l.lang,showLabel:!1,iconClass:h,dropDown:this.dropDown,tabIndex:"-1"},this.params||{}),delete k.name,this.button=new this.buttonClass(k))}this.get("disabled")&&this.button&&this.button.set("disabled",this.get("disabled"))},destroy:function(){this.dropDown&&this.dropDown.destroyRecursive();
this.inherited(arguments)},connect:function(d,k,h){this.own(r.connect(d,k,this,h))},updateState:function(){var d=this.editor,k=this.command,h,e;if(d&&d.isLoaded&&k.length){var c=this.get("disabled");if(this.button)try{e=!c&&d.queryCommandEnabled(k),this.enabled!==e&&(this.enabled=e,this.button.set("disabled",!e)),e&&"boolean"==typeof this.button.checked&&(h=d.queryCommandState(k),this.checked!==h&&(this.checked=h,this.button.set("checked",d.queryCommandState(k))))}catch(b){console.log(b)}}},setEditor:function(k){this.editor=
k;this._initButton();this.button&&this.useDefaultCommand&&(this.editor.queryCommandAvailable(this.command)?this.own(this.button.on("click",d.hitch(this.editor,"execCommand",this.command,this.commandArg))):this.button.domNode.style.display="none");this.own(this.editor.on("NormalizedDisplayChanged",d.hitch(this,"updateState")))},setToolbar:function(d){this.button&&d.addChild(this.button)},set:function(d,k){if("object"===typeof d){for(var h in d)this.set(h,d[h]);return this}h=this._getAttrNames(d);if(this[h.s])var e=
this[h.s].apply(this,Array.prototype.slice.call(arguments,1));else this._set(d,k);return e||this},get:function(d){var k=this._getAttrNames(d);return this[k.g]?this[k.g]():this[d]},_setDisabledAttr:function(d){this._set("disabled",d);this.updateState()},_getAttrNames:function(d){var k=this._attrPairNames;if(k[d])return k[d];var h=d.charAt(0).toUpperCase()+d.substr(1);return k[d]={s:"_set"+h+"Attr",g:"_get"+h+"Attr"}},_set:function(d,k){this[d]=k}});l.registry={};return l})},"dijit/_editor/plugins/EnterKeyHandling":function(){define("dojo/_base/declare dojo/dom-construct dojo/keys dojo/_base/lang dojo/on dojo/sniff dojo/_base/window dojo/window ../_Plugin ../RichText ../range".split(" "),
function(r,l,d,q,k,m,p,h,e,c,b){return r("dijit._editor.plugins.EnterKeyHandling",e,{blockNodeForEnter:"BR",constructor:function(a){a&&("blockNodeForEnter"in a&&(a.blockNodeForEnter=a.blockNodeForEnter.toUpperCase()),q.mixin(this,a))},setEditor:function(a){if(this.editor!==a)if(this.editor=a,"BR"==this.blockNodeForEnter)this.editor.customUndo=!0,a.onLoadDeferred.then(q.hitch(this,function(b){this.own(k(a.document,"keydown",q.hitch(this,function(a){if(a.keyCode==d.ENTER){var b=q.mixin({},a);b.shiftKey=
!0;this.handleEnterKey(b)||(a.stopPropagation(),a.preventDefault())}})));9<=m("ie")&&10>=m("ie")&&this.own(k(a.document,"paste",q.hitch(this,function(a){setTimeout(q.hitch(this,function(){var a=this.editor.document.selection.createRange();a.move("character",-1);a.select();a.move("character",1);a.select()}),0)})));return b}));else if(this.blockNodeForEnter){var b=q.hitch(this,"handleEnterKey");a.addKeyHandler(13,0,0,b);a.addKeyHandler(13,0,1,b);this.own(this.editor.on("KeyPressed",q.hitch(this,"onKeyPressed")))}},
onKeyPressed:function(){if(this._checkListLater){if(this.editor.selection.isCollapsed()){var a=this.editor.selection.getAncestorElement("LI");if(a){m("mozilla")&&"LI"==a.parentNode.parentNode.nodeName&&(a=a.parentNode.parentNode);var d=a.firstChild;!d||1!=d.nodeType||"UL"!=d.nodeName&&"OL"!=d.nodeName||(a.insertBefore(d.ownerDocument.createTextNode("\u00a0"),d),d=b.create(this.editor.window),d.setStart(a.firstChild,0),a=b.getSelection(this.editor.window,!0),a.removeAllRanges(),a.addRange(d))}else c.prototype.execCommand.call(this.editor,
"formatblock",this.blockNodeForEnter),(a=this.editor.selection.getAncestorElement(this.blockNodeForEnter))?(a.innerHTML=this.bogusHtmlContent,9>=m("ie")&&(a=this.editor.document.selection.createRange(),a.move("character",-1),a.select())):console.error("onKeyPressed: Cannot find the new block node")}this._checkListLater=!1}this._pressedEnterInBlock&&(this._pressedEnterInBlock.previousSibling&&this.removeTrailingBr(this._pressedEnterInBlock.previousSibling),delete this._pressedEnterInBlock)},bogusHtmlContent:"\x26#160;",
blockNodes:/^(?:P|H1|H2|H3|H4|H5|H6|LI)$/,handleEnterKey:function(a){var d,e,k,p,f=this.editor.document,q,r,w;if(a.shiftKey){a=this.editor.selection.getParentElement();if(p=b.getAncestor(a,this.blockNodes)){if("LI"==p.tagName)return!0;a=b.getSelection(this.editor.window);d=a.getRangeAt(0);d.collapsed||(d.deleteContents(),a=b.getSelection(this.editor.window),d=a.getRangeAt(0));if(b.atBeginningOfContainer(p,d.startContainer,d.startOffset))q=f.createElement("br"),d=b.create(this.editor.window),p.insertBefore(q,
p.firstChild),d.setStartAfter(q),a.removeAllRanges(),a.addRange(d);else if(b.atEndOfContainer(p,d.startContainer,d.startOffset))d=b.create(this.editor.window),q=f.createElement("br"),p.appendChild(q),p.appendChild(f.createTextNode("\u00a0")),d.setStart(p.lastChild,0),a.removeAllRanges(),a.addRange(d);else return(r=d.startContainer)&&3==r.nodeType?(w=r.nodeValue,e=f.createTextNode(w.substring(0,d.startOffset)),k=f.createTextNode(w.substring(d.startOffset)),p=f.createElement("br"),""==k.nodeValue&&
m("webkit")&&(k=f.createTextNode("\u00a0")),l.place(e,r,"after"),l.place(p,e,"after"),l.place(k,p,"after"),l.destroy(r),d=b.create(this.editor.window),d.setStart(k,0),a.removeAllRanges(),a.addRange(d),!1):!0}else a=b.getSelection(this.editor.window),a.rangeCount?(d=a.getRangeAt(0))&&d.startContainer&&(d.collapsed||(d.deleteContents(),a=b.getSelection(this.editor.window),d=a.getRangeAt(0)),(r=d.startContainer)&&3==r.nodeType?(p=d.startOffset,r.length<p&&(k=this._adjustNodeAndOffset(r,p),r=k.node,p=
k.offset),w=r.nodeValue,e=f.createTextNode(w.substring(0,p)),k=f.createTextNode(w.substring(p)),p=f.createElement("br"),k.length||(k=f.createTextNode("\u00a0")),e.length?l.place(e,r,"after"):e=r,l.place(p,e,"after"),l.place(k,p,"after"),l.destroy(r)):(0<=d.startOffset&&(q=r.childNodes[d.startOffset]),p=f.createElement("br"),k=f.createTextNode("\u00a0"),q?(l.place(p,q,"before"),l.place(k,p,"after")):(r.appendChild(p),r.appendChild(k))),d=b.create(this.editor.window),d.setStart(k,0),d.setEnd(k,k.length),
a.removeAllRanges(),a.addRange(d),this.editor.selection.collapse(!0)):c.prototype.execCommand.call(this.editor,"inserthtml","\x3cbr\x3e");return!1}var z=!0;a=b.getSelection(this.editor.window);d=a.getRangeAt(0);d.collapsed||(d.deleteContents(),a=b.getSelection(this.editor.window),d=a.getRangeAt(0));q=b.getBlockAncestor(d.endContainer,null,this.editor.editNode);var A=q.blockNode;if(this._checkListLater=A&&("LI"==A.nodeName||"LI"==A.parentNode.nodeName))return m("mozilla")&&(this._pressedEnterInBlock=
A),/^(\s|&nbsp;|&#160;|\xA0|<span\b[^>]*\bclass=['"]Apple-style-span['"][^>]*>(\s|&nbsp;|&#160;|\xA0)<\/span>)?(<br>)?$/.test(A.innerHTML)&&(A.innerHTML="",m("webkit")&&(d=b.create(this.editor.window),d.setStart(A,0),a.removeAllRanges(),a.addRange(d)),this._checkListLater=!1),!0;if(!q.blockNode||q.blockNode===this.editor.editNode){try{c.prototype.execCommand.call(this.editor,"formatblock",this.blockNodeForEnter)}catch(y){}q={blockNode:this.editor.selection.getAncestorElement(this.blockNodeForEnter),
blockContainer:this.editor.editNode};if(q.blockNode){if(q.blockNode!=this.editor.editNode&&!(q.blockNode.textContent||q.blockNode.innerHTML).replace(/^\s+|\s+$/g,"").length)return this.removeTrailingBr(q.blockNode),!1}else q.blockNode=this.editor.editNode;a=b.getSelection(this.editor.window);d=a.getRangeAt(0)}A=f.createElement(this.blockNodeForEnter);A.innerHTML=this.bogusHtmlContent;this.removeTrailingBr(q.blockNode);k=d.endOffset;z=d.endContainer;z.length<k&&(k=this._adjustNodeAndOffset(z,k),z=
k.node,k=k.offset);if(b.atEndOfContainer(q.blockNode,z,k))q.blockNode===q.blockContainer?q.blockNode.appendChild(A):l.place(A,q.blockNode,"after"),z=!1,d=b.create(this.editor.window),d.setStart(A,0),a.removeAllRanges(),a.addRange(d),this.editor.height&&h.scrollIntoView(A);else if(b.atBeginningOfContainer(q.blockNode,d.startContainer,d.startOffset))l.place(A,q.blockNode,q.blockNode===q.blockContainer?"first":"before"),A.nextSibling&&this.editor.height&&(d=b.create(this.editor.window),d.setStart(A.nextSibling,
0),a.removeAllRanges(),a.addRange(d),h.scrollIntoView(A.nextSibling)),z=!1;else{q.blockNode===q.blockContainer?q.blockNode.appendChild(A):l.place(A,q.blockNode,"after");z=!1;q.blockNode.style&&A.style&&q.blockNode.style.cssText&&(A.style.cssText=q.blockNode.style.cssText);if((r=d.startContainer)&&3==r.nodeType){k=d.endOffset;r.length<k&&(k=this._adjustNodeAndOffset(r,k),r=k.node,k=k.offset);w=r.nodeValue;e=f.createTextNode(w.substring(0,k));k=f.createTextNode(w.substring(k,w.length));l.place(e,r,
"before");l.place(k,r,"after");l.destroy(r);for(d=e.parentNode;d!==q.blockNode;){w=f.createElement(d.tagName);d.style&&w.style&&d.style.cssText&&(w.style.cssText=d.style.cssText);"FONT"===d.tagName&&(d.color&&(w.color=d.color),d.face&&(w.face=d.face),d.size&&(w.size=d.size));for(;k;)r=k.nextSibling,w.appendChild(k),k=r;l.place(w,d,"after");e=d;k=w;d=d.parentNode}if(1==k.nodeType||3==k.nodeType&&k.nodeValue)A.innerHTML="";for(e=k;k;)r=k.nextSibling,A.appendChild(k),k=r}d=b.create(this.editor.window);
f=e;if("BR"!==this.blockNodeForEnter){for(;f;)p=f,f=r=f.firstChild;p&&p.parentNode?(A=p.parentNode,d.setStart(A,0),a.removeAllRanges(),a.addRange(d),this.editor.height&&h.scrollIntoView(A),m("mozilla")&&(this._pressedEnterInBlock=q.blockNode)):z=!0}else d.setStart(A,0),a.removeAllRanges(),a.addRange(d),this.editor.height&&h.scrollIntoView(A),m("mozilla")&&(this._pressedEnterInBlock=q.blockNode)}return z},_adjustNodeAndOffset:function(a,b){for(;a.length<b&&a.nextSibling&&3==a.nextSibling.nodeType;)b-=
a.length,a=a.nextSibling;return{node:a,offset:b}},removeTrailingBr:function(a){if(a=/P|DIV|LI/i.test(a.tagName)?a:this.editor.selection.getParentOfType(a,["P","DIV","LI"]))a.lastChild&&(1<a.childNodes.length&&3==a.lastChild.nodeType&&/^[\s\xAD]*$/.test(a.lastChild.nodeValue)||"BR"==a.lastChild.tagName)&&l.destroy(a.lastChild),a.childNodes.length||(a.innerHTML=this.bogusHtmlContent)}})})},"dijit/_editor/RichText":function(){define("dojo/_base/array dojo/_base/config dojo/_base/declare dojo/_base/Deferred dojo/dom dojo/dom-attr dojo/dom-class dojo/dom-construct dojo/dom-geometry dojo/dom-style dojo/_base/kernel dojo/keys dojo/_base/lang dojo/on dojo/query dojo/domReady dojo/sniff dojo/string dojo/topic dojo/_base/unload dojo/_base/url dojo/window ../_Widget ../_CssStateMixin ../selection ./range ./html ../focus ../main".split(" "),
function(r,l,d,q,k,m,p,h,e,c,b,a,g,u,n,t,f,v,x,w,z,A,y,B,C,E,D,F,G){var J=d("dijit._editor.RichText",[y,B],{constructor:function(a){this.contentPreFilters=[];this.contentPostFilters=[];this.contentDomPreFilters=[];this.contentDomPostFilters=[];this.editingAreaStyleSheets=[];this.events=[].concat(this.events);this._keyHandlers={};a&&g.isString(a.value)&&(this.value=a.value);this.onLoadDeferred=new q},baseClass:"dijitEditor",inheritWidth:!1,focusOnLoad:!1,name:"",styleSheets:"",height:"300px",minHeight:"1em",
isClosed:!0,isLoaded:!1,_SEPARATOR:"@@**%%__RICHTEXTBOUNDRY__%%**@@",_NAME_CONTENT_SEP:"@@**%%:%%**@@",onLoadDeferred:null,isTabIndent:!1,disableSpellCheck:!1,postCreate:function(){"textarea"===this.domNode.tagName.toLowerCase()&&console.warn("RichText should not be used with the TEXTAREA tag.  See dijit._editor.RichText docs.");this.contentPreFilters=[g.trim,g.hitch(this,"_preFixUrlAttributes")].concat(this.contentPreFilters);f("mozilla")&&(this.contentPreFilters=[this._normalizeFontStyle].concat(this.contentPreFilters),
this.contentPostFilters=[this._removeMozBogus].concat(this.contentPostFilters));f("webkit")&&(this.contentPreFilters=[this._removeWebkitBogus].concat(this.contentPreFilters),this.contentPostFilters=[this._removeWebkitBogus].concat(this.contentPostFilters));if(f("ie")||f("trident"))this.contentPostFilters=[this._normalizeFontStyle].concat(this.contentPostFilters),this.contentDomPostFilters=[g.hitch(this,"_stripBreakerNodes")].concat(this.contentDomPostFilters);this.contentDomPostFilters=[g.hitch(this,
"_stripTrailingEmptyNodes")].concat(this.contentDomPostFilters);this.inherited(arguments);x.publish(G._scopeName+"._editor.RichText::init",this)},startup:function(){this.inherited(arguments);this.open();this.setupDefaultShortcuts()},setupDefaultShortcuts:function(){var a=g.hitch(this,function(a,b){return function(){return!this.execCommand(a,b)}}),b={b:a("bold"),i:a("italic"),u:a("underline"),a:a("selectall"),s:function(){this.save(!0)},m:function(){this.isTabIndent=!this.isTabIndent},1:a("formatblock",
"h1"),2:a("formatblock","h2"),3:a("formatblock","h3"),4:a("formatblock","h4"),"\\":a("insertunorderedlist")};f("ie")||(b.Z=a("redo"));for(var c in b)this.addKeyHandler(c,!0,!1,b[c])},events:["onKeyDown","onKeyUp"],captureEvents:[],_editorCommandsLocalized:!1,_localizeEditorCommands:function(){if(J._editorCommandsLocalized)this._local2NativeFormatNames=J._local2NativeFormatNames,this._native2LocalFormatNames=J._native2LocalFormatNames;else{J._editorCommandsLocalized=!0;J._local2NativeFormatNames={};
J._native2LocalFormatNames={};this._local2NativeFormatNames=J._local2NativeFormatNames;this._native2LocalFormatNames=J._native2LocalFormatNames;for(var a="div p pre h1 h2 h3 h4 h5 h6 ol ul address".split(" "),b="",c,d=0;c=a[d++];)b="l"!==c.charAt(1)?b+("\x3c"+c+"\x3e\x3cspan\x3econtent\x3c/span\x3e\x3c/"+c+"\x3e\x3cbr/\x3e"):b+("\x3c"+c+"\x3e\x3cli\x3econtent\x3c/li\x3e\x3c/"+c+"\x3e\x3cbr/\x3e");var e=h.create("div",{style:{position:"absolute",top:"0px",zIndex:10,opacity:.01},innerHTML:b});this.ownerDocumentBody.appendChild(e);
a=g.hitch(this,function(){for(var a=e.firstChild;a;)try{this.selection.selectElement(a.firstChild);var b=a.tagName.toLowerCase();this._local2NativeFormatNames[b]=document.queryCommandValue("formatblock");this._native2LocalFormatNames[this._local2NativeFormatNames[b]]=b;a=a.nextSibling.nextSibling}catch(O){}h.destroy(e)});this.defer(a)}},open:function(a){if(!this.onLoadDeferred||0<=this.onLoadDeferred.fired)this.onLoadDeferred=new q;this.isClosed||this.close();x.publish(G._scopeName+"._editor.RichText::open",
this);1===arguments.length&&a.nodeName&&(this.domNode=a);var b=this.domNode,d;if(g.isString(this.value))d=this.value,b.innerHTML="";else if(b.nodeName&&"textarea"==b.nodeName.toLowerCase()){var e=this.textarea=b;this.name=e.name;d=e.value;b=this.domNode=this.ownerDocument.createElement("div");b.setAttribute("widgetId",this.id);e.removeAttribute("widgetId");b.cssText=e.cssText;b.className+=" "+e.className;h.place(b,e,"before");var n=g.hitch(this,function(){c.set(e,{display:"block",position:"absolute",
top:"-1000px"});if(f("ie")){var a=e.style;this.__overflow=a.overflow;a.overflow="hidden"}});f("ie")?this.defer(n,10):n();if(e.form){var t=e.value;this.reset=function(){this.getValue()!==t&&this.replaceValue(t)};u(e.form,"submit",g.hitch(this,function(){m.set(e,"disabled",this.disabled);e.value=this.getValue()}))}}else d=D.getChildrenHtml(b),b.innerHTML="";this.value=d;b.nodeName&&"LI"===b.nodeName&&(b.innerHTML=" \x3cbr\x3e");this.header=b.ownerDocument.createElement("div");b.appendChild(this.header);
this.editingArea=b.ownerDocument.createElement("div");b.appendChild(this.editingArea);this.footer=b.ownerDocument.createElement("div");b.appendChild(this.footer);this.name||(this.name=this.id+"_AUTOGEN");if(""!==this.name&&(!l.useXDomain||l.allowXdRichTextSave)){if((d=k.byId(G._scopeName+"._editor.RichText.value"))&&""!==d.value)for(var n=d.value.split(this._SEPARATOR),r=0,v;v=n[r++];)if(v=v.split(this._NAME_CONTENT_SEP),v[0]===this.name){this.value=v[1];n=n.splice(r,1);d.value=n.join(this._SEPARATOR);
break}J._globalSaveHandler||(J._globalSaveHandler={},w.addOnUnload(function(){for(var a in J._globalSaveHandler){var b=J._globalSaveHandler[a];g.isFunction(b)&&b()}}));J._globalSaveHandler[this.id]=g.hitch(this,"_saveContent")}this.isClosed=!1;d=this.editorObject=this.iframe=this.ownerDocument.createElement("iframe");d.id=this.id+"_iframe";d.style.border="none";d.style.width="100%";this._layoutMode?d.style.height="100%":7<=f("ie")?(this.height&&(d.style.height=this.height),this.minHeight&&(d.style.minHeight=
this.minHeight)):d.style.height=this.height?this.height:this.minHeight;d.frameBorder=0;d._loadFunc=g.hitch(this,function(a){this.window=a;this.document=a.document;this.selection=new C.SelectionManager(a);f("ie")&&this._localizeEditorCommands();this.onLoad(this.get("value"))});n=this._getIframeDocTxt().replace(/\\/g,"\\\\").replace(/'/g,"\\'");n=11>f("ie")?'javascript:document.open();try{parent.window;}catch(e){document.domain\x3d"'+document.domain+"\";}document.write('"+n+"');document.close()":"javascript: '"+
n+"'";this.editingArea.appendChild(d);d.src=n;"LI"===b.nodeName&&(b.lastChild.style.marginTop="-1.2em");p.add(this.domNode,this.baseClass)},_local2NativeFormatNames:{},_native2LocalFormatNames:{},_getIframeDocTxt:function(){var a=c.getComputedStyle(this.domNode),d;if(this["aria-label"])d=this["aria-label"];else{var e=n('label[for\x3d"'+this.id+'"]',this.ownerDocument)[0]||k.byId(this["aria-labelledby"],this.ownerDocument);e&&(d=e.textContent||e.innerHTML||"")}var e="\x3cdiv id\x3d'dijitEditorBody' role\x3d'textbox' aria-multiline\x3d'true' "+
(d?" aria-label\x3d'"+v.escape(d)+"'":"")+"\x3e\x3c/div\x3e",h=[a.fontWeight,a.fontSize,a.fontFamily].join(" "),l=a.lineHeight,l=0<=l.indexOf("px")?parseFloat(l)/parseFloat(a.fontSize):0<=l.indexOf("em")?parseFloat(l):"normal",m="",p=this;this.style.replace(/(^|;)\s*(line-|font-?)[^;]+/ig,function(a){a=a.replace(/^;/ig,"")+";";var b=a.split(":")[0];if(b){var b=g.trim(b),b=b.toLowerCase(),d,e="";for(d=0;d<b.length;d++){var f=b.charAt(d);switch(f){case "-":d++,f=b.charAt(d).toUpperCase();default:e+=
f}}c.set(p.domNode,e,"")}m+=a+";"});this.iframe.setAttribute("title",d);return["\x3c!DOCTYPE html\x3e","\x3chtml lang\x3d'"+(this.lang||b.locale.replace(/-.*/,""))+"'"+(this.isLeftToRight()?"":" dir\x3d'rtl'")+"\x3e\n","\x3chead\x3e\n\x3cmeta http-equiv\x3d'Content-Type' content\x3d'text/html'\x3e\n",d?"\x3ctitle\x3e"+v.escape(d)+"\x3c/title\x3e":"","\x3cstyle\x3e\n\tbody,html {\n\t\tbackground:transparent;\n\t\tpadding: 1px 0 0 0;\n\t\tmargin: -1px 0 0 0;\n\t}\n\tbody,html,#dijitEditorBody { outline: none; }html { height: 100%; width: 100%; overflow: hidden; }\n",
this.height?"\tbody,#dijitEditorBody { height: 100%; width: 100%; overflow: auto; }\n":"\tbody,#dijitEditorBody { min-height: "+this.minHeight+"; width: 100%; overflow-x: auto; overflow-y: hidden; }\n","\tbody{\n\t\ttop:0px;\n\t\tleft:0px;\n\t\tright:0px;\n\t\tfont:",h,";\n",this.height||f("opera")?"":"\t\tposition: fixed;\n","\t\tline-height:",l,";\n\t}\n\tp{ margin: 1em 0; }\n\tli \x3e ul:-moz-first-node, li \x3e ol:-moz-first-node{ padding-top: 1.2em; }\n",f("ie")||f("trident")||f("edge")?"":"\tli{ min-height:1.2em; }\n",
"\x3c/style\x3e\n",this._applyEditingAreaStyleSheets(),"\n\x3c/head\x3e\n\x3cbody role\x3d'application'",d?" aria-label\x3d'"+v.escape(d)+"'":"","onload\x3d'try{frameElement \x26\x26 frameElement._loadFunc(window,document)}catch(e){document.domain\x3d\""+document.domain+"\";frameElement._loadFunc(window,document)}' ","style\x3d'"+m+"'\x3e",e,"\x3c/body\x3e\n\x3c/html\x3e"].join("")},_applyEditingAreaStyleSheets:function(){var a=[];this.styleSheets&&(a=this.styleSheets.split(";"),this.styleSheets=
"");a=a.concat(this.editingAreaStyleSheets);this.editingAreaStyleSheets=[];for(var b="",c=0,d,e=A.get(this.ownerDocument);d=a[c++];)d=(new z(e.location,d)).toString(),this.editingAreaStyleSheets.push(d),b+='\x3clink rel\x3d"stylesheet" type\x3d"text/css" href\x3d"'+d+'"/\x3e';return b},addStyleSheet:function(a){var b=a.toString(),c=A.get(this.ownerDocument);if("."===b.charAt(0)||"/"!==b.charAt(0)&&!a.host)b=(new z(c.location,b)).toString();-1<r.indexOf(this.editingAreaStyleSheets,b)||(this.editingAreaStyleSheets.push(b),
this.onLoadDeferred.then(g.hitch(this,function(){if(this.document.createStyleSheet)this.document.createStyleSheet(b);else{var a=this.document.getElementsByTagName("head")[0],c=this.document.createElement("link");c.rel="stylesheet";c.type="text/css";c.href=b;a.appendChild(c)}})))},removeStyleSheet:function(a){var b=a.toString(),c=A.get(this.ownerDocument);if("."===b.charAt(0)||"/"!==b.charAt(0)&&!a.host)b=(new z(c.location,b)).toString();a=r.indexOf(this.editingAreaStyleSheets,b);-1!==a&&(delete this.editingAreaStyleSheets[a],
n('link[href\x3d"'+b+'"]',this.window.document).orphan())},disabled:!1,_mozSettingProps:{styleWithCSS:!1},_setDisabledAttr:function(a){a=!!a;this._set("disabled",a);if(this.isLoaded){var b=f("ie")&&(this.isLoaded||!this.focusOnLoad);b&&(this.editNode.unselectable="on");this.editNode.contentEditable=!a;this.editNode.tabIndex=a?"-1":this.tabIndex;b&&this.defer(function(){this.editNode&&(this.editNode.unselectable="off")});if(f("mozilla")&&!a&&this._mozSettingProps){a=this._mozSettingProps;for(var c in a)if(a.hasOwnProperty(c))try{this.document.execCommand(c,
!1,a[c])}catch(K){}}this._disabledOK=!0}},onLoad:function(a){this.window.__registeredWindow||(this.window.__registeredWindow=!0,this._iframeRegHandle=F.registerIframe(this.iframe));this.editNode=this.document.body.firstChild;var b=this;this.beforeIframeNode=h.place("\x3cdiv tabIndex\x3d-1\x3e\x3c/div\x3e",this.iframe,"before");this.afterIframeNode=h.place("\x3cdiv tabIndex\x3d-1\x3e\x3c/div\x3e",this.iframe,"after");this.iframe.onfocus=this.document.onfocus=function(){b.editNode.focus()};this.focusNode=
this.editNode;var c=this.events.concat(this.captureEvents),d=this.iframe?this.document:this.editNode;this.own.apply(this,r.map(c,function(a){var b=a.toLowerCase().replace(/^on/,"");return u(d,b,g.hitch(this,a))},this));this.own(u(d,"mouseup",g.hitch(this,"onClick")));f("ie")&&(this.own(u(this.document,"mousedown",g.hitch(this,"_onIEMouseDown"))),this.editNode.style.zoom=1);f("webkit")&&(this._webkitListener=this.own(u(this.document,"mouseup",g.hitch(this,"onDisplayChanged")))[0],this.own(u(this.document,
"mousedown",g.hitch(this,function(a){a=a.target;!a||a!==this.document.body&&a!==this.document||this.defer("placeCursorAtEnd")}))));if(f("ie"))try{this.document.execCommand("RespectVisibilityInDesign",!0,null)}catch(W){}this.isLoaded=!0;this.set("disabled",this.disabled);c=g.hitch(this,function(){this.setValue(a);this.onLoadDeferred&&!this.onLoadDeferred.isFulfilled()&&this.onLoadDeferred.resolve(!0);this.onDisplayChanged();this.focusOnLoad&&t(g.hitch(this,"defer","focus",this.updateInterval));this.value=
this.getValue(!0)});this.setValueDeferred?this.setValueDeferred.then(c):c()},onKeyDown:function(b){if(b.keyCode===a.SHIFT||b.keyCode===a.ALT||b.keyCode===a.META||b.keyCode===a.CTRL)return!0;b.keyCode===a.TAB&&this.isTabIndent&&(b.stopPropagation(),b.preventDefault(),this.queryCommandEnabled(b.shiftKey?"outdent":"indent")&&this.execCommand(b.shiftKey?"outdent":"indent"));if(b.keyCode==a.TAB&&!this.isTabIndent&&!b.ctrlKey&&!b.altKey)return b.shiftKey?this.beforeIframeNode.focus():this.afterIframeNode.focus(),
!0;9>f("ie")&&b.keyCode===a.BACKSPACE&&"Control"===this.document.selection.type&&(b.stopPropagation(),b.preventDefault(),this.execCommand("delete"));f("ff")&&(b.keyCode===a.PAGE_UP||b.keyCode===a.PAGE_DOWN)&&this.editNode.clientHeight>=this.editNode.scrollHeight&&b.preventDefault();var c=this._keyHandlers[b.keyCode],d=arguments;c&&!b.altKey&&r.some(c,function(a){if(!(a.shift^b.shiftKey||a.ctrl^(b.ctrlKey||b.metaKey)))return a.handler.apply(this,d)||b.preventDefault(),!0},this);this.defer("onKeyPressed",
1);return!0},onKeyUp:function(){},setDisabled:function(a){b.deprecated("dijit.Editor::setDisabled is deprecated",'use dijit.Editor::attr("disabled",boolean) instead',2);this.set("disabled",a)},_setValueAttr:function(a){this.setValue(a)},_setDisableSpellCheckAttr:function(a){this.document?m.set(this.document.body,"spellcheck",!a):this.onLoadDeferred.then(g.hitch(this,function(){m.set(this.document.body,"spellcheck",!a)}));this._set("disableSpellCheck",a)},addKeyHandler:function(a,b,c,d){"string"==
typeof a&&(a=a.toUpperCase().charCodeAt(0));g.isArray(this._keyHandlers[a])||(this._keyHandlers[a]=[]);this._keyHandlers[a].push({shift:c||!1,ctrl:b||!1,handler:d})},onKeyPressed:function(){this.onDisplayChanged()},onClick:function(a){this.onDisplayChanged(a)},_onIEMouseDown:function(){this.focused||this.disabled||this.focus()},_onBlur:function(a){(f("ie")||f("trident"))&&this.defer(function(){F.curNode||this.ownerDocumentBody.focus()});this.inherited(arguments);var b=this.getValue(!0);if(b!==this.value)this.onChange(b);
this._set("value",b)},_onFocus:function(a){this.disabled||(this._disabledOK||this.set("disabled",!1),this.inherited(arguments))},blur:function(){!f("ie")&&this.window.document.documentElement&&this.window.document.documentElement.focus?this.window.document.documentElement.focus():this.ownerDocumentBody.focus&&this.ownerDocumentBody.focus()},focus:function(){this.isLoaded?9>f("ie")?this.iframe.fireEvent("onfocus",document.createEventObject()):this.editNode.focus():this.focusOnLoad=!0},updateInterval:200,
_updateTimer:null,onDisplayChanged:function(){this._updateTimer&&this._updateTimer.remove();this._updateTimer=this.defer("onNormalizedDisplayChanged",this.updateInterval)},onNormalizedDisplayChanged:function(){delete this._updateTimer},onChange:function(){},_normalizeCommand:function(a,b){var c=a.toLowerCase();"formatblock"===c?f("safari")&&void 0===b&&(c="heading"):"hilitecolor"!==c||f("mozilla")||(c="backcolor");return c},_qcaCache:{},queryCommandAvailable:function(a){var b=this._qcaCache[a];return void 0!==
b?b:this._qcaCache[a]=this._queryCommandAvailable(a)},_queryCommandAvailable:function(a){switch(a.toLowerCase()){case "bold":case "italic":case "underline":case "subscript":case "superscript":case "fontname":case "fontsize":case "forecolor":case "hilitecolor":case "justifycenter":case "justifyfull":case "justifyleft":case "justifyright":case "delete":case "selectall":case "toggledir":case "createlink":case "unlink":case "removeformat":case "inserthorizontalrule":case "insertimage":case "insertorderedlist":case "insertunorderedlist":case "indent":case "outdent":case "formatblock":case "inserthtml":case "undo":case "redo":case "strikethrough":case "tabindent":case "cut":case "copy":case "paste":return!0;
case "blockdirltr":case "blockdirrtl":case "dirltr":case "dirrtl":case "inlinedirltr":case "inlinedirrtl":return f("ie")||f("trident")||f("edge");case "inserttable":case "insertcell":case "insertcol":case "insertrow":case "deletecells":case "deletecols":case "deleterows":case "mergecells":case "splitcell":return!f("webkit");default:return!1}},execCommand:function(a,b){var c;this.focused&&this.focus();a=this._normalizeCommand(a,b);if(void 0!==b){if("heading"===a)throw Error("unimplemented");"formatblock"===
a&&(f("ie")||f("trident"))&&(b="\x3c"+b+"\x3e")}var d="_"+a+"Impl";if(this[d])c=this[d](b);else if((b=1<arguments.length?b:null)||"createlink"!==a)c=this.document.execCommand(a,!1,b);this.onDisplayChanged();return c},queryCommandEnabled:function(a){if(this.disabled||!this._disabledOK)return!1;a=this._normalizeCommand(a);var b="_"+a+"EnabledImpl";return this[b]?this[b](a):this._browserQueryCommandEnabled(a)},queryCommandState:function(a){if(this.disabled||!this._disabledOK)return!1;a=this._normalizeCommand(a);
try{return this.document.queryCommandState(a)}catch(M){return!1}},queryCommandValue:function(a){if(this.disabled||!this._disabledOK)return!1;a=this._normalizeCommand(a);if(f("ie")&&"formatblock"===a)a=this._native2LocalFormatNames[this.document.queryCommandValue(a)];else if(f("mozilla")&&"hilitecolor"===a){var b;try{b=this.document.queryCommandValue("styleWithCSS")}catch(L){b=!1}this.document.execCommand("styleWithCSS",!1,!0);a=this.document.queryCommandValue(a);this.document.execCommand("styleWithCSS",
!1,b)}else a=this.document.queryCommandValue(a);return a},_sCall:function(a,b){return this.selection[a].apply(this.selection,b)},placeCursorAtStart:function(){this.focus();var a=!1;if(f("mozilla"))for(var b=this.editNode.firstChild;b;){if(3===b.nodeType){if(0<b.nodeValue.replace(/^\s+|\s+$/g,"").length){a=!0;this.selection.selectElement(b);break}}else if(1===b.nodeType){var a=!0,c=b.tagName?b.tagName.toLowerCase():"";/br|input|img|base|meta|area|basefont|hr|link/.test(c)?this.selection.selectElement(b):
this.selection.selectElementChildren(b);break}b=b.nextSibling}else a=!0,this.selection.selectElementChildren(this.editNode);a&&this.selection.collapse(!0)},placeCursorAtEnd:function(){this.focus();var a=!1;if(f("mozilla"))for(var b=this.editNode.lastChild;b;){if(3===b.nodeType){if(0<b.nodeValue.replace(/^\s+|\s+$/g,"").length){a=!0;this.selection.selectElement(b);break}}else if(1===b.nodeType){a=!0;this.selection.selectElement(b.lastChild||b);break}b=b.previousSibling}else a=!0,this.selection.selectElementChildren(this.editNode);
a&&this.selection.collapse(!1)},getValue:function(a){return!this.textarea||!this.isClosed&&this.isLoaded?this.isLoaded?this._postFilterContent(null,a):this.value:this.textarea.value},_getValueAttr:function(){return this.getValue(!0)},setValue:function(a){if(this.isLoaded){if(!this.textarea||!this.isClosed&&this.isLoaded){a=this._preFilterContent(a);var b=this.isClosed?this.domNode:this.editNode;b.innerHTML=a;this._preDomFilterContent(b)}else this.textarea.value=a;this.onDisplayChanged();this._set("value",
this.getValue(!0))}else this.onLoadDeferred.then(g.hitch(this,function(){this.setValue(a)}))},replaceValue:function(a){this.isClosed?this.setValue(a):this.window&&this.window.getSelection&&!f("mozilla")?this.setValue(a):this.window&&this.window.getSelection?(a=this._preFilterContent(a),this.execCommand("selectall"),this.execCommand("inserthtml",a),this._preDomFilterContent(this.editNode)):this.document&&this.document.selection&&this.setValue(a);this._set("value",this.getValue(!0))},_preFilterContent:function(a){var b=
a;r.forEach(this.contentPreFilters,function(a){a&&(b=a(b))});return b},_preDomFilterContent:function(a){a=a||this.editNode;r.forEach(this.contentDomPreFilters,function(b){b&&g.isFunction(b)&&b(a)},this)},_postFilterContent:function(a,b){var c;g.isString(a)?c=a:(a=a||this.editNode,this.contentDomPostFilters.length&&(b&&(a=g.clone(a)),r.forEach(this.contentDomPostFilters,function(b){a=b(a)})),c=D.getChildrenHtml(a));g.trim(c.replace(/^\xA0\xA0*/,"").replace(/\xA0\xA0*$/,"")).length||(c="");r.forEach(this.contentPostFilters,
function(a){c=a(c)});return c},_saveContent:function(){var a=k.byId(G._scopeName+"._editor.RichText.value");a&&(a.value&&(a.value+=this._SEPARATOR),a.value+=this.name+this._NAME_CONTENT_SEP+this.getValue(!0))},escapeXml:function(a,b){a=a.replace(/&/gm,"\x26amp;").replace(/</gm,"\x26lt;").replace(/>/gm,"\x26gt;").replace(/"/gm,"\x26quot;");b||(a=a.replace(/'/gm,"\x26#39;"));return a},getNodeHtml:function(a){b.deprecated("dijit.Editor::getNodeHtml is deprecated","use dijit/_editor/html::getNodeHtml instead",
2);return D.getNodeHtml(a)},getNodeChildrenHtml:function(a){b.deprecated("dijit.Editor::getNodeChildrenHtml is deprecated","use dijit/_editor/html::getChildrenHtml instead",2);return D.getChildrenHtml(a)},close:function(a){if(!this.isClosed){arguments.length||(a=!0);a&&this._set("value",this.getValue(!0));this.interval&&clearInterval(this.interval);this._webkitListener&&(this._webkitListener.remove(),delete this._webkitListener);f("ie")&&(this.iframe.onfocus=null);this.iframe._loadFunc=null;this._iframeRegHandle&&
(this._iframeRegHandle.remove(),delete this._iframeRegHandle);if(this.textarea){var b=this.textarea.style;b.position="";b.left=b.top="";f("ie")&&(b.overflow=this.__overflow,this.__overflow=null);this.textarea.value=this.value;h.destroy(this.domNode);this.domNode=this.textarea}else this.domNode.innerHTML=this.value;delete this.iframe;p.remove(this.domNode,this.baseClass);this.isClosed=!0;this.isLoaded=!1;delete this.editNode;delete this.focusNode;this.window&&this.window._frameElement&&(this.window._frameElement=
null);this.editorObject=this.editingArea=this.document=this.window=null}},destroy:function(){this.isClosed||this.close(!1);this._updateTimer&&this._updateTimer.remove();this.inherited(arguments);J._globalSaveHandler&&delete J._globalSaveHandler[this.id]},_removeMozBogus:function(a){return a.replace(/\stype="_moz"/gi,"").replace(/\s_moz_dirty=""/gi,"").replace(/_moz_resizing="(true|false)"/gi,"")},_removeWebkitBogus:function(a){a=a.replace(/\sclass="webkit-block-placeholder"/gi,"");a=a.replace(/\sclass="apple-style-span"/gi,
"");return a=a.replace(/<meta charset=\"utf-8\" \/>/gi,"")},_normalizeFontStyle:function(a){return a.replace(/<(\/)?strong([ \>])/gi,"\x3c$1b$2").replace(/<(\/)?em([ \>])/gi,"\x3c$1i$2")},_preFixUrlAttributes:function(a){return a.replace(/(?:(<a(?=\s).*?\shref=)("|')(.*?)\2)|(?:(<a\s.*?href=)([^"'][^ >]+))/gi,"$1$4$2$3$5$2 _djrealurl\x3d$2$3$5$2").replace(/(?:(<img(?=\s).*?\ssrc=)("|')(.*?)\2)|(?:(<img\s.*?src=)([^"'][^ >]+))/gi,"$1$4$2$3$5$2 _djrealurl\x3d$2$3$5$2")},_browserQueryCommandEnabled:function(a){if(!a)return!1;
if(f("ie")||f("trident")||f("edge"))return this.focused&&!this.disabled;var b=9>f("ie")?this.document.selection.createRange():this.document;try{return b.queryCommandEnabled(a)}catch(L){return!1}},_createlinkEnabledImpl:function(){var a=!0;return a=f("opera")?this.window.getSelection().isCollapsed?!0:this.document.queryCommandEnabled("createlink"):this._browserQueryCommandEnabled("createlink")},_unlinkEnabledImpl:function(){var a=!0;return a=f("mozilla")||f("webkit")||f("ie")||f("trident")||f("edge")?
this.selection.hasAncestorElement("a"):this._browserQueryCommandEnabled("unlink")},_inserttableEnabledImpl:function(){var a=!0;return a=f("mozilla")||f("webkit")?!0:this._browserQueryCommandEnabled("inserttable")},_cutEnabledImpl:function(){var a=!0;f("webkit")?((a=this.window.getSelection())&&(a=a.toString()),a=!!a):a=this._browserQueryCommandEnabled("cut");return a},_copyEnabledImpl:function(){var a=!0;f("webkit")?((a=this.window.getSelection())&&(a=a.toString()),a=!!a):a=this._browserQueryCommandEnabled("copy");
return a},_pasteEnabledImpl:function(){var a=!0;return f("webkit")?!0:a=this._browserQueryCommandEnabled("paste")},_inserthorizontalruleImpl:function(a){return f("ie")?this._inserthtmlImpl("\x3chr\x3e"):this.document.execCommand("inserthorizontalrule",!1,a)},_unlinkImpl:function(a){return this.queryCommandEnabled("unlink")&&(f("mozilla")||f("webkit"))?(a=this.selection.getAncestorElement("a"),this.selection.selectElement(a),this.document.execCommand("unlink",!1,null)):this.document.execCommand("unlink",
!1,a)},_hilitecolorImpl:function(a){var b;this._handleTextColorOrProperties("hilitecolor",a)||(f("mozilla")?(this.document.execCommand("styleWithCSS",!1,!0),console.log("Executing color command."),b=this.document.execCommand("hilitecolor",!1,a),this.document.execCommand("styleWithCSS",!1,!1)):b=this.document.execCommand("hilitecolor",!1,a));return b},_backcolorImpl:function(a){f("ie")&&(a=a?a:null);var b=this._handleTextColorOrProperties("backcolor",a);b||(b=this.document.execCommand("backcolor",
!1,a));return b},_forecolorImpl:function(a){f("ie")&&(a=a?a:null);var b=!1;(b=this._handleTextColorOrProperties("forecolor",a))||(b=this.document.execCommand("forecolor",!1,a));return b},_inserthtmlImpl:function(a){a=this._preFilterContent(a);var b=!0;if(9>f("ie")){var c=this.document.selection.createRange();if("CONTROL"===this.document.selection.type.toUpperCase()){for(var d=c.item(0);c.length;)c.remove(c.item(0));d.outerHTML=a}else c.pasteHTML(a);c.select()}else if(8>f("trident")){var e=E.getSelection(this.window);
if(e&&e.rangeCount&&e.getRangeAt){c=e.getRangeAt(0);c.deleteContents();var g=h.create("div");g.innerHTML=a;for(var k,d=this.document.createDocumentFragment();a=g.firstChild;)k=d.appendChild(a);c.insertNode(d);k&&(c=c.cloneRange(),c.setStartAfter(k),c.collapse(!1),e.removeAllRanges(),e.addRange(c))}}else f("mozilla")&&!a.length?this.selection.remove():b=this.document.execCommand("inserthtml",!1,a);return b},_boldImpl:function(a){var b=!1;if(f("ie")||f("trident"))this._adaptIESelection(),b=this._adaptIEFormatAreaAndExec("bold");
b||(b=this.document.execCommand("bold",!1,a));return b},_italicImpl:function(a){var b=!1;if(f("ie")||f("trident"))this._adaptIESelection(),b=this._adaptIEFormatAreaAndExec("italic");b||(b=this.document.execCommand("italic",!1,a));return b},_underlineImpl:function(a){var b=!1;if(f("ie")||f("trident"))this._adaptIESelection(),b=this._adaptIEFormatAreaAndExec("underline");b||(b=this.document.execCommand("underline",!1,a));return b},_strikethroughImpl:function(a){var b=!1;if(f("ie")||f("trident"))this._adaptIESelection(),
b=this._adaptIEFormatAreaAndExec("strikethrough");b||(b=this.document.execCommand("strikethrough",!1,a));return b},_superscriptImpl:function(a){var b=!1;if(f("ie")||f("trident"))this._adaptIESelection(),b=this._adaptIEFormatAreaAndExec("superscript");b||(b=this.document.execCommand("superscript",!1,a));return b},_subscriptImpl:function(a){var b=!1;if(f("ie")||f("trident"))this._adaptIESelection(),b=this._adaptIEFormatAreaAndExec("subscript");b||(b=this.document.execCommand("subscript",!1,a));return b},
_fontnameImpl:function(a){var b;if(f("ie")||f("trident"))b=this._handleTextColorOrProperties("fontname",a);b||(b=this.document.execCommand("fontname",!1,a));return b},_fontsizeImpl:function(a){var b;if(f("ie")||f("trident"))b=this._handleTextColorOrProperties("fontsize",a);b||(b=this.document.execCommand("fontsize",!1,a));return b},_insertorderedlistImpl:function(a){var b=!1;if(f("ie")||f("trident")||f("edge"))b=this._adaptIEList("insertorderedlist",a);b||(b=this.document.execCommand("insertorderedlist",
!1,a));return b},_insertunorderedlistImpl:function(a){var b=!1;if(f("ie")||f("trident")||f("edge"))b=this._adaptIEList("insertunorderedlist",a);b||(b=this.document.execCommand("insertunorderedlist",!1,a));return b},getHeaderHeight:function(){return this._getNodeChildrenHeight(this.header)},getFooterHeight:function(){return this._getNodeChildrenHeight(this.footer)},_getNodeChildrenHeight:function(a){var b=0;if(a&&a.childNodes){var c;for(c=0;c<a.childNodes.length;c++)var d=e.position(a.childNodes[c]),
b=b+d.h}return b},_isNodeEmpty:function(a,b){return 1===a.nodeType?0<a.childNodes.length?this._isNodeEmpty(a.childNodes[0],b):!0:3===a.nodeType?""===a.nodeValue.substring(b):!1},_removeStartingRangeFromRange:function(a,b){if(a.nextSibling)b.setStart(a.nextSibling,0);else{for(var c=a.parentNode;c&&null==c.nextSibling;)c=c.parentNode;c&&b.setStart(c.nextSibling,0)}return b},_adaptIESelection:function(){var a=E.getSelection(this.window);if(a&&a.rangeCount&&!a.isCollapsed){for(var b=a.getRangeAt(0),c=
b.startContainer,d=b.startOffset;3===c.nodeType&&d>=c.length&&c.nextSibling;)d-=c.length,c=c.nextSibling;for(var e=null;this._isNodeEmpty(c,d)&&c!==e;)e=c,b=this._removeStartingRangeFromRange(c,b),c=b.startContainer,d=0;a.removeAllRanges();a.addRange(b)}},_adaptIEFormatAreaAndExec:function(a){var b=E.getSelection(this.window),c=this.document,d,e,f,g,k,n,l;if(a&&b&&b.isCollapsed){if(this.queryCommandValue(a)){a=this._tagNamesForCommand(a);f=b.getRangeAt(0);g=f.startContainer;3===g.nodeType&&(e=f.endOffset,
g.length<e&&(e=this._adjustNodeAndOffset(d,e),g=e.node,e=e.offset));for(;g&&g!==this.editNode;){d=g.tagName?g.tagName.toLowerCase():"";if(-1<r.indexOf(a,d)){l=g;break}g=g.parentNode}if(l&&(d=f.startContainer,a=c.createElement(l.tagName),h.place(a,l,"after"),d&&3===d.nodeType)){e=f.endOffset;d.length<e&&(e=this._adjustNodeAndOffset(d,e),d=e.node,e=e.offset);g=d.nodeValue;f=c.createTextNode(g.substring(0,e));var m=g.substring(e,g.length);m&&(k=c.createTextNode(m));h.place(f,d,"before");k&&(n=c.createElement("span"),
n.className="ieFormatBreakerSpan",h.place(n,d,"after"),h.place(k,n,"after"),k=n);h.destroy(d);e=f.parentNode;for(d=[];e!==l;){g=e.tagName;f={tagName:g};d.push(f);g=c.createElement(g);e.style&&g.style&&e.style.cssText&&(g.style.cssText=e.style.cssText,f.cssText=e.style.cssText);"FONT"===e.tagName&&(e.color&&(g.color=e.color,f.color=e.color),e.face&&(g.face=e.face,f.face=e.face),e.size&&(g.size=e.size,f.size=e.size));e.className&&(g.className=e.className,f.className=e.className);if(k)for(;k;)f=k.nextSibling,
g.appendChild(k),k=f;g.tagName==e.tagName?(n=c.createElement("span"),n.className="ieFormatBreakerSpan",h.place(n,e,"after"),h.place(g,n,"after")):h.place(g,e,"after");f=e;k=g;e=e.parentNode}if(k){if(1===k.nodeType||3===k.nodeType&&k.nodeValue)a.innerHTML="";for(;k;)f=k.nextSibling,a.appendChild(k),k=f}if(d.length){f=d.pop();k=c.createElement(f.tagName);f.cssText&&k.style&&(k.style.cssText=f.cssText);f.className&&(k.className=f.className);"FONT"===f.tagName&&(f.color&&(k.color=f.color),f.face&&(k.face=
f.face),f.size&&(k.size=f.size));for(h.place(k,a,"before");d.length;)f=d.pop(),l=c.createElement(f.tagName),f.cssText&&l.style&&(l.style.cssText=f.cssText),f.className&&(l.className=f.className),"FONT"===f.tagName&&(f.color&&(l.color=f.color),f.face&&(l.face=f.face),f.size&&(l.size=f.size)),k.appendChild(l),k=l;l=c.createTextNode(".");n.appendChild(l);k.appendChild(l)}else n=c.createElement("span"),n.className="ieFormatBreakerSpan",l=c.createTextNode("."),n.appendChild(l),h.place(n,a,"before");k=
E.create(this.window);k.setStart(l,0);k.setEnd(l,l.length);b.removeAllRanges();b.addRange(k);this.selection.collapse(!1);l.parentNode.innerHTML="";a.firstChild||h.destroy(a);return!0}return!1}f=b.getRangeAt(0);if((d=f.startContainer)&&3===d.nodeType)return e=f.startOffset,d.length<e&&(e=this._adjustNodeAndOffset(d,e),d=e.node,e=e.offset),g=d.nodeValue,f=c.createTextNode(g.substring(0,e)),m=g.substring(e),""!==m&&(k=c.createTextNode(g.substring(e))),n=c.createElement("span"),l=c.createTextNode("."),
n.appendChild(l),f.length?h.place(f,d,"after"):f=d,h.place(n,f,"after"),k&&h.place(k,n,"after"),h.destroy(d),k=E.create(this.window),k.setStart(l,0),k.setEnd(l,l.length),b.removeAllRanges(),b.addRange(k),c.execCommand(a),h.place(n.firstChild,n,"before"),h.destroy(n),k.setStart(l,0),k.setEnd(l,l.length),b.removeAllRanges(),b.addRange(k),this.selection.collapse(!1),l.parentNode.innerHTML="",!0}else return!1},_adaptIEList:function(a){var b=E.getSelection(this.window);if(b.isCollapsed&&b.rangeCount&&
!this.queryCommandValue(a)){var c=b.getRangeAt(0),d=c.startContainer;if(d&&3==d.nodeType&&!c.startOffset)return c="ul","insertorderedlist"===a&&(c="ol"),a=this.document.createElement(c),c=h.create("li",null,a),h.place(a,d,"before"),c.appendChild(d),h.create("br",null,a,"after"),a=E.create(this.window),a.setStart(d,0),a.setEnd(d,d.length),b.removeAllRanges(),b.addRange(a),this.selection.collapse(!0),!0}return!1},_handleTextColorOrProperties:function(a,b){var d=E.getSelection(this.window),e=this.document,
g,k,l,n,m;b=b||null;if(a&&d&&d.isCollapsed&&d.rangeCount&&(k=d.getRangeAt(0),(g=k.startContainer)&&3===g.nodeType)){m=k.startOffset;g.length<m&&(k=this._adjustNodeAndOffset(g,m),g=k.node,m=k.offset);l=g.nodeValue;k=e.createTextNode(l.substring(0,m));""!==l.substring(m)&&(n=e.createTextNode(l.substring(m)));l=e.createElement("span");m=e.createTextNode(".");l.appendChild(m);e=e.createElement("span");l.appendChild(e);k.length?h.place(k,g,"after"):k=g;h.place(l,k,"after");n&&h.place(n,l,"after");h.destroy(g);
g=E.create(this.window);g.setStart(m,0);g.setEnd(m,m.length);d.removeAllRanges();d.addRange(g);if(f("webkit")){d="color";if("hilitecolor"===a||"backcolor"===a)d="backgroundColor";c.set(l,d,b);this.selection.remove();h.destroy(e);l.innerHTML="\x26#160;";this.selection.selectElement(l);this.focus()}else this.execCommand(a,b),h.place(l.firstChild,l,"before"),h.destroy(l),g.setStart(m,0),g.setEnd(m,m.length),d.removeAllRanges(),d.addRange(g),this.selection.collapse(!1),m.parentNode.removeChild(m);return!0}return!1},
_adjustNodeAndOffset:function(a,b){for(;a.length<b&&a.nextSibling&&3===a.nextSibling.nodeType;)b-=a.length,a=a.nextSibling;return{node:a,offset:b}},_tagNamesForCommand:function(a){return"bold"===a?["b","strong"]:"italic"===a?["i","em"]:"strikethrough"===a?["s","strike"]:"superscript"===a?["sup"]:"subscript"===a?["sub"]:"underline"===a?["u"]:[]},_stripBreakerNodes:function(a){if(this.isLoaded)return n(".ieFormatBreakerSpan",a).forEach(function(a){for(;a.firstChild;)h.place(a.firstChild,a,"before");
h.destroy(a)}),a},_stripTrailingEmptyNodes:function(a){function b(a){return/^(p|div|br)$/i.test(a.nodeName)&&0==a.children.length&&/^[\s\xA0]*$/.test(a.textContent||a.innerText||"")||3===a.nodeType&&/^[\s\xA0]*$/.test(a.nodeValue)}for(;a.lastChild&&b(a.lastChild);)h.destroy(a.lastChild);return a},_setTextDirAttr:function(a){this._set("textDir",a);this.onLoadDeferred.then(g.hitch(this,function(){this.editNode.dir=a}))}});return J})},"dijit/selection":function(){define("dojo/_base/array dojo/dom dojo/_base/lang dojo/sniff dojo/_base/window dijit/focus".split(" "),
function(r,l,d,q,k,m){var p=function(e){var c=e.document;this.getType=function(){if(c.getSelection){var b="text",a;try{a=e.getSelection()}catch(g){}a&&1==a.rangeCount&&(a=a.getRangeAt(0),a.startContainer==a.endContainer&&1==a.endOffset-a.startOffset&&3!=a.startContainer.nodeType&&(b="control"));return b}return c.selection.type.toLowerCase()};this.getSelectedText=function(){if(c.getSelection){var b=e.getSelection();return b?b.toString():""}return"control"==this.getType()?null:c.selection.createRange().text};
this.getSelectedHtml=function(){if(c.getSelection){var b=e.getSelection();if(b&&b.rangeCount){var a,d="";for(a=0;a<b.rangeCount;a++){var h=b.getRangeAt(a).cloneContents(),k=c.createElement("div");k.appendChild(h);d+=k.innerHTML}return d}return null}return"control"==this.getType()?null:c.selection.createRange().htmlText};this.getSelectedElement=function(){if("control"==this.getType()){if(c.getSelection){var b=e.getSelection();return b.anchorNode.childNodes[b.anchorOffset]}if((b=c.selection.createRange())&&
b.item)return c.selection.createRange().item(0)}return null};this.getParentElement=function(){if("control"==this.getType()){var b=this.getSelectedElement();if(b)return b.parentNode}else if(c.getSelection){if(b=c.getSelection()){for(b=b.anchorNode;b&&1!=b.nodeType;)b=b.parentNode;return b}}else return b=c.selection.createRange(),b.collapse(!0),b.parentElement();return null};this.hasAncestorElement=function(b){return null!=this.getAncestorElement.apply(this,arguments)};this.getAncestorElement=function(b){var a=
this.getSelectedElement()||this.getParentElement();return this.getParentOfType(a,arguments)};this.isTag=function(b,a){if(b&&b.tagName)for(var c=b.tagName.toLowerCase(),d=0;d<a.length;d++){var e=String(a[d]).toLowerCase();if(c==e)return e}return""};this.getParentOfType=function(b,a){for(;b;){if(this.isTag(b,a).length)return b;b=b.parentNode}return null};this.collapse=function(b){if(c.getSelection){var a=e.getSelection();a.removeAllRanges?b?a.collapseToStart():a.collapseToEnd():a.collapse(b)}else a=
c.selection.createRange(),a.collapse(b),a.select()};this.remove=function(){var b=c.selection;c.getSelection?(b=e.getSelection(),b.deleteFromDocument()):"none"!=b.type.toLowerCase()&&b.clear();return b};this.selectElementChildren=function(b,a){var d;b=l.byId(b);if(c.getSelection){var h=e.getSelection();q("opera")?(d=h.rangeCount?h.getRangeAt(0):c.createRange(),d.setStart(b,0),d.setEnd(b,3==b.nodeType?b.length:b.childNodes.length),h.addRange(d)):h.selectAllChildren(b)}else if(d=b.ownerDocument.body.createTextRange(),
d.moveToElementText(b),!a)try{d.select()}catch(n){}};this.selectElement=function(b,a){var d;b=l.byId(b);if(c.getSelection){var e=c.getSelection();d=c.createRange();e.removeAllRanges&&(q("opera")&&e.getRangeAt(0)&&(d=e.getRangeAt(0)),d.selectNode(b),e.removeAllRanges(),e.addRange(d))}else try{e=b.tagName?b.tagName.toLowerCase():"",d="img"===e||"table"===e?k.body(c).createControlRange():k.body(c).createRange(),d.addElement(b),a||d.select()}catch(n){this.selectElementChildren(b,a)}};this.inSelection=
function(b){if(b){var a,d;if(c.getSelection){var h=e.getSelection();h&&0<h.rangeCount&&(d=h.getRangeAt(0));if(d&&d.compareBoundaryPoints&&c.createRange)try{if(a=c.createRange(),a.setStart(b,0),1===d.compareBoundaryPoints(d.START_TO_END,a))return!0}catch(n){}}else{d=c.selection.createRange();try{a=b.ownerDocument.body.createTextRange(),a.moveToElementText(b)}catch(n){}if(d&&a&&1===d.compareEndPoints("EndToStart",a))return!0}}return!1};this.getBookmark=function(){var b,a,d=c.selection,h=m.curNode;if(c.getSelection){if(d=
e.getSelection())if(d.isCollapsed){if(b=h?h.tagName:"")if(b=b.toLowerCase(),"textarea"==b||"input"==b&&(!h.type||"text"==h.type.toLowerCase()))return d={start:h.selectionStart,end:h.selectionEnd,node:h,pRange:!0},{isCollapsed:d.end<=d.start,mark:d};b={isCollapsed:!0};d.rangeCount&&(b.mark=d.getRangeAt(0).cloneRange())}else a=d.getRangeAt(0),b={isCollapsed:!1,mark:a.cloneRange()}}else if(d){b=h?h.tagName:"";b=b.toLowerCase();if(h&&b&&("button"==b||"textarea"==b||"input"==b)){if(d.type&&"none"==d.type.toLowerCase())return{isCollapsed:!0,
mark:null};a=d.createRange();return{isCollapsed:a.text&&a.text.length?!1:!0,mark:{range:a,pRange:!0}}}b={};try{a=d.createRange(),b.isCollapsed=!("Text"==d.type?a.htmlText.length:a.length)}catch(n){return b.isCollapsed=!0,b}if("CONTROL"==d.type.toUpperCase())if(a.length)for(b.mark=[],d=0,h=a.length;d<h;)b.mark.push(a.item(d++));else b.isCollapsed=!0,b.mark=null;else b.mark=a.getBookmark()}else console.warn("No idea how to store the current selection for this browser!");return b};this.moveToBookmark=
function(b){if(b=b.mark)if(c.getSelection){var a=e.getSelection();a&&a.removeAllRanges?b.pRange?(a=b.node,a.selectionStart=b.start,a.selectionEnd=b.end):(a.removeAllRanges(),a.addRange(b)):console.warn("No idea how to restore selection for this browser!")}else if(c.selection&&b){var g;b.pRange?g=b.range:d.isArray(b)?(g=c.body.createControlRange(),r.forEach(b,function(a){g.addElement(a)})):(g=c.body.createTextRange(),g.moveToBookmark(b));g.select()}};this.isCollapsed=function(){return this.getBookmark().isCollapsed}},
h=new p(window);h.SelectionManager=p;return h})},"dijit/_editor/range":function(){define(["dojo/_base/array","dojo/_base/declare","dojo/_base/lang"],function(r,l,d){var q={getIndex:function(d,h){for(var e=[],c=[],b=d,a,g;d!=h;){var k=0;for(a=d.parentNode;g=a.childNodes[k++];)if(g===d){--k;break}e.unshift(k);c.unshift(k-a.childNodes.length);d=a}if(0<e.length&&3==b.nodeType){for(g=b.previousSibling;g&&3==g.nodeType;)e[e.length-1]--,g=g.previousSibling;for(g=b.nextSibling;g&&3==g.nodeType;)c[c.length-
1]++,g=g.nextSibling}return{o:e,r:c}},getNode:function(k,h){if(!d.isArray(k)||0==k.length)return h;var e=h;r.every(k,function(c){if(0<=c&&c<e.childNodes.length)e=e.childNodes[c];else return e=null,!1;return!0});return e},getCommonAncestor:function(d,h,e){e=e||d.ownerDocument.body;var c=function(a){for(var b=[];a;)if(b.unshift(a),a!==e)a=a.parentNode;else break;return b};d=c(d);h=c(h);for(var c=Math.min(d.length,h.length),b=d[0],a=1;a<c;a++)if(d[a]===h[a])b=d[a];else break;return b},getAncestor:function(d,
h,e){for(e=e||d.ownerDocument.body;d&&d!==e;){var c=d.nodeName.toUpperCase();if(h.test(c))return d;d=d.parentNode}return null},BlockTagNames:/^(?:P|DIV|H1|H2|H3|H4|H5|H6|ADDRESS|PRE|OL|UL|LI|DT|DE)$/,getBlockAncestor:function(d,h,e){e=e||d.ownerDocument.body;h=h||q.BlockTagNames;for(var c=null,b;d&&d!==e;){var a=d.nodeName.toUpperCase();!c&&h.test(a)&&(c=d);!b&&/^(?:BODY|TD|TH|CAPTION)$/.test(a)&&(b=d);d=d.parentNode}return{blockNode:c,blockContainer:b||d.ownerDocument.body}},atBeginningOfContainer:function(d,
h,e){var c=!1,b=0==e;b||3!=h.nodeType||/^[\s\xA0]+$/.test(h.nodeValue.substr(0,e))&&(b=!0);if(b)for(c=!0;h&&h!==d;){if(h.previousSibling){c=!1;break}h=h.parentNode}return c},atEndOfContainer:function(d,h,e){var c=!1,b=e==(h.length||h.childNodes.length);b||3!=h.nodeType||/^[\s\xA0]+$/.test(h.nodeValue.substr(e))&&(b=!0);if(b)for(c=!0;h&&h!==d;){if(h.nextSibling){c=!1;break}h=h.parentNode}return c},adjacentNoneTextNode:function(d,h){for(var e=d,c=0-d.length||0,b=h?"nextSibling":"previousSibling";e&&
3==e.nodeType;)c+=e.length,e=e[b];return[e,c]},create:function(d){d=d||window;return d.getSelection?d.document.createRange():new m},getSelection:function(d,h){if(d.getSelection)return d.getSelection();var e=new k.selection(d);h||e._getCurrentSelection();return e}};if(!window.getSelection)var k=q.ie={cachedSelection:{},selection:function(d){this._ranges=[];this.addRange=function(d,e){this._ranges.push(d);e||d._select();this.rangeCount=this._ranges.length};this.removeAllRanges=function(){this._ranges=
[];this.rangeCount=0};this.getRangeAt=function(d){return this._ranges[d]};this._getCurrentSelection=function(){this.removeAllRanges();var h;h=d.document.selection.createRange();h="CONTROL"==d.document.selection.type.toUpperCase()?new m(k.decomposeControlRange(h)):new m(k.decomposeTextRange(h));this.addRange(h,!0),this.isCollapsed=h.collapsed}},decomposeControlRange:function(d){var h=d.item(0),e=d.item(d.length-1);d=h.parentNode;var c=e.parentNode,h=q.getIndex(h,d).o[0],e=q.getIndex(e,c).o[0]+1;return[d,
h,c,e]},getEndPoint:function(d,h){var e=d.duplicate();e.collapse(!h);var c="EndTo"+(h?"End":"Start"),b=e.parentElement(),a,g,k;0<b.childNodes.length?r.every(b.childNodes,function(h,f){var l;if(3!=h.nodeType)if(e.moveToElementText(h),0<e.compareEndPoints(c,d))if(k&&3==k.nodeType)a=k,l=!0;else return a=b,g=f,!1;else{if(f==b.childNodes.length-1)return a=b,g=b.childNodes.length,!1}else f==b.childNodes.length-1&&(a=h,l=!0);if(l&&a){a=(l=q.adjacentNoneTextNode(a)[0])?l.nextSibling:b.firstChild;var n=q.adjacentNoneTextNode(a);
l=n[0];n=n[1];l?(e.moveToElementText(l),e.collapse(!1)):e.moveToElementText(b);e.setEndPoint(c,d);g=e.text.length-n;return!1}k=h;return!0}):(a=b,g=0);if(!h&&1==a.nodeType&&g==a.childNodes.length){var l=a.nextSibling;l&&3==l.nodeType&&(a=l,g=0)}return[a,g]},setEndPoint:function(d,h,e){d=d.duplicate();var c;if(3!=h.nodeType)if(0<e){if(c=h.childNodes[e-1])if(3==c.nodeType)h=c,e=c.length;else if(c.nextSibling&&3==c.nextSibling.nodeType)h=c.nextSibling,e=0;else{d.moveToElementText(c.nextSibling?c:h);var b=
c.parentNode;c=b.insertBefore(c.ownerDocument.createTextNode(" "),c.nextSibling);d.collapse(!1);b.removeChild(c)}}else d.moveToElementText(h),d.collapse(!0);3==h.nodeType&&(c=q.adjacentNoneTextNode(h),b=c[0],c=c[1],b?(d.moveToElementText(b),d.collapse(!1),"inherit"!=b.contentEditable&&c++):(d.moveToElementText(h.parentNode),d.collapse(!0),d.move("character",1),d.move("character",-1)),e+=c,0<e&&d.move("character",e)!=e&&console.error("Error when moving!"));return d},decomposeTextRange:function(d){var h=
k.getEndPoint(d),e=h[0],c=h[1],b=h[0],h=h[1];d.htmlText.length&&(d.htmlText==d.text?h=c+d.text.length:(h=k.getEndPoint(d,!0),b=h[0],h=h[1]));return[e,c,b,h]},setRange:function(d,h,e,c,b,a){h=k.setEndPoint(d,h,e);d.setEndPoint("StartToStart",h);if(!a)var g=k.setEndPoint(d,c,b);d.setEndPoint("EndToEnd",g||h);return d}},m=q.W3CRange=l(null,{constructor:function(){0<arguments.length?(this.setStart(arguments[0][0],arguments[0][1]),this.setEnd(arguments[0][2],arguments[0][3])):(this.startContainer=this.commonAncestorContainer=
null,this.startOffset=0,this.endContainer=null,this.endOffset=0,this.collapsed=!0)},_updateInternal:function(){this.commonAncestorContainer=this.startContainer!==this.endContainer?q.getCommonAncestor(this.startContainer,this.endContainer):this.startContainer;this.collapsed=this.startContainer===this.endContainer&&this.startOffset==this.endOffset},setStart:function(d,h){h=parseInt(h);if(this.startContainer!==d||this.startOffset!=h)delete this._cachedBookmark,this.startContainer=d,this.startOffset=
h,this.endContainer?this._updateInternal():this.setEnd(d,h)},setEnd:function(d,h){h=parseInt(h);if(this.endContainer!==d||this.endOffset!=h)delete this._cachedBookmark,this.endContainer=d,this.endOffset=h,this.startContainer?this._updateInternal():this.setStart(d,h)},setStartAfter:function(d,h){this._setPoint("setStart",d,h,1)},setStartBefore:function(d,h){this._setPoint("setStart",d,h,0)},setEndAfter:function(d,h){this._setPoint("setEnd",d,h,1)},setEndBefore:function(d,h){this._setPoint("setEnd",
d,h,0)},_setPoint:function(d,h,e,c){e=q.getIndex(h,h.parentNode).o;this[d](h.parentNode,e.pop()+c)},_getIERange:function(){var d=(this._body||this.endContainer.ownerDocument.body).createTextRange();k.setRange(d,this.startContainer,this.startOffset,this.endContainer,this.endOffset,this.collapsed);return d},getBookmark:function(){this._getIERange();return this._cachedBookmark},_select:function(){this._getIERange().select()},deleteContents:function(){var d=this.startContainer,h=this._getIERange();3!==
d.nodeType||this.startOffset||this.setStartBefore(d);h.pasteHTML("");this.endContainer=this.startContainer;this.endOffset=this.startOffset;this.collapsed=!0},cloneRange:function(){var d=new m([this.startContainer,this.startOffset,this.endContainer,this.endOffset]);d._body=this._body;return d},detach:function(){this.startContainer=this.commonAncestorContainer=this._body=null;this.startOffset=0;this.endContainer=null;this.endOffset=0;this.collapsed=!0}});d.setObject("dijit.range",q);return q})},"dijit/_editor/html":function(){define(["dojo/_base/array",
"dojo/_base/lang","dojo/sniff"],function(r,l,d){var q={};l.setObject("dijit._editor.html",q);var k=q.escapeXml=function(d,k){d=d.replace(/&/gm,"\x26amp;").replace(/</gm,"\x26lt;").replace(/>/gm,"\x26gt;").replace(/"/gm,"\x26quot;");k||(d=d.replace(/'/gm,"\x26#39;"));return d};q.getNodeHtml=function(d){var k=[];q.getNodeHtmlHelper(d,k);return k.join("")};q.getNodeHtmlHelper=function(l,p){switch(l.nodeType){case 1:var h=l.nodeName.toLowerCase();if(!h||"/"==h.charAt(0))return"";p.push("\x3c",h);var e=
[],c={},b;if(d("dom-attributes-explicit")||d("dom-attributes-specified-flag"))for(var a=0;b=l.attributes[a++];){var g=b.name;"_dj"===g.substr(0,3)||d("dom-attributes-specified-flag")&&!b.specified||g in c||(b=b.value,("src"==g||"href"==g)&&l.getAttribute("_djrealurl")&&(b=l.getAttribute("_djrealurl")),8===d("ie")&&"style"===g&&(b=b.replace("HEIGHT:","height:").replace("WIDTH:","width:")),e.push([g,b]),c[g]=b)}else{var m=(/^input$|^img$/i.test(l.nodeName)?l:l.cloneNode(!1)).outerHTML,c=m.match(/[\w-]+=("[^"]*"|'[^']*'|\S*)/gi),
m=m.substr(0,m.indexOf("\x3e"));r.forEach(c,function(a){if(a){var b=a.indexOf("\x3d");if(0<b&&(a=a.substring(0,b),"_dj"!=a.substr(0,3)))if("src"!=a&&"href"!=a||!l.getAttribute("_djrealurl")){var c;switch(a){case "style":c=l.style.cssText.toLowerCase();break;case "class":c=l.className;break;case "width":if("img"===h){(b=/width=(\S+)/i.exec(m))&&(c=b[1]);break}case "height":if("img"===h){(b=/height=(\S+)/i.exec(m))&&(c=b[1]);break}default:c=l.getAttribute(a)}null!=c&&e.push([a,c.toString()])}else e.push([a,
l.getAttribute("_djrealurl")])}},this)}e.sort(function(a,b){return a[0]<b[0]?-1:a[0]==b[0]?0:1});for(c=0;b=e[c++];)p.push(" ",b[0],'\x3d"',"string"===typeof b[1]?k(b[1],!0):b[1],'"');switch(h){case "br":case "hr":case "img":case "input":case "base":case "meta":case "area":case "basefont":p.push(" /\x3e");break;case "script":p.push("\x3e",l.innerHTML,"\x3c/",h,"\x3e");break;default:p.push("\x3e"),l.hasChildNodes()&&q.getChildrenHtmlHelper(l,p),p.push("\x3c/",h,"\x3e")}break;case 4:case 3:p.push(k(l.nodeValue,
!0));break;case 8:p.push("\x3c!--",k(l.nodeValue,!0),"--\x3e");break;default:p.push("\x3c!-- Element not recognized - Type: ",l.nodeType," Name: ",l.nodeName,"--\x3e")}};q.getChildrenHtml=function(d){var k=[];q.getChildrenHtmlHelper(d,k);return k.join("")};q.getChildrenHtmlHelper=function(k,l){if(k)for(var h=k.childNodes||k,e=!d("ie")||h!==k,c,b=0;c=h[b++];)e&&c.parentNode!=k||q.getNodeHtmlHelper(c,l)};return q})},"esri/dijit/ColorPicker":function(){define("../Color ../kernel ./_EventedWidget ./_Tooltip ./ColorPicker/colorUtil ./ColorPicker/HexPalette dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dojo/_base/array dojo/_base/declare dojo/_base/lang dojo/dom-class dojo/dom-construct dojo/on dojo/query dojo/sniff dojo/dom-style dojo/i18n!../nls/jsapi dojo/text!./ColorPicker/templates/ColorPicker.html ./HorizontalSlider dijit/form/RadioButton dijit/form/TextBox dijit/form/ToggleButton dojo/NodeList-dom".split(" "),
function(r,l,d,q,k,m,p,h,e,c,b,a,g,u,n,t,f,v,x){l=c("esri.dijit.ColorPicker",[d,p,h,q],{_DEFAULT_COLORS_PER_ROW:13,templateString:x,labels:v.widgets.colorPicker,baseClass:"esriColorPicker",css:{container:"esriContainer",header:"esriHeader",footer:"esriFooter",middle:"esriMiddle",swatch:"esriSwatch",swatchRow:"esriSwatchRow",swatchEmpty:"esriSwatchEmpty",swatchPreview:"esriSwatchPreview",swatchTransparencyBackground:"esriSwatchTransparencyBackground",palette:"esriPalette",paletteOptions:"esriPaletteOptions",
paletteToggle:"esriPaletteToggle",label:"esriLabel",hexInput:"esriHexInput",recent:"esriRecent",suggested:"esriSuggested",selected:"esriSelected",disabled:"esriDisabled",section:"esriSection",displayNone:"esriDisplayNone",transparencySlider:"esriTransparencySlider",alt:"esriAlt"},color:null,trackColors:!0,_required:!1,_activePalette:null,recentColors:[],_showRecentColors:!0,_showTransparencySlider:!0,colorsPerRow:void 0,_brightsPalette:null,_pastelsPalette:null,_swatches:null,_colorInstance:null,
_swatchCreator:null,_noColorSwatchNode:null,constructor:function(a,b){a=a||{};this._colorInstance=new r;this._brightsPalette=new m({colors:a.palette});this._pastelsPalette=new m({colors:this._toPastels(this._brightsPalette.get("colors"))});this._activePalette=this._brightsPalette;this._swatchCreator=a.swatchCreator||this._createSwatch;a.hasOwnProperty("required")&&(this._required=a.required);a.hasOwnProperty("showRecentColors")&&(this._showRecentColors=a.showRecentColors);a.hasOwnProperty("showSuggestedColors")&&
(this._showSuggestedColors=a.showSuggestedColors);a.hasOwnProperty("showTransparencySlider")&&(this._showTransparencySlider=a.showTransparencySlider);a.color&&(a.color=k.normalizeColor(a.color));this.colorsPerRow=0<a.colorsPerRow?a.colorsPerRow:this._DEFAULT_COLORS_PER_ROW;this._swatches={}},_toPastels:function(a){var b=this._colorInstance,c=new r([238,238,238]);return e.map(a,function(a){return r.blendColors(b.setColor(a),c,.2)},this)},_createSwatch:function(a){return g.create("span",{className:a.className,
style:{background:a.hexColor||"transparent"}},a.paletteNode)},_createSwatches:function(a,b){var c=this.css.swatch,d=this.css.swatchRow,f=this.colorsPerRow,h=b.get("colors"),k,l;e.forEach(h,function(b,e){0===e%f&&(k=g.create("div",{className:d},a));l=this._swatchCreator({className:c,hexColor:b,paletteNode:k});this._swatches[b]=l},this)},_selectColor:function(){var a=this.color||this._activePalette.get("colors")[0];this.set("color",a)},_setColorWithCurrentAlpha:function(a){"no-color"!==a&&"no-color"!==
this.color&&(a=k.normalizeColor(a),a.a=this.color.a);this.set("color",a)},_updatePreviewSwatch:function(b){var c=this.css.swatchEmpty,d=this.dap_previewSwatch,e,g;"no-color"===b?(a.add(d,c),f.set(d,{backgroundColor:"",borderColor:""})):(e=k.getContrastingColor(b),g=8!==t("ie"),a.remove(d,c),c=b.toCss(g),e=e.toCss(g),e={backgroundColor:c,borderColor:e},g||(e.opacity=b.a),f.set(d,e))},_showBrights:function(){a.remove(this.dap_paletteContainer,this.css.alt);this._activePalette=this._brightsPalette},
_showPastels:function(){a.add(this.dap_paletteContainer,this.css.alt);this._activePalette=this._pastelsPalette},_setColorFromSwatch:function(a){a=f.get(a,"backgroundColor");this._setColorWithCurrentAlpha(a)},_checkSelection:function(){var a=this.get("color");this._activePalette.contains(a)?this._highlightColor(a):this._clearSelection()},_addListeners:function(){var a="."+this.css.swatch;this.own(u(this.dap_paletteContainer,u.selector(a,"click"),b.hitch(this,function(a){this._setColorFromSwatch(a.target)})));
this.own(u(this.dap_recentColorPalette,u.selector(a,"click"),b.hitch(this,function(a){this._setColorFromSwatch(a.target)})));this.own(u(this.dap_suggestedColorPalette,u.selector(a,"click"),b.hitch(this,function(a){this._setColorFromSwatch(a.target)})));this._required||this.own(u(this._noColorSwatchNode,"click",b.hitch(this,function(a){this.set("color","no-color")})));var c=this.dap_hexInput;c.on("blur",b.hitch(this,function(){var a=k.normalizeHex(c.get("value"));k.isShorthandHex(a)?this._setColorWithCurrentAlpha(a):
this._silentlyUpdateHexInput(this.color)}));c.on("change",b.hitch(this,function(){var a=k.normalizeHex(c.get("value"));k.isLonghandHex(a)&&("no-color"!==this.color&&this.color.toHex()===a||this._setColorWithCurrentAlpha(a))}));this.dap_transparencySlider.on("change",b.hitch(this,function(a){var b=this.get("color");"no-color"!==b&&(b=k.normalizeColor(this._colorInstance.setColor(b)),b.a=1-a,this._updatePreviewSwatch(b),this._silentlyUpdateHexInput(b),this.set("color",b))}));this.dap_paletteToggle.on("change",
b.hitch(this,this._togglePalette))},_togglePalette:function(a){this.dap_paletteToggle.set("checked",a,!1);a?this._showPastels():this._showBrights();this._checkSelection()},postCreate:function(){this.inherited(arguments);this._addListeners();this._selectColor();this.dap_hexInput.intermediateChanges=!0;this.dap_transparencySlider.intermediateChanges=!0;this.createTooltips([{node:this.dap_paletteContainer,label:this.labels.paletteTooltip},{node:this.dap_hexInput,label:this.labels.hexInputTooltip},{node:this._noColorSwatchNode,
label:this.labels.noColorTooltip},{node:this.dap_paletteToggle,label:this.labels.moreColorsTooltip}])},buildRendering:function(){this.inherited(arguments);this._createPalettes();var b=this.css.swatch,c=this.css.swatchEmpty;this._required||(this._noColorSwatchNode=g.create("div",{className:b+" "+c},this.dap_hexInput.domNode,"after"));b=this.css.displayNone;this._showTransparencySlider||a.add(this.dap_transparencySection,b);this._showRecentColors||a.add(this.dap_recentColorSection,b);this._showSuggestedColors||
a.add(this.dap_suggestedColorSection,b)},_createPalettes:function(){this._swatches={};g.empty(this.dap_primaryPalette);g.empty(this.dap_secondaryPalette);this._createSwatches(this.dap_primaryPalette,this._brightsPalette);this._createSwatches(this.dap_secondaryPalette,this._pastelsPalette)},_silentlyUpdateHexInput:function(a){a="no-color"===a?"":a.toHex();this._silentlyUpdateIntermediateChangingValueWidget(this.dap_hexInput,a)},_silentlyUpdateIntermediateChangingValueWidget:function(a,b){a.intermediateChanges=
!1;a.set("value",b,!1);a.intermediateChanges=!0},addRecentColor:function(a){a&&"no-color"!==a&&this._addRecentColor(k.normalizeColor(a).toHex())},_addRecentColor:function(a){if(a){var b=this.recentColors,c=e.indexOf(b,a);-1<c&&b.splice(c,1);b.unshift(a);b.length>this.colorsPerRow&&b.pop();this._renderRecentSwatches()}},_renderRecentSwatches:function(){if(this.recentColors){var a=this.css.recent,b=this.css.swatch,c=n("."+a+"."+b,this.dap_recentColorPalette);e.forEach(this.recentColors,function(d,e){if(e<
this.colorsPerRow){if(e+1>c.length){var g=this._swatchCreator({hexColor:d,className:b+" "+a,paletteNode:this.dap_recentColorPalette});c.push(g)}f.set(c[e],"backgroundColor",d)}},this)}},_renderSuggestedSwatches:function(){if(this.suggestedColors){var a=this.css.suggested,b=this.css.swatch,c=n("."+a+"."+b,this.dap_recentColorPalette);e.forEach(this.suggestedColors,function(d,e){if(e<this.colorsPerRow){if(e+1>c.length){var g=this._swatchCreator({hexColor:d,className:b+" "+a,paletteNode:this.dap_suggestedColorPalette});
c.push(g)}f.set(c[e],"backgroundColor",d)}},this)}},_clearRecentSwatches:function(){g.empty(this.dap_recentColorPalette)},_clearSuggestedSwatches:function(){g.empty(this.dap_suggestedColorPalette)},_clearSelection:function(){var a=this.css.selected;n("."+a,this.dap_paletteContainer).removeClass(a)},_highlightColor:function(b){var c=this.css.selected,d=this._findColorSwatch(b);d&&(b=k.normalizeColor(b),b=k.getContrastingColor(b),a.add(d,c),f.set(d,"borderColor",b.toHex()))},_findColorSwatch:function(a){var b=
this._activePalette.get("colors");a=this._colorInstance.setColor(a).toHex();var c;-1<e.indexOf(b,a)&&(c=this._swatches[a]);return c},_getColorAttr:function(){return"no-color"===this.color?"no-color":new r(this.color)},_previousColor:null,_enableTransparencySlider:function(){a.remove(this.dap_transparencyLabel,this.css.disabled);this.dap_transparencySlider.set("disabled",!1)},_disableTransparencySlider:function(){a.add(this.dap_transparencyLabel,this.css.disabled);this.dap_transparencySlider.set("disabled",
!0)},_setColorAttr:function(b,c){b=b||"no-color";c=c||void 0===c;if(!this._required){if("no-color"===b){this._set("color","no-color");this._previousColor="no-color";this._disableTransparencySlider();this._clearSelection();this._silentlyUpdateHexInput("no-color");this._updatePreviewSwatch(b);a.add(this._noColorSwatchNode,this.css.selected);c&&this.emit("color-change",{color:"no-color"});return}this._enableTransparencySlider();a.remove(this._noColorSwatchNode,this.css.selected)}var d=k.normalizeColor(b),
e=this._previousColor,g=this._colorInstance,h=this.css.selected;if(e){if(k.equal(e,d))return;if(e=this._findColorSwatch(e))a.remove(e,h),f.set(e,"borderColor","")}g.setColor(d);h=g.toHex();this._set("color",new r(g));this._previousColor=d;this._silentlyUpdateIntermediateChangingValueWidget(this.dap_transparencySlider,1-g.a);this._updatePreviewSwatch(g);this._checkSelection();this._silentlyUpdateHexInput(g);this.trackColors&&this._addRecentColor(h);c&&this.emit("color-change",{color:new r(g)})},_getRecentColorsAttr:function(){return e.map(this.recentColors,
function(a){return k.normalizeColor(a)})},_setRecentColorsAttr:function(a){this.recentColors=a||[];this._showRecentColors&&(this.recentColors=e.map(this.recentColors,function(a){return k.normalizeColor(a).toHex()}));0===this.recentColors.length?this._clearRecentSwatches():this._renderRecentSwatches()},suggestedColors:null,_getSuggestedColorsAttr:function(){return e.map(this.suggestedColors,function(a){return k.normalizeColor(a)})},_setSuggestedColorsAttr:function(a){this._showSuggestedColors&&(this._clearSuggestedSwatches(),
this.suggestedColors=a||[],this.suggestedColors=e.map(this.suggestedColors,function(a){return k.normalizeColor(a).toHex()}),0<this.suggestedColors.length&&this._renderSuggestedSwatches())},_setPaletteAttr:function(a){var b=this._activePalette===this._brightsPalette;this._brightsPalette.set("colors",a);this._pastelsPalette.set("colors",this._toPastels(this._brightsPalette.get("colors")));this._activePalette=b?this._brightsPalette:this._pastelsPalette;this._createPalettes();this._togglePalette(!b)},
saveRecentColors:function(a){localStorage.setItem(a,JSON.stringify(this.get("recentColors")))},loadRecentColors:function(a){this.set("recentColors",JSON.parse(localStorage.getItem(a)))}});l.NO_COLOR="no-color";return l})},"esri/dijit/_Tooltip":function(){define(["dijit/Tooltip","dojo/_base/array","dojo/_base/declare","dojo/_base/lang","dojo/dom"],function(r,l,d,q,k){return d(null,{declaredClass:"esri.dijit._Tooltip",_tooltips:null,constructor:function(){this._tooltips=[]},startup:function(){this.inherited(arguments);
this._started||l.forEach(this._tooltips,function(d){d.startup()})},destroy:function(){this.inherited(arguments);l.forEach(this._tooltips,function(d){d.destroy()});this._tooltips=null},createTooltips:function(d){l.forEach(d,function(d){this.createTooltip(d.node,d.label)},this)},createTooltip:function(d,k){var h=this._getConnectId(d);h&&(h="object"===typeof k?q.mixin({},k,{connectId:h}):{connectId:h,label:k},h=new r(h),this._started&&h.startup(),this._tooltips.push(h))},_getConnectId:function(d){var k,
h;if(d){if(q.isArray(d)){if(k=[],l.forEach(d,function(d){(h=this._getNode(d))&&k.push(h)}),0===k.length)return}else if(k=this._getNode(d),!k)return;return k}},_getNode:function(d){return k.byId(d.domNode||d)},findTooltip:function(d){var k=this._getNode(d),h,e,c;if(d){d=this._tooltips;h=d.length;for(var b=0;b<h;b++)if(e=d[b],c=q.isArray(e.connectId)?-1<l.indexOf(e.connectId,k):e.connectId===k)return e}}})})},"esri/dijit/ColorPicker/colorUtil":function(){define(["dojo/_base/lang","../../Color"],function(r,
l){var d={equal:function(d,k){return d&&k&&d.r===k.r&&d.g===k.g&&d.b===k.b&&d.a===k.a},normalizeHex:function(d){return"#"+r.trim(d).replace(/#/g,"").substr(0,6)},normalizeColor:function(d){return new l(d)},isValidHex:function(l){return d.isShorthandHex(l)||d.isLonghandHex(l)},_shortHandHex:/^#[0-9A-F]{3}$/i,isShorthandHex:function(l){return l&&4===l.length&&d._shortHandHex.test(l)},_longhandHex:/^#[0-9A-F]{6}$/i,isLonghandHex:function(l){return l&&7===l.length&&d._longhandHex.test(l)},getContrastingColor:function(l){return d.isBright(l)?
this.darker(l):this.brighter(l,3)},isBright:function(d){return 127<=.299*d.r+.587*d.g+.114*d.b},darker:function(d,k){var m=Math.pow(.7,k?k:1);return new l([Math.round(d.r*m),Math.round(d.g*m),Math.round(d.b*m),d.a])},brighter:function(d,k){var m=Math.pow(.7,k?k:1),p=d.r,h=d.g,e=d.b;30>p&&(p=30);30>h&&(h=30);30>e&&(e=30);return new l([Math.min(255,Math.round(p/m)),Math.min(255,Math.round(h/m)),Math.min(255,Math.round(e/m)),d.a])}};return d})},"esri/dijit/ColorPicker/HexPalette":function(){define(["dojo/_base/array",
"dojo/_base/Color","dojo/_base/declare","dojo/Stateful"],function(r,l,d,q){var k="#ffffff #858585 #ffbebe #ffebbe #ffebaf #ffffbe #e9ffbe #d3ffbe #beffe8 #bee8ff #bed2ff #e8beff #ffbee8 #ebebeb #707070 #ff7f7f #ffa77f #ffd37f #ffff73 #d1ff73 #a3ff73 #73ffdf #73dfff #73b2ff #df73ff #ff73df #d6d6d6 #5c5c5c #ff0000 #ff5500 #ffaa00 #ffff00 #aaff00 #55ff00 #00ffc5 #00c5ff #0070ff #c500ff #ff00c5 #c2c2c2 #474747 #e60000 #e64c00 #e69800 #e6e600 #98e600 #4ce600 #00e6a9 #00a9e6 #005ce6 #a900e6 #e600a9 #adadad #242424 #a80000 #a83800 #a87000 #a8a800 #70a800 #38a800 #00a884 #0084a8 #004da8 #8400a8 #a80084 #999999 #1a1a1a #730000 #732600 #734c00 #737300 #4c7300 #267300 #00734c #004c73 #002673 #4c0073 #73004c".split(" ");
l=d([q],{constructor:function(d){d=d||{};this.set("colors",d.colors)},_colorInstance:new l,_colors:null,_colorsGetter:function(){return this._colors},_colorsSetter:function(d){d=d?d:k;this._colors=this._normalizeColors(d)},_normalizeColors:function(d){var k=this._colorInstance;return r.map(d,function(d){return k.setColor(d).toHex()},this)},contains:function(d){var k=this._colorInstance;k.setColor(d);return-1<r.indexOf(this._colors,k.toHex())}});l.DEFAULT_COLORS=k;return l})},"esri/dijit/HorizontalSlider":function(){define("dijit/form/HorizontalRuleLabels dijit/form/HorizontalSlider dojo/_base/declare dojo/_base/lang dojo/has ../kernel".split(" "),
function(r,l,d,q,k,m){return d("esri.dijit.HorizontalSlider",l,{baseClass:"esriHorizontalSlider",showButtons:!1,labels:null,constructor:function(d){d=d||{};d.labels&&(this.labels=d.labels)},buildRendering:function(){this.inherited(arguments);this.labels&&(new r({labels:this.labels})).placeAt(this.bottomDecoration)}})})},"dijit/form/HorizontalRuleLabels":function(){define("dojo/_base/declare dojo/has dojo/number dojo/query dojo/_base/lang ./HorizontalRule".split(" "),function(r,l,d,q,k,m){r=r("dijit.form.HorizontalRuleLabels",
m,{templateString:'\x3cdiv class\x3d"dijitRuleContainer dijitRuleContainerH dijitRuleLabelsContainer dijitRuleLabelsContainerH"\x3e\x3c/div\x3e',labelStyle:"",labels:[],numericMargin:0,minimum:0,maximum:1,constraints:{pattern:"#%"},_positionPrefix:'\x3cdiv class\x3d"dijitRuleLabelContainer dijitRuleLabelContainerH" style\x3d"left:',_labelPrefix:'"\x3e\x3cdiv class\x3d"dijitRuleLabel dijitRuleLabelH"\x3e',_suffix:"\x3c/div\x3e\x3c/div\x3e",_calcPosition:function(d){return d},_genHTML:function(d,h){var e=
this.labels[h];return this._positionPrefix+this._calcPosition(d)+this._positionSuffix+this.labelStyle+this._genDirectionHTML(e)+this._labelPrefix+e+this._suffix},_genDirectionHTML:function(d){return""},getLabels:function(){var k=this.labels;!k.length&&this.srcNodeRef&&(k=q("\x3e li",this.srcNodeRef).map(function(b){return String(b.innerHTML)}));if(!k.length&&1<this.count)for(var k=[],h=this.minimum,e=(this.maximum-h)/(this.count-1),c=0;c<this.count;c++)k.push(c<this.numericMargin||c>=this.count-this.numericMargin?
"":d.format(h,this.constraints)),h+=e;return k},postMixInProperties:function(){this.inherited(arguments);this.labels=this.getLabels();this.count=this.labels.length}});l("dojo-bidi")&&r.extend({_setTextDirAttr:function(d){this.textDir!=d&&(this._set("textDir",d),q(".dijitRuleLabelContainer",this.domNode).forEach(k.hitch(this,function(d){d.style.direction=this.getTextDir(d.innerText||d.textContent||"")})))},_genDirectionHTML:function(d){return this.textDir?"direction:"+this.getTextDir(d)+";":""}});
return r})},"dijit/form/HorizontalRule":function(){define(["dojo/_base/declare","../_Widget","../_TemplatedMixin"],function(r,l,d){return r("dijit.form.HorizontalRule",[l,d],{templateString:'\x3cdiv class\x3d"dijitRuleContainer dijitRuleContainerH"\x3e\x3c/div\x3e',count:3,container:"containerNode",ruleStyle:"",_positionPrefix:'\x3cdiv class\x3d"dijitRuleMark dijitRuleMarkH" style\x3d"left:',_positionSuffix:"%;",_suffix:'"\x3e\x3c/div\x3e',_genHTML:function(d){return this._positionPrefix+d+this._positionSuffix+
this.ruleStyle+this._suffix},_isHorizontal:!0,buildRendering:function(){this.inherited(arguments);var d;if(1==this.count)d=this._genHTML(50,0);else{var k,l=100/(this.count-1);if(!this._isHorizontal||this.isLeftToRight()){d=this._genHTML(0,0);for(k=1;k<this.count-1;k++)d+=this._genHTML(l*k,k);d+=this._genHTML(100,this.count-1)}else{d=this._genHTML(100,0);for(k=1;k<this.count-1;k++)d+=this._genHTML(100-l*k,k);d+=this._genHTML(0,this.count-1)}}this.domNode.innerHTML=d}})})},"dijit/form/HorizontalSlider":function(){define("dojo/_base/array dojo/_base/declare dojo/dnd/move dojo/_base/fx dojo/dom-geometry dojo/dom-style dojo/keys dojo/_base/lang dojo/sniff dojo/dnd/Moveable dojo/dnd/Mover dojo/query dojo/mouse dojo/on ../_base/manager ../focus ../typematic ./Button ./_FormValueWidget ../_Container dojo/text!./templates/HorizontalSlider.html".split(" "),
function(r,l,d,q,k,m,p,h,e,c,b,a,g,u,n,t,f,v,x,w,z){var A=l("dijit.form._SliderMover",b,{onMouseMove:function(a){var b=this.widget,c=b._abspos;c||(c=b._abspos=k.position(b.sliderBarContainer,!0),b._setPixelValue_=h.hitch(b,"_setPixelValue"),b._isReversed_=b._isReversed());a=a[b._mousePixelCoord]-c[b._startingPixelCoord];b._setPixelValue_(b._isReversed_?c[b._pixelCount]-a:a,c[b._pixelCount],!1)},destroy:function(a){b.prototype.destroy.apply(this,arguments);var c=this.widget;c._abspos=null;c._setValueAttr(c.value,
!0)}});d=l("dijit.form.HorizontalSlider",[x,w],{templateString:z,value:0,showButtons:!0,minimum:0,maximum:100,discreteValues:Infinity,pageIncrement:2,clickSelect:!0,slideDuration:n.defaultDuration,_setIdAttr:"",_setNameAttr:"valueNode",baseClass:"dijitSlider",cssStateNodes:{incrementButton:"dijitSliderIncrementButton",decrementButton:"dijitSliderDecrementButton",focusNode:"dijitSliderThumb"},_mousePixelCoord:"pageX",_pixelCount:"w",_startingPixelCoord:"x",_handleOffsetCoord:"left",_progressPixelSize:"width",
_onKeyUp:function(a){this.disabled||this.readOnly||a.altKey||a.ctrlKey||a.metaKey||this._setValueAttr(this.value,!0)},_onKeyDown:function(a){if(!(this.disabled||this.readOnly||a.altKey||a.ctrlKey||a.metaKey)){switch(a.keyCode){case p.HOME:this._setValueAttr(this.minimum,!1);break;case p.END:this._setValueAttr(this.maximum,!1);break;case this._descending||this.isLeftToRight()?p.RIGHT_ARROW:p.LEFT_ARROW:case !1===this._descending?p.DOWN_ARROW:p.UP_ARROW:case !1===this._descending?p.PAGE_DOWN:p.PAGE_UP:this.increment(a);
break;case this._descending||this.isLeftToRight()?p.LEFT_ARROW:p.RIGHT_ARROW:case !1===this._descending?p.UP_ARROW:p.DOWN_ARROW:case !1===this._descending?p.PAGE_UP:p.PAGE_DOWN:this.decrement(a);break;default:return}a.stopPropagation();a.preventDefault()}},_onHandleClick:function(a){this.disabled||this.readOnly||(e("ie")||t.focus(this.sliderHandle),a.stopPropagation(),a.preventDefault())},_isReversed:function(){return!this.isLeftToRight()},_onBarClick:function(a){if(!this.disabled&&!this.readOnly&&
this.clickSelect){t.focus(this.sliderHandle);a.stopPropagation();a.preventDefault();var b=k.position(this.sliderBarContainer,!0),c=a[this._mousePixelCoord]-b[this._startingPixelCoord];this._setPixelValue(this._isReversed()?b[this._pixelCount]-c:c,b[this._pixelCount],!0);this._movable.onMouseDown(a)}},_setPixelValue:function(a,b,c){if(!this.disabled&&!this.readOnly){var d=this.discreteValues;if(1>=d||Infinity==d)d=b;d--;this._setValueAttr(Math.max(Math.min((this.maximum-this.minimum)*Math.round(a/
(b/d))/d+this.minimum,this.maximum),this.minimum),c)}},_setValueAttr:function(a,b){this._set("value",a);this.valueNode.value=a;this.focusNode.setAttribute("aria-valuenow",a);this.inherited(arguments);var c=this.maximum>this.minimum?(a-this.minimum)/(this.maximum-this.minimum):0,d=!1===this._descending?this.remainingBar:this.progressBar,e=!1===this._descending?this.progressBar:this.remainingBar;this._inProgressAnim&&"stopped"!=this._inProgressAnim.status&&this._inProgressAnim.stop(!0);if(b&&0<this.slideDuration&&
d.style[this._progressPixelSize]){var f=this,g={},h=parseFloat(d.style[this._progressPixelSize]),k=this.slideDuration*(c-h/100);0!=k&&(0>k&&(k=0-k),g[this._progressPixelSize]={start:h,end:100*c,units:"%"},this._inProgressAnim=q.animateProperty({node:d,duration:k,onAnimate:function(a){e.style[f._progressPixelSize]=100-parseFloat(a[f._progressPixelSize])+"%"},onEnd:function(){delete f._inProgressAnim},properties:g}),this._inProgressAnim.play())}else d.style[this._progressPixelSize]=100*c+"%",e.style[this._progressPixelSize]=
100*(1-c)+"%"},_bumpValue:function(a,b){if(!(this.disabled||this.readOnly||this.maximum<=this.minimum)){var c=m.getComputedStyle(this.sliderBarContainer),d=k.getContentBox(this.sliderBarContainer,c),c=this.discreteValues;if(1>=c||Infinity==c)c=d[this._pixelCount];c--;d=Math.round((this.value-this.minimum)*c/(this.maximum-this.minimum))+a;0>d&&(d=0);d>c&&(d=c);d=d*(this.maximum-this.minimum)/c+this.minimum;this._setValueAttr(d,b)}},_onClkBumper:function(a){this.disabled||this.readOnly||!this.clickSelect||
this._setValueAttr(a,!0)},_onClkIncBumper:function(){this._onClkBumper(!1===this._descending?this.minimum:this.maximum)},_onClkDecBumper:function(){this._onClkBumper(!1===this._descending?this.maximum:this.minimum)},decrement:function(a){this._bumpValue(a.keyCode==p.PAGE_DOWN?-this.pageIncrement:-1)},increment:function(a){this._bumpValue(a.keyCode==p.PAGE_UP?this.pageIncrement:1)},_mouseWheeled:function(a){this.focused&&(a.stopPropagation(),a.preventDefault(),this._bumpValue(0>a.wheelDelta?-1:1,!0))},
startup:function(){this._started||(r.forEach(this.getChildren(),function(a){this[a.container]!=this.containerNode&&this[a.container].appendChild(a.domNode)},this),this.inherited(arguments))},_typematicCallback:function(a,b,c){if(-1==a)this._setValueAttr(this.value,!0);else this[b==(this._descending?this.incrementButton:this.decrementButton)?"decrement":"increment"](c)},buildRendering:function(){this.inherited(arguments);this.showButtons&&(this.incrementButton.style.display="",this.decrementButton.style.display=
"");var b=a('label[for\x3d"'+this.id+'"]');b.length&&(b[0].id||(b[0].id=this.id+"_label"),this.focusNode.setAttribute("aria-labelledby",b[0].id));this.focusNode.setAttribute("aria-valuemin",this.minimum);this.focusNode.setAttribute("aria-valuemax",this.maximum)},postCreate:function(){this.inherited(arguments);this.showButtons&&this.own(f.addMouseListener(this.decrementButton,this,"_typematicCallback",25,500),f.addMouseListener(this.incrementButton,this,"_typematicCallback",25,500));this.own(u(this.domNode,
g.wheel,h.hitch(this,"_mouseWheeled")));var a=l(A,{widget:this});this._movable=new c(this.sliderHandle,{mover:a});this._layoutHackIE7()},destroy:function(){this._movable.destroy();this._inProgressAnim&&"stopped"!=this._inProgressAnim.status&&this._inProgressAnim.stop(!0);this.inherited(arguments)}});d._Mover=A;return d})},"dijit/typematic":function(){define("dojo/_base/array dojo/_base/connect dojo/_base/lang dojo/on dojo/sniff ./main".split(" "),function(r,l,d,q,k,m){var p=m.typematic={_fireEventAndReload:function(){this._timer=
null;this._callback(++this._count,this._node,this._evt);this._currentTimeout=Math.max(0>this._currentTimeout?this._initialDelay:1<this._subsequentDelay?this._subsequentDelay:Math.round(this._currentTimeout*this._subsequentDelay),this._minDelay);this._timer=setTimeout(d.hitch(this,"_fireEventAndReload"),this._currentTimeout)},trigger:function(h,e,c,b,a,g,k,l){if(a!=this._obj){this.stop();this._initialDelay=k||500;this._subsequentDelay=g||.9;this._minDelay=l||10;this._obj=a;this._node=c;this._count=
this._currentTimeout=-1;this._callback=d.hitch(e,b);this._evt={faux:!0};for(var n in h)"layerX"!=n&&"layerY"!=n&&(e=h[n],"function"!=typeof e&&"undefined"!=typeof e&&(this._evt[n]=e));this._fireEventAndReload()}},stop:function(){this._timer&&(clearTimeout(this._timer),this._timer=null);this._obj&&(this._callback(-1,this._node,this._evt),this._obj=null)},addKeyListener:function(h,e,c,b,a,g,k){var n="keyCode"in e?"keyCode":"charCode"in e?"charCode":"charOrCode",m=[q(h,"keyCode"in e?"keydown":"charCode"in
e?"keypress":l._keypress,d.hitch(this,function(d){d[n]!=e[n]||void 0!==e.ctrlKey&&e.ctrlKey!=d.ctrlKey||void 0!==e.altKey&&e.altKey!=d.altKey||void 0!==e.metaKey&&e.metaKey!=(d.metaKey||!1)||void 0!==e.shiftKey&&e.shiftKey!=d.shiftKey?p._obj==e&&p.stop():(d.stopPropagation(),d.preventDefault(),p.trigger(d,c,h,b,e,a,g,k))})),q(h,"keyup",d.hitch(this,function(){p._obj==e&&p.stop()}))];return{remove:function(){r.forEach(m,function(a){a.remove()})}}},addMouseListener:function(h,e,c,b,a,g){var l=[q(h,
"mousedown",d.hitch(this,function(d){d.preventDefault();p.trigger(d,e,h,c,h,b,a,g)})),q(h,"mouseup",d.hitch(this,function(a){this._obj&&a.preventDefault();p.stop()})),q(h,"mouseout",d.hitch(this,function(a){this._obj&&a.preventDefault();p.stop()})),q(h,"dblclick",d.hitch(this,function(l){l.preventDefault();9>k("ie")&&(p.trigger(l,e,h,c,h,b,a,g),setTimeout(d.hitch(this,p.stop),50))}))];return{remove:function(){r.forEach(l,function(a){a.remove()})}}},addListener:function(d,e,c,b,a,g,k,l){var h=[this.addKeyListener(e,
c,b,a,g,k,l),this.addMouseListener(d,b,a,g,k,l)];return{remove:function(){r.forEach(h,function(a){a.remove()})}}}};return p})},"dijit/form/RadioButton":function(){define(["dojo/_base/declare","./CheckBox","./_RadioButtonMixin"],function(r,l,d){return r("dijit.form.RadioButton",[l,d],{baseClass:"dijitRadio"})})},"dijit/form/_RadioButtonMixin":function(){define("dojo/_base/array dojo/_base/declare dojo/dom-attr dojo/_base/lang dojo/query!css2 ../registry".split(" "),function(r,l,d,q,k,m){return l("dijit.form._RadioButtonMixin",
null,{type:"radio",_getRelatedWidgets:function(){var d=[];k("input[type\x3dradio]",this.focusNode.form||this.ownerDocument).forEach(q.hitch(this,function(h){h.name==this.name&&h.form==this.focusNode.form&&(h=m.getEnclosingWidget(h))&&d.push(h)}));return d},_setCheckedAttr:function(d){this.inherited(arguments);this._created&&d&&r.forEach(this._getRelatedWidgets(),q.hitch(this,function(d){d!=this&&d.checked&&d.set("checked",!1)}))},_getSubmitValue:function(d){return null==d?"on":d},_onClick:function(k){if(this.checked||
this.disabled)return k.stopPropagation(),k.preventDefault(),!1;if(this.readOnly)return k.stopPropagation(),k.preventDefault(),r.forEach(this._getRelatedWidgets(),q.hitch(this,function(c){d.set(this.focusNode||this.domNode,"checked",c.checked)})),!1;var h=!1,e;r.some(this._getRelatedWidgets(),function(c){return c.checked?(e=c,!0):!1});this.checked=!0;e&&(e.checked=!1);if(!1===this.onClick(k)||k.defaultPrevented)h=!0;this.checked=!1;e&&(e.checked=!0);h?k.preventDefault():this.set("checked",!0);return!h}})})},
"dijit/_editor/plugins/TextColor":function(){define("require dojo/colors dojo/_base/declare dojo/_base/lang ../_Plugin ../../form/DropDownButton".split(" "),function(r,l,d,q,k,m){var p=d("dijit._editor.plugins.TextColor",k,{buttonClass:m,colorPicker:"dijit/ColorPalette",useDefaultCommand:!1,_initButton:function(){this.command=this.name;this.inherited(arguments);var d=this;this.button.loadDropDown=function(e){function c(b){d.button.dropDown=new b({dir:d.editor.dir,ownerDocument:d.editor.ownerDocument,
value:d.value,onChange:function(a){d.editor.execCommand(d.command,a)},onExecute:function(){d.editor.execCommand(d.command,this.get("value"))}});e()}"string"==typeof d.colorPicker?r([d.colorPicker],c):c(d.colorPicker)}},updateState:function(){var d=this.editor,e=this.command;if(d&&d.isLoaded&&e.length){if(this.button){var c=this.get("disabled");this.button.set("disabled",c);if(c)return;var b;try{b=d.queryCommandValue(e)||""}catch(a){b=""}}""==b&&(b="#000000");"transparent"==b&&(b="#ffffff");"string"==
typeof b?-1<b.indexOf("rgb")&&(b=l.fromRgb(b).toHex()):(b=((b&255)<<16|b&65280|(b&16711680)>>>16).toString(16),b="#000000".slice(0,7-b.length)+b);this.value=b;(d=this.button.dropDown)&&d.get&&b!==d.get("value")&&d.set("value",b,!1)}}});k.registry.foreColor=function(d){return new p(d)};k.registry.hiliteColor=function(d){return new p(d)};return p})},"dojo/colors":function(){define(["./_base/kernel","./_base/lang","./_base/Color","./_base/array"],function(r,l,d,q){var k={};l.setObject("dojo.colors",
k);var m=function(d,e,c){0>c&&++c;1<c&&--c;var b=6*c;return 1>b?d+(e-d)*b:1>2*c?e:2>3*c?d+(e-d)*(2/3-c)*6:d};r.colorFromRgb=d.fromRgb=function(h,e){var c=h.toLowerCase().match(/^(rgba?|hsla?)\(([\s\.\-,%0-9]+)\)/);if(c){var b=c[2].split(/\s*,\s*/),a=b.length,c=c[1];if("rgb"==c&&3==a||"rgba"==c&&4==a)return c=b[0],"%"==c.charAt(c.length-1)?(c=q.map(b,function(a){return 2.56*parseFloat(a)}),4==a&&(c[3]=b[3]),d.fromArray(c,e)):d.fromArray(b,e);if("hsl"==c&&3==a||"hsla"==c&&4==a){var c=(parseFloat(b[0])%
360+360)%360/360,g=parseFloat(b[1])/100,k=parseFloat(b[2])/100,g=.5>=k?k*(g+1):k+g-k*g,k=2*k-g,c=[256*m(k,g,c+1/3),256*m(k,g,c),256*m(k,g,c-1/3),1];4==a&&(c[3]=b[3]);return d.fromArray(c,e)}}return null};var p=function(d,e,c){d=Number(d);return isNaN(d)?c:d<e?e:d>c?c:d};d.prototype.sanitize=function(){this.r=Math.round(p(this.r,0,255));this.g=Math.round(p(this.g,0,255));this.b=Math.round(p(this.b,0,255));this.a=p(this.a,0,1);return this};k.makeGrey=d.makeGrey=function(h,e){return d.fromArray([h,h,
h,e])};l.mixin(d.named,{aliceblue:[240,248,255],antiquewhite:[250,235,215],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],blanchedalmond:[255,235,205],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,
169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,
34],floralwhite:[255,250,240],forestgreen:[34,139,34],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,
250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,
104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],oldlace:[253,245,230],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,
192,203],plum:[221,160,221],powderblue:[176,224,230],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,
222,179],whitesmoke:[245,245,245],yellowgreen:[154,205,50]});return d})},"dijit/form/DropDownButton":function(){define("dojo/_base/declare dojo/_base/kernel dojo/_base/lang dojo/query ../registry ../popup ./Button ../_Container ../_HasDropDown dojo/text!./templates/DropDownButton.html ../a11yclick".split(" "),function(r,l,d,q,k,m,p,h,e,c){return r("dijit.form.DropDownButton",[p,h,e],{baseClass:"dijitDropDownButton",templateString:c,_fillContent:function(){var b=this.srcNodeRef,a=this.containerNode;
if(b&&a)for(;b.hasChildNodes();){var c=b.firstChild;c.hasAttribute&&(c.hasAttribute("data-dojo-type")||c.hasAttribute("dojoType")||c.hasAttribute("data-"+l._scopeName+"-type")||c.hasAttribute(l._scopeName+"Type"))?(this.dropDownContainer=this.ownerDocument.createElement("div"),this.dropDownContainer.appendChild(c)):a.appendChild(c)}},startup:function(){this._started||(!this.dropDown&&this.dropDownContainer&&(this.dropDown=k.byNode(this.dropDownContainer.firstChild),delete this.dropDownContainer),
this.dropDown&&m.hide(this.dropDown),this.inherited(arguments))},isLoaded:function(){var b=this.dropDown;return!!b&&(!b.href||b.isLoaded)},loadDropDown:function(b){var a=this.dropDown,c=a.on("load",d.hitch(this,function(){c.remove();b()}));a.refresh()},isFocusable:function(){return this.inherited(arguments)&&!this._mouseDown}})})},"dijit/_editor/plugins/LinkDialog":function(){define("require dojo/_base/declare dojo/dom-attr dojo/keys dojo/_base/lang dojo/on dojo/sniff dojo/query dojo/string ../_Plugin ../../form/DropDownButton ../range".split(" "),
function(r,l,d,q,k,m,p,h,e,c,b,a){var g=l("dijit._editor.plugins.LinkDialog",c,{buttonClass:b,useDefaultCommand:!1,urlRegExp:"((https?|ftps?|file)\\://|./|../|/|)(/[a-zA-Z]{1,1}:/|)(((?:(?:[\\da-zA-Z](?:[-\\da-zA-Z]{0,61}[\\da-zA-Z])?)\\.)*(?:[a-zA-Z](?:[-\\da-zA-Z]{0,80}[\\da-zA-Z])?)\\.?)|(((\\d|[1-9]\\d|1\\d\\d|2[0-4]\\d|25[0-5])\\.){3}(\\d|[1-9]\\d|1\\d\\d|2[0-4]\\d|25[0-5])|(0[xX]0*[\\da-fA-F]?[\\da-fA-F]\\.){3}0[xX]0*[\\da-fA-F]?[\\da-fA-F]|(0+[0-3][0-7][0-7]\\.){3}0+[0-3][0-7][0-7]|(0|[1-9]\\d{0,8}|[1-3]\\d{9}|4[01]\\d{8}|42[0-8]\\d{7}|429[0-3]\\d{6}|4294[0-8]\\d{5}|42949[0-5]\\d{4}|429496[0-6]\\d{3}|4294967[01]\\d{2}|42949672[0-8]\\d|429496729[0-5])|0[xX]0*[\\da-fA-F]{1,8}|([\\da-fA-F]{1,4}\\:){7}[\\da-fA-F]{1,4}|([\\da-fA-F]{1,4}\\:){6}((\\d|[1-9]\\d|1\\d\\d|2[0-4]\\d|25[0-5])\\.){3}(\\d|[1-9]\\d|1\\d\\d|2[0-4]\\d|25[0-5])))(\\:\\d+)?(/(?:[^?#\\s/]+/)*(?:[^?#\\s/]{0,}(?:\\?[^?#\\s/]*)?(?:#.*)?)?)?",
emailRegExp:"\x3c?(mailto\\:)([!#-'*+\\-\\/-9\x3d?A-Z^-~]+[.])*[!#-'*+\\-\\/-9\x3d?A-Z^-~]+@((?:(?:[\\da-zA-Z](?:[-\\da-zA-Z]{0,61}[\\da-zA-Z])?)\\.)+(?:[a-zA-Z](?:[-\\da-zA-Z]{0,6}[\\da-zA-Z])?)\\.?)|localhost|^[^-][a-zA-Z0-9_-]*\x3e?",htmlTemplate:'\x3ca href\x3d"${urlInput}" _djrealurl\x3d"${urlInput}" target\x3d"${targetSelect}"\x3e${textInput}\x3c/a\x3e',tag:"a",_hostRxp:/^((([^\[:]+):)?([^@]+)@)?(\[([^\]]+)\]|([^\[:]*))(:([0-9]+))?$/,_userAtRxp:/^([!#-'*+\-\/-9=?A-Z^-~]+[.])*[!#-'*+\-\/-9=?A-Z^-~]+@/i,
linkDialogTemplate:"\x3ctable role\x3d'presentation'\x3e\x3ctr\x3e\x3ctd\x3e\x3clabel for\x3d'${id}_urlInput'\x3e${url}\x3c/label\x3e\x3c/td\x3e\x3ctd\x3e\x3cinput data-dojo-type\x3d'dijit.form.ValidationTextBox' required\x3d'true' id\x3d'${id}_urlInput' name\x3d'urlInput' data-dojo-props\x3d'intermediateChanges:true'/\x3e\x3c/td\x3e\x3c/tr\x3e\x3ctr\x3e\x3ctd\x3e\x3clabel for\x3d'${id}_textInput'\x3e${text}\x3c/label\x3e\x3c/td\x3e\x3ctd\x3e\x3cinput data-dojo-type\x3d'dijit.form.ValidationTextBox' required\x3d'true' id\x3d'${id}_textInput' name\x3d'textInput' data-dojo-props\x3d'intermediateChanges:true'/\x3e\x3c/td\x3e\x3c/tr\x3e\x3ctr\x3e\x3ctd\x3e\x3clabel for\x3d'${id}_targetSelect'\x3e${target}\x3c/label\x3e\x3c/td\x3e\x3ctd\x3e\x3cselect id\x3d'${id}_targetSelect' name\x3d'targetSelect' data-dojo-type\x3d'dijit.form.Select'\x3e\x3coption selected\x3d'selected' value\x3d'_self'\x3e${currentWindow}\x3c/option\x3e\x3coption value\x3d'_blank'\x3e${newWindow}\x3c/option\x3e\x3coption value\x3d'_top'\x3e${topWindow}\x3c/option\x3e\x3coption value\x3d'_parent'\x3e${parentWindow}\x3c/option\x3e\x3c/select\x3e\x3c/td\x3e\x3c/tr\x3e\x3ctr\x3e\x3ctd colspan\x3d'2'\x3e\x3cbutton data-dojo-type\x3d'dijit.form.Button' type\x3d'submit' id\x3d'${id}_setButton'\x3e${set}\x3c/button\x3e\x3cbutton data-dojo-type\x3d'dijit.form.Button' type\x3d'button' id\x3d'${id}_cancelButton'\x3e${buttonCancel}\x3c/button\x3e\x3c/td\x3e\x3c/tr\x3e\x3c/table\x3e",
_initButton:function(){this.inherited(arguments);this.button.loadDropDown=k.hitch(this,"_loadDropDown");this._connectTagEvents()},_loadDropDown:function(a){r("dojo/i18n ../../TooltipDialog ../../registry ../../form/Button ../../form/Select ../../form/ValidationTextBox dojo/i18n!../../nls/common dojo/i18n!../nls/LinkDialog".split(" "),k.hitch(this,function(b,c,d){var f=this;this.tag="insertImage"==this.command?"img":"a";b=k.delegate(b.getLocalization("dijit","common",this.lang),b.getLocalization("dijit._editor",
"LinkDialog",this.lang));var g=this.dropDown=this.button.dropDown=new c({title:b[this.command+"Title"],ownerDocument:this.editor.ownerDocument,dir:this.editor.dir,execute:k.hitch(this,"setValue"),onOpen:function(){f._onOpenDialog();c.prototype.onOpen.apply(this,arguments)},onCancel:function(){setTimeout(k.hitch(f,"_onCloseDialog"),0)}});b.urlRegExp=this.urlRegExp;b.id=d.getUniqueId(this.editor.id);this._uniqueId=b.id;this._setContent(g.title+"\x3cdiv style\x3d'border-bottom: 1px black solid;padding-bottom:2pt;margin-bottom:4pt'\x3e\x3c/div\x3e"+
e.substitute(this.linkDialogTemplate,b));g.startup();this._urlInput=d.byId(this._uniqueId+"_urlInput");this._textInput=d.byId(this._uniqueId+"_textInput");this._setButton=d.byId(this._uniqueId+"_setButton");this.own(d.byId(this._uniqueId+"_cancelButton").on("click",k.hitch(this.dropDown,"onCancel")));this._urlInput&&this.own(this._urlInput.on("change",k.hitch(this,"_checkAndFixInput")));this._textInput&&this.own(this._textInput.on("change",k.hitch(this,"_checkAndFixInput")));this._urlRegExp=new RegExp("^"+
this.urlRegExp+"$","i");this._emailRegExp=new RegExp("^"+this.emailRegExp+"$","i");this._urlInput.isValid=k.hitch(this,function(){var a=this._urlInput.get("value");return this._urlRegExp.test(a)||this._emailRegExp.test(a)});this.own(m(g.domNode,"keydown",k.hitch(this,k.hitch(this,function(a){!a||a.keyCode!=q.ENTER||a.shiftKey||a.metaKey||a.ctrlKey||a.altKey||this._setButton.get("disabled")||(g.onExecute(),g.execute(g.get("value")))}))));a()}))},_checkAndFixInput:function(){var a=this,b=this._urlInput.get("value");
this._delayedCheck&&(clearTimeout(this._delayedCheck),this._delayedCheck=null);this._delayedCheck=setTimeout(function(){var c=b,d=!1,e=!1;c&&1<c.length&&(c=k.trim(c),0!==c.indexOf("mailto:")&&(0<c.indexOf("/")?-1===c.indexOf("://")&&"/"!==c.charAt(0)&&c.indexOf("./")&&0!==c.indexOf("../")&&a._hostRxp.test(c)&&(d=!0):a._userAtRxp.test(c)&&(e=!0)));d&&a._urlInput.set("value","http://"+c);e&&a._urlInput.set("value","mailto:"+c);a._setButton.set("disabled",!a._isValid())},250)},_connectTagEvents:function(){this.editor.onLoadDeferred.then(k.hitch(this,
function(){this.own(m(this.editor.editNode,"dblclick",k.hitch(this,"_onDblClick")))}))},_isValid:function(){return this._urlInput.isValid()&&this._textInput.isValid()},_setContent:function(a){this.dropDown.set({parserScope:"dojo",content:a})},_checkValues:function(a){a&&a.urlInput&&(a.urlInput=a.urlInput.replace(/"/g,"\x26quot;"));return a},setValue:function(b){this._onCloseDialog();if(9>p("ie")){var c=a.getSelection(this.editor.window).getRangeAt(0).endContainer;3===c.nodeType&&(c=c.parentNode);
c&&c.nodeName&&c.nodeName.toLowerCase()!==this.tag&&(c=this.editor.selection.getSelectedElement(this.tag));c&&c.nodeName&&c.nodeName.toLowerCase()===this.tag&&this.editor.queryCommandEnabled("unlink")&&(this.editor.selection.selectElementChildren(c),this.editor.execCommand("unlink"))}b=this._checkValues(b);this.editor.execCommand("inserthtml",e.substitute(this.htmlTemplate,b));h("a",this.editor.document).forEach(function(a){a.innerHTML||d.has(a,"name")||a.parentNode.removeChild(a)},this)},_onCloseDialog:function(){this.editor.focused&&
this.editor.focus()},_getCurrentValues:function(a){var b,c,d;a&&a.tagName.toLowerCase()===this.tag?(b=a.getAttribute("_djrealurl")||a.getAttribute("href"),d=a.getAttribute("target")||"_self",c=a.textContent||a.innerText,this.editor.selection.selectElement(a,!0)):c=this.editor.selection.getSelectedText();return{urlInput:b||"",textInput:c||"",targetSelect:d||""}},_onOpenDialog:function(){var b,c;if(p("ie")){if(c=a.getSelection(this.editor.window),c.rangeCount){var d=c.getRangeAt(0);b=d.endContainer;
3===b.nodeType&&(b=b.parentNode);b&&b.nodeName&&b.nodeName.toLowerCase()!==this.tag&&(b=this.editor.selection.getSelectedElement(this.tag));if(!b||b.nodeName&&b.nodeName.toLowerCase()!==this.tag)(c=this.editor.selection.getAncestorElement(this.tag))&&c.nodeName&&c.nodeName.toLowerCase()==this.tag?(b=c,this.editor.selection.selectElement(b)):d.startContainer===d.endContainer&&(c=d.startContainer.firstChild)&&c.nodeName&&c.nodeName.toLowerCase()==this.tag&&(b=c,this.editor.selection.selectElement(b))}}else b=
this.editor.selection.getAncestorElement(this.tag);this.dropDown.reset();this._setButton.set("disabled",!0);this.dropDown.set("value",this._getCurrentValues(b))},_onDblClick:function(a){if(a&&a.target&&(a=a.target,(a.tagName?a.tagName.toLowerCase():"")===this.tag&&d.get(a,"href"))){var b=this.editor;this.editor.selection.selectElement(a);b.onDisplayChanged();b._updateTimer&&(b._updateTimer.remove(),delete b._updateTimer);b.onNormalizedDisplayChanged();var c=this.button;setTimeout(function(){c.set("disabled",
!1);c.loadAndOpenDropDown().then(function(){c.dropDown.focus&&c.dropDown.focus()})},10)}}}),u=l("dijit._editor.plugins.ImgLinkDialog",[g],{linkDialogTemplate:"\x3ctable role\x3d'presentation'\x3e\x3ctr\x3e\x3ctd\x3e\x3clabel for\x3d'${id}_urlInput'\x3e${url}\x3c/label\x3e\x3c/td\x3e\x3ctd\x3e\x3cinput dojoType\x3d'dijit.form.ValidationTextBox' regExp\x3d'${urlRegExp}' required\x3d'true' id\x3d'${id}_urlInput' name\x3d'urlInput' data-dojo-props\x3d'intermediateChanges:true'/\x3e\x3c/td\x3e\x3c/tr\x3e\x3ctr\x3e\x3ctd\x3e\x3clabel for\x3d'${id}_textInput'\x3e${text}\x3c/label\x3e\x3c/td\x3e\x3ctd\x3e\x3cinput data-dojo-type\x3d'dijit.form.ValidationTextBox' required\x3d'false' id\x3d'${id}_textInput' name\x3d'textInput' data-dojo-props\x3d'intermediateChanges:true'/\x3e\x3c/td\x3e\x3c/tr\x3e\x3ctr\x3e\x3ctd\x3e\x3c/td\x3e\x3ctd\x3e\x3c/td\x3e\x3c/tr\x3e\x3ctr\x3e\x3ctd colspan\x3d'2'\x3e\x3cbutton data-dojo-type\x3d'dijit.form.Button' type\x3d'submit' id\x3d'${id}_setButton'\x3e${set}\x3c/button\x3e\x3cbutton data-dojo-type\x3d'dijit.form.Button' type\x3d'button' id\x3d'${id}_cancelButton'\x3e${buttonCancel}\x3c/button\x3e\x3c/td\x3e\x3c/tr\x3e\x3c/table\x3e",
htmlTemplate:'\x3cimg src\x3d"${urlInput}" _djrealurl\x3d"${urlInput}" alt\x3d"${textInput}" /\x3e',tag:"img",_getCurrentValues:function(a){var b,c;a&&a.tagName.toLowerCase()===this.tag?(b=a.getAttribute("_djrealurl")||a.getAttribute("src"),c=a.getAttribute("alt"),this.editor.selection.selectElement(a,!0)):c=this.editor.selection.getSelectedText();return{urlInput:b||"",textInput:c||""}},_isValid:function(){return this._urlInput.isValid()},_connectTagEvents:function(){this.inherited(arguments);this.editor.onLoadDeferred.then(k.hitch(this,
function(){this.own(m(this.editor.editNode,"mousedown",k.hitch(this,"_selectTag")))}))},_selectTag:function(a){a&&a.target&&(a=a.target,(a.tagName?a.tagName.toLowerCase():"")===this.tag&&this.editor.selection.selectElement(a))},_checkValues:function(a){a&&a.urlInput&&(a.urlInput=a.urlInput.replace(/"/g,"\x26quot;"));a&&a.textInput&&(a.textInput=a.textInput.replace(/"/g,"\x26quot;"));return a},_onDblClick:function(a){if(a&&a.target&&(a=a.target,(a.tagName?a.tagName.toLowerCase():"")===this.tag&&d.get(a,
"src"))){var b=this.editor;this.editor.selection.selectElement(a);b.onDisplayChanged();b._updateTimer&&(b._updateTimer.remove(),delete b._updateTimer);b.onNormalizedDisplayChanged();var c=this.button;setTimeout(function(){c.set("disabled",!1);c.loadAndOpenDropDown().then(function(){c.dropDown.focus&&c.dropDown.focus()})},10)}}});c.registry.createLink=function(){return new g({command:"createLink"})};c.registry.insertImage=function(){return new u({command:"insertImage"})};g.ImgLinkDialog=u;return g})},
"builder/plugins/app-config-templateconfig/_build-generate_module":function(){define(["builder/plugins/app-config-templateconfig/Plugin","dojo/text!builder/plugins/app-config-templateconfig/Plugin.html","dojo/text!builder/plugins/app-config-templateconfig/css/style.css","dojo/i18n!builder/plugins/app-config-templateconfig/nls/strings"],function(){})},"builder/plugins/app-config-templateconfig/Plugin":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/html dojo/topic builder/BasePlugin builder/dijit/template-config/Template builder/dijit/template-config/utils builder/dijit/TemplateAttributes".split(" "),
function(r,l,d,q,k,m,p,h){return r([k],{baseClass:"plugin-config-template",postCreate:function(){this.inherited(arguments);this.own(q.subscribe("app/appConfigLoaded",l.hitch(this,this._onAppConfigLoaded)));this.own(q.subscribe("app/appConfigChanged",l.hitch(this,this._onAppConfigChanged)));this.pluginManager.getPluginByName("app-config").addRepublishEvent("templateConfigChanged")},_init:function(){this.visible&&this.appConfig&&p.loadAllWidgetConfigs(l.clone(this.appConfig)).then(l.hitch(this,function(d){this._initConfigPanel(d);
this._initPriviewPanel(this.configTemplate.getTemplateConfig())}))},_initConfigPanel:function(e){this.configTemplate&&this.configTemplate.destroy();this.configTemplate=new m({appConfig:e,appInfo:window.appInfo,templateConfig:e.templateConfig});this.configTemplate.on("hasChanged",l.hitch(this,this._onConfigTempalteChanged));d.place(this.configTemplate.domNode,this.configPanel);this.configTemplate.startup()},_initPriviewPanel:function(e){this.previewTemplate&&this.previewTemplate.destroy();this.previewTemplate=
new h({templateConfig:e});d.place(this.previewTemplate.domNode,this.previewPanel);this.previewTemplate.startup()},_onAppConfigLoaded:function(d){this.appConfig=d;this._init()},_onAppConfigChanged:function(d){this.appConfig=d},_onToAppClick:function(){this.pluginManager.getPluginByName("app-config").switchToConfigApp()},_onConfigTempalteChanged:function(){this._initPriviewPanel(this.configTemplate.getTemplateConfig());q.publish("templateConfigChanged",this.configTemplate.getFullTemplateConfig())},
refresh:function(){this._init()}})})},"builder/dijit/template-config/Template":function(){define("dojo/_base/declare dojo/_base/array dojo/_base/html dijit/_WidgetBase dijit/_TemplatedMixin dojo/text!./templates/Template.html dojo/on dojo/dom dojo/_base/lang dojo/dom-construct dojo/dom-style dojo/dom-class dojo/dom-attr dojo/json dojo/query dojo/Deferred dojo/Evented dijit/form/Select ./ConfigNode ./CategoryManager ./Export builder/serviceUtils jimu/utils jimu/WidgetManager jimu/dijit/Message jimu/portalUrlUtils builder/portalUtils jimu/dijit/LoadingShelter ./ExportMessage".split(" "),
function(r,l,d,q,k,m,p,h,e,c,b,a,g,u,n,t,f,v,x,w,z,A,y,B,C,E,D,F,G){return r([q,k,f],{templateString:m,baseClass:"agol-template",configTree:null,nls:null,lastTemplateJson:null,constructor:function(){this.loading=new F({hidden:!0})},postMixInProperties:function(){this.nls=window.builderNls;this.imageFolder="builder/css/images/agoltemplate/";this.arrowImgSrc=isRTL?this.imageFolder+"v_left.png":this.imageFolder+"v_right.png"},postCreate:function(){this.inherited(arguments)},startup:function(){this._beforeInitWork();
h.setSelectable(this.contentPart,!1);this.configTree=new x(this.cleanAppConfig,null,"app","",0);this.categoryManager=new w(this.configTree,this.cleanAppConfig,this.templateConfig);this.drawTree(this.configTree,this.treePart);this.drawCategoryPart();this._afterInitWork()},_beforeInitWork:function(){this.cleanAppConfig=this.appConfig.getCleanConfig(!0);delete this.cleanAppConfig.visitElement;delete this.cleanAppConfig._buildInfo;delete this.cleanAppConfig.agolTemplateJson},_afterInitWork:function(){this.lastTemplateJson=
this.categoryManager.getTemplateJson()},drawTree:function(a,b){var c,d;c=this.drawDomNode(a,b);if(0!==a.childs.length)for(d=0;d<a.childs.length;d++)this.drawTree(a.childs[d],c)},drawDomNode:function(a,f){var g,h,k,l,n;n=this.categoryManager.getCategoryByField(a.absolutePath);g=c.create("div",{"class":"tree-node-div",idAttr:a.id},f);a.traversal(e.hitch(this,function(a){if(this.categoryManager.getCategoryByField(a.absolutePath))return!0}))||b.set(g,"display","none");"leaf"!==a.nodeType||n||b.set(g,
"color","#cccccc");h=c.create("div",{"class":"line-label-div "},g);var m=a.label?a.label:a.keyString;m.indexOf("]")===m.length-1&&(m+="\x26lrm;");m=c.create("div",{"class":"line-label-text ",innerHTML:m,title:m},h);"leaf"!==a.nodeType&&d.addClass(m,"leaf-node");n&&"leaf"===a.nodeType&&(k=c.create("div",{"class":"to-right-div "},g),c.create("img",{"class":"to-right-img",src:this.imageFolder+"add_field.png",alt:"img"},k),this.own(p(k,"click",e.hitch(this,function(c){b.set(k,"display","none");this._onToRightDiv(a,
"add",g);c.stopPropagation();this._checkTemplateStatus()}))),-1!==n.findFieldFromDisplay(a.absolutePath)&&b.set(k,"display","none"));l=12*a.level;"leaf"===a.nodeType?isRTL?b.set(h,"paddingRight",l+17+"px"):b.set(h,"paddingLeft",l+17+"px"):isRTL?b.set(h,"paddingRight",l+"px"):b.set(h,"paddingLeft",l+"px");h=c.create("div",{"class":"tree-node-subdiv"},f);b.set(h,"display","none");"leaf"!==a.nodeType?(b.set(g,"cursor","pointer"),this.own(p(g,"click",e.hitch(this,function(a,c,e){"none"===b.get(c,"display")?
(b.set(c,"display","block"),d.addClass(e,"unfold")):(b.set(c,"display","none"),d.removeClass(e,"unfold"));-1===a.absolutePath.search(/widgets\[[0-9]+\]_config$/)||a.jsonObject||this.addWidgetConfigToConfigTree(a.absolutePath)},a,h,m)))):n&&(b.set(g,"cursor","pointer"),this.own(p(g,"click",e.hitch(this,function(a,b){this._onToRightDiv(a,"notAdd",g);b.stopPropagation()},a))));a.lineDomNode=g;a.subLineDomNode=h;a.showSubDivDomNode=void 0;a.toRightDiv=k;0===a.level&&(d.setStyle(g,"display","none"),d.setStyle(h,
"display","block"));return h},drawCategoryPart:function(){l.forEach(this.categoryManager.displayCategorys,function(a){this.drawCategory(a)},this)},drawCategory:function(a){var d,f,h,k,n,m,q;d=c.create("div",{"class":"category-div",categoryDiv:a.name},this.categoryPart);k=c.create("div",{"class":"category-head-div",categoryHeadDiv:a.name},d);n=c.create("div",{"class":"category-fold-div jimu-float-leading"},k);q=c.create("img",{"class":"category-fold-img",src:this.arrowImgSrc,alt:"img"},n);c.create("div",
{"class":"category-title-div jimu-float-leading",innerHTML:a.title},k);f=c.create("div",{"class":"category-oper-div jimu-float-trailing"},k);n=c.create("div",{"class":"category-oper-item-div category-moveup-div jimu-float-leading",innerHTML:"\x3cimg src\x3d'"+this.imageFolder+"moveup.png' alt\x3d'img'\x3e\x3c/img\x3e"},f);m=c.create("div",{"class":"category-oper-item-div category-movedown-div jimu-float-leading",innerHTML:"\x3cimg src\x3d'"+this.imageFolder+"movedown.png' alt\x3d'img'\x3e\x3c/img\x3e"},
f);f=c.create("div",{"class":"category-oper-item-div category-remove-div jimu-float-leading",innerHTML:"\x3cimg src\x3d'"+this.imageFolder+"delete01.png' alt\x3d'img'\x3e\x3c/img\x3e"},f);h=c.create("div",{"class":"fields-div",fieldsDiv:a.name},d);this.own(p(n,"click",e.hitch(this,function(b){this.categoryManager.moveup(a)&&(c.empty(this.categoryPart),this.drawCategoryPart());this._changeHeighlightCategoryHead(a.name);b.stopPropagation();this._checkTemplateStatus()})));this.own(p(m,"click",e.hitch(this,
function(b){this.categoryManager.movedown(a)&&(c.empty(this.categoryPart),this.drawCategoryPart());this._changeHeighlightCategoryHead(a.name);b.stopPropagation();this._checkTemplateStatus()})));this.own(p(f,"click",e.hitch(this,function(e){this.categoryManager.removeCategoryFromDisplay(a);c.destroy(d);l.forEach(a.displayFields,function(a){var c=this.configTree.findNode(a.fieldPath);c&&(c.setTemplateField(a.fieldJson),c.toRightDiv&&b.set(c.toRightDiv,"display","block"))},this);a.displayFields=[];e.stopPropagation();
this._checkTemplateStatus()})));this.own(p(k,"click",e.hitch(this,function(){"block"===b.get(h,"display")?(b.set(h,"display","none"),g.set(q,"src",this.arrowImgSrc)):(b.set(h,"display","block"),g.set(q,"src",this.imageFolder+"v.png"));this._changeHeighlightCategoryHead(a.name)})));this.drawFields(a,d,h);b.set(h,"display","none")},drawFields:function(a,b,c){l.forEach(a.displayFields,function(d){this.drawField(a,b,c,d)},this)},addWidgetConfigToConfigTree:function(a){var b=new t,c=a.search(/widgets\[[0-9]+\]/),
d=a.slice(c,a.length).indexOf("]"),c=a.slice(0,c+d+1);a=c+"_config";var c=this.configTree.findNode(c),f=this.configTree.findNode(a);a=this.appConfig.getConfigElementById(c.jsonObject.id);B.getInstance().tryLoadWidgetConfig(a).then(e.hitch(this,function(a){if(a){var c;f.jsonObject=a;a.geocoder&&a.geocoder.geocoders&&delete a.geocoder.geocoders;for(c in a)a.hasOwnProperty(c)&&(c=f.addChild(a[c],c,f.absolutePath,f.level),this.drawTree(c,f.subLineDomNode))}b.resolve()}));return b},drawField:function(a,
f,h,k){var n,m,q,t,u,r,w,z;this.configTree.findNode(k.fieldPath);z=x.getDefaultTemplateField(k.fieldPath,k.fieldJson.type,k.fieldJson.label);for(n in k.fieldJson)k.fieldJson.hasOwnProperty(n)&&(z[n]=k.fieldJson[n]);n=c.create("div",{"class":"field-div",fieldDiv:k.fieldPath},h);this.own(p(n,"click",e.hitch(this,function(a,c){function f(){g=this.configTree.findNode(n);h=d.position(this.treePart).y;k=d.position(g.lineDomNode).y;l=k-h;(0>l||l>b.get(this.categoryPart,"height"))&&g.lineDomNode.scrollIntoView(!1);
this._changeHeighlightFieldDomNode(n);this._changeHeighlightTreeDomNode(g.lineDomNode);this._changeHeighlightCategoryHead(c.name)}var g,h,k,l,n=a.fieldPath;if(g=this.configTree.findNode(n)){for(;g;)b.set(g.subLineDomNode,"display","block"),g=g.parentNode;e.hitch(this,f)()}else this.addWidgetConfigToConfigTree(n).then(e.hitch(this,function(){for(g=this.configTree.findNode(n);g;)b.set(g.subLineDomNode,"display","block"),g=g.parentNode;e.hitch(this,f)()}))},k,a)));a=c.create("div",{"class":"field-head-div"},
n);q=c.create("div",{"class":"field-fold-div"},a);t=c.create("img",{"class":"field-fold-img",src:this.arrowImgSrc,alt:"img"},q);q=e.hitch(this,function(a){var b="",c=a.split("_"),d=e.clone(c);l.forEach(c,function(a,b){var e,f="";if(-1!==a.search(/widgets\[[0-9]+\]$/)||-1!==a.search(/groups\[[0-9]+\]$/)){for(e=0;e<=b;e++)f+=c[e]+"_";e=this.configTree.findNode(f.slice(0,-1));d[b]=e.label}},this);for(a=1;a<d.length;a++)b+=d[a]+"_";return b.slice(0,-1)})(k.fieldPath);c.create("div",{"class":"field-head-title-div",
innerHTML:q,title:q},a);u=c.create("div",{"class":"field-opers-div"},a);q=c.create("div",{"class":"field-oper-div jimu-float-trailing",innerHTML:"\x3cimg class\x3d'field-oper-img' src\x3d'"+this.imageFolder+"delete01.png' alt\x3d'img'\x3e\x3c/img\x3e"},u);r=c.create("div",{"class":"field-oper-div jimu-float-trailing",innerHTML:"\x3cimg class\x3d'field-oper-img' src\x3d'"+this.imageFolder+"movedown.png' alt\x3d'img'\x3e\x3c/img\x3e"},u);u=c.create("div",{"class":"field-oper-div jimu-float-trailing",
innerHTML:"\x3cimg class\x3d'field-oper-img' src\x3d'"+this.imageFolder+"moveup.png' alt\x3d'img'\x3e\x3c/img\x3e"},u);var A=c.create("div",{"class":"field-fixed-content-div",style:"display:none;"},n);m=c.create("div",{"class":"field-box-div"},A);c.create("span",{"class":"field-label-span",innerHTML:this.nls.fieldLabel},m);m=c.create("input",{"class":"jimu-input field-label-input",type:"text",value:z.label},m);this.own(p(m,"change",e.hitch(this,function(a,b){this._onFieldChange(a,{key:"label",value:y.stripHTML(b.value)})},
k.fieldPath,m)));m=c.create("div",{"class":"field-box-div"},A);c.create("span",{"class":"field-type-span",innerHTML:this.nls.fieldType},m);m=(new v({name:"selectFieldType","class":"field-type-select",options:[{label:this.nls.typeSelectString,value:"string"},{label:this.nls.typeSelectBoolean,value:"boolean"},{label:this.nls.typeSelectNumber,value:"number"},{label:this.nls.typeSelectOptions,value:"options"},{label:this.nls.typeSelectColor,value:"color"}],value:z.type})).placeAt(m);w=c.create("div",
{"class":"field-content-div",style:"display:none;"},n);this.drawFieldContent(k.fieldPath,z,w,m.getValue());this.own(p(m,"change",e.hitch(this,function(a,c,d,e){this.drawFieldContent(a,c,d,e);this._onFieldChange(a,{key:"type",value:e});b.set(d,"display","block")},k.fieldPath,z,w)));this.own(p(a,"click",e.hitch(this,function(){"block"===b.get(w,"display")?(b.set(w,"display","none"),b.set(A,"display","none"),g.set(t,"src",this.arrowImgSrc)):(b.set(w,"display","block"),b.set(A,"display","block"),g.set(t,
"src",this.imageFolder+"v.png"))})));this.own(p(q,"click",e.hitch(this,function(a,d,f,g){var h=a.fieldPath,k=this.configTree.findNode(h);k?(k.setTemplateField(a.fieldJson),k.toRightDiv&&b.set(k.toRightDiv,"display","block")):this.addWidgetConfigToConfigTree(h).then(e.hitch(this,function(){var b=this.configTree.findNode(h);a.fieldJson&&b.setTemplateField(a.fieldJson)}));k=this.categoryManager.getCategoryByField(h);k.removeFieldFromDisplay(h);c.destroy(d);k.displayIsEmpty()&&(this.categoryManager.removeCategoryFromDisplay(k),
c.destroy(f));g.stopPropagation();this._checkTemplateStatus()},k,n,f)));this.own(p(u,"click",e.hitch(this,function(a,b,d){var e=this.categoryManager.getCategoryByField(a);e.moveup(a)&&(c.empty(b),this.drawFields(e,f,b),this._changeHeighlightFieldDomNode(a));d.stopPropagation();this._checkTemplateStatus()},k.fieldPath,h)));this.own(p(r,"click",e.hitch(this,function(a,b,d){var e=this.categoryManager.getCategoryByField(a);e.movedown(a)&&(c.empty(b),this.drawFields(e,f,b),this._changeHeighlightFieldDomNode(a));
d.stopPropagation();this._checkTemplateStatus()},k.fieldPath,h)))},drawFieldContent:function(a,b,d,f){var g,h,k,n;c.empty(d);"color"!==f&&(c.create("span",{"class":"field-tooltip-span",innerHTML:this.nls.tooltip},d),g=c.create("input",{"class":"jimu-input field-tooltip-input",type:"text",value:b.tooltip},d),this.own(p(g,"change",e.hitch(this,function(a,b){this._onFieldChange(a,{key:"tooltip",value:b.value})},a,g))),c.create("br",{},d),"string"===f?(c.create("span",{"class":"field-string-ph-span",
innerHTML:this.nls.placeholder},d),f=c.create("input",{"class":"jimu-input field-string-ph-input",type:"text",value:b.placeHolder},d),this.own(p(f,"change",e.hitch(this,function(a,b){this._onFieldChange(a,{key:"placeHolder",value:b.value})},a,f))),f=c.create("div",{"class":"field-text-type-div"},d),c.create("span",{"class":"field-text-type-span",innerHTML:this.nls.textBoxType},f),b=(new v({name:"stringOptions","class":"field-string-options",options:[{label:this.nls.textBoxTypeTextbox,value:"textbox"},
{label:this.nls.textBoxTypeTextarea,value:"textarea"},{label:this.nls.textBoxTypeRichtext,value:"richtext"}],value:b.stringFieldOption})).placeAt(f),this.own(p(b,"change",e.hitch(this,function(a,b){this._onFieldChange(a,{key:"stringFieldOption",value:b})},a)))):"number"===f?(c.create("span",{"class":"field-num-min-span",innerHTML:this.nls.minvalue},d),h=c.create("input",{"class":"jimu-input field-num-input field-num-min-input",type:"text",value:b.constraints.min},d),c.create("br",{},d),c.create("span",
{"class":"field-num-max-span",innerHTML:this.nls.maxvalue},d),k=c.create("input",{"class":"jimu-input field-num-input field-num-max-input",type:"text",value:b.constraints.max},d),c.create("br",{},d),c.create("span",{"class":"field-num-places-span",innerHTML:this.nls.places},d),n=c.create("input",{"class":"jimu-input field-num-input field-num-places-input",type:"text",value:b.constraints.places},d),this.own(p(h,"change",e.hitch(this,function(a){this._onFieldChange(a,{key:"constraints",value:{min:h.value,
max:k.value,places:n.value}})},a))),this.own(p(k,"change",e.hitch(this,function(a){this._onFieldChange(a,{key:"constraints",value:{min:h.value,max:k.value,places:n.value}})},a))),this.own(p(n,"change",e.hitch(this,function(a){this._onFieldChange(a,{key:"constraints",value:{min:h.value,max:k.value,places:n.value}})},a)))):"options"===f&&(f=c.create("div",{"class":"field-options-add-div"},d),g=c.create("div",{"class":"field-options-add-content"},f),c.create("div",{"class":"field-options-add-img-div jimu-float-leading",
innerHTML:"\x3cimg src\x3d'"+this.imageFolder+"add_link.png' alt\x3d'img'\x3e\x3c/img\x3e"},g),c.create("div",{"class":"field-options-add-text-div jimu-float-leading",innerHTML:this.nls.addNewOption},g),l.forEach(b.options,function(b){this._onFieldOptionsAdd(a,d,b.label,b.value)},this),this.own(p(f,"click",e.hitch(this,this._onFieldOptionsAdd,a,d,"","")))))},_changeHeighlightFieldDomNode:function(b){n(".field-div",this.categoryPart).removeClass("field-heighlight-div");a.add(n('div[fieldDiv\x3d"'+
b+'"]',this.categoryPart)[0],"field-heighlight-div")},_changeHeighlightTreeDomNode:function(b){this.heighlightTreeDomNode&&a.remove(this.heighlightTreeDomNode,"tree-node-heighlight-div");a.add(b,"tree-node-heighlight-div");this.heighlightTreeDomNode=b},_changeHeighlightCategoryHead:function(a){n(".category-head-div",this.categoryPart).removeClass("category-head-div-selected");a=n("div[categoryHeadDiv\x3d'"+a+"']",this.categoryPart)[0];d.addClass(a,"category-head-div-selected")},_onToRightDiv:function(a,
c,e){var f,g,h=this.categoryManager.getCategoryByField(a.absolutePath);f=this.categoryManager.findDisplayCategory(h.name);g={fieldPath:a.absolutePath,fieldJson:a.getTemplateField()};if(-1===f){if("add"!==c)return;this.categoryManager.addCategoryToDisplay(h);h.addFieldToDisplay(g);this.drawCategory(h);f=n("div[fieldsDiv\x3d'"+h.name+"']",this.categoryPart)[0]}else if(-1===h.findFieldFromDisplay(a.absolutePath)){if("add"!==c)return;h.addFieldToDisplay(g);c=n("div[categoryDiv\x3d'"+h.name+"']",this.categoryPart)[0];
f=n("div[fieldsDiv\x3d'"+h.name+"']",this.categoryPart)[0];this.drawField(h,c,f,g)}else f=n("div[fieldsDiv\x3d'"+h.name+"']",this.categoryPart)[0];b.set(f,"display","block");g=n('div[fieldDiv\x3d"'+a.absolutePath+'"]',this.categoryPart)[0];this._changeHeighlightCategoryHead(h.name);this._changeHeighlightFieldDomNode(a.absolutePath);this._changeHeighlightTreeDomNode(e);a=d.position(this.categoryPart).y;a=d.position(g).y-a;(0>a||a>b.get(this.categoryPart,"height"))&&g.scrollIntoView(!1)},_onFieldChange:function(a,
b){var c=this.configTree.findNode(a),d=this.categoryManager.getCategoryByField(a).getDisplayField(a);d.fieldJson[b.key]=b.value;c.templateField=d.fieldJson;this._checkTemplateStatus()},_onFieldOptionsAdd:function(a,b,d,f){var g=c.create("div",{"class":"field-options-div"},b),h=c.create("div",{"class":"field-box-div"},g);c.create("div",{"class":"field-options-label-div jimu-float-leading",innerHTML:this.nls.labelStr},h);h=c.create("input",{"class":"jimu-input field-options-label-input jimu-float-leading",
type:"text",value:d},h);this.own(p(h,"change",e.hitch(this,function(a){this._onFieldChange(a,{key:"options",value:this._getFieldOptions(b)})},a)));h=c.create("div",{"class":"field-box-div"},g);c.create("div",{"class":"field-options-value-div jimu-float-leading",innerHTML:this.nls.value},h);f=c.create("input",{"class":"jimu-input field-options-value-input jimu-float-leading",type:"text",value:f},h);this.own(p(f,"change",e.hitch(this,function(a){this._onFieldChange(a,{key:"options",value:this._getFieldOptions(b)})},
a)));f=c.create("div",{"class":"jimu-icon jimu-icon-delete field-options-remove-div jimu-float-leading"},h);this.own(p(f,"click",e.hitch(this,function(a){c.destroy(g);this._onFieldChange(a,{key:"options",value:this._getFieldOptions(b)})},a)))},_getFieldOptions:function(a){var b=[];n(".field-options-div",a).forEach(e.hitch(this,function(a){b.push({label:n(".field-options-label-input",a).attr("value")[0],value:n(".field-options-value-input",a).attr("value")[0]})}));return b},_onReviewJsonDivClick:function(){var a=
this.categoryManager.getTemplateJson();this.showJsonWidget.setConfig(a);g.set(this.rightPartHeadText,"innerHTML",this.nls.rightPartHead2);b.set(this.showJsonDiv,"display","block");b.set(this.reviewJsonDiv,"display","none");b.set(this.reviewJsonBackDiv,"display","block")},_onReviewJsonBackDivClick:function(){g.set(this.rightPartHeadText,"innerHTML",this.nls.rightPartHead);b.set(this.reviewJsonDiv,"display","block");b.set(this.reviewJsonBackDiv,"display","none");b.set(this.showJsonDiv,"display","none")},
_saveAgolTemplate:function(a){var b=new t,c=u.stringify(this.categoryManager.getTemplateJson("fullJson")),d={itemId:a?a:this.appInfo.agolTemplateInfo?this.appInfo.agolTemplateInfo.itemId:null,json:c};A.saveAgolTemplate(this.appInfo,d).then(e.hitch(this,function(){this.appInfo.agolTemplateInfo=d;this.lastTemplateJson=this.categoryManager.getTemplateJson();b.resolve()}),function(a){new C({message:a});b.reject()});return b},_onDownloadNodeClick:function(){},_updateAgolTemplate:function(){var a=new t,
b=this.hasChanged(),c=u.stringify(this.categoryManager.getTemplateJson());this.loading.show(this.nls.updating);b?this._saveAgolTemplate().then(e.hitch(this,function(){this._checkTemplateStatus();a.resolve()})):a.resolve();a.then(e.hitch(this,function(){D.getPortal(window.portalUrl).getUser().then(e.hitch(this,function(a){a.updateItem(this.appInfo.agolTemplateInfo.itemId,{text:c}).then(e.hitch(this,function(){this.loading.hide();G._exportedMessage({itemId:this.appInfo.agolTemplateInfo.itemId,message:this.nls.exportSuccessfulUpdate},
this.nls.exportMessageTitleUpdate,this.nls)}),e.hitch(this,function(a){this.loading.hide();console.error(a.message||a);G._exportedMessage({itemId:null,message:this.nls.exportTemplateFailed7},this.nls.exportMessageTitleUpdate,this.nls)}))}),e.hitch(this,function(a){this.loading.hide();console.error(a.message||a);G._exportedMessage({itemId:null,message:this.nls.exportTemplateFailed6},this.nls.exportMessageTitleUpdate,this.nls)}))}))},_exportTemplate:function(a){var b="",c=u.stringify(this.categoryManager.getTemplateJson()),
d=u.stringify(this.categoryManager.getTemplateJson("fullJson"));window.isXT?b=E.getProtocol(window.portalUrl)+"://"+window.location.host+path+"apps/"+this.appInfo.id:(b=E.getStandardPortalUrl(window.portalUrl),b="HTML3D"===window.appInfo.appType?b+"/apps/webappviewer3d/index.html?id\x3d"+this.appInfo.id:b+"/apps/webappviewer/index.html?id\x3d"+this.appInfo.id);(new z({_templateUrl:b,_temlateJson:c,_fullTemplateJson:d,nls:this.nls,_afterAddItemOfExportCallback:e.hitch(this,this._afterAddItemOfExportCallback),
appInfo:this.appInfo,appConfig:this.cleanAppConfig,isExportWABTemplate:a})).startup()},_afterAddItemOfExportCallback:function(a){this._saveAgolTemplate(a).then(e.hitch(this,function(){this._checkTemplateStatus();this.emit("exported",!0)}))},_checkTemplateStatus:function(){var a=this.hasChanged();this.emit("hasChanged",a)},exportOrUpdateAGOLTemplate:function(){this.appInfo.agolTemplateInfo&&this.appInfo.agolTemplateInfo.itemId?this._updateAgolTemplate():this._exportTemplate(!1)},exportWABTemplate:function(){this._exportTemplate(!0)},
saveAgolTemplate:function(){return this._saveAgolTemplate()},hasChanged:function(){return!y.isEqual(this.lastTemplateJson,this.categoryManager.getTemplateJson())},getTemplateConfig:function(){return this.categoryManager.getTemplateJson()},getFullTemplateConfig:function(){return this.categoryManager.getTemplateJson("fullJson")}})})},"builder/dijit/template-config/ConfigNode":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/_base/array"],function(r,l,d){var q={},k=r([],{id:null,parentNode:null,
keyString:null,absolutePath:null,childs:null,nodeType:null,templateField:null,jsonObject:null,level:null,label:null,isVisible:!1,constructor:function(d,k,h,e,c){var b;this.parentNode=k;this.keyString=h;this.childs=[];this.absolutePath=""===e?h:e+"_"+h;this.jsonObject=d;this.level=c;this.initId();this.initLabel();this.initTemplateField(d);if("object"!==typeof d||null===d)this.nodeType="leaf";else if(l.isArrayLike(d))for(this.nodeType="array",k=0;k<d.length;k++)this.addChild(d[k],this.keyString+"["+
k+"]",e,c);else for(b in this.nodeType="normal",d)d.hasOwnProperty(b)&&"function"!==typeof d[b]&&this.addChild(d[b],b,this.absolutePath,c)},initId:function(){var d,k;d=this.absolutePath.search(/_widgets\[[0-9]+\]/);k=this.absolutePath.search(/_groups\[[0-9]+\]/);-1!==d||-1!==k?-1!==this.absolutePath.search(/_widgets\[[0-9]+\]$/)||-1!==this.absolutePath.search(/_groups\[[0-9]+\]$/)?this.id=this.parentNode.id+"["+this.jsonObject.id+"]":l.isArrayLike(this.parentNode.jsonObject)?this.id=this.parentNode.parentNode.id+
"_"+this.keyString:this.id=this.parentNode.id+"_"+this.keyString:this.id=this.absolutePath},initLabel:function(){this.label=this.keyString;if(-1!==this.absolutePath.search(/widgets\[[0-9]+\]$/)||-1!==this.absolutePath.search(/groups\[[0-9]+\]$/))this.label=this.jsonObject.label},initTemplateField:function(d){this.templateField=k.getDefaultTemplateField(this.absolutePath,typeof d,this.label);k.setDefaultValue(this.absolutePath,d,this.id)},getTemplateFieldDefaultValue:function(){return this.templateField.defaultValue},
getTemplateField:function(d){d=d?d:this.templateField;var k={type:d.type,fieldName:this.id,label:d.label,tooltip:d.tooltip};"leaf"!==this.nodeType&&(k.fieldName+="--");switch(k.type){case "string":k.stringFieldOption=d.stringFieldOption;k.placeHolder=d.placeHolder;break;case "number":k.constraints=d.constraints||{min:0,max:100,places:0};break;case "options":k.options=d.options||[{label:"label1",value:"value1"}]}return k},setTemplateField:function(d){this.templateField.type=d.type;this.templateField.label=
d.label;this.templateField.tooltip=d.tooltip;"leaf"!==this.nodeType&&(this.templateField.fieldName=this.templateField.fieldName.slice(0,this.templateField.fieldName.length-2));switch(this.templateField.type){case "string":this.templateField.stringFieldOption=d.stringFieldOption;this.templateField.placeHolder=d.placeHolder;break;case "number":this.templateField.constraints=d.constraints;break;case "options":this.templateField.options=d.options}return d},addChild:function(d,l,h,e){d=new k(d,this,l,
h,e+1);this.childs.push(d);return d},isLeaf:function(){var d=!1;this.childs&&0<this.childs.length&&(d=!0);return d},findNode:function(d){var k=[],h,e,c;d.split("_").forEach(function(b){var a=b.search(/\[[0-9]+\]/);-1!==a&&k.push(b.slice(0,a));k.push(b)});e=this;if(e.keyString!==k[0])return null;for(d=1;d<k.length;d++){c=e.childs.length;for(h=0;h<c;h++)if(e.childs[h].keyString===k[d]){e=e.childs[h];break}if(h===c)return null}return e},setVisible:function(){for(var d=this;d;)d.isVisible=!0,d=d.parentNode},
findNodeById:function(d){var k=null;this.traversal(function(h){if(h.id===d)return k=h,!0});return k},traversal:function(d){if(d(this))return!0;for(var k=0;k<this.childs.length;k++)if(this.childs[k].traversal(d))return!0},deserialize:function(k){k&&d.forEach(k.configurationSettings,function(k){d.forEach(k.fields,function(d){this.findNode(d.fieldName).setTemplateField(d)},this)},this)}});k.getDefaultValue=function(d){return q[d]};k.setDefaultValue=function(d,k,h){var e=null,e=k;"app_portalUrl"===d||
"app_map_itemId"===d?e=null:"app_title"===d?e="":"app_subtitle"===d?e="":"object"===typeof k&&(e=!1);q[h]=e};k.defaultValueExisted=function(d){return void 0===q[d]?!1:!0};k.getDefaultTemplateField=function(d,k,h){d="string";switch(k){case "number":d="number";break;case "boolean":d="boolean";break;case "object":d="boolean",h="disable"}return{type:d,label:h,tooltip:"",stringFieldOption:"textbox",placeHolder:h,constraints:{min:0,max:100,places:0},options:[{label:"label1",value:"value1"}]}};return k})},
"builder/dijit/template-config/CategoryManager":function(){define(["dojo/_base/declare","dojo/_base/array","./ConfigNode","./Category"],function(r,l,d,q){return r([],{categorys:null,displayCategorys:null,constructor:function(d,l,p){this.configTree=d;this.categorys=[];this.displayCategorys=[];this.initCategorys(l,d);this.deserialize(p,d)},initCategorys:function(d,m){var k=new q(m,"Attribute","Attribute",["app_title","app_subtitle","app_logo","app_links"],[],["app_title","app_subtitle"]);this.categorys.push(k);
l.forEach(d.widgetOnScreen.widgets,function(d,e){var c="ScreenWidget_"+d.id,b="app_widgetOnScreen_widgets["+e+"]",b=[b+"_label",b+"_visible",b+"_config",b+"_openAtStart"],a=[];d.uri&&this.categorys.push(new q(m,c,d.label+" widget",b,a))},this);l.forEach(d.widgetOnScreen.groups,function(d,e){var c="ScreenWidgetGroup_"+d.id,b="app_widgetOnScreen_groups["+e+"]",a=[b+"_label",b+"_visible",b+"_openAtStart"];l.forEach(d.widgets,function(c,d){a.push(b+"_widgets["+d+"]_label");a.push(b+"_widgets["+d+"]_visible");
a.push(b+"_widgets["+d+"]_openAtStart");a.push(b+"_widgets["+d+"]_config")});this.categorys.push(new q(m,c,d.label,a,[]))},this);l.forEach(d.widgetPool.widgets,function(d,e){var c="widgetPoolWidget_"+d.id,b="app_widgetPool_widgets["+e+"]",b=[b+"_label",b+"_visible",b+"_config",b+"_openAtStart"],a=[];d.uri&&this.categorys.push(new q(m,c,d.label+" widget",b,a))},this);l.forEach(d.widgetPool.groups,function(d,e){var c="widgetPoolGroup_"+d.id,b="app_widgetPool_groups["+e+"]",a=[b+"_label",b+"_visible",
b+"_openAtStart"];l.forEach(d.widgets,function(c,d){a.push(b+"_widgets["+d+"]_label");a.push(b+"_widgets["+d+"]_visible");a.push(b+"_widgets["+d+"]_openAtStart");a.push(b+"_widgets["+d+"]_config")});this.categorys.push(new q(m,c,d.label,a,[]))},this);this.displayCategorys.push(k)},getCategoryByName:function(d){return this.categorys[this.findCategory(d)]},getCategoryByField:function(d){var k;for(k=0;k<this.categorys.length;k++)if(this.categorys[k].hasField(d))return this.categorys[k];return null},
findCategory:function(d){return this._find(d,this.categorys)},findDisplayCategory:function(d){return this._find(d,this.displayCategorys)},_find:function(d,l){var k;for(k=0;k<l.length&&l[k].name!==d;k++);return k===l.length?-1:k},addCategoryToDisplay:function(d){-1===this.findDisplayCategory(d.name)&&this.displayCategorys.push(d)},removeCategoryFromDisplay:function(d){d=this.findDisplayCategory(d.name);0<=d&&this.displayCategorys.splice(d,1)},moveup:function(d){var k;d=this.findDisplayCategory(d.name);
return 0<d?(k=this.displayCategorys[d],this.displayCategorys[d]=this.displayCategorys[d-1],this.displayCategorys[d-1]=k,!0):!1},movedown:function(d){var k;d=this.findDisplayCategory(d.name);return 0<=d&&d<this.displayCategorys.length-1?(k=this.displayCategorys[d],this.displayCategorys[d]=this.displayCategorys[d+1],this.displayCategorys[d+1]=k,!0):!1},getTemplateJson:function(k){var m={configurationSettings:[],values:{}};l.forEach(this.displayCategorys,function(p,h){var e={category:p.title,fields:[]};
"fullJson"===k&&(e.categoryName=p.name);l.forEach(p.displayFields,function(c,b){var a=this.configTree.findNode(c.fieldPath).getTemplateField(c.fieldJson);e.fields[b]=a;m.values[a.fieldName]=d.getDefaultValue(c.fieldJson.fieldName)},this);m.configurationSettings[h]=e},this);return m},deserialize:function(k,m){if(k){l.forEach(this.displayCategorys,function(d){d.displayFields=[]});this.displayCategorys=[];l.forEach(k.configurationSettings,function(d){var c=this.getCategoryByName(d.categoryName),b=0;
c&&(b=c.deserialize(d.fields,m),0<b&&this.displayCategorys.push(c))},this);var p,h=k.values;for(p in h)h.hasOwnProperty(p)&&"function"!==typeof h[p]&&!d.defaultValueExisted(p)&&d.setDefaultValue(null,h[p],p)}}})})},"builder/dijit/template-config/Category":function(){define(["dojo/_base/declare","dojo/_base/array"],function(r,l){return r([],{name:null,title:null,includeFields:null,excludeFields:null,displayFields:null,constructor:function(d,q,k,m,p,h){this.name=q;this.title=k;this.includeFields=m;
this.excludeFields=p;this.displayFields=[];l.forEach(h,function(e){var c=d.findNode(e);c&&this.displayFields.push({fieldPath:e,fieldJson:c.getTemplateField()})},this)},hasField:function(d){var l=!1,k;for(k=0;k<this.includeFields.length;k++)if(0===d.indexOf(this.includeFields[k])){l=!0;break}for(k=0;k<this.excludeFields.length;k++)if(0===d.indexOf(this.excludeFields[k])){l=!1;break}return l},getDisplayField:function(d){d=this.findFieldFromDisplay(d);return-1!==d?this.displayFields[d]:null},findFieldFromDisplay:function(d){var l;
for(l=0;l<this.displayFields.length;l++)if(this.displayFields[l].fieldPath===d)return l;return-1},addFieldToDisplay:function(d){var l;l=this.findFieldFromDisplay(d.fieldPath);-1===l?this.displayFields.push({fieldPath:d.fieldPath,fieldJson:d.fieldJson}):this.displayFields[l].fieldJson=d.fieldJson},removeFieldFromDisplay:function(d){var l;l=this.findFieldFromDisplay(d);0<=l&&this.displayFields.splice(l,1);return d},moveup:function(d){var l;d=this.findFieldFromDisplay(d);return 0<d?(l=this.displayFields[d],
this.displayFields[d]=this.displayFields[d-1],this.displayFields[d-1]=l,!0):!1},movedown:function(d){var l;d=this.findFieldFromDisplay(d);return 0<=d&&d<this.displayFields.length-1?(l=this.displayFields[d],this.displayFields[d]=this.displayFields[d+1],this.displayFields[d+1]=l,!0):!1},displayIsEmpty:function(){return 0===this.displayFields.length},deserialize:function(d,q){this.displayFields=[];l.forEach(d,function(d){var k;k=d.fieldName.replace(/\//g,"_");(k=q.findNodeById(k))&&this.displayFields.push({fieldPath:k.absolutePath,
fieldJson:d})},this);return this.displayFields.length}})})},"builder/dijit/template-config/Export":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/html dijit/dijit dijit/_WidgetBase dijit/_TemplatedMixin dojo/text!./templates/Export.html dojo/Deferred dojo/promise/all dojo/dom-style dojo/dom-attr dojo/json jimu/dijit/Message jimu/dijit/LoadingShelter builder/portalUtils ./ExportMessage jimu/dijit/Popup builder/dijit/ItemInfo builder/serviceUtils builder/PluginManager".split(" "),
function(r,l,d,q,k,m,p,h,e,c,b,a,g,u,n,t,f,v,x,w){return r([k,m],{templateString:p,baseClass:"export-agoltemplate",_templateUrl:null,_temlateJson:null,_fullTemplateJson:null,pluginManager:null,_afterAddItemOfExportCallback:null,isExportWABTemplate:null,appInfo:null,constructor:function(){this.pluginManager=w.getInstance()},startup:function(){this.isExportWABTemplate?this.popupWABTemplateDlg():this.popupAGOLTemplateDlg()},popupAGOLTemplateDlg:function(a){this.isExportWABTemplate=!1;this._initToAGOLTemplateDlgPage();
this.popup=new f({content:this,container:"main-page",titleLabel:this.nls.title2,width:669,autoHeight:!0,buttons:[{label:this.nls.ok,onClick:l.hitch(this,this._onNextClick)},{label:this.nls.cancel,classNames:["jimu-btn-vacation"],onClick:l.hitch(this,this._onCancelClick)}]});this.loading=new u({hidden:!0});this.loading.placeAt(this.popup.domNode)},popupWABTemplateDlg:function(){this.isExportWABTemplate=!0;this._initToWABTemplateDlgPage();this.popup=new f({content:this,container:"main-page",titleLabel:this.nls.exportPopupTitleForWab,
width:669,autoHeight:!0,buttons:[{label:this.nls.ok,onClick:l.hitch(this,this._onNextClick)},{label:this.nls.cancel,classNames:["jimu-btn-vacation"],onClick:l.hitch(this,this._onCancelClick)}]});this.loading=new u({hidden:!0});this.loading.placeAt(this.popup.domNode)},_initToAGOLTemplateDlgPage:function(){window.isXT&&(b.set(this.explain1,"innerHTML",this.nls.explain1),c.set(this.explain1,"display","block"));this.itemInfoDijit=new v({itemInfo:this.getDefaultAppInfo()});this.itemInfoDijit.placeAt(this.itemInfoBox)},
_initToWABTemplateDlgPage:function(){var a=this.getDefaultAppInfo();window.isXT&&(b.set(this.templateTitle,"innerHTML",this.nls.templateTitleForWAB),a.tags=void 0,a.folderId=void 0,a.sharing=void 0,a.thumbnail="/webappbuilder/builder/images/templatethumbnail.jpg");this.itemInfoDijit=new v({itemInfo:a});this.itemInfoDijit.placeAt(this.itemInfoBox)},getDefaultAppInfo:function(){return{name:"",description:this.nls.templateDefaultSnippet,tags:["template"],folderId:"",sharing:void 0,thumbnail:void 0}},
_onNextClick:function(){this.isExportWABTemplate?this._exportWABTemplate():this._exportAGOLTemplate()},_onCancelClick:function(){this.close()},close:function(){this.popup.close()},_exportAGOLTemplate:function(){var a=this.itemInfoDijit.getProperties();a.name&&a.tags?(this.loading.show(),this.exportAGOLTemplate(a,this._templateUrl,this._fullTemplateJson,this._afterAddItemOfExportCallback).then(l.hitch(this,function(a){this.close();this.loading.hide();t._exportedMessage(a,this.nls.exportMessageTitle,
this.nls)}),l.hitch(this,function(a){this.close();this.loading.hide();t._exportedMessage(a,this.nls.exportMessageTitle,this.nls)}))):new g({message:this.nls.noTitleMessage})},_exportWABTemplate:function(){var b=this.itemInfoDijit.getProperties();if(b.name){this.loading.show();var c=this.pluginManager.getPluginByName("app-list");this.exportWABTemplate(b,a.parse(this._fullTemplateJson),this._afterAddItemOfExportCallback).then(l.hitch(this,function(){this.close();this.loading.hide();c&&(c._onSwitchToTemplateContent(),
c.refreshTemplatePage());new f({content:this.nls.exportSuccessfulForWab,titleLabel:this.nls.exportPopupTitleForWab,width:"600",autoHeight:!0,buttons:[{label:this.nls.ok}]})}),l.hitch(this,function(){this.close();this.loading.hide()}))}else new g({message:this.nls.noTitleMessage})},exportAGOLTemplate:function(a,b,c,d){var f=new h,g=new h,k=new h,m=new h,p="http://"+window.location.host+window.location.pathname,q=p.indexOf("index.html");-1!==q&&(p=p.slice(0,q));var p=p+"builder/css/images/agoltemplate/templateThumbnail.jpg",
t=n.getPortal(window.portalUrl);t.getUser().then(l.hitch(this,function(b){var c={q:"owner:"+b.username+" title:"+a.name+' type:"Web Mapping Application"'},d=builderNls.titleExist.replace("${TITLE}",a.name);t.queryItems(c).then(l.hitch(this,function(a){0<a.total?(g.reject(),f.reject({itemId:null,message:d})):g.resolve(b)}),l.hitch(this,function(a){g.reject(a);console.error(a.message||a);f.reject({itemId:null,message:this.nls.exportTemplateFailed5})}))}),l.hitch(this,function(a){g.reject(a);console.error(a.message||
a);f.reject({itemId:null,message:this.nls.exportTemplateFailed5})}));g.then(l.hitch(this,function(e){var g={title:a.name,snippet:a.description,tags:a.tags,url:b,thumbnailurl:p,type:"Web Mapping Application",typeKeywords:"Configurable, JavaScript, selfConfigured",text:c},h="";"HTML"===window.appInfo.appType?h="WAB2D":"HTML3D"===window.appInfo.appType&&(h="WAB3D, 3Dscene");g.typeKeywords=(window.isXT?"Configurable, JavaScript, WABTemplate, WABTemplateFromXT, ":"Configurable, JavaScript, selfConfigured, WABTemplate, WABTemplateFromAGOL, ")+
h;a.folderId===e.username&&(a.folderId="");e.addItem(g,a.folderId).then(l.hitch(this,function(a){a.success?(k.resolve(a),d(a.id)):(console.error(a.message||""),k.reject(this.nls.exportTemplateFailed1))}),l.hitch(this,function(a){k.reject(a);console.error(a.message||a);f.reject({itemId:null,message:this.nls.exportTemplateFailed1})}))}));n.getTemplatesGroup(window.portalUrl).then(l.hitch(this,function(a){m.resolve(a)}),l.hitch(this,function(a){m.reject(a);console.error(a.message||a);f.reject({itemId:null,
message:this.nls.exportTemplateFailed2})}));e({user:g,itemRes:k,templateGroup:m}).then(l.hitch(this,function(b){b.user.shareItem({groups:b.templateGroup.id},b.itemRes.id,a.folderId).then(l.hitch(this,function(a){-1===a.notSharedWith.indexOf(b.templateGroup.id)?f.resolve({itemId:b.itemRes.id,message:this.nls.exportSuccessful}):f.reject({itemId:b.itemRes.id,message:this.nls.exportTemplateFailed3,type:"no_permission_to_share"})}),l.hitch(this,function(a){console.error(a.message||a);f.reject({itemId:b.itemRes.id,
message:this.nls.exportTemplateFailed4})}))}));return f},exportWABTemplate:function(a,b,c){var d=new h;a={name:a.name,description:a.description,fromAppId:this.appInfo.id,saveAsTemplate:!0,thumbnail:a.thumbnail};var e=l.clone(window.appConfig);e.templateConfig=b;delete e.isTemplateApp;x.saveAs(a,e.getCleanConfig()).then(l.hitch(this,function(a){a.success?(d.resolve(),c()):(console.error("exportWABTemplate failed: duplicateApp response's success is false"),new g({message:"Exported as web app template failed."}),
d.reject())}),l.hitch(this,function(a){console.error("exportWABTemplate failed: duplicateApp error: "+a);new g({message:"Exported as web app template failed"});d.reject()}));return d}})})},"dijit/dijit":function(){define("./main ./_base dojo/parser ./_Widget ./_TemplatedMixin ./_Container ./layout/_LayoutWidget ./form/_FormWidget ./form/_FormValueWidget".split(" "),function(r){return r})},"dijit/_base":function(){define("./main ./a11y ./WidgetSet ./_base/focus ./_base/manager ./_base/place ./_base/popup ./_base/scroll ./_base/sniff ./_base/typematic ./_base/wai ./_base/window".split(" "),
function(r){return r._base})},"dijit/WidgetSet":function(){define(["dojo/_base/array","dojo/_base/declare","dojo/_base/kernel","./registry"],function(r,l,d,q){var k=l("dijit.WidgetSet",null,{constructor:function(){this._hash={};this.length=0},add:function(d){if(this._hash[d.id])throw Error("Tried to register widget with id\x3d\x3d"+d.id+" but that id is already registered");this._hash[d.id]=d;this.length++},remove:function(d){this._hash[d]&&(delete this._hash[d],this.length--)},forEach:function(k,
l){l=l||d.global;var h=0,e;for(e in this._hash)k.call(l,this._hash[e],h++,this._hash);return this},filter:function(l,p){p=p||d.global;var h=new k,e=0,c;for(c in this._hash){var b=this._hash[c];l.call(p,b,e++,this._hash)&&h.add(b)}return h},byId:function(d){return this._hash[d]},byClass:function(d){var l=new k,h,e;for(h in this._hash)e=this._hash[h],e.declaredClass==d&&l.add(e);return l},toArray:function(){var d=[],k;for(k in this._hash)d.push(this._hash[k]);return d},map:function(d,k){return r.map(this.toArray(),
d,k)},every:function(k,l){l=l||d.global;var h=0,e;for(e in this._hash)if(!k.call(l,this._hash[e],h++,this._hash))return!1;return!0},some:function(k,l){l=l||d.global;var h=0,e;for(e in this._hash)if(k.call(l,this._hash[e],h++,this._hash))return!0;return!1}});r.forEach("forEach filter byClass map every some".split(" "),function(d){q[d]=k.prototype[d]});return k})},"dijit/_base/focus":function(){define("dojo/_base/array dojo/dom dojo/_base/lang dojo/topic dojo/_base/window ../focus ../selection ../main".split(" "),
function(r,l,d,q,k,m,p,h){m.focus=function(d){if(d){var c="node"in d?d.node:d,b=d.bookmark;d=d.openedForWindow;var a=b?b.isCollapsed:!1;if(c){var e="iframe"==c.tagName.toLowerCase()?c.contentWindow:c;if(e&&e.focus)try{e.focus()}catch(u){}m._onFocusNode(c)}if(b&&k.withGlobal(d||k.global,h.isCollapsed)&&!a){d&&d.focus();try{k.withGlobal(d||k.global,h.moveToBookmark,null,[b])}catch(u){}}}};m.watch("curNode",function(d,c,b){h._curFocus=b;h._prevFocus=c;b&&q.publish("focusNode",b)});m.watch("activeStack",
function(d,c,b){h._activeStack=b});m.on("widget-blur",function(d,c){q.publish("widgetBlur",d,c)});m.on("widget-focus",function(d,c){q.publish("widgetFocus",d,c)});d.mixin(h,{_curFocus:null,_prevFocus:null,isCollapsed:function(){return h.getBookmark().isCollapsed},getBookmark:function(){return(k.global==window?p:new p.SelectionManager(k.global)).getBookmark()},moveToBookmark:function(d){return(k.global==window?p:new p.SelectionManager(k.global)).moveToBookmark(d)},getFocus:function(d,c){var b=!m.curNode||
d&&l.isDescendant(m.curNode,d.domNode)?h._prevFocus:m.curNode;return{node:b,bookmark:b&&b==m.curNode&&k.withGlobal(c||k.global,h.getBookmark),openedForWindow:c}},_activeStack:[],registerIframe:function(d){return m.registerIframe(d)},unregisterIframe:function(d){d&&d.remove()},registerWin:function(d,c){return m.registerWin(d,c)},unregisterWin:function(d){d&&d.remove()}});return h})},"dijit/_base/place":function(){define(["dojo/_base/array","dojo/_base/lang","dojo/window","../place","../main"],function(r,
l,d,q,k){var m={getViewport:function(){return d.getBox()}};m.placeOnScreen=q.at;m.placeOnScreenAroundElement=function(d,h,e,c){var b;if(l.isArray(e))b=e;else{b=[];for(var a in e)b.push({aroundCorner:a,corner:e[a]})}return q.around(d,h,b,!0,c)};m.placeOnScreenAroundNode=m.placeOnScreenAroundElement;m.placeOnScreenAroundRectangle=m.placeOnScreenAroundElement;m.getPopupAroundAlignment=function(d,h){var e={};r.forEach(d,function(c){var b=h;switch(c){case "after":e[h?"BR":"BL"]=h?"BL":"BR";break;case "before":e[h?
"BL":"BR"]=h?"BR":"BL";break;case "below-alt":b=!b;case "below":e[b?"BL":"BR"]=b?"TL":"TR";e[b?"BR":"BL"]=b?"TR":"TL";break;case "above-alt":b=!b;default:e[b?"TL":"TR"]=b?"BL":"BR",e[b?"TR":"TL"]=b?"BR":"BL"}});return e};l.mixin(k,m);return k})},"dijit/_base/popup":function(){define(["dojo/dom-class","dojo/_base/window","../popup","../BackgroundIframe"],function(r,l,d){var q=d._createWrapper;d._createWrapper=function(d){d.declaredClass||(d={_popupWrapper:d.parentNode&&r.contains(d.parentNode,"dijitPopup")?
d.parentNode:null,domNode:d,destroy:function(){},ownerDocument:d.ownerDocument,ownerDocumentBody:l.body(d.ownerDocument)});return q.call(this,d)};var k=d.open;d.open=function(d){if(d.orient&&"string"!=typeof d.orient&&!("length"in d.orient)){var l=[],h;for(h in d.orient)l.push({aroundCorner:h,corner:d.orient[h]});d.orient=l}return k.call(this,d)};return d})},"dijit/_base/scroll":function(){define(["dojo/window","../main"],function(r,l){l.scrollIntoView=function(d,l){r.scrollIntoView(d,l)}})},"dijit/_base/sniff":function(){define(["dojo/uacss"],
function(){})},"dijit/_base/typematic":function(){define(["../typematic"],function(){})},"dijit/_base/wai":function(){define(["dojo/dom-attr","dojo/_base/lang","../main","../hccss"],function(r,l,d){l.mixin(d,{hasWaiRole:function(d,k){var l=this.getWaiRole(d);return k?-1<l.indexOf(k):0<l.length},getWaiRole:function(d){return l.trim((r.get(d,"role")||"").replace("wairole:",""))},setWaiRole:function(d,k){r.set(d,"role",k)},removeWaiRole:function(d,k){var m=r.get(d,"role");m&&(k?(m=l.trim((" "+m+" ").replace(" "+
k+" "," ")),r.set(d,"role",m)):d.removeAttribute("role"))},hasWaiState:function(d,k){return d.hasAttribute?d.hasAttribute("aria-"+k):!!d.getAttribute("aria-"+k)},getWaiState:function(d,k){return d.getAttribute("aria-"+k)||""},setWaiState:function(d,k,l){d.setAttribute("aria-"+k,l)},removeWaiState:function(d,k){d.removeAttribute("aria-"+k)}});return d})},"dijit/_base/window":function(){define(["dojo/window","../main"],function(r,l){l.getDocumentWindow=function(d){return r.get(d)}})},"builder/dijit/template-config/ExportMessage":function(){define("dojo/_base/declare dojo/_base/html dijit/_WidgetBase dijit/_TemplatedMixin dojo/text!./templates/ExportMessage.html jimu/portalUrlUtils jimu/dijit/Popup".split(" "),
function(r,l,d,q,k,m,p){var h=r([d,q],{baseClass:"agol-template-export-message",templateString:k,constructor:function(){},postCreate:function(){this.inherited(arguments);"no_permission_to_share"===this.exportedInfo.type?(l.setAttr(this.word1,"innerHTML",this.nls.exportTemplateFailed31),this.exportedInfo.itemUrl&&(l.setAttr(this.itemLink,"innerHTML",this.nls.descriptionTemplateUrl21),l.setAttr(this.itemLink,"href",this.exportedInfo.itemUrl)),l.setAttr(this.word2,"innerHTML",this.nls.exportTemplateFailed32)):
(this.exportedInfo.message&&l.setAttr(this.resMessage,"innerHTML",this.exportedInfo.message),this.exportedInfo.itemUrl&&(l.setAttr(this.word1,"innerHTML",this.nls.descriptionTemplateUrl1),l.setAttr(this.itemLink,"innerHTML",this.nls.descriptionTemplateUrl2),l.setAttr(this.itemLink,"href",this.exportedInfo.itemUrl),l.setAttr(this.word2,"innerHTML",this.nls.descriptionTemplateUrl3)))}});h._exportedMessage=function(d,c,b){d.itemId&&(d.itemUrl=m.getItemDetailsPageUrl(window.portalUrl,d.itemId));d=new h({exportedInfo:d,
nls:b});new p({content:d,titleLabel:c,width:"600",autoHeight:!0,buttons:[{label:b.ok}]})};return h})},"builder/dijit/ItemInfo":function(){define("dojo/_base/declare dojo/_base/array dojo/_base/html dojo/Deferred dijit/_WidgetBase dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dijit/dijit dojo/text!./templates/ItemInfo.html dojo/dom-style dojo/_base/lang dojo/promise/all builder/portalUtils jimu/portalUrlUtils jimu/utils ./Tags dijit/form/SimpleTextarea jimu/dijit/ImageChooser dijit/form/TextBox dijit/form/Select dijit/form/CheckBox".split(" "),
function(r,l,d,q,k,m,p,h,e,c,b,a,g,u,n,t,f,v){return r([k,m,p],{templateString:e,baseClass:"dijit-item-info",postMixInProperties:function(){this.inherited(arguments);this.nls=b.mixin(this.nls,builderNls)},postCreate:function(){this.inherited(arguments);this.tags.nls=this.nls;this._init(this.itemInfo)},_init:function(e){this.appName.focus();void 0===e.tags&&c.set(this.tagsTr,"display","none");void 0===e.folderId&&c.set(this.folderTr,"display","none");void 0===e.sharing&&c.set(this.sharingTr,"display",
"none");void 0===e.thumbnail&&c.set(this.thumbnailTr,"display","none");void 0!==e.tags||void 0!==e.folder?g.getPortal(u.getStandardPortalUrl(window.portalUrl)).getUser().then(b.hitch(this,function(c){var d=[];this.user=c;if(void 0!==e.folderId)d.push(this._initFolder(c));else{var f=new q;f.resolve();d.push(f)}void 0!==e.tags?d.push(h.byId("publish-webmap-tags").loadTags(c)):(c=new q,c.resolve(),d.push(c));a(d).then(b.hitch(this,function(){this.setProperties(e)}),b.hitch(this,function(a){this.setProperties(e);
console.error(a.message||a)}))}),b.hitch(this,function(a){this.setProperties(e);console.error(a.message||a)})):(void 0!==e.thumbnail&&(this.imageChooser=new v({cropImage:!0,showSelfImg:!0,format:[v.GIF,v.JPEG,v.PNG],goldenWidth:300,goldenHeight:200}),d.place(this.imageChooser.domNode,this.imageChooserBase)),this.setProperties(e))},_initFolder:function(a){var c=new q;a.getContent().then(b.hitch(this,function(d){var e=[{label:a.username,value:""}],e=e.concat(l.map(d.folders,b.hitch(this,function(a){return{label:a.title,
value:a.id}})));h.byId("publish-webmap-folder").set("options",e);h.byId("publish-webmap-folder").set("value","");c.resolve()}),function(a){console.error("get userContent error!",a.message);c.reject()});return c},setProperties:function(a){h.byId("publish-webmap-name").set("value",a.name);h.byId("publish-webmap-tags").set("tags",a.tags||[]);h.byId("publish-webmap-summary").set("value",a.description);h.byId("publish-webmap-folder").set("value",a.folderId);h.byId("publish-webmap-sharing").set("checked",
a.sharing);this.imageChooser&&this.imageChooser.setDefaultSelfSrc(a.thumbnail)},getProperties:function(){return{name:n.stripHTML(h.byId("publish-webmap-name").get("value")),tags:h.byId("publish-webmap-tags").get("tags"),description:n.stripHTML(h.byId("publish-webmap-summary").get("value")),folderId:h.byId("publish-webmap-folder").get("value"),sharing:h.byId("publish-webmap-sharing").get("checked"),thumbnail:this.imageChooser&&this.imageChooser.imageData}}})})},"builder/dijit/Tags":function(){define("dojo/_base/array dojo/_base/lang dojo/_base/declare dojo/dom-construct dojo/store/Memory dojo/Deferred dojo/sniff dijit/_TemplatedMixin dijit/_WidgetBase dijit/form/TextBox ./AutoComplete dojo/text!./templates/Tags.html dojo/domReady!".split(" "),
function(r,l,d,q,k,m,p,h,e,c,b,a){return d([e,h],{templateString:a,baseClass:"esriAGOTags",_minWidth:"100%",_maxWidth:"100%",postMixInProperties:function(){this.inherited(arguments)},postCreate:function(){this.inherited(arguments);this._isIE8=p("ie")},startup:function(){this.inherited(arguments)},loadTags:function(a){var b=new m;this._isIE8?(this._textTags||(this.tagsId="userTags-"+(new Date).getTime(),q.create("div",{id:this.tagsId},this.domNode),this._textTags=new c({placeHolder:this.nls.addTags,
trim:!0,style:{minWidth:this._minWidth,maxWidth:this._maxWidth}},this.tagsId)),b.resolve()):a?a.getTags().then(l.hitch(this,function(a){this._handleTags(a);b.resolve()}),l.hitch(this,function(a){console.error("get user tags error: "+a);this._handleTags({tags:[]});b.resolve()})):(this._handleTags({tags:[]}),b.resolve());return b},_handleTags:function(a){if(a){this._autoComplete&&this._autoComplete.clearTags();var c=[];a.tags&&r.forEach(a.tags,l.hitch(this,function(a){c.push(a)}));this._tagStore?(this._tagStore.query({}).forEach(l.hitch(this,
function(a){this._tagStore.remove(a.tag)})),r.forEach(c,l.hitch(this,function(a){this._tagStore.add(a)}))):this._tagStore=new k({idProperty:"tag",data:c});this._autoComplete||(a=(new Date).getTime(),this.tagsId="userTags-"+a,this.gridId="grid-"+a,this.filterId="filter-"+a,q.create("div",{id:this.tagsId,className:"grid_1"},this.domNode),this._autoComplete=new b({placeholder:this.nls.addTags,noDataMsg:this.nls.noTagsFound,idProperty:"tag",gridId:this.gridId,filterId:this.filterId,minWidth:this._minWidth,
maxWidth:this._maxWidth,matchParam:"first",store:this._tagStore,style:{width:this._minWidth}},this.tagsId))}},_getUniqueTags:function(a){return r.filter(a,l.hitch(this,function(b,c){return r.indexOf(a,b)===c}))},_setValueAttr:function(a){this._setTagsAttr(a)},_getValueAttr:function(){return this._getTagsAttr()},_setTagsAttr:function(a){!a||a instanceof Array||(a=a.split(","));this._isIE8?this._textTags&&this._textTags.set("value",this._getUniqueTags(a).join(",")):this._autoComplete&&(this._autoComplete.clearTags(),
this._autoComplete.prepopulate(a?this._getUniqueTags(a):[]))},_getTagsAttr:function(){return this._isIE8?this._textTags?this._textTags.get("value"):"":this._autoComplete&&this._autoComplete.values?this._autoComplete.values.join(","):""},_setMinWidthAttr:function(a){this._minWidth=a},_setMaxWidthAttr:function(a){this._maxWidth=a}})})},"builder/dijit/AutoComplete":function(){define("dojo/_base/array dojo/_base/declare dojo/_base/lang dojo/_base/window dojo/dom dojo/dom-attr dojo/dom-class dojo/dom-construct dojo/dom-style dojo/html dojo/json dojo/keys dojo/on dojo/query dojo/request dojo/string dijit/focus dijit/form/TextBox dijit/registry dijit/_OnDijitClickMixin dijit/_TemplatedMixin dijit/_WidgetBase dgrid/OnDemandGrid dgrid/Selection dgrid/Keyboard dojo/NodeList-traverse dojo/NodeList-manipulate".split(" "),
function(r,l,d,q,k,m,p,h,e,c,b,a,g,u,n,t,f,v,x,w,z,A,y,B,C){return l([A,w,z],{_attachmentNode:"",_autocompleteList:"",_grid:"",_store:"",_matchParam:"",_idProperty:"",_gridId:"",_filterId:"",_placeHolder:"",_noDataMsg:"",_maxWidth:"",_minWidth:"",_inputTextBox:"",_gridHasFocus:!1,_metaKeyPressed:!1,_shiftKeyPressed:!1,_CSS_STYLES:{CLASS_SELECTOR:".",ALL_SELECTOR:"\x3e",MULTI:"select2-container select2-container-multi",CHOICES:"select2-choices",CHOICE:"select2-search-choice",SEARCH_CHOICE_FOCUS:"select2-search-choice-focus",
SEARCH_FIELD:"select2-search-field",CLOSE_ICON:"select2-search-choice-close"},values:[],_selRows:[],_CHOICE_SELECTOR:"",_CHOICE_FOCUS:"",_CHOICE_FOCUS_ALL:"",constructor:function(a,b){this._attachmentNode=b;this._idProperty=a.idProperty;this._gridId=a.gridId;this._filterId=a.filterId;this._store=a.store;this._placeHolder=a.placeholder;this._noDataMsg=a.noDataMsg;this._maxWidth=a.maxWidth;this._minWidth=a.minWidth;this._matchParam=a.matchParam;this.values=[];this._selRows=[];this._CHOICE_ALL_SELECTOR=
this._CSS_STYLES.CLASS_SELECTOR+this._CSS_STYLES.CHOICE+this._CSS_STYLES.ALL_SELECTOR;this._CHOICE_FOCUS=this._CSS_STYLES.CLASS_SELECTOR+this._CSS_STYLES.SEARCH_CHOICE_FOCUS;this._CHOICE_FOCUS_ALL=this._CHOICE_FOCUS+this._CSS_STYLES.ALL_SELECTOR},buildRendering:function(){this._createContainerNode();this._createTagList();this._createDropDownList();this._createInput();var a=d.hitch(this,function(a,b,c){b=this._inputTextBox?this._inputTextBox.get("value")+"":"";if(1>b.length)return!0;if(!a.tag)return!1;
a=(a.tag+"").toLowerCase().match(new RegExp("^"+b.toLowerCase()));return null!==a&&0<a.length?!0:!1}),b=d.hitch(this,function(a,b,c){b=this._inputTextBox?this._inputTextBox.get("value")+"":"";return 1>b.length?!0:a.tag?~(a.tag+"").toLowerCase().indexOf(b.toLowerCase())?!0:!1:!1}),c=[{field:this._idProperty}],e=[{attribute:this._idProperty,ascending:!0}];this._grid=new (l([y,B,C]))({store:this._store,showHeader:!1,noDataMessage:this._noDataMsg,selectionMode:"extended",allowSelectAll:!0,cellNavigation:!1,
columns:c,sort:e,renderRow:this._renderItem},this._gridId);p.add(this._gridId,"gridHeightLimiter");this._grid.query="first"===this._matchParam?a:b},postCreate:function(){var a;this._inputTextBox.watch("value",d.hitch(this,function(b,c,d){a&&(clearTimeout(a),a=null);this._grid.refresh()}));this._grid.on(".dgrid-row:click",d.hitch(this,function(a){var b="";this._shiftKeyPressed||this._metaKeyPressed?a.shiftKey||a.metaKey||a.ctrlKey||(b=this._selRows[0],this._createTags(b),this._store.remove(b),this._grid.refresh(),
this._resetInputTextBox()):(b=this._grid.row(a).data.tag,this._createTags(b),this._store.remove(b),this._grid.refresh(),this._resetInputTextBox())}));this._grid.on("dgrid-deselect",d.hitch(this,function(a){this._selRows=[];for(var b in this._grid.selection)this._selRows.push(b)}));this._grid.on("dgrid-select",d.hitch(this,function(a){this._selRows=[];for(var b in this._grid.selection)this._selRows.push(b)}));this.connect(this.domNode,"keydown","_keydownHandler");window.onkeydown=d.hitch(this,function(a){if(a.shiftKey||
a.ctrlKey||224===a.keyCode)this._metaKeyPressed=!0});this.connect(document,"onkeydown",d.hitch(this,function(a){this._metaKeyPressed=this._shiftKeyPressed=!0}))},_keydownHandler:function(b){var c;void 0!==f.curNode.value&&(c=f.curNode.value.length);var g=u(this._CHOICE_FOCUS,k.byId(this.id)),l=u(this._CSS_STYLES.CLASS_SELECTOR+this._CSS_STYLES.CHOICE,k.byId(this.id)).last();switch(b.keyCode){case a.RIGHT_ARROW:this._navigate(g,c,l,"right");this._hideGrid();break;case a.LEFT_ARROW:this._navigate(g,
c,l,"left");this._hideGrid();break;case a.DOWN_ARROW:b.preventDefault();this._unhighlightTag(g);"none"===e.get(this._gridId,"display")&&this._showGrid();this._gridHasFocus||(this._grid.focus(this._setFocusOnFirstRow(this._grid,0)),this._gridHasFocus=!0);break;case a.UP_ARROW:break;case a.BACKSPACE:var n;if(0===c&&0===u(this._CHOICE_FOCUS_ALL).length&&void 0!==u(this._CHOICE_ALL_SELECTOR)[u(this._CHOICE_ALL_SELECTOR).length-1]&&(n=u(this._CHOICE_ALL_SELECTOR)[u(this._CHOICE_ALL_SELECTOR).length-1].title,
0<u("li",this._attachmentNode).length&&(h.destroy(l[0]),void 0!==n)))try{this._store.add({tag:n})}catch(M){}if(0<u(this._CHOICE_FOCUS_ALL).length&&(n=u(this._CHOICE_FOCUS_ALL).text(),h.destroy(g[0]),void 0!==n))try{this._store.add({tag:n})}catch(M){}this._grid.refresh();0===c&&this._hideGrid();this._removeTag(n);break;case a.CTRL:this._metaKeyPressed=!0;break;case a.META:this._metaKeyPressed=!0;break;case a.SHIFT:this._shiftKeyPressed=!0;break;case a.ENTER:if(0<c){c=f.curNode.value;c=c.split(",");
var m=[];r.forEach(c,function(a,b){-1===r.indexOf(m,a)&&m.push(t.trim(a))});r.forEach(m,d.hitch(this,function(a,b){this._isEmpty(a)||this._contains(this.values,a)||this._createTags(a)}))}else{for(c=0;c<this._selRows.length;c++)this._createTags(this._selRows[c]),this._store.remove(this._selRows[c]);this._metaKeyPressed=this._shiftKeyPressed=!1}this._resetInputTextBox();b.preventDefault();f.focus(k.byId(this._filterId));break;case a.TAB:if(f.curNode.id!==this._filterId||0!==c){if(0<c)c=f.curNode.value,
c=c.split(","),m=[],r.forEach(c,function(a,b){-1===r.indexOf(m,a)&&m.push(t.trim(a))}),r.forEach(m,d.hitch(this,function(a,b){this._isEmpty(a)||this._contains(this.values,a)||this._createTags(a)}));else{for(c=0;c<this._selRows.length;c++)this._createTags(this._selRows[c]),this._store.remove(this._selRows[c]);this._metaKeyPressed=this._shiftKeyPressed=!1}this._resetInputTextBox();b.preventDefault();f.focus(k.byId(this._filterId))}break;case a.ESCAPE:this._hideGrid();break;default:-1<c&&("none"===e.get(k.byId(this._gridId),
"display")&&this._showGrid(),this._unhighlightTag(g)),this._metaKeyPressed=!1}},_blurHandler:function(a,b,c){if(!this.focused){if(0<this._inputTextBox.value.length){var e=[];a=this._inputTextBox.value.split(",");r.forEach(a,function(a,b){-1===r.indexOf(e,a)&&e.push(t.trim(a))});r.forEach(e,d.hitch(this,function(a,b){this._isEmpty(a)||this._contains(this.values,a)||this._createTags(a)}));this._resetInputTextBox()}this._hideGrid()}},_resetInputTextBox:function(){x.byId(this._filterId).set("value","")},
_isEmpty:function(a){a=a.replace(/^\s+|\s+$/,"");return 0===a.length?!0:!1},_navigate:function(a,b,c,d){0<a.length&&1>b?("right"===d?this._hightlightTag(a.next()):this._hightlightTag(a.prev()),this._unhighlightTag(a)):1>b&&this._hightlightTag(c)},_contains:function(a,b){return 0<=r.indexOf(a,b)},_hightlightTag:function(a){a.addClass(this._CSS_STYLES.SEARCH_CHOICE_FOCUS)},_unhighlightTag:function(a){a.removeClass(this._CSS_STYLES.SEARCH_CHOICE_FOCUS)},_removeTag:function(a){a&&-1!==r.indexOf(this.values,
a)&&this.values.splice(r.indexOf(this.values,a),1)},_hideGrid:function(){k.byId(this._gridId)&&e.set(k.byId(this._gridId),"display","none");this._gridHasFocus=!1},_showGrid:function(){e.set(k.byId(this._gridId),"display","block");var a=e.get(k.byId(this._attachmentNode),"width");e.set(k.byId(this._gridId),"width",a+"px")},_setFocusOnFirstRow:function(a,b){return u(".dgrid-content .dgrid-cell",this._grid.domNode)[b]||u(".dgrid-content .dgrid-row",this._grid.domNode)[b]},_createTags:function(a){u(this._CHOICE_FOCUS,
k.byId(this.id)).removeClass("select2-search-choice-focus");var b=h.create("li",null,this._autocompleteList);p.add(b,this._CSS_STYLES.CHOICE);b=h.create("div",{title:a},b);c.set(b,this.htmlEncode(a));b=h.create("a",{href:"#"},b);p.add(b,this._CSS_STYLES.CLOSE_ICON);g(b,"click",d.hitch(this,function(a){var b=a.target.parentElement.innerText||a.target.parentElement.textContent;try{this._store.add({tag:b})}catch(J){}this._grid.refresh();this._removeTag(b);h.destroy(a.target.parentNode.parentNode);a.preventDefault()}));
b=x.byId(this._filterId);h.place(b.domNode,this._autocompleteList,"last");this._hideGrid();this.values.push(a)},_renderItem:function(a){return h.create("div",{innerHTML:a.tag})},_createContainerNode:function(){this.domNode=h.create("div",null,this._attachmentNode);p.add(this.domNode,this._CSS_STYLES.MULTI);e.set(this.domNode,"maxWidth",this._maxWidth);e.set(this.domNode,"minWidth",this._minWidth)},_createTagList:function(){this._autocompleteList=h.create("ul",null,this.domNode);p.add(this._autocompleteList,
this._CSS_STYLES.CHOICES)},_createInput:function(){var a=h.create("li",null,this._autocompleteList,"last");p.add(a,this._CSS_STYLES.SEARCH_FIELD);this._inputTextBox=new v({id:this._filterId,placeHolder:this._placeHolder,intermediateChanges:!0,trim:!0,style:{border:"none"}},a);p.add(this._inputTextBox,"inputTextBox");e.set(this._inputTextBox,"width",this._minWidth);f.watch("curNode",d.hitch(this,this._blurHandler))},_createDropDownList:function(){var a=h.create("div",{id:this._gridId},this.domNode);
p.add(a,"dropDownList");e.set(a,"width",this._minWidth)},prepopulate:function(a){r.forEach(a,d.hitch(this,function(a,b){this._createTags(a);this._store.remove(a)}))},clearTags:function(){var a=u(this._CSS_STYLES.CLASS_SELECTOR+this._CSS_STYLES.CHOICE,k.byId(this.id));0<a.length&&(r.forEach(a,d.hitch(this,function(a,b){try{this._store.add({tag:u(this._CHOICE_ALL_SELECTOR,k.byId(this.id))[0].title})}catch(G){}h.destroy(a)})),this.values=[])},addStyledTags:function(a,b){p.add(k.byId(b),this._CSS_STYLES.MULTI);
var d=h.create("ul",null,k.byId(b));p.add(d,this._CSS_STYLES.CHOICES);e.set(d,"border","none");r.forEach(a,function(a,b){var f=h.create("li",null,d);e.set(f,"padding","3px 5px 3px 5px");p.add(f,"select2-search-resultSet");f=h.create("div",{title:a},f);c.set(f,a)})},htmlEncode:function(a){return a?a.replace(/&/g,"\x26amp;").replace(/>/g,"\x26gt;").replace(/</g,"\x26lt;").replace(/"/g,"\x26quot;"):a}})})},"dgrid/OnDemandGrid":function(){define(["dojo/_base/declare","./Grid","./OnDemandList"],function(r,
l,d){return r("dgrid.OnDemandGrid",[l,d],{})})},"dgrid/Grid":function(){define("dojo/_base/kernel dojo/_base/declare dojo/on dojo/has put-selector/put ./List ./util/misc dojo/_base/sniff".split(" "),function(r,l,d,q,k,m,p){function h(b,a){a&&a.nodeType&&b.appendChild(a)}function e(b,a,c,d){if(this.formatter){d=this.formatter;var e=this.grid.formatterScope;c.innerHTML="string"===typeof d&&e?e[d](a,b):this.formatter(a,b)}else null!=a&&c.appendChild(document.createTextNode(a))}var c=8>q("ie")&&!q("quirks");
l=l("dgrid.Grid",m,{columns:null,cellNavigation:!0,tabableHeader:!0,showHeader:!0,column:function(b){return"object"!=typeof b?this.columns[b]:this.cell(b).column},listType:"grid",cell:function(b,a){if(b.column&&b.element)return b;b.target&&b.target.nodeType&&(b=b.target);var c;if(b.nodeType){do{if(this._rowIdToObject[b.id])break;var d=b.columnId;if(d){a=d;c=b;break}b=b.parentNode}while(b&&b!=this.domNode)}if(!c&&"undefined"!=typeof a){var e=this.row(b);if(d=e&&e.element)for(var d=d.getElementsByTagName("td"),
h=0;h<d.length;h++)if(d[h].columnId==a){c=d[h];break}}if(null!=b)return{row:e||this.row(b),column:a&&this.column(a),element:c}},createRowCells:function(b,a,d,e){var g=k("table.dgrid-row-table[role\x3dpresentation]"),h=9>q("ie")||q("quirks")?k(g,"tbody"):g,f,l,m,u,r,A,y,B,C,E;d=d||this.subRows;l=0;for(m=d.length;l<m;l++)for(A=d[l],f=k(h,"tr"),A.className&&k(f,"."+A.className),u=0,r=A.length;u<r;u++){y=A[u];B=y.id;C=y.field?".field-"+p.escapeCssIdentifier(y.field,"-"):"";(E="function"===typeof y.className?
y.className(e):y.className)&&(C+="."+E);C=k(b+(".dgrid-cell.dgrid-cell-padding"+(B?".dgrid-column-"+p.escapeCssIdentifier(B,"-"):"")+C.replace(/ +/g,"."))+"[role\x3d"+("th"===b?"columnheader":"gridcell")+"]");C.columnId=B;c?(B=k(C,"!dgrid-cell-padding div.dgrid-cell-padding"),C.contents=B):B=C;if(E=y.colSpan)C.colSpan=E;if(E=y.rowSpan)C.rowSpan=E;a(B,y);f.appendChild(C)}return g},left:function(b,a){b.element||(b=this.cell(b));return this.cell(this._move(b,-(a||1),"dgrid-cell"))},right:function(b,
a){b.element||(b=this.cell(b));return this.cell(this._move(b,a||1,"dgrid-cell"))},renderRow:function(b,a){var c=this.createRowCells("td",function(c,d){var g=b;d.get?g=d.get(b):"field"in d&&"_item"!=d.field&&(g=g[d.field]);d.renderCell?h(c,d.renderCell(b,g,c,a)):e.call(d,b,g,c,a)},a&&a.subRows,b);return k("div[role\x3drow]\x3e",c)},renderHeader:function(){var b=this,a=this.headerNode,e=a.childNodes.length;for(a.setAttribute("role","row");e--;)k(a.childNodes[e],"!");e=this.createRowCells("th",function(a,
b){var d=b.headerNode=a;c&&(a=a.parentNode);var e=b.field;e&&(a.field=e);b.renderHeaderCell?h(d,b.renderHeaderCell(d)):("label"in b||b.field)&&d.appendChild(document.createTextNode("label"in b?b.label:b.field));!1!==b.sortable&&e&&"_item"!=e&&(a.sortable=!0,a.className+=" dgrid-sortable")},this.subRows&&this.subRows.headerRows);this._rowIdToObject[e.id=this.id+"-header"]=this.columns;a.appendChild(e);this._sortListener&&this._sortListener.remove();this._sortListener=d(e,"click,keydown",function(c){if("click"==
c.type||32==c.keyCode||!q("opera")&&13==c.keyCode){var e=c.target,g,f,h;do if(e.sortable){h=[{attribute:g=e.field||e.columnId,descending:(f=b._sort[0])&&f.attribute==g&&!f.descending}];g={bubbles:!0,cancelable:!0,grid:b,parentType:c.type,sort:h};d.emit(c.target,"dgrid-sort",g)&&(b._sortNode=e,b.set("sort",h));break}while((e=e.parentNode)&&e!=a)}})},resize:function(){var b=this.headerNode.firstChild,a=this.contentNode,c;this.inherited(arguments);if(!q("ie")||7<q("ie")&&!q("quirks"))a.style.width="",
a&&b&&(c=b.offsetWidth)!=a.offsetWidth&&(a.style.width=c+"px")},destroy:function(){this._destroyColumns();this._sortListener&&this._sortListener.remove();this.inherited(arguments)},_setSort:function(b,a){this.inherited(arguments);this.updateSortArrow(this._sort)},_findSortArrowParent:function(b){var a=this.columns,c;for(c in a){var d=a[c];if(d.field==b)return d.headerNode}},updateSortArrow:function(b,a){this._lastSortedArrow&&(k(this._lastSortedArrow,"\x3c!dgrid-sort-up!dgrid-sort-down"),k(this._lastSortedArrow,
"!"),delete this._lastSortedArrow);a&&(this._sort=b);if(b[0]){var c=b[0].attribute,d=b[0].descending,c=this._sortNode||this._findSortArrowParent(c),e;delete this._sortNode;c&&(c=c.contents||c,e=this._lastSortedArrow=k("div.dgrid-sort-arrow.ui-icon[role\x3dpresentation]"),e.innerHTML="\x26nbsp;",c.insertBefore(e,c.firstChild),k(c,d?".dgrid-sort-down":".dgrid-sort-up"),this.resize())}},styleColumn:function(b,a){return this.addCssRule("#"+p.escapeCssIdentifier(this.domNode.id)+" .dgrid-column-"+p.escapeCssIdentifier(b,
"-"),a)},_configColumns:function(b,a){var c=[],d=a instanceof Array;p.each(a,function(e,g){"string"==typeof e&&(a[g]=e={label:e});d||e.field||(e.field=g);g=e.id=e.id||(isNaN(g)?g:b+g);this._configColumn&&(this._configColumn(e,g,a,b),g=e.id);d&&(this.columns[g]=e);e.grid=this;"function"===typeof e.init&&e.init();c.push(e)},this);return d?a:c},_destroyColumns:function(){var b=this.subRows,a=b&&b.length,c,d,e,h;this.cleanup();for(c=0;c<a;c++)for(d=0,h=b[c].length;d<h;d++)e=b[c][d],"function"===typeof e.destroy&&
e.destroy()},configStructure:function(){var b=this.subRows,a=this._columns=this.columns;this.columns=!a||a instanceof Array?{}:a;if(b)for(a=0;a<b.length;a++)b[a]=this._configColumns(a+"-",b[a]);else this.subRows=[this._configColumns("",a)]},_getColumns:function(){return this._columns||this.columns},_setColumns:function(b){this._destroyColumns();this.subRows=null;this.columns=b;this._updateColumns()},_setSubRows:function(b){this._destroyColumns();this.subRows=b;this._updateColumns()},setColumns:function(b){r.deprecated("setColumns(...)",
'use set("columns", ...) instead',"dgrid 0.4");this.set("columns",b)},setSubRows:function(b){r.deprecated("setSubRows(...)",'use set("subRows", ...) instead',"dgrid 0.4");this.set("subRows",b)},_updateColumns:function(){this.configStructure();this.renderHeader();this.refresh();this._lastCollection&&this.renderArray(this._lastCollection);this._started&&(this._sort&&this._sort.length?this.updateSortArrow(this._sort):this.resize())}});l.appendIfNode=h;l.defaultRenderCell=e;return l})},"put-selector/put":function(){(function(r){var l,
d=/[-+,> ]/;r([],l=function(q,k){function m(b){function a(){f&&t&&f!=t&&(t==b&&(g||(g=d.test(z)&&q.createDocumentFragment()))?g:t).insertBefore(f,l||null)}for(var g,k,l,t,f,r=arguments,x=r[0],w=0;w<r.length;w++){var z=r[w];if("object"==typeof z){k=!1;if(z instanceof Array){f=q.createDocumentFragment();for(var A=0;A<z.length;A++)f.appendChild(m(z[A]));z=f}if(z.nodeType)f=z,a(),t=z,l=0;else for(A in z)f[A]=z[A]}else if(k)k=!1,f.appendChild(q.createTextNode(z));else{1>w&&(b=null);k=!0;if(x=z.replace(p,
function(d,g,k,n,p,u){g&&(a(),"-"==g||"+"==g?(t=(l=f||t).parentNode,f=null,"+"==g&&(l=l.nextSibling)):("\x3c"==g?t=f=(f||t).parentNode:(","==g?t=b:f&&(t=f),f=null),l=0),f&&(t=f));if((d=!k&&n)||!f&&(k||p))"$"==d?(d=r[++w],t.appendChild(q.createTextNode(d))):(d=d||m.defaultTag,(g=c&&r[w+1]&&r[w+1].name)&&(d="\x3c"+d+' name\x3d"'+g+'"\x3e'),f=e&&~(h=d.indexOf("|"))?q.createElementNS(e[d.slice(0,h)],d.slice(h+1)):q.createElement(d));if(k)if("$"==n&&(n=r[++w]),"#"==k)f.id=n;else if(g=(d=f.className)&&
(" "+d+" ").replace(" "+n+" "," "),"."==k)f.className=d?(g+n).substring(1):n;else if("!"==z){var v;c?m("div",f,"\x3c").innerHTML="":(v=f.parentNode)&&v.removeChild(f)}else g=g.substring(1,g.length-1),g!=d&&(f.className=g);p&&("$"==u&&(u=r[++w]),"style"==p?f.style.cssText=u:(k="!"==p.charAt(0)?(p=p.substring(1))&&"removeAttribute":"setAttribute",u=""===u?p:u,e&&~(h=p.indexOf("|"))?f[k+"NS"](e[p.slice(0,h)],p.slice(h+1),u):f[k](p,u)));return""}))throw new SyntaxError("Unexpected char "+x+" in "+z);
a();t=x=f||t}}b&&g&&b.appendChild(g);return x}d=k||d;var p=/(?:\s*([-+ ,<>]))?\s*(\.|!\.?|#)?([-\w\u00A0-\uFFFF%$|]+)?(?:\[([^\]=]+)=?['"]?([^\]'"]*)['"]?\])?/g,h,e=!1;q=q||document;var c="object"==typeof q.createElement;m.addNamespace=function(b,a){q.createElementNS?(e||(e={}))[b]=a:q.namespaces.add(b,a)};m.defaultTag="div";m.forDocument=l;return m})})(function(r,l,d){d=d||l;"function"===typeof define?define([],function(){return d()}):"undefined"==typeof window?require("./node-html")(module,d):put=
d()})},"dgrid/List":function(){define("dojo/_base/kernel dojo/_base/declare dojo/dom dojo/on dojo/has ./util/misc dojo/has!touch?./TouchScroll xstyle/has-class put-selector/put dojo/_base/sniff xstyle/css!./css/dgrid.css".split(" "),function(r,l,d,q,k,m,p,h,e){function c(a,b){e(document.body,a,".dgrid-scrollbar-measure");var c=a["offset"+b]-a["client"+b];a.className="";document.body.removeChild(a);return c}function b(a){var b=a?"."+a.replace(v,"."):"";this._class&&(b="!"+this._class.replace(v,"!")+
b);e(this.domNode,b);this._class=a}function a(){return this._class}function g(){return{x:this.bodyNode.scrollLeft,y:this.bodyNode.scrollTop}}function u(a){"undefined"!==typeof a.x&&(this.bodyNode.scrollLeft=a.x);"undefined"!==typeof a.y&&(this.bodyNode.scrollTop=a.y)}h("mozilla","opera","webkit","ie","ie-6","ie-6-7","quirks","no-quirks","touch");var n,t;k.add("dom-scrollbar-width",function(a,b,d){return c(d,"Width")});k.add("dom-scrollbar-height",function(a,b,d){return c(d,"Height")});k.add("dom-rtl-scrollbar-left",
function(a,b,c){a=e("div");e(document.body,c,".dgrid-scrollbar-measure[dir\x3drtl]");e(c,a);b=!!k("ie")||!!k("trident")||a.offsetLeft>=k("dom-scrollbar-width");c.className="";document.body.removeChild(c);e(a,"!");c.removeAttribute("dir");return b});var f=0,v=/ +/g,x=7>k("ie")&&!k("quirks")?function(){var a,b,c;this._started&&(a=document.documentElement,b=a.clientWidth,a=a.clientHeight,c=this._prevWinDims||[],c[0]!==b||c[1]!==a)&&(this.resize(),this._prevWinDims=[b,a])}:function(){this._started&&this.resize()};
return l("dgrid.List",k("touch")?p:null,{tabableHeader:!1,showHeader:!1,showFooter:!1,maintainOddEven:!0,cleanAddedRules:!0,useTouchScroll:null,addUiClasses:!0,shouldObserveStore:!0,cleanEmptyObservers:!0,highlightDuration:250,postscript:function(a,b){var c=this;(this._Row=function(a,b,c){this.id=a;this.data=b;this.element=c}).prototype.remove=function(){c.removeRow(this.element)};b&&(this.srcNodeRef=b=b.nodeType?b:document.getElementById(b));this.create(a,b)},listType:"list",create:function(a,c){var d=
this.domNode=c||e("div"),g;a?(this.params=a,l.safeMixin(this,a),g=a["class"]||a.className||d.className,this._sort=a.sort||[],delete this.sort):this._sort=[];this.observers=[];this._numObservers=0;this._listeners=[];this._rowIdToObject={};this.postMixInProperties&&this.postMixInProperties();this.id=d.id=d.id||this.id||"dgrid_"+f++;null===this.useTouchScroll&&(this.useTouchScroll=!k("dom-scrollbar-width"));this.buildRendering();g&&b.call(this,g);this.postCreate();delete this.srcNodeRef;this.domNode.offsetHeight&&
this.startup()},buildRendering:function(){var a=this.domNode,b=this.addUiClasses,c=this,d,f,g,h;h=this.isRTL="rtl"==(document.body.dir||document.documentElement.dir||document.body.style.direction).toLowerCase();a.className="";e(a,"[role\x3dgrid].dgrid.dgrid-"+this.listType+(b?".ui-widget":""));d=this.headerNode=e(a,"div.dgrid-header.dgrid-header-row"+(b?".ui-widget-header":"")+(this.showHeader?"":".dgrid-header-hidden"));(k("quirks")||8>k("ie"))&&e(a,"div.dgrid-spacer");f=this.bodyNode=e(a,"div.dgrid-scroller");
k("ff")&&(f.tabIndex=-1);this.headerScrollNode=e(a,"div.dgrid-header.dgrid-header-scroll.dgrid-scrollbar-width"+(b?".ui-widget-header":""));g=this.footerNode=e("div.dgrid-footer"+(this.showFooter?"":".dgrid-footer-hidden"));e(a,g);h&&(a.className+=" dgrid-rtl"+(k("dom-rtl-scrollbar-left")?" dgrid-rtl-swap":""));q(f,"scroll",function(b){c.showHeader&&(d.scrollLeft=b.scrollLeft||f.scrollLeft);b.stopPropagation();q.emit(a,"scroll",{scrollTarget:f})});this.configStructure();this.renderHeader();this.contentNode=
this.touchNode=e(this.bodyNode,"div.dgrid-content"+(b?".ui-widget-content":""));this._listeners.push(this._resizeHandle=q(window,"resize",m.throttleDelayed(x,this)))},postCreate:k("touch")?function(){this.useTouchScroll&&this.inherited(arguments)}:function(){},startup:function(){this._started||(this.inherited(arguments),this._started=!0,this.resize(),this.set("sort",this._sort))},configStructure:function(){},resize:function(){var a=this.bodyNode,b=this.headerNode,c=this.footerNode,d=b.offsetHeight,
e=this.showFooter?c.offsetHeight:0,f=k("quirks")||7>k("ie");this.headerScrollNode.style.height=a.style.marginTop=d+"px";a.style.marginBottom=e+"px";f&&(a.style.height="",a.style.height=Math.max(this.domNode.offsetHeight-d-e,0)+"px",e&&(c.style.bottom="1px",setTimeout(function(){c.style.bottom=""},0)));n||(n=k("dom-scrollbar-width"),t=k("dom-scrollbar-height"),k("ie")&&(n++,t++),m.addCssRule(".dgrid-scrollbar-width","width: "+n+"px"),m.addCssRule(".dgrid-scrollbar-height","height: "+t+"px"),17==n||
f||(m.addCssRule(".dgrid-header-row","right: "+n+"px"),m.addCssRule(".dgrid-rtl-swap .dgrid-header-row","left: "+n+"px")));f&&(b.style.width=a.clientWidth+"px",setTimeout(function(){b.scrollLeft=a.scrollLeft},0))},addCssRule:function(a,b){var c=m.addCssRule(a,b);this.cleanAddedRules&&this._listeners.push(c);return c},on:function(a,b){var c=q(this.domNode,a,b);k("dom-addeventlistener")||this._listeners.push(c);return c},cleanup:function(){var a=this.observers,b;for(b in this._rowIdToObject)if(this._rowIdToObject[b]!=
this.columns){var c=document.getElementById(b);c&&this.removeRow(c,!0)}for(b=0;b<a.length;b++)(c=a[b])&&c.cancel();this.observers=[];this._numObservers=0;this.preload=null},destroy:function(){if(this._listeners){for(var a=this._listeners.length;a--;)this._listeners[a].remove();delete this._listeners}this._started=!1;this.cleanup();e(this.domNode,"!");this.useTouchScroll&&this.inherited(arguments)},refresh:function(){this.cleanup();this._rowIdToObject={};this._autoId=0;this.contentNode.innerHTML="";
this.scrollTo({x:0,y:0})},newRow:function(a,b,c,d,f){if(b){var g=this.insertRow(a,b,c,d,f);e(g,".dgrid-highlight"+(this.addUiClasses?".ui-state-highlight":""));setTimeout(function(){e(g,"!dgrid-highlight!ui-state-highlight")},this.highlightDuration);return g}},adjustRowIndices:function(a){var b=a.rowIndex;if(-1<b){do-1<a.rowIndex&&(this.maintainOddEven&&-1<(a.className+" ").indexOf("dgrid-row ")&&e(a,"."+(1==b%2?"dgrid-row-odd":"dgrid-row-even")+"!"+(0==b%2?"dgrid-row-odd":"dgrid-row-even")),a.rowIndex=
b++);while((a=a.nextSibling)&&a.rowIndex!=b)}},renderArray:function(a,b,c){function e(){var b=arguments;if(-1<q)for(var d=0;d<b.length;d++){var e=b[d],g=m[e?0:m.length-1];if(g=g&&f(g)){var h=g[e?"previousSibling":"nextSibling"];h&&(h=k.row(h));h&&h.element!=g&&(e=e?"unshift":"push",a[e](h.data),m[e](h.element),c.count++)}}}function f(a){return!d.isDescendant(a,k.domNode)&&document.getElementById(a.id)?k.row(a.id.slice(k.id.length+5)).element:a}function g(a){r=k.insertRow(a,u,null,l++,c);r.observerIndex=
q;return r}function h(a){w=a.slice(0);(p=b?b.parentNode:k.contentNode)&&p.parentNode&&(p!==k.contentNode||a.length)?(p.insertBefore(u,b||null),(r=a[a.length-1])&&k.adjustRowIndices(r)):n[q]&&k.cleanEmptyObservers&&"undefined"!==typeof q&&(n[q].cancel(),n[q]=0,k._numObservers--);m=a;t&&(t.rows=m)}c=c||{};var k=this,l=c.start||0,n=this.observers,m,p,q;b||(this._lastCollection=a);if(a.observe&&this.shouldObserveStore){k._numObservers++;var t=a.observe(function(d,g,h){var l,n,t;-1<g&&m[g]&&(l=m.splice(g,
1)[0],l.parentNode==p&&((n=l.nextSibling)&&g!=h&&n.rowIndex--,k.removeRow(l)),c.count--,k._processScroll&&k._processScroll());if(-1<h){if(m.length)if(0===h)t=(t=m[h])&&f(t);else{if(t=m[h-1])t=f(t),t=(t.connected||t).nextSibling}else t=k._getFirstRowSibling&&k._getFirstRowSibling(p);l&&t&&l.id===t.id&&(t=(t.connected||t).nextSibling);t&&!t.parentNode&&(t=document.getElementById(t.id));l=b&&b.parentNode||t&&t.parentNode||k.contentNode;if(l=k.newRow(d,l,t,c.start+h,c))if(l.observerIndex=q,m.splice(h,
0,l),!n||h<g)n=(n=l.previousSibling)&&n.rowIndex+1!=l.rowIndex&&0!=l.rowIndex?n:l;c.count++}0===g?e(1,1):g===a.length-(-1===h?0:1)&&e(0,0);g!=h&&n&&k.adjustRowIndices(n);k._onNotification(m,d,g,h)},!0);q=n.push(t)-1}var u=document.createDocumentFragment(),r,w;if(a.map){if(m=a.map(g,console.error),m.then)return a.then(function(b){a=b;return m.then(function(a){h(a);e(1,1,0,0);return w})})}else{m=[];for(var v=0,x=a.length;v<x;v++)m[v]=g(a[v])}h(m);e(1,1,0,0);return w},_onNotification:function(a,b,c,
d){},renderHeader:function(){},_autoId:0,insertRow:function(a,b,c,d,e){var f=e.parentId,f=this.id+"-row-"+(f?f+"-":"")+(this.store&&this.store.getIdentity?this.store.getIdentity(a):this._autoId++),g=document.getElementById(f),h=g&&g.previousSibling;g&&(g===c&&(c=(c.connected||c).nextSibling),this.removeRow(g));g=this.renderRow(a,e);g.className=(g.className||"")+" dgrid-row "+(1==d%2?"dgrid-row-odd":"dgrid-row-even")+(this.addUiClasses?" ui-state-default":"");this._rowIdToObject[g.id=f]=a;b.insertBefore(g,
c||null);h&&this.adjustRowIndices(h);g.rowIndex=d;return g},renderRow:function(a,b){return e("div",""+a)},removeRow:function(a,b){a=a.element||a;delete this._rowIdToObject[a.id];b||e(a,"!")},row:function(a){var b;if(a instanceof this._Row)return a;a.target&&a.target.nodeType&&(a=a.target);if(a.nodeType){do{var c=a.id;if(b=this._rowIdToObject[c])return new this._Row(c.substring(this.id.length+5),b,a);a=a.parentNode}while(a&&a!=this.domNode)}else return"object"==typeof a?b=this.store.getIdentity(a):
(b=a,a=this._rowIdToObject[this.id+"-row-"+b]),new this._Row(b,a,document.getElementById(this.id+"-row-"+b))},cell:function(a){return{row:this.row(a)}},_move:function(a,b,c,d){var e,f;f=e=a.element;b=b||1;do if(a=e[0>b?"previousSibling":"nextSibling"]){do if((e=a)&&-1<(e.className+" ").indexOf(c+" ")){f=e;b+=0>b?1:-1;break}while(a=(!d||!e.hidden)&&e[0>b?"lastChild":"firstChild"])}else if(e=e.parentNode,!e||e===this.bodyNode||e===this.headerNode)break;while(b);return f},up:function(a,b,c){a.element||
(a=this.row(a));return this.row(this._move(a,-(b||1),"dgrid-row",c))},down:function(a,b,c){a.element||(a=this.row(a));return this.row(this._move(a,b||1,"dgrid-row",c))},scrollTo:k("touch")?function(a){return this.useTouchScroll?this.inherited(arguments):u.call(this,a)}:u,getScrollPosition:k("touch")?function(){return this.useTouchScroll?this.inherited(arguments):g.call(this)}:g,get:function(a){var b="_get"+a.charAt(0).toUpperCase()+a.slice(1);return"function"===typeof this[b]?this[b].apply(this,[].slice.call(arguments,
1)):this[a]},set:function(a,b){if("object"===typeof a)for(var c in a)this.set(c,a[c]);else c="_set"+a.charAt(0).toUpperCase()+a.slice(1),"function"===typeof this[c]?this[c].apply(this,[].slice.call(arguments,1)):this[a]=b;return this},_getClass:a,_setClass:b,_getClassName:a,_setClassName:b,_setSort:function(a,b){this._sort="string"!=typeof a?a:[{attribute:a,descending:b}];this.refresh();this._lastCollection&&(a.length&&("string"!=typeof a&&(b=a[0].descending,a=a[0].attribute),this._lastCollection.sort(function(c,
d){var e=c[a],f=d[a];void 0===e&&(e="");void 0===f&&(f="");return e==f?0:e>f==!b?1:-1})),this.renderArray(this._lastCollection))},sort:function(a,b){r.deprecated("sort(...)",'use set("sort", ...) instead',"dgrid 0.4");this.set("sort",a,b)},_getSort:function(){return this._sort},_setShowHeader:function(a){var b=this.headerNode;this.showHeader=a;e(b,(a?"!":".")+"dgrid-header-hidden");this.renderHeader();this.resize();a&&(b.scrollLeft=this.getScrollPosition().x)},setShowHeader:function(a){r.deprecated("setShowHeader(...)",
'use set("showHeader", ...) instead',"dgrid 0.4");this.set("showHeader",a)},_setShowFooter:function(a){this.showFooter=a;e(this.footerNode,(a?"!":".")+"dgrid-footer-hidden");this.resize()}})})},"dgrid/util/misc":function(){define(["dojo/has","put-selector/put"],function(r,l){r.add("dom-contains",function(d,c,b){return!!b.contains});var d=[],q,k,m,p=/([^A-Za-z0-9_\u00A0-\uFFFF-])/g,h={defaultDelay:15,throttle:function(d,c,b){var a=!1;b=b||h.defaultDelay;return function(){a||(a=!0,d.apply(c,arguments),
setTimeout(function(){a=!1},b))}},throttleDelayed:function(d,c,b){var a=!1;b=b||h.defaultDelay;return function(){if(!a){a=!0;var e=arguments;setTimeout(function(){a=!1;d.apply(c,e)},b)}}},debounce:function(d,c,b){var a;b=b||h.defaultDelay;return function(){a&&(clearTimeout(a),a=null);var e=arguments;a=setTimeout(function(){d.apply(c,e)},b)}},each:function(d,c,b){var a,e;if(d)if("number"===typeof d.length)for(a=0,e=d.length;a<e;a++)c.call(b,d[a],a,d);else for(a in d)c.call(b,d[a],a,d)},contains:function(d,
c){return r("dom-contains")?d.contains(c):d.compareDocumentPosition(c)&8},addCssRule:function(e,c){q||(q=l(document.getElementsByTagName("head")[0],"style"),q=q.sheet||q.styleSheet,k=q.deleteRule?"deleteRule":"removeRule",m=q.cssRules?"cssRules":"rules");var b=d.length;d[b]=(q.cssRules||q.rules).length;q.addRule?q.addRule(e,c):q.insertRule(e+"{"+c+"}",d[b]);return{get:function(a){return q[m][d[b]].style[a]},set:function(a,c){"undefined"!==typeof d[b]&&(q[m][d[b]].style[a]=c)},remove:function(){var a=
d[b],c,e;if(void 0!==a)for(q[k](a),d[b]=void 0,c=b+1,e=d.length;c<e;c++)d[c]>a&&d[c]--}}},escapeCssIdentifier:function(d,c){return"string"===typeof d?d.replace(p,c||"\\$1"):d}};return h})},"xstyle/has-class":function(){define(["dojo/has"],function(r){var l={};return function(){for(var d,q=arguments,k=0;k<q.length;k++)if(d=q[k],!l[d]){l[d]=!0;var m=d.match(/^(no-)?(.+?)((-[\d\.]+)(-[\d\.]+)?)?$/),p=r(m[2]),h=-m[4];(0<h?h<=p&&(-m[5]||h)>=p:!!p)==!m[1]&&(document.documentElement.className+=" has-"+d)}}})},
"xstyle/css":function(){define(["require"],function(r){function l(d,l,k){var m=document.documentElement;d=m.insertBefore(document.createElement(d),m.firstChild);d.id=l;l=(d.currentStyle||getComputedStyle(d,null)||{})[k];m.removeChild(d);return l}return{load:function(d,q,k,m){function p(b){var a=l("x-parse",null,"content"),c=b&&(b.sheet||b.styleSheet);a&&"none"!=a&&"normal"!=a?q([eval(a)],function(a){b?a.process(b,k):(a.processAll(),k(c))}):k(c)}var h=q.toUrl(d),e;h.match(/!$/)&&(e={wait:!1},h=h.slice(0,
-1));var c=q.cache&&q.cache["url:"+h];if(c)c.xCss&&(c=c.cssText),r(["./core/load-css"],function(b){p(b.insertCss(c))});else{if("none"==l("div",d.replace(/\//g,"-").replace(/\..*/,"")+"-loaded","display"))return p();r(["./core/load-css"],function(b){b(h,p,e)})}}}})},"dgrid/OnDemandList":function(){define("./List ./_StoreMixin dojo/_base/declare dojo/_base/lang dojo/_base/Deferred dojo/dom dojo/on ./util/misc put-selector/put".split(" "),function(r,l,d,q,k,m,p,h,e){return d("dgrid.OnDemandList",[r,
l],{minRowsPerPage:25,maxRowsPerPage:250,maxEmptySpace:Infinity,bufferRows:10,farOffRemoval:2E3,queryRowsOverlap:0,pagingMethod:"debounce",pagingDelay:h.defaultDelay,keepScrollPosition:!1,rowHeight:22,postCreate:function(){this.inherited(arguments);var c=this;p(this.bodyNode,"scroll",h[this.pagingMethod](function(b){c._processScroll(b)},null,this.pagingDelay))},destroy:function(){this.inherited(arguments);this._refreshTimeout&&clearTimeout(this._refreshTimeout)},renderQuery:function(c,b){function a(a){e(w,
"!");if(a)throw d._refreshDeferred&&(d._refreshDeferred.reject(a),delete d._refreshDeferred),a;}var d=this,h=b&&b.container||this.contentNode,l={query:c,count:0,options:b},m,f=this.preload,p,r={node:e(h,"div.dgrid-preload",{rowIndex:0}),count:0,query:c,next:l,options:b};r.node.style.height="0";l.node=m=e(h,"div.dgrid-preload");l.previous=r;m.rowIndex=this.minRowsPerPage;f?((l.next=f.next)&&m.offsetTop>=f.node.offsetTop?l.previous=f:(l.next=f,l.previous=f.previous),l.previous.next=l,l.next.previous=
l):this.preload=l;var w=e(m,"-div.dgrid-loading");e(w,"div.dgrid-below").innerHTML=this.loadingMessage;b=q.mixin(this.get("queryOptions"),b,{start:0,count:this.minRowsPerPage},"level"in c?{queryLevel:c.level}:null);this._trackError(function(){return p=c(b)});if("undefined"===typeof p)a();else return k.when(d.renderArray(p,m,b),function(c){return k.when("undefined"===typeof p.total?p.length:p.total,function(a){var f=c.length,g=m.parentNode,h=d.noDataNode;e(w,"!");"queryLevel"in b||(d._total=a);0===
a&&g&&(h&&(e(h,"!"),delete d.noDataNode),d.noDataNode=h=e("div.dgrid-no-data"),g.insertBefore(h,d._getFirstRowSibling(g)),h.innerHTML=d.noDataMessage);for(h=g=0;h<f;h++)g+=d._calcRowHeight(c[h]);f&&g&&(d.rowHeight=g/f);g=d.rowHeight*d.bufferRows;g>d.farOffRemoval&&(d.farOffRemoval=g);a-=f;l.count=a;m.rowIndex=f;a?m.style.height=Math.min(a*d.rowHeight,d.maxEmptySpace)+"px":(m.style.display="none",b.count++);d._previousScrollPosition&&(d.scrollTo(d._previousScrollPosition),delete d._previousScrollPosition);
d._processScroll();d._refreshDeferred&&(d._refreshDeferred.resolve(p),delete d._refreshDeferred);return c},a)},a),p},refresh:function(c){var b=this,a=c&&c.keepScrollPosition,d;"undefined"===typeof a&&(a=this.keepScrollPosition);a&&(this._previousScrollPosition=this.getScrollPosition());this.inherited(arguments);if(this.store)return a=this._refreshDeferred=new k,d=b.renderQuery(function(a){return b.store.query(b.query,a)}),"undefined"===typeof d&&a.reject(),a.then(function(a){b._refreshTimeout=setTimeout(function(){p.emit(b.domNode,
"dgrid-refresh-complete",{bubbles:!0,cancelable:!1,grid:b,results:a});b._refreshTimeout=null},0);delete b._refreshDeferred;return a},function(a){delete b._refreshDeferred;throw a;})},resize:function(){this.inherited(arguments);this._processScroll()},_getFirstRowSibling:function(c){return c.lastChild},_calcRowHeight:function(c){var b=c.nextSibling;return b&&!/\bdgrid-preload\b/.test(b.className)?b.offsetTop-c.offsetTop:c.offsetHeight},lastScrollTop:0,_processScroll:function(c){function b(b,c,d,f){var g=
h.farOffRemoval,k=b.node;if(c>2*g){for(var l,n=k[d],m=0,p=0,q=[];l=n;){var t=h._calcRowHeight(l);if(m+t+g>c||0>n.className.indexOf("dgrid-row")&&0>n.className.indexOf("dgrid-loading"))break;n=l[d];m+=t;p+=l.count||1;h.removeRow(l,!0);q.push(l)}b.count+=p;f?(k.rowIndex-=p,a(b)):k.style.height=k.offsetHeight+m+"px";var u=e("div",q);setTimeout(function(){e(u,"!")},1)}}function a(a,b){a.node.style.height=Math.min(a.count*h.rowHeight,b?Infinity:h.maxEmptySpace)+"px"}function d(a,b){do a=b?a.next:a.previous;
while(a&&!a.node.offsetWidth);return a}var h=this,l=h.bodyNode;c=c&&c.scrollTop||this.getScrollPosition().y;var l=l.offsetHeight+c,m,f,p=h.preload,r=h.lastScrollTop,w=h.bufferRows*h.rowHeight,z=w-h.rowHeight,A,y,B,C=!0;for(h.lastScrollTop=c;p&&!p.node.offsetWidth;)p=p.previous;for(;p&&p!=m;){m=h.preload;h.preload=p;f=p.node;var E=f.offsetTop;if(l+1+z<E)p=d(p,C=!1);else if(c-1-z>E+f.offsetHeight)p=d(p,C=!0);else{var D=((f.rowIndex?c-w:l)-E)/h.rowHeight,E=(l-c+2*w)/h.rowHeight,E=E+Math.min(Math.abs(Math.max(Math.min((c-
r)*h.rowHeight,h.maxRowsPerPage/2),h.maxRowsPerPage/-2)),10);0==f.rowIndex&&(D-=E);D=Math.max(D,0);10>D&&0<D&&E+D<h.maxRowsPerPage&&(E+=Math.max(0,D),D=0);E=Math.min(Math.max(E,h.minRowsPerPage),h.maxRowsPerPage,p.count);if(0==E)p=d(p,C);else{var E=Math.ceil(E),D=Math.min(Math.floor(D),p.count-E),F=q.mixin(h.get("queryOptions"),p.options);p.count-=E;var G=f,J,N=h.queryRowsOverlap,M=(0<f.rowIndex||f.offsetTop>c)&&p;if(M){var L=p.previous;L&&(b(L,c-(L.node.offsetTop+L.node.offsetHeight),"nextSibling"),
0<D&&L.node==f.previousSibling?(D=Math.min(p.count,D),p.previous.count+=D,a(p.previous,!0),f.rowIndex+=D,N=0):E+=D,p.count-=D);F.start=f.rowIndex-N;F.count=Math.min(E+N,h.maxRowsPerPage);f.rowIndex=F.start+F.count}else p.next&&(b(p.next,p.next.node.offsetTop-l,"previousSibling",!0),G=f.nextSibling,G==p.next.node?(p.next.count+=p.count-D,p.next.node.rowIndex=D+E,a(p.next),p.count=D,N=0):J=!0),F.start=p.count,F.count=Math.min(E+N,h.maxRowsPerPage);J&&G&&G.offsetWidth&&(J=G.offsetTop);a(p);"level"in
p.query&&(F.queryLevel=p.query.level);if("queryLevel"in F||!(F.start>h._total||0>F.count)){f=e(G,"-div.dgrid-loading[style\x3dheight:"+E*h.rowHeight+"px]");e(f,"div.dgrid-"+(M?"below":"above")).innerHTML=h.loadingMessage;f.count=E;var K=p.query(F);if(void 0===h._trackError(function(){return K})){e(f,"!");return}(function(b,c,d,f){B=k.when(h.renderArray(f,b,F),function(g){y=f;G=b.nextSibling;e(b,"!");if(d&&G&&G.offsetWidth){var l=h.getScrollPosition();h.scrollTo({x:l.x,y:l.y+G.offsetTop-d,preserveMomentum:!0})}k.when(f.total||
f.length,function(b){"queryLevel"in F||(h._total=b);c&&(c.count=b-c.node.rowIndex,0===c.count&&F.count++,a(c))});h._processScroll();return g},function(a){e(b,"!");throw a;})}).call(this,f,M,J,K);p=p.previous}}}}B&&(A=this._refreshDeferred)&&(delete this._refreshDeferred,k.when(B,function(){A.resolve(y)}))},removeRow:function(c,b){if(c){var a=c.previousSibling,d=c.nextSibling,e;if(e=a)e=a.observerIndex,e=null!=e?e:a.previousObserverIndex;a=e;if(e=d)e=d.observerIndex,e=null!=e?e:d.nextObserverIndex;
d=c.observerIndex;c.observerIndex=void 0;b&&(c.nextObserverIndex=e,c.previousObserverIndex=a);if(this.cleanEmptyObservers&&-1<d&&d!==a&&d!==e&&(a=this.observers,e=a[d])){if(!b)for(var h=e.rows,k=0;k<h.length;k++)if(h[k]!=c&&m.isDescendant(h[k],this.domNode))return this.inherited(arguments);e.cancel();this._numObservers--;a[d]=0}}this.inherited(arguments)}})})},"dgrid/_StoreMixin":function(){define("dojo/_base/kernel dojo/_base/declare dojo/_base/lang dojo/_base/Deferred dojo/on dojo/aspect put-selector/put".split(" "),
function(r,l,d,q,k,m,p){function h(c){return c}function e(c){if("object"!==typeof c)c=Error(c);else if("cancel"===c.dojoType)return;c.grid=this;k.emit(this.domNode,"dgrid-error",{grid:this,error:c,cancelable:!0,bubbles:!0})&&console.error(c)}return l("dgrid._StoreMixin",null,{store:null,query:null,queryOptions:null,getBeforePut:!0,noDataMessage:"",loadingMessage:"",constructor:function(){this.query={};this.queryOptions={};this.dirty={};this._updating={};this._columnsWithSet={};m.before(this,"configStructure",
d.hitch(this,function(){this._columnsWithSet={}}))},postCreate:function(){this.inherited(arguments);this.store&&this._updateNotifyHandle(this.store)},destroy:function(){this.inherited(arguments);this._notifyHandle&&this._notifyHandle.remove()},_configColumn:function(c){c.set&&(this._columnsWithSet[c.field]=c);this.inherited(arguments)},_updateNotifyHandle:function(c){this._notifyHandle&&(this._notifyHandle.remove(),delete this._notifyHandle);c&&"function"===typeof c.notify&&this.shouldObserveStore&&
(this._notifyHandle=m.after(c,"notify",d.hitch(this,"_onNotify"),!0),(c=this.get("sort"))&&c.length||console.warn("Observable store detected, but no sort order specified. You may experience quirks when adding/updating items.  These can be resolved by setting a sort order on the list or grid."))},_setStore:function(c,b,a){this._updateNotifyHandle(c);this.store=c;this.dirty={};this.set("query",b,a)},_setQuery:function(c,b){var a=b&&b.sort;this.query=void 0!==c?c:this.query;this.queryOptions=b||this.queryOptions;
this._started&&(a?this.set("sort",a):this.refresh())},setStore:function(c,b,a){r.deprecated("setStore(...)",'use set("store", ...) instead',"dgrid 0.4");this.set("store",c,b,a)},setQuery:function(c,b){r.deprecated("setQuery(...)",'use set("query", ...) instead',"dgrid 0.4");this.set("query",c,b)},_getQueryOptions:function(){var c=d.delegate(this.queryOptions,{});if("function"===typeof this._sort||this._sort.length)c.sort=this._sort;return c},_getQuery:function(){var c=this.query;return"object"==typeof c&&
null!=c?d.delegate(c,{}):c},_setSort:function(c,b){this.store&&(this._lastCollection=null);this.inherited(arguments)},_onNotify:function(c,b){this.inherited(arguments);c&&1>this._numObservers&&this.refresh({keepScrollPosition:!0})},refresh:function(){var c=this.inherited(arguments);this.store||(this.noDataNode=p(this.contentNode,"div.dgrid-no-data"),this.noDataNode.innerHTML=this.noDataMessage);return c},renderArray:function(){var c=this,b=this.inherited(arguments);this.store||q.when(b,function(a){a.length&&
c.noDataNode&&p(c.noDataNode,"!")});return b},insertRow:function(c,b,a,e,h){var g=this.store,k=this.dirty,g=g&&g.getIdentity(c),f;g in k&&!(g in this._updating)&&(f=k[g]);f&&(c=d.delegate(c,f));return this.inherited(arguments)},updateDirty:function(c,b,a){var d=this.dirty,e=d[c];e||(e=d[c]={});e[b]=a},setDirty:function(c,b,a){r.deprecated("setDirty(...)","use updateDirty() instead","dgrid 0.4");this.updateDirty(c,b,a)},save:function(){function c(c,e){return function(f){var g=b._columnsWithSet,h=b._updating,
k,l;if("function"===typeof f.set)f.set(e);else for(k in e)f[k]=e[k];for(k in g)l=g[k].set(f),void 0!==l&&(f[k]=l);h[c]=!0;return q.when(a.put(f),function(){delete d[c];delete h[c]})}}var b=this,a=this.store,d=this.dirty,e=new q,h=e.promise,k=function(c){var d;return b.getBeforePut||!(d=b.row(c).data)?function(){return a.get(c)}:function(){return d}},f;for(f in d)var l=c(f,d[f]),h=h.then(k(f)).then(l);e.resolve();return h},revert:function(){this.dirty={};this.refresh()},_trackError:function(c){var b;
"string"==typeof c&&(c=d.hitch(this,c));try{b=c()}catch(a){e.call(this,a)}return q.when(b,h,d.hitch(this,e))},newRow:function(){var c=this.inherited(arguments);this.noDataNode&&(p(this.noDataNode,"!"),delete this.noDataNode);return c},removeRow:function(c,b){var a={element:c};!b&&this.noDataMessage&&this.up(a).element===c&&this.down(a).element===c&&(this.noDataNode=p(this.contentNode,"div.dgrid-no-data"),this.noDataNode.innerHTML=this.noDataMessage);return this.inherited(arguments)}})})},"dgrid/Selection":function(){define("dojo/_base/kernel dojo/_base/declare dojo/_base/Deferred dojo/on dojo/has dojo/aspect ./List dojo/has!touch?./util/touch put-selector/put dojo/query dojo/_base/sniff".split(" "),
function(r,l,d,q,k,m,p,h,e){function c(a,b){for(var c=a.unselectable=b?"on":"",d=a.getElementsByTagName("*"),e=d.length;--e;)"INPUT"!==d[e].tagName&&"TEXTAREA"!==d[e].tagName&&(d[e].unselectable=c)}function b(a,b){var d=a.bodyNode,e=b?"text":21>k("ff")?"-moz-none":"none";g&&"msUserSelect"!==g?d.style[g]=e:k("dom-selectstart")?b||a._selectstartHandle?b&&a._selectstartHandle&&(a._selectstartHandle.remove(),delete a._selectstartHandle):a._selectstartHandle=q(d,"selectstart",function(a){var b=a.target&&
a.target.tagName;"INPUT"!==b&&"TEXTAREA"!==b&&a.preventDefault()}):(c(d,!b),b||a._unselectableHandle)?b&&a._unselectableHandle&&(a._unselectableHandle.remove(),delete a._unselectableHandle):a._unselectableHandle=m.after(a,"renderRow",function(a){c(a,!0);return a})}k.add("dom-comparedocumentposition",function(a,b,c){return!!c.compareDocumentPosition});k.add("pointer",function(a){return"PointerEvent"in a?"pointer":"MSPointerEvent"in a?"MSPointer":!1});k.add("css-user-select",function(a,b,c){a=c.style;
b=["Khtml","O","ms","Moz","Webkit"];c=b.length;var d="userSelect";do if("undefined"!==typeof a[d])return d;while(c--&&(d=b[c]+"UserSelect"));return!1});k.add("dom-selectstart","undefined"!==typeof document.onselectstart);var a=k("mac")?"metaKey":"ctrlKey",g=k("css-user-select"),u=(p=k("pointer"))&&"MS"===p.slice(0,2),n=p?p+(u?"Down":"down"):"mousedown",t=p?p+(u?"Up":"up"):"mouseup";"WebkitUserSelect"===g&&"undefined"!==typeof document.documentElement.style.msUserSelect&&(g=!1);return l("dgrid.Selection",
null,{selectionDelegate:".dgrid-row",selectionEvents:n+","+t+",dgrid-cellfocusin",selectionTouchEvents:k("touch")?h.tap:null,deselectOnRefresh:!0,allowSelectAll:!1,selection:{},selectionMode:"extended",allowTextSelection:void 0,_selectionTargetType:"rows",create:function(){this.selection={};return this.inherited(arguments)},postCreate:function(){this.inherited(arguments);this._initSelectionEvents();var a=this.selectionMode;this.selectionMode="";this._setSelectionMode(a)},destroy:function(){this.inherited(arguments);
this._selectstartHandle&&this._selectstartHandle.remove();this._unselectableHandle&&this._unselectableHandle.remove();this._removeDeselectSignals&&this._removeDeselectSignals()},_setSelectionMode:function(a){a!=this.selectionMode&&(this.clearSelection(),this.selectionMode=a,this._selectionHandlerName="_"+a+"SelectionHandler",this._setAllowTextSelection(this.allowTextSelection))},setSelectionMode:function(a){r.deprecated("setSelectionMode(...)",'use set("selectionMode", ...) instead',"dgrid 0.4");
this.set("selectionMode",a)},_setAllowTextSelection:function(a){"undefined"!==typeof a?b(this,a):b(this,"none"===this.selectionMode);this.allowTextSelection=a},_handleSelect:function(a,b){if(this[this._selectionHandlerName]&&this.allowSelect(this.row(b))&&("dgrid-cellfocusin"!==a.type||"mousedown"!==a.parentType)&&(a.type!==t||b==this._waitForMouseUp)){this._waitForMouseUp=null;this._selectionTriggerEvent=a;if(!a.keyCode||!a.ctrlKey||32==a.keyCode)if(!a.shiftKey&&a.type===n&&this.isSelected(b))this._waitForMouseUp=
b;else this[this._selectionHandlerName](a,b);this._selectionTriggerEvent=null}},_singleSelectionHandler:function(b,c){var d=b.keyCode?b.ctrlKey:b[a];this._lastSelected===c?this.select(c,null,!d||!this.isSelected(c)):(this.clearSelection(),this.select(c),this._lastSelected=c)},_multipleSelectionHandler:function(b,c){var d=this._lastSelected,e=b.keyCode?b.ctrlKey:b[a],f;b.shiftKey||(f=e?null:!0,d=null);this.select(c,d,f);d||(this._lastSelected=c)},_extendedSelectionHandler:function(b,c){(2===b.button?
this.isSelected(c):b.keyCode?b.ctrlKey:b[a])||this.clearSelection(null,!0);this._multipleSelectionHandler(b,c)},_toggleSelectionHandler:function(a,b){this.select(b,null,null)},_initSelectionEvents:function(){var b=this,c=this.contentNode,d=this.selectionDelegate;this._selectionEventQueues={deselect:[],select:[]};k("touch")&&!k("pointer")&&this.selectionTouchEvents?(q(c,h.selector(d,this.selectionTouchEvents),function(a){b._handleSelect(a,this);b._ignoreMouseSelect=this}),q(c,q.selector(d,this.selectionEvents),
function(a){b._ignoreMouseSelect!==this?b._handleSelect(a,this):a.type===t&&(b._ignoreMouseSelect=null)})):q(c,q.selector(d,this.selectionEvents),function(a){b._handleSelect(a,this)});this.addKeyHandler&&this.addKeyHandler(32,function(a){b._handleSelect(a,a.target)});if(this.allowSelectAll)this.on("keydown",function(c){c[a]&&65==c.keyCode&&!/\bdgrid-input\b/.test(c.target.className)&&(c.preventDefault(),b[b.allSelected?"clearSelection":"selectAll"]())});this._setStore&&m.after(this,"_setStore",function(){b._updateDeselectionAspect()});
this._updateDeselectionAspect()},_updateDeselectionAspect:function(){function a(a,c,d){a=c||a&&a[b.idProperty||"id"];if(null!=a&&(c=(a=b.row(a))&&b.selection[a.id]))b[d](a,null,c)}var b=this,c=this.store,d,e;this._removeDeselectSignals&&this._removeDeselectSignals();c&&c.notify?(d=m.before(c,"notify",function(b,c){b||a(b,c,"deselect")}),e=m.after(c,"notify",function(b,c){a(b,c,"select")},!0),this._removeDeselectSignals=function(){d.remove();e.remove()}):(d=m.before(this,"removeRow",function(a,b){var c;
b||(c=this.row(a))&&c.id in this.selection&&this.deselect(c)}),this._removeDeselectSignals=function(){d.remove()})},allowSelect:function(a){return!0},_fireSelectionEvent:function(a){var b=this._selectionEventQueues[a],c=this._selectionTriggerEvent,d;d={bubbles:!0,grid:this};c&&(d.parentType=c.type);d[this._selectionTargetType]=b;this._selectionEventQueues[a]=[];q.emit(this.contentNode,"dgrid-"+a,d)},_fireSelectionEvents:function(){var a=this._selectionEventQueues,b;for(b in a)a[b].length&&this._fireSelectionEvent(b)},
_select:function(a,b,c){var d,f,g;"undefined"===typeof c&&(c=!0);a.element||(a=this.row(a));if(!1===c||this.allowSelect(a))if(d=this.selection,f=!!d[a.id],null===c&&(c=!f),g=a.element,c||this.allSelected?d[a.id]=c:delete this.selection[a.id],g&&(c?e(g,".dgrid-selected"+(this.addUiClasses?".ui-state-active":"")):e(g,"!dgrid-selected!ui-state-active")),c!==f&&g&&this._selectionEventQueues[(c?"":"de")+"select"].push(a),b)if(b.element||(b=this.row(b)),b){if(b=b.element)for(d=this._determineSelectionDirection(g,
b),d||(b=document.getElementById(b.id),d=this._determineSelectionDirection(g,b));a.element!=b&&(a=this[d](a));)this._select(a,null,c)}else this._lastSelected=g,console.warn("The selection range has been reset because the beginning of the selection is no longer in the DOM. If you are using OnDemandList, you may wish to increase farOffRemoval to avoid this, but note that keeping more nodes in the DOM may impact performance.")},_determineSelectionDirection:k("dom-comparedocumentposition")?function(a,
b){var c=b.compareDocumentPosition(a);return c&1?!1:2===c?"down":"up"}:function(a,b){return 1>b.sourceIndex?!1:b.sourceIndex>a.sourceIndex?"down":"up"},select:function(a,b,c){this._select(a,b,c);this._fireSelectionEvents()},deselect:function(a,b){this.select(a,b,!1)},clearSelection:function(a,b){this.allSelected=!1;for(var c in this.selection)a!==c&&this._select(c,null,!1);b||(this._lastSelected=null);this._fireSelectionEvents()},selectAll:function(){this.allSelected=!0;this.selection={};for(var a in this._rowIdToObject){var b=
this.row(this._rowIdToObject[a]);this._select(b.id,null,!0)}this._fireSelectionEvents()},isSelected:function(a){if("undefined"===typeof a||null===a)return!1;a.element||(a=this.row(a));return a.id in this.selection?!!this.selection[a.id]:this.allSelected&&(!a.data||this.allowSelect(a))},refresh:function(){this.deselectOnRefresh&&this.clearSelection();this._lastSelected=null;return this.inherited(arguments)},renderArray:function(){var a=this,b=this.inherited(arguments);d.when(b,function(b){var c=a.selection,
d,e,f;for(d=0;d<b.length;d++)e=a.row(b[d]),(f=e.id in c?c[e.id]:a.allSelected)&&a._select(e,null,f);a._fireSelectionEvents()});return b}})})},"dgrid/Keyboard":function(){define("dojo/_base/declare dojo/aspect dojo/on dojo/_base/lang dojo/has put-selector/put ./util/misc dojo/_base/Deferred dojo/_base/sniff".split(" "),function(r,l,d,q,k,m,p,h){function e(a){a.preventDefault()}var c={checkbox:1,radio:1,button:1},b=/\bdgrid-cell\b/,a=/\bdgrid-row\b/,g=r("dgrid.Keyboard",null,{pageSkip:10,tabIndex:0,
keyMap:null,headerKeyMap:null,postMixInProperties:function(){this.inherited(arguments);this.keyMap||(this.keyMap=q.mixin({},g.defaultKeyMap));this.headerKeyMap||(this.headerKeyMap=q.mixin({},g.defaultHeaderKeyMap))},postCreate:function(){function e(a){var b=a.target;return b.type&&(!c[b.type]||32==a.keyCode)}function f(c){function f(){g._focusedHeaderNode&&(g._focusedHeaderNode.tabIndex=-1);if(g.showHeader){if(k)for(var a=0,b,c=g.headerNode.getElementsByTagName("th");b=c[a];++a){if(n.test(b.className)){g._focusedHeaderNode=
q=b;break}}else g._focusedHeaderNode=q=g.headerNode;q&&(q.tabIndex=g.tabIndex)}}var k=g.cellNavigation,n=k?b:a,m=c===g.headerNode,q=c;m?(f(),l.after(g,"renderHeader",f,!0)):l.after(g,"renderArray",function(a){return h.when(a,function(a){var b=g._focusedNode||q;if(n.test(b.className)&&p.contains(c,b))return a;for(var d=0,e=c.getElementsByTagName("*"),f;f=e[d];++d)if(n.test(f.className)){b=g._focusedNode=f;break}b.tabIndex=g.tabIndex;return a})});g._listeners.push(d(c,"mousedown",function(a){e(a)||
g._focusOnNode(a.target,m,a)}));g._listeners.push(d(c,"keydown",function(a){if(!a.metaKey&&!a.altKey){var b=g[m?"headerKeyMap":"keyMap"][a.keyCode];b&&!e(a)&&b.call(g,a)}}))}this.inherited(arguments);var g=this;this.tabableHeader&&(f(this.headerNode),d(this.headerNode,"dgrid-cellfocusin",function(){g.scrollTo({x:this.scrollLeft})}));f(this.contentNode);this._debouncedEnsureRowScroll=p.debounce(this._ensureRowScroll,this)},removeRow:function(a){if(!this._focusedNode)return this.inherited(arguments);
var b=this,c=document.activeElement===this._focusedNode,d=this[this.cellNavigation?"cell":"row"](this._focusedNode),e=d.row||d,f;a=a.element||a;a===e.element&&((f=this.down(e,!0))&&f.element!==a||(f=this.up(e,!0)),this._removedFocus={active:c,rowId:e.id,columnId:d.column&&d.column.id,siblingId:f&&f.element!==a?f.id:void 0},setTimeout(function(){b._removedFocus&&b._restoreFocus(e.id)},0),this._focusedNode=null);this.inherited(arguments)},insertRow:function(a){var b=this.inherited(arguments);this._removedFocus&&
!this._removedFocus.wait&&this._restoreFocus(b);return b},_restoreFocus:function(a){var b=this._removedFocus,c;if((a=(a=a&&this.row(a))&&a.element&&a.id===b.rowId?a:"undefined"!==typeof b.siblingId&&this.row(b.siblingId))&&a.element){if(!a.element.parentNode.parentNode){b.wait=!0;return}"undefined"!==typeof b.columnId&&(c=this.cell(a,b.columnId))&&c.element&&(a=c);b.active&&0!==a.element.offsetHeight?this._focusOnNode(a,!1,null):(m(a.element,".dgrid-focus"),a.element.tabIndex=this.tabIndex,this._focusedNode=
a.element)}delete this._removedFocus},addKeyHandler:function(a,b,c){return l.after(this[c?"headerKeyMap":"keyMap"],a,b,!0)},_ensureRowScroll:function(a){var b=this.getScrollPosition().y;b>a.offsetTop?this.scrollTo({y:a.offsetTop}):b+this.contentNode.offsetHeight<a.offsetTop+a.offsetHeight&&this.scrollTo({y:a.offsetTop-this.contentNode.offsetHeight+a.offsetHeight})},_focusOnNode:function(c,e,f){var g="_focused"+(e?"Header":"")+"Node",h=this[g],l=this.cellNavigation?"cell":"row",n=this[l](c),p,t,u,
r,w;if(c=n&&n.element){if(this.cellNavigation)for(p=c.getElementsByTagName("input"),w=0,u=p.length;w<u;w++)if(t=p[w],(-1!=t.tabIndex||"_dgridLastValue"in t)&&!t.disabled){8>k("ie")&&(t.style.position="relative");t.focus();8>k("ie")&&(t.style.position="");r=!0;break}null!==f&&(f=q.mixin({grid:this},f),f.type&&(f.parentType=f.type),f.bubbles||(f.bubbles=!0));h&&(m(h,"!dgrid-focus[!tabIndex]"),8>k("ie")&&(h.style.position=""),f&&(f[l]=this[l](h),d.emit(h,"dgrid-cellfocusout",f)));h=this[g]=c;f&&(f[l]=
n);g=this.cellNavigation?b:a;!r&&g.test(c.className)&&(8>k("ie")&&(c.style.position="relative"),c.tabIndex=this.tabIndex,c.focus());m(c,".dgrid-focus");f&&d.emit(h,"dgrid-cellfocusin",f);this.cellNavigation&&(this.columnSets||1<this.subRows.length)&&!e&&this._debouncedEnsureRowScroll(n.row.element)}},focusHeader:function(a){this._focusOnNode(a||this._focusedHeaderNode,!0)},focus:function(a){(a=a||this._focusedNode)?this._focusOnNode(a,!1):this.contentNode.focus()}}),u=g.moveFocusVertical=function(a,
b){var c=this.cellNavigation,d=this[c?"cell":"row"](a),d=c&&d.column.id,e=this.down(this._focusedNode,b,!0);c&&(e=this.cell(e,d));this._focusOnNode(e,!1,a);a.preventDefault()};r=g.moveFocusUp=function(a){u.call(this,a,-1)};var n=g.moveFocusDown=function(a){u.call(this,a,1)},t=g.moveFocusPageUp=function(a){u.call(this,a,-this.pageSkip)},f=g.moveFocusPageDown=function(a){u.call(this,a,this.pageSkip)},v=g.moveFocusHorizontal=function(a,b){if(this.cellNavigation){var c=!this.row(a);this._focusOnNode(this.right(this["_focused"+
(c?"Header":"")+"Node"],b),c,a);a.preventDefault()}},x=g.moveFocusLeft=function(a){v.call(this,a,-1)},w=g.moveFocusRight=function(a){v.call(this,a,1)},z=g.moveHeaderFocusEnd=function(a,b){var c;this.cellNavigation&&(c=this.headerNode.getElementsByTagName("th"),this._focusOnNode(c[b?0:c.length-1],!0,a));a.preventDefault()},A=g.moveHeaderFocusHome=function(a){z.call(this,a,!0)},y=g.moveFocusEnd=function(a,b){var c=this,d=this.cellNavigation,e=this.contentNode,f=e.scrollTop+(b?0:e.scrollHeight),e=e[b?
"firstChild":"lastChild"],g=-1<e.className.indexOf("dgrid-preload"),n=g?e[(b?"next":"previous")+"Sibling"]:e,m=n.offsetTop+(b?0:n.offsetHeight),p;if(g){for(;n&&0>n.className.indexOf("dgrid-row");)n=n[(b?"next":"previous")+"Sibling"];if(!n)return}!g||1>e.offsetHeight?(d&&(n=this.cell(n,this.cell(a).column.id)),this._focusOnNode(n,!1,a)):(k("dom-addeventlistener")||(a=q.mixin({},a)),p=l.after(this,"renderArray",function(e){p.remove();return h.when(e,function(e){e=e[b?0:e.length-1];d&&(e=c.cell(e,c.cell(a).column.id));
c._focusOnNode(e,!1,a)})}));f===m&&a.preventDefault()},B=g.moveFocusHome=function(a){y.call(this,a,!0)};g.defaultKeyMap={32:e,33:t,34:f,35:y,36:B,37:x,38:r,39:w,40:n};g.defaultHeaderKeyMap={32:e,35:z,36:A,37:x,39:w};return g})},"dojo/NodeList-manipulate":function(){define("./query ./_base/lang ./_base/array ./dom-construct ./dom-attr ./NodeList-dom".split(" "),function(r,l,d,q,k){function m(d){for(;d.childNodes[0]&&1==d.childNodes[0].nodeType;)d=d.childNodes[0];return d}function p(d,c){"string"==
typeof d?(d=q.toDom(d,c&&c.ownerDocument),11==d.nodeType&&(d=d.childNodes[0])):1==d.nodeType&&d.parentNode&&(d=d.cloneNode(!1));return d}var h=r.NodeList;l.extend(h,{_placeMultiple:function(d,c){for(var b="string"==typeof d||d.nodeType?r(d):d,a=[],e=0;e<b.length;e++)for(var h=b[e],k=this.length,l=k-1,f;f=this[l];l--)0<e&&(f=this._cloneNode(f),a.unshift(f)),l==k-1?q.place(f,h,c):h.parentNode.insertBefore(f,h),h=f;a.length&&(a.unshift(0),a.unshift(this.length-1),Array.prototype.splice.apply(this,a));
return this},innerHTML:function(d){return arguments.length?this.addContent(d,"only"):this[0].innerHTML},text:function(d){if(arguments.length){for(var c=0,b;b=this[c];c++)1==b.nodeType&&k.set(b,"textContent",d);return this}for(var a="",c=0;b=this[c];c++)a+=k.get(b,"textContent");return a},val:function(e){if(arguments.length){for(var c=l.isArray(e),b=0,a;a=this[b];b++){var g=a.nodeName.toUpperCase(),h=a.type,k=c?e[b]:e;if("SELECT"==g)for(g=a.options,h=0;h<g.length;h++){var m=g[h];m.selected=a.multiple?
-1!=d.indexOf(e,m.value):m.value==k}else"checkbox"==h||"radio"==h?a.checked=a.value==k:a.value=k}return this}if((a=this[0])&&1==a.nodeType){e=a.value||"";if("SELECT"==a.nodeName.toUpperCase()&&a.multiple){e=[];g=a.options;for(h=0;h<g.length;h++)m=g[h],m.selected&&e.push(m.value);e.length||(e=null)}return e}},append:function(d){return this.addContent(d,"last")},appendTo:function(d){return this._placeMultiple(d,"last")},prepend:function(d){return this.addContent(d,"first")},prependTo:function(d){return this._placeMultiple(d,
"first")},after:function(d){return this.addContent(d,"after")},insertAfter:function(d){return this._placeMultiple(d,"after")},before:function(d){return this.addContent(d,"before")},insertBefore:function(d){return this._placeMultiple(d,"before")},remove:h.prototype.orphan,wrap:function(d){if(this[0]){d=p(d,this[0]);for(var c=0,b;b=this[c];c++){var a=this._cloneNode(d);b.parentNode&&b.parentNode.replaceChild(a,b);m(a).appendChild(b)}}return this},wrapAll:function(d){if(this[0]){d=p(d,this[0]);this[0].parentNode.replaceChild(d,
this[0]);d=m(d);for(var c=0,b;b=this[c];c++)d.appendChild(b)}return this},wrapInner:function(d){if(this[0]){d=p(d,this[0]);for(var c=0;c<this.length;c++){var b=this._cloneNode(d);this._wrap(l._toArray(this[c].childNodes),null,this._NodeListCtor).wrapAll(b)}}return this},replaceWith:function(d){d=this._normalize(d,this[0]);for(var c=0,b;b=this[c];c++)this._place(d,b,"before",0<c),b.parentNode.removeChild(b);return this},replaceAll:function(d){d=r(d);for(var c=this._normalize(this,this[0]),b=0,a;a=
d[b];b++)this._place(c,a,"before",0<b),a.parentNode.removeChild(a);return this},clone:function(){for(var d=[],c=0;c<this.length;c++)d.push(this._cloneNode(this[c]));return this._wrap(d,this,this._NodeListCtor)}});h.prototype.html||(h.prototype.html=h.prototype.innerHTML);return h})},"jimu/dijit/ImageChooser":function(){define("dojo/Evented dojo/_base/declare dijit/_WidgetBase dijit/_TemplatedMixin dojo/_base/lang dojo/_base/html dojo/on dojo/text!./templates/ImageChooser.html dojo/sniff dojo/request esri/lang ../utils ./_CropImage jimu/dijit/Popup jimu/dijit/Message jimu/dijit/LoadingShelter".split(" "),
function(r,l,d,q,k,m,p,h,e,c,b,a,g,u,n,t){var f=0;r=l([d,q,r],{templateString:h,declaredClass:"jimu.dijit.ImageChooser",cropImage:!0,displayImg:null,defaultSelfSrc:null,showSelfImg:!1,label:null,showTip:!0,goldenWidth:400,goldenHeight:400,maxSize:1024,format:null,imageData:null,postMixInProperties:function(){this.inherited(arguments);this.nls=window.jimuNls.imageChooser;this.nls.common=window.jimuNls.common;this.nls.readError=this.nls.readError||"Failed to read the file."},postCreate:function(){this._initial();
a.file.supportHTML5()||e("safari")||!a.file.isEnabledFlash()||a.file.loadFileAPI().then(k.hitch(this,function(){m.setStyle(this.mask,"zIndex",1)}))},setImageSize:function(a){this.goldenWidth=a.width;this.goldenHeight=a.height},disableChooseImage:function(){m.setStyle(this.fileForm,"display","none");this.label&&"string"===typeof this.label&&m.addClass(this.displayText,"disable-label");m.removeAttr(this.domNode,"title")},enableChooseImage:function(){m.setStyle(this.fileForm,"display","block");this.label&&
"string"===typeof this.label&&m.removeClass(this.displayText,"disable-label");this._addTip()},setDefaultSelfSrc:function(a){this.defaultSelfSrc=a;this.imageData=this.selfImg.src=a},getImageData:function(){return this.imageData},_initial:function(){this._processProperties();this._porcessMaskClick();this._setupFileInput();this._addTip()},_processProperties:function(){this.fileProperty={};this.label&&"string"===typeof this.label&&(this.displayText.innerHTML=this.label,m.setStyle(this.hintText,"display",
"block"));this.showSelfImg&&m.setStyle(this.hintImage,"display","block");this.defaultSelfSrc&&(this.imageData=this.selfImg.src=this.defaultSelfSrc);if(this.format){var b="image/*";"string"===typeof this.format&&/^image\/./.test(this.format)?b=this.format:"[object Array]"===Object.prototype.toString.call(this.format)&&0<this.format.length&&(b=this.format.join(","));m.setAttr(this.fileInput,"accept",b)}a.file.supportHTML5()||e("safari")||!a.file.isEnabledFlash()||m.setStyle(this.fileInput,{width:"100%",
height:"100%",position:"absolute",left:0,top:0,opacity:0,zIndex:9})},_porcessMaskClick:function(){m.setAttr(this.fileInput,"id","imageChooser_"+f);m.setAttr(this.mask,"for","imageChooser_"+f);f++;this.maskHandle=p(this.mask,"click",k.hitch(this,function(b){b.stopPropagation();if(e("safari")&&7>e("safari"))new n({message:this.nls.unsupportReaderAPI}),b.preventDefault();else{if(!a.file.supportHTML5()){if(!a.file.isEnabledFlash()){var c=m.create("a",{href:"http://helpx.adobe.com/flash-player.html",innerHTML:this.nls.enableFlash,
target:"_blank"});new n({message:c});b.preventDefault();return}if(!a.file.supportFileAPI()){new n({message:this.nls.unsupportReaderAPI});b.preventDefault();return}}m.setStyle(this.fileInput,"display","none");setTimeout(k.hitch(this,function(){m.setStyle(this.fileInput,"display","block")}),200)}}))},_addTip:function(){if(this.showTip){var a=b.substitute({width:this.goldenWidth||40,height:this.goldenHeight||40},this.nls.toolTip);m.setAttr(this.domNode,"title",a)}else m.setAttr(this.domNode,"title",
"")},_setupFileInput:function(){if(9>=e("ie"))this.own(p(this.fileInput,"change",k.hitch(this,this._onFileInputChange)));else p.once(this.fileInput,"change",k.hitch(this,this._onFileInputChange))},_onFileInputChange:function(b){var c=b.target.files&&b.target.files[0]||b.files&&b.files[0];if(this.format&&-1===this.format.indexOf(c.type))new n({message:this.nls.invalidType}),(!e("ie")||9<e("ie"))&&this._recreateFileForm();else{var d=9>e("ie")?23552:1024*this.maxSize;a.file.readFile(b,"image/*",d,k.hitch(this,
function(a,b,f){a?(b=this.nls[a.errCode],"exceed"===a.errCode&&(b=b.replace("1024",d/1024)),new n({message:b})):(this.fileProperty.fileName=b,window.isXT&&this.cropImage&&"image/gif"!==c.type?this._cropImageByUser(f):this._readFileData(f));(!e("ie")||9<e("ie"))&&this._recreateFileForm()}))}},_recreateFileForm:function(){var a=k.clone(this.mask),b=k.clone(this.fileInput);m.destroy(this.mask);m.destroy(this.fileInput);var c=k.clone(this.fileForm);m.place(a,c);m.place(b,c);m.place(c,this.fileForm,"replace");
this.maskHandle.remove();this.mask=a;this.fileInput=b;m.destroy(this.fileForm);this.fileForm=c;this._porcessMaskClick();this._setupFileInput()},_readFileData:function(a){this.onImageChange(a,this.fileProperty);this.displayImg&&m.setAttr(this.displayImg,"src",a);this.showSelfImg&&(this.selfImg?m.setAttr(this.selfImg,"src",a):this.selfImg.src=a,(a=m.getMarginBox(this.hintImage))&&a.w&&a.h&&(m.style(this.selfImg,"maxWidth",a.w+"px"),m.style(this.selfImg,"maxHeight",a.h+"px")))},_cropImageByUser:function(a){var b=
new g({imageSrc:a,nls:k.clone(this.nls),realWidth:this.goldenWidth,realHeight:this.goldenHeight}),d=new t({hidden:!0}),e=new u({titleLabel:this.nls.cropImage,content:b,width:500,height:480,buttons:[{label:this.nls.common.ok,onClick:k.hitch(this,function(){var f=b.getImageSize(),g=b.getCropSize();d.show();c("/webappbuilder/rest/cropimage",{data:{imageData:a,imageDisplaySize:f.w+","+f.h,cropRectangle:g.w+","+g.h+","+g.t+","+g.l},method:"POST",handleAs:"json",headers:{"X-Requested-With":null}}).then(k.hitch(this,
function(a){a.success?(this._readFileData(a.imageData),e.close()):(new n({message:this.nls.unknowError}),d.hide())}),k.hitch(this,function(a){console.error(a);new n({message:this.nls.unknowError});d.hide()}))})}]});d.placeAt(e.domNode);b.startup();m.addClass(e.domNode,"image-chooser-crop-popup")},onImageChange:function(a){this.imageData=a;this.emit("imageChange",this.imageData,this.fileProperty);this.emit("change",this.imageData,this.fileProperty)}});r.GIF="image/gif";r.JPEG="image/jpeg";r.PNG="image/png";
return r})},"jimu/dijit/_CropImage":function(){define("dojo/_base/declare dojo/_base/html dojo/_base/lang dojo/on dojo/query dijit/_WidgetBase dijit/_TemplatedMixin dojo/text!./templates/_CropImage.html jimu/dijit/Message esri/lang dojo/NodeList-dom".split(" "),function(r,l,d,q,k,m,p,h,e,c){return r([m,p],{templateString:h,inDrag:!1,inSlider:!1,realWidth:30,realHeight:30,ratio:null,imageSrc:null,_currentX:null,_currentY:null,_currentTop:0,_currentLeft:0,postCreate:function(){this._dragingHandlers=
[];this.setImageSrc(this.imageSrc);this.own(q(this.ownerDocument,"mousemove",d.hitch(this,"_onMouseMove")));this.own(q(this.ownerDocument,"mouseup",d.hitch(this,"_onMouseUp")));this.loadingImg.src=require.toUrl("jimu")+"/images/loading.gif";this.own(q(this.baseImage,"load",d.hitch(this,function(){this._init();l.setStyle(this.loadingImg,"display","none")})))},setImageSrc:function(b){l.setAttr(this.viewerImage,"src",b);l.setAttr(this.baseImage,"src",b)},getImageSize:function(){return{w:this._currentImageWidth,
h:this._currentImageHeight}},getCropSize:function(){return{l:-this._currentLeft,t:-this._currentTop,w:this.idealWidth,h:this.idealHeight}},_init:function(){var b=this._getComputedStyle(this.cropSection),a=l.getContentBox(this.cropSection),g=this._getComputedStyle(this.baseImage),h=parseFloat(g.width)||this.baseImage.offsetWidth,g=parseFloat(g.height)||this.baseImage.offsetHeight,n=h/g;this._maxImageWidth=h;this._maxImageHeight=g;if(g<this.realHeight&&h<this.realWidth)b=c.substitute({width:this.realWidth,
height:this.realHeight},this.nls.cropWaining),setTimeout(d.hitch(this,function(){this.popup.close()}),50),new e({message:b});else{this.idealWidth=this.realWidth;this.idealHeight=this.realHeight;var m=this.ratio=this.ratio?this.ratio:this.realWidth/this.realHeight;1<=this.ratio?a.h*this.ratio<=a.w?(this.idealHeight=a.h,this.idealWidth=a.h*this.ratio):(this.idealHeight=this._findProperlyValue(0,a.h,a.w-5,function(a){return a*m}),this.idealWidth=this.idealHeight*this.ratio):a.w/this.ratio<=a.h?(this.idealWidth=
a.w,this.idealHeight=a.w/this.ratio):(this.idealWidth=this._findProperlyValue(0,a.w,a.h-5,function(a){return a/m}),this.idealHeight=this.idealWidth/this.ratio);l.setStyle(this.viewerBox,{width:this.idealWidth+"px",height:this.idealHeight+"px"});b=Math.abs((parseFloat(b.height)-this.idealHeight)/2);l.setStyle(this.cropSection,{paddingTop:b+"px",paddingBottom:b+"px"});1<=n?this.idealHeight*n>=this.idealWidth?(l.setStyle(this.viewerImage,"height",this.idealHeight+"px"),l.setStyle(this.baseImage,"height",
this.idealHeight+"px")):(b=this._findProperlyValue(0,this.idealWidth,this.idealWidth,function(a){return a*n}),l.setStyle(this.viewerImage,"height",b+"px"),l.setStyle(this.baseImage,"height",b+"px")):this.idealWidth/n>=this.idealHeight?(l.setStyle(this.viewerImage,"width",this.idealWidth+"px"),l.setStyle(this.baseImage,"width",this.idealWidth+"px")):(b=this._findProperlyValue(0,this.idealHeight,this.idealHeight,function(a){return a/n}),l.setStyle(this.viewerImage,"width",b+"px"),l.setStyle(this.baseImage,
"width",b+"px"));k(".hide-status",this.domNode).removeClass("hide-status");g=this._getComputedStyle(this.baseImage);h=parseFloat(g.width)||this.baseImage.offsetWidth;g=parseFloat(g.height)||this.baseImage.offsetHeight;this._minImageWidth=h;this._minImageHeight=g;this._currentImageWidth=h;this._currentImageHeight=g;this._currentTop=-(g-this.idealHeight)/2;this._currentLeft=-(h-this.idealWidth)/2;l.setStyle(this.baseImage,{top:this._currentTop+"px",left:this._currentLeft+"px"});l.setStyle(this.viewerImage,
{top:this._currentTop+"px",left:this._currentLeft+"px"});this._zoomRatio=this._maxImageWidth/this._minImageWidth;1>=this._zoomRatio&&l.addClass(this.zoomInBtn,"disable-zoom");l.addClass(this.zoomOutBtn,"disable-zoom");this._latestPercentage=window.isRTL?100:0}},_findProperlyValue:function(b,a,c,d,e){e=isFinite(e)?parseFloat(e):1;c=0>c-e||0>c+e?e:c;var g=(b+a)/2,f=d(g);if(f<=c+e&&f>=c-e)return g;if(f>c)return this._findProperlyValue(b,g,c,d);if(f<c)return this._findProperlyValue(g,a,c,d)},_getComputedStyle:function(b){b=
l.getMarginBox(b);return{width:b.w,height:b.h,left:b.l,top:b.t}},_onViewerMouseDown:function(b){var a=this._getComputedStyle(this.baseImage),c=this._getComputedStyle(this.viewerContent);this._maxOffsetLeft=parseFloat(c.width)-parseFloat(a.width);this._maxOffsetTop=parseFloat(c.height)-parseFloat(a.height);this._maxOffsetLeft=0<this._maxOffsetLeft?0:this._maxOffsetLeft;this._maxOffsetTop=0<this._maxOffsetTop?0:this._maxOffsetTop;this.inDrag=!0;this._currentX=b.clientX;this._currentY=b.clientY;this._stopSelect()},
_stopSelect:function(){this._dragingHandlers=this._dragingHandlers.concat([q(this.ownerDocument,"dragstart",function(b){b.stopPropagation();b.preventDefault()}),q(this.ownerDocumentBody,"selectstart",function(b){b.stopPropagation();b.preventDefault()})])},_removeStopSelect:function(){for(var b=this._dragingHandlers.pop();b;)b.remove(),b=this._dragingHandlers.pop()},_onViewerMouseUp:function(b){this.inDrag&&(this.inDrag=!1,this._resetImagePosition(b.clientX,b.clientY),this._removeStopSelect(),b.stopPropagation())},
_onSliderMouseDown:function(b){if(!(1>=this._zoomRatio)){this.inSlider=!0;this._currentX=b.clientX;this._currentY=b.clientY;var a=l.position(this.sliderNode);this._startSliderLeft=a.x;this._sliderWidth=a.w;this._stopSelect();b.stopPropagation()}},_onSliderMouseUp:function(b){if(!(1>=this._zoomRatio)&&this.inSlider){this.inSlider=!1;this._resetSliderButtonPosition(b.clientX);var a=this._getComputedStyle(this.baseImage);this._currentLeft=parseFloat(a.left);this._currentTop=parseFloat(a.top);this._latestPercentage=
(b.clientX-this._startSliderLeft)/this._sliderWidth*100;this._latestPercentage=this._normalizePercentage(this._latestPercentage);this._removeStopSelect();b.stopPropagation()}},_onMouseMove:function(b){this.inDrag&&this._resetImagePosition(b.clientX,b.clientY);!this.inSlider||1>=this._zoomRatio||this._resetSliderButtonPosition(b.clientX,b.clientY)},_onMouseUp:function(b){this.inDrag&&this._onViewerMouseUp(b);this.inSlider&&this._onSliderMouseUp(b)},_onZoomOutClick:function(){1>=this._zoomRatio||this._zoomImage("out")},
_onZoomInClick:function(){1>=this._zoomRatio||this._zoomImage("in")},_zoomImage:function(b){var a=0;this._latestPercentage=this._normalizePercentage(this._latestPercentage);"in"===b?a=window.isRTL?this._latestPercentage-20:this._latestPercentage+20:"out"===b&&(a=window.isRTL?this._latestPercentage+20:this._latestPercentage-20);b=this._normalizePercentage(a);this._moveSliderButton(b,this._latestPercentage);this._latestPercentage=b;b=this._getComputedStyle(this.baseImage);this._currentLeft=parseFloat(b.left);
this._currentTop=parseFloat(b.top)},_resetImagePosition:function(b,a){var c=b-this._currentX,d=a-this._currentY;0<=this._currentTop+d?(l.setStyle(this.baseImage,"top",0),l.setStyle(this.viewerImage,"top",0),this._currentY=a,this._currentTop=0):this._currentTop+d<=this._maxOffsetTop?(l.setStyle(this.baseImage,"top",this._maxOffsetTop+"px"),l.setStyle(this.viewerImage,"top",this._maxOffsetTop+"px"),this._currentY=a,this._currentTop=this._maxOffsetTop):(l.setStyle(this.baseImage,"top",this._currentTop+
d+"px"),l.setStyle(this.viewerImage,"top",this._currentTop+d+"px"),this._currentY=a,this._currentTop+=d);0<=this._currentLeft+c?(l.setStyle(this.baseImage,"left",0),l.setStyle(this.viewerImage,"left",0),this._currentX=b,this._currentLeft=0):this._currentLeft+c<=this._maxOffsetLeft?(l.setStyle(this.baseImage,"left",this._maxOffsetLeft+"px"),l.setStyle(this.viewerImage,"left",this._maxOffsetLeft+"px"),this._currentX=b,this._currentLeft=this._maxOffsetLeft):(l.setStyle(this.baseImage,"left",this._currentLeft+
c+"px"),l.setStyle(this.viewerImage,"left",this._currentLeft+c+"px"),this._currentX=b,this._currentLeft+=c)},_normalizePercentage:function(b){b=0>b?0:b;return 100<b?100:b},_resetSliderButtonPosition:function(b){b=(b-this._startSliderLeft)/this._sliderWidth*100;b=this._normalizePercentage(b);this._moveSliderButton(b,this._latestPercentage)},_moveSliderButton:function(b,a){0>=b?l.addClass(this.zoomOutBtn,"disable-zoom"):l.removeClass(this.zoomOutBtn,"disable-zoom");100<=b?l.addClass(this.zoomInBtn,
"disable-zoom"):l.removeClass(this.zoomInBtn,"disable-zoom");l.setStyle(this.sliderButton,"left",b+"%");window.isRTL&&(b=100-b,a=100-a);var c=this._minImageWidth*(this._zoomRatio-1)*b/100,d=this._minImageHeight*(this._zoomRatio-1)*b/100,e=this._getComputedStyle(this.baseImage);this._currentLeft=parseFloat(e.left);this._currentTop=parseFloat(e.top);var e=(Math.abs(this._currentLeft)+this.idealWidth/2)*((this._minImageWidth+c)/this._currentImageWidth-1),h=(Math.abs(this._currentTop)+this.idealHeight/
2)*((this._minImageWidth+c)/this._currentImageWidth-1);l.setStyle(this.baseImage,{width:this._minImageWidth+c+"px",height:this._minImageHeight+d+"px"});l.setStyle(this.viewerImage,{width:this._minImageWidth+c+"px",height:this._minImageHeight+d+"px"});this._currentImageWidth=this._minImageWidth+c;this._currentImageHeight=this._minImageHeight+d;if(0<=b-a)l.setStyle(this.baseImage,{top:this._currentTop-h+"px",left:this._currentLeft-e+"px"}),l.setStyle(this.viewerImage,{top:this._currentTop-h+"px",left:this._currentLeft-
e+"px"});else{var f=0,k=0,f=0<=this._currentTop-h?0:this._currentTop-h+this._minImageHeight+d<=this.idealHeight?this.idealHeight-this._minImageHeight-d:this._currentTop-h,k=0<=this._currentLeft-e?0:this._currentLeft-e+this._minImageWidth+c<=this.idealWidth?this.idealWidth-this._minImageWidth-c:this._currentLeft-e;l.setStyle(this.baseImage,{top:f+"px",left:k+"px"});l.setStyle(this.viewerImage,{top:f+"px",left:k+"px"})}this._latestPercentage=b}})})},"builder/dijit/template-config/utils":function(){define("dojo/_base/lang dojo/Deferred jimu/utils jimu/dijit/Message jimu/WidgetManager dojo/promise/all dojo/json builder/serviceUtils".split(" "),
function(r,l,d,q,k,m,p,h){return{loadAllWidgetConfigs:function(e){var c=new l,b=[];e.visitElement(function(a){if(a.uri){var c=k.getInstance().tryLoadWidgetConfig(a).then(function(b){b&&(a.config=b,e._originConfig&&(d.getConfigElementById(e._originConfig,a.id).config=b))});b.push(c)}});m(b).then(function(){c.resolve(e)},function(a){c.reject(a)});return c},saveAgolTemplate:function(d,c,b){var a=new l,e={itemId:b?b:this.app.agolTemplateInfo?this.app.agolTemplateInfo.itemId:null,json:c};h.saveAgolTemplate(this.app,
e).then(r.hitch(this,function(){this.app.agolTemplateInfo=e;this.lastTemplateJson=this.categoryManager.getTemplateJson();a.resolve()}),function(b){new q({message:b});a.reject()});return a}}})},"builder/plugins/app-list/_build-generate_module":function(){define(["builder/plugins/app-list/Plugin","dojo/text!builder/plugins/app-list/Plugin.html","dojo/text!builder/plugins/app-list/css/style.css","dojo/i18n!builder/plugins/app-list/nls/strings"],function(){})},"builder/plugins/app-list/Plugin":function(){define("dojo/_base/declare dojo/_base/html dojo/_base/array dojo/_base/Deferred dijit/_WidgetsInTemplateMixin dojo/text!./Plugin.html dojo/on dojo/_base/lang dojo/query dojo/topic ./Import ./AppCatalogPage ./CardPageWithBigThumbnail ./CardPageWithSmallThumbnail builder/serviceUtils jimu/dijit/LoadingShelter jimu/utils builder/BasePlugin esri/lang dojox/form/Uploader dojo/NodeList-dom".split(" "),
function(r,l,d,q,k,m,p,h,e,c,b,a,g,u,n,t,f,v,x){var w=r([v,k],{baseClass:"plugin-app-list",templateString:m,label:"applist",apps:null,templates:null,_appPages:null,_tempaltePage:null,_appPageState:null,_tempaltePageState:null,_currentPageState:null,_refreshImageFlag:null,postMixInProperties:function(){this.inherited(arguments);this.nls=h.mixin(this.nls,builderNls)},constructor:function(){this.apps=[];this.templates=[];this._appPages=[];this._appPageState={name:w.APP_PAGE,shownType:w.APP_TYPE_ALL,
sortBy:w.SORT_BY_MODIFIED_TIME,searchKey:""};this._tempaltePageState={name:w.TEMPLATE_PAGE,shownType:w.APP_TYPE_ALL,sortBy:w.SORT_BY_MODIFIED_TIME,searchKey:""};this._currentPageState=this._appPageState;this._refreshImageFlag=new Date},startup:function(){this.inherited(arguments);this.loading=new t({hidden:!0});this.loading.placeAt(this.domNode);this.importDijit=(new b({appListWidget:this})).placeAt(this.importBtn);var c=new g({appListWidget:this});this._addAppPage(c,"card-page2",this.nls.gridView);
c=new a({appListWidget:this});this._addAppPage(c,"catalog-page",this.nls.listView);this.refreshAppPage();this._tempaltePage=new u({appListWidget:this});this._tempaltePage.placeAt(this.templateContent);this.refreshTemplatePage();this._bindEvent()},_addAppPage:function(a,b,c){var d=l.create("div",{"class":"app-page-box"},this.appContent);a.placeAt(d);var f=l.create("div",{"class":"switch-app-page-btn jimu-float-leading "+b,title:c},this.switchAppPapgeBox);this.own(p(f,"click",h.hitch(this,function(){e(".app-page-box",
this.contentBox).removeClass("selected");l.addClass(d,"selected");e(".switch-app-page-btn",this.switchAppPapgeBox).removeClass("selected");l.addClass(f,"selected")})));0===this._appPages.length&&(l.addClass(d,"selected"),l.addClass(f,"selected"));this._appPages.push(a)},refreshAppPage:function(a){var b=new q;a?b.resolve():this.getAppList().then(h.hitch(this,function(a){this._currentPageState.sortBy!==w.SORT_BY_MODIFIED_TIME&&(a=this._sort(a));this.initApps(a);b.resolve()}));b.then(h.hitch(this,function(){var a=
this.filter(this.apps),b=this.filter(this.templates);d.forEach(this._appPages,function(c){c.refresh(a,b)},this)}))},refreshTemplatePage:function(a){var b=new q;a?b.resolve():this.getTemplateList().then(h.hitch(this,function(a){this._currentPageState.sortBy!==w.SORT_BY_MODIFIED_TIME&&(a=this._sort(a));this.initTemplates(a);b.resolve()}));b.then(h.hitch(this,function(){var a=this.filter(this.templates);this._tempaltePage.refresh(a)}))},refreshCurrentPage:function(a,b){this._currentPageState.name===
w.APP_PAGE?this.refreshAppPage(a):this._currentPageState.name===w.TEMPLATE_PAGE&&this.refreshTemplatePage(b)},getRefreshImageFlag:function(){return this._refreshImageFlag.getTime()},resetRefreshImageFlag:function(){this._refreshImageFlag=new Date},initApps:function(a){this.apps=this._filterItemByCondition(a);this.apps=this._mixinExtraProperties(this.apps)},initTemplates:function(a){this.templates=this._filterItemByCondition(a);this.templates=this._mixinExtraProperties(this.templates)},setApps:function(a){this.apps=
a},setTemplates:function(a){this.templates=a},_filterItemByCondition:function(a){var b=[];return b=d.filter(a,function(a){return window.isPortalSupport3D||a.appType!==w.APP_TYPE_3D?!0:!1},this)},_mixinExtraProperties:function(a){d.forEach(a,function(a){a.isTemplate||a.icon||(a.icon=a.themeName?"/webappbuilder/apps/"+a.id+"/themes/"+a.themeName+"/images/icon.png":"/webappbuilder/builder/images/logo.png",a._defaultIconClass="default-icon");a.downloadUrl="/webappbuilder/rest/apps/"+a.id+"/download";
var b="stemapp/index.html?id\x3d"+a.id;a.isPredefined&&(b+="\x26ispredefined\x3dtrue");a.appUrl=b;a.styleColor||(a.styleColor=w.DEFAULT_APP_STYLE_COLOR);a.id===w.ID_OF_BASIC_VIEWER_TEMPLATE?a.description=this.nls.basicViewerTemplateDesc:a.id===w.ID_OF_EDITOR_TEMPLATE?a.description=this.nls.editorTemplateDesc:a.id===w.ID_OF_SIMPLE_MAP_VIEWER_TEMPLATE&&(a.description=this.nls.simpleMapViewerTemplateDesc)},this);return a},getAppList:function(){return n.getAppList()},getTemplateList:function(){return n.getTemplateList().then(function(a){return d.filter(a,
function(a){return a.isTemplate})})},updateApp:function(a){return n.updateApp(a)},_getLocaleDateTime:function(a){return f.localizeDate(new Date(a),{fullYear:!0,selector:"date",formatLength:"medium"})},filter:function(a){a=this._filterByType(a);return a=this._filterBySearch(a)},_filterByType:function(a){var b=[];return b=this._currentPageState.shownType===w.APP_TYPE_ALL?a:d.filter(a,function(a){return a.appType===this._currentPageState.shownType},this)},_filterBySearch:function(a){var b=[],c=this._currentPageState.searchKey.toLowerCase();
return c?(d.forEach(a,function(a){0<=(a.name+" "+a.description+""+this._getLocaleDateTime(a.lastUpdated)+" "+a.creator+" "+a.modified).toLowerCase().indexOf(c)&&b.push(a)},this),b):a},_sort:function(a){var b=this._currentPageState.sortBy;a.sort(function(a,c){return a[b]&&c[b]?b===w.SORT_BY_MODIFIED_TIME?a[b]>c[b]?-1:1:a[b]<c[b]?-1:1:a[b]?-1:1});return a},_resetAppStateUI:function(){e(".filter",this.filterBox).removeClass("selected");var a=e("#"+this._currentPageState.shownType,this.filterBox)[0];
a&&l.addClass(a,"selected");e(".sort",this.sortBox).removeClass("selected");(a=e("#"+this._currentPageState.sortBy,this.sortBox)[0])&&l.addClass(a,"selected");this.searchBox.setValue(this._currentPageState.searchKey)},_addEmptyDescription:function(a,b){var c=l.create("div",{"class":"empty-description-box "+(b?b:"")},a),d=this.nls.appCreate,e=x.substitute({action:"\x3cspan\x3e"+d+"\x3c/span\x3e"},this.nls.emptyDescForCreate),d=this.nls.appImport,d=x.substitute({action:"\x3cspan\x3e"+d+"\x3c/span\x3e"},
this.nls.emptyDescForImport);l.create("div",{"class":"empty-description",innerHTML:e+"\x3cbr\x3e"+d},c)},_bindEvent:function(){this.own(c.subscribe("switchToAppListApps",h.hitch(this,this._onSwitchToAppContent)));this.own(c.subscribe("switchToAppListTemplates",h.hitch(this,this._onSwitchToTemplateContent)))},_onSwitchToAppContent:function(){l.removeClass(this.templateContent,"selected");l.addClass(this.appContent,"selected");this._currentPageState=this._appPageState;this._resetAppStateUI();l.removeClass(this.switchAppPapgeBox,
"hidden");l.setStyle(this.importDijit.itemImportBtn,"display","block");l.setStyle(this.createNewBtn,"display","block");l.setStyle(this.sortByAuthorBtn,"display","none")},_onSwitchToTemplateContent:function(){l.removeClass(this.appContent,"selected");l.addClass(this.templateContent,"selected");this._currentPageState=this._tempaltePageState;this._resetAppStateUI();l.addClass(this.switchAppPapgeBox,"hidden");l.setStyle(this.importDijit.itemImportBtn,"display","none");l.setStyle(this.createNewBtn,"display",
"none");l.setStyle(this.sortByAuthorBtn,"display","block")},_onSearchBoxChange:function(){this._currentPageState.searchKey=this.searchBox.getValue();this.refreshCurrentPage(!0,!0)},_filterAllBtnClick:function(){this._filterAppTypeBtnClick(this.filterAllBtn,w.APP_TYPE_ALL)},_filter2dBtnClick:function(){this._filterAppTypeBtnClick(this.filter2dBtn,w.APP_TYPE_2D)},_filter3dBtnClick:function(){this._filterAppTypeBtnClick(this.filter3dBtn,w.APP_TYPE_3D)},_filterAppTypeBtnClick:function(a,b){this._currentPageState.shownType!==
b&&(e(".filter",this.filterBox).removeClass("selected"),l.addClass(a,"selected"),this._currentPageState.shownType=b,this.refreshCurrentPage(!0,!0))},_sortByModifiedTimeBtnClick:function(){this._sortBtnClick(this.sortByModifiedTimeBtn,w.SORT_BY_MODIFIED_TIME)},_sortByNameBtnClick:function(){this._sortBtnClick(this.sortByNameBtn,w.SORT_BY_NAME)},_sortByAuthorBtnClick:function(){this._sortBtnClick(this.sortByAuthorBtn,w.SORT_BY_AUTHOR)},_sortBtnClick:function(a,b){this._currentPageState.sortBy!==b&&
(this._currentPageState.sortBy=b,e(".sort",this.sortBox).removeClass("selected"),l.addClass(a,"selected"),this._currentPageState.name===w.APP_PAGE?this.setApps(this._sort(this.apps)):this._currentPageState.name===w.TEMPLATE_PAGE&&this.setTemplates(this._sort(this.templates)),this.refreshCurrentPage(!0,!0))},_onCreateClick:function(){var a=this.pluginManager.getExtensions("startup.creation-entry")[0],a=this.pluginsMeta[a.pluginName];this.loading.show("");this.pluginManager.loadPlugin(a).then(h.hitch(this,
function(a){a.popupNewCreateDlg();this.loading.hide()}),h.hitch(this,function(){this.loading.hide()}))}});h.mixin(w,{APP_TYPE_ALL:"ALL",APP_TYPE_2D:"HTML",APP_TYPE_3D:"HTML3D",SORT_BY_MODIFIED_TIME:"lastUpdated",SORT_BY_NAME:"name",SORT_BY_AUTHOR:"creator",APP_PAGE:"appPage",TEMPLATE_PAGE:"templatePage",DEFAULT_APP_STYLE_COLOR:"#596679",ID_OF_BASIC_VIEWER_TEMPLATE:"HTML_basic_viewer",ID_OF_EDITOR_TEMPLATE:"HTML_editor",ID_OF_SIMPLE_MAP_VIEWER_TEMPLATE:"HTML_simple_map_viewer"});return w})},"builder/plugins/app-list/Import":function(){define("dojo/_base/declare dojo/_base/html dijit/_WidgetBase dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dojo/text!./Import.html dojo/on dojo/_base/lang dojo/sniff builder/serviceUtils dojo/query jimu/dijit/Message jimu/dijit/ItemSelector jimu/dijit/Popup builder/portalUtils esri/lang builder/dijit/FullScreenPopup dojox/form/Uploader dojo/NodeList-dom".split(" "),
function(r,l,d,q,k,m,p,h,e,c,b,a,g,u,n,t,f){return r([d,q,k],{baseClass:"import-app",templateString:m,_itemSelector:null,_importPopup:null,nls:null,postMixInProperties:function(){this.inherited(arguments);this.nls=this.appListWidget.nls;this.loading=this.appListWidget.loading},startup:function(){this.inherited(arguments);this.own(p(window.document,"click",h.hitch(this,function(a){a.clickFromSelf||setTimeout(h.hitch(this,function(){l.setStyle(this.actionsMenu,"display","none");window.isRTL?l.setStyle(this.actionsMenu,
{left:"auto",right:0}):l.setStyle(this.actionsMenu,{right:"auto",left:0});l.removeClass(this.actionsNode,"actions-drop-down")}),50)})));this._applyZipToFileInput();this.appPortalUrlInputNode&&(this.appPortalUrlInputNode.value=window.portalUrl);this._keepFileChooserOverItem()},_applyZipToFileInput:function(){b('input[type\x3d"file"]',this.appFileInputNode.domNode).forEach(h.hitch(this,function(a){l.setAttr(a,"accept",".zip")}))},_keepFileChooserOverItem:function(){9>=e("ie")&&b("span.dijitUploader input:first-child",
this.domNode).forEach(h.hitch(this,function(a){window.isRTL?l.setStyle(a,{left:"33px",right:"auto"}):l.setStyle(a,"right","33px")}))},_onActionsLabelClick:function(a){var b=l.getMarginBox(window.jimuConfig.layoutId),c=null;"none"===l.getStyle(this.actionsMenu,"display")?(l.setStyle(this.actionsMenu,"display","block"),c=l.position(this.actionsMenu),window.isRTL?0>c.x&&l.setStyle(this.actionsMenu,{right:"auto",left:0}):c.x+c.w>b.w&&l.setStyle(this.actionsMenu,{left:"auto",right:0})):(l.setStyle(this.actionsMenu,
"display","none"),c=l.position(this.actionsMenu),window.isRTL?l.setStyle(this.actionsMenu,{left:"auto",right:0}):l.setStyle(this.actionsMenu,{right:"auto",left:0}));a.clickFromSelf=!0},_onMenuItemClick:function(a){setTimeout(h.hitch(this,function(){l.setStyle(this.actionsMenu,"display","none");l.removeClass(this.actionsNode,"actions-drop-down");a.stopPropagation()}),50)},_onAppFileUploadError:function(b){console.error(b);new a({message:b.message||b});this._keepFileChooserOverItem();this._applyZipToFileInput();
this.loading.hide()},_onAppFileUploadComplete:function(a){a.success?(this._refreshAppOrTemplatePage(),this._keepFileChooserOverItem(),this._applyZipToFileInput(),this.loading.hide()):this._onAppFileUploadError(a)},_onAppFileChange:function(){var b=this.appFileInputNode.getFileList();b&&0<b.length&&(/.+(\.zip)$/.test(b[0].name)?(this.loading.show(this.nls.uploading),n.getPortal(window.portalUrl).getUser().then(h.hitch(this,function(a){l.setAttr(this.appFileCreatorInputNode,"value",a.username);l.setAttr(this.fromListNode,
"value",this._currentShownList);this.appFileInputNode.submit(this.uploadAppFileFormNode)}),function(b){console.error(b);new a({message:b.message||b});this.loading.hide()})):new a({message:this.nls.fileTypeError}))},_onImportClick:function(){this._itemSelector=new g({portalUrl:window.portalUrl,itemTypes:["Web Mapping Application"],onlyShowOnlineFeaturedItems:!1,typeKeywords:["Web AppBuilder"],showOnlineItems:!1});this.own(p(this._itemSelector,"item-selected",h.hitch(this,function(){this._importPopup.enableButton(0)})));
this.own(p(this._itemSelector,"none-item-selected",h.hitch(this,function(){this._importPopup.disableButton(0)})));var a=b("#main-page")[0];this._importPopup=new f({zIndex:101,titleStr:this.nls.importApp,blurContainer:a.firstElementChild,content:this._itemSelector.domNode,buttons:[{label:this.nls.ok,isHighLight:!0,onClick:h.hitch(this,this._onImportOkClick)},{label:this.nls.cancel,isHighLight:!1,onClick:h.hitch(this,this._onImportCancelClick)}],contentAutoHeight:!0});this._importPopup.placeAt(a);this._importPopup.show();
this._importPopup.disableButton(0);this._itemSelector.startup();this.own(p(this._itemSelector.tab,"tabChanged",h.hitch(this,function(){window.setTimeout(h.hitch(this,function(){this._importPopup.resize()},100))})));this.own(p(this._itemSelector,"update",h.hitch(this,function(){this._importPopup.resize()})))},_onImportOkClick:function(){var a=this._itemSelector.getSelectedItem(),b=a.id;this.loading.show();n.getPortal(window.portalUrl).getUser().then(h.hitch(this,function(d){a.getItemData().then(h.hitch(this,
function(e){this.loading.hide();this._importPopup.close();e=h.clone(e);c.switchImageFormatOfAppConfig({appConfig:e,appId:b},"import").then(h.hitch(this,function(b){this._checkAppVersion(b.appConfig,{creator:d.username,name:a.title,description:a.description||"",appType:a.typeKeywords&&0<=a.typeKeywords.indexOf("WAB3D")?"HTML3D":"HTML",stemappPath:this.appListWidget.pluginManager.getStemappInfo("HTML").appPath,portalUrl:window.portalUrl,isTemplate:!1,isTemplateApp:!1,isPredefined:!1})}),h.hitch(this,
function(b){this.loading.hide();this._checkAppInfoError(a.title,b)}))}),h.hitch(this,function(b){this.loading.hide();this._checkAppInfoError(a.title,b)}))}),h.hitch(this,function(b){this.loading.hide();this._checkAppInfoError(a.title,b)}))},_checkAppVersion:function(a,b){this.loading.show(this.nls.importing);c.checkAppVersion(a,b).then(h.hitch(this,function(c){this.loading.hide();c=c.versionInfo;"old"===c.wabVersionStatus?this._doAction("upgrade",a,b):"new"===c.wabVersionStatus?this._showNewer(b.name,
c.appVersion):"same"===c.wabVersionStatus&&this._doAction("import",a,b)}),h.hitch(this,function(b){this.loading.hide();this._checkAppInfoError(a.title,b)}))},_checkAppInfoError:function(b,c){new a({message:t.substitute({APP_NAME:b},this.nls.checkVersionError)});console.error(c)},_showUpgrade:function(a,b,c){c="\x3cdiv style\x3d'font-size:14px;'\x3e"+t.substitute({OLD_VERSION:c.appVersion,LATEST_VERSION:c.latestVersion},this.nls.upgradeContent)+"\x3cdiv style\x3d'height:24px;'\x3e\x3c/div\x3e"+this.nls.upgradeContentFooter+
"\x3c/div\x3e";var d=new u({titleLabel:this.nls.upgradeApp,content:l.toDom(c),width:640,autoHeight:!0,buttons:[{label:this.nls.upgradeBtn,onClick:h.hitch(this,function(){d.close();this._doAction("upgrade",a,b)})},{label:this.nls.cancel,classNames:["jimu-btn-vacation"],onClick:h.hitch(this,function(){d.close()})}]})},_showNewer:function(a,b){var c="\x3cdiv style\x3d'font-size:14px;'\x3e"+t.substitute({APP_NAME:a,VERSION_NUMBER:b},this.nls.importUpperVertion)+"\x3c/div\x3e";new u({titleLabel:this.nls.importApp,
content:l.toDom(c),width:640,autoHeight:!0,buttons:[{label:this.nls.ok}]})},_doAction:function(a,b,d){"import"===a?this.loading.show(this.nls.importing):"upgrade"===a&&this.loading.show(this.nls.upgrading);c.importPortalApp(b,d).then(h.hitch(this,function(){this._importSuccess(d.appName)}),h.hitch(this,function(a){this.loading.hide();this._importError(d.appName,a)}))},_importSuccess:function(a){this.appListWidget.getAppList().then(h.hitch(this,function(){this._refreshAppOrTemplatePage();var b="\x3cdiv style\x3d'font-size:14px;'\x3e"+
t.substitute({APP_NAME:a},this.nls.importSuccess)+"\x3c/div\x3e";new u({titleLabel:this.nls.importApp,content:l.toDom(b),width:640,autoHeight:!0,buttons:[{label:this.nls.ok}]})}),h.hitch(this,function(a){console.error(a)})).always(h.hitch(this,function(){this.loading.hide()}))},_importError:function(a,b){var c="\x3cdiv style\x3d'font-size:14px;'\x3e"+t.substitute({APP_NAME:a},this.nls.upgradeFailure)+"\x3c/div\x3e";new u({titleLabel:this.nls.importApp,content:l.toDom(c),width:640,autoHeight:!0,buttons:[{label:this.nls.ok}]});
console.error(b)},_onImportCancelClick:function(){this._importPopup.close()},_refreshAppOrTemplatePage:function(){this.appListWidget.refreshTemplatePage();this.appListWidget.refreshAppPage()}})})},"jimu/dijit/ItemSelector":function(){define("dojo/_base/declare dojo/topic dijit/_WidgetBase dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dojo/text!./templates/ItemSelector.html dojo/Evented dojo/_base/lang dojo/_base/config dojo/_base/array dojo/_base/html dojo/_base/Deferred dojo/promise/all dojo/query dojo/on jimu/utils jimu/portalUtils jimu/tokenUtils jimu/portalUrlUtils jimu/dijit/ViewStack jimu/dijit/Search jimu/dijit/TabContainer3 jimu/dijit/_ItemTable".split(" "),
function(r,l,d,q,k,m,p,h,e,c,b,a,g,u,n,t,f,v,x,w,z,A,y){return r([d,q,k,p],{templateString:m,declaredClass:"jimu.dijit.ItemSelector",baseClass:"jimu-item-selector",tab:null,_user:null,_group:null,_allPublicPortalQuery:null,_filterPublicPortalQuery:null,_allPublicOnlineQuery:null,_filterPublicOnlineQuery:null,_allOrganizationQuery:null,_filterOrganizationQuery:null,_allMyContentQuery:null,_filterMyContentQuery:null,_allGroupQuery:null,_filterGroupQuery:null,_isPublicTabShow:!1,_signIn:!1,_itemTypeQueryString:"",
_typeKeywordQueryString:"",portalUrl:null,itemTypes:"",typeKeywords:"",showOnlineItems:!0,onlyShowOnlineFeaturedItems:!1,postMixInProperties:function(){this.portalUrl=x.getStandardPortalUrl(this.portalUrl);this.showOnlineItems=!1===this.showOnlineItems?!1:!0;this.itemTypes&&0<this.itemTypes.length||(this.itemTypes=[]);this._itemTypes="";c.forEach(this.itemTypes,h.hitch(this,function(a,b){this._itemTypes+='"'+a+'"';b!==this.itemTypes.length-1&&(this._itemTypes+=",")}));this._itemTypes="["+this._itemTypes+
"]";this.typeKeywords&&0<this.typeKeywords.length||(this.typeKeywords=[]);this._typeKeywords="";c.forEach(this.typeKeywords,h.hitch(this,function(a,b){this._typeKeywords+='"'+a+'"';b!==this.typeKeywords.length-1&&(this._typeKeywords+=",")}));this._typeKeywords="["+this._typeKeywords+"]";this.nls=window.jimuNls.itemSelector},postCreate:function(){this.inherited(arguments);var a=this._getPortalUrl();this.portal=f.getPortal(a);this._initOptions();this._initSearchQuery();this._initTabs();this._initPortalRadio();
this._initItemTables();this._initPublic();this._initPrivate();this._updateUIbySignIn()},_initOptions:function(){this._itemTypeQueryString=t.getItemQueryStringByTypes(this.itemTypes);this._typeKeywordQueryString=t.getItemQueryStringByTypeKeywords(this.typeKeywords)},_initTabs:function(){this.tab=new A({tabs:[{title:this.nls.myContent,content:this.mycontentTabNode},{title:this.nls.myOrganization,content:this.organizationTabNode},{title:this.nls.myGroup,content:this.groupTabNode},{title:this.nls.publicMap,
content:this.publicTabNode}]},this.tabNode);this.own(n(this.tab,"tabChanged",h.hitch(this,function(a){b.setStyle(this.signinSection,"display","none");a!==this.nls.publicMap?(this._isPublicTabShow=!1,this._updateUIbySignIn()):this._isPublicTabShow=!0})))},_updateUIbySignIn:function(){b.setStyle(this.signinSection,"display","none");var a=u(".organization-tab-content-main,.group-tab-content-main,.mycontent-tab-content-main",this.domNode);v.userHaveSignInPortal(this._getPortalUrl())?a.style("display",
"block"):(a.style("display","none"),this._isPublicTabShow||b.setStyle(this.signinSection,"display","block"))},_initPortalRadio:function(){t.combineRadioCheckBoxWithLabel(this.portalPublicRaido,this.portalPublicLabel);t.combineRadioCheckBoxWithLabel(this.onlinePublicRaido,this.onlinePublicLabel);var a=this._getPortalUrl(),a=x.getServerByUrl(a);this.portalPublicRaido.disabled=!1;this.onlinePublicRaido.disabled=!1;this.portalPublicRaido.checked=!0;var c=!1;x.isArcGIScom(a)?(c=!0,this.portalPublicLabel.innerHTML=
"ArcGIS.com"):(this.portalPublicLabel.innerHTML=a,c=this.showOnlineItems?!1:!0);c&&(this.onlinePublicRaido.disabled=!0,b.setStyle(this.onlinePublicRaido,"display","none"),b.setStyle(this.onlinePublicLabel,"display","none"))},_initSearchQuery:function(){var a="esri_"+(e.locale&&e.locale.slice(0,2)||"en").toLowerCase(),b=c.filter("esri_he esri_fr esri_ja esri_nl esri_th esri_tr esri_nb esri_ro esri_it esri_pl esri_po esri_ru esri_pt esri_en esri_ar esri_et esri_es esri_ko esri_cs esri_da esri_zh esri_sv esri_lt esri_fi esri_lv esri_de esri_vi".split(" "),
h.hitch(this,function(b){return b!==a})),d="";c.forEach(b,h.hitch(this,function(a){d+=" -owner:"+a+" "}));b=" ";this.portal&&this.portal.user&&this.portal.user.orgId&&(b=" orgid:"+this.portal.user.orgId+" ");b=b+this._itemTypeQueryString+" AND access:public "+d+" "+this._typeKeywordQueryString;this._allPublicPortalQuery=this._getQuery({sortField:"numViews",sortOrder:"desc",q:b});this._filterPublicPortalQuery=this._getQuery({q:b,basicQ:b});this._allPublicOnlineQuery=this._getQuery({sortField:"numViews",
sortOrder:"desc",q:(this.onlyShowOnlineFeaturedItems?' (group:"c755678be14e4a0984af36a15f5b643e"  OR group:"b8787a74b4d74f7fb9b8fac918735153") ':" ")+this._itemTypeQueryString+" AND access:public "+this._typeKeywordQueryString});this._filterPublicOnlineQuery=this._getQuery({q:this._itemTypeQueryString+" AND access:public "+this._typeKeywordQueryString});this._allOrganizationQuery=this._getQuery();this._filterOrganizationQuery=this._getQuery();this._allMyContentQuery=this._getQuery();this._filterMyContentQuery=
this._getQuery();this._allGroupQuery=this._getQuery();this._filterGroupQuery=this._getQuery()},_getQuery:function(a){return h.mixin({start:1,num:16,f:"json"},a||{})},_getPortalUrl:function(){return x.getStandardPortalUrl(this.portalUrl)},_initItemTables:function(){"function"===typeof this.onCreateItemContent&&(this.mycontentItemTable.onCreateItemContent=this.onCreateItemContent,this.organizationItemTable.onCreateItemContent=this.onCreateItemContent,this.groupItemTable.onCreateItemContent=this.onCreateItemContent,
this.publicPortalItemTable.onCreateItemContent=this.onCreateItemContent,this.publicOnlineItemTable.onCreateItemContent=this.onCreateItemContent);this.own(n(this.publicPortalItemTable,"item-dom-clicked",h.hitch(this,this._onItemDomClicked)));this.own(n(this.publicOnlineItemTable,"item-dom-clicked",h.hitch(this,this._onItemDomClicked)));this.own(n(this.organizationItemTable,"item-dom-clicked",h.hitch(this,this._onItemDomClicked)));this.own(n(this.groupItemTable,"item-dom-clicked",h.hitch(this,this._onItemDomClicked)));
this.own(n(this.mycontentItemTable,"item-dom-clicked",h.hitch(this,this._onItemDomClicked)));this.own(n(this.publicPortalItemTable,"update",h.hitch(this,this._onItemTableUpdate)));this.own(n(this.publicOnlineItemTable,"update",h.hitch(this,this._onItemTableUpdate)));this.own(n(this.organizationItemTable,"update",h.hitch(this,this._onItemTableUpdate)));this.own(n(this.groupItemTable,"update",h.hitch(this,this._onItemTableUpdate)));this.own(n(this.mycontentItemTable,"update",h.hitch(this,this._onItemTableUpdate)));
var a=this._getPortalUrl();this.portalPublicRaido.disabled||(this.publicPortalItemTable.set("portalUrl",a),this.publicPortalItemTable.searchAllItems(this._allPublicPortalQuery),this.publicPortalItemTable.set("filteredQuery",this._filterPublicPortalQuery));this.onlinePublicRaido.disabled||(this.publicOnlineItemTable.set("portalUrl",window.location.protocol+"//www.arcgis.com"),this.publicOnlineItemTable.searchAllItems(this._allPublicOnlineQuery),this.publicOnlineItemTable.set("filteredQuery",this._filterPublicOnlineQuery))},
_initPublic:function(){this.own(n(this.portalPublicRaido,"click",h.hitch(this,this._onPublicRaidoClicked)));this.own(n(this.onlinePublicRaido,"click",h.hitch(this,this._onPublicRaidoClicked)));this._onPublicRaidoClicked()},_onPublicRaidoClicked:function(){this.portalPublicRaido.checked?(this.publicPortalItemTable.show(),this.publicOnlineItemTable.hide()):this.onlinePublicRaido.checked&&(this.publicPortalItemTable.hide(),this.publicOnlineItemTable.show())},_onPublicSearch:function(a){(a=a&&h.trim(a))?
(this.publicPortalItemTable.showFilterItemsSection(),this.publicOnlineItemTable.showFilterItemsSection(),this.portalPublicRaido.checked?(this._filterPublicPortalQuery.q=a+" "+this._filterPublicPortalQuery.basicQ,this._filterPublicPortalQuery.start=1,this.publicPortalItemTable.searchFilteredItems(this._filterPublicPortalQuery)):this.onlinePublicRaido.checked&&(this._filterPublicOnlineQuery.q=a+" "+this._itemTypeQueryString+" AND access:public "+this._typeKeywordQueryString,this._filterPublicOnlineQuery.start=
1,this.publicOnlineItemTable.searchFilteredItems(this._filterPublicOnlineQuery))):(this.publicPortalItemTable.showAllItemsSection(),this.publicOnlineItemTable.showAllItemsSection())},_initPrivate:function(){this._resetPortalMaps();this.own(n(this.groupsSelect,"change",h.hitch(this,this._onGroupsSelectChange)));var a=x.getServerByUrl(this._getPortalUrl());x.isArcGIScom(a)&&(a="ArcGIS.com");v.userHaveSignInPortal(this._getPortalUrl())&&this._onSignIn()},_onOrganizationSearch:function(a){if(a=a&&h.trim(a)){if(this._allOrganizationQuery){var b=
this._allOrganizationQuery.q;b&&(this._filterOrganizationQuery.q=a+" "+b,this._filterOrganizationQuery.start=1,this.organizationItemTable.searchFilteredItems(this._filterOrganizationQuery))}}else this.organizationItemTable.showAllItemsSection()},_onMyContentSearch:function(a){if(a=a&&h.trim(a)){if(this._allMyContentQuery){var b=this._allMyContentQuery.q;b&&(this._filterMyContentQuery.q=a+" "+b,this._filterMyContentQuery.start=1,this.mycontentItemTable.searchFilteredItems(this._filterMyContentQuery))}}else this.mycontentItemTable.showAllItemsSection()},
_onGroupSearch:function(a){if(a=a&&h.trim(a)){if(this._allGroupQuery){var b=this._allGroupQuery.q;b&&(this._filterGroupQuery.q=a+" "+b,this._filterGroupQuery.start=1,this.groupItemTable.searchFilteredItems(this._filterGroupQuery))}}else this.groupItemTable.showAllItemsSection()},_onSignIn:function(){this._updateUIbySignIn();if(!this._signIn){this._signIn=!0;var a=this._getPortalUrl();f.getPortal(a).getUser().then(h.hitch(this,function(a){this.domNode&&(this._resetPortalMaps(),this._searchOrganization(a),
this._searchMyContent(a),this._searchGroups(a))}))}},_onSignOut:function(){this._signIn=!1;this._resetPortalMaps();this._updateUIbySignIn()},_resetPortalMaps:function(){this.organizationItemTable.clear();this.mycontentItemTable.clear();this._resetGroupsSection()},_searchOrganization:function(a){this.organizationItemTable.clear();a=" orgid:"+a.orgId+" AND "+this._itemTypeQueryString+" AND (access:org OR access:public) "+this._typeKeywordQueryString;var b=this._getPortalUrl();this._allOrganizationQuery=
this._getQuery({q:a});this._filterOrganizationQuery=this._getQuery({q:a});this.organizationItemTable.set("portalUrl",b);this.organizationItemTable.searchAllItems(this._allOrganizationQuery)},_searchMyContent:function(a){this.mycontentItemTable.clear();var b=this._getPortalUrl();a="owner:"+a.username+" AND "+this._itemTypeQueryString+" "+this._typeKeywordQueryString;this._allMyContentQuery=this._getQuery({q:a});this._filterMyContentQuery=this._getQuery({q:a});this.mycontentItemTable.set("portalUrl",
b);this.mycontentItemTable.searchAllItems(this._allMyContentQuery)},_searchGroups:function(a){this._resetGroupsSection();b.setStyle(this.groupsSection,"display","block");a=a.getGroups();if(0<a.length){b.setStyle(this.groupSearch.domNode,"display","block");this.groupItemTable.show();b.empty(this.groupsSelect);for(var c=0;c<a.length;c++){var d=a[c];b.create("option",{value:d.id,innerHTML:d.title},this.groupsSelect)}this._onGroupsSelectChange()}this._updateUIbyGroups(a.length)},_resetGroupsSection:function(){b.setStyle(this.groupsSection,
"display","none");b.empty(this.groupsSelect);b.create("option",{value:"nodata",innerHTML:this.nls.noneGroups},this.groupsSelect);this.groupItemTable.clear();b.setStyle(this.groupSearch.domNode,"display","none");this.groupItemTable.hide();this._updateUIbyGroups(0)},_updateUIbyGroups:function(a){0===a?b.setStyle(this.groupsSection,"top","15px"):b.setStyle(this.groupsSection,"top","50px")},_onGroupsSelectChange:function(){var a=this.groupsSelect.value;this.groupItemTable.clear();if("nodata"===a)b.setStyle(this.groupSearch,
"display","none"),this.groupItemTable.hide();else{b.setStyle(this.groupSearch,"display","block");this.groupItemTable.show();var c=this._getPortalUrl(),a="group:"+a+" AND "+this._itemTypeQueryString+" "+this._typeKeywordQueryString;this._allGroupQuery=this._getQuery({q:a});this._filterGroupQuery=this._getQuery({q:a});this.groupItemTable.set("portalUrl",c);this.groupItemTable.searchAllItems(this._allGroupQuery)}},_onItemTableUpdate:function(){this.emit("update")},_onItemDomClicked:function(a){var c=
b.hasClass(a,"jimu-state-active");u(".item.jimu-state-active",this.domNode).removeClass("jimu-state-active");c&&b.addClass(a,"jimu-state-active");(a=this.getSelectedItem())?this.emit("item-selected",a):this.emit("none-item-selected")},getSelectedItem:function(){var a=null,b=u(".item.jimu-state-active",this.domNode);0<b.length&&(a=h.mixin({},b[0].item));return a}})})},"jimu/dijit/Search":function(){define(["dojo/_base/declare","dojo/_base/html","dojo/string","dijit/_WidgetBase","dijit/_TemplatedMixin"],
function(r,l,d,q,k){return r([q,k],{baseClass:"jimu-search",declaredClass:"jimu.dijit.Search",templateString:'\x3cdiv\x3e\x3cspan class\x3d"jimu-input-wrapper" style\x3d"left:0;right:0;"\x3e\x3cinput class\x3d"jimu-input" style\x3d"background:#fafafc;" data-dojo-attach-point\x3d"inputSearch" data-dojo-attach-event\x3d"onKeydown: _onKeyDown, onKeyUp: _onKeyUp"/\x3e\x3c/span\x3e\x3cdiv class\x3d"search-btn jimu-icon jimu-icon-search" data-dojo-attach-point\x3d"searchBtn" data-dojo-attach-event\x3d"onClick: _onBtnClick"\x3e\x3c/div\x3e\x3c/div\x3e',
placeholder:"",onSearch:null,searchWhenInput:!1,postCreate:function(){this.inherited(arguments);this.placeholder&&l.setAttr(this.inputSearch,"placeholder",this.placeholder)},getValue:function(){return d.trim(this.inputSearch.value)},doSearch:function(){if(this.onSearch)this.onSearch(this.getValue())},_onKeyDown:function(d){this.doChange();13===(void 0!==d.keyCode?d.keyCode:d.which)&&this.doSearch();d.stopPropagation()},_onKeyUp:function(){this.searchWhenInput&&this.doSearch()},_onBtnClick:function(){this.doSearch()},
doChange:function(){if(this.onChange)this.onChange(this.getValue())}})})},"jimu/dijit/TabContainer3":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/html dojo/on dojo/Evented dojo/query dijit/_WidgetBase dijit/_TemplatedMixin dojo/text!./templates/TabContainer3.html jimu/dijit/ViewStack".split(" "),function(r,l,d,q,k,m,p,h,e,c,b){return r([h,e,m],{templateString:c,selected:"",tabs:null,average:!0,baseClass:"jimu-tab3",declaredClass:"jimu.dijit.TabContainer3",_currentIndex:-1,
postCreate:function(){this.inherited(arguments);this._initSelf();this.selected?this.selectTab(this.selected):0<this.tabs.length&&this.selectTab(this.tabs[0].title)},selectTab:function(a){var b=p("td",this.tabTr);d.forEach(b,l.hitch(this,function(b,c){q.removeClass(b,"jimu-state-active");b.label===a&&(q.addClass(b,"jimu-state-active"),this._currentIndex=c)}));this.controlNode.removeChild(this.controlTable);q.place(this.controlTable,this.controlNode);this.viewStack.switchView(a);this.emit("tabChanged",
a)},addTab:function(a){if(!this.average){var b=p("td:last-child",this.tabTr);0<b.length&&q.destroy(b[0])}0<d.filter(this.tabs,function(b){return b.title===a.title}).length?console.error("tab title conflict: "+a.title):(this.tabs.push(a),this._createTab(a),this.average||(b=q.toDom('\x3ctd nowrap class\x3d"tab-item-td" style\x3d"border-bottom:1px solid #ccc;"\x3e\x3cdiv class\x3d"tab-item-div"\x3e\x3c/div\x3e\x3c/td\x3e'),q.place(b,this.tabTr)))},removeTab:function(a){var b=-1;if(d.some(this.tabs,function(c,
d){if(c.title===a)return b=d,!0})){var c=this.tabs.splice(b,1)[0],e=p("td",this.tabTr),h;d.some(e,function(b){if(b.label===a)return h=b,!0})&&q.destroy(h);this.viewStack.removeView(c.content)}},showShelter:function(){q.setStyle(this.shelter,"display","block")},hideShelter:function(){q.setStyle(this.shelter,"display","none")},getSelectedIndex:function(){return this._currentIndex},getSelectedTitle:function(){return this.viewStack.getSelectedLabel()},_initSelf:function(){this.viewStack=new b(null,this.containerNode);
d.forEach(this.tabs,function(a){this._createTab(a)},this);if(this.average)this.controlTable.style.tableLayout="fixed",q.addClass(this.domNode,"average");else{var a=q.toDom('\x3ctd nowrap class\x3d"tab-item-td" style\x3d"border-bottom:1px solid #ccc;"\x3e\x3cdiv class\x3d"tab-item-div"\x3e\x3c/div\x3e\x3c/td\x3e');q.place(a,this.tabTr)}},startup:function(){this.inherited(arguments);this._started=!0},_createTab:function(a){var b=q.toDom('\x3ctd nowrap class\x3d"tab-item-td"\x3e\x3cdiv class\x3d"tab-item-div"\x3e\x3c/div\x3e\x3c/td\x3e');
b.label=a.title||"";q.place(b,this.tabTr);var c=p(".tab-item-div",b)[0];c.innerHTML=b.label;c.label=b.label;a.content.label=b.label;this.viewStack.addView(a.content);this.own(k(b,"click",l.hitch(this,this._onSelect,a.title)))},_onSelect:function(a){this.selectTab(a)}})})},"jimu/dijit/_ItemTable":function(){define("dojo/_base/declare dijit/_WidgetBase dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dojo/text!./templates/_ItemTable.html dojo/Evented dojo/_base/lang dojo/_base/array dojo/_base/html dojo/_base/Deferred dojo/query dojo/on jimu/utils jimu/portalUtils jimu/portalUrlUtils jimu/dijit/LoadingIndicator".split(" "),
function(r,l,d,q,k,m,p,h,e,c,b,a,g,u,n,t){return r([l,d,q,m],{templateString:k,declaredClass:"jimu.dijit.ItemTable",baseClass:"jimu-item-table",query:null,filteredQuery:null,portalUrl:null,hidden:!1,nls:null,types:"",typeKeywords:"",_defaultThumbnail:{"Web Mapping Application":"webapp.png","Mobile Application":"mobileapp.png"},postMixInProperties:function(){this.nls=window.jimuNls.itemSelector},postCreate:function(){this.inherited(arguments);this._initSelf()},_initSelf:function(){this.types&&0<this.types.length||
(this.types=[]);(this.hidden=!0===this.hidden)&&this.hide();this.portalUrl&&(this.portalUrl=n.getStandardPortalUrl(this.portalUrl));this.showAllItemsSection();this.searchAllItems()},show:function(){e.setStyle(this.domNode,"display","block")},hide:function(){e.setStyle(this.domNode,"display","none")},searchAllItems:function(a){this.showAllItemsSection();a&&(this.query=p.mixin({},a),this.query.start=1,this.clearAllItemsSection());this.portalUrl&&this.query&&0<this.query.start&&(this.allItemsShelter.show(),
u.getPortal(this.portalUrl).queryItems(this.query).then(p.hitch(this,function(a){this.domNode&&(this.allItemsShelter.hide(),this.query.start=a.nextStart,this._createItems(a,this.allItemTbody))}),p.hitch(this,function(a){console.error(a);this.domNode&&this.allItemsShelter.hide()})))},searchFilteredItems:function(a){this.showFilterItemsSection();a&&(this.filteredQuery=p.clone(a),this.filteredQuery.start=1,this.clearFilteredItemsSection());this.portalUrl&&this.filteredQuery&&0<this.filteredQuery.start&&
(this.filteredItemShelter.show(),u.getPortal(this.portalUrl).queryItems(this.filteredQuery).then(p.hitch(this,function(b){this.domNode&&(this.showFilterItemsSection(),a&&this.clearFilteredItemsSection(),this.filteredQuery.start=b.nextStart,this._createItems(b,this.filteredItemsTbody),this._filterItemCallback())}),p.hitch(this,function(a){console.error(a);this.domNode&&this._filterItemCallback()})))},_filterItemCallback:function(){this.filteredItemShelter.hide();0<this._getItemCount(this.filteredItemsTbody)?
(e.setStyle(this.filteredItemsTableDiv,"display","block"),e.setStyle(this.searchNoneTipSection,"display","none")):(e.setStyle(this.filteredItemsTableDiv,"display","none"),e.setStyle(this.searchNoneTipSection,"display","block"))},clear:function(){this.clearAllItemsSection();this.clearFilteredItemsSection()},clearAllItemsSection:function(){e.empty(this.allItemTbody)},clearFilteredItemsSection:function(){e.empty(this.filteredItemsTbody)},showAllItemsSection:function(){e.setStyle(this.allItemsSection,
"display","block");e.setStyle(this.filteredItemsSection,"display","none")},showFilterItemsSection:function(){e.setStyle(this.allItemsSection,"display","none");e.setStyle(this.filteredItemsSection,"display","block");e.setStyle(this.filteredItemsTableDiv,"display","block");e.setStyle(this.searchNoneTipSection,"display","none")},_onAllItemsSectionScroll:function(){this._isScrollToBottom(this.allItemsTableDiv)&&this.searchAllItems()},_onFilteredItemsSectionScroll:function(){this._isScrollToBottom(this.filteredItemsTableDiv)&&
this.searchFilteredItems()},_isScrollToBottom:function(a){return g.isScrollToBottom(a)},_createItems:function(a,c){var d=a.results,f=h.map(this.types,p.hitch(this,function(a){return a.toLowerCase()})),d=h.filter(d,p.hitch(this,function(a){a=a.type&&a.type.toLowerCase()||"";return 0<=h.indexOf(f,a)}));if(0!==d.length){var g,k=b("td.empty",c),l;if(0<k.length){var n=Math.min(d.length,k.length),m=d.splice(0,n);for(l=0;l<n;l++){var q=k[l];g=this._createItem(m[l]);e.place(g,q);e.removeClass(q,"empty")}}if(0!==
d.length){k=Math.ceil(d.length/2);for(l=0;l<k;l++)for(g=e.toDom("\x3ctr\x3e\x3ctd\x3e\x3c/td\x3e\x3ctd\x3e\x3c/td\x3e\x3c/tr\x3e"),e.place(g,c),n=b("td",g),m=0;m<n.length;m++)q=n[m],(g=d[2*l+m])?(g=this._createItem(g),e.place(g,q)):e.addClass(q,"empty");this.emit("update")}}},_getItemCount:function(a){return b(".item",a).length},_createItem:function(a){var c=e.toDom('\x3cdiv class\x3d"item"\x3e\x3cdiv class\x3d"item-border"\x3e\x3c/div\x3e\x3cdiv class\x3d"item-thumbnail jimu-auto-vertical"\x3e\x3cdiv class\x3d"none-thumbnail-tip jimu-auto-vertical-content"\x3e\x3c/div\x3e\x3c/div\x3e\x3cdiv class\x3d"item-info"\x3e\x3cdiv class\x3d"item-name"\x3e\x3c/div\x3e\x3cdiv class\x3d"item-type-owner"\x3e\x3c/div\x3e\x3cdiv class\x3d"item-date"\x3e\x3c/div\x3e\x3ca class\x3d"item-details" target\x3d"_blank"\x3e\x3c/a\x3e\x3c/div\x3e\x3c/div\x3e');
c.item=a;var d=b(".item-thumbnail",c)[0],f=b(".item-name",c)[0],g=b(".item-type-owner",c)[0],h=b(".item-date",c)[0],k=b(".item-details",c)[0],l=b(".none-thumbnail-tip",c)[0];if(!a.thumbnailUrl){var n=this._defaultThumbnail[a.type];n&&(a.thumbnailUrl=require.toUrl("jimu")+"/images/"+n)}a.thumbnailUrl?e.setStyle(d,"backgroundImage","url("+a.thumbnailUrl+")"):l.innerHTML=this.nls.noneThumbnail;"function"===typeof this.onCreateItemContent?(h=b(".item-info",c)[0],this.onCreateItemContent(a,h)):(f.innerHTML=
a.title,f.title=f.innerHTML,g.innerHTML=a.type+" by "+a.owner,g.title=g.innerHTML,d=new Date,d.setTime(a.modified),h.innerHTML=d.toLocaleString(),h.title=h.innerHTML,k.innerHTML=this.nls.moreDetails,k.href=a.detailsPageUrl||"#");return c},_onItemsTableClicked:function(a){var c=a.target||a.srcElement;a=null;e.hasClass(c,"item-thumbnail")?a=c.parentNode:e.hasClass(c,"none-thumbnail-tip")&&(a=c.parentNode.parentNode);a&&(c=e.hasClass(a,"jimu-state-active"),b(".item.jimu-state-active",this.domNode).removeClass("jimu-state-active"),
c?e.removeClass(a,"jimu-state-active"):e.addClass(a,"jimu-state-active"),this.emit("item-dom-clicked",a))},getSelectedItem:function(){var a=null,c=b(".item.jimu-state-active",this.domNode);0<c.length&&(a=p.mixin({},c[0].item));return a}})})},"jimu/dijit/LoadingIndicator":function(){define(["dojo/_base/declare","dijit/_WidgetBase","dojo/dom-style","dojo/dom-construct"],function(r,l,d,q){return r(l,{baseClass:"jimu-loading-indicator",declaredClass:"jimu.dijit.LoadingIndicator",hidden:!1,postCreate:function(){this.inherited(arguments);
(this.hidden=!0===this.hidden)&&d.set(this.domNode,{display:"none"});d.set(this.domNode,{width:"100%",height:"100%"});q.place('\x3cdiv class\x3d"jimu-loading"\x3e\x3c/div\x3e',this.domNode)},show:function(){this.domNode&&d.set(this.domNode,"display","block")},hide:function(){this.domNode&&d.set(this.domNode,"display","none")}})})},"builder/dijit/FullScreenPopup":function(){define("dojo/_base/lang dojo/_base/declare dojo/_base/html dojo/dom-class dojo/dom-construct dojo/dom-style dojo/dom-attr dijit/_WidgetBase dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dojo/text!./templates/FullScreenPopup.html dojo/on dojo/throttle".split(" "),
function(r,l,d,q,k,m,p,h,e,c,b,a,g){return l([h,e,c],{templateString:b,baseClass:"fullscreen-popup-container",isShow:!1,position:{},_zIndexIncrease:0,_btns:[],postCreate:function(){this.inherited(arguments);this._btns=[];this.outerMainPage=this.blurContainer?this.blurContainer:null;this._zIndexIncrease=this.zIndex?this.zIndex:1;m.set(this.domNode,"z-index",this._zIndexIncrease++);m.set(this.background,"display","block");m.set(this.background,"z-index",this._zIndexIncrease++);m.set(this.main,"z-index",
this._zIndexIncrease++);m.set(this.fullscreenPopupBtns,"z-index",this._zIndexIncrease++);if(this.buttons)for(var b=0,c=this.buttons.length;b<c;b++){var e=this.buttons[b],f=d.create("input",{"class":"btn",type:"button",value:e.label},this.fullscreenPopupBtns);e.isHighLight&&q.add(f,"light");e.onClick&&this.own(a(f,"click",e.onClick));this._btns.push(f)}this.contentAutoHeight&&q.add(this.main,"autoHeight");this.own(a(window,"resize",g(r.hitch(this,this.resize)),50));this.own(a(this.fullscreenPopupContent,
"DOMNodeInserted,DOMNodeRemoved",g(r.hitch(this,this.resize)),100))},startup:function(){this.hide();this.refresh()},destroy:function(){this.subDijit&&(this.subDijit.destroy(),this.subDijit=null);this._btns=[];d.destroy(this.domNode);this.inherited(arguments)},refresh:function(){this.fullscreenPopupTitle.innerHTML=this.titleStr;k.place(this.content,this.fullscreenPopupContent);this.resize()},show:function(){d.setStyle(this.domNode,"display","block");this.isShow=!0;this.refresh()},hide:function(){d.setStyle(this.domNode,
"display","none");q.remove(this.outerMainPage,"glass-blur");this.isShow=!1;this.destroy()},enableButton:function(a){a=this._btns[a];p.remove(a,"disabled");return a},disableButton:function(a){a=this._btns[a];p.set(a,{disabled:"disabled"});return a},close:function(){this._onCloseClick()},setTitle:function(a){a&&(this.fullscreenPopupTitle.innerHTML=a)},setSubTitle:function(a){},resize:function(){this.btnsAtuoBottom&&this._setBtnsAutoBottom();this.contentAutoHeight&&this._setContentAutoHeight()},_onContainerClick:function(a){a.stopPropagation();
return!1},_onCloseClick:function(){this.hide()},_ieBlurPolyfill:function(){},_setBtnsAutoBottom:function(){var a=this.head;this._footerMarginTop||(this._footerMarginTop=m.get(this.fullscreenPopupBtns,"margin-top"));this._footerPaddingTopHeight||(this._footerPaddingTopHeight=m.get(this.fullscreenPopupBtnsContainer,"padding-top"));this._footerPaddingBottomHeight||(this._footerPaddingBottomHeight=m.get(this.fullscreenPopupBtnsContainer,"padding-bottom"));this._footerHeight||(this._footerHeight=m.get(this.fullscreenPopupBtns,
"height"));document.body.clientHeight-a.clientHeight-(this._footerMarginTop+this._footerHeight+this._footerPaddingTopHeight+this._footerPaddingBottomHeight)<this.fullscreenPopupContent.scrollHeight?(m.set(this.contentScroller,"height",document.body.clientHeight-a.clientHeight-this._footerMarginTop-this._footerPaddingTopHeight-this._footerPaddingBottomHeight+"px"),m.set(this.fullscreenPopupBtns,"margin-top","0")):(m.set(this.contentScroller,"height",this.fullscreenPopupContent.scrollHeight+"px"),m.set(this.fullscreenPopupBtns,
"margin-top",this._footerMarginTop+"px"))},_setContentAutoHeight:function(){q.add(this.main,"autoHeight");var a=this.head.scrollHeight,b=this.fullscreenPopupBtnsContainer.scrollHeight,c=m.get(this.fullscreenPopupBtns,"margin-top");m.set(this.contentScroller,"height",document.body.clientHeight-a-b-c+"px")}})})},"dojo/throttle":function(){define([],function(){return function(r,l){var d=!0;return function(){d&&(d=!1,r.apply(this,arguments),setTimeout(function(){d=!0},l))}}})},"dojox/form/Uploader":function(){define("dojo/_base/kernel dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/connect dojo/_base/window dojo/dom-style dojo/dom-class dojo/dom-geometry dojo/dom-attr dojo/dom-construct dojo/dom-form dijit dijit/form/Button ./uploader/_Base ./uploader/_HTML5 ./uploader/_IFrame ./uploader/_Flash dojo/i18n!./nls/Uploader dojo/text!./resources/Uploader.html".split(" "),
function(r,l,d,q,k,m,p,h,e,c,b,a,g,u,n,t,f,v,x,w){return l("dojox.form.Uploader",[n,u,t,f,v],{uploadOnSelect:!1,tabIndex:0,multiple:!1,label:x.label,url:"",name:"uploadedfile",flashFieldName:"",force:"",uploadType:"",showInput:"",focusedClass:"dijitButtonHover",_nameIndex:0,templateString:w,baseClass:"dijitUploader "+u.prototype.baseClass,postMixInProperties:function(){this._inputs=[];this._cons=[];this.force=this.force.toLowerCase();this.supports("multiple")?this.uploadType="form"===this.force?"form":
"html5":this.uploadType="flash"===this.force?"flash":"iframe";this.inherited(arguments)},buildRendering:function(){this.inherited(arguments);p.set(this.domNode,{overflow:"hidden",position:"relative"});this._buildDisplay();c.set(this.titleNode,"tabIndex",-1)},_buildDisplay:function(){this.showInput&&(this.displayInput=b.create("input",{"class":"dijitUploadDisplayInput",tabIndex:-1,autocomplete:"off",role:"presentation"},this.containerNode,this.showInput),this._attachPoints.push("displayInput"),this.connect(this,
"onChange",function(a){for(var b=0,c,d=[];c=a[b++];)c&&c.name&&d.push(c.name);this.displayInput.value=d.join(", ")}),this.connect(this,"reset",function(){this.displayInput.value=""}))},startup:function(){this._buildInitialized||(this._buildInitialized=!0,this._getButtonStyle(this.domNode),this._setButtonStyle(),this.inherited(arguments))},onChange:function(a){},onBegin:function(a){},onProgress:function(a){},onComplete:function(a){this.reset()},onCancel:function(){},onAbort:function(){},onError:function(a){},
upload:function(a){a=a||{};a.uploadType=this.uploadType;this.inherited(arguments)},submit:function(b){b=b?b.tagName?b:this.getForm():this.getForm();b=a.toObject(b);b.uploadType=this.uploadType;this.upload(b)},reset:function(){delete this._files;this._disconnectButton();q.forEach(this._inputs,b.destroy);this._inputs=[];this._nameIndex=0;this._createInput()},getFileList:function(){var a=[];this.supports("multiple")?q.forEach(this._files,function(b,c){a.push({index:c,name:b.name,size:b.size,type:b.type})},
this):q.forEach(this._inputs,function(b,c){b.value&&a.push({index:c,name:b.value.substring(b.value.lastIndexOf("\\")+1),size:0,type:b.value.substring(b.value.lastIndexOf(".")+1)})},this);return a},_getValueAttr:function(){return this.getFileList()},_setValueAttr:function(a){console.error("Uploader value is read only")},_setDisabledAttr:function(a){this.disabled!=a&&this.inputNode&&(this.inherited(arguments),p.set(this.inputNode,"display",a?"none":""))},_getButtonStyle:function(a){this.btnSize={w:p.get(a,
"width"),h:p.get(a,"height")}},_setButtonStyle:function(){this.inputNodeFontSize=Math.max(2,Math.max(Math.ceil(this.btnSize.w/60),Math.ceil(this.btnSize.h/15)));this._createInput()},_getFileFieldName:function(){return this.supports("multiple")&&this.multiple?this.name+"s[]":this.name+(this.multiple?this._nameIndex:"")},_createInput:function(){this._inputs.length&&(p.set(this.inputNode,{top:"500px"}),this._disconnectButton(),this._nameIndex++);var a=this._getFileFieldName();this.focusNode=this.inputNode=
b.create("input",{type:"file",name:a,"aria-labelledby":this.id+"_label"},this.domNode,"first");this.supports("multiple")&&this.multiple&&c.set(this.inputNode,"multiple",!0);this._inputs.push(this.inputNode);p.set(this.inputNode,{position:"absolute",fontSize:this.inputNodeFontSize+"em",top:"-3px",right:"-3px",opacity:0});this._connectButton()},_connectButton:function(){this._cons.push(k.connect(this.inputNode,"change",this,function(a){this._files=this.inputNode.files;this.onChange(this.getFileList(a));
!this.supports("multiple")&&this.multiple&&this._createInput()}));-1<this.tabIndex&&(this.inputNode.tabIndex=this.tabIndex,this._cons.push(k.connect(this.inputNode,"focus",this,function(){h.add(this.domNode,this.focusedClass)})),this._cons.push(k.connect(this.inputNode,"blur",this,function(){h.remove(this.domNode,this.focusedClass)})))},_disconnectButton:function(){q.forEach(this._cons,k.disconnect);this._cons.splice(0,this._cons.length)}})})},"dojox/form/uploader/_Base":function(){define("dojo/dom-form dojo/dom-style dojo/dom-construct dojo/dom-attr dojo/has dojo/_base/declare dojo/_base/event dijit/_Widget dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin".split(" "),
function(r,l,d,q,k,m,p,h,e,c){k.add("FormData",function(){return!!window.FormData});k.add("xhr-sendAsBinary",function(){var b=window.XMLHttpRequest&&new window.XMLHttpRequest;return b&&!!b.sendAsBinary});k.add("file-multiple",function(){return!!{"true":1,"false":1}[q.get(document.createElement("input",{type:"file"}),"multiple")]});return m("dojox.form.uploader._Base",[h,e,c],{getForm:function(){if(!this.form)for(var b=this.domNode;b&&b.tagName&&b!==document.body;){if("form"==b.tagName.toLowerCase()){this.form=
b;break}b=b.parentNode}return this.form},getUrl:function(){this.uploadUrl&&(this.url=this.uploadUrl);if(this.url)return this.url;this.getForm()&&(this.url=this.form.action);return this.url},connectForm:function(){this.url=this.getUrl();!this._fcon&&this.getForm()&&(this._fcon=!0,this.connect(this.form,"onsubmit",function(b){console.log("SUBMIT");p.stop(b);this.submit(this.form)}))},supports:function(b){switch(b){case "multiple":if("flash"==this.force||"iframe"==this.force)break;return k("file-multiple");
case "FormData":return k(b);case "sendAsBinary":return k("xhr-sendAsBinary")}return!1},getMimeType:function(){return"application/octet-stream"},getFileType:function(b){return b.substring(b.lastIndexOf(".")+1).toUpperCase()},convertBytes:function(b){var a=Math.round(b/1024*1E5)/1E5,c=Math.round(b/1048576*1E5)/1E5,d=Math.round(b/1073741824*1E5)/1E5,e=b;1<a&&(e=a.toFixed(1)+" kb");1<c&&(e=c.toFixed(1)+" mb");1<d&&(e=d.toFixed(1)+" gb");return{kb:a,mb:c,gb:d,bytes:b,value:e}}})})},"dojox/form/uploader/_HTML5":function(){define(["dojo/_base/declare",
"dojo/_base/lang","dojo/_base/array","dojo"],function(r,l,d,q){return r("dojox.form.uploader._HTML5",[],{errMsg:"Error uploading files. Try checking permissions",uploadType:"html5",postMixInProperties:function(){this.inherited(arguments)},postCreate:function(){this.connectForm();this.inherited(arguments);this.uploadOnSelect&&this.connect(this,"onChange",function(d){this.upload(d[0])})},_drop:function(d){q.stopEvent(d);this._files=d.dataTransfer.files;this.onChange(this.getFileList())},upload:function(d){this.onBegin(this.getFileList());
this.uploadWithFormData(d)},addDropTarget:function(d,l){l||(this.connect(d,"dragenter",q.stopEvent),this.connect(d,"dragover",q.stopEvent),this.connect(d,"dragleave",q.stopEvent));this.connect(d,"drop","_drop")},uploadWithFormData:function(k){if(this.getUrl()){var l=new FormData,p=this._getFileFieldName();d.forEach(this._files,function(d,c){l.append(p,d)},this);if(k){k.uploadType=this.uploadType;for(var h in k)l.append(h,k[h])}this.createXhr().send(l)}else console.error("No upload url found.",this)},
_xhrProgress:function(d){if(d.lengthComputable){var k={bytesLoaded:d.loaded,bytesTotal:d.total,type:d.type,timeStamp:d.timeStamp};"load"==d.type?(k.percent="100%",k.decimal=1):(k.decimal=d.loaded/d.total,k.percent=Math.ceil(d.loaded/d.total*100)+"%");this.onProgress(k)}},createXhr:function(){var d=new XMLHttpRequest,m;d.upload.addEventListener("progress",l.hitch(this,"_xhrProgress"),!1);d.addEventListener("load",l.hitch(this,"_xhrProgress"),!1);d.addEventListener("error",l.hitch(this,function(d){this.onError(d);
clearInterval(m)}),!1);d.addEventListener("abort",l.hitch(this,function(d){this.onAbort(d);clearInterval(m)}),!1);d.onreadystatechange=l.hitch(this,function(){if(4===d.readyState){clearInterval(m);try{this.onComplete(JSON.parse(d.responseText.replace(/^\{\}&&/,"")))}catch(p){console.error("Error parsing server result:",p),console.error(d.responseText),this.onError("Error parsing server result:",p)}}});d.open("POST",this.getUrl());d.setRequestHeader("Accept","application/json");m=setInterval(l.hitch(this,
function(){}),250);return d}})})},"dojox/form/uploader/_IFrame":function(){define("dojo/query dojo/dom-construct dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/dom-form dojo/request/iframe".split(" "),function(r,l,d,q,k,m,p){return d("dojox.form.uploader._IFrame",[],{postMixInProperties:function(){this.inherited(arguments);"iframe"===this.uploadType&&(this.uploadType="iframe",this.upload=this.uploadIFrame)},uploadIFrame:function(d){var e={},c;this.getForm();var b=this.getUrl(),a=this;d=
d||{};d.uploadType=this.uploadType;c=l.place('\x3cform enctype\x3d"multipart/form-data" method\x3d"post"\x3e\x3c/form\x3e',this.domNode);k.forEach(this._inputs,function(a,b){""!==a.value&&(c.appendChild(a),e[a.name]=a.value)},this);if(d)for(nm in d)void 0===e[nm]&&l.create("input",{name:nm,value:d[nm],type:"hidden"},c);p.post(b,{form:c,handleAs:"json",content:d}).then(function(b){l.destroy(c);if(b.ERROR||b.error)a.onError(b);else a.onComplete(b)},function(b){console.error("error parsing server result",
b);l.destroy(c);a.onError(b)})}})})},"dojox/form/uploader/_Flash":function(){define("dojo/dom-form dojo/dom-style dojo/dom-construct dojo/dom-attr dojo/_base/declare dojo/_base/config dojo/_base/connect dojo/_base/lang dojo/_base/array dojox/embed/Flash".split(" "),function(r,l,d,q,k,m,p,h,e,c){return k("dojox.form.uploader._Flash",[],{swfPath:m.uploaderPath||require.toUrl("dojox/form/resources/uploader.swf"),preventCache:!0,skipServerCheck:!0,serverTimeout:2E3,isDebug:!1,devMode:!1,deferredUploading:0,
postMixInProperties:function(){"flash"===this.uploadType&&(this._files=[],this._fileMap={},this._createInput=this._createFlashUploader,this.getFileList=this.getFlashFileList,this.reset=this.flashReset,this.upload=this.uploadFlash,this.fieldname="flashUploadFiles");this.inherited(arguments)},onReady:function(b){},onLoad:function(b){},onFileChange:function(b){},onFileProgress:function(b){},getFlashFileList:function(){return this._files},flashReset:function(){this.flashMovie.reset();this._files=[];this._fileMap=
{}},uploadFlash:function(b){this.onBegin(this.getFileList());b=b||{};b.returnType="F";b.uploadType=this.uploadType;console.log("flas upload",b);this.flashMovie.doUpload(b)},_change:function(b){this._files=this._files.concat(b);e.forEach(b,function(a){a.bytesLoaded=0;a.bytesTotal=a.size;this._fileMap[a.name+"_"+a.size]=a},this);this.onChange(this._files);this.onFileChange(b)},_complete:function(b){this._getCustomEvent().type="load";this.onComplete(b)},_progress:function(b){this._fileMap[b.name+"_"+
b.bytesTotal].bytesLoaded=b.bytesLoaded;var a=this._getCustomEvent();this.onFileProgress(b);this.onProgress(a)},_error:function(b){this.onError(b)},_onFlashBlur:function(b){},_getCustomEvent:function(){var b={bytesLoaded:0,bytesTotal:0,type:"progress",timeStamp:(new Date).getTime()},a;for(a in this._fileMap)b.bytesTotal+=this._fileMap[a].bytesTotal,b.bytesLoaded+=this._fileMap[a].bytesLoaded;b.decimal=b.bytesLoaded/b.bytesTotal;b.percent=Math.ceil(b.bytesLoaded/b.bytesTotal*100)+"%";return b},_connectFlash:function(){this._subs=
[];this._cons=[];var b=h.hitch(this,function(a,b){this._subs.push(p.subscribe(this.id+a,this,b))});b("/filesSelected","_change");b("/filesUploaded","_complete");b("/filesProgress","_progress");b("/filesError","_error");b("/filesCanceled","onCancel");b("/stageBlur","_onFlashBlur");this.connect(this.domNode,"focus",function(){this.flashMovie.focus();this.flashMovie.doFocus()});0<=this.tabIndex&&q.set(this.domNode,"tabIndex",this.tabIndex)},_createFlashUploader:function(){var b=this.btnSize.w,a=this.btnSize.h;
if(b){var e=this.getUrl();if(e){if(0>e.toLowerCase().indexOf("http")&&0!=e.indexOf("/")){var k=window.location.href.split("/");k.pop();k=k.join("/")+"/";e=k+e}}else console.warn("Warning: no uploadUrl provided.");this.inputNode=d.create("div",{className:"dojoxFlashNode"},this.domNode,"first");l.set(this.inputNode,{position:"absolute",top:"-2px",width:b+"px",height:a+"px",opacity:0});b={expressInstall:!0,path:(this.swfPath.uri||this.swfPath)+(this.preventCache?"?cb_"+(new Date).getTime():""),width:b,
height:a,allowScriptAccess:"always",allowNetworking:"all",vars:{uploadDataFieldName:this.flashFieldName||this.name+"Flash",uploadUrl:e,uploadOnSelect:this.uploadOnSelect,deferredUploading:this.deferredUploading||0,selectMultipleFiles:this.multiple,id:this.id,isDebug:this.isDebug,noReturnCheck:this.skipServerCheck,serverTimeout:this.serverTimeout},params:{scale:"noscale",wmode:"opaque",allowScriptAccess:"always",allowNetworking:"all"}};this.flashObject=new c(b,this.inputNode);this.flashObject.onError=
h.hitch(function(a){console.error("Flash Error: "+a)});this.flashObject.onReady=h.hitch(this,function(){this.onReady(this)});this.flashObject.onLoad=h.hitch(this,function(a){this.flashMovie=a;this.flashReady=!0;this.onLoad(this)});this._connectFlash()}else setTimeout(dojo.hitch(this,function(){this._getButtonStyle(this.domNode);this._createFlashUploader()}),200)}})})},"dojox/embed/Flash":function(){define("dojo/_base/lang dojo/_base/unload dojo/_base/array dojo/query dojo/has dojo/dom dojo/on dojo/window dojo/string".split(" "),
function(r,l,d,q,k,m,p,h,e){function c(a){a=r.delegate(u,a);if(!("path"in a))return console.error("dojox.embed.Flash(ctor):: no path reference to a Flash movie was provided."),null;"id"in a||(a.id="dojox-embed-flash-"+g++);return a}var b,a,g=0,u={expressInstall:!1,width:320,height:240,swLiveConnect:"true",allowScriptAccess:"sameDomain",allowNetworking:"all",style:null,redirect:null};k("ie")?(b=function(a){a=c(a);if(!a)return null;var b,d=a.path;if(a.vars){var g=[];for(b in a.vars)g.push(encodeURIComponent(b)+
"\x3d"+encodeURIComponent(a.vars[b]));a.params.FlashVars=g.join("\x26");delete a.vars}d='\x3cobject id\x3d"'+e.escape(String(a.id))+'" classid\x3d"clsid:D27CDB6E-AE6D-11cf-96B8-444553540000" width\x3d"'+e.escape(String(a.width))+'" height\x3d"'+e.escape(String(a.height))+'"'+(a.style?' style\x3d"'+e.escape(String(a.style))+'"':"")+'\x3e\x3cparam name\x3d"movie" value\x3d"'+e.escape(String(d))+'" /\x3e';if(a.params)for(b in a.params)d+='\x3cparam name\x3d"'+e.escape(b)+'" value\x3d"'+e.escape(String(a.params[b]))+
'" /\x3e';return{id:a.id,markup:d+"\x3c/object\x3e"}},a=function(){for(var a=10,b=null;!b&&7<a;)try{b=new ActiveXObject("ShockwaveFlash.ShockwaveFlash."+a--)}catch(v){}return b?(a=b.GetVariable("$version").split(" ")[1].split(","),{major:null!=a[0]?parseInt(a[0]):0,minor:null!=a[1]?parseInt(a[1]):0,rev:null!=a[2]?parseInt(a[2]):0}):{major:0,minor:0,rev:0}}(),l.addOnWindowUnload(function(){console.warn("***************UNLOAD");var a=function(){};q("object").reverse().style("display","none").forEach(function(b){for(var c in b)if("FlashVars"!=
c&&"function"==typeof b[c])try{b[c]=a}catch(x){}})})):(b=function(a){a=c(a);if(!a)return null;var b,d=a.path;if(a.vars){var g=[];for(b in a.vars)g.push(encodeURIComponent(b)+"\x3d"+encodeURIComponent(a.vars[b]));a.params.flashVars=g.join("\x26");delete a.vars}d='\x3cembed type\x3d"application/x-shockwave-flash" src\x3d"'+e.escape(String(d))+'" id\x3d"'+e.escape(String(a.id))+'" width\x3d"'+e.escape(String(a.width))+'" height\x3d"'+e.escape(String(a.height))+'"'+(a.style?' style\x3d"'+e.escape(String(a.style))+
'" ':"")+'pluginspage\x3d"'+window.location.protocol+'//www.adobe.com/go/getflashplayer" ';if(a.params)for(b in a.params)d+=" "+e.escape(b)+'\x3d"'+e.escape(String(a.params[b]))+'"';return{id:a.id,markup:d+" /\x3e"}},a=function(){var a=navigator.plugins["Shockwave Flash"];return a&&a.description?(a=a.description.replace(/([a-zA-Z]|\s)+/,"").replace(/(\s+r|\s+b[0-9]+)/,".").split("."),{major:null!=a[0]?parseInt(a[0]):0,minor:null!=a[1]?parseInt(a[1]):0,rev:null!=a[2]?parseInt(a[2]):0}):{major:0,minor:0,
rev:0}}());var n=function(b,c){if(-1<location.href.toLowerCase().indexOf("file://"))throw Error("dojox.embed.Flash can't be run directly from a file. To instatiate the required SWF correctly it must be run from a server, like localHost.");this.available=a.major;this.minimumVersion=b.minimumVersion||9;this.domNode=this.movie=this.id=null;c&&(c=m.byId(c));setTimeout(r.hitch(this,function(){if(b.expressInstall||this.available&&this.available>=this.minimumVersion)if(b&&c)this.init(b,c);else this.onError("embed.Flash was not provided with the proper arguments.");
else if(this.available)this.onError("Flash version detected: "+this.available+" is out of date. Minimum required: "+this.minimumVersion);else this.onError("Flash is not installed.")}),100)};r.extend(n,{onReady:function(a){},onLoad:function(a){},onError:function(a){},_onload:function(){clearInterval(this._poller);delete this._poller;delete this._pollCount;delete this._pollMax;this.onLoad(this.movie)},init:function(a,b){this.destroy();b=m.byId(b||this.domNode);if(!b)throw Error("dojox.embed.Flash: no domNode reference has been passed.");
var c=0;this._poller=null;this._pollCount=0;this._pollMax=15;this.pollTime=100;n.initialized&&(this.id=n.place(a,b),this.domNode=b,setTimeout(r.hitch(this,function(){this.movie=this.byId(this.id,a.doc);this.onReady(this.movie);this._poller=setInterval(r.hitch(this,function(){try{c=this.movie.PercentLoaded()}catch(x){console.warn("this.movie.PercentLoaded() failed",x,this.movie)}if(100==c)this._onload();else if(0==c&&this._pollCount++>this._pollMax)throw clearInterval(this._poller),Error("Building SWF failed.");
}),this.pollTime)}),1))},_destroy:function(){try{this.domNode.removeChild(this.movie)}catch(t){}this.id=this.movie=this.domNode=null},destroy:function(){if(this.movie){var a=r.delegate({id:!0,movie:!0,domNode:!0,onReady:!0,onLoad:!0}),b;for(b in this)a[b]||delete this[b];this._poller?p(this,"Load",this,"_destroy"):this._destroy()}},byId:function(a,b){b=b||document;return b.embeds[a]?b.embeds[a]:b[a]?b[a]:window[a]?window[a]:document[a]?document[a]:null}});r.mixin(n,{minSupported:8,available:a.major,
supported:a.major>=a.required,minimumRequired:a.required,version:a,initialized:!1,onInitialize:function(){n.initialized=!0},__ie_markup__:function(a){return b(a)},proxy:function(a,b){d.forEach(b instanceof Array?b:[b],function(a){this[a]=r.hitch(this,function(){return function(){return eval(this.movie.CallFunction('\x3cinvoke name\x3d"'+a+'" returntype\x3d"javascript"\x3e\x3carguments\x3e'+d.map(arguments,function(a){return __flash__toXML(a)}).join("")+"\x3c/arguments\x3e\x3c/invoke\x3e"))}.apply(this,
arguments||[])})},a)}});n.place=function(a,c){var d=b(a);c=m.byId(c);c||(c=h.doc.createElement("div"),c.id=d.id+"-container",h.body().appendChild(c));return d?(c.innerHTML=d.markup,d.id):null};n.onInitialize();r.setObject("dojox.embed.Flash",n);return n})},"builder/plugins/app-list/AppCatalogPage":function(){define("dojo/_base/declare dojo/_base/html dojo/dom-style dojo/dom dojo/_base/array dojo/on dojo/_base/lang dojo/query dojo/dom-attr dojo/topic dijit/_WidgetBase dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dojo/text!./AppCatalogPage.html ./AppOperMenu".split(" "),
function(r,l,d,q,k,m,p,h,e,c,b,a,g,u,n){return r([b,a,g],{baseClass:"app-catalog-page",templateString:u,_defaultStyleColor:"#31aacd",loading:null,folderUrl:null,appListWidget:null,_eventHandles:null,_appOperMenus:null,postMixInProperties:function(){this.inherited(arguments);this.nls=this.appListWidget.nls;this.loading=this.appListWidget.loading;this.folderUrl=this.appListWidget.folderUrl},constructor:function(){this._appOperMenus=[];this._eventHandles=[]},startup:function(){this.inherited(arguments)},
refresh:function(a,b){this.createAppList(a,b);l.setSelectable(this.appContent,!1)},createAppList:function(a){var b;this.cleanAppList();l.setStyle(this.listSectionBodyContent,"display","block");if(0<a.length)for(b=0;b<a.length;b++)this.createAppNode(a[b],b);else this.appListWidget._addEmptyDescription(this.listTableBody)},cleanAppList:function(){l.empty(this.listTableBody);k.forEach(this._appOperMenus,function(a){a.destroy()});this._appOperMenus=[];k.forEach(this._eventHandles,function(a){a.remove()});
this._eventHandles=[]},createAppNode:function(a,b){return this._createItem(a,b)},_createItem:function(a,b){var e=l.create("tr",{"class":"app-catalogs list-table-item"+(b%2?" list-table-item-add ":" "),"data-app-id":a.id,"data-app-name":a.name},this.listTableBody),f=l.create("td",{"class":"item-td"},e),f=l.create("div",{"class":"catalog"},f),g=l.create("div",{"class":"content-theme jimu-float-leading"},f),h=l.create("div",{"class":"content-theme-icon "+(a._defaultIconClass?a._defaultIconClass:""),
title:this.nls.launch},g);a.thumbnail&&d.set(h,"backgroundImage","url("+a.thumbnail+"?date\x3d"+this.appListWidget.getRefreshImageFlag()+")");l.create("div",{"class":"content-theme-flagImg content-theme-flagImg-"+this._getType(a.appType)},h);var h=l.create("div",{"class":"content-opers jimu-float-trailing"},f),k=l.create("div",{"class":"content-opers-btns"},h),h=l.create("div",{"class":"content-opers-btn content-opers-btns-edit",title:this.nls.configApp},k),t=l.create("div",{"class":"content-opers-btn content-opers-btns-launch",
title:this.nls.launch},k),u=l.create("div",{"class":"content-opers-btn content-opers-btns-download",title:this.nls.download},k),k=l.create("div",{"class":"content-opers-btn content-opers-btns-more","data-appid":a.id},k),r=(new n({app:a,posNode:k,appListWidget:this.appListWidget,nls:this.nls,isTemplate:!1,appContentNode:this.appContent,height:122,offset:{top:42,left:-16,right:-16}})).placeAt(k);this._appOperMenus.push(r);this._eventHandles.push(m(g,"click",p.hitch(this,this._onAppLaunchClick,a)));
this._eventHandles.push(m(u,"click",p.hitch(this,this._onAppDownloadClick,a)));this._eventHandles.push(m(h,"click",p.hitch(this,this._onAppEditClick,a)));this._eventHandles.push(m(t,"click",p.hitch(this,this._onAppLaunchClick,a)));this._eventHandles.push(m(k,"click",p.hitch(this,this._onAppMoreClick,a,r,k)));f=l.create("div",{"class":"catalog-content"},f);g=l.create("div",{"class":"catalog-content-head"},f);l.create("p",{"class":"catalog-content-appname long-text-ellipsis",innerHTML:a.name,title:a.name},
g);g=l.create("p",{"class":"catalog-content-appinfo long-text-ellipsis jimu-float-trailing"},g);l.create("span",{"class":"catalog-content-appinfo-time jimu-float-leading",innerHTML:this.appListWidget._getLocaleDateTime(a.lastUpdated)},g);l.create("span",{"class":"catalog-content-appinfo-owner jimu-float-leading",innerHTML:"\x3cp class\x3d'catalog-content-appinfo-owner-name long-text-ellipsis'title\x3d'"+a.creator+"'\x3e"+a.creator+"\x3c/p\x3e"},g);l.create("p",{"class":"catalog-content-dis "+(a.description?
"":"place-holder-class"),innerHTML:a.description?a.description:this.nls.defaultDesc,title:a.description},f);this._eventHandles.push(m(q.byId("content-box"),"click",p.hitch(this,this.resetStatus)));this._eventHandles.push(m(this.ownerDocument,"click",p.hitch(this,this.resetStatus)));this._eventHandles.push(c.subscribe("menuAll/hide",p.hitch(this,this.resetStatus)));return e},_getType:function(a){var b="";switch(a){case "HTML":b="2D";break;case "HTML3D":b="3D";break;default:console.error("AppCatalogPage Error _getType")}return b},
resetStatus:function(a){this._hideAllAppOperMenus(a);this._hideBtnsSelect(a)},_hideAllAppOperMenus:function(a){k.forEach(this._appOperMenus,function(b){!b.isShow||"undefined"!==typeof a&&"undefined"!==typeof a.itemId&&a.itemId===b.app.id||b.hide()})},_hideBtnsSelect:function(a){for(var b=h(".content-opers-btns-more"),c=0,d=b.length;c<d;c++){var g=b[c];"undefined"!==typeof a&&"undefined"!==typeof a.itemId&&a.itemId===parseInt(e.get(g,"data-appid"),10)||l.removeClass(g,"content-opers-btns-more-selected")}},
_onAppDownloadClick:function(a){window.open(a.downloadUrl,"downloadTargetFrame")},_onAppEditClick:function(a){this.appListWidget.pluginManager.getPluginByName("startup").switchToAppConfig(a)},_onAppLaunchClick:function(a){window.open(a.appUrl,"_blank")},_onAppMoreClick:function(a,b,d,e){e&&(e.itemId=a.id);b.isShow?b.hide():(c.publish("menuAll/hide"),b.set("app",a),b.show(),l.addClass(d,"content-opers-btns-more-selected"))}})})},"builder/plugins/app-list/AppOperMenu":function(){define("dojo/_base/declare dojo/_base/html dijit/_WidgetBase dijit/_TemplatedMixin dojo/text!./AppOperMenu.html dojo/on dojo/query dojo/keys dojo/_base/lang jimu/dijit/Popup jimu/dijit/Message builder/serviceUtils jimu/dijit/QRCode builder/dijit/FullScreenPopup builder/dijit/EditItemInfo".split(" "),
function(r,l,d,q,k,m,p,h,e,c,b,a,g,u,n){return r([d,q],{templateString:k,baseClass:"app-oper-menu white-style",app:void 0,isShow:!1,position:{},itemDefaultColor:"#ffffff",appListWidget:void 0,loadingDiv:null,_loading:null,_downloadUrl:null,constructor:function(){this.height||(this.height=0);this.offset||(this.offset={top:0,left:0,right:0})},postCreate:function(){this.inherited(arguments);this._loading=this.appListWidget.loading;this._initMenu();this.hide();this._downloadUrl="/webappbuilder/rest/apps/"+
this.app.id+"/download";l.setAttr(this.downloadLinkNode,"href",this._downloadUrl);this.own(m(this.downloadLinkNode,"click",e.hitch(this,function(){this.hide()})));this.app.isTemplate&&l.setAttr(this.editAppInfo,"innerHTML",this.nls.editTemplateInfo)},refresh:function(){var a="",b="";if(this.appContentNode){var a=l.position(this.posNode),b=l.position(this.appContentNode),c=l.getStyle(this.appContentNode,"height");a.y+this.height+25>b.y+c?(b=this.offset.top,a="",l.setStyle(this.upTriangle,"display",
"none"),l.setStyle(this.downTriangle,"top",this.height-4+"px"),l.setStyle(this.downTriangle,"display","block")):(a=this.offset.top,b="")}l.setStyle(this.domNode,isRTL?{top:a+"px",bottom:b+"px",left:this.offset.left+"px"}:{top:a+"px",bottom:b+"px",right:this.offset.right+"px"})},_refreshAppOrTempaltePage:function(){this.appListWidget.resetRefreshImageFlag();this.app.isTemplate?this.appListWidget.refreshTemplatePage():this.appListWidget.refreshAppPage()},show:function(){this.refresh();l.setStyle(this.domNode,
"display","block");this.isShow=!0},hide:function(){l.setStyle(this.domNode,"display","none");this.isShow=!1},_initMenu:function(){this.isTemplate?(l.addClass(this.editAppInfo,"border-top-radius"),this._disableItem(this.createAppFromTemplate),this.app.isPredefined&&(this._disableItem(this.duplicate),this._disableItem(this.editAppInfo),this._disableItem(this.remove),this._disableItem(this.download),this._disableItem(this.duplicate))):(l.addClass(this.editAppInfo,"border-top-radius"),this._disableItem(this.createAppFromTemplate),
this._disableItem(this.download))},_disableItem:function(a){l.setStyle(a,"display","none")},_onMenuClick:function(a){a.stopPropagation()},_onRemoveClick:function(){var b,d;this.app.isTemplate?(b=this.nls.confirmDeleteTemplate,d=this.nls.deleteTemplateTitle):(b=this.nls.confirmDeleteApp,d=this.nls.deleteAppTitle);var g=new c({content:b,titleLabel:d,width:"425",autoHeight:!0,"class":"jimu-popup-in-home",buttons:[{label:this.nls.ok,onClick:e.hitch(this,function(){this._loading.show(this.nls.deleting);
g.close();a.removeApp(this.app.id).then(e.hitch(this,function(a){a.success?(console.log("Removed app successfully, id\x3d"+this.app.id),this._refreshAppOrTempaltePage()):console.error(this.nls.deleteFalse);this._loading.hide()}),function(){console.error(this.nls.deleteError);this._loading.hide()})})},{label:this.nls.cancel,classNames:["jimu-btn-vacation"],onClick:e.hitch(this,function(){g.close()})}]})},_onDuplicateClick:function(){this._loading.show(this.nls.duplicating);a.duplicateApp({name:this.app.name,
description:this.app.description,fromAppId:this.app.id,appType:this.app.appType,isTemplate:this.app.isTemplate,isPredefined:this.app.isPredefined}).then(e.hitch(this,function(a){this._loading.hide();a.success?(console.log("Duplicated app successfully, app id\x3d"+this.app.id),this._refreshAppOrTempaltePage()):console.error(this.nls.duplicateFalse)}),function(){console.error(this.nls.duplicateError);this._loading.hide()});this.hide()},_onEditClick:function(){this.itemInfoDijit=new n({itemInfo:this.app,
nls:this.nls});var a;a=this.app.isTemplate?this.nls.editTemplateInfo:this.nls.editAppInfo;var b=p("#main-page")[0];this._EditPopup=new u({zIndex:101,titleStr:a,blurContainer:b.firstElementChild,content:this.itemInfoDijit.domNode,subDijit:this.itemInfoDijit,buttons:[{label:this.nls.ok,isHighLight:!0,onClick:e.hitch(this,this._onEditOKClick)},{label:this.nls.cancel,isHighLight:!1,onClick:e.hitch(this,this._onEditCancelClick)}],btnsAtuoBottom:!0});this._EditPopup.placeAt(b);this._EditPopup.show();this.itemInfoDijit.focusItemByName("appName");
this.hide();this.posNode&&l.removeClass(this.posNode,"item-more-selected")},_onEditOKClick:function(){var a=e.clone(this.app),c=this.itemInfoDijit.getProperties();a.name=c.name;a.description=c.description;!0!==this.app.isTemplate&&c.icon&&(a.icon=c.icon);c.thumbnail&&(a.thumbnail=c.thumbnail);this.appListWidget.updateApp(a).then(e.hitch(this,function(a){!0===a.success?(this._refreshAppOrTempaltePage(),this._EditPopup.close()):(console.error(a.message),new b({message:this.nls.editAppFalse}))}),e.hitch(this,
function(a){console.error(a);new b({message:this.nls.editError})}))},_onEditCancelClick:function(){this._EditPopup&&this._EditPopup.close()},_onDownloadClick:function(){},_onAgolTemplateClick:function(){var a=this.appListWidget.pluginsMeta["popup-actions.popup-agoltemplate"];a&&this.appListWidget.pluginManager.loadPlugin(a).then(e.hitch(this,function(a){a.onClickBeforeConfigPage(this.app)}))},_onCreateAppFromTempalteClick:function(){var a=this.appListWidget.pluginManager.getExtensions("startup.creation-entry")[0],
a=this.appListWidget.pluginsMeta[a.pluginName];this._loading.show("");this.appListWidget.pluginManager.loadPlugin(a).then(e.hitch(this,function(a){a.popupNewCreateDlg("",this.app,700);this._loading.hide()}),e.hitch(this,function(){this._loading.hide()}))},_onQRCodeClick:function(){new c({content:new g({text:"http://"+window.location.host+path+"apps/"+this.app.id,width:128,height:128}),container:"main-page",titleLabel:"qrcode-nonls",width:300,autoHeight:!0,buttons:[{label:this.nls.cancel,key:h.ESCAPE}]})}})})},
"builder/dijit/EditItemInfo":function(){define("dojo/_base/declare dojo/_base/array dojo/_base/html dojo/Deferred dijit/_WidgetBase dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dijit/dijit dojo/text!./templates/EditItemInfo.html dojo/dom-style dojo/dom-class dojo/_base/lang dojo/on dojo/mouse dojo/query dojo/dom-attr dojo/promise/all builder/portalUtils jimu/portalUrlUtils jimu/utils ./Tags dijit/form/SimpleTextarea jimu/dijit/ImageChooser dojo/has dojo/sniff dijit/form/TextBox dijit/form/Select dijit/form/CheckBox".split(" "),
function(r,l,d,q,k,m,p,h,e,c,b,a,g,u,n,t,f,v,x,w,z,A,y,B){return r([k,m,p],{templateString:e,baseClass:"dijit-item-info",_isTemplate:"",postMixInProperties:function(){this.inherited(arguments);this.nls=a.mixin(this.nls,builderNls)},postCreate:function(){this.inherited(arguments);this._init(this.itemInfo);t.set(this.publishWebmapSummary,"placeholder",this.nls.summaryLabelPlaceHolder)},_init:function(c){var e="";this._isTemplate=!1===c.isTemplate?!1:!0;e="imageChooserTemplate";this.imageChooser=new y({cropImage:!0,
showSelfImg:!0,format:[y.GIF,y.JPEG,y.PNG],goldenWidth:300,goldenHeight:180,maxSize:2048});d.place(this.imageChooser.domNode,this.imageChooserBase);b.add(this.imageChooserContainer,e);b.add(this.imageChooserMasker,e);this.own(g(this.imageChooserContainer,u.enter,a.hitch(this,this._onImageChooserBaseMouseEnter)));this.own(g(this.imageChooserContainer,u.leave,a.hitch(this,this._onImageChooserBaseMouseLeave)));this.own(g(this.imageChooserMasker,"click",a.hitch(this,this._onEmitUploadPic)));this.setProperties(c)},
_onImageChooserBaseMouseEnter:function(a){c.set(this.imageChooserMasker,"display","block");a.stopPropagation();return!1},_onImageChooserBaseMouseLeave:function(a){c.set(this.imageChooserMasker,"display","none");a.stopPropagation();return!1},_onEmitUploadPic:function(){var a=n("form",this.imageChooserBase)[0],a=n("label",a)[0];3<B("ff")||B("chrome")?a.click():g.emit(a,"click",{bubbles:!0,cancelable:!0})},setProperties:function(a){h.byId("publish-webmap-name").set("value",a.name);h.byId("publish-webmap-summary").set("value",
a.description);if(this.imageChooser){var b="",b=a.thumbnail;"undefined"!==typeof b&&this.imageChooser.setDefaultSelfSrc(b)}},getProperties:function(){var a={name:w.stripHTML(h.byId("publish-webmap-name").get("value")),description:w.stripHTML(h.byId("publish-webmap-summary").get("value"))};!0!==this._isTemplate&&(a.icon=this.imageChooser&&this.imageChooser.imageData);a.thumbnail=this.imageChooser&&this.imageChooser.imageData;return a},focusItemByName:function(a){a&&this[a]?this[a].focus():console.log("Error name")}})})},
"builder/plugins/app-list/CardPageWithBigThumbnail":function(){define("dojo/_base/declare dojo/_base/html dojo/_base/array dojo/_base/lang dojo/on dojo/dom ./AppOperMenu dijit/_WidgetBase dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dojo/text!./CardPageWithBigThumbnail.html dojox/form/Uploader dojo/NodeList-dom".split(" "),function(r,l,d,q,k,m,p,h,e,c,b){return r([h,e,c],{baseClass:"card-page",templateString:b,loading:null,folderUrl:null,appListWidget:null,_eventHandles:null,_appOperMenus:null,
postMixInProperties:function(){this.inherited(arguments);this.nls=this.appListWidget.nls;this.loading=this.appListWidget.loading;this.folderUrl=this.appListWidget.folderUrl},constructor:function(){this._eventHandles=[];this._appOperMenus=[]},startup:function(){this.inherited(arguments);l.setSelectable(this.domNode,!1)},refresh:function(a){this.createItemList(a)},cleanItemList:function(){l.empty(this.cardPageContent);d.forEach(this._appOperMenus,function(a){a.destroy()});this._appOperMenus=[];d.forEach(this._eventHandles,
function(a){a.remove()});this._eventHandles=[]},createItemList:function(a){this.cleanItemList();0<a.length?d.forEach(a,function(a){this.createItemCard(a)},this):this.appListWidget._addEmptyDescription(this.cardPageContent,"card-page")},createItemCard:function(a){var b=a.isTemplate?this.nls.preview:this.nls.launch,c=l.create("div",{"class":"item-card jimu-float-leading"},this.cardPageContent),e=l.create("a",{"class":"thumbnail-part",style:"background-image: url("+a.thumbnail+"?date\x3d"+this.appListWidget.getRefreshImageFlag()+
")",href:a.appUrl,target:"_blank",title:b},c);l.create("div",{"class":"item-type-div "+("HTML"===a.appType?"item-type-2d":"item-type-3d")},e);e=l.create("div",{"class":"appInfo-part"},c);l.create("div",{"class":"item-name-div",innerHTML:a.name,title:a.name},e);var h=l.create("div",{"class":"item-info-div"},e);l.create("div",{"class":"app-time-div jimu-float-leading",innerHTML:this.appListWidget._getLocaleDateTime(a.lastUpdated)},h);l.create("div",{"class":"app-creator-div jimu-float-trailing",innerHTML:a.creator},
h);l.create("div",{"class":"item-des-div "+(a.description?"":"place-holder-class"),innerHTML:a.description?a.description:this.nls.defaultDesc,title:a.description},e);c=l.create("div",{"class":"item-operation-part"},c);l.create("div",{innerHTML:'\x3ca href\x3d"'+a.appUrl+'" target\x3d"_blank"\x3e\x3c/a\x3e',"class":"item-operation launch-operation jimu-float-leading",title:b},c);a.isTemplate||l.create("div",{innerHTML:'\x3ca href\x3d"'+a.downloadUrl+'" target\x3d"downloadTargetFrame"\x3e\x3c/a\x3e',
"class":"item-operation download-operation jimu-float-leading",title:this.nls.download},c);var b=l.create("div",{"class":"item-operation edit-operation jimu-float-leading "+(a.isPredefined?"disable":""),title:a.isTemplate?this.nls.configTemplate:this.nls.configApp},c),f=l.create("div",{"class":"item-operation more-operation jimu-float-trailing "+(a.isPredefined?"disable":"")},c),r=(new p({app:a,posNode:f,appListWidget:this.appListWidget,nls:this.nls,isTemplate:a.isTemplate,appContentNode:this.cardPageContent,
height:a.isTemplate?a.isPredefined?45:162:122,offset:{top:44,left:-10,right:-10}})).placeAt(f);this._appOperMenus.push(r);e=k(f,"click",q.hitch(this,function(b){r.isShow?(r.hide(),l.removeClass(f,"item-more-selected")):(d.forEach(this._appOperMenus,function(a){a.hide();l.removeClass(a.posNode,"item-more-selected")}),r.show(),l.addClass(f,"item-more-selected"));b.itemId=a.id}));this._eventHandles.push(e);e=k(b,"click",q.hitch(this,function(){this.appListWidget.pluginManager.getPluginByName("startup").switchToAppConfig(a)}));
this._eventHandles.push(e);a.isTemplate&&(b=l.create("div",{"class":"item-operation create-app-from-item-operation jimu-float-leading",title:this.nls.createApp},c),e=k(b,"click",q.hitch(this,function(){r._onCreateAppFromTempalteClick()})),this._eventHandles.push(e));e=k(m.byId("content-box"),"click",q.hitch(this,function(b){b.itemId!==a.id&&(r.hide(),l.removeClass(f,"item-more-selected"))}));this._eventHandles.push(e)}})})},"builder/plugins/app-list/CardPageWithSmallThumbnail":function(){define("dojo/_base/declare dojo/_base/html dojo/_base/array dojo/_base/lang dojo/on dojo/dom ./AppOperMenu dijit/_WidgetBase dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dojo/text!./CardPageWithSmallThumbnail.html dojox/form/Uploader dojo/NodeList-dom".split(" "),
function(r,l,d,q,k,m,p,h,e,c,b){return r([h,e,c],{baseClass:"card-page-with-small-thumbnail",templateString:b,loading:null,folderUrl:null,appListWidget:null,_eventHandles:null,_appOperMenus:null,postMixInProperties:function(){this.inherited(arguments);this.nls=this.appListWidget.nls;this.loading=this.appListWidget.loading;this.folderUrl=this.appListWidget.folderUrl},constructor:function(){this._eventHandles=[];this._appOperMenus=[]},startup:function(){this.inherited(arguments);l.setSelectable(this.domNode,
!1)},refresh:function(a){this.createAppList(a)},cleanAppList:function(){l.empty(this.appCardPageContent);d.forEach(this._appOperMenus,function(a){a.destroy()});this._appOperMenus=[];d.forEach(this._eventHandles,function(a){a.remove()});this._eventHandles=[]},createAppList:function(a){this.cleanAppList();d.forEach(a,function(a){this.createAppCard(a)},this)},createAppCard:function(a){var b=a.isTemplate?this.nls.preview:this.nls.launch,c=l.create("div",{"class":"app-card-box jimu-float-leading"},this.appCardPageContent),
c=l.create("div",{"class":"card app-info-card"},c),e=l.create("div",{"class":"app-title-part"},c);l.create("div",{"class":"app-type-div "+("HTML"===a.appType?"app-type-2d":"app-type-3d")},e);var e=l.create("table",{"class":"app-title-table"},e),e=l.create("tbody",{"class":"app-title-table-body"},e),e=l.create("tr",{"class":"app-title-table-tr"},e),h=l.create("td",{"class":"app-thumbnail-td"},e);l.create("a",{"class":"app-thumbnail",style:"background-image: url("+a.thumbnail+"?date\x3d"+this.appListWidget.getRefreshImageFlag()+
")",href:a.appUrl,target:"_blank",title:b},h);e=l.create("td",{"class":"app-title-td"},e);l.create("div",{"class":"app-title-div",innerHTML:a.name},e);l.create("div",{"class":"app-time-div",innerHTML:this.appListWidget._getLocaleDateTime(a.lastUpdated)},e);l.create("div",{"class":"app-creator-div",innerHTML:a.creator},e);e=l.create("div",{"class":"app-desc-box"},c);l.create("div",{"class":"app-desc-part "+(a.description?"":"place-holder-class"),innerHTML:a.description?a.description:this.nls.defaultDesc,
title:a.description},e);c=l.create("div",{"class":"app-operation-part"},c);l.create("div",{innerHTML:'\x3ca href\x3d"'+a.appUrl+'" target\x3d"_blank"\x3e\x3c/a\x3e',"class":"app-operation launch-operation jimu-float-leading",title:b},c);a.isTemplate||l.create("div",{innerHTML:'\x3ca href\x3d"'+a.downloadUrl+'" target\x3d"downloadTargetFrame"\x3e\x3c/a\x3e',"class":"app-operation download-operation jimu-float-leading",title:this.nls.download},c);var b=l.create("div",{"class":"app-operation edit-operation jimu-float-leading "+
(a.isPredefined?"disable":""),title:a.isTemplate?this.nls.configTemplate:this.nls.configApp},c),f=l.create("div",{"class":"app-operation more-operation jimu-float-trailing "+(a.isPredefined?"disable":"")},c),r=(new p({app:a,posNode:f,appListWidget:this.appListWidget,nls:this.nls,isTemplate:a.isTemplate,appContentNode:this.appCardPageContent,height:a.isTemplate?a.isPredefined?45:162:122,offset:{top:44,left:-10,right:-10}})).placeAt(f);this._appOperMenus.push(r);e=k(f,"click",q.hitch(this,function(b){r.isShow?
(r.hide(),l.removeClass(f,"item-more-selected")):(d.forEach(this._appOperMenus,function(a){a.isShow&&(a.hide(),l.removeClass(a.posNode,"item-more-selected"))}),r.show(),l.addClass(f,"item-more-selected"));b.itemId=a.id}));this._eventHandles.push(e);e=k(b,"click",q.hitch(this,function(){this.appListWidget.pluginManager.getPluginByName("startup").switchToAppConfig(a)}));this._eventHandles.push(e);a.isTemplate&&(b=l.create("div",{"class":"app-operation create-app-from-item-operation jimu-float-leading",
title:this.nls.createApp},c),e=k(b,"click",q.hitch(this,function(){r._onCreateAppFromTempalteClick()})),this._eventHandles.push(e));e=k(m.byId("content-box"),"click",q.hitch(this,function(b){b.itemId!==a.id&&(l.removeClass(r.posNode,"item-more-selected"),r.hide())}));this._eventHandles.push(e)}})})},"builder/plugins/attribute-config/_build-generate_module":function(){define(["builder/plugins/attribute-config/Plugin","dojo/text!builder/plugins/attribute-config/Plugin.html","dojo/text!builder/plugins/attribute-config/css/style.css",
"dojo/i18n!builder/plugins/attribute-config/nls/strings"],function(){})},"builder/plugins/attribute-config/Plugin":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/html dojo/_base/Color dojo/topic dojo/on dojo/query dojo/sniff dojo/Deferred dijit/_WidgetsInTemplateMixin dojo/text!./Plugin.html ./AttrbuteLogoChooser dojo/dom-style dojo/dom-construct dojo/_base/array builder/portalUtils builder/BasePlugin jimu/utils jimu/portalUrlUtils jimu/dijit/CheckBox jimu/dijit/ImageChooser jimu/dijit/Message jimu/dijit/LoadingIndicator esri/arcgis/AppProxyManager ./AppProxyUtil ./MapProxyItem ./UrlProxyItem builder/dijit/LinkEditor jimu/dijit/Popup dijit/Editor ./dataSource/AdditionalDataSources dojo/NodeList-dom dojo/NodeList-data jimu/dijit/ColorPicker dijit/form/Select dijit/_editor/plugins/FontChoice dijit/_editor/plugins/TextColor dijit/ToolbarSeparator jimu/dijit/EditorTextColor jimu/dijit/EditorBackgroundColor".split(" "),
function(r,l,d,q,k,m,p,h,e,c,b,a,g,u,n,t,f,v,x,w,z,A,y,B,C,E,D,F,G,J,N){return r([f,c],{templateString:b,appConfig:null,selectLinkNode:null,selectProxyRuleNode:null,initedLinks:!1,initedProxy:!1,_currentPortalUrl:null,showProxySetting:!1,showAlwaysUseProxy:!1,keepAppState:!0,titleNodeClickHandler:null,subtitleNodeClickHandler:null,postMixInProperties:function(){this.inherited(arguments)},postCreate:function(){this.inherited(arguments);this.own(k.subscribe("app/appConfigLoaded",l.hitch(this,this._onAppConfigLoaded)));
this.own(k.subscribe("app/appConfigChanged",l.hitch(this,this._onAppConfigChanged)));this.own(k.subscribe("app/mapLoaded",l.hitch(this,this._setMap)));this.own(k.subscribe("app/mapChanged",l.hitch(this,this._setMap)));this.useProxySetting=new w({label:this.nls.useProxySetting,checked:!1},this.useProxySetting);this.alwaysUseProxy=new w({label:this.nls.alwaysUseProxyLabel,checked:!1},this.alwaysUseProxy);this._is3D()?(g.set(this.appStateController,"display","none"),g.set(this.dataSourceSection,"display",
"none")):(g.set(this.appStateController,"display",""),this.appStateSetting=new w({label:this.nls.keepAppState,checked:!0,onChange:l.hitch(this,this._onAppStateSettingChange)},this.appStateSetting));window.isXT?(g.set(this.loadingPageController,"display",""),this.bgImageCheckBox=new w({label:this.nls.backgroundImage,checked:!0,onChange:l.hitch(this,this._onBackgroundImageStatusChange)},this.bgCheckBoxDiv),this.gifImageCheckBox=new w({label:this.nls.loadingGifImage,checked:!0,onChange:l.hitch(this,
this._onGifImageStatusChange)},this.gifCheckBoxDiv),this._onSelectGifMode()):g.set(this.loadingPageController,"display","none");this.linksEditor=new F({nls:this.nls,linkList:[],btnLabel:this.nls.addLink,canEdit:!0,canDelete:!0,isRest:!1,afterAdd:l.hitch(this,this._publishLinksChange),afterUpdate:l.hitch(this,this._publishLinksChange),afterDelete:l.hitch(this,this._publishLinksChange)});this.linksEditor.placeAt(this.linksSection);this.bgImageChooser=new z({cropImage:!1,label:this.nls.selectFile,format:["image/png",
"image/jpeg"]},this.bgImageChooser);d.addClass(this.bgImageChooser.domNode,"jimu-trailing-margin1 loading-image-chooser");this.bgImageChooser.startup();this.gifImageChooser=new z({cropImage:!1,label:this.nls.selectFile,format:["image/gif"]},this.gifImageChooser);d.addClass(this.gifImageChooser.domNode,"jimu-float-leading jimu-trailing-margin1 loading-image-chooser");this.gifImageChooser.startup();p(".header-section .label",this.domNode).style("display","none");this._bindEvents();window.isRTL?(p(".arrow-forward",
this.domNode).addClass("icon-arrow-left"),p(".arrow-forward",this.domNode).removeClass("icon-arrow-right"),p(".arrow-back",this.domNode).addClass("icon-arrow-forward")):(p(".arrow-forward",this.domNode).addClass("icon-arrow-right"),p(".arrow-forward",this.domNode).removeClass("icon-arrow-left"),p(".arrow-back",this.domNode).addClass("icon-arrow-back"));this.loading=new y({hidden:!0},this.loadingNode);this.loading.startup()},startup:function(){this.inherited(arguments);this._keepOrder()},destroy:function(){this.inherited(arguments);
this.subtitleNodeClickHandler&&(this.subtitleNodeClickHandler.remove(),this.subtitleNodeClickHandler=null);this.titleNodeClickHandler&&(this.titleNodeClickHandler.remove(),this.titleNodeClickHandler=null)},_setMap:function(a){this.map=a;this.additionalDataSources&&this.additionalDataSources.setMap(this.map)},_bindEvents:function(){this.titleChangeHandle=m(this.titleNode,"change",l.hitch(this,this.onTitleChange));this.subtitleChangeHandle=m(this.subtitleNode,"change",l.hitch(this,this.onSubtitleChange));
this.own(this.titleChangeHandle);this.own(this.subtitleChangeHandle);this.own(m(this.useProxySetting,"click",l.hitch(this,this._onUseProxySettingChange)));this.own(m(this.alwaysUseProxy,"click",l.hitch(this,this._onAlwaysUseProxyChange)));this.own(m(this.proxyUrlNode,"change",l.hitch(this,this._onProxyUrlChange)));this.own(m(this.proxyUrlNode,"blur",l.hitch(this,this._onProxyUrlBlur)));this.own(m(this.appIdNode,"change",l.hitch(this,this._onAppIdChange)));this.own(m(this.domNode,"click",l.hitch(this,
function(){p(".header-button",this.domNode).removeClass("highlight-button");this.selectLinkNode&&(d.removeClass(this.selectLinkNode,"selected-item"),this.selectLinkNode=null);this.selectProxyRuleNode&&(d.removeClass(this.selectProxyRuleNode,"selected-item"),this.selectProxyRuleNode=null)})));window.isXT&&(this.own(m(this.loadingPageController,"click",l.hitch(this,this._switchToLoading))),this.own(m(this.backController,"click",l.hitch(this,this._switchToApp))),this.own(m(this.bgColorPicker,"change",
l.hitch(this,this._onBackgroundColorChange))),this.own(m(this.gifSelect,"change",l.hitch(this,this._onGifSelectChange))),this.own(m(this.bgImageChooser,"change",l.hitch(this,this._onBackgroundImageUpload))),this.own(m(this.gifImageChooser,"change",l.hitch(this,this._onLoadingGifUpload))));this.own(m(this.appProxyController,"click",l.hitch(this,this._switchToAppProxy)));this.own(m(this.backController2,"click",l.hitch(this,this._switchToApp)))},_createAppProxySection:function(){this.appProxyManager.loaded?
(this._checkMapProxy(),this._checkUrlProxy()):this.own(m.once(this.appProxyManager,"load",l.hitch(this,function(){this._checkMapProxy();this._checkUrlProxy()})))},init:function(a,b){this.appConfig=a||{};this.initHeader(a,b);this.initLinks(a);this._is3D()||this.initAppStateSetting(a);this.initedProxy||(this.initProxy(a),this.initedProxy=!0);this._currentPortalUrl!==a.portalUrl&&(this.initAppId(a),this._currentPortalUrl=a.portalUrl);window.isXT&&this.initLoadingPage(a);this._is3D()||!this._isOnline()||
window.isXT?g.set(this.appProxyController,"display","none"):(this.appProxyManager||(this.appProxyManager=new B({appid:window.appInfo.id})),g.set(this.appProxyController,"display",""),this._createAppProxySection())},_isOnline:function(){var a=x.getStandardPortalUrl(window.portalUrl);return x.isOnline(a)},_checkMapProxy:function(){this.appConfig&&this.appConfig.map&&(this.appConfig.map.appProxy?this.appConfig.map.itemId===this.appConfig.map.appProxy.mapItemId?this._createMapProxyTable(this.appConfig.map.appProxy.proxyItems):
this._refreshMapProxy():this._refreshMapProxy())},_refreshMapProxy:function(){C.queryForSecureServicesInMap(this.appConfig.map.portalUrl,this.appConfig.map.itemId).then(l.hitch(this,function(a){a&&0<a.length&&this._publishAppProxy(a);this._createMapProxyTable(a)}))},_createMapProxyTable:function(a){d.empty(this.mapProxyContent);a&&0!==a.length?(d.setStyle(this.mapSection,"display",""),d.addClass(this.urlSection,"double-margin"),n.forEach(a,l.hitch(this,function(a){!0!==a.useProxy||this._proxyExists(a)||
(a.useProxy=!1,a.proxyUrl="",a.proxyId="",this._publishAppProxy([{sourceUrl:a.sourceUrl,useProxy:!1}]));a=new E({appProxyManager:this.appProxyManager,sourceUrl:a.sourceUrl,title:a.title,premium:!0===a.premium,consumeCredits:!0===a.consumeCredits,useProxy:!0===a.useProxy,proxyUrl:a.proxyUrl||"",proxyId:a.proxyId||"",nls:this.nls});this.own(m(a,E.PROCESS_START,l.hitch(this,function(){this.loading.show()})));this.own(m(a,E.PROCESS_END,l.hitch(this,function(){this.loading.hide()})));this.own(m(a,E.PROXY_CREATED,
l.hitch(this,function(a){this._publishAppProxy([a])})));this.own(m(a,E.PROXY_DELETED,l.hitch(this,function(a){this._publishAppProxy([a])})));this.own(m(a,E.PROCESS_ERROR,l.hitch(this,function(a){new A({message:a})})));d.place(a.domNode,this.mapProxyContent)}))):(d.setStyle(this.mapSection,"display","none"),d.removeClass(this.urlSection,"double-margin"))},_proxyExists:function(a){if(this.appProxyManager){var b=this.appProxyManager.get("proxies");if(b&&0<b.length)return n.some(b,function(b){return b.sourceUrl===
a.sourceUrl&&b.proxyUrl===a.proxyUrl&&b.proxyId===a.proxyId})}return!1},_checkUrlProxy:function(){this.proxyLinkEditor||(this.proxyLinkEditor=new F({nls:this.nls,linkList:[],btnLabel:this.nls.addUrlProxy,canEdit:!1,canDelete:!0,isRest:!0,beforeAdd:l.hitch(this,this._createUrlAppProxy),afterDelete:l.hitch(this,this._deleteUrlAppProxy)}),this.proxyLinkEditor.placeAt(this.linkEditorNode));if(this.appConfig&&this.appConfig.appProxies){var a=[];n.forEach(this.appConfig.appProxies,function(b){this._proxyExists(b)?
a.push({label:b.title,url:b.sourceUrl}):this._deleteUrlProxy(b.sourceUrl)},this);this.proxyLinkEditor.setItems(a)}},_createUrlAppProxy:function(a){a=new D({appProxyManager:this.appProxyManager,sourceUrl:a.url,title:a.label,nls:this.nls});var b=new e;this.own(m(a,D.PROCESS_START,l.hitch(this,function(){this.loading.show()})));this.own(m(a,D.PROCESS_END,l.hitch(this,function(){this.loading.hide()})));this.own(m(a,D.PROXY_CREATED,l.hitch(this,function(a){this._addUrlProxy(a);b.resolve(!0)})));this.own(m(a,
D.PROCESS_ERROR,l.hitch(this,function(a){b.resolve(!1);new A({message:a})})));a.createProxy();return b},_deleteUrlAppProxy:function(a){var b={appProxyManager:this.appProxyManager,sourceUrl:a.url,title:a.label,nls:this.nls};n.some(this.appConfig.appProxies,function(c){if(c.sourceUrl===a.url)return l.mixin(b,{proxyId:c.proxyId,proxyUrl:c.proxyUrl,useProxy:c.useProxy}),!0});(new D(b)).deleteProxy();this._deleteUrlProxy(b.sourceUrl)},_publishAppProxy:function(a){k.publish("appProxyForMapChanged",{mapItemId:this.appConfig.map.itemId,
proxyItems:a})},_addUrlProxy:function(a){var b=[];this.appConfig.appProxies&&0<this.appConfig.appProxies.length&&(b=l.clone(this.appConfig.appProxies));b.push({sourceUrl:a.sourceUrl,title:a.title,premium:a.premium,consumeCredits:a.consumeCredits,useProxy:a.useProxy,proxyUrl:a.proxyUrl,proxyId:a.proxyId});setTimeout(function(){k.publish("appProxyForUrlChanged",b)},100)},_deleteUrlProxy:function(a){var b=n.filter(this.appConfig.appProxies,function(b){return b.sourceUrl!==a});setTimeout(function(){k.publish("appProxyForUrlChanged",
b)},100)},_onAppConfigLoaded:function(a){this._setAppConfig(a)},_onAppConfigChanged:function(a,b){this._setAppConfig(a,b)},_setAppConfig:function(a,b){this.init(a,b)},_publishLinksChange:function(){k.publish("appAttributeChanged",{links:this.getLinks()})},initHeader:function(b,c){var e=l.getObject("theme.sharedTheme",!1,b);this.logoChooser||(this.logoChooser=new a({nls:this.nls,isPortalSupport:e.isPortalSupport}),this.logoChooser.placeAt(this.logoNodeDiv),this.logoChooser.startup(),this.own(m(this.logoChooser,
"sharedThemeChanged",l.hitch(this,function(a){a=l.mixin(this.appConfig.theme.sharedTheme,a);k.publish("sharedThemeChanged",a)}))),this.own(m(this.logoChooser,"appAttributeChanged",l.hitch(this,function(a){k.publish("appAttributeChanged",a)}))));if("undefined"===typeof c||"attributeChange"===c||"sharedThemeChange"===c)this.logoChooser.setLogo(b.logo||""),this.logoChooser.setLink(b.logoLink||"");"undefined"!==typeof c&&"sharedThemeChange"!==c||this.logoChooser.setSharedThemeConfig(e);e="";b.title&&
(e=v.stripHTML(b.title),p(this.titleNode).data("config",b.title),/<([a-z]+)\s*.*>/ig.test(b.title)&&(this.titleNode.disabled=!0,this.titleNode.title=e,this.titleNodeClickHandler||(this.titleNodeClickHandler=m(this.titleNodeDiv,"click",l.hitch(this,this.onTitleEditorClick)))),d.setAttr(this.titleNode,"value",e));b.subtitle&&(e=v.stripHTML(b.subtitle),p(this.subtitleNode).data("config",b.subtitle),/<([a-z]+)\s*.*>/ig.test(b.subtitle)&&(this.subtitleNode.disabled=!0,this.subtitleNode.title=e,this.subtitleNodeClickHandler||
(this.subtitleNodeClickHandler=m(this.subtitleNodeDiv,"click",l.hitch(this,this.onSubtitleEditorClick)))),d.setAttr(this.subtitleNode,"value",e))},onTitleChange:function(a){k.publish("appAttributeChanged",{title:a.target.disabled?p(a.target).data("config")[0]:a.target.value})},onSubtitleChange:function(a){k.publish("appAttributeChanged",{subtitle:a.target.disabled?p(a.target).data("config")[0]:a.target.value})},onTitleEditorClick:function(a){a.stopPropagation();this._editText(this.titleNode)},onSubtitleEditorClick:function(a){a.stopPropagation();
this._editText(this.subtitleNode)},_editText:function(a){this.editor=new J({plugins:["bold","italic","underline",v.getEditorTextColor("attributeConfig",!0)],extraPlugins:["|",{name:"dijit._editor.plugins.FontChoice",command:"fontName",custom:"Arial;Comic Sans MS;Courier New;Garamond;Tahoma;Times New Roman;Verdana".split(";")},"fontSize"],style:"font-family:Verdana;"});var b=d.position(a),c=new G({titleLabel:this.nls.formatStyle,width:window.isRTL?695:680,height:250,content:this.editor.domNode,buttons:[{label:window.jimuNls.common.reset,
title:this.nls.restoreStyle,onClick:l.hitch(this,function(){var a=this.editor.get("value"),a=v.stripHTML(a);this.editor.set("value",a)})},{label:window.jimuNls.common.ok,onClick:l.hitch(this,function(){var b=this.editor.get("value");/"attribute-custom-style"/g.test(b)||(b='\x3cdiv class\x3d"attribute-custom-style"\x3e'+b+"\x3c/div\x3e");p(a).data("config",b);var d=v.stripHTML(b);/<([a-z]+)\s*.*>/ig.test(b)?(a.disabled=!0,a.title=d,a!==this.titleNode||this.titleNodeClickHandler)?a!==this.subtitleNode||
this.subtitleNodeClickHandler||(this.subtitleNodeClickHandler=m(this.subtitleNodeDiv,"click",l.hitch(this,this.onSubtitleEditorClick))):this.titleNodeClickHandler=m(this.titleNodeDiv,"click",l.hitch(this,this.onTitleEditorClick)):""===d&&(a.disabled=!1,a.title="",a===this.titleNode&&this.titleNodeClickHandler?(this.titleNodeClickHandler.remove(),this.titleNodeClickHandler=null):a===this.subtitleNode&&this.subtitleNodeClickHandler&&(this.subtitleNodeClickHandler.remove(),this.subtitleNodeClickHandler=
null));a.value=d;if(a===this.titleNode)this.onTitleChange({target:a});else if(a===this.subtitleNode)this.onSubtitleChange({target:a});this.editor.destroy();this.editor=null;c.close()})},{label:window.jimuNls.common.cancel,classNames:["jimu-btn-vacation"],onClick:l.hitch(this,function(){this.editor.destroy();this.editor=null;c.close()})}],onClose:l.hitch(this,function(){this.editor&&this.editor.destroy();return!0})});window.isRTL?d.setStyle(c.domNode,{top:b.y+b.h+5+"px",left:b.x+b.w-(window.isRTL?
695:680)+"px"}):d.setStyle(c.domNode,{top:b.y+b.h+5+"px",left:b.x+"px"});d.addClass(c.domNode,"format-font-style");d.setStyle(this.editor.domNode,{width:"100%",height:"100%"});this.editor.startup();8!==h("ie")&&this.editor.resize({w:"100%",h:"100%"});this.editor.set("value",p(a).data("config")[0])},initLinks:function(a){a.links&&this.linksEditor.setItems(a.links)},initProxy:function(a){if(a=a.httpProxy)this.useProxySetting.setValue(a.useProxy),this.showProxySetting=!!a.useProxy,this._onUseProxySettingChange(),
this.alwaysUseProxy.setValue(a.alwaysUseProxy),this.showAlwaysUseProxy=!!a.alwaysUseProxy,this._onAlwaysUseProxyChange(),a.url&&d.setAttr(this.proxyUrlNode,"value",a.url),a.rules&&(d.empty(this.proxyRulesListNode),n.forEach(a.rules,l.hitch(this,function(a){this.createProxyRuleNode(a)})))},initAppStateSetting:function(a){this.appStateSetting.setValue(!!a.keepAppState)},initAppId:function(a){t.getPortal(a.portalUrl).loadSelfInfo().then(l.hitch(this,function(b){b.supportsOAuth?(d.setStyle(this.appIdSection,
"display","none"),d.setAttr(this.appIdNode,"value",a.appId)):d.setStyle(this.appIdSection,"display","none")}),l.hitch(this,function(a){this.shelter.hide();console.error(a)}))},getLinks:function(){var a=[];n.forEach(this.linksEditor.getItems(),function(b){a.push({label:b.label,url:b.url})});return a},getProxy:function(){var a=[],b=d.getAttr(this.proxyUrlNode,"value");p(".proxy-rule-list .list-item",this.domNode).forEach(l.hitch(this,function(b){var c=p(".first input",b).attr("value")[0];b=p(".second input",
b).attr("value")[0];c&&a.push({urlPrefix:c,proxyUrl:b})}));return{useProxy:this.useProxySetting.getValue(),alwaysUseProxy:this.alwaysUseProxy.getValue(),url:b,rules:a}},_bindNodeEvents:function(a,b,c,e,f,g){this.own(m(a,"click",l.hitch(this,function(b){p(".header-button",this.domNode).addClass("highlight-button");"links"===g?(this.selectLinkNode&&d.removeClass(this.selectLinkNode,"selected-item"),d.addClass(a,"selected-item"),this.selectLinkNode=a):"proxyRules"===g&&(this.selectProxyRuleNode&&d.removeClass(this.selectProxyRuleNode,
"selected-item"),d.addClass(a,"selected-item"),this.selectProxyRuleNode=a);b.stopPropagation()})));this.own(m(b,"dblclick",l.hitch(this,function(){d.setStyle(b,"display","none");d.setStyle(c,"display","block");c.focus();c.select()})));this.own(m(e,"dblclick",l.hitch(this,function(){d.setStyle(e,"display","none");d.setStyle(f,"display","block");f.focus();f.select()})));this.own(m(f,"focus",function(a){a.target.value||(a.target.value="http://")}));this.own(m(c,"blur",l.hitch(this,function(a){d.setAttr(b,
{innerHTML:a.target.value||b.innerHTML,style:{display:"block"}});d.setStyle(c,"display","none");"links"===g?k.publish("appAttributeChanged",{links:this.getLinks()}):"proxyRules"===g&&this._publishProxy()})));this.own(m(f,"blur",l.hitch(this,function(a){d.setAttr(e,{innerHTML:a.target.value||e.innerHTML,style:{display:"block"}});d.setStyle(f,"display","none");"links"===g?(a=this._formatLinkValue(a.target.value),d.setAttr(e,"innerHTML",a),d.setAttr(f,"value",a),k.publish("appAttributeChanged",{links:this.getLinks()})):
"proxyRules"===g&&this._publishProxy()})))},_formatLinkValue:function(a){var b="";return b=/^http(s?):\/\//.test(a)?a:/^\/\//.test(a)?"http:"+a:"http://"+a},_createListItem:function(a,b,c,e,f){var g=d.create("div",{"class":"list-item"}),h=d.create("div",{"class":"first jimu-float-leading"},g);c=d.create("div",{"class":"mask",innerHTML:b||c,title:c},h);var h=d.create("input",{style:{display:"none"}},h),k=d.create("div",{"class":"second jimu-float-leading"},g);f=d.create("div",{"class":"mask",innerHTML:e||
f,title:f},k);k=d.create("input",{style:{display:"none"}},k);d.setAttr(h,"value",b);d.setAttr(k,"value",e);this._bindNodeEvents(g,c,h,f,k,a);b||this.focusNewItem(g,c,h,a);return g},focusNewItem:function(a,b,c,e){"links"===e?(this.selectLinkNode&&d.removeClass(this.selectLinkNode,"selected-item"),d.addClass(a,"selected-item"),this.selectLinkNode=a):"proxyRules"===e&&(this.selectProxyRuleNode&&d.removeClass(this.selectProxyRuleNode,"selected-item"),d.addClass(a,"selected-item"),this.selectProxyRuleNode=
a);d.setStyle(b,"display","none");d.setStyle(c,"display","block");c.value=b.innerHTML;setTimeout(function(){c.focus();c.select()},0)},createProxyRuleNode:function(a){a=this._createListItem("proxyRules",a.urlPrefix,this.nls.prefixPlaceholder,a.proxyUrl,this.nls.proxyUrlPlaceholder);d.place(a,this.proxyRulesListNode)},_keepOrder:function(){var a=d.getMarginBox(this.headerSection),b=d.getMarginBox(this.linksSection),c=d.getMarginBox(this.appIdSection),e=d.getMarginBox(this.useProxySection),a=a.h+b.h+
c.h+e.h,b=d.getMarginBox(this.domNode).h;a>b&&d.setStyle(this.domNode,"paddingRight","10px")},_onEditItemClick:function(a){var b=p(".first .mask",a)[0];a=p(".first input",a)[0];d.setStyle(b,"display","none");d.setStyle(a,"display","block");a.focus();a.select()},onAddProxyRuleClick:function(a){this.createProxyRuleNode({urlPrefix:"",proxyUrl:""});this._keepOrder();a.stopPropagation()},onEditProxyRuleClick:function(){this.selectProxyRuleNode&&this._onEditItemClick(this.selectProxyRuleNode)},onDeleteProxyRuleClick:function(){this.selectProxyRuleNode&&
(d.destroy(this.selectProxyRuleNode),k.publish("appAttributeChanged",{httpProxy:this.getProxy()}))},_onUseProxySettingChange:function(){this.useProxySetting.checked?d.setStyle(this.proxySection,"display","block"):d.setStyle(this.proxySection,"display","none");this.showProxySetting!==this.useProxySetting.checked&&(this._publishProxy(),this.showProxySetting=this.useProxySetting.checked)},_onAlwaysUseProxyChange:function(){this.showAlwaysUseProxy!==this.alwaysUseProxy.checked&&(this._publishProxy(),
this.showAlwaysUseProxy=this.alwaysUseProxy.checked)},_onProxyUrlChange:function(){this._publishProxy()},_onProxyUrlBlur:function(){this.proxyUrlNode.value?d.removeClass(this.proxyUrlNode,"error-status"):d.addClass(this.proxyUrlNode,"error-status")},_onAppIdChange:function(){k.publish("appAttributeChanged",{appId:this.appIdNode.value})},_onAppStateSettingChange:function(){this.keepAppState!==this.appStateSetting.checked&&(this.keepAppState=this.appStateSetting.checked,k.publish("appAttributeChanged",
{keepAppState:this.keepAppState}))},_publishProxy:function(){k.publish("appAttributeChanged",{httpProxy:this.getProxy()})},initLoadingPage:function(a){this.showLoadingGif=this.showBackgroundImage=!0;"object"===typeof a.loadingPage&&(a=a.loadingPage,/^#([A-Fa-f0-9]{6}|[A-Fa-f0-9]{3})$/.test(a.backgroundColor)&&this.bgColorPicker.setColor(new q(a.backgroundColor)),this._initBackgroundImage(a),this._initLoadingGif(a))},_switchToLoading:function(){g.set(this.attributeSection,"display","none");g.set(this.loadingPageSection,
"display","");k.publish("actionTriggered",{action:"showLoading"})},_switchToAppProxy:function(){g.set(this.attributeSection,"display","none");g.set(this.appProxySection,"display","")},_switchToApp:function(){g.set(this.attributeSection,"display","");g.set(this.loadingPageSection,"display","none");g.set(this.appProxySection,"display","none");k.publish("actionTriggered",{action:"showApp"})},_initBackgroundImage:function(a){a.backgroundImage?a.backgroundImage.visible?(this.showBackgroundImage=!0,this.bgImageCheckBox.check(),
g.set(this.bgUploaderDiv,"display","")):(this.showBackgroundImage=!1,this.bgImageCheckBox.uncheck(),g.set(this.bgUploaderDiv,"display","none")):(this.showBackgroundImage=!1,this.bgImageCheckBox.uncheck(),g.set(this.bgUploaderDiv,"display","none"))},_initLoadingGif:function(a){var b=0;a.loadingGif?(a.loadingGif.visible?(this.showLoadingGif=!0,this.gifImageCheckBox.check(),g.set(this.gifModeSection,"display","")):(this.showLoadingGif=!1,this.gifImageCheckBox.uncheck(),g.set(this.gifModeSection,"display",
"none")),/^configs\/loading\/images/.test(a.loadingGif.uri)&&(a.loadingGif.uri=window.appInfo.appPath+a.loadingGif.uri),/^data:image\/.*;base64,/.test(a.loadingGif.uri)||/loading\.gif$/.test(a.loadingGif.uri)?(this.uploadMode.checked=!0,this._onUploadGifMode()):(this.selectMode.checked=!0,this._onSelectGifMode(),a=a.loadingGif.uri.match(/images\/(.*)/)[1],b=a.match(/\d+/),this.gifSelect.set("value",b[0]))):(this.showLoadingGif=!1,this.gifImageCheckBox.uncheck(),g.set(this.gifModeSection,"display",
"none"))},_getLoadingGifSetting:function(){var a={};this.appConfig&&this.appConfig.loadingPage&&this.appConfig.loadingPage.loadingGif&&(a=this.appConfig.loadingPage.loadingGif);return a},_getLoadingBackgroundColor:function(){return this.appConfig&&this.appConfig.loadingPage&&this.appConfig.loadingPage.backgroundColor?this.appConfig.loadingPage.backgroundColor:""},_onBackgroundColorChange:function(a){u.empty(this.bgColorPicker.domNode);u.create("span",{innerHTML:a.toHex(),style:{color:v.invertColor(a.toHex())}},
this.bgColorPicker.domNode);a.toHex()!==this._getLoadingBackgroundColor()&&k.publish("loadingPageChanged",{backgroundColor:this.bgColorPicker.getColor().toHex()})},_onBackgroundImageStatusChange:function(a){a!==this.showBackgroundImage&&(this.showBackgroundImage=a,k.publish("loadingPageChanged",{backgroundImage:{visible:this.showBackgroundImage}}))},_onBackgroundImageUpload:function(a){var b=new Image;b.src=a;this.own(m(b,"load",l.hitch(this,function(){k.publish("loadingPageChanged",{backgroundImage:{uri:a,
width:b.width,height:b.height}})})))},_onSelectGifMode:function(){g.set(this.predefinedGif,"display","");g.set(this.customGif,"display","none")},_onUploadGifMode:function(){g.set(this.predefinedGif,"display","none");g.set(this.customGif,"display","")},_onGifImageStatusChange:function(a){a!==this.showLoadingGif&&(this.showLoadingGif=a,k.publish("loadingPageChanged",{loadingGif:{visible:this.showLoadingGif}}))},_onGifSelectChange:function(a){if("0"!==a){var b=this._getLoadingGifSetting(),c=null;b.uri&&
/images\/.*/.test(b.uri)&&(b=b.uri.match(/images\/(.*)/)[1],c=b.match(/\d+/));if(null===c||a!==c[0])b=[{width:58,height:58},{width:58,height:10},{width:32,height:32},{width:34,height:34}][a-1],k.publish("loadingPageChanged",{loadingGif:{uri:window.appInfo.appPath+"configs/loading/images/predefined_loading_"+a+".gif",width:b?b.width:0,height:b?b.height:0}})}},_onLoadingGifUpload:function(a){var b=new Image;b.src=a;this.own(m(b,"load",l.hitch(this,function(){k.publish("loadingPageChanged",{loadingGif:{uri:a,
width:b.width,height:b.height}});this.gifSelect.set("value",0)})))},_is3D:function(){return"HTML3D"===window.appInfo.appType},_openDataSourcesPage:function(){g.set(this.attributeSection,{display:"none"});g.set(p(".datasources-section")[0],{display:"block"});this.additionalDataSources=new N({nls:this.nls,map:this.map,appConfig:this.appConfig});this.additionalDataSources.placeAt(this.additionalDataSourcesDiv)},_closeDataSourcesPage:function(){this.additionalDataSources.destroy();this.additionalDataSources=
null;g.set(this.attributeSection,{display:"block"});g.set(p(".datasources-section")[0],{display:"none"})}})})},"builder/plugins/attribute-config/AttrbuteLogoChooser":function(){define("dojo/Evented dojo/_base/declare dijit/_WidgetBase dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dojo/_base/lang dojo/_base/html dojo/on dojo/text!./AttrbuteLogoChooser.html jimu/dijit/Popup builder/dijit/SharedThemeChooserPopup ./CustomLogoPage dojo/sniff jimu/dijit/ImageChooser".split(" "),function(r,l,d,q,k,
m,p,h,e,c,b,a,g){return l([d,q,k,r],{baseClass:"logo-container no-logo",declaredClass:"jimu.dijit.AttrbuteLogoChooser",templateString:e,isPortalSupport:!1,_wabDefaultLogo:!0,postCreate:function(){this.inherited(arguments);p.setAttr(this.removeLogoNode,"title",this.nls.removeLogo)},startup:function(){this._createTooltipDialog();this.own(h(this.imageChooser,"imageChange",m.hitch(this,"_onLogoChoosed")));this.own(h(this.maskerNode,"mouseenter",m.hitch(this,function(){this.popup.showPopup()})));this.own(h(this.maskerNode,
"mouseleave",m.hitch(this,function(){this.popup.hidePopup()})))},setLogo:function(a){this._wabDefaultLogo="images/app-logo.png"===a?!0:!1;a?(!a||a.startWith("/")||a.startWith("http")||a.startWith("data")||(a=window.appInfo.appPath+a),this.imageChooser.setDefaultSelfSrc(a),p.addClass(this.logoContainer,"logo"),p.removeClass(this.logoContainer,"no-logo"),p.addClass(this.addLogoNode,"hide"),this._resetLogoBox(50)):(this.imageChooser.setDefaultSelfSrc(a),p.addClass(this.logoContainer,"no-logo"))},setLink:function(a){this.link=
a},setSharedThemeConfig:function(a){a&&"undefined"!==typeof a.useLogo&&(this._useLogo=a.useLogo,this.popup.setIsPortalSupport(a.isPortalSupport),this._isNoChooseState()||(!0===a.useLogo?this.showSharedThemeLogo(!1):this.setCustomLogo(!1)))},_isNoChooseState:function(){return!1===this._useLogo&&!0===this._wabDefaultLogo?!0:!1},onRemoveLogoHandler:function(a){a.stopPropagation();a.preventDefault();this.imageChooser.imageData&&(this.imageChooser.setDefaultSelfSrc(""),p.removeClass(this.logoContainer,
"logo"),p.removeClass(this.addLogoNode,"hide"),p.addClass(this.logoContainer,"no-logo"),this.setCustomLogo(),this.emit("appAttributeChanged",{logo:""}))},onChangeLogoHandler:function(a){a.stopPropagation();a.preventDefault();this.popup.showTooltipDialog()},setDiskLogo:function(){var a=this.imageChooser.mask;if(g("safari")){var b=document.createEvent("MouseEvents");b.initEvent("click",!0,!0);a.dispatchEvent(b)}else a.click();this.popup.hideTooltipDialog()},_onLogoChoosed:function(a){this._changeLogo();
this.emit("appAttributeChanged",{logo:a});this.setCustomLogo()},_onLinkChange:function(a){this.emit("appAttributeChanged",{logoLink:a});this.setCustomLogo()},showSharedThemeLogo:function(a){this.popup.setChecked(this.popup.ACTION.SHARED);this.emitSharedThemeChangedEvent(!0,a)},showCustomLogo:function(){this.popup.setChecked(this.popup.ACTION.CUSTOM)},setCustomLogo:function(a){this.emitSharedThemeChangedEvent(!1,a)},emitSharedThemeChangedEvent:function(a,b){!1!==b&&this.emit("sharedThemeChanged",{useLogo:a});
this.popup.hideTooltipDialog()},_changeLogo:function(){p.setStyle(this.imageChooser.selfImg,{width:"auto",height:"auto",marginLeft:"auto",marginRight:"auto",marginTop:"auto",marginBottom:"auto"});p.removeClass(this.logoContainer,"no-logo");p.addClass(this.logoContainer,"logo");p.addClass(this.addLogoNode,"hide");p.removeClass(this.imageChooser.domNode,"hide");setTimeout(m.hitch(this,this._resetLogoBox,4),4)},_resetLogoBox:function(a){if(this.domNode&&this.imageChooser){var b=p.getContentBox(this.imageChooser.selfImg);
0<b.w?(a=p.getContentBox(this.imageChooser.domNode),b=b.w/b.h,1>=b?(p.setStyle(this.imageChooser.selfImg,"height",a.h+"px"),b=(a.w-a.h*b)/2,p.setStyle(this.imageChooser.selfImg,{marginLeft:b+"px",marginRight:b+"px"})):(p.setStyle(this.imageChooser.selfImg,"width",a.w+"px"),b=(a.h-a.w/b)/2,p.setStyle(this.imageChooser.selfImg,{marginTop:b+"px",marginBottom:b+"px"}))):setTimeout(m.hitch(this,this._resetLogoBox,a),a)}},onMouseEnterHandler:function(){10>g("ie")&&(this._hasEntered?p.setStyle(this.removeLogoNode,
{display:"block"}):setTimeout(m.hitch(this,function(){var a=p.position(this.logoContainer);p.place(this.removeLogoNode,this.ownerDocumentBody);p.addClass(this.removeLogoNode,"attribute-config-plugin-logo-options");p.setStyle(this.removeLogoNode,{position:"absolute",display:"block",left:(window.isRTL?a.x+5:a.x+a.w-35)+"px",top:a.y+5+"px"});this._hasEntered=!0})))},onMouseLeaveHandler:function(){10>g("ie")&&(p.setStyle(this.removeLogoNode,{display:"none"}),this._hasEntered=!1)},destroy:function(){this.popup.destroy();
this.inherited(arguments)},_createTooltipDialog:function(){this.popup=new b({isPortalSupport:this.isPortalSupport,placeAt:this.getParent(),around:this.domNode});this.own(h(this.popup,"btnClick",m.hitch(this,function(a){a===this.popup.ACTION.SHARED?this.showSharedThemeLogo():a===this.popup.ACTION.CUSTOM&&this.showCustomPopup()})));this.own(h(this.popup,"showPopup",m.hitch(this,function(){this._isNoChooseState()||this.popup.setChecked(this._useLogo?this.popup.ACTION.SHARED:this.popup.ACTION.CUSTOM)})))},
showCustomPopup:function(){this.popup.hideTooltipDialog();this.customLogoPage=new a({nls:this.nls,link:this.link,imageChooser:this.imageChooser});this.customPopup=new c({content:this.customLogoPage,titleLabel:this.nls.setLogo,width:669,autoHeight:!0,buttons:[{label:this.nls.ok,onClick:m.hitch(this,function(){if(this.customLogoPage.isValid()){var a=this.customLogoPage.getLink();this.setLink(a);this._onLinkChange(a);this.customPopup.close()}})},{label:this.nls.cancel,onClick:m.hitch(this,function(){this.customPopup.close()})}]})}})})},
"builder/dijit/SharedThemeChooserPopup":function(){define("dojo/Evented dojo/_base/declare dijit/_WidgetBase dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dojo/_base/lang dojo/_base/html dojo/on dijit/TooltipDialog dojo/text!./templates/SharedThemeChooserPopup.html dijit/popup".split(" "),function(r,l,d,q,k,m,p,h,e,c,b){return l([d,q,k,r],{declaredClass:"shared-theme-chooser-popup",templateString:c,isPortalSupport:!1,_DISAPPEAR_TIMER:null,_isTooltipDialogOpened:!1,placeAt:null,ACTION:null,postMixInProperties:function(){this.inherited(arguments);
this.nls=m.mixin(this.nls,builderNls);this.ACTION={SHARED:"shared",CUSTOM:"custom"}},postCreate:function(){this.inherited(arguments);this.setIsPortalSupport(this.isPortalSupport);this._createTooltipDialog();this.own(h(this.sharedItem,"click",m.hitch(this,function(a){a.stopPropagation();a.preventDefault();!0===this.isPortalSupport&&this.sharedClickHanlder(a)})));this.own(h(this.customItem,"click",m.hitch(this,function(a){this.customClickHanlder(a)})));this.own(h(document,"click",m.hitch(this,function(a){this.isPartOfPopup(a.srcElement||
a.target)||this._hideTooltipDialog()})));this._hideTooltipDialog()},destroy:function(){b.close(this.tooltipDialog);this.tooltipDialog.destroy();this.inherited(arguments)},isPartOfPopup:function(a){var c=this.tooltipDialog.domNode,c=a===c||p.isDescendant(a,c),d=!1,e=b.getTopPopup();e&&e.wrapper&&(d=e.wrapper,d=a===d||p.isDescendant(a,d));return c||d},hideTooltipDialog:function(){this._hideTooltipDialog()},showTooltipDialog:function(){this._showTooltipDialog()},getTooltipDialog:function(){return this.tooltipDialog&&
this.tooltipDialog.domNode?this.tooltipDialog:null},_showTooltipDialog:function(){b.open({parent:this.placeAt||this.getParent(),popup:this.tooltipDialog,around:this.around});this._isTooltipDialogOpened=!0;this.emit("showPopup")},_hideTooltipDialog:function(){b.close(this.tooltipDialog);this._isTooltipDialogOpened=!1},_createTooltipDialog:function(){this.tooltipDialog=new e({content:this.domNode});p.addClass(this.tooltipDialog.domNode,"shared-theme-chooser-popup-container");var a=this.getTooltipDialog();
this.own(h(a.domNode,"mouseover",m.hitch(this,function(a){this.showPopup(a)})));this.own(h(a.domNode,"mouseleave",m.hitch(this,function(a){this.hidePopup(a)})))},setIsPortalSupport:function(a){this.isPortalSupport=a;!0!==this.isPortalSupport?p.addClass(this.sharedItem,"no-support"):p.removeClass(this.sharedItem,"no-support")},sharedClickHanlder:function(a){this.emit("btnClick",this.ACTION.SHARED,a)},customClickHanlder:function(a){this.emit("btnClick",this.ACTION.CUSTOM,a)},setChecked:function(a){p.removeClass(this.sharedCheck,
"check");p.removeClass(this.customCheck,"check");a===this.ACTION.SHARED&&p.addClass(this.sharedCheck,"check");a===this.ACTION.CUSTOM&&p.addClass(this.customCheck,"check")},showPopup:function(a){a&&(a.stopPropagation(),a.preventDefault());this._clearDisappearTimer();!1===this._isTooltipDialogOpened&&(this.showTooltipDialog(),this._isTooltipDialogOpened=!0)},hidePopup:function(a){a&&(a.stopPropagation(),a.preventDefault());this._setDisappearTimer()},_clearDisappearTimer:function(){this._miniModeTimer&&
clearTimeout(this._miniModeTimer)},_setDisappearTimer:function(){this._miniModeTimer=setTimeout(m.hitch(this,function(){this.hideTooltipDialog();this._isTooltipDialogOpened=!1}),500)}})})},"dijit/TooltipDialog":function(){define("dojo/_base/declare dojo/dom-class dojo/has dojo/keys dojo/_base/lang dojo/on ./focus ./layout/ContentPane ./_DialogMixin ./form/_FormMixin ./_TemplatedMixin dojo/text!./templates/TooltipDialog.html ./main".split(" "),function(r,l,d,q,k,m,p,h,e,c,b,a,g){r=r("dijit.TooltipDialog",
[h,b,c,e],{title:"",doLayout:!1,autofocus:!0,baseClass:"dijitTooltipDialog",_firstFocusItem:null,_lastFocusItem:null,templateString:a,_setTitleAttr:"containerNode",postCreate:function(){this.inherited(arguments);this.own(m(this.domNode,"keydown",k.hitch(this,"_onKey")))},orient:function(a,b,c){a={"MR-ML":"dijitTooltipRight","ML-MR":"dijitTooltipLeft","TM-BM":"dijitTooltipAbove","BM-TM":"dijitTooltipBelow","BL-TL":"dijitTooltipBelow dijitTooltipABLeft","TL-BL":"dijitTooltipAbove dijitTooltipABLeft",
"BR-TR":"dijitTooltipBelow dijitTooltipABRight","TR-BR":"dijitTooltipAbove dijitTooltipABRight","BR-BL":"dijitTooltipRight","BL-BR":"dijitTooltipLeft","BR-TL":"dijitTooltipBelow dijitTooltipABLeft","BL-TR":"dijitTooltipBelow dijitTooltipABRight","TL-BR":"dijitTooltipAbove dijitTooltipABRight","TR-BL":"dijitTooltipAbove dijitTooltipABLeft"}[b+"-"+c];l.replace(this.domNode,a,this._currentOrientClass||"");this._currentOrientClass=a},focus:function(){this._getFocusItems();p.focus(this._firstFocusItem)},
onOpen:function(a){this.orient(this.domNode,a.aroundCorner,a.corner);var b=a.aroundNodePos;"M"==a.corner.charAt(0)&&"M"==a.aroundCorner.charAt(0)?(this.connectorNode.style.top=b.y+(b.h-this.connectorNode.offsetHeight>>1)-a.y+"px",this.connectorNode.style.left=""):"M"==a.corner.charAt(1)&&"M"==a.aroundCorner.charAt(1)&&(this.connectorNode.style.left=b.x+(b.w-this.connectorNode.offsetWidth>>1)-a.x+"px");this._onShow()},onClose:function(){this.onHide()},_onKey:function(a){if(a.keyCode==q.ESCAPE)this.defer("onCancel"),
a.stopPropagation(),a.preventDefault();else if(a.keyCode==q.TAB){var b=a.target;this._getFocusItems();this._firstFocusItem==this._lastFocusItem?(a.stopPropagation(),a.preventDefault()):b==this._firstFocusItem&&a.shiftKey?(p.focus(this._lastFocusItem),a.stopPropagation(),a.preventDefault()):b!=this._lastFocusItem||a.shiftKey?a.stopPropagation():(p.focus(this._firstFocusItem),a.stopPropagation(),a.preventDefault())}}});d("dojo-bidi")&&r.extend({_setTitleAttr:function(a){this.containerNode.title=this.textDir&&
this.enforceTextDirWithUcc?this.enforceTextDirWithUcc(null,a):a;this._set("title",a)},_setTextDirAttr:function(a){this._created&&this.textDir==a||(this._set("textDir",a),this.textDir&&this.title&&(this.containerNode.title=this.enforceTextDirWithUcc(null,this.title)))}});return r})},"builder/plugins/attribute-config/CustomLogoPage":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/html dojo/on dojo/sniff builder/BasePlugin dijit/_WidgetsInTemplateMixin dojo/text!./CustomLogoPage.html".split(" "),
function(r,l,d,q,k,m,p,h){return r([m,p],{templateString:h,baseClass:"custom-logo-page",nls:null,imageChooser:null,postMixInProperties:function(){this.inherited(arguments);this.nls=l.mixin(this.nls,window.jimuNls);this.nls=l.mixin(this.nls,builderNls)},postCreate:function(){this.inherited(arguments);this.noImage.innerHTML=this.nls.symbolChooser.noFileChoosen;var d=this.imageChooser.getImageData();this.setImage(d);this.link&&this.setLink(this.link);this.own(q(this.chooseImageBtn,"click",l.hitch(this,
this.chooseImage)));this.own(q(this.imageChooser,"imageChange",l.hitch(this,function(c){this.setImage(c)})))},setImage:function(e){d.addClass(this.image,"hide");d.addClass(this.noImage,"hide");""===e?d.removeClass(this.noImage,"hide"):(d.removeClass(this.image,"hide"),d.attr(this.image,"src",e))},chooseImage:function(){var d=this.imageChooser.mask;if(k("safari")){var c=document.createEvent("MouseEvents");c.initEvent("click",!0,!0);d.dispatchEvent(c)}else d.click()},setLink:function(d){this.linkText.setValue(d)},
getLink:function(){return this.linkText.getValue()},isValid:function(){return!1===this.linkText.isValid()?!1:!0}})})},"jimu/dijit/CheckBox":function(){define("dojo/_base/declare dijit/_WidgetBase dojo/_base/lang dojo/_base/html dojo/dom-class dojo/on dojo/Evented".split(" "),function(r,l,d,q,k,m,p){return r([l,p],{baseClass:"jimu-checkbox",declaredClass:"jimu.dijit.CheckBox",checked:!1,status:!0,label:"",postCreate:function(){this.checkNode=q.create("div",{"class":"checkbox jimu-float-leading"},this.domNode);
this.labelNode=q.create("div",{"class":"label jimu-float-leading",innerHTML:this.label||""},this.domNode);this.checked&&q.addClass(this.checkNode,"checked");this.status||q.addClass(this.domNode,"jimu-state-disabled");this.own(m(this.checkNode,"click",d.hitch(this,function(){this.status&&(this.checked?this.uncheck():this.check())})));this.own(m(this.labelNode,"click",d.hitch(this,function(){this.checked&&this.status?this.uncheck():this.status&&this.check()})));this._udpateLabelClass()},setLabel:function(d){this.label=
d;this.labelNode.innerHTML=this.label;this._udpateLabelClass()},_udpateLabelClass:function(){this.labelNode&&(this.labelNode.innerHTML?q.removeClass(this.labelNode,"not-visible"):q.addClass(this.labelNode,"not-visible"))},setValue:function(d){this.status&&(!0===d?this.check():this.uncheck())},getValue:function(){return this.checked},setStatus:function(d){d=!!d;var e=this.status!==d;(this.status=d)?k.remove(this.domNode,"jimu-state-disabled"):k.add(this.domNode,"jimu-state-disabled");e&&this.emit("status-change",
d)},getStatus:function(){return this.status},check:function(){this.status&&(this.checked=!0,q.addClass(this.checkNode,"checked"),this.onStateChange())},uncheck:function(d){if(this.status&&(this.checked=!1,q.removeClass(this.checkNode,"checked"),!d))this.onStateChange()},onStateChange:function(){if(this.onChange&&d.isFunction(this.onChange))this.onChange(this.checked);this.emit("change",this.checked)}})})},"esri/arcgis/AppProxyManager":function(){define("dojo/_base/declare dojo/_base/lang ../kernel dojo/uacss dojo/Deferred dojo/promise/all dojo/json dojo/Evented dojo/Stateful ../request ./utils".split(" "),
function(r,l,d,q,k,m,p,h,e,c,b){return r([h,e],{constructor:function(a){this.defaults={appid:"",hitsPerInterval:0,intervalSeconds:60,referrers:[],proxies:[]};a=l.mixin({},this.defaults,a);this.set(a);this._init()},createProxies:function(a){var b=new k;this._registerApp(this._appItem).then(l.hitch(this,function(){var d={referrers:this.referrers},e=this.hitsPerInterval;isNaN(e)||(d.hitsPerInterval=e);e=this.intervalSeconds;isNaN(e)||(d.intervalSeconds=e);for(var e=[],g=0;g<a.length;g++)e.push({sourceUrl:a[g].sourceUrl});
g=this._sharingBaseUrl+"content/users/"+this._owner+"/";this._folderId&&(g+=this._folderId+"/");g+="items/"+this.appid+"/createProxies";c({url:g,content:{proxies:p.stringify(e),serviceProxyParams:p.stringify(d),f:"json"},callbackParamName:"callback"},{usePost:!0}).then(l.hitch(this,function(a){this.set("proxies",a.appProxies||[]);b.resolve(a.appProxies)}),b.reject)}),b.reject);return b.promise},deleteProxies:function(a){var b=new k,d={f:"json"},e=[];if(a&&a.length)for(var h=0;h<a.length;h++)e.push(a[h].proxyId);
e&&e.length&&(d.proxies=e.toString());a=this._sharingBaseUrl+"content/users/"+this._owner+"/";this._folderId&&(a+=this._folderId+"/");a+="items/"+this.appid+"/deleteProxies";c({url:a,content:d,callbackParamName:"callback"},{usePost:!0}).then(l.hitch(this,function(a){var c=this.proxies.slice();a=a.results;if(c&&c.length&&a&&a.length)for(var d=0;d<c.length;d++)for(var e=c[d],f=e.proxyId,g=0;g<a.length;g++){var h=a[g].proxyId;h&&f&&h===f&&(e.proxied=!1)}this.set("proxies",c);b.resolve(c)}),b.reject);
return b.promise},_parseUrl:function(a){var b=document.createElement("a");b.href=a;return b},_init:function(){this.appid?b.getItem(this.appid).then(l.hitch(this,function(a){this._appItem=a;this._folderId=a.item.ownerFolder;var b=this._parseUrl(a.item.url);this._sharingBaseUrl="https://"+b.hostname+"/sharing/rest/";var c=b.pathname.substring(0,b.pathname.lastIndexOf("/")),c="/"===c.charAt(0)?c:"/"+c,b=b.hostname+c,c="https://"+b;this.referrers.push("http://"+b);this.referrers.push(c);this._owner=a.item.owner;
-1!==a.item.typeKeywords.indexOf("App Proxy")&&a.item.appProxies&&this.set("proxies",a.item.appProxies);this.emit("load",{});this.set("loaded",!0)})):console.error("AppProxyManager: appid required.")},_registerApp:function(a){var b=new k,d=a.item.id,e=this._sharingBaseUrl+"oauth2/",h=this.referrers;this._registered&&this._registered===this.appid?b.resolve(a):-1!==a.item.typeKeywords.indexOf("Registered App")?b.resolve(a):c({url:e+"/registerApp",content:{itemId:d,appType:"browser",redirect_uris:p.stringify(h),
f:"json"},callbackParamName:"callback"},{usePost:!0}).then(l.hitch(this,function(a){this._registered=this.appid;b.resolve(a)}),b.reject);return b.promise}})})},"builder/plugins/attribute-config/AppProxyUtil":function(){define(["dojo/_base/array","dojo/Deferred","jimu/portalUtils"],function(r,l,d){function q(c){return r.some(p,function(b){return-1<c.search(b)})}function k(c){return r.some(h,function(b){return-1<c.search(b)})}function m(c){var b=new l;if(c){var a=[],d={},e;r.forEach(c.operationalLayers,
function(b){var c,f;c=b.url;f=document.createElement("a");f.href=c;c=q(f.host);f=k(f.host);if(c||f)d[b.url]?(e=d[b.url],e.title=e.title+", "+(b.title||b.name)):(e={sourceUrl:b.url,title:b.title||b.name,premium:c,consumeCredits:f,useProxy:!1},a.push(e),d[b.url]=e)});b.resolve(a)}else b.resolve([]);return b}var p=[/traffic\w*\.arcgis\.com/i,/landsat\w*\.arcgis\.com/i,/elevation\w*\.arcgis\.com/i,/geoenrich\w*\.arcgis\.com/i,/hydro\w*\.arcgis\.com/i,/naip\w*\.arcgis\.com/i,/livefeeds\w*\.arcgis\.com/i,
/demographics\w*\.arcgis\.com/i,/landscape\w*\.arcgis\.com/i,/historical\w*\.arcgis\.com/i,/earthobs\w*\.arcgis\.com/i],h=[/demographics\w*\.arcgis\.com/i,/geoenrich\w*\.arcgis\.com/i,/route\w*\.arcgis\.com/i,/logistics\w*\.arcgis\.com/i,/analysis\w*\.arcgis\.com/i,/elevation\w*\.arcgis\.com/i],e={queryForSecureServicesInMap:function(c,b){try{return d.getPortal(c).getItemData(b).then(function(a){return m(a)},function(){return[]})}catch(g){var a=new l;a.resolve([]);return a}}};e.isPremium=q;e.consumesCredits=
k;return e})},"builder/plugins/attribute-config/MapProxyItem":function(){define("dojo/_base/declare dojo/_base/array dojo/_base/lang dojo/_base/html dojo/Evented dojo/on dijit/_WidgetBase dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin jimu/dijit/CheckBox".split(" "),function(r,l,d,q,k,m,p,h,e){r=r([p,h,e,k],{baseClass:"map-proxy-item",templateString:'\x3cdiv class\x3d"row"\x3e\x3cdiv data-dojo-attach-point\x3d"layerTitle" class\x3d"col" title\x3d"${title}"\x3e${title}\x3c/div\x3e\x3cdiv data-dojo-attach-point\x3d"consumeCreditsContent" class\x3d"col credits-value"\x3e\x3c/div\x3e\x3cdiv class\x3d"use-proxy col" data-dojo-attach-point\x3d"useProxyCheckBox" data-dojo-type\x3d"jimu/dijit/CheckBox"\x3e\x3c/div\x3e\x3cdiv data-dojo-attach-point\x3d"loading" class\x3d"loading-content"\x3e\x3c/div\x3e\x3c/div\x3e',
appProxyManager:null,sourceUrl:"",title:"",useProxy:!1,proxyUrl:"",proxyId:"",premium:!0,consumeCredits:!1,postCreate:function(){this.inherited(arguments);!0===this.consumeCredits&&q.addClass(this.consumeCreditsContent,"credits");q.setStyle(this.loading,"display","none");this.useProxyCheckBox.setStatus(!0);!0===this.useProxy&&this.proxyId&&this.proxyUrl?this.useProxyCheckBox.setValue(!0):this.useProxyCheckBox.setValue(!1);this.own(m(this.useProxyCheckBox,"change",d.hitch(this,this._onUseProxyChange)))},
_onUseProxyChange:function(c){c&&!this.proxyId&&this._createProxy();!c&&this.proxyId&&this._deleteProxy()},_createProxy:function(){this._startProcess("Create Proxy");if(this.appProxyManager){var c=!1;this.appProxyManager.proxies&&0<this.appProxyManager.proxies.length&&(c=l.some(this.appProxyManager.proxies,function(b){return b.sourceUrl===this.sourceUrl&&b.proxyId&&b.proxyUrl}));if(c)this._checkCreateProxiesCallback(this.appProxyManager.proxies);else try{this.appProxyManager.createProxies([{sourceUrl:this.sourceUrl}]).then(d.hitch(this,
this._checkCreateProxiesCallback),d.hitch(this,this._createProxiesFail))}catch(b){this._createProxiesFail(b.message)}}else this.emit("processError",this.nls.deleteProxyFailed+" "+this.sourceUrl),this._stopProcess("appProxyManager is undefined",!1)},_checkCreateProxiesCallback:function(c){l.some(c,d.hitch(this,function(b){if(b.sourceUrl===this.sourceUrl)return this.proxyUrl=b.proxyUrl,this.proxyId=b.proxyId,this.useProxy=!0}))?(this.emit("proxyCreated",{sourceUrl:this.sourceUrl,proxyUrl:this.proxyUrl,
proxyId:this.proxyId,title:this.title,useProxy:!0}),this._stopProcess("Create Proxy",!0)):(this.emit("processError",this.nls.createProxyFailed+" "+this.sourceUrl),this._stopProcess("Create Proxy",!1))},_createProxiesFail:function(c){this.proxyUrl=this.proxyId="";this.useProxy=!1;this.emit("processError",this.nls.createProxyFailed+" "+this.sourceUrl);this._stopProcess(c||"Create Proxy",!1)},_deleteProxy:function(){var c=this.proxyId;this.proxyId=this.proxyUrl="";this.useProxy=!1;this.emit("proxyDeleted",
{sourceUrl:this.sourceUrl,useProxy:!1});this.useProxyCheckBox.setValue(!1);if(this.appProxyManager)try{this.appProxyManager.deleteProxies([{proxyId:c}])}catch(b){console.error(b)}},_startProcess:function(c){q.setStyle(this.loading,"display","");this.useProxyCheckBox.setStatus(!1);this.emit("processStart",c)},_stopProcess:function(c,b){q.setStyle(this.loading,"display","none");this.useProxyCheckBox.setStatus(!0);"undefined"!==typeof b&&this.useProxyCheckBox.setValue(b);this.emit("processEnd",c)}});
r.PROXY_CREATED="proxyCreated";r.PROXY_DELETED="proxyDeleted";r.PROCESS_START="processStart";r.PROCESS_END="processEnd";r.PROCESS_ERROR="processError";return r})},"builder/plugins/attribute-config/UrlProxyItem":function(){define(["dojo/_base/declare","dojo/_base/array","dojo/_base/lang","dojo/Evented","./AppProxyUtil"],function(r,l,d,q,k){r=r([q],{appProxyManager:null,title:"",sourceUrl:"",proxyUrl:"",proxyId:"",premium:!0,consumeCredits:!1,constructor:function(l){d.mixin(this,l);this.premium=k.isPremium(this.sourceUrl);
this.consumeCredits=k.consumesCredits(this.sourceUrl)},createProxy:function(){this._startProcess();if(this.premium||this.consumeCredits)if(this.appProxyManager){var k=!1;this.appProxyManager.proxies&&0<this.appProxyManager.proxies.length&&(k=l.some(this.appProxyManager.proxies,function(d){return d.sourceUrl===this.sourceUrl&&d.proxyId&&d.proxyUrl}));if(k)this._checkCreateProxiesCallback(this.appProxyManager.proxies);else try{this.appProxyManager.createProxies([{sourceUrl:this.sourceUrl}]).then(d.hitch(this,
function(d){this._checkCreateProxiesCallback(d)}),d.hitch(this,function(){this._checkCreateProxiesCallback([])}))}catch(p){this._checkCreateProxiesCallback([])}}else this._checkCreateProxiesCallback([]);else this.emit("processError",this.nls.notValidPremiumUrl+" "+this.sourceUrl),this._stopProcess()},_checkCreateProxiesCallback:function(k){l.some(k,d.hitch(this,function(d){if(d.sourceUrl===this.sourceUrl)return this.proxyUrl=d.proxyUrl,this.proxyId=d.proxyId,!0}))?this.emit("proxyCreated",{sourceUrl:this.sourceUrl,
proxyUrl:this.proxyUrl,proxyId:this.proxyId,title:this.title,premium:this.premium,consumeCredits:this.consumeCredits,useProxy:!0}):(this.proxyUrl=this.proxyId="",this.useProxy=!1,this.emit("processError",this.nls.createProxyFailed+" "+this.sourceUrl));this._stopProcess()},deleteProxy:function(){this._startProcess();if(this.appProxyManager&&this.proxyId)try{this.appProxyManager.deleteProxies([{proxyId:this.proxyId}]).then(d.hitch(this,function(k){var m=l.some(k,d.hitch(this,function(d){return d.sourceUrl===
this.sourceUrl&&!1===d.proxied}));m||(m=l.every(k,d.hitch(this,function(d){return d.sourceUrl!==this.sourceUrl})));m?(this.proxyId=this.proxyUrl="",this.emit("proxyDeleted",this.sourceUrl)):this.emit("processError",this.nls.deleteProxyFailed+" "+this.sourceUrl);this._stopProcess()}),d.hitch(this,function(){this.emit("processError",this.nls.deleteProxyFailed+" "+this.sourceUrl);this._stopProcess()}))}catch(m){this.emit("processError",this.nls.deleteProxyFailed+" "+this.sourceUrl),this._stopProcess()}else this.emit("processError",
this.nls.deleteProxyFailed+" "+this.sourceUrl),this._stopProcess()},_startProcess:function(){this.emit("processStart")},_stopProcess:function(){this.emit("processEnd")}});r.PROXY_CREATED="proxyCreated";r.PROCESS_START="processStart";r.PROXY_DELETED="proxyDeleted";r.PROCESS_END="processEnd";r.PROCESS_ERROR="processError";return r})},"builder/dijit/LinkEditor":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/html dojo/_base/array dijit/_WidgetBase dijit/_TemplatedMixin dojo/text!./templates/LinkEditor.html dojo/on dojo/dom-geometry dojo/Evented ./LinkItemEditor ./LinkItem".split(" "),
function(r,l,d,q,k,m,p,h,e,c,b,a){return r([k,m,c],{templateString:p,baseClass:"link-editor",btnLabel:"",linkList:[],canEdit:!0,canDelete:!0,isRest:!1,beforeAdd:null,afterAdd:null,beforeUpdate:null,afterUpdate:null,beforeDelete:null,afterDelete:null,postMixInProperties:function(){this.nls=l.mixin(this.nls,window.jimuNls.common);""===this.btnLabel&&(this.btnLabel="Add Link")},postCreate:function(){this.inherited(arguments);this.labelNode.innerHTML=this.btnLabel;this.setItems(this.linkList);this.editor=
new b({nls:this.nls,isRest:this.isRest});this.editor.placeAt(this.domNode);this.editor.startup();this.editor.hide();this.own(h(this.editor,"updated",l.hitch(this,this._updateLinkItem)));this.own(h(this.addLinkBtn,"click",l.hitch(this,function(){this._showEditor(null)})))},clearItems:function(){this.linkItems=[];d.empty(this.linkListNode)},setItems:function(a){this.clearItems();this.linkList=a;q.forEach(this.linkList,l.hitch(this,function(a){this._addItem(a,!1)}))},getItems:function(){return this.linkItems},
_showEditor:function(a){var b;null!==a?b=e.position(a.domNode):(b=e.position(this.addLinkBtn),b.y+=b.h);this.editor.setLinkItem(a);this.editor.show(b.x,b.y)},_addItem:function(a,b){b&&"function"===typeof this.beforeAdd?this.beforeAdd(a).then(l.hitch(this,function(b){!0===b&&this._doAddItem(a)})):this._doAddItem(a,b)},_doAddItem:function(b,c){var d=new a({nls:this.nls,label:b.label,url:b.url,canEdit:this.canEdit,canDelete:this.canDelete});d.placeAt(this.linkListNode);d.startup();this.linkItems.push(d);
this.own(h(d,"delete",l.hitch(this,this._deleteItem)));this.own(h(d,"edit",l.hitch(this,function(a){this._showEditor(a)})));c&&"function"===typeof this.afterAdd&&this.afterAdd(d)},_updateLinkItem:function(a){null===a.linkItem?this._addItem({label:a.newValue.label,url:a.newValue.url},!0):"function"===typeof this.beforeUpdate?this.beforeUpdate(a.linkItem,a.newValue.label,a.newValue.url).then(l.hitch(this,function(b){!0===b&&this._doUpdateItem(a.linkItem,a.newValue.label,a.newValue.url)})):this._doUpdateItem(a.linkItem,
a.newValue.label,a.newValue.url)},_doUpdateItem:function(a,b,c){a.update(b,c);"function"===typeof this.afterUpdate&&this.afterUpdate(a,b,c)},_deleteItem:function(a){"function"===typeof this.beforeDelete?this.beforeDelete(a).then(l.hitch(this,function(b){!0===b&&this._doDeleteItem(a)})):this._doDeleteItem(a)},_doDeleteItem:function(a){this.linkItems=q.filter(this.linkItems,function(b){return b!==a});d.destroy(a.domNode);"function"===typeof this.afterDelete&&this.afterDelete(a)}})})},"builder/dijit/LinkItemEditor":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/html dijit/_WidgetBase dijit/_TemplatedMixin dijit/form/ValidationTextBox jimu/dijit/URLInput dojo/text!./templates/LinkItemEditor.html dojo/on dojo/dom-style dojo/Evented".split(" "),
function(r,l,d,q,k,m,p,h,e,c,b){return r([q,k,b],{templateString:h,baseClass:"link-item-editor",linkItem:null,isRest:!1,postCreate:function(){this.inherited(arguments);this.urlInput=new p({required:!0,rest:this.isRest,placeHolder:this.nls.inputURL,value:this.linkItem?this.linkItem.url:"",style:"width:100%"});this.urlInput.placeAt(this.urlNode);this.urlInput.startup();this.titleInput=new m({required:!0,trim:!0,placeHolder:this.nls.inputTitle,value:this.linkItem?this.linkItem.label:"",style:"width: 100%"});
this.titleInput.placeAt(this.titleNode);this.titleInput.startup();this.own(e(this.okBtn,"click",l.hitch(this,this._onOkClicked)));this.own(e(this.cancelBtn,"click",l.hitch(this,this.hide)));this.own(e(this.domNode,"click",l.hitch(this,this._onDomClicked)))},setLinkItem:function(a){this.linkItem=a;this.titleInput.set("value",a?a.label:"");this.urlInput.set("value",a?a.url:"")},_onDomClicked:function(a){d.isDescendant(a.target||a.srcElement,this.contentNode)||this.hide()},show:function(a,b){c.set(this.domNode,
"display","");c.set(this.contentNode,{left:a+"px",top:b+"px"})},hide:function(){c.set(this.domNode,"display","none")},_onOkClicked:function(){if(this.urlInput.isValid()&&this.titleInput.isValid()){var a=this.titleInput.get("value"),b=this.urlInput.get("value");-1===b.indexOf("//")&&(b="http://"+b);this.linkItem&&a===this.linkItem.label&&b===this.linkItem.url||(this.emit("updated",{linkItem:this.linkItem,newValue:{label:a,url:b}}),this.hide())}}})})},"jimu/dijit/URLInput":function(){define(["dojo/_base/declare",
"dojo/_base/html","dijit/form/ValidationTextBox","dojox/validate/regexp"],function(r,l,d,q){return r([d],{required:!0,invalidMessage:"Invalid url.",trim:!0,rest:!0,allowNamed:!0,allowLocal:!0,declaredClass:"jimu.dijit.URLInput",postMixInProperties:function(){this.inherited(arguments);this.invalidMessage=(this.nls=window.jimuNls.urlInput)?this.nls.invalidUrl:"Invalid Url"},postCreate:function(){this.inherited(arguments);l.addClass(this.domNode,"jimu-url-input")},validator:function(d){if(!1===this.required&&
""===d)return!0;if(isFinite(d))return!1;var k="^"+q.url({allowNamed:this.allowNamed,allowLocal:this.allowLocal}),k=new RegExp(k,"g");k.lastIndex=0;k=k.test(d);return this.rest?(d=/\/rest\/services/gi.test(d),k&&d):k}})})},"dojox/validate/regexp":function(){define(["dojo/_base/lang","dojo/regexp","dojox/main"],function(r,l,d){var q=r.getObject("validate.regexp",!0,d);return q=d.validate.regexp={ipAddress:function(d){d="object"==typeof d?d:{};"boolean"!=typeof d.allowDottedDecimal&&(d.allowDottedDecimal=
!0);"boolean"!=typeof d.allowDottedHex&&(d.allowDottedHex=!0);"boolean"!=typeof d.allowDottedOctal&&(d.allowDottedOctal=!0);"boolean"!=typeof d.allowDecimal&&(d.allowDecimal=!0);"boolean"!=typeof d.allowHex&&(d.allowHex=!0);"boolean"!=typeof d.allowIPv6&&(d.allowIPv6=!0);"boolean"!=typeof d.allowHybrid&&(d.allowHybrid=!0);var k=[];d.allowDottedDecimal&&k.push("((\\d|[1-9]\\d|1\\d\\d|2[0-4]\\d|25[0-5])\\.){3}(\\d|[1-9]\\d|1\\d\\d|2[0-4]\\d|25[0-5])");d.allowDottedHex&&k.push("(0[xX]0*[\\da-fA-F]?[\\da-fA-F]\\.){3}0[xX]0*[\\da-fA-F]?[\\da-fA-F]");
d.allowDottedOctal&&k.push("(0+[0-3][0-7][0-7]\\.){3}0+[0-3][0-7][0-7]");d.allowDecimal&&k.push("(0|[1-9]\\d{0,8}|[1-3]\\d{9}|4[01]\\d{8}|42[0-8]\\d{7}|429[0-3]\\d{6}|4294[0-8]\\d{5}|42949[0-5]\\d{4}|429496[0-6]\\d{3}|4294967[01]\\d{2}|42949672[0-8]\\d|429496729[0-5])");d.allowHex&&k.push("0[xX]0*[\\da-fA-F]{1,8}");d.allowIPv6&&k.push("([\\da-fA-F]{1,4}\\:){7}[\\da-fA-F]{1,4}");d.allowHybrid&&k.push("([\\da-fA-F]{1,4}\\:){6}((\\d|[1-9]\\d|1\\d\\d|2[0-4]\\d|25[0-5])\\.){3}(\\d|[1-9]\\d|1\\d\\d|2[0-4]\\d|25[0-5])");
d="";0<k.length&&(d="("+k.join("|")+")");return d},host:function(d){d="object"==typeof d?d:{};"boolean"!=typeof d.allowIP&&(d.allowIP=!0);"boolean"!=typeof d.allowLocal&&(d.allowLocal=!1);"boolean"!=typeof d.allowPort&&(d.allowPort=!0);"boolean"!=typeof d.allowNamed&&(d.allowNamed=!1);var k=d.allowPort?"(\\:\\d+)?":"",l="((?:(?:[\\da-zA-Z](?:[-\\da-zA-Z]{0,61}[\\da-zA-Z])?)\\.)+(?:[a-zA-Z](?:[-\\da-zA-Z]{0,61}[\\da-zA-Z])?)\\.?)";d.allowIP&&(l+="|"+q.ipAddress(d));d.allowLocal&&(l+="|localhost");
d.allowNamed&&(l+="|^[^-][a-zA-Z0-9_-]*");return"("+l+")"+k},url:function(d){d="object"==typeof d?d:{};"scheme"in d||(d.scheme=[!0,!1]);return l.buildGroupRE(d.scheme,function(d){return d?"(https?|ftps?)\\://":""})+q.host(d)+"(/(?:[^?#\\s/]+/)*(?:[^?#\\s/]+(?:\\?[^?#\\s/]*)?(?:#[A-Za-z][\\w.:-]*)?)?)?"},emailAddress:function(d){d="object"==typeof d?d:{};"boolean"!=typeof d.allowCruft&&(d.allowCruft=!1);d.allowPort=!1;var k="([!#-'*+\\-\\/-9\x3d?A-Z^-~]+[.])*[!#-'*+\\-\\/-9\x3d?A-Z^-~]+@"+q.host(d);
d.allowCruft&&(k="\x3c?(mailto\\:)?"+k+"\x3e?");return k},emailAddressList:function(d){d="object"==typeof d?d:{};"string"!=typeof d.listSeparator&&(d.listSeparator="\\s;,");var k=q.emailAddress(d);return"("+k+"\\s*["+d.listSeparator+"]\\s*)*"+k+"\\s*["+d.listSeparator+"]?\\s*"},numberFormat:function(d){d="object"==typeof d?d:{};"undefined"==typeof d.format&&(d.format="###-###-####");return l.buildGroupRE(d.format,function(d){return l.escapeString(d,"?").replace(/\?/g,"\\d?").replace(/#/g,"\\d")})},
ca:{postalCode:function(){return"([A-Z][0-9][A-Z] [0-9][A-Z][0-9])"},province:function(){return"(AB|BC|MB|NB|NL|NS|NT|NU|ON|PE|QC|SK|YT)"}},us:{state:function(d){d="object"==typeof d?d:{};"boolean"!=typeof d.allowTerritories&&(d.allowTerritories=!0);"boolean"!=typeof d.allowMilitary&&(d.allowMilitary=!0);var k="AL|AK|AZ|AR|CA|CO|CT|DE|DC|FL|GA|HI|ID|IL|IN|IA|KS|KY|LA|ME|MD|MA|MI|MN|MS|MO|MT|NE|NV|NH|NJ|NM|NY|NC|ND|OH|OK|OR|PA|RI|SC|SD|TN|TX|UT|VT|VA|WA|WV|WI|WY";d.allowTerritories&&(k+="|AS|FM|GU|MH|MP|PW|PR|VI");
d.allowMilitary&&(k+="|AA|AE|AP");return"("+k+")"}}}})},"builder/dijit/LinkItem":function(){define("dojo/_base/declare dojo/_base/lang dijit/_WidgetBase dijit/_TemplatedMixin dojo/on dojo/mouse dojo/dom-style dojo/Evented".split(" "),function(r,l,d,q,k,m,p,h){return r([d,q,h],{templateString:'\x3cdiv\x3e\x3cdiv class\x3d"label" data-dojo-attach-point\x3d"titleNode" title\x3d"${url}"\x3e${label}\x3c/div\x3e\x3cdiv class\x3d"action" data-dojo-attach-point\x3d"actionSection" style\x3d"display:none;"\x3e\x3cdiv class\x3d"btn delete-btn" data-dojo-attach-point\x3d"deleteBtn" title\x3d"${nls.deleteLink}"\x3e\x3c/div\x3e\x3cdiv class\x3d"btn edit-btn" data-dojo-attach-point\x3d"editBtn" title\x3d"${nls.editLink}"\x3e\x3c/div\x3e\x3c/div\x3e\x3c/div\x3e',
baseClass:"link-item",label:"",url:"",canEdit:!0,canDelete:!0,_tooltipTimeout:200,postCreate:function(){this.inherited(arguments);this.canDelete?(p.set(this.deleteBtn,"display","inline-block"),this.own(k(this.deleteBtn,"click",l.hitch(this,this._deleteLink)))):p.set(this.deleteBtn,"display","none");this.canEdit?(p.set(this.editBtn,"display","inline-block"),this.own(k(this.editBtn,"click",l.hitch(this,this._editLink)))):p.set(this.editBtn,"display","none");this.own(k(this.domNode,m.enter,l.hitch(this,
function(){p.set(this.actionSection,"display","")})));this.own(k(this.domNode,m.leave,l.hitch(this,function(){p.set(this.actionSection,"display","none")})))},update:function(d,c){this.label=d;this.url=c;this.titleNode.innerHTML=this.label;this.titleNode.title=this.url},_deleteLink:function(){this.emit("delete",this)},_editLink:function(){this.emit("edit",this)}})})},"builder/plugins/attribute-config/dataSource/AdditionalDataSources":function(){define("dojo/_base/declare dijit/_WidgetBase dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dojo/text!./AdditionalDataSources.html dojo/on dojo/mouse dojo/query dojo/topic dojo/_base/lang dojo/_base/html jimu/dijit/_QueryableLayerSourcePopup jimu/dijit/Message jimu/utils ./DataSourceConfigPopup ./utils builder/dijit/RefreshInterval dijit/form/Select dijit/form/ValidationTextBox".split(" "),
function(r,l,d,q,k,m,p,h,e,c,b,a,g,u,n,t,f){var v=p.enter,x=p.leave;return r([l,d,q],{templateString:k,baseClass:"additional-data-sources",_layerId:"",_serviceType:"",_targetSourceId:"",layerType:"Features",_sourceType:"",postMixInProperties:function(){this.nls=c.mixin(this.nls,window.jimuNls.common,window.builderNls)},postCreate:function(){this.inherited(arguments);this._initRefreshInterval();this._renderUIByConfig();this._initEvent();this.own(e.subscribe("app/appConfigChanged",c.hitch(this,this._onAppConfigChanged)))},
setMap:function(a){a&&(this.map=a)},_onAppConfigChanged:function(a){var c=u.isEqual(this.appConfig.dataSource,a.dataSource);this.appConfig&&!c&&(this.appConfig=a,b.empty(this.sourcesList),this._renderUIByConfig())},_initRefreshInterval:function(){this.refreshIntervalDijit=new f({defaultRefreshTip:this.nls.defaultRefreshTip_dataSource,singleRefreshTip:this.nls.singleRefreshTip_dataSource});this.refreshIntervalDijit.placeAt(this.refreshIntervalDiv)},_renderUIByConfig:function(){var a=c.clone(this.appConfig.dataSource),
d=a.dataSources,e;for(e in d)"widget"!==e.split("~")[0]&&this._addSourceTr(d[e]);a=a.settings||{};d={};"undefined"!==typeof a.unifiedRefreshInterval?(d.useWebMapRefreshInterval=!1,d.minutes=a.unifiedRefreshInterval):d.useWebMapRefreshInterval=!0;this.refreshIntervalDijit.setValue(d);this._isNotEmptySourceList()?(b.setStyle(this.refreshIntervalDiv,"display",""),b.setStyle(this.tabelHeader,"display",""),b.setStyle(this.noDataSourceTip,"display","none")):(b.setStyle(this.refreshIntervalDiv,"display",
"none"),b.setStyle(this.tabelHeader,"display","none"),b.setStyle(this.noDataSourceTip,"display",""))},_onAddNewClick:function(a){a.stopPropagation();b.hasClass(this.dsOptions,"hide")?this._showDsOption():this._hiddenDsOption()},_showDsOption:function(){b.removeClass(this.dsOptions,"hide")},_hiddenDsOption:function(){b.addClass(this.dsOptions,"hide")},_onAddNewLayerClick:function(a){a.stopPropagation();this._sourceType="Features";this._addNewSource()},_onAddNewStatisticsClick:function(a){a.stopPropagation();
this._sourceType="FeatureStatistics";this._addNewSource()},_addNewSource:function(){this._hiddenDsOption();var b=new a({titleLabel:this.nls.setDataSource,dijitArgs:{multiple:!1,createMapResponse:this.map.webMapResponse,mustSupportStatistics:"FeatureStatistics"===this._sourceType,portalUrl:this.appConfig.portalUrl,style:{height:"100%"}}});this.own(m(b,"ok",c.hitch(this,function(a){"FeatureStatistics"!==this._sourceType||this._isSupportStatistics(a.definition)?(this._setLayerId(a),a.label=a.name,this._serviceType=
b.getSelectedRadioType(),b.close(),b=null,this._createSourceConfigPopup(a,"add")):new g({message:this.nls.notSupportStatistics})})));this.own(m(b,"cancel",c.hitch(this,function(){b.close();b=null})))},_createSourceConfigPopup:function(a,b){c.mixin(a,{type:this._sourceType,serviceType:this._serviceType});this.sourceConfigPopup=new n({titleLabel:this.nls.configDataSource,dijitArgs:{nls:this.nls,map:this.map,config:a}});this.own(m(this.sourceConfigPopup,"ok",c.hitch(this,function(a){this.sourceConfigPopup.close();
this.sourceConfigPopup=null;"add"===b?this._addDataSourceToAppConfig(a):this._updateDataSourceOfAppConfig(a)})));this.own(m(this.sourceConfigPopup,"cancel",c.hitch(this,function(){this.sourceConfigPopup.close();this.sourceConfigPopup=null})))},_addDataSourceToAppConfig:function(a){a.id=this._generateSourceId();var b=c.clone(this.appConfig.dataSource);b.dataSources||(b.dataSources={});b.dataSources[a.id]=a;this._updateAppConfig(b)},_addSourceTr:function(a){this._sourceType=a.type;var c;"Features"===
this._sourceType?c=this.nls.layer:"FeatureStatistics"===this._sourceType&&(c=this.nls.statistics);c='\x3cdiv style\x3d"width: 100%;"\x3e\x3cdiv class\x3d"source-tr"\x3e\x3cdiv class\x3d"source-td source-tr-name textOverFlow" title\x3d"'+a.label+'"\x3e'+a.label+'\x3c/div\x3e\x3cdiv class\x3d"source-td source-tr-type textOverFlow" title\x3d"'+c+'"\x3e'+c+'\x3c/div\x3e\x3cdiv class\x3d"source-td source-tr-action"\x3e\x3cdiv class\x3d"edit hidden"\x3e\x3c/div\x3e\x3cdiv class\x3d"delete hidden"\x3e\x3c/div\x3e\x3c/div\x3e\x3c/div\x3e\x3cdiv class\x3d"mid-line"\x3e\x3c/div\x3e\x3c/div\x3e';
c=b.toDom(c);var d=h(".source-tr",c)[0];d.source=a;b.place(c,this.sourcesList,"last");this._bindTrEvent(d)},_bindTrEvent:function(a){this.own(m(a,["click",v,x],c.hitch(this,function(a){a.stopPropagation();var c=a.type;a=a.target||a.srcElement;var d=null;if("click"===c)b.hasClass(a,"edit")?(d=a.parentElement.parentElement,this._targetSourceId=d.source.id,this._editSourceTr(d)):b.hasClass(a,"delete")&&(d=a.parentElement.parentElement,this._targetSourceId=d.source.id,this._deleteSourceTr(d));else{var e=
null,f=null;b.hasClass(a,"edit")?(e=a,d=e.parentElement.parentElement):b.hasClass(a,"delete")?(f=a,d=f.parentElement.parentElement):b.hasClass(a,"source-tr")&&(d=a);if(e||f||d)"mouseover"===c?(b.removeClass(h(".source-td .edit",d)[0],"hidden"),b.removeClass(h(".source-td .delete",d)[0],"hidden")):"mouseout"===c&&(b.addClass(h(".source-td .edit",d)[0],"hidden"),b.addClass(h(".source-td .delete",d)[0],"hidden"))}})))},_editSourceTr:function(a){a=a.source;this._sourceType=a.type;var b={id:a.id,label:a.label,
url:a.url,filter:a.filter,filterByExtent:a.filterByExtent,isDynamic:a.isDynamic,resultRecordType:a.resultRecordType,refreshInterval:a.refreshInterval,dataSchema:a.dataSchema};"undefined"!==typeof a.resultRecordCount&&(b.resultRecordCount=a.resultRecordCount);this._createSourceConfigPopup(b)},_updateDataSourceOfAppConfig:function(a){a.id=this._targetSourceId;var b=c.clone(this.appConfig.dataSource),d;for(d in b.dataSources)d===this._targetSourceId&&(b.dataSources[d]=a);this._updateAppConfig(b)},_deleteSourceTr:function(){var a=
new g({message:this.nls.removeSourceMessage,buttons:[{label:this.nls.ok,onClick:c.hitch(this,function(){this._deleteDataSourceOfAppConfig();a.content=null;a.close()})},{label:this.nls.cancel,classNames:["jimu-btn-vacation"],onClick:c.hitch(this,function(){a.content=null;a.close()})}]})},_deleteDataSourceOfAppConfig:function(){var a=c.clone(this.appConfig.dataSource);delete a.dataSources[this._targetSourceId];this._updateAppConfig(a)},_updateDataSettingsOfAppConfig:function(){var a={},b=c.clone(this.appConfig.dataSource),
d=this.refreshIntervalDijit.getValue();"undefined"!==typeof d.minutes&&(a.unifiedRefreshInterval=d.minutes);b.settings=a;this._updateAppConfig(b)},_updateAppConfig:function(a){e.publish("dataSourceChanged",a)},_generateSourceId:function(){if(this._serviceType)return t.createDataSourceId(this._serviceType,this._layerId)},_setLayerId:function(a){a.layerInfo&&a.layerInfo.id&&(this._layerId=a.layerInfo.id)},_initEvent:function(){this.own(m(document.body,"click",c.hitch(this,function(){this._hiddenDsOption()})));
this.own(m(this.refreshIntervalDijit,"user-input-change",c.hitch(this,function(){this._isNotEmptySourceList()&&this._updateDataSettingsOfAppConfig()})));this.own(m(this.addNewDs,[v,x],c.hitch(this,function(a){a.stopPropagation();var c=a.type;h("div",this.addNewDs).forEach(function(a){b.hasClass(a,"img_add")?"mouseover"===c?b.addClass(a,"img_add_hover"):"mouseout"===c&&b.removeClass(a,"img_add_hover"):b.hasClass(a,"text_add")&&("mouseover"===c?b.addClass(a,"text_add_hover"):"mouseout"===c&&b.removeClass(a,
"text_add_hover"))}.bind(this))})))},_isNotEmptySourceList:function(){return 0<h(".source-tr",this.sourcesList).length},_isSupportStatistics:function(a){return a&&"object"===typeof a?a.advancedQueryCapabilities?!!a.advancedQueryCapabilities.supportsStatistics:!!a.supportsStatistics:!1},destroy:function(){this.refreshIntervalDijit&&this.refreshIntervalDijit.destroy();this.inherited(arguments)}})})},"jimu/dijit/_QueryableLayerSourcePopup":function(){define("dojo/on dojo/Evented dojo/_base/lang dojo/_base/html dojo/_base/declare jimu/dijit/Popup jimu/dijit/QueryableLayerSource jimu/dijit/LoadingIndicator esri/request".split(" "),
function(r,l,d,q,k,m,p,h,e){return k([m,l],{width:830,height:560,titleLabel:"",dijitArgs:null,postCreate:function(){this.inherited(arguments);q.addClass(this.domNode,"jimu-queryable-layer-source-popup");this._initFls();this._initLoading()},getSelectedRadioType:function(){return this.sourceDijit.getSelectedRadioType()},_initFls:function(){this.sourceDijit=new p(this.dijitArgs);this.sourceDijit.placeAt(this.contentContainerNode);this.sourceDijit.startup();this.own(r(this.sourceDijit,"ok",d.hitch(this,
function(c){if(0!==c.length){var b=c[0];if(b.definition)try{b.definition.name=b.name,b.definition.url=b.url,this.emit("ok",b)}catch(a){console.error(a)}else this.loading.show(),e({url:b.url,content:{f:"json"},handleAs:"json",callbackParamName:"callback"}).then(d.hitch(this,function(a){if(this.domNode){this.loading.hide();b.definition=a;try{b.definition.name=b.name,b.definition.url=b.url,this.emit("ok",b)}catch(g){console.error(g)}}}),d.hitch(this,function(a){console.error(a);this.domNode&&this.loading.hide()}))}})));
this.own(r(this.sourceDijit,"cancel",d.hitch(this,function(){try{this.emit("cancel")}catch(c){console.error(c)}})))},_initLoading:function(){this.loading=new h({hidden:!0});this.loading.placeAt(this.domNode);this.loading.startup()}})})},"jimu/dijit/QueryableLayerSource":function(){define("dojo/on dojo/Evented dojo/_base/lang dojo/_base/html dojo/_base/declare dijit/_WidgetBase dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dojo/text!./templates/QueryableLayerSource.html jimu/dijit/_QueryableLayerChooserWithButtons jimu/dijit/QueryableServiceChooserFromPortal jimu/dijit/_QueryableServiceChooserContent jimu/portalUrlUtils".split(" "),
function(r,l,d,q,k,m,p,h,e,c,b,a,g){return k([m,p,h,l],{templateString:e,baseClass:"jimu-layer-source jimu-queryable-layer-source",declaredClass:"jimu.dijit.QueryableLayerSource",nls:null,multiple:!1,createMapResponse:null,mustSupportStatistics:!1,portalUrl:null,postMixInProperties:function(){this.nls=window.jimuNls.queryableLayerSource;this.portalUrl=g.getStandardPortalUrl(this.portalUrl)},postCreate:function(){this.inherited(arguments);this._initSelf()},getSelectedRadioType:function(){if(this.mapRadio.checked)return"map";
if(this.portalRadio.checked)return"portal";if(this.urlRadio.checked)return"url"},getSelectedItems:function(){var a=[];this.mapRadio.checked?a=this.queryableLayerChooserFromMap.getSelectedItems():this.portalRadio.checked?a=this.queryableServiceChooserFromPortal.getSelectedItems():this.urlRadio.checked&&(a=this.queryableServiceChooserContent.getSelectedItems());return a},startup:function(){this.inherited(arguments);this.queryableLayerChooserFromMap.startup();this.queryableServiceChooserFromPortal.startup();
this.queryableServiceChooserContent.startup()},_initSelf:function(){this._initRadios();this._createQueryableLayerChooserWithButtons();this._createQueryableServiceChooserFromPortal();this._createQueryableServiceChooserContent();this._onRadioClicked()},_createQueryableLayerChooserWithButtons:function(){this.queryableLayerChooserFromMap=new c({style:{width:"100%",height:"100%"},multiple:this.multiple,createMapResponse:this.createMapResponse,mustSupportStatistics:this.mustSupportStatistics,onlyShowWebMapLayers:!0});
this.queryableLayerChooserFromMap.operationTip=this.nls.selectLayer;this.queryableLayerChooserFromMap.placeAt(this.mapDijitContainer);this.own(r(this.queryableLayerChooserFromMap,"ok",d.hitch(this,function(a){a&&0<a.length&&this.emit("ok",a)})));this.own(r(this.queryableLayerChooserFromMap,"cancel",d.hitch(this,function(){this.emit("cancel")})))},_createQueryableServiceChooserFromPortal:function(){this.queryableServiceChooserFromPortal=new b({multiple:this.multiple,portalUrl:this.portalUrl,style:{width:"100%",
height:"100%"}});this.queryableServiceChooserFromPortal.operationTip=this.nls.chooseItem;this.queryableServiceChooserFromPortal.placeAt(this.portalDijitContainer);this.own(r(this.queryableServiceChooserFromPortal,"next",d.hitch(this,function(){this.queryableServiceChooserFromPortal.operationTip=this.nls.chooseItem+" -\x3e "+this.nls.chooseLayer;this._updateOperationTip()})));this.own(r(this.queryableServiceChooserFromPortal,"back",d.hitch(this,function(){this.queryableServiceChooserFromPortal.operationTip=
this.nls.chooseItem;this._updateOperationTip()})));this.own(r(this.queryableServiceChooserFromPortal,"ok",d.hitch(this,function(a){a&&0<a.length&&this.emit("ok",a)})));this.own(r(this.queryableServiceChooserFromPortal,"cancel",d.hitch(this,function(){this.emit("cancel")})));0<=(this.portalUrl||"").toLowerCase().indexOf(".arcgis.com")?this.portalLabel.innerHTML=this.nls.selectFromOnline:this.portalLabel.innerHTML=this.nls.selectFromPortal},_createQueryableServiceChooserContent:function(){this.queryableServiceChooserContent=
new a({multiple:this.multiple,style:{width:"100%",height:"100%"}});this.queryableServiceChooserContent.operationTip=this.nls.setServiceUrl;this.queryableServiceChooserContent.placeAt(this.urlDijitContainer);this.own(r(this.queryableServiceChooserContent,"ok",d.hitch(this,function(a){a&&0<a.length&&this.emit("ok",a)})));this.own(r(this.queryableServiceChooserContent,"cancel",d.hitch(this,function(){this.emit("cancel")})))},_initRadios:function(){var a="queryableLayerSourceRadios_"+this._getRandomString();
this.mapRadio.name=a;q.setAttr(this.mapRadio,"id","mapRadio_"+this._getRandomString());q.setAttr(this.mapLabel,"for",this.mapRadio.id);this.portalRadio.name=a;q.setAttr(this.portalRadio,"id","portalRadio_"+this._getRandomString());q.setAttr(this.portalLabel,"for",this.portalRadio.id);this.urlRadio.name=a;q.setAttr(this.urlRadio,"id","urlRadio_"+this._getRandomString());q.setAttr(this.urlLabel,"for",this.urlRadio.id)},_getRandomString:function(){var a=Math.random().toString();return a=a.slice(2,a.length)},
_onRadioClicked:function(){q.setStyle(this.mapDijitContainer,"display","none");q.setStyle(this.portalDijitContainer,"display","none");q.setStyle(this.urlDijitContainer,"display","none");this.mapRadio.checked?(q.setStyle(this.mapDijitContainer,"display","block"),this.operationTip.innerHTML=this.nls.selectLayer):this.portalRadio.checked?(q.setStyle(this.portalDijitContainer,"display","block"),this.operationTip.innerHTML=this.nls.chooseItem):this.urlRadio.checked&&(q.setStyle(this.urlDijitContainer,
"display","block"),this.operationTip.innerHTML=this.nls.setServiceUrl);this._updateOperationTip()},_updateOperationTip:function(){this.mapRadio.checked?this.operationTip.innerHTML=this.queryableLayerChooserFromMap.operationTip:this.portalRadio.checked?this.operationTip.innerHTML=this.queryableServiceChooserFromPortal.operationTip:this.urlRadio.checked&&(this.operationTip.innerHTML=this.queryableServiceChooserContent.operationTip)}})})},"jimu/dijit/_QueryableLayerChooserWithButtons":function(){define("dojo/_base/declare dijit/_WidgetBase dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dojo/_base/lang dojo/_base/html dojo/on dojo/Evented jimu/dijit/QueryableLayerChooserFromMap".split(" "),
function(r,l,d,q,k,m,p,h,e){return r([l,d,q,h],{baseClass:"jimu-layer-chooser-with-buttons jimu-queryable-layer-chooser-with-buttons",declaredClass:"jimu.dijit.QueryableLayerChooserWithButtons",templateString:'\x3cdiv\x3e\x3cdiv class\x3d"chooser-container" data-dojo-attach-point\x3d"chooserContainer"\x3e\x3c/div\x3e\x3cdiv class\x3d"footer"\x3e\x3cdiv class\x3d"jimu-btn jimu-float-trailing cancel jimu-btn-vacation" data-dojo-attach-point\x3d"btnCancel"\x3e${nls.cancel}\x3c/div\x3e\x3cdiv class\x3d"jimu-btn jimu-float-trailing ok jimu-trailing-margin1 jimu-state-disabled" data-dojo-attach-point\x3d"btnOk"\x3e${nls.ok}\x3c/div\x3e\x3c/div\x3e\x3c/div\x3e',
constructor:function(c){this.options=c},postMixInProperties:function(){this.nls=k.clone(window.jimuNls.common)},postCreate:function(){this.inherited(arguments);this.queryableLayerChooserFromMap=new e(this.options);this.queryableLayerChooserFromMap.placeAt(this.chooserContainer);m.setStyle(this.queryableLayerChooserFromMap.domNode,{width:"100%",height:"100%"});this.own(p(this.queryableLayerChooserFromMap,"tree-click",k.hitch(this,function(){0<this.getSelectedItems().length?m.removeClass(this.btnOk,
"jimu-state-disabled"):m.addClass(this.btnOk,"jimu-state-disabled")})));this.own(p(this.btnOk,"click",k.hitch(this,function(){var c=this.getSelectedItems();0<c.length&&this.emit("ok",c)})));this.own(p(this.btnCancel,"click",k.hitch(this,function(){this.emit("cancel")})))},getSelectedItems:function(){return this.queryableLayerChooserFromMap.getSelectedItems()},startup:function(){this.inherited(arguments);this.queryableLayerChooserFromMap.startup()}})})},"jimu/dijit/QueryableLayerChooserFromMap":function(){define(["dojo/_base/lang",
"dojo/_base/html","dojo/_base/declare","./LayerChooserFromMap"],function(r,l,d,q){return d([q],{baseClass:"jimu-queryable-layer-chooser-from-map",declaredClass:"jimu.dijit.QueryableLayerChooserFromMap",showImageLayer:!0,mustSupportStatistics:!1,ignoreVirtualLayer:!1,postMixInProperties:function(){this.inherited(arguments);this.filter=this.showImageLayer?q.createQueryableLayerFilter(this.mustSupportStatistics):q.createFeaturelayerFilter(["point","polyline","polygon"],!1,!0,this.mustSupportStatistics);
this.ignoreVirtualLayer&&(this.filter=q.andCombineFilters([this.filter,r.hitch(this,this._ignoreVirtualLayerFilter)]))},_ignoreVirtualLayerFilter:function(d){return d.getLayerType().then(function(d){return!("ArcGISDynamicMapServiceLayer"===d||"ArcGISTiledMapServiceLayer"===d||"GroupLayer"===d)})},postCreate:function(){this.inherited(arguments);l.addClass(this.domNode,"jimu-basic-layer-chooser-from-map")},getHandledItem:function(d){var k=this.inherited(arguments),l=d&&d.layerInfo,l=l&&l.layerObject;
k.url=l&&l.url||"";return k}})})},"jimu/dijit/LayerChooserFromMap":function(){define("dojo/on dojo/Evented dojo/_base/declare dijit/_WidgetBase dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dojo/store/Memory dojo/Deferred dojo/store/Observable dijit/tree/ObjectStoreModel dojo/promise/all dojo/_base/lang dojo/_base/html dojo/_base/array jimu/utils jimu/dijit/_Tree jimu/LayerInfos/LayerInfos jimu/dijit/LoadingIndicator".split(" "),function(r,l,d,q,k,m,p,h,e,c,b,a,g,u,n,t,f,v){var x=d([q,k,m,l],
{templateString:'\x3cdiv style\x3d"width:100%;"\x3e\x3cdiv data-dojo-attach-point\x3d"errorTipSection" class\x3d"error-tip-section"\x3e\x3cspan class\x3d"jimu-icon jimu-icon-error"\x3e\x3c/span\x3e\x3cspan class\x3d"jimu-state-error-text" data-dojo-attach-point\x3d"errTip"\x3e${nls.noLayersTip}\x3c/span\x3e\x3c/div\x3e\x3c/div\x3e',_store:null,_id:0,_treeClass:"layer-chooser-tree",createMapResponse:null,multiple:!1,onlyShowVisible:!1,updateWhenLayerInfosIsShowInMapChanged:!1,onlyShowWebMapLayers:!1,
postMixInProperties:function(){this.nls=window.jimuNls.basicLayerChooserFromMap},postCreate:function(){this.inherited(arguments);g.addClass(this.domNode,"jimu-basic-layer-chooser-from-map");this.multiple=!!this.multiple;this.shelter=new v({hidden:!0});this.shelter.placeAt(this.domNode);this.shelter.startup();this._createTree();this.basicFilter=a.hitch(this,this.basicFilter);this.filter=x.andCombineFilters([this.basicFilter,this.filter]);this.createMapResponse&&this.setCreateMapResponse(this.createMapResponse)},
basicFilter:function(a){var b=new h;this.onlyShowVisible?b.resolve(a.isShowInMap()):b.resolve(!0);return b},filter:function(a){a=new h;a.resolve(!0);return a},getSelectedItems:function(){var b=this.tree.getSelectedItems();return u.map(b,a.hitch(this,function(a){return this.getHandledItem(a)}))},getAllItems:function(){var b=this.tree.getAllItems(),c=[];u.forEach(b,a.hitch(this,function(a){"root"!==a.id&&(a=this.getHandledItem(a),c.push(a))}));return c},getHandledItem:function(a){return{name:a.name,
layerInfo:a.layerInfo}},_isLeafItem:function(a){return a.isLeaf},setCreateMapResponse:function(b){this.createMapResponse=b;f.getInstance(this.createMapResponse.map,this.createMapResponse.itemInfo).then(a.hitch(this,function(b){this.layerInfosObj=b;this.own(r(this.layerInfosObj,"layerInfosChanged",a.hitch(this,this._onLayerInfosChanged)));this.updateWhenLayerInfosIsShowInMapChanged&&this.own(r(this.layerInfosObj,"layerInfosIsShowInMapChanged",a.hitch(this,this._onLayerInfosIsShowInMapChanged)));this._buildTree(this.layerInfosObj)}))},
_onLayerInfosChanged:function(a,b){this._buildTree(this.layerInfosObj);this.emit("update")},_onLayerInfosIsShowInMapChanged:function(a){this._buildTree(this.layerInfosObj);this.emit("update")},_buildTree:function(b){this._clear();g.setStyle(this.errorTipSection,"display","block");var c=[];this.onlyShowWebMapLayers?(c=b.getLayerInfoArrayOfWebmap(),c=c.concat(b.getTableInfoArrayOfWebmap())):(c=b.getLayerInfoArray(),c=c.concat(b.getTableInfoArray()));0!==c.length&&(g.setStyle(this.errorTipSection,"display",
"none"),u.forEach(c,a.hitch(this,function(a){this._addDirectLayerInfo(a)})))},_addDirectLayerInfo:function(b){b&&b.getLayerObject().then(a.hitch(this,function(){this._addItem("root",b)}),a.hitch(this,function(a){console.error(a)}))},_clear:function(){var b=this._store.query({parent:"root"});u.forEach(b,a.hitch(this,function(a){a&&"root"!==a.id&&this._store.remove(a.id)}))},_addItem:function(c,d){var e=null,f=d.getLayerType(),g=this.filter(d);b({layerType:f,valid:g}).then(a.hitch(this,function(f){if(f.valid){var g=
a.hitch(this,function(a,b){this._id++;e={name:d.title||"",parent:c,layerInfo:d,type:f.layerType,layerClass:d.layerObject.declaredClass,id:this._id.toString(),isLeaf:a,hasChildren:b};this._store.add(e)}),h=d.getSubLayers(),k=0===h.length;k?g(k,!1):(h=u.map(h,a.hitch(this,function(a){return this.filter(a)})),b(h).then(a.hitch(this,function(a){(a=u.some(a,function(a){return a}))&&g(k,a)})))}}))},_getRootItem:function(){return{id:"root",name:"Map Root",type:"root",isLeaf:!1,hasChildren:!0}},_createTree:function(){var b=
this._getRootItem(),b=new p({data:[b],getChildren:function(a){return this.query({parent:a.id})}});this._store=new e(b);b=new c({store:this._store,query:{id:"root"},mayHaveChildren:a.hitch(this,this._mayHaveChildren)});this.tree=new t({multiple:this.multiple,model:b,showRoot:!1,isLeafItem:a.hitch(this,this._isLeafItem),style:{width:"100%"},onOpen:a.hitch(this,function(a,b){"root"!==a.id&&this._onTreeOpen(a,b)}),onClick:a.hitch(this,function(a,b,c){this._onTreeClick(a,b,c);this.emit("tree-click",a,
b,c)}),getIconStyle:a.hitch(this,function(a,b){var c=null;if(!a||"root"===a.id)return null;var d={width:"20px",height:"20px",backgroundRepeat:"no-repeat",backgroundPosition:"center center",backgroundImage:""},e=window.location.protocol+"//"+window.location.host+require.toUrl("jimu"),f=this._getIconImageName(a,b);f&&(d.backgroundImage="url("+e+"/css/images/"+f+")",c=d);return c})});g.addClass(this.tree.domNode,this._treeClass);this.tree.placeAt(this.shelter.domNode,"before")},_mayHaveChildren:function(a){return a.hasChildren},
_getIconImageName:function(a,b){var c="";if("ArcGISDynamicMapServiceLayer"===a.type||"ArcGISTiledMapServiceLayer"===a.type)c=b?"mapserver_open.png":"mapserver_close.png";else if("GroupLayer"===a.type)c=b?"group_layer2.png":"group_layer1.png";else if("FeatureLayer"===a.type){var d=n.getTypeByGeometryType(a.layerInfo.layerObject.geometryType);"point"===d?c="point_layer1.png":"polyline"===d?c="line_layer1.png":"polygon"===d&&(c="polygon_layer1.png")}else c="Table"===a.type?"table.png":"ArcGISImageServiceLayer"===
a.type||"ArcGISImageServiceVectorLayer"===a.type?"image_layer.png":b?"mapserver_open.png":"mapserver_close.png";return c},_onTreeOpen:function(c,d){if("root"!==c.id){var e=[],f=[],e=c.layerInfo.getSubLayers();c.checked||(this.shelter.show(),f=u.map(e,a.hitch(this,function(a){return a.getLayerObject()})),b(f).then(a.hitch(this,function(){this.domNode&&(u.forEach(e,a.hitch(this,function(a){this._addItem(c.id,a)})),c.checked=!0,this.shelter.hide())}),a.hitch(this,function(a){console.error(a);this.shelter.hide()})))}},
_onTreeClick:function(a,b,c){},destroy:function(){this.shelter&&this.shelter.destroy();this.tree&&this.tree.destroy();this.shelter=null;this.tree.destroy();this.inherited(arguments)}});x.createFilterByLayerType=function(c){a.isArrayLike(c)||(c=[]);return function(a){var d=new h;if(0===c.length)d.resolve(!0);else{var e=[];a.traversal(function(a){e.push(a.getLayerType())});b(e).then(function(a){for(var b=0;b<a.length;b++)for(var e=0;e<c.length;e++)if(a[b]===c[e]){d.resolve(!0);return}d.resolve(!1)},
function(a){console.error(a);d.reject(a)})}return d}};x.createFeaturelayerFilter=function(a,c,d,e){var f=["point","polyline","polygon"];a&&0<a.length?(a=u.filter(a,function(a){return 0<=f.indexOf(a)}),0===a.length&&(a=f)):a=f;return function(f){var g=f.getLayerType();f=f.getLayerObject();return b({layerType:g,layerObject:f}).then(function(b){var f=b.layerType;b=b.layerObject;if("ArcGISDynamicMapServiceLayer"===f||"ArcGISTiledMapServiceLayer"===f||"GroupLayer"===f||"FeatureCollection"===f)return!0;
if("FeatureLayer"===f){var f=n.getTypeByGeometryType(b.geometryType),f=0<=u.indexOf(a,f),g=x._shouldPassStatisticsCheck(e,b);return b.url?(b=n.isFeaturelayerUrlSupportQuery(b.url,b.capabilities),f&&b&&g):c&&f}return"Table"===f?(f=n.isFeaturelayerUrlSupportQuery(b.url,b.capabilities),b=x._shouldPassStatisticsCheck(e,b),d&&f&&b):!1})}};x.createImageServiceLayerFilter=function(a,c){return function(d){var e=d.getLayerType();d=d.getLayerObject();return b({layerType:e,layerObject:d}).then(function(b){var d=
b.layerType,e=b.layerObject;return"ArcGISImageServiceLayer"===d||"ArcGISImageServiceVectorLayer"===d?a?n.isImageServiceSupportQuery(b.layerObject.capabilities)?c?x._shouldPassStatisticsCheck(c,e):!0:!1:!0:!1})}};x._shouldPassStatisticsCheck=function(a,b){if(a){var c=!1;return c=b.advancedQueryCapabilities?!!b.advancedQueryCapabilities.supportsStatistics:!!b.supportsStatistics}return!0};x.createQueryableLayerFilter=function(a){var b=x.createFeaturelayerFilter(["point","polyline","polygon"],!1,!0,a);
a=x.createImageServiceLayerFilter(!0,a);return x.orCombineFilters([b,a])};x.andCombineFilters=function(a){return x._combineFilters(a,!0)};x.orCombineFilters=function(a){return x._combineFilters(a,!1)};x._combineFilters=function(a,c){return function(d){var e=new h,f=u.map(a,function(a){return a(d)});b(f).then(function(a){var b=!1,b=c?u.every(a,function(a){return a}):u.some(a,function(a){return a});e.resolve(b)},function(a){console.error(a);e.reject(a)});return e}};return x})},"dojo/store/Observable":function(){define(["../_base/kernel",
"../_base/lang","../when","../_base/array"],function(r,l,d,q){r=function(k){function m(b,a){var e=k[b];e&&(k[b]=function(g){var h;"put"===b&&(h=k.getIdentity(g));if(c)return e.apply(this,arguments);c=!0;try{var l=e.apply(this,arguments);d(l,function(b){a("object"==typeof b&&b||g,h)});return l}finally{c=!1}})}var p=[],h=0;k=l.delegate(k);k.notify=function(b,a){h++;for(var c=p.slice(),d=0,e=c.length;d<e;d++)c[d](b,a)};var e=k.query;k.query=function(b,a){a=a||{};var c=e.apply(this,arguments);if(c&&c.forEach){var m=
l.mixin({},a);delete m.start;delete m.count;var n=k.queryEngine&&k.queryEngine(b,m),t=h,f=[],r;c.observe=function(b,e){1==f.push(b)&&p.push(r=function(b,g){d(c,function(c){var d=c.length!=a.count,l,m;if(++t!=h)throw Error("Query is out of date, you must observe() the query prior to any data modifications");var p,r=-1,u=-1;if(void 0!==g){var v=[].concat(c);n&&!b&&(v=n(c));l=0;for(m=c.length;l<m;l++){var w=c[l];if(k.getIdentity(w)==g&&!(0>v.indexOf(w))){p=w;r=l;!n&&b||c.splice(l,1);break}}}n?b&&(n.matches?
n.matches(b):n([b]).length)&&(l=-1<r?r:c.length,c.splice(l,0,b),u=q.indexOf(n(c),b),c.splice(l,1),a.start&&0==u||!d&&u==c.length?u=-1:c.splice(u,0,b)):b&&(void 0!==g?u=r:a.start||(u=k.defaultIndex||0,c.splice(u,0,b)));if((-1<r||-1<u)&&(e||!n||r!=u))for(d=f.slice(),l=0;c=d[l];l++)c(b||p,r,u)})});var g={};g.remove=g.cancel=function(){var a=q.indexOf(f,b);-1<a&&(f.splice(a,1),f.length||p.splice(q.indexOf(p,r),1))};return g}}return c};var c;m("put",function(b,a){k.notify(b,a)});m("add",function(b){k.notify(b)});
m("remove",function(b){k.notify(void 0,b)});return k};l.setObject("dojo.store.Observable",r);return r})},"dijit/tree/ObjectStoreModel":function(){define("dojo/_base/array dojo/aspect dojo/_base/declare dojo/Deferred dojo/_base/lang dojo/when ../Destroyable".split(" "),function(r,l,d,q,k,m,p){return d("dijit.tree.ObjectStoreModel",p,{store:null,labelAttr:"name",labelType:"text",root:null,query:null,constructor:function(d){k.mixin(this,d);this.childrenCache={}},getRoot:function(d,e){if(this.root)d(this.root);
else{var c=this.store.query(this.query);c.then&&this.own(c);m(c,k.hitch(this,function(b){if(1!=b.length)throw Error("dijit.tree.ObjectStoreModel: root query returned "+b.length+" items, but must return exactly one");this.root=b[0];d(this.root);c.observe&&c.observe(k.hitch(this,function(a){this.onChange(a)}),!0)}),e)}},mayHaveChildren:function(){return!0},getChildren:function(d,e,c){var b=this.store.getIdentity(d);if(this.childrenCache[b])m(this.childrenCache[b],e,c);else{var a=this.childrenCache[b]=
this.store.getChildren(d);a.then&&this.own(a);a.observe&&this.own(a.observe(k.hitch(this,function(b,c,e){this.onChange(b);c!=e&&m(a,k.hitch(this,"onChildrenChange",d))}),!0));m(a,e,c)}},isItem:function(){return!0},getIdentity:function(d){return this.store.getIdentity(d)},getLabel:function(d){return d[this.labelAttr]},newItem:function(d,e,c,b){return this.store.put(d,{parent:e,before:b})},pasteItem:function(d,e,c,b,a,g){var h=new q;if(e===c&&!b&&!g)return h.resolve(!0),h;e&&!b?this.getChildren(e,k.hitch(this,
function(a){a=[].concat(a);var b=r.indexOf(a,d);a.splice(b,1);this.onChildrenChange(e,a);h.resolve(this.store.put(d,{overwrite:!0,parent:c,oldParent:e,before:g}))})):h.resolve(this.store.put(d,{overwrite:!0,parent:c,oldParent:e,before:g}));return h},onChange:function(){},onChildrenChange:function(){},onDelete:function(){}})})},"jimu/dijit/_Tree":function(){define("dojo/_base/declare dijit/_WidgetBase dijit/_TemplatedMixin dojo/text!./templates/_TreeNode.html dojo/_base/lang dojo/_base/html dojo/_base/array dojo/_base/event dojo/query dojo/aspect dojo/on dojo/Evented dijit/registry dijit/Tree jimu/utils".split(" "),
function(r,l,d,q,k,m,p,h,e,c,b,a,g,u,n){var t=r([u._TreeNode,a],{templateString:q,declaredClass:"jimu._TreeNode",isLeaf:!1,groupId:"",postCreate:function(){this.inherited(arguments);m.addClass(this.domNode,"jimu-tree-node");this.isLeaf=!!this.isLeaf;this.groupId?(this.checkNode=m.toDom('\x3cinput type\x3d"radio" /\x3e'),this.checkNode.name=this.groupId):this.checkNode=m.toDom('\x3cinput type\x3d"checkbox" /\x3e');m.addClass(this.checkNode,"jimu-tree-check-node");m.place(this.checkNode,this.contentNode,
"first");this.own(b(this.checkNode,"click",k.hitch(this,this._onClick)));this.isLeaf?this.groupId?m.setStyle(this.checkNode,"display","none"):m.setStyle(this.checkNode,"display","inline"):m.setStyle(this.checkNode,"display","none");this.isLeaf?m.addClass(this.domNode,"jimu-tree-leaf-node"):m.addClass(this.domNode,"jimu-tree-not-leaf-node")},select:function(){this.isLeaf&&(this.checkNode.checked=!0,m.addClass(this.domNode,"jimu-tree-selected-leaf-node"))},unselect:function(){this.isLeaf&&(this.checkNode.checked=
!1,m.removeClass(this.domNode,"jimu-tree-selected-leaf-node"))},toggleSelect:function(){this.isLeaf&&(this.checkNode.checked?this.unselect():this.select())},_onClick:function(a){(a.target||a.srcElement)===this.checkNode?this.tree._onCheckNodeClick(this,this.checkNode.checked,a):this.tree._onClick(this,a)},_onChange:function(){this.isLeaf&&setTimeout(k.hitch(this,function(){this.checkNode.checked?this.emit("tn-select",this):this.emit("tn-unselect",this)}),100)},destroy:function(){delete this.tree;
this.inherited(arguments)}});return r([u,a],{declaredClass:"jimu._Tree",openOnClick:!0,multiple:!0,uniqueId:"",showRoot:!1,postMixInProperties:function(){this.inherited(arguments);this.uniqueId="tree_"+n.getRandomString()},postCreate:function(){this.inherited(arguments);m.addClass(this.domNode,"jimu-tree");this.own(c.before(this,"onClick",k.hitch(this,this._jimuBeforeClick)));this.rootLoadingIndicator&&m.setStyle(this.rootLoadingIndicator,"display","none");this.dndController.singular=!0},removeItem:function(a){this.model.store.remove(a)},
getAllItems:function(){var a=this.getAllTreeNodeWidgets();return p.map(a,k.hitch(this,function(a){var b=a.item;b.selected=a.checkNode.checked;return b}))},getSelectedItems:function(){var a=this.getAllTreeNodeWidgets(),a=p.filter(a,k.hitch(this,function(a){return a.checkNode.checked}));return p.map(a,k.hitch(this,function(a){return a.item}))},getFilteredItems:function(a){var b=this.getAllTreeNodeWidgets(),b=p.map(b,k.hitch(this,function(a){var b=a.item;b.selected=a.checkNode.checked;return b}));return p.filter(b,
k.hitch(this,function(b){return a(b)}))},getTreeNodeByItemId:function(a){for(var b=this._getAllTreeNodeDoms(),c=0;c<b.length;c++){var d=g.byNode(b[c]);if(d.item.id.toString()===a.toString())return d}return null},selectItem:function(a){(a=this.getTreeNodeByItemId(a))&&a.isLeaf&&this.selectNodeWidget(a)},unselectItem:function(a){(a=this.getTreeNodeByItemId(a))&&a.isLeaf&&a.unselect()},getAllLeafTreeNodeWidgets:function(){var a=this.getAllTreeNodeWidgets();return p.filter(a,k.hitch(this,function(a){return a.isLeaf}))},
getAllTreeNodeWidgets:function(){var a=this._getAllTreeNodeDoms();return p.map(a,k.hitch(this,function(a){return g.byNode(a)}))},isLeafItem:function(a){return a&&a.isLeaf},_getAllTreeNodeDoms:function(){return e(".dijitTreeNode",this.domNode)},_createTreeNode:function(a){a.isLeaf=this.isLeafItem(a.item);this.multiple||(a.groupId=this.uniqueId);return new t(a)},_onTreeNodeSelect:function(a){this.emit("item-select",{item:a.item,treeNode:a})},_onTreeNodeUnselect:function(a){this.emit("item-unselect",
{item:a.item,treeNode:a})},selectNodeWidget:function(a){this.multiple||this.unselectAllLeafNodeWidgets();a.select()},_jimuBeforeClick:function(a,b,c){b.isLeaf&&(m.hasClass(c.target||c.srcElement,"jimu-tree-check-node")||(this.multiple?b.toggleSelect():this.selectNodeWidget(b)));return arguments},_onCheckNodeClick:function(a,b,c){!this.multiple&&b&&this.unselectAllLeafNodeWidgets();h.stop(c);this.focusNode(a);setTimeout(k.hitch(this,function(){b?this.selectNodeWidget(a):a.unselect();this.onClick(a.item,
a,c)}),0)},unselectAllLeafNodeWidgets:function(){var a=this.getAllLeafTreeNodeWidgets();p.forEach(a,k.hitch(this,function(a){a.unselect()}))}})})},"dijit/Tree":function(){define("dojo/_base/array dojo/aspect dojo/cookie dojo/_base/declare dojo/Deferred dojo/promise/all dojo/dom dojo/dom-class dojo/dom-geometry dojo/dom-style dojo/errors/create dojo/fx dojo/has dojo/_base/kernel dojo/keys dojo/_base/lang dojo/on dojo/topic dojo/touch dojo/when ./a11yclick ./focus ./registry ./_base/manager ./_Widget ./_TemplatedMixin ./_Container ./_Contained ./_CssStateMixin ./_KeyNavMixin dojo/text!./templates/TreeNode.html dojo/text!./templates/Tree.html ./tree/TreeStoreModel ./tree/ForestStoreModel ./tree/_dndSelector dojo/query!css2".split(" "),
function(r,l,d,q,k,m,p,h,e,c,b,a,g,u,n,t,f,v,x,w,z,A,y,B,C,E,D,F,G,J,N,M,L,K,W){function R(a){return t.delegate(a.promise||a,{addCallback:function(a){this.then(a)},addErrback:function(a){this.otherwise(a)}})}var ba=q("dijit._TreeNode",[C,E,D,F,G],{item:null,isTreeNode:!0,label:"",_setLabelAttr:function(a){this.labelNode["html"==this.labelType?"innerHTML":"innerText"in this.labelNode?"innerText":"textContent"]=a;this._set("label",a);g("dojo-bidi")&&this.applyTextDir(this.labelNode)},labelType:"text",
isExpandable:null,isExpanded:!1,state:"NotLoaded",templateString:N,baseClass:"dijitTreeNode",cssStateNodes:{rowNode:"dijitTreeRow"},_setTooltipAttr:{node:"rowNode",type:"attribute",attribute:"title"},buildRendering:function(){this.inherited(arguments);this._setExpando();this._updateItemClasses(this.item);this.isExpandable&&this.labelNode.setAttribute("aria-expanded",this.isExpanded);this.setSelected(!1)},_setIndentAttr:function(a){var b=Math.max(a,0)*this.tree._nodePixelIndent+"px";c.set(this.domNode,
"backgroundPosition",b+" 0px");c.set(this.rowNode,this.isLeftToRight()?"paddingLeft":"paddingRight",b);r.forEach(this.getChildren(),function(b){b.set("indent",a+1)});this._set("indent",a)},markProcessing:function(){this.state="Loading";this._setExpando(!0)},unmarkProcessing:function(){this._setExpando(!1)},_updateItemClasses:function(a){var b=this.tree,c=b.model;b._v10Compat&&a===c.root&&(a=null);this._applyClassAndStyle(a,"icon","Icon");this._applyClassAndStyle(a,"label","Label");this._applyClassAndStyle(a,
"row","Row");this.tree._startPaint(!0)},_applyClassAndStyle:function(a,b,d){var e="_"+b+"Class";b+="Node";var f=this[e];this[e]=this.tree["get"+d+"Class"](a,this.isExpanded);h.replace(this[b],this[e]||"",f||"");c.set(this[b],this.tree["get"+d+"Style"](a,this.isExpanded)||{})},_updateLayout:function(){var a=this.getParent(),a=!a||!a.rowNode||"none"==a.rowNode.style.display;h.toggle(this.domNode,"dijitTreeIsRoot",a);h.toggle(this.domNode,"dijitTreeIsLast",!a&&!this.getNextSibling())},_setExpando:function(a){var b=
["dijitTreeExpandoLoading","dijitTreeExpandoOpened","dijitTreeExpandoClosed","dijitTreeExpandoLeaf"];a=a?0:this.isExpandable?this.isExpanded?1:2:3;h.replace(this.expandoNode,b[a],b);this.expandoNodeText.innerHTML=["*","-","+","*"][a]},expand:function(){if(this._expandDeferred)return R(this._expandDeferred);this._collapseDeferred&&(this._collapseDeferred.cancel(),delete this._collapseDeferred);this.isExpanded=!0;this.labelNode.setAttribute("aria-expanded","true");(this.tree.showRoot||this!==this.tree.rootNode)&&
this.containerNode.setAttribute("role","group");h.add(this.contentNode,"dijitTreeContentExpanded");this._setExpando();this._updateItemClasses(this.item);this==this.tree.rootNode&&this.tree.showRoot&&this.tree.domNode.setAttribute("aria-expanded","true");var b=a.wipeIn({node:this.containerNode,duration:B.defaultDuration}),c=this._expandDeferred=new k(function(){b.stop()});l.after(b,"onEnd",function(){c.resolve(!0)},!0);b.play();return R(c)},collapse:function(){if(this._collapseDeferred)return R(this._collapseDeferred);
this._expandDeferred&&(this._expandDeferred.cancel(),delete this._expandDeferred);this.isExpanded=!1;this.labelNode.setAttribute("aria-expanded","false");this==this.tree.rootNode&&this.tree.showRoot&&this.tree.domNode.setAttribute("aria-expanded","false");h.remove(this.contentNode,"dijitTreeContentExpanded");this._setExpando();this._updateItemClasses(this.item);var b=a.wipeOut({node:this.containerNode,duration:B.defaultDuration}),c=this._collapseDeferred=new k(function(){b.stop()});l.after(b,"onEnd",
function(){c.resolve(!0)},!0);b.play();return R(c)},indent:0,setChildItems:function(a){var b=this.tree,c=b.model,d=[],e=b.focusedChild,f=this.getChildren();r.forEach(f,function(a){D.prototype.removeChild.call(this,a)},this);this.defer(function(){r.forEach(f,function(a){if(!a._destroyed&&!a.getParent()){var d=function(a){var e=c.getIdentity(a.item),f=b._itemNodesMap[e];1==f.length?delete b._itemNodesMap[e]:(e=r.indexOf(f,a),-1!=e&&f.splice(e,1));r.forEach(a.getChildren(),d)};b.dndController.removeTreeNode(a);
d(a);if(b.persist){var f=r.map(a.getTreePath(),function(a){return b.model.getIdentity(a)}).join("/"),g;for(g in b._openedNodes)g.substr(0,f.length)==f&&delete b._openedNodes[g];b._saveExpandedNodes()}b.lastFocusedChild&&!p.isDescendant(b.lastFocusedChild.domNode,b.domNode)&&delete b.lastFocusedChild;e&&!p.isDescendant(e.domNode,b.domNode)&&b.focus();a.destroyRecursive()}})});this.state="Loaded";a&&0<a.length?(this.isExpandable=!0,r.forEach(a,function(a){var e=c.getIdentity(a),f=b._itemNodesMap[e],
g;if(f)for(var h=0;h<f.length;h++)if(f[h]&&!f[h].getParent()){g=f[h];g.set("indent",this.indent+1);break}g||(g=this.tree._createTreeNode({item:a,tree:b,isExpandable:c.mayHaveChildren(a),label:b.getLabel(a),labelType:b.model&&b.model.labelType||"text",tooltip:b.getTooltip(a),ownerDocument:b.ownerDocument,dir:b.dir,lang:b.lang,textDir:b.textDir,indent:this.indent+1}),f?f.push(g):b._itemNodesMap[e]=[g]);this.addChild(g);(this.tree.autoExpand||this.tree._state(g))&&d.push(b._expandNode(g))},this),r.forEach(this.getChildren(),
function(a){a._updateLayout()})):this.isExpandable=!1;this._setExpando&&this._setExpando(!1);this._updateItemClasses(this.item);a=m(d);this.tree._startPaint(a);return R(a)},getTreePath:function(){for(var a=this,b=[];a&&a!==this.tree.rootNode;)b.unshift(a.item),a=a.getParent();b.unshift(this.tree.rootNode.item);return b},getIdentity:function(){return this.tree.model.getIdentity(this.item)},removeChild:function(a){this.inherited(arguments);var b=this.getChildren();0==b.length&&(this.isExpandable=!1,
this.collapse());r.forEach(b,function(a){a._updateLayout()})},makeExpandable:function(){this.isExpandable=!0;this._setExpando(!1)},setSelected:function(a){this.labelNode.setAttribute("aria-selected",a?"true":"false");h.toggle(this.rowNode,"dijitTreeRowSelected",a)},focus:function(){A.focus(this.focusNode)}});g("dojo-bidi")&&ba.extend({_setTextDirAttr:function(a){!a||this.textDir==a&&this._created||(this._set("textDir",a),this.applyTextDir(this.labelNode),r.forEach(this.getChildren(),function(b){b.set("textDir",
a)},this))}});var O=q("dijit.Tree",[C,J,E,G],{baseClass:"dijitTree",store:null,model:null,query:null,label:"",showRoot:!0,childrenAttr:["children"],paths:[],path:[],selectedItems:null,selectedItem:null,openOnClick:!1,openOnDblClick:!1,templateString:M,persist:!1,autoExpand:!1,dndController:W,dndParams:"onDndDrop itemCreator onDndCancel checkAcceptance checkItemAcceptance dragThreshold betweenThreshold".split(" "),onDndDrop:null,itemCreator:null,onDndCancel:null,checkAcceptance:null,checkItemAcceptance:null,
dragThreshold:5,betweenThreshold:0,_nodePixelIndent:19,_publish:function(a,b){v.publish(this.id,t.mixin({tree:this,event:a},b||{}))},postMixInProperties:function(){this.tree=this;this.autoExpand&&(this.persist=!1);this._itemNodesMap={};!this.cookieName&&this.id&&(this.cookieName=this.id+"SaveStateCookie");this.expandChildrenDeferred=new k;this.pendingCommandsPromise=this.expandChildrenDeferred.promise;this.inherited(arguments)},postCreate:function(){this._initState();var a=this;this.own(f(this.containerNode,
f.selector(".dijitTreeNode",x.enter),function(b){a._onNodeMouseEnter(y.byNode(this),b)}),f(this.containerNode,f.selector(".dijitTreeNode",x.leave),function(b){a._onNodeMouseLeave(y.byNode(this),b)}),f(this.containerNode,f.selector(".dijitTreeRow",z.press),function(b){a._onNodePress(y.getEnclosingWidget(this),b)}),f(this.containerNode,f.selector(".dijitTreeRow",z),function(b){a._onClick(y.getEnclosingWidget(this),b)}),f(this.containerNode,f.selector(".dijitTreeRow","dblclick"),function(b){a._onDblClick(y.getEnclosingWidget(this),
b)}));this.model||this._store2model();this.own(l.after(this.model,"onChange",t.hitch(this,"_onItemChange"),!0),l.after(this.model,"onChildrenChange",t.hitch(this,"_onItemChildrenChange"),!0),l.after(this.model,"onDelete",t.hitch(this,"_onItemDelete"),!0));this.inherited(arguments);if(this.dndController){t.isString(this.dndController)&&(this.dndController=t.getObject(this.dndController));for(var b={},c=0;c<this.dndParams.length;c++)this[this.dndParams[c]]&&(b[this.dndParams[c]]=this[this.dndParams[c]]);
this.dndController=new this.dndController(this,b)}this._load();this.onLoadDeferred=R(this.pendingCommandsPromise);this.onLoadDeferred.then(t.hitch(this,"onLoad"))},_store2model:function(){this._v10Compat=!0;u.deprecated("Tree: from version 2.0, should specify a model object rather than a store/query");var a={id:this.id+"_ForestStoreModel",store:this.store,query:this.query,childrenAttrs:this.childrenAttr};this.params.mayHaveChildren&&(a.mayHaveChildren=t.hitch(this,"mayHaveChildren"));this.params.getItemChildren&&
(a.getChildren=t.hitch(this,function(a,b,c){this.getItemChildren(this._v10Compat&&a===this.model.root?null:a,b,c)}));this.model=new K(a);this.showRoot=!!this.label},onLoad:function(){},_load:function(){this.model.getRoot(t.hitch(this,function(a){var b=this.rootNode=this.tree._createTreeNode({item:a,tree:this,isExpandable:!0,label:this.label||this.getLabel(a),labelType:this.model.labelType||"text",textDir:this.textDir,indent:this.showRoot?0:-1});this.showRoot?(this.domNode.setAttribute("aria-multiselectable",
!this.dndController.singular),this.rootLoadingIndicator.style.display="none"):(b.rowNode.style.display="none",this.domNode.setAttribute("role","presentation"),this.domNode.removeAttribute("aria-expanded"),this.domNode.removeAttribute("aria-multiselectable"),this["aria-label"]?(b.containerNode.setAttribute("aria-label",this["aria-label"]),this.domNode.removeAttribute("aria-label")):this["aria-labelledby"]&&(b.containerNode.setAttribute("aria-labelledby",this["aria-labelledby"]),this.domNode.removeAttribute("aria-labelledby")),
b.labelNode.setAttribute("role","presentation"),b.labelNode.removeAttribute("aria-selected"),b.containerNode.setAttribute("role","tree"),b.containerNode.setAttribute("aria-expanded","true"),b.containerNode.setAttribute("aria-multiselectable",!this.dndController.singular));this.containerNode.appendChild(b.domNode);a=this.model.getIdentity(a);this._itemNodesMap[a]?this._itemNodesMap[a].push(b):this._itemNodesMap[a]=[b];b._updateLayout();this._expandNode(b).then(t.hitch(this,function(){this._destroyed||
(this.rootLoadingIndicator.style.display="none",this.expandChildrenDeferred.resolve(!0))}))}),t.hitch(this,function(a){console.error(this,": error loading root: ",a)}))},getNodesByItem:function(a){if(!a)return[];a=t.isString(a)?a:this.model.getIdentity(a);return[].concat(this._itemNodesMap[a])},_setSelectedItemAttr:function(a){this.set("selectedItems",[a])},_setSelectedItemsAttr:function(a){var b=this;return this.pendingCommandsPromise=this.pendingCommandsPromise.always(t.hitch(this,function(){var c=
r.map(a,function(a){return!a||t.isString(a)?a:b.model.getIdentity(a)}),d=[];r.forEach(c,function(a){d=d.concat(b._itemNodesMap[a]||[])});this.set("selectedNodes",d)}))},_setPathAttr:function(a){return a.length?R(this.set("paths",[a]).then(function(a){return a[0]})):R(this.set("paths",[]).then(function(a){return a[0]}))},_setPathsAttr:function(a){function b(a,d){var e=a.shift(),f=r.filter(d,function(a){return a.getIdentity()==e})[0];if(f)return a.length?c._expandNode(f).then(function(){return b(a,
f.getChildren())}):f;throw new O.PathError("Could not expand path at "+e);}var c=this;return R(this.pendingCommandsPromise=this.pendingCommandsPromise.always(function(){return m(r.map(a,function(a){a=r.map(a,function(a){return a&&t.isObject(a)?c.model.getIdentity(a):a});if(a.length)return b(a,[c.rootNode]);throw new O.PathError("Empty path");}))}).then(function(a){c.set("selectedNodes",a);return c.paths}))},_setSelectedNodeAttr:function(a){this.set("selectedNodes",[a])},_setSelectedNodesAttr:function(a){this.dndController.setSelection(a)},
expandAll:function(){function a(c){return b._expandNode(c).then(function(){var b=r.filter(c.getChildren()||[],function(a){return a.isExpandable});return m(r.map(b,a))})}var b=this;return R(a(this.rootNode))},collapseAll:function(){function a(c){var d=r.filter(c.getChildren()||[],function(a){return a.isExpandable}),d=m(r.map(d,a));return!c.isExpanded||c==b.rootNode&&!b.showRoot?d:d.then(function(){return b._collapseNode(c)})}var b=this;return R(a(this.rootNode))},mayHaveChildren:function(){},getItemChildren:function(){},
getLabel:function(a){return this.model.getLabel(a)},getIconClass:function(a,b){return!a||this.model.mayHaveChildren(a)?b?"dijitFolderOpened":"dijitFolderClosed":"dijitLeaf"},getLabelClass:function(){},getRowClass:function(){},getIconStyle:function(){},getLabelStyle:function(){},getRowStyle:function(){},getTooltip:function(){return""},_onDownArrow:function(a,b){var c=this._getNext(b);c&&c.isTreeNode&&this.focusNode(c)},_onUpArrow:function(a,b){var c=b.getPreviousSibling();if(c)for(b=c;b.isExpandable&&
b.isExpanded&&b.hasChildren();)c=b.getChildren(),b=c[c.length-1];else if(c=b.getParent(),this.showRoot||c!==this.rootNode)b=c;b&&b.isTreeNode&&this.focusNode(b)},_onRightArrow:function(a,b){b.isExpandable&&!b.isExpanded?this._expandNode(b):b.hasChildren()&&(b=b.getChildren()[0])&&b.isTreeNode&&this.focusNode(b)},_onLeftArrow:function(a,b){if(b.isExpandable&&b.isExpanded)this._collapseNode(b);else{var c=b.getParent();c&&c.isTreeNode&&(this.showRoot||c!==this.rootNode)&&this.focusNode(c)}},focusLastChild:function(){var a=
this._getLast();a&&a.isTreeNode&&this.focusNode(a)},_getFirst:function(){return this.showRoot?this.rootNode:this.rootNode.getChildren()[0]},_getLast:function(){for(var a=this.rootNode;a.isExpanded;){var b=a.getChildren();if(!b.length)break;a=b[b.length-1]}return a},_getNext:function(a){if(a.isExpandable&&a.isExpanded&&a.hasChildren())return a.getChildren()[0];for(;a&&a.isTreeNode;){var b=a.getNextSibling();if(b)return b;a=a.getParent()}return null},childSelector:".dijitTreeRow",isExpandoNode:function(a,
b){return p.isDescendant(a,b.expandoNode)||p.isDescendant(a,b.expandoNodeText)},_onNodePress:function(a,b){this.focusNode(a)},__click:function(a,b,c,d){var e=this.isExpandoNode(b.target,a);a.isExpandable&&(c||e)?this._onExpandoClick({node:a}):(this._publish("execute",{item:a.item,node:a,evt:b}),this[d](a.item,a,b),this.focusNode(a));b.stopPropagation();b.preventDefault()},_onClick:function(a,b){this.__click(a,b,this.openOnClick,"onClick")},_onDblClick:function(a,b){this.__click(a,b,this.openOnDblClick,
"onDblClick")},_onExpandoClick:function(a){a=a.node;this.focusNode(a);a.isExpanded?this._collapseNode(a):this._expandNode(a)},onClick:function(){},onDblClick:function(){},onOpen:function(){},onClose:function(){},_getNextNode:function(a){u.deprecated(this.declaredClass+"::_getNextNode(node) is deprecated. Use _getNext(node) instead.","","2.0");return this._getNext(a)},_getRootOrFirstNode:function(){u.deprecated(this.declaredClass+"::_getRootOrFirstNode() is deprecated. Use _getFirst() instead.","",
"2.0");return this._getFirst()},_collapseNode:function(a){a._expandNodeDeferred&&delete a._expandNodeDeferred;if("Loading"!=a.state&&a.isExpanded){var b=a.collapse();this.onClose(a.item,a);this._state(a,!1);this._startPaint(b);return b}},_expandNode:function(a){if(a._expandNodeDeferred)return a._expandNodeDeferred;var b=this.model,c=a.item,d=this;a._loadDeferred||(a.markProcessing(),a._loadDeferred=new k,b.getChildren(c,function(b){a.unmarkProcessing();a.setChildItems(b).then(function(){a._loadDeferred.resolve(b)})},
function(b){console.error(d,": error loading "+a.label+" children: ",b);a._loadDeferred.reject(b)}));b=a._loadDeferred.then(t.hitch(this,function(){var b=a.expand();this.onOpen(a.item,a);this._state(a,!0);return b}));this._startPaint(b);return b},focusNode:function(a){var b=this.domNode.scrollLeft;this.focusChild(a);this.domNode.scrollLeft=b},_onNodeMouseEnter:function(){},_onNodeMouseLeave:function(){},_onItemChange:function(a){var b=this.model.getIdentity(a);if(b=this._itemNodesMap[b]){var c=this.getLabel(a),
d=this.getTooltip(a);r.forEach(b,function(b){b.set({item:a,label:c,tooltip:d});b._updateItemClasses(a)})}},_onItemChildrenChange:function(a,b){var c=this.model.getIdentity(a);(c=this._itemNodesMap[c])&&r.forEach(c,function(a){a.setChildItems(b)})},_onItemDelete:function(a){a=this.model.getIdentity(a);var b=this._itemNodesMap[a];b&&(r.forEach(b,function(a){this.dndController.removeTreeNode(a);var b=a.getParent();b&&b.removeChild(a);this.lastFocusedChild&&!p.isDescendant(this.lastFocusedChild.domNode,
this.domNode)&&delete this.lastFocusedChild;this.focusedChild&&!p.isDescendant(this.focusedChild.domNode,this.domNode)&&this.focus();a.destroyRecursive()},this),delete this._itemNodesMap[a])},_initState:function(){this._openedNodes={};if(this.persist&&this.cookieName){var a=d(this.cookieName);a&&r.forEach(a.split(","),function(a){this._openedNodes[a]=!0},this)}},_state:function(a,b){if(!this.persist)return!1;var c=r.map(a.getTreePath(),function(a){return this.model.getIdentity(a)},this).join("/");
if(1===arguments.length)return this._openedNodes[c];b?this._openedNodes[c]=!0:delete this._openedNodes[c];this._saveExpandedNodes()},_saveExpandedNodes:function(){if(this.persist&&this.cookieName){var a=[],b;for(b in this._openedNodes)a.push(b);d(this.cookieName,a.join(","),{expires:365})}},destroy:function(){this._curSearch&&(this._curSearch.timer.remove(),delete this._curSearch);this.rootNode&&this.rootNode.destroyRecursive();this.dndController&&!t.isString(this.dndController)&&this.dndController.destroy();
this.rootNode=null;this.inherited(arguments)},destroyRecursive:function(){this.destroy()},resize:function(a){a&&e.setMarginBox(this.domNode,a);this._nodePixelIndent=e.position(this.tree.indentDetector).w||this._nodePixelIndent;this.expandChildrenDeferred.then(t.hitch(this,function(){this.rootNode.set("indent",this.showRoot?0:-1);this._adjustWidths()}))},_outstandingPaintOperations:0,_startPaint:function(a){this._outstandingPaintOperations++;this._adjustWidthsTimer&&(this._adjustWidthsTimer.remove(),
delete this._adjustWidthsTimer);var b=t.hitch(this,function(){this._outstandingPaintOperations--;0>=this._outstandingPaintOperations&&!this._adjustWidthsTimer&&this._started&&(this._adjustWidthsTimer=this.defer("_adjustWidths"))});w(a,b,b)},_adjustWidths:function(){this._adjustWidthsTimer&&(this._adjustWidthsTimer.remove(),delete this._adjustWidthsTimer);this.containerNode.style.width="auto";this.containerNode.style.width=this.domNode.scrollWidth>this.domNode.offsetWidth?"auto":"100%"},_createTreeNode:function(a){return new ba(a)},
focus:function(){this.lastFocusedChild?this.focusNode(this.lastFocusedChild):this.focusFirstChild()}});g("dojo-bidi")&&O.extend({_setTextDirAttr:function(a){a&&this.textDir!=a&&(this._set("textDir",a),this.rootNode.set("textDir",a))}});O.PathError=b("TreePathError");O._TreeNode=ba;return O})},"dijit/tree/TreeStoreModel":function(){define(["dojo/_base/array","dojo/aspect","dojo/_base/declare","dojo/_base/lang"],function(r,l,d,q){return d("dijit.tree.TreeStoreModel",null,{store:null,childrenAttrs:["children"],
newItemIdAttr:"id",labelAttr:"",root:null,query:null,deferItemLoadingUntilExpand:!1,constructor:function(d){q.mixin(this,d);this.connects=[];d=this.store;if(!d.getFeatures()["dojo.data.api.Identity"])throw Error("dijit.tree.TreeStoreModel: store must support dojo.data.Identity");d.getFeatures()["dojo.data.api.Notification"]&&(this.connects=this.connects.concat([l.after(d,"onNew",q.hitch(this,"onNewItem"),!0),l.after(d,"onDelete",q.hitch(this,"onDeleteItem"),!0),l.after(d,"onSet",q.hitch(this,"onSetItem"),
!0)]))},destroy:function(){for(var d;d=this.connects.pop();)d.remove()},getRoot:function(d,l){this.root?d(this.root):this.store.fetch({query:this.query,onComplete:q.hitch(this,function(k){if(1!=k.length)throw Error("dijit.tree.TreeStoreModel: root query returned "+k.length+" items, but must return exactly one");this.root=k[0];d(this.root)}),onError:l})},mayHaveChildren:function(d){return r.some(this.childrenAttrs,function(k){return this.store.hasAttribute(d,k)},this)},getChildren:function(d,l,p){var h=
this.store;if(h.isItemLoaded(d)){for(var e=[],c=0;c<this.childrenAttrs.length;c++)var b=h.getValues(d,this.childrenAttrs[c]),e=e.concat(b);var a=0;this.deferItemLoadingUntilExpand||r.forEach(e,function(b){h.isItemLoaded(b)||a++});0==a?l(e):r.forEach(e,function(b,c){h.isItemLoaded(b)||h.loadItem({item:b,onItem:function(b){e[c]=b;0==--a&&l(e)},onError:p})})}else{var g=q.hitch(this,arguments.callee);h.loadItem({item:d,onItem:function(a){g(a,l,p)},onError:p})}},isItem:function(d){return this.store.isItem(d)},
fetchItemByIdentity:function(d){this.store.fetchItemByIdentity(d)},getIdentity:function(d){return this.store.getIdentity(d)},getLabel:function(d){return this.labelAttr?this.store.getValue(d,this.labelAttr):this.store.getLabel(d)},newItem:function(d,l,p){var h={parent:l,attribute:this.childrenAttrs[0]},e;this.newItemIdAttr&&d[this.newItemIdAttr]?this.fetchItemByIdentity({identity:d[this.newItemIdAttr],scope:this,onItem:function(c){c?this.pasteItem(c,null,l,!0,p):(e=this.store.newItem(d,h))&&void 0!=
p&&this.pasteItem(e,l,l,!1,p)}}):(e=this.store.newItem(d,h))&&void 0!=p&&this.pasteItem(e,l,l,!1,p)},pasteItem:function(d,l,p,h,e){var c=this.store,b=this.childrenAttrs[0];l&&r.forEach(this.childrenAttrs,function(a){if(c.containsValue(l,a,d)){if(!h){var e=r.filter(c.getValues(l,a),function(a){return a!=d});c.setValues(l,a,e)}b=a}});if(p)if("number"==typeof e){var a=c.getValues(p,b).slice();a.splice(e,0,d);c.setValues(p,b,a)}else c.setValues(p,b,c.getValues(p,b).concat(d))},onChange:function(){},onChildrenChange:function(){},
onDelete:function(){},onNewItem:function(d,l){l&&this.getChildren(l.item,q.hitch(this,function(d){this.onChildrenChange(l.item,d)}))},onDeleteItem:function(d){this.onDelete(d)},onSetItem:function(d,l){if(-1!=r.indexOf(this.childrenAttrs,l))this.getChildren(d,q.hitch(this,function(k){this.onChildrenChange(d,k)}));else this.onChange(d)}})})},"dijit/tree/ForestStoreModel":function(){define(["dojo/_base/array","dojo/_base/declare","dojo/_base/kernel","dojo/_base/lang","./TreeStoreModel"],function(r,l,
d,q,k){return l("dijit.tree.ForestStoreModel",k,{rootId:"$root$",rootLabel:"ROOT",query:null,constructor:function(d){this.root={store:this,root:!0,id:d.rootId,label:d.rootLabel,children:d.rootChildren}},mayHaveChildren:function(d){return d===this.root||this.inherited(arguments)},getChildren:function(d,k,h){d===this.root?this.root.children?k(this.root.children):this.store.fetch({query:this.query,onComplete:q.hitch(this,function(d){this.root.children=d;k(d)}),onError:h}):this.inherited(arguments)},
isItem:function(d){return d===this.root?!0:this.inherited(arguments)},fetchItemByIdentity:function(k){if(k.identity==this.root.id){var l=k.scope||d.global;k.onItem&&k.onItem.call(l,this.root)}else this.inherited(arguments)},getIdentity:function(d){return d===this.root?this.root.id:this.inherited(arguments)},getLabel:function(d){return d===this.root?this.root.label:this.inherited(arguments)},newItem:function(d,k,h){return k===this.root?(this.onNewRootItem(d),this.store.newItem(d)):this.inherited(arguments)},
onNewRootItem:function(){},pasteItem:function(d,k,h,e,c){if(k===this.root&&!e)this.onLeaveRoot(d);this.inherited(arguments,[d,k===this.root?null:k,h===this.root?null:h,e,c]);if(h===this.root)this.onAddToRoot(d)},onAddToRoot:function(d){console.log(this,": item ",d," added to root")},onLeaveRoot:function(d){console.log(this,": item ",d," removed from root")},_requeryTop:function(){var d=this.root.children||[];this.store.fetch({query:this.query,onComplete:q.hitch(this,function(k){this.root.children=
k;if(d.length!=k.length||r.some(d,function(d,e){return k[e]!=d}))this.onChildrenChange(this.root,k)})})},onNewItem:function(d,k){this._requeryTop();this.inherited(arguments)},onDeleteItem:function(d){-1!=r.indexOf(this.root.children,d)&&this._requeryTop();this.inherited(arguments)},onSetItem:function(d,k,h,e){this._requeryTop();this.inherited(arguments)}})})},"dijit/tree/_dndSelector":function(){define("dojo/_base/array dojo/_base/declare dojo/_base/kernel dojo/_base/lang dojo/dnd/common dojo/dom dojo/mouse dojo/on dojo/touch ../a11yclick ./_dndContainer".split(" "),
function(r,l,d,q,k,m,p,h,e,c,b){return l("dijit.tree._dndSelector",b,{constructor:function(){this.selection={};this.anchor=null;this.events.push(h(this.tree.domNode,e.press,q.hitch(this,"onMouseDown")),h(this.tree.domNode,e.release,q.hitch(this,"onMouseUp")),h(this.tree.domNode,e.move,q.hitch(this,"onMouseMove")),h(this.tree.domNode,c.press,q.hitch(this,"onClickPress")),h(this.tree.domNode,c.release,q.hitch(this,"onClickRelease")))},singular:!1,getSelectedTreeNodes:function(){var a=[],b=this.selection,
c;for(c in b)a.push(b[c]);return a},selectNone:function(){this.setSelection([]);return this},destroy:function(){this.inherited(arguments);this.selection=this.anchor=null},addTreeNode:function(a,b){this.setSelection(this.getSelectedTreeNodes().concat([a]));b&&(this.anchor=a);return a},removeTreeNode:function(a){var b=r.filter(this.getSelectedTreeNodes(),function(b){return!m.isDescendant(b.domNode,a.domNode)});this.setSelection(b);return a},isTreeNodeSelected:function(a){return a.id&&!!this.selection[a.id]},
setSelection:function(a){var b=this.getSelectedTreeNodes();r.forEach(this._setDifference(b,a),q.hitch(this,function(a){a.setSelected(!1);this.anchor==a&&delete this.anchor;delete this.selection[a.id]}));r.forEach(this._setDifference(a,b),q.hitch(this,function(a){a.setSelected(!0);this.selection[a.id]=a}));this._updateSelectionProperties()},_setDifference:function(a,b){r.forEach(b,function(a){a.__exclude__=!0});var c=r.filter(a,function(a){return!a.__exclude__});r.forEach(b,function(a){delete a.__exclude__});
return c},_updateSelectionProperties:function(){var a=this.getSelectedTreeNodes(),b=[],c=[];r.forEach(a,function(a){var d=a.getTreePath();c.push(a);b.push(d)},this);a=r.map(c,function(a){return a.item});this.tree._set("paths",b);this.tree._set("path",b[0]||[]);this.tree._set("selectedNodes",c);this.tree._set("selectedNode",c[0]||null);this.tree._set("selectedItems",a);this.tree._set("selectedItem",a[0]||null)},onClickPress:function(a){if(!(this.current&&this.current.isExpandable&&this.tree.isExpandoNode(a.target,
this.current))){"mousedown"==a.type&&p.isLeft(a)&&a.preventDefault();var b="keydown"==a.type?this.tree.focusedChild:this.current;if(b){var c=k.getCopyKeyState(a),d=b.id;this.singular||a.shiftKey||!this.selection[d]?(this._doDeselect=!1,this.userSelect(b,c,a.shiftKey)):this._doDeselect=!0}}},onClickRelease:function(a){this._doDeselect&&(this._doDeselect=!1,this.userSelect("keyup"==a.type?this.tree.focusedChild:this.current,k.getCopyKeyState(a),a.shiftKey))},onMouseMove:function(){this._doDeselect=
!1},onMouseDown:function(){},onMouseUp:function(){},_compareNodes:function(a,b){if(a===b)return 0;if("sourceIndex"in document.documentElement)return a.sourceIndex-b.sourceIndex;if("compareDocumentPosition"in document.documentElement)return a.compareDocumentPosition(b)&2?1:-1;if(document.createRange){var c=doc.createRange();c.setStartBefore(a);var d=doc.createRange();d.setStartBefore(b);return c.compareBoundaryPoints(c.END_TO_END,d)}throw Error("dijit.tree._compareNodes don't know how to compare two different nodes in this browser");
},userSelect:function(a,b,c){if(this.singular)this.anchor==a&&b?this.selectNone():(this.setSelection([a]),this.anchor=a);else if(c&&this.anchor){b=this._compareNodes(this.anchor.rowNode,a.rowNode);c=this.anchor;0>b?b=c:(b=a,a=c);for(c=[];b!=a;)c.push(b),b=this.tree._getNext(b);c.push(a);this.setSelection(c)}else this.selection[a.id]&&b?this.removeTreeNode(a):b?this.addTreeNode(a,!0):(this.setSelection([a]),this.anchor=a)},getItem:function(a){return{data:this.selection[a],type:["treeNode"]}},forInSelectedItems:function(a,
b){b=b||d.global;for(var c in this.selection)a.call(b,this.getItem(c),c,this)}})})},"dijit/tree/_dndContainer":function(){define("dojo/aspect dojo/_base/declare dojo/dom-class dojo/_base/lang dojo/on dojo/touch".split(" "),function(r,l,d,q,k,m){return l("dijit.tree._dndContainer",null,{constructor:function(l,h){this.tree=l;this.node=l.domNode;q.mixin(this,h);this.containerState="";d.add(this.node,"dojoDndContainer");this.events=[k(this.node,m.enter,q.hitch(this,"onOverEvent")),k(this.node,m.leave,
q.hitch(this,"onOutEvent")),r.after(this.tree,"_onNodeMouseEnter",q.hitch(this,"onMouseOver"),!0),r.after(this.tree,"_onNodeMouseLeave",q.hitch(this,"onMouseOut"),!0),k(this.node,"dragstart, selectstart",function(d){d.preventDefault()})]},destroy:function(){for(var d;d=this.events.pop();)d.remove();this.node=this.parent=null},onMouseOver:function(d){this.current=d},onMouseOut:function(){this.current=null},_changeState:function(k,h){var e="dojoDnd"+k,c=k.toLowerCase()+"State";d.replace(this.node,e+
h,e+this[c]);this[c]=h},_addItemClass:function(k,h){d.add(k,"dojoDndItem"+h)},_removeItemClass:function(k,h){d.remove(k,"dojoDndItem"+h)},onOverEvent:function(){this._changeState("Container","Over")},onOutEvent:function(){this._changeState("Container","")}})})},"jimu/dijit/QueryableServiceChooserFromPortal":function(){define("dojo/_base/declare dijit/_WidgetBase dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dojo/text!./templates/QueryableServiceChooserFromPortal.html dojo/_base/lang dojo/_base/html dojo/_base/array dojo/on dojo/query dojo/Deferred dojo/Evented dojo/promise/all jimu/dijit/ItemSelector jimu/dijit/QueryableServiceBrowser jimu/portalUrlUtils esri/request".split(" "),
function(r,l,d,q,k,m,p,h,e,c,b,a,g,u,n,t,f){return r([l,d,q,a],{templateString:k,declaredClass:"jimu.dijit.QueryableServiceChooserFromPortal",baseClass:"jimu-service-chooser-from-portal jimu-queryable-service-chooser-from-portal",_serviceBrowserDef:null,portalUrl:null,multiple:!1,postMixInProperties:function(){this.nls=m.mixin({},window.jimuNls.common);this.nls=m.mixin(this.nls,window.jimuNls.featureLayerChooserFromPortal);this.portalUrl=t.getStandardPortalUrl(this.portalUrl);this.multiple=!0===this.multiple?
!0:!1},postCreate:function(){this.inherited(arguments);this._initSelf()},getSelectedItems:function(){return this.serviceBrowser.getSelectedItems()},_initSelf:function(){this.selector=new u({portalUrl:this.portalUrl,itemTypes:["Feature Service","Map Service","Image Service"],onlyShowOnlineFeaturedItems:!1});this.own(e(this.selector,"item-selected",m.hitch(this,this._onItemSelected)));this.own(e(this.selector,"none-item-selected",m.hitch(this,this._onNoneItemSelected)));this.selector.placeAt(this.selectorContainer);
this.selector.startup();this.serviceBrowser=new n({multiple:this.multiple});this.own(e(this.serviceBrowser,"tree-click",m.hitch(this,this._onServiceBrowserClicked)));this.serviceBrowser.placeAt(this.serviceBrowserContainer);this.serviceBrowser.startup()},_onItemSelected:function(){p.removeClass(this.btnNext,"jimu-state-disabled")},_onNoneItemSelected:function(){p.addClass(this.btnNext,"jimu-state-disabled")},_onBtnBackClicked:function(){this._serviceBrowserDef&&!this._serviceBrowserDef.isFulfilled()&&
this._serviceBrowserDef.cancel();p.setStyle(this.btnOk,"display","none");p.setStyle(this.btnNext,"display","block");p.setStyle(this.btnBack,"display","none");p.addClass(this.btnOk,"jimu-state-disabled");p.setStyle(this.selectorContainer,"display","block");p.setStyle(this.serviceBrowserContainer,"display","none");this.serviceBrowser.reset();this.emit("back")},_onBtnOkClicked:function(){var a=this.getSelectedItems();0<a.length&&this.emit("ok",a)},_onBtnNextClicked:function(){var a=this.selector.getSelectedItem();
a&&(p.setStyle(this.btnNext,"display","none"),p.setStyle(this.btnBack,"display","block"),p.setStyle(this.btnOk,"display","block"),p.addClass(this.btnOk,"jimu-state-disabled"),p.setStyle(this.selectorContainer,"display","none"),p.setStyle(this.serviceBrowserContainer,"display","block"),this.serviceBrowser.reset(),this._serviceBrowserDef=this.serviceBrowser.setUrl(a.url||a.item),this._serviceBrowserDef.then(m.hitch(this,function(){this._serviceBrowserDef=null;this._setOkStateBySelectedItems()}),m.hitch(this,
function(){this._serviceBrowserDef=null})),this.emit("next"))},_setOkStateBySelectedItems:function(){0<this.serviceBrowser.getSelectedItems().length?p.removeClass(this.btnOk,"jimu-state-disabled"):p.addClass(this.btnOk,"jimu-state-disabled")},_onServiceBrowserClicked:function(){this._setOkStateBySelectedItems()},_onBtnCancelClicked:function(){this.emit("cancel")}})})},"jimu/dijit/QueryableServiceBrowser":function(){define(["dojo/_base/declare","./_BasicServiceBrowser","dojo/_base/lang","dojo/_base/array",
"jimu/serviceBrowserRuleUtils"],function(r,l,d,q,k){return r([l],{declaredClass:"jimu.dijit.QueryableServiceBrowser",baseClass:"jimu-queryable-service-browser",url:"",multiple:!1,postMixInProperties:function(){this.inherited(arguments);this.rule=k.getQueryableServiceBrowserRule()},getSelectedItems:function(){var k=this.inherited(arguments);return k=q.map(k,d.hitch(this,function(d){return{name:d.name,url:d.url,definition:d.definition}}))}})})},"jimu/dijit/_BasicServiceBrowser":function(){define("dojo/_base/declare dijit/_WidgetBase dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dojo/Evented dojo/_base/lang dojo/_base/html dojo/_base/array dojo/Deferred dojo/promise/all dojo/store/Memory dojo/store/Observable dijit/tree/ObjectStoreModel jimu/utils jimu/dijit/_Tree jimu/dijit/LoadingShelter".split(" "),
function(r,l,d,q,k,m,p,h,e,c,b,a,g,u,n){return r([l,d,q,k],{templateString:'\x3cdiv style\x3d"width:100%;"\x3e\x3cdiv data-dojo-attach-point\x3d"shelter"  data-dojo-type\x3d"jimu/dijit/LoadingShelter" data-dojo-props\x3d"hidden:true"\x3e\x3c/div\x3e\x3c/div\x3e',_store:null,_id:0,_currentUrl:"",_treeClass:"service-browser-tree",_def:null,url:"",multiple:!1,rule:null,postMixInProperties:function(){this.nls=window.jimuNls.basicServiceBrowser},postCreate:function(){this.inherited(arguments);p.addClass(this.domNode,
"jimu-basic-service-browser");this.multiple=!!this.multiple;this._createTree();this.url&&"string"===typeof this.url&&this.setUrl(this.url)},reset:function(){this.url="";this._clear()},getSelectedItems:function(){return this.tree.getSelectedItems()},setUrl:function(a){this._def&&(this._def.isFulfilled()||this._def.cancel(),this._def=null);this._def=new e;a&&"string"===typeof a&&a.replace(/\/*$/g,"")||this._def.reject();a=a.replace(/\/*$/g,"");a=m.trim(a);var b=a.match(/^http(s?):\/\//gi);b&&0<b.length||
(a="http://"+a);if(!(0>=a.search(/\/rest\/services/i))&&(this._clear(),this._currentUrl=a))return a=this._getRootItem(),a=u.isStringEndWith(this._currentUrl,"rest/services")?this._searchBaseServiceUrl(this._currentUrl,a):this._isUrlContainsServiceType(this._currentUrl)?this._searchServiceUrl(this._currentUrl,a):this._searchFolderServiceUrl(this._currentUrl,a),this.shelter.show(),a.then(m.hitch(this,function(a){this.domNode&&this.shelter.hide();var b=this.tree.getAllLeafTreeNodeWidgets();1===b.length&&
b[0].select();this._def.resolve(a)}),m.hitch(this,function(a){this.domNode&&this.shelter.hide();this._showRequestError();this._def.reject(a)})),this._def;this._def.reject()},_getItem:function(a){return this.rule.getItem(a)},_getSubItemUrls:function(a){return this.rule.getSubItemUrls(a)},_getSubItems:function(a){var b=new e;this._getSubItemUrls(a).then(m.hitch(this,function(a){a=h.map(a,m.hitch(this,function(a){return this._getItem(a)}));c(a).then(m.hitch(this,function(a){a=h.filter(a,m.hitch(this,
function(a){return a&&"object"===typeof a}));b.resolve(a)}),m.hitch(this,function(a){b.reject(a)}))}),m.hitch(this,function(a){b.reject(a)}));return b},_selectFirstLeafTreeNodeWidget:function(){var a=this.tree.getAllLeafTreeNodeWidgets();1===a.length&&a[0].select()},isLeafItem:function(a){return 0<=this.rule.leafTypes.indexOf(a.type)},isServiceTypeSupported:function(a){return this.rule.isServiceTypeSupported(a)},_getStringEndWith:function(a,b){var c="",d=a.indexOf(b);0<=d&&(c=a.slice(0,d+b.length));
return c},_isUrlContainsServiceType:function(a){return this.rule.isUrlContainsServiceType(a)},_getBaseServiceUrl:function(){return this._getStringEndWith(this._currentUrl,"rest/services")},_getServiceName:function(a){var b="";a=a.split("/");return b=a[a.length-1]},_searchBaseServiceUrl:function(a,b){var d=new e;this._getRestInfo(a).then(m.hitch(this,function(f){if(this.domNode){var g=[];h.map(f.folders,m.hitch(this,function(c){var d={name:c,type:"folder",url:a+"/"+c,parent:b.id};this._addItem(d);
var f=new e;this._doSearchFolderServiceUrl(d.url,d.id).then(m.hitch(this,function(a){0<a.length?h.forEach(a,m.hitch(this,function(a){a.parent=d.id;this._addItem(a)})):this._removeItem(d.id);f.resolve()}),m.hitch(this,function(a){f.reject(a)}));g.push(f);return f}));h.forEach(f.services,m.hitch(this,function(c){if(this.isServiceTypeSupported(c.type)){c=a+"/"+c.name+"/"+c.type;var d=new e;this.rule.getItem(c).then(m.hitch(this,function(a){a&&(a.parent=b.id,this._addItem(a));d.resolve()}),m.hitch(this,
function(a){console.error(a);d.reject(a)}));g.push(d)}}));c(g).then(m.hitch(this,function(){this.domNode&&d.resolve()}),m.hitch(this,function(a){console.error(a);this.domNode&&d.reject(a)}))}}),m.hitch(this,function(a){console.error(a);this.domNode&&d.reject({errorCode:"NETWORK_ERROR",error:a})}));return d},_searchFolderServiceUrl:function(a,b){var c=new e;this._doSearchFolderServiceUrl(a,b).then(m.hitch(this,function(a){this.domNode&&(h.forEach(a,m.hitch(this,function(a){a.parent=b.id;this._addItem(a)})),
c.resolve())}),m.hitch(this,function(a){console.error(a);this.domNode&&c.reject({errorCode:"NETWORK_ERROR",error:a})}));return c},_doSearchFolderServiceUrl:function(a){var b=new e,d=this._getBaseServiceUrl();this._getRestInfo(a).then(m.hitch(this,function(a){a=a.services;var e=[];a&&0<a.length&&h.forEach(a,m.hitch(this,function(a){this.isServiceTypeSupported(a.type)&&(a=this.rule.getItem(d+"/"+a.name+"/"+a.type),e.push(a))}));c(e).then(m.hitch(this,function(a){a=h.filter(a,m.hitch(this,function(a){return a}));
b.resolve(a)}),m.hitch(this,function(a){console.error(a);b.reject(a)}))}),m.hitch(this,function(a){console.error(a);b.reject(a)}));return b},_searchServiceUrl:function(a,b){var c=new e;this._getSubItems(a).then(m.hitch(this,function(d){d&&0<d.length?(h.forEach(d,m.hitch(this,function(a){a.parent=b.id;this._addItem(a)})),c.resolve()):this._getItem(a).then(m.hitch(this,function(a){a&&(a.parent=b.id,this._addItem(a));c.resolve()}),m.hitch(this,function(a){c.reject(a)}))}),m.hitch(this,function(a){c.reject(a)}));
return c},_getRestInfo:function(a){var b=new e;this.rule.getRestInfo(a).then(m.hitch(this,function(a){this.domNode&&b.resolve(a)}),m.hitch(this,function(a){this.domNode&&b.reject(a)}));return b},_clear:function(){var a=this._store.query({parent:"root"});h.forEach(a,m.hitch(this,function(a){a&&"root"!==a.id&&this._store.remove(a.id)}))},_showRequestError:function(){this.emit("error",this.nls.invalidUrlTip)},_addItem:function(a){this._id++;a.id=this._id.toString();this._store.add(a);return a},_removeItem:function(a){this._store.remove(a)},
_getRootItem:function(){return{id:"root",name:"Services Root",type:"root"}},_createTree:function(){var c=this._getRootItem(),c=new b({data:[c],getChildren:function(a){return this.query({parent:a.id})}});this._store=new a(c);c=new g({store:this._store,query:{id:"root"},mayHaveChildren:m.hitch(this,this._mayHaveChildren)});this.tree=new n({multiple:this.multiple,model:c,showRoot:!1,style:{width:"100%"},isLeafItem:m.hitch(this,this.isLeafItem),onOpen:m.hitch(this,function(a,b){this._onTreeOpen(a,b);
this.emit("tree-open",a,b)}),onClick:m.hitch(this,function(a,b,c){this._onTreeClick(a,b,c);this.emit("tree-click",a,b,c)}),getIconStyle:m.hitch(this,function(a,b){var c=null;if(!a)return null;var d={width:"20px",height:"20px",backgroundRepeat:"no-repeat",backgroundPosition:"center center",backgroundImage:""},e=window.location.protocol+"//"+window.location.host+require.toUrl("jimu"),f=this._getIconImageName(a,b);f||("folder"===a.type?f=b?"folder_open_default.png":"folder_close_default.png":this.isServiceTypeSupported(a.type)&&
(f=b?"folder_open_default.png":"folder_close_default.png"));f&&(d.backgroundImage="url("+e+"/css/images/"+f+")",c=d);return c})});p.addClass(this.tree.domNode,this._treeClass);this.tree.placeAt(this.domNode)},_getIconImageName:function(a,b){var c="";"function"===typeof this.rule.getIconImageName&&(c=this.rule.getIconImageName(a,b));return c},_mayHaveChildren:function(a){return"root"===a.type?!0:!this.isLeafItem(a)},_onTreeOpen:function(a,b){"root"===a.id||0<this._store.query({parent:a.id}).length||
a.checking||a.checked||(a.checking=!0,this._getSubItems(a.url).then(m.hitch(this,function(b){h.forEach(b,m.hitch(this,function(b){b.parent=a.id;this._addItem(b)}));a.checking=!1;a.checked=!0}),m.hitch(this,function(b){console.error(b);a.checking=!1;a.checked=!0})))},_onTreeClick:function(a,b,c){},destroy:function(){this.shelter&&(this.shelter.destroy(),this.shelter=null);this.inherited(arguments)}})})},"jimu/serviceBrowserRuleUtils":function(){define(["dojo/_base/lang","dojo/_base/array","dojo/Deferred",
"jimu/utils","jimu/ServiceBrowserRule"],function(r,l,d,q,k){var m={combineRules:function(d){var h=new k;l.forEach(d,function(d){l.forEach(d.leafTypes,function(c){0>h.leafTypes.indexOf(c)&&h.leafTypes.push(c)});l.forEach(d.serviceTypes,function(c){0>h.serviceTypes.indexOf(c)&&h.serviceTypes.push(c)})});h.getMatchedRule=function(e){var c=null;l.some(d,function(b){return b.isUrlContainsServiceType(e)?(c=b,!0):!1});return c};h.getItem=function(d){var c=null;return c=(c=h.getMatchedRule(d))?c.getItem(d):
h.defaultGetItem(d)};h.getSubItemUrls=function(d){var c=null;return c=(c=h.getMatchedRule(d))?c.getSubItemUrls(d):h.defaultGetSubItemUrls(d)};h.getIconImageName=function(d,c){var b="";if(d.url){var a=h.getMatchedRule(d.url);a&&"function"===typeof a.getIconImageName&&(b=a.getIconImageName(d,c))}return b};return h},getFeaturelayerServiceBrowserRule:function(d,h){var e=r.clone(d),c=["point","polyline","polygon"];r.isArrayLike(e)&&0<e.length?(e=l.filter(e,function(b){return 0<=c.indexOf(b)}),0===e.length&&
(e=c)):e=c;return m._getFeaturelayerServiceBrowserRule(e,h)},_getFeaturelayerServiceBrowserRule:function(m,h){return new k({types:m,leafTypes:["Feature Layer","Table"],serviceTypes:["MapServer","FeatureServer"],_groupLayerType:"Group Layer",_featureLayerType:"Feature Layer",_tableType:"Table",getItem:function(e){var c=new d;this.isUrlEndWithServiceType(e,this.serviceTypes)?c=this.defaultGetItem(e):this.getRestInfo(e).then(r.hitch(this,function(b){b=this._getItemByLayerDefinition(e,b);c.resolve(b)}),
r.hitch(this,function(b){c.reject(b)}));return c},getSubItemUrls:function(e){var c=new d;return c=this.isUrlEndWithServiceType(e)?this._getSubUrlsByServiceUrl(e):this._getSubUrlsByGroupUrl(e)},getIconImageName:function(d,c){var b="";if("MapServer"===d.type||"FeatureServer"===d.type)b=c?"mapserver_open.png":"mapserver_close.png";else if(d.type===this._groupLayerType)b=c?"group_layer2.png":"group_layer1.png";else if(d.type===this._featureLayerType){var a=q.getTypeByGeometryType(d.definition&&d.definition.geometryType);
"point"===a?b="point_layer1.png":"polyline"===a?b="line_layer1.png":"polygon"===a&&(b="polygon_layer1.png")}else d.type===this._tableType?b="table.png":"root"===d.type&&this._currentUrl&&l.some(this.serviceTypes,r.hitch(this,function(a){return q.isStringEndWith(this._currentUrl,"/"+a)}))&&(b=c?"mapserver_open.png":"mapserver_close.png");return b},_getSubUrlsByServiceUrl:function(e){var c=new d;this.getRestInfo(e).then(r.hitch(this,function(b){var a=[];l.forEach(b.layers,r.hitch(this,function(b){0<=
b.parentLayerId||a.push(e+"/"+b.id)}));c.resolve(a)}),r.hitch(this,function(b){c.reject(b)}));return c},_getSubUrlsByGroupUrl:function(e){var c=new d;this.getRestInfo(e).then(r.hitch(this,function(b){var a=[];if(b.type===this._groupLayerType)var d=this._getServiceUrlByLayerUrl(e),a=l.map(b.subLayers||[],r.hitch(this,function(a){return d+"/"+a.id}));c.resolve(a)}),r.hitch(this,function(b){c.reject(b)}));return c},_getItemByLayerDefinition:function(d,c){var b=null,a=c.type;if(a===this._groupLayerType)b=
{name:c.name,type:a,url:d,definition:c};else if(a===this._featureLayerType||a===this._tableType){var e=!1;a===this._featureLayerType?e=this._validateEsriGeometryType(c.geometryType):a===this._tableType&&(e=!0);e&&(e=!1,(e=h?q.isFeaturelayerUrlSupportQuery(d,c.capabilities):!0)&&(b={name:c.name,type:a,url:d,definition:c}))}return b},_validateEsriGeometryType:function(d){d=q.getTypeByGeometryType(d);return 0<=this.types.indexOf(d)},_getServiceUrlByLayerUrl:function(d){for(var c="",b=0;b<this.serviceTypes.length;b++){var a=
this.serviceTypes[b].toLowerCase(),e=d.toLowerCase().lastIndexOf("/"+a+"/");if(0<=e){c=d.slice(0,e+a.length+1);break}}return c}})},getGeocodeServiceBrowserRule:function(){return new k({leafTypes:["GeocodeServer"],serviceTypes:["GeocodeServer"]})},getGpServiceBrowserRule:function(){return new k({leafTypes:["GPTask"],serviceTypes:["GPServer"],getItem:function(k){var h=new d;this.isUrlEndWithServiceType(k)?h=this.defaultGetItem(k):this.getRestInfo(k).then(r.hitch(this,function(d){h.resolve({name:d.displayName||
d.name,type:"GPTask",url:k,definition:d})}),r.hitch(this,function(d){h.reject(d)}));return h},getSubItemUrls:function(k){var h=new d;this.isUrlEndWithServiceType(k)?this.getRestInfo(k).then(r.hitch(this,function(d){d=l.map(d.tasks||[],r.hitch(this,function(c){return k+"/"+c}));h.resolve(d)}),r.hitch(this,function(d){h.reject(d)})):h.resolve([]);return h},getIconImageName:function(d,h){var e="";"GPServer"===d.type?e="toolbox.png":"GPTask"===d.type&&(e="tool.png");return e}})},getImageServiceBrowserRule:function(l){return new k({leafTypes:["ImageServer"],
serviceTypes:["ImageServer"],getItem:function(h){var e=new d;this.isUrlEndWithServiceType(h)?this.defaultGetItem(h).then(r.hitch(this,function(c){l?q.isImageServiceSupportQuery(c.definition.capabilities)?e.resolve(c):e.resolve(null):e.resolve(c)}),r.hitch(this,function(c){e.reject(c)})):e.resolve(null);return e},getIconImageName:function(d,e){var c="";"ImageServer"===d.type&&(c="image_layer.png");return c}})},getQueryableServiceBrowserRule:function(){var d=m.getFeaturelayerServiceBrowserRule(["point",
"polyline","polygon"],!0),h=m.getImageServiceBrowserRule(!0);return m.combineRules([d,h])}};return m})},"jimu/ServiceBrowserRule":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/Deferred jimu/utils esri/request esri/IdentityManager".split(" "),function(r,l,d,q,k,m,p){return r([],{leafTypes:null,serviceTypes:null,_restInfoCache:{},constructor:function(d){l.mixin(this,d);l.isArrayLike(this.leafTypes)||(this.leafTypes=[]);l.isArrayLike(this.serviceTypes)||(this.serviceTypes=
[])},getItem:function(d){return this.defaultGetItem(d)},getSubItemUrls:function(d){return this.defaultGetSubItemUrls(d)},getIconImageName:function(d,e){return""},defaultGetItem:function(d){var e=new q;d=d.replace(/\/*$/g,"");if(this.isUrlEndWithServiceType(d)){var c=d.split("/"),b=c[c.length-1],a=c[c.length-2];this.getRestInfo(d).then(l.hitch(this,function(c){e.resolve({name:a,type:b,url:d,definition:c})}),l.hitch(this,function(a){console.error(a);e.reject({errorCode:"NETWORK_ERROR",error:a})}))}else e.resolve(null);
return e},defaultGetSubItemUrls:function(d){d=new q;d.resolve([]);return d},getRestInfo:function(d){var e=new q;d=d.replace(/\/*$/g,"");var c=this._restInfoCache[d];if(c)e.resolve(c);else{var c={url:d,content:{f:"json"},handleAs:"json",callbackParamName:"callback",timeout:2E4},b=p.findCredential(d);b&&b.token&&(c.content.token=b.token);m(c).then(l.hitch(this,function(a){this._restInfoCache[d]=a;e.resolve(a)}),function(a){e.reject(a)})}return e},isServiceTypeSupported:function(h){h=h.toLowerCase();
return d.some(this.serviceTypes,l.hitch(this,function(d){return d.toLowerCase()===h}))},isUrlEndWithServiceType:function(h){return d.some(this.serviceTypes,l.hitch(this,function(d){return k.isStringEndWith(h,"/"+d)}))},isUrlContainsServiceType:function(h){h=h.toLowerCase();return d.some(this.serviceTypes,l.hitch(this,function(d){d=d.toLowerCase();return 0<=h.indexOf("/"+d)}))}})})},"jimu/dijit/_QueryableServiceChooserContent":function(){define(["dojo/_base/declare","./_BasicServiceChooserContent",
"./QueryableServiceBrowser"],function(r,l,d){return r([l],{baseClass:"jimu-queryable-service-chooser-content",_examples:["http://myserver/arcgis/rest/services","http://myserver/arcgis/rest/services/myservice/MapServer","http://myserver/arcgis/rest/services/myservice/FeatureServer","http://myserver/arcgis/rest/services/myservice/ImageServer"],_createServiceBrowser:function(l){return new d(l)}})})},"jimu/dijit/_BasicServiceChooserContent":function(){define("dojo/_base/declare dijit/_WidgetBase dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dojo/text!./templates/_BasicServiceChooserContent.html dojo/Evented dojo/Deferred dojo/_base/html dojo/_base/array dojo/_base/lang dojo/on dojo/aspect dojo/promise/all jimu/dijit/URLInput jimu/dijit/LoadingIndicator".split(" "),
function(r,l,d,q,k,m,p,h,e,c,b,a,g,u,n){return r([l,d,q,m],{templateString:k,_examples:["http://myserver/arcgis/rest/services","http://myserver/arcgis/rest/services/folder","http://myserver/arcgis/rest/services/myservice/servicetype"],multiple:!1,url:"",getSelectedItems:function(){return this.serviceBrowser.getSelectedItems()},postMixInProperties:function(){this.nls=c.mixin({},window.jimuNls.common);this.nls=c.mixin(this.nls,window.jimuNls.basicServiceChooser)},postCreate:function(){this.inherited(arguments);
h.addClass(this.domNode,"jimu-basic-service-chooser-content");this.multiple=!!this.multiple;this._initSelf();this.exampleTd.innerHTML=this.exampleTd.innerHTML},setUrl:function(a){var b=new p;(this.url=a)&&"string"===typeof this.url?(this.urlInput.set("value",this.url),b=this._onBtnValidateClick()):b.reject();return b},focusInput:function(){this.urlInput.focus()},_initSelf:function(){this._examples&&0<this._examples.length?e.forEach(this._examples,c.hitch(this,function(a){h.create("div",{innerHTML:a,
"class":"example-url"},this.exampleTd)})):h.setStyle(this.exampleTr,"display","none");var d={multiple:this.multiple,_onTreeClick:c.hitch(this,this._onTreeClick)};this.serviceBrowser=this._createServiceBrowser(d);this.serviceBrowser.placeAt(this.serviceBrowserContainer);this.serviceBrowser.startup();this.own(a.after(this.urlInput,"validator",c.hitch(this,this._afterUrlValidate)));this.url&&"string"===typeof this.url&&this.urlInput.set("value",this.url);this.own(b(this.serviceBrowser,"error",c.hitch(this,
this._onServiceBrowserError)))},_createServiceBrowser:function(a){},_validateUrl:function(a){a=a.replace(/\/*$/g,"");if((a=a.match(/\/rest\/services\/*(.*)/gi))&&0<a.length)if(a=a[0].replace(/\/rest\/services\/*/,"")){var b=a.split("/");if(1===b.length)return!0;if(2===b.length)return this.serviceBrowser.isServiceTypeSupported(b[1]);if(3<=b.length)return a=this.serviceBrowser.isServiceTypeSupported(b[1]),b=this.serviceBrowser.isServiceTypeSupported(b[2]),a||b}else return!0;else return!1},_afterUrlValidate:function(a){a&&
(a=this.urlInput.get("value"),a=this._validateUrl(a));a?h.removeClass(this.btnValidate,"jimu-state-disabled"):h.addClass(this.btnValidate,"jimu-state-disabled");return a},_onServiceBrowserError:function(a){this._showErrorMessage(a)},_showErrorMessage:function(a){a&&"string"===typeof a?(this.errorNode.innerHTML=a,h.addClass(this.errorSection,"visible")):h.removeClass(this.errorSection,"visible")},_clearErrorMessage:function(){this.errorNode.innerHTML="";h.removeClass(this.errorSection,"visible")},
_onBtnValidateClick:function(){this._clearErrorMessage();var a=new p;if(this.urlInput.validate()){var b=this.urlInput.get("value");this.serviceBrowser.setUrl(b).then(c.hitch(this,function(){this.domNode&&this._checkSelectedItemsNumber();a.resolve()}),c.hitch(this,function(){this.domNode&&this._checkSelectedItemsNumber();a.reject()}));this.emit("validate-click")}else a.reject();return a},_checkSelectedItemsNumber:function(){0<this.getSelectedItems().length?h.removeClass(this.btnOk,"jimu-state-disabled"):
h.addClass(this.btnOk,"jimu-state-disabled")},_onTreeClick:function(){this._checkSelectedItemsNumber()},_onBtnOkClick:function(){var a=this.getSelectedItems();0<a.length&&this.emit("ok",a)},_onBtnCancelClick:function(){this.emit("cancel")}})})},"builder/plugins/attribute-config/dataSource/DataSourceConfigPopup":function(){define("dojo/_base/declare dojo/Evented dojo/on dojo/_base/lang dojo/_base/html jimu/dijit/Popup ./DataSourceConfig".split(" "),function(r,l,d,q,k,m,p){return r([m,l],{width:830,
height:580,titleLabel:"",dijitArgs:null,postCreate:function(){this.inherited(arguments);k.addClass(this.domNode,"data-source-config-popup");this._initDataSourceConfig()},_initDataSourceConfig:function(){this.dataSourceConfig=new p(this.dijitArgs);this.dataSourceConfig.placeAt(this.contentContainerNode);this.dataSourceConfig.startup();this.own(d(this.dataSourceConfig,"ok",q.hitch(this,function(d){this.emit("ok",d)})));this.own(d(this.dataSourceConfig,"cancel",q.hitch(this,function(){this.emit("cancel")})))}})})},
"builder/plugins/attribute-config/dataSource/DataSourceConfig":function(){define("dojo/_base/declare dojo/Evented dijit/_WidgetBase dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dojo/text!./DataSourceConfig.html dojo/on dojo/_base/html dojo/_base/query dojo/dom-style jimu/dijit/Popup jimu/dijit/Filter dojo/_base/lang dojo/_base/array dojo/Deferred esri/request esri/tasks/query esri/tasks/QueryTask jimu/dijit/CheckBox jimu/dijit/Message jimu/utils jimu/Query jimu/LayerInfos/LayerInfos ./DataFields ./utils jimu/DataSourceManager jimu/dijit/DataPreviewTable jimu/dijit/LoadingIndicator dijit/form/ValidationTextBox dijit/form/Select dijit/form/NumberTextBox".split(" "),
function(r,l,d,q,k,m,p,h,e,c,b,a,g,u,n,t,f,v,x,w,z,A,y,B,C,E,D,F){return r([d,l,q,k],{templateString:m,baseClass:"data-sources-config",_layerDefinition:null,_filterObj:null,_filterByExtent:!1,_numberFieldTypes:["esriFieldTypeSmallInteger","esriFieldTypeInteger","esriFieldTypeSingle","esriFieldTypeDouble"],postMixInProperties:function(){this.nls=g.mixin(this.nls,window.jimuNls.common)},postCreate:function(){this.inherited(arguments);this.setConfig(this.config);this._initEvent()},setConfig:function(a){a&&
(this.config=a,"Features"===this.config.type?(c.set(this.layerOnlyOption,{display:"block"}),this._initFeaturesFields()):"FeatureStatistics"===this.config.type&&(c.set(this.statisticsOnlyOption,{display:"block"}),this._initFeatureStatisticsFields()),this.reset(),this.sourceName.setValue(this.config.label||""),this.sourceUrl.set("value",this.config.url||""),this.sourceUrl.title=this.config.url||"",this.config.filter&&(this._filterObj=this.config.filter),"FeatureStatistics"!==this.config.type&&"undefined"!==
typeof this.config.filterByExtent&&(this._filterByExtent=this.config.filterByExtent),this._refreshFilterBtnDisplay(),this._setFilterExpr(),this._getDefinition().then(g.hitch(this,function(){this.queryType=A.getQueryType(this._layerDefinition);this._setRefreshInterval();"Features"===this.config.type?(this._setFeaturesFields(),this._setRecords(),this._setOrderByFieldForRecords()):"FeatureStatistics"===this.config.type&&(this._setStatisticsFields(),this._setGroupByFields())})))},_setFilterExpr:function(){var a=
"";this._filterObj&&(a=this._filterObj.expr);this._filterByExtent&&(a&&(a+="\x26"),a+="Extent\x3d"+!!this._filterByExtent);a||(a=this.nls.noFilter);this.filterExpr.innerText="";this.filterExpr.innerText=a},_initFeaturesFields:function(){this.featuresFields=new B({nls:{moveUp:window.jimuNls.simpleTable.moveUp,moveDown:window.jimuNls.simpleTable.moveDown}});this.featuresFields.placeAt(this.fieldsOption);this.featuresFields.startup();this.own(p(this.featuresFields,"change",g.hitch(this,function(){this._layerDefinition&&
this._setOrderByFieldForRecords()})))},_setFeaturesFields:function(){var a=this._getFilteredFields(this._layerDefinition.fields,"esriFieldTypeGeometry");this.featuresFields.setFields(this._keepRequiredFields(a,!0));this.config.dataSchema&&z.isNotEmptyObject(this.config.dataSchema.fields)&&this.featuresFields.selectFields(this._getFieldsNames(this.config.dataSchema.fields,!1))},_setRecords:function(){3===this.queryType?(this._updateOptions(this.resultRecordType,null,"serviceLimitation"),this.resultRecordType.set("disabled",
!0)):(this.resultRecordType.set("disabled",!1),this.config.resultRecordType&&(this._updateOptions(this.resultRecordType,null,this.config.resultRecordType),"undefined"!==typeof this.config.resultRecordCount&&"custom"===this.config.resultRecordType&&this.customNumber.setValue(this.config.resultRecordCount)))},_setOrderByFieldForRecords:function(){if(1===this.queryType){this.orderFields.set("disabled",!1);var a=this._getFieldsForOrderBy();this._updateOptions(this.orderFields,a);if(this.config.dataSchema&&
z.isNotEmptyObject(this.config.dataSchema.orderByFields)){var a=this.config.dataSchema.orderByFields[0].split(" ")[0],a=this._getFieldLabelByFieldName(a),b=this.config.dataSchema.orderByFields[0].split(" ")[1];this._updateOptions(this.orderFields,null,a);"DESC"===b?this._onOrderClick(!1):this._onOrderClick(!0)}}else this.orderFields.set("disabled",!0)},_initFeatureStatisticsFields:function(){this.statisticsFields=new B({nls:{moveUp:window.jimuNls.simpleTable.moveUp,moveDown:window.jimuNls.simpleTable.moveDown}});
this.statisticsFields.placeAt(this.statisticsFieldsOption);this.statisticsFields.startup()},_setStatisticsFields:function(){var a=this._hasNumberFields(this._layerDefinition);a&&(a=this._getFilteredFields(a,"esriFieldTypeOID"),a=this._getFilteredFields(a,"esriFieldTypeGeometry"),this.statisticsFields.setFields(a),this.config.dataSchema&&z.isNotEmptyObject(this.config.dataSchema.fields)&&(a=this._getFieldsNames(this.config.dataSchema.fields,!1),this.config.dataSchema.groupByFields&&0<this.config.dataSchema.groupByFields.length&&
a.splice(a.indexOf(this.config.dataSchema.groupByFields[0]),1),this.statisticsFields.selectFields(a)))},_setGroupByFields:function(){if(this._layerDefinition&&this._layerDefinition.fields){var a=this._getFilteredFields(this._layerDefinition.fields,"esriFieldTypeGeometry"),a=this._handleFieldsForSelectOption(a);a.unshift({label:"-",value:"-"});this._updateOptions(this.groupFields,a);this.config.dataSchema&&this.config.dataSchema.groupByFields&&(a=this._getFieldLabelByFieldName(this.config.dataSchema.groupByFields[0]),
this._updateOptions(this.groupFields,null,a))}},_createFilterPopup:function(a){this.filterDomNode=h.toDom('\x3cdiv class\x3d"data-sources-filter"\x3e\x3cdiv class\x3d"filter-label"\x3e'+this.nls.extent+'\x3c/div\x3e\x3cdiv class\x3d"filterByExtent" style\x3d"margin-top: 10px;"\x3e\x3c/div\x3e\x3cdiv style\x3d"margin-top: 20px;" class\x3d"filter-label queryCritiera"\x3e'+this.nls.queryCritiera+'\x3c/div\x3e\x3cdiv style\x3d"margin-top: 15px;" class\x3d"filterDiv"\x3e\x3c/div\x3e\x3cdiv class\x3d"footer"\x3e\x3cdiv class\x3d"jimu-float-leading sample-btn data-preview textOverFlow"\x3e'+
this.nls.sampleData+'\x3c/div\x3e\x3cdiv class\x3d"jimu-btn jimu-float-trailing cancel btnCancel"\x3e'+this.nls.cancel+'\x3c/div\x3e\x3cdiv class\x3d"jimu-btn jimu-float-trailing ok jimu-trailing-margin1 btnOk"\x3e'+this.nls.ok+"\x3c/div\x3e\x3c/div\x3e\x3c/div\x3e");if("FeatureStatistics"!==this.config.type){h.setStyle(e(".filter-label",this.filterDomNode)[0],"display","block");h.setStyle(e(".filterByExtent",this.filterDomNode)[0],"display","block");h.setStyle(e(".queryCritiera",this.filterDomNode)[0],
"margin-top","20px");var c=e(".filterByExtent",this.filterDomNode)[0];this.cbxFilterByExtent=new x({label:this.nls.filterByExtentLabel});this.cbxFilterByExtent.placeAt(c)}else h.setStyle(e(".filter-label",this.filterDomNode)[0],"display","none"),h.setStyle(e(".filterByExtent",this.filterDomNode)[0],"display","none"),h.setStyle(e(".queryCritiera",this.filterDomNode)[0],"margin-top","0");this.popup=new b({titleLabel:this.nls.dataSourceFilter,width:680,height:485,content:this.filterDomNode});c=this.sourceUrl.getValue().trim();
"set"===a?this._createNewFilter(c,"1\x3d1"):"config"===a&&this._editFilter(c,this._filterObj);a=e(".footer .btnOk",this.filterDomNode)[0];this.own(p(a,"click",g.hitch(this,function(){var a=this.filter.toJson();if(!a||!a.expr)return new w({message:window.jimuNls.filterBuilder.setFilterTip}),null;"FeatureStatistics"!==this.config.type&&(this._filterByExtent=this.cbxFilterByExtent.checked);this._filterObj=a;this._setFilterExpr();this.filter.destroy();this.filter=null;this.popup.close();this.popup=null;
this._refreshFilterBtnDisplay()})));a=e(".footer .btnCancel",this.filterDomNode)[0];this.own(p(a,"click",g.hitch(this,function(){this.filter.destroy();this.filter=null;this.popup.close();this.popup=null})));a=e(".sample-btn",this.filterDomNode)[0];this.own(p(a,"click",g.hitch(this,this._onSampleDataClick)))},_createFilter:function(){this.filter=new a({nls:this.nls,enableAskForValues:!1,noFilterTip:window.jimuNls.filterBuilder.error.noFilterFields,style:"width:100%;"});var b=e(".filterDiv",this.filterDomNode)[0];
this.filter.placeAt(b)},_editFilter:function(a,b){this._createFilter();this.filter.buildByFilterObj(a,b,this._layerDefinition);this._filterByExtent&&this.cbxFilterByExtent.check()},_createNewFilter:function(a,b){this._createFilter();this.filter.buildByExpr(a,b,this._layerDefinition)},getConfig:function(){var a={};a.type=this.config.type;var b=!!this.isDynamic.checked;if(b){var c=this.refreshInterval.getValue();c&&(a.refreshInterval=Number(c))}a.isDynamic=b;a.label=this.sourceName.getValue();a.url=
this.sourceUrl.getValue().trim();"FeatureStatistics"!==this.config.type&&(a.filterByExtent=this._filterByExtent);this._filterObj&&(a.filter=this._filterObj);"Features"===this.config.type&&(a=this._getFeaturesRecord(a));b=this._getVaildDataSchema();a.dataSchema=b;return a},_getFeaturesRecord:function(a){var b=this.resultRecordType.getValue();a.resultRecordType=b;"custom"===b&&(b=this.customNumber.getValue())&&(a.resultRecordCount=parseInt(b,10));return a},_getVaildDataSchema:function(){var a={},b,
c;b=z.getDataSchemaFromLayerDefinition(this._layerDefinition);b.objectIdField&&(a.objectIdFieldName=b.objectIdField.name||"");a.geometryType=b.geometryType||"";a.displayFieldName=b.displayField||"";a.typeIdField=b.typeIdField||"";if("Features"===this.config.type){if(b=this.featuresFields.getSelectedFieldNames(),b=this._getFieldsByFieldNames(b),a.fields=b||[],b=this.orderFields.getValue())b=this._getFieldNameByFieldLabel(b),c=[],c.push(b+" "+this._getSelectedOrder()),a.orderByFields=c}else"FeatureStatistics"===
this.config.type&&(c=this.statisticsFields.getSelectedFieldNames(),0===c.length&&a.objectIdFieldName&&c.push(a.objectIdFieldName),b=this._getFieldsByFieldNames(c),a.statistics=this._getStatisticDefinition(b,a.objectIdFieldName),b=g.clone(c),(c=this._getFieldNameByFieldLabel(this.groupFields.getValue()))?(b.push(c),a.groupByFields=[c]):a.groupByFields=[],a.fields=this._getFieldsByFieldNames(b)||[]);return a},_getFieldsByFieldNames:function(a){if(a)return 0===a.length?[]:a.map(g.hitch(this,function(a){return this._getFieldByFieldName(a)}))},
_getStatisticFields:function(a){var b=[];if(0>=a.length)return b;"count sum min max avg stddev".split(" ").forEach(g.hitch(this,function(c){"count"===c?b.push(this._getFormatStatisticField(a[0],c)):a.forEach(g.hitch(this,function(a){b.push(this._getFormatStatisticField(a,c))}))}));return b},_getFormatStatisticField:function(a,b){if(z.isNotEmptyObject(a)&&!Array.isArray(a))return a=g.clone(a),a.name=a.name+"_"+b,a},_getStatisticDefinition:function(a,b){var c=[];["count","sum","min","max","avg"].forEach(g.hitch(this,
function(d){"count"===d?c.push(this._getFormatStatisticDefinition(d,b)):a.forEach(g.hitch(this,function(a){c.push(this._getFormatStatisticDefinition(d,b,a))}))}));return c},_getFormatStatisticDefinition:function(a,b,c){var d={};if("count"===a)return d.onStatisticField=b||"*",d.outStatisticFieldName="count",d.statisticType=a,d;d.onStatisticField=c.name;d.outStatisticFieldName=c.name+"_"+a;d.statisticType=a;return d},_getDefinition:function(){var a=new n;z.isObject(this.config.definition)?(this._layerDefinition=
this.config.definition,a.resolve()):(this.loading.show(),t({url:this.config.url,content:{f:"json"},handleAs:"json"}).then(g.hitch(this,function(b){this.domNode?(this.loading.hide(),this._layerDefinition=b,a.resolve(b)):a.reject()}),g.hitch(this,function(b){console.error(b);a.reject();this.domNode&&this.loading.hide()})));return a},reset:function(){this.sourceName.setValue("");this.sourceUrl.set("value","");this.isDynamic.checked=!1;this.isDynamic.setStatus(!0);this.refreshInterval.set("disabled",
!1);this.resultRecordType.set("disabled",!1);this.orderFields.set("disabled",!1);this._layerDefinition=null;this._filterByExtent=!1;this._filterObj=null;this.filterExpr.innerText="";this._refreshFilterBtnDisplay();"Features"===this.config.type?(this.featuresFields.setFields([]),this._updateOptions(this.resultRecordType),this._updateOptions(this.orderFields,[]),this._onOrderClick(!0),h.addClass(this.customNumberDiv,"hide")):"FeatureStatistics"===this.config.type&&(this._updateOptions(this.groupFields,
[{label:"-",value:"-"}]),this.statisticsFields.setFields([]))},_onFeaturesFieldsClick:function(a){a.stopPropagation();h.hasClass(this.fieldsOptionDiv,"hide")?h.removeClass(this.fieldsOptionDiv,"hide"):h.addClass(this.fieldsOptionDiv,"hide")},_showStatisticsFieldsList:function(){h.removeClass(this.statisticsFieldsOptionDiv,"hide")},_hideStatisticsFieldsList:function(){h.addClass(this.statisticsFieldsOptionDiv,"hide")},_onStatisticsFieldsClick:function(a){a.stopPropagation();h.hasClass(this.statisticsFieldsOptionDiv,
"hide")?this._showStatisticsFieldsList():this._hideStatisticsFieldsList()},_getFieldsNames:function(a,b){return a&&0!==a.length?a.map(function(a){return b?a.alias||a.name:a.name}):[]},_getStatisticsFieldRealNames:function(a){if(!a||0===a.length)return[];a=a.map(function(a){return a.replace(/(_count|_sum|_max|_min|_avg|_stddev)$/,"")});a=z.uniqueArray(a);if(this.config.dataSchema.groupByFields){var b=this.config.dataSchema.groupByFields[0];b&&"-"!==b&&(a=a.filter(function(a){return a!==b}))}return a},
_getFieldsForOrderBy:function(){var a=[],b=this.featuresFields.getSelectedFieldNames();b&&0<b.length&&(a=this._getFieldsByFieldNames(b),a=this._getFilteredFields(a,"esriFieldTypeGeometry"),a=this._handleFieldsForSelectOption(a));return a},_getFieldByFieldName:function(a){if(this._layerDefinition&&this._layerDefinition.fields){var b;this._layerDefinition.fields.forEach(function(c){c.name===a&&(b=c)});return b}},_getFieldNameByFieldLabel:function(a){if(this._layerDefinition&&this._layerDefinition.fields){var b;
this._layerDefinition.fields.forEach(function(c){if(c.alias===a||c.name===a)b=c.name});return b}},_getFieldLabelByFieldName:function(a){if(this._layerDefinition&&this._layerDefinition.fields){var b;this._layerDefinition.fields.forEach(function(c){c.name===a&&(b=c.alias||c.name)});return b}},_handleFieldsForSelectOption:function(a){return!a||0>=a.length?[]:a=a.map(function(b){var c;"object"===typeof a[0]?c=b.alias||b.name:"string"===typeof a[0]&&(c=b);return{label:c,value:c}})},_updateOptions:function(a,
b,c){b?(a.removeOption(a.getOptions()),a.addOption(b)):b=[];!c&&0<b.length&&(c=b[0].value);c&&a.set("value",c)},_setRefreshInterval:function(){this._settingRefreshIntervalFromMapLayer()||(this.config.isDynamic?(this.isDynamic.check(),this.config.refreshInterval&&this.refreshInterval.setValue(this.config.refreshInterval)):this.isDynamic.uncheck())},_settingRefreshIntervalFromMapLayer:function(){var a;this.config.layerInfo?a=this.config.layerInfo:this.config.id&&"map"===this.config.id.split("~")[0]&&
(a=this.config.id.split("~")[1],a=y.getInstanceSync().getLayerInfoById(a));if(a&&a.layerObject&&a.layerObject.refreshInterval)return this.isDynamic.check(),this.refreshInterval.setValue(a.layerObject.refreshInterval),this.refreshInterval.set("disabled",!0),this.isDynamic.setStatus(!1),!0},_checkConfigValue:function(){var a=!0;this.sourceName.getValue()&&this.sourceUrl.getValue().trim()||(a=!1);!this.isDynamic.checked||this.refreshInterval.isValid()&&this.refreshInterval.getValue()||(a=!1);"custom"!==
this.resultRecordType.getValue()||this.customNumber.isValid()||(a=!1);if("FeatureStatistics"===this.config.type){var b=this.statisticsFields.getSelectedFieldNames(),c=this._getFieldNameByFieldLabel(this.groupFields.getValue());-1<b.indexOf(c)&&(new w({message:this.nls.groupFieldIsNotAllowedInStatistics}),a=!1)}return a},_hasNumberFields:function(a){var b=!1;(a=a.fields)&&0<a.length&&(b=u.filter(a,g.hitch(this,function(a){return 0<=this._numberFieldTypes.indexOf(a.type)})));return b},_refreshFilterBtnDisplay:function(){this._filterObj||
this._filterByExtent?(h.addClass(this.btnConfig,"visible"),h.addClass(this.btnRemove,"visible"),h.removeClass(this.btnSet,"visible")):(h.removeClass(this.btnConfig,"visible"),h.removeClass(this.btnRemove,"visible"),h.addClass(this.btnSet,"visible"))},_initEvent:function(){this.own(p(document.body,"click",g.hitch(this,function(a){var b=a.target||a.srcElement;this.featuresFields?(a=b===this.featuresFields.domNode,b=h.isDescendant(b,this.featuresFields.domNode),a||b||h.addClass(this.fieldsOptionDiv,
"hide")):this.statisticsFields&&(a=b===this.statisticsFields.domNode,b=h.isDescendant(b,this.statisticsFields.domNode),a||b||h.addClass(this.statisticsFieldsOptionDiv,"hide"))})));this.own(p(this.resultRecordType,"change",g.hitch(this,function(a){"custom"===a?h.removeClass(this.customNumberDiv,"hide"):h.addClass(this.customNumberDiv,"hide")})));this.own(p(this.btnOk,"click",g.hitch(this,function(){this._checkConfigValue()&&this.emit("ok",this.getConfig())})));this.own(p(this.btnCancel,"click",g.hitch(this,
function(){this.emit("cancel")})));this.own(p(this.ascBtn,"click",g.hitch(this,function(){this._onOrderClick(!0)})));this.own(p(this.descBtn,"click",g.hitch(this,function(){this._onOrderClick()})));this._initFilterBtnEvent()},_onOrderClick:function(a){a?(h.addClass(this.ascBtn,"selected"),h.removeClass(this.descBtn,"selected")):(h.removeClass(this.ascBtn,"selected"),h.addClass(this.descBtn,"selected"))},_getSelectedOrder:function(){var a;h.hasClass(this.ascBtn,"selected")?a="ASC":h.hasClass(this.descBtn,
"selected")&&(a="DESC");return a},_initFilterBtnEvent:function(){this.own(p(this.btnSet,"click",g.hitch(this,function(){this._createFilterPopup("set")})));this.own(p(this.btnConfig,"click",g.hitch(this,function(){this._createFilterPopup("config")})));this.own(p(this.btnRemove,"click",g.hitch(this,function(){var a=new w({message:this.nls.removeFilterMessage,buttons:[{label:this.nls.ok,onClick:g.hitch(this,function(){this._filterObj=null;this._filterByExtent=!1;this._setFilterExpr();this._refreshFilterBtnDisplay();
a.content=null;a.close()})},{label:this.nls.cancel,onClick:g.hitch(this,function(){a.content=null;a.close()})}]})})))},_keepRequiredFields:function(a,b){return a?a=a.map(function(a){"undefined"!==typeof a.nullable?(a.checked=!a.nullable,a.disabled=!a.nullable):(a.checked="esriFieldTypeOID"===a.type,a.disabled="esriFieldTypeOID"===a.type);b&&(a.checked=!0);return a}):[]},_getFilteredFields:function(a,b){return a?a=a.filter(function(a){return a.type!==b}):[]},_isServiceSupportsOrderBy:function(a){var b=
!1;a.advancedQueryCapabilities&&a.advancedQueryCapabilities.supportsOrderBy&&(b=!0);return b},_onSampleDataClick:function(){var a=new v(this.config.url),b=new f;b.where="1\x3d1";b.outFields=["*"];b.returnGeometry=!1;a.execute(b).then(g.hitch(this,function(a){a.features=a.features.slice(0,10);this._showDataPreviewTable(a,"sampleData")}))},_onPreviewClick:function(){if(this._checkConfigValue()){this.dataPreviewTableLoading||(this.dataPreviewTableLoading=new F,this.dataPreviewTableLoading.placeAt(this.domNode));
this.dataPreviewTableLoading.show();var a=g.clone(this.getConfig());a.id=this.config.id?this.config.id:C.createDataSourceId(this.config.serviceType,this.config.layerInfo?this.config.layerInfo.id:null);E.getInstance().doQuery(a).then(g.hitch(this,function(b){if(a.dataSchema.groupByFields&&0<a.dataSchema.groupByFields.length)var c=a.dataSchema.groupByFields.length[0];b.fields&&(b.fields=b.fields.sort(function(a,b){return a.name===c?1:a.name-b.name}));this._showDataPreviewTable(b,"preview")}),g.hitch(this,
function(){this.dataPreviewTableLoading.hide()}))}},_showDataPreviewTable:function(a,c){this.dataPreviewPopup=new b({titleLabel:"preview"===c?this.nls.preview:this.nls.sampleData,width:800,height:610,content:new D({height:610,featureSet:a,loadingIndicator:this.dataPreviewTableLoading}),onClose:g.hitch(this,function(){this.dataPreviewTableLoading&&this.dataPreviewTableLoading.hide&&this.dataPreviewTableLoading.hide()})});h.addClass(this.dataPreviewPopup.domNode,"data-preview-popup")},destroy:function(){this.filter&&
this.filter.destroy();this.dataPreviewTableLoading&&this.dataPreviewTableLoading.destroy();this.dataPreviewPopup&&this.dataPreviewPopup.destroy();this.inherited(arguments)}})})},"dojo/_base/query":function(){define(["../query","./NodeList"],function(r){return r})},"jimu/dijit/Filter":function(){define("dojo/Evented dojo/_base/declare dijit/_WidgetBase dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dojo/text!./templates/Filter.html jimu/filterUtils jimu/utils jimu/dijit/_filter/ValueProviderFactory dijit/registry dojo/_base/lang dojo/_base/html dojo/_base/array dojo/aspect dojo/Deferred esri/request ./_SingleFilter ./_FilterSet ./LoadingIndicator".split(" "),
function(r,l,d,q,k,m,p,h,e,c,b,a,g,u,n,t,f,v){return l([d,q,k,p,r],{templateString:m,baseClass:"jimu-filter",declaredClass:"jimu.dijit.Filter",nls:null,_validOptions:!1,_layerDefinition:null,_def:null,valueProviderFactory:null,noFilterTip:"",enableAskForValues:!1,postMixInProperties:function(){this.nls=window.jimuNls.filterBuilder;var a=this.nls.matchMsg.split("${any_or_all}");this.nls.strMatchMsgPart1=a[0]||"";this.nls.strMatchMsgPart2=a[1]||"";this.inherited(arguments)},postCreate:function(){this.inherited(arguments);
this.noFilterTip&&"string"===typeof this.noFilterTip&&(this.noFilterTipSection.innerHTML=this.noFilterTip)},reset:function(){this.isBuilding()||(this.removeAllFilters(),this.url=null,this.isHosted=!1,this.valueProviderFactory=this.partsObj=this.expr=this._layerDefinition=null)},isBuilding:function(){return this._def&&!this._def.isFulfilled()},buildByExpr:function(a,b,c){var d=new n;this.isBuilding()?d.reject("Filter is already building."):(this._def=null,this.reset(),this.url=a,this.isHosted=h.isHostedService(this.url),
this.expr=b||"1\x3d1",this._layerDefinition=c,d=this._def=this._init("expr"));return d},buildByFilterObj:function(a,b,c){var d=new n;this.isBuilding()?d.reject("Filter is already building."):(this._def=null,this.reset(),this.url=a,this.isHosted=h.isHostedService(this.url),this.partsObj=this._updatePartsObj(b),this._layerDefinition=c,d=this._def=this._init("partsObj"));return d},_updatePartsObj:function(a){g.forEach(a,b.hitch(this,function(a){a.parts?g.forEach(a.parts,b.hitch(this,function(a){a.interactiveObj&&
!0===a.interactiveObj.cascade?a.interactiveObj.cascade="previous":!1===a.interactiveObj.cascade&&(a.interactiveObj.cascade="none")})):a.interactiveObj&&!0===a.interactiveObj.cascade?a.interactiveObj.cascade="previous":!1===a.interactiveObj.cascade&&(a.interactiveObj.cascade="none")}));return a},removeAllFilters:function(){this._destroyAllFilters()},_getLayerDefinitionRaw:function(a,c){var d=new n;c?d.resolve(c):(this.loading.show(),t({url:a,content:{f:"json"},handleAs:"json",callbackParamName:"callback"}).then(b.hitch(this,
function(a){this.domNode?(this.loading.hide(),d.resolve(a)):d.reject()}),b.hitch(this,function(a){console.error(a);d.reject();this.domNode&&this.loading.hide()})));return d},_validateLayerDefinition:function(a){return this._isObject(a)},_init:function(c){var d=new n;if(!this._isString(this.url))return d.reject(),d;var f=b.hitch(this,function(){setTimeout(b.hitch(this,function(){d.resolve()}),1500)}),h=b.hitch(this,function(){a.setStyle(this.contentSection,"display","block");a.setStyle(this.errorSection,
"display","none");this.removeAllFilters();var h=this._layerDefinition.fields;h&&0<h.length?(h=g.filter(h,b.hitch(this,function(a){return 0<=this._supportFieldTypes.indexOf(a.type)})))&&0<h.length?(this._validOptions=!0,a.removeClass(this.btnAddSet,"jimu-state-disabled"),a.removeClass(this.btnAddExp,"jimu-state-disabled"),a.removeClass(this.iconAddExp,"jimu-state-disabled"),a.removeClass(this.iconAddSet,"jimu-state-disabled"),this.createFieldsStore(),this.valueProviderFactory=new e({url:this.url,layerDefinition:this._layerDefinition}),
"expr"===c?this._isString(this.expr)?("1\x3d1"===this.expr.replace(/\s/gi,"")&&this.removeAllFilters(),this._parseExpr(this.expr)?f():d.reject()):d.reject():"partsObj"===c?this._validatePartsObj(this.partsObj)?(this._parsePartsObj(this.partsObj),f()):d.reject():this._validatePartsObj(this.partsObj)?(this._parsePartsObj(this.partsObj),f()):this._isString(this.expr)?this._parseExpr(this.expr)?f():d.reject():(this.removeAllFilters(),f())):(this._showErrorOptions(this.nls.error.noFilterFields),d.reject()):
d.reject()});this._validateLayerDefinition(this._layerDefinition)?h():(this.loading.show(),t({url:this.url,content:{f:"json"},handleAs:"json",callbackParamName:"callback"}).then(b.hitch(this,function(a){this.domNode?(this.loading.hide(),this._layerDefinition=a,h()):d.reject()}),b.hitch(this,function(a){console.error(a);d.reject();this.domNode&&this.loading.hide()})));return d},toJson:function(){var a={logicalOperator:this.allAnySelect.value,parts:[]},c=this._getAllSingleFiltersAndFilterSets();if(0===
c.length)return a.expr="1\x3d1",a;g.forEach(c,b.hitch(this,function(b){b=b.toJson();a.parts.push(b)}));return g.every(a.parts,b.hitch(this,function(a){return!!a}))&&0<a.parts.length?(a.expr=this.getExprByFilterObj(a),a):null},createFieldsStore:function(){if(this._layerDefinition.fields&&0!==this._layerDefinition.fields.length){var a=b.clone(this._layerDefinition).fields;0===this.setFieldsStoreByFieldInfos(a)&&this._showErrorOptions(this.nls.error.noFilterFields)}else this._showErrorOptions(this.nls.error.noFilterFields)},
_parsePartsObj:function(a){this._validatePartsObj(a)&&(this.removeAllFilters(),this._buildEditUIByPartsObj(a))},_parseExpr:function(a){this._destroyAllFilters();var b=null;if(!this._validateLayerDefinition(this._layerDefinition))return b;if(!a||"string"!==typeof a)return this._showErrorOptions(this.nls.error.invalidSQL),b;if("1\x3d1"===this.expr.replace(/\s/gi,""))return b={expr:"1\x3d1",parts:[],logicalOperator:"AND"};try{b=this.getFilterObjByExpr(a)}catch(z){b=null,console.error(z)}b?this._buildEditUIByPartsObj(b):
this._showErrorOptions(this.nls.error.cantParseSQL);return b},_buildEditUIByPartsObj:function(a){a&&(this._destroyAllFilters(),this.allAnySelect.value=a.logicalOperator,g.forEach(a.parts,b.hitch(this,function(a){a.parts?this._addFilterSet(a):a.fieldObj&&a.operator&&a.valueObj&&this._addSingleFilter(a)})))},_addSingleFilter:function(a){a={url:this.url,layerInfo:this._layerDefinition,stringFieldType:this._stringFieldType,dateFieldType:this._dateFieldType,numberFieldTypes:this._numberFieldTypes,part:a,
OPERATORS:b.mixin({},this.OPERATORS),enableAskForValues:this.enableAskForValues,isHosted:this.isHosted,valueProviderFactory:this.valueProviderFactory};a=new f(a);a.placeAt(this.allExpsBox);a.startup();this.own(u.after(a,"_destroySelf",b.hitch(this,this._checkFilterNumbers)));this._checkFilterNumbers()},_addFilterSet:function(a){a={url:this.url,layerInfo:this._layerDefinition,stringFieldType:this._stringFieldType,dateFieldType:this._dateFieldType,numberFieldTypes:this._numberFieldTypes,partsObj:a,
OPERATORS:b.mixin({},this.OPERATORS),enableAskForValues:this.enableAskForValues,isHosted:this.isHosted,valueProviderFactory:this.valueProviderFactory};a=new v(a);a.placeAt(this.allExpsBox);a.startup();this.own(u.after(a,"_destroySelf",b.hitch(this,this._checkFilterNumbers)));this._checkFilterNumbers()},_destroyAllFilters:function(){for(var a=this._getAllSingleFiltersAndFilterSets();0<a.length;)a[0].destroy(),a.splice(0,1);this._checkFilterNumbers()},_getAllSingleFiltersAndFilterSetsDoms:function(){var c=
[];this.allExpsBox.childNodes&&0<this.allExpsBox.childNodes.length&&g.forEach(this.allExpsBox.childNodes,b.hitch(this,function(b){(a.hasClass(b,"jimu-single-filter")||a.hasClass(b,"jimu-filter-set"))&&c.push(b)}));return c},_getAllSingleFiltersAndFilterSets:function(){var a=this._getAllSingleFiltersAndFilterSetsDoms();return g.map(a,b.hitch(this,function(a){return c.byNode(a)}))},_checkFilterNumbers:function(){var c=this._getAllSingleFiltersAndFilterSetsDoms();1<c.length?a.setStyle(this.matchMsg,
"display","block"):a.setStyle(this.matchMsg,"display","none");0<c.length?a.setStyle(this.noFilterTipSection,"display","none"):a.setStyle(this.noFilterTipSection,"display","block");g.forEach(c,b.hitch(this,function(b,c){a.removeClass(b,"even-filter");a.removeClass(b,"odd-filter");a.addClass(b,0===(c+1)%2?"even-filter":"odd-filter")}));this.emit("filter-number-change")},_showErrorOptions:function(b){console.error(b);a.setStyle(this.errorSection,"display","none");this.errorTip.innerHTML=b;this.loading.hide()},
_onBtnAddSetClick:function(){this._layerDefinition&&this._validOptions&&this._addFilterSet()},_onBtnAddExpClick:function(){this._layerDefinition&&this._validOptions&&this._addSingleFilter()}})})},"jimu/filterUtils":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/date/locale esri/lang dojo/data/ItemFileWriteStore jimu/utils".split(" "),function(r,l,d,q,k,m,p){return r([],{_stringFieldType:"esriFieldTypeString",_dateFieldType:"esriFieldTypeDate",_numberFieldTypes:["esriFieldTypeOID",
"esriFieldTypeSmallInteger","esriFieldTypeInteger","esriFieldTypeSingle","esriFieldTypeDouble"],_supportFieldTypes:[],dayInMS:86399E3,fieldsStore:null,isHosted:!1,constructor:function(){String.prototype.startsWith=function(d){return 0===this.indexOf(d)};String.prototype.endsWith=function(d){return this.substring(this.length-d.length)===d};String.prototype.count=function(d){return this.split(d).length-1};String.prototype.trim||(String.prototype.trim=l.trim);this._supportFieldTypes=[];this._supportFieldTypes.push(this._stringFieldType);
this._supportFieldTypes.push(this._dateFieldType);this._supportFieldTypes=this._supportFieldTypes.concat(this._numberFieldTypes)},OPERATORS:{stringOperatorIs:"stringOperatorIs",stringOperatorIsNot:"stringOperatorIsNot",stringOperatorStartsWith:"stringOperatorStartsWith",stringOperatorEndsWith:"stringOperatorEndsWith",stringOperatorContains:"stringOperatorContains",stringOperatorDoesNotContain:"stringOperatorDoesNotContain",stringOperatorIsBlank:"stringOperatorIsBlank",stringOperatorIsNotBlank:"stringOperatorIsNotBlank",
numberOperatorIs:"numberOperatorIs",numberOperatorIsNot:"numberOperatorIsNot",numberOperatorIsAtLeast:"numberOperatorIsAtLeast",numberOperatorIsLessThan:"numberOperatorIsLessThan",numberOperatorIsAtMost:"numberOperatorIsAtMost",numberOperatorIsGreaterThan:"numberOperatorIsGreaterThan",numberOperatorIsBetween:"numberOperatorIsBetween",numberOperatorIsNotBetween:"numberOperatorIsNotBetween",numberOperatorIsBlank:"numberOperatorIsBlank",numberOperatorIsNotBlank:"numberOperatorIsNotBlank",dateOperatorIsOn:"dateOperatorIsOn",
dateOperatorIsNotOn:"dateOperatorIsNotOn",dateOperatorIsBefore:"dateOperatorIsBefore",dateOperatorIsAfter:"dateOperatorIsAfter",dateOperatorIsOnOrBefore:"dateOperatorIsOnOrBefore",dateOperatorIsOnOrAfter:"dateOperatorIsOnOrAfter",dateOperatorIsBetween:"dateOperatorIsBetween",dateOperatorIsNotBetween:"dateOperatorIsNotBetween",dateOperatorIsBlank:"dateOperatorIsBlank",dateOperatorIsNotBlank:"dateOperatorIsNotBlank",dateOperatorInTheLast:"dateOperatorInTheLast",dateOperatorNotInTheLast:"dateOperatorNotInTheLast",
dateOperatorMinutes:"dateOperatorMinutes",dateOperatorHours:"dateOperatorHours",dateOperatorDays:"dateOperatorDays",dateOperatorWeeks:"dateOperatorWeeks",dateOperatorMonths:"dateOperatorMonths",dateOperatorYears:"dateOperatorYears"},prepare:function(d,e){this.isHosted=p.isHostedService(d);this.setFieldsStoreByFieldInfos(e)},isPartsObjHasError:function(h){var e=!1;h&&(e=h.parts&&0<=h.parts.length?d.every(h.parts,l.hitch(this,function(c){return c.parts?0<c.parts.length?d.every(c.parts,l.hitch(this,
function(b){return!b.error})):!1:!c.error})):!1);return!e},isAskForValues:function(h){var e=!1;return e=d.some(h.parts,l.hitch(this,function(c){return c.parts?d.some(c.parts,l.hitch(this,function(b){return!!b.interactiveObj})):!!c.interactiveObj}))},setFieldsStoreByFieldInfos:function(h){h=d.filter(h,l.hitch(this,function(d){return 0<=this._supportFieldTypes.indexOf(d.type)}));h=d.map(h,function(d,c){var b;switch(d.type){case "esriFieldTypeString":b="string";break;case "esriFieldTypeDate":b="date";
break;default:b="number"}return{id:c,label:d.name,shortType:b,alias:d.alias,editable:d.editable,name:d.name,nullable:d.nullable,type:d.type}},this);this.fieldsStore=new m({data:{identifier:"id",label:"label",items:h}});return h.length},_validatePartsObj:function(d){return d&&"object"===typeof d},_isObject:function(d){return d&&"object"===typeof d},_isString:function(d){return d&&"string"===typeof d},containsNonLatinCharacter:function(d){for(var e=0;e<d.length;e++)if(255<d.charCodeAt(e))return!0;return!1},
getExprByFilterObj:function(h){if(!d.every(h.parts,function(a){return!!a}))return null;if(!this.isPartsObjReadyToBuild(h))return h.expr="",h.expr;var e="";if(0===h.parts.length)e="1\x3d1";else if(1===h.parts.length)e=this.builtFilterString(h.parts[0]);else for(var c="",b=0;b<h.parts.length;b++){var a=this.builtFilterString(h.parts[b]);if(!k.isDefined(a))return null;e+=c+"("+a+")";c=c||" "+h.logicalOperator+" "}return h.expr=e},isPartsObjReadyToBuild:function(h){return d.every(h.parts,l.hitch(this,
function(e){return e.parts?d.every(e.parts,l.hitch(this,function(c){return this._isPartReadyToBuild(c)})):this._isPartReadyToBuild(e)}))},_isPartReadyToBuild:function(d){var e=d.fieldObj.shortType,c=d.operator,b=d.valueObj;d=b.type||"value";var a=b.value,g=b.value1,b=b.value2;if("value"===d){if("string"===e)return c===this.OPERATORS.stringOperatorIsBlank||c===this.OPERATORS.stringOperatorIsNotBlank?!0:p.isNotEmptyString(a);if("number"===e)return c===this.OPERATORS.numberOperatorIsBlank||c===this.OPERATORS.numberOperatorIsNotBlank?
!0:c===this.OPERATORS.numberOperatorIsBetween||c===this.OPERATORS.numberOperatorIsNotBetween?p.isValidNumber(g)&&p.isValidNumber(b):p.isValidNumber(a);if("date"===e)return c===this.OPERATORS.dateOperatorIsBlank||c===this.OPERATORS.dateOperatorIsNotBlank?!0:c===this.OPERATORS.dateOperatorIsBetween||c===this.OPERATORS.dateOperatorIsNotBetween?p.isNotEmptyString(g)&&p.isNotEmptyString(b):c===this.OPERATORS.dateOperatorInTheLast||c===this.OPERATORS.dateOperatorNotInTheLast?void 0!==a&&null!==a:p.isNotEmptyString(a)}else{if("field"===
d)return p.isNotEmptyString(a);if("unique"===d){if("string"===e)return p.isNotEmptyString(a);if("number"===e)return p.isValidNumber(a)}}return!1},builtFilterString:function(d){var e="";if(d.parts)for(var c="",b=0;b<d.parts.length;b++){var a=d.parts[b],g=this.builtSingleFilterString(a);a.expr=g.whereClause;if(!k.isDefined(g.whereClause))return null;e+=c+g.whereClause;c=" "+d.logicalOperator+" "}else e=this.builtSingleFilterString(d).whereClause;return d.expr=e},_preBuiltSingleFilterString:function(d){if("string"===
d.fieldObj.shortType&&"\x3cNull\x3e"===d.valueObj.value){if(d.operator===this.OPERATORS.stringOperatorIs)return{whereClause:d.fieldObj.name+" IS NULL"};if(d.operator===this.OPERATORS.stringOperatorIsNot)return{whereClause:d.fieldObj.name+" IS NOT NULL"}}if("number"===d.fieldObj.shortType&&"\x3cNull\x3e"===d.valueObj.value){if(d.operator===this.OPERATORS.numberOperatorIs)return{whereClause:d.fieldObj.name+" IS NULL"};if(d.operator===this.OPERATORS.numberOperatorIsNot)return{whereClause:d.fieldObj.name+
" IS NOT NULL"}}return null},builtSingleFilterString:function(d,e){this.isHosted&&(d.caseSensitive=!1);if(k.isDefined(d.valueObj.isValid)&&!d.valueObj.isValid)return{whereClause:null};var c=this._preBuiltSingleFilterString(d);if(c)return c;var c=d.valueObj.value,b=d.valueObj.value1,a=d.valueObj.value2,g=!1;d.interactiveObj&&k.isDefined(e)&&(g=!0,k.isDefined(d.valueObj.value)&&(c="{"+e+"}"),k.isDefined(d.valueObj.value1)&&(b="{"+e+"}"),k.isDefined(d.valueObj.value2)&&(a="{"+(e+1)+"}"));var h="";if("string"===
d.fieldObj.shortType)switch(b="",g&&this.isHosted?b="N":c&&"field"!==d.valueObj.type&&this.isHosted&&this.containsNonLatinCharacter(c)&&(b="N"),d.operator){case this.OPERATORS.stringOperatorIs:h="field"===d.valueObj.type?d.fieldObj.name+" \x3d "+c:d.fieldObj.name+" \x3d "+b+"'"+c.replace(/\'/g,"''")+"'";break;case this.OPERATORS.stringOperatorIsNot:h="field"===d.valueObj.type?d.fieldObj.name+" \x3c\x3e "+c:d.fieldObj.name+" \x3c\x3e "+b+"'"+c.replace(/\'/g,"''")+"'";break;case this.OPERATORS.stringOperatorStartsWith:h=
d.caseSensitive?d.fieldObj.name+" LIKE "+b+"'"+c.replace(/\'/g,"''")+"%'":"UPPER("+d.fieldObj.name+") LIKE UPPER("+b+"'"+c.replace(/\'/g,"''")+"%')";break;case this.OPERATORS.stringOperatorEndsWith:h=d.caseSensitive?d.fieldObj.name+" LIKE "+b+"'%"+c.replace(/\'/g,"''")+"'":"UPPER("+d.fieldObj.name+") LIKE UPPER("+b+"'%"+c.replace(/\'/g,"''")+"')";break;case this.OPERATORS.stringOperatorContains:h=d.caseSensitive?d.fieldObj.name+" LIKE "+b+"'%"+c.replace(/\'/g,"''")+"%'":"UPPER("+d.fieldObj.name+") LIKE UPPER("+
b+"'%"+c.replace(/\'/g,"''")+"%')";break;case this.OPERATORS.stringOperatorDoesNotContain:h=d.caseSensitive?d.fieldObj.name+" NOT LIKE "+b+"'%"+c.replace(/\'/g,"''")+"%'":"UPPER("+d.fieldObj.name+") NOT LIKE UPPER("+b+"'%"+c.replace(/\'/g,"''")+"%')";break;case this.OPERATORS.stringOperatorIsBlank:h=d.fieldObj.name+" IS NULL";break;case this.OPERATORS.stringOperatorIsNotBlank:h=d.fieldObj.name+" IS NOT NULL"}else if("number"===d.fieldObj.shortType)switch(d.operator){case this.OPERATORS.numberOperatorIs:h=
d.fieldObj.name+" \x3d "+c;break;case this.OPERATORS.numberOperatorIsNot:h=d.fieldObj.name+" \x3c\x3e "+c;break;case this.OPERATORS.numberOperatorIsAtLeast:h=d.fieldObj.name+" \x3e\x3d "+c;break;case this.OPERATORS.numberOperatorIsLessThan:h=d.fieldObj.name+" \x3c "+c;break;case this.OPERATORS.numberOperatorIsAtMost:h=d.fieldObj.name+" \x3c\x3d "+c;break;case this.OPERATORS.numberOperatorIsGreaterThan:h=d.fieldObj.name+" \x3e "+c;break;case this.OPERATORS.numberOperatorIsBetween:h=d.fieldObj.name+
" BETWEEN "+b+" AND "+a;break;case this.OPERATORS.numberOperatorIsNotBetween:h=d.fieldObj.name+" NOT BETWEEN "+b+" AND "+a;break;case this.OPERATORS.numberOperatorIsBlank:h=d.fieldObj.name+" IS NULL";break;case this.OPERATORS.numberOperatorIsNotBlank:h=d.fieldObj.name+" IS NOT NULL"}else switch(k.isDefined(c)&&"field"!==d.valueObj.type&&"string"===typeof c&&(c=new Date(c)),"field"!==d.valueObj.type&&(c&&(c=new Date(c)),b&&(b=new Date(b)),a&&(a=new Date(a))),d.operator){case this.OPERATORS.dateOperatorIsOn:h=
"field"===d.valueObj.type?d.fieldObj.name+" \x3d "+c:g?d.fieldObj.name+" BETWEEN "+(this.isHosted?"":"timestamp ")+"'{"+e+"}' AND "+(this.isHosted?"":"timestamp ")+"'{"+(e+1)+"}'":d.fieldObj.name+" BETWEEN "+(this.isHosted?"":"timestamp ")+"'"+this.formatDate(c)+"' AND "+(this.isHosted?"":"timestamp ")+"'"+this.formatDate(this.addDay(c))+"'";break;case this.OPERATORS.dateOperatorIsNotOn:h="field"===d.valueObj.type?d.fieldObj.name+" \x3c\x3e "+c:g?d.fieldObj.name+" NOT BETWEEN "+(this.isHosted?"":
"timestamp ")+"'{"+e+"}' AND "+(this.isHosted?"":"timestamp ")+"'{"+(e+1)+"}'":d.fieldObj.name+" NOT BETWEEN "+(this.isHosted?"":"timestamp ")+"'"+this.formatDate(c)+"' AND "+(this.isHosted?"":"timestamp ")+"'"+this.formatDate(this.addDay(c))+"'";break;case this.OPERATORS.dateOperatorIsBefore:h="field"===d.valueObj.type?d.fieldObj.name+" \x3c "+c:d.fieldObj.name+" \x3c "+(this.isHosted?"":"timestamp ")+"'"+this.formatDate(c)+"'";break;case this.OPERATORS.dateOperatorIsAfter:h="field"===d.valueObj.type?
d.fieldObj.name+" \x3e "+c:d.fieldObj.name+" \x3e "+(this.isHosted?"":"timestamp ")+"'"+this.formatDate(this.addDay(c))+"'";break;case this.OPERATORS.dateOperatorIsOnOrBefore:h="field"===d.valueObj.type?d.fieldObj.name+" \x3c\x3d "+c:d.fieldObj.name+" \x3c\x3d "+(this.isHosted?"":"timestamp ")+"'"+this.formatDate(this.addDay(c))+"'";break;case this.OPERATORS.dateOperatorIsOnOrAfter:h="field"===d.valueObj.type?d.fieldObj.name+" \x3e\x3d "+c:d.fieldObj.name+" \x3e\x3d "+(this.isHosted?"":"timestamp ")+
"'"+this.formatDate(c)+"'";break;case this.OPERATORS.dateOperatorInTheLast:h=d.fieldObj.name+" BETWEEN CURRENT_TIMESTAMP - "+this._convertRangeToDays(d.valueObj.value,d.valueObj.range)+" AND CURRENT_TIMESTAMP";break;case this.OPERATORS.dateOperatorNotInTheLast:h=d.fieldObj.name+" NOT BETWEEN CURRENT_TIMESTAMP - "+this._convertRangeToDays(d.valueObj.value,d.valueObj.range)+" AND CURRENT_TIMESTAMP";break;case this.OPERATORS.dateOperatorIsBetween:h=g?d.fieldObj.name+" BETWEEN '"+b+"' AND '"+a+"'":d.fieldObj.name+
" BETWEEN "+(this.isHosted?"":"timestamp ")+"'"+this.formatDate(b)+"' AND "+(this.isHosted?"":"timestamp ")+"'"+this.formatDate(this.addDay(a))+"'";break;case this.OPERATORS.dateOperatorIsNotBetween:h=g?d.fieldObj.name+" NOT BETWEEN '"+b+"' AND '"+a+"'":d.fieldObj.name+" NOT BETWEEN "+(this.isHosted?"":"timestamp ")+"'"+this.formatDate(b)+"' AND "+(this.isHosted?"":"timestamp ")+"'"+this.formatDate(this.addDay(a))+"'";break;case this.OPERATORS.dateOperatorIsBlank:h=d.fieldObj.name+" IS NULL";break;
case this.OPERATORS.dateOperatorIsNotBlank:h=d.fieldObj.name+" IS NOT NULL"}return{whereClause:h}},_convertRangeToDays:function(d,e){var c=d;e===this.OPERATORS.dateOperatorYears?c=365*d:e===this.OPERATORS.dateOperatorMonths?c=30*d:e===this.OPERATORS.dateOperatorWeeks?c=7*d:e===this.OPERATORS.dateOperatorHours?c=d/24:e===this.OPERATORS.dateOperatorMinutes&&(c=d/1440);return c=Math.round(1E6*c)/1E6},formatDate:function(d){var e=q.format(d,{datePattern:"yyyy-MM-dd",selector:"date"});d=q.format(d,{selector:"time",
timePattern:"HH:mm:ss"});return e+" "+d},addDay:function(d){return new Date(d.getTime()+this.dayInMS)},getFilterObjByExpr:function(h){if(h&&this.fieldsStore){var e=this.replaceStrings(h);h=e.defExpr;var c=this.findParts(h,"AND");1===c.parts.length&&(c=this.findParts(h,"OR"),1===c.parts.length&&(c.logicalOperator="AND"));d.forEach(c.parts,function(b){b.expr=b.expr.trim();if(b.expr.startsWith("(")&&-1<b.expr.search(/\)$/)){var a=b.expr.substring(1,b.expr.length-1),c=a.indexOf("("),d=a.indexOf(")");
if(-1===c&&-1===d||c<d)b.expr=a}a=this.findParts(b.expr,"AND");1===a.parts.length&&(a=this.findParts(b.expr,"OR"));1<a.parts.length&&(b.parts=a.parts,b.logicalOperator=a.logicalOperator)},this);this.parseExpr(c);this.reReplaceStrings(e,c,l.hitch(this,function(){c&&c.parts&&d.forEach(c.parts,l.hitch(this,function(b){b&&(b.parts?d.forEach(b.parts,l.hitch(this,function(a){this._handleParsedValuesForSinglePart(a);this._addDefalutValueTypeForSinglePart(a)})):(this._handleParsedValuesForSinglePart(b),this._addDefalutValueTypeForSinglePart(b)))}))}));
this.isPartsObjHasError(c)&&(c=null);return c}},_handleParsedValuesForSinglePart:function(d){d&&d.fieldObj&&"number"===d.fieldObj.shortType&&d.valueObj&&(d.valueObj.hasOwnProperty("value")&&(d.valueObj.value=parseFloat(d.valueObj.value)),d.valueObj.hasOwnProperty("value1")&&(d.valueObj.value1=parseFloat(d.valueObj.value1)),d.valueObj.hasOwnProperty("value2")&&(d.valueObj.value2=parseFloat(d.valueObj.value2)))},_addDefalutValueTypeForSinglePart:function(d){d&&d.valueObj&&!d.valueObj.type&&(d.valueObj.type=
"value")},replaceStrings:function(d){for(var e=d,c=function(a,b,d){var e=-1,e=a.indexOf("'",d+1);return e===d+1?(e=a.indexOf("'",e+1),c(a,b,e)):d},b=[],a=d.indexOf("'");-1<a;){var g=a,a=d.indexOf("'",a+1),h=0,a=c(d,g,a);"%"===d[g+1]&&g++;"%"===d[a-1]&&(--a,h++);var k=d.substring(g+1,a);"N"===d[g-1]&&(d=d.substring(0,g-1)+d.substring(g),--g,--a);this.isDateString(k)||-1!==k.indexOf("{")?a=d.indexOf("'",a+1+h):(b.push(k),d=d.substring(0,g+1)+"#"+(b.length-1)+"#"+d.substring(a),a=d.indexOf("'",d.lastIndexOf("#")+
2+h))}return{origDefExpr:e,defExpr:d,savedStrings:b}},reReplaceStrings:function(h,e,c){var b=h.savedStrings;if(!b.length)c&&"function"===typeof c&&c();else if(b.length){var a=function(a,b){if(void 0===a.valueObj||null===a.valueObj||void 0===a.valueObj.value||null===a.valueObj.value||"string"!==a.fieldObj.shortType)return!1;var c=a.valueObj.value.indexOf("#"),d=a.valueObj.value.lastIndexOf("#");return k.isDefined(a.valueObj.value)&&-1<c?(a.valueObj.value=b[parseInt(a.valueObj.value.substring(c+1,d),
10)].replace(/\'\'/g,"'"),this.builtSingleFilterString(a),!0):!1},a=l.hitch(this,a),g=!1;d.forEach(e.parts,function(c){if(c.parts){var e=!1;d.forEach(c.parts,function(c){e=a(c,b)||e});e&&(g=e,c.expr=this.builtFilterString(c))}else(g=a(c,b)||g)&&this.builtFilterString(c)},this);c&&"function"===typeof c&&c();g&&(e.expr=null,this.getExprByFilterObj(e))}},isDateString:function(d){return 19===d.length&&"-"===d.charAt(4)&&"-"===d.charAt(7)&&" "===d.charAt(10)&&":"===d.charAt(13)&&":"===d.charAt(16)?!0:
!1},findParts:function(d,e){for(var c=d.toLowerCase(),b=" "+e.toLowerCase()+" ",a=[],g=0,h=c.indexOf(b);0<h;){var k=d.substring(g,h),l=k.toLowerCase(),f=k.count("("),m=k.count(")"),p=k.count("'");f!==m||1===p%2?h=c.indexOf(b,h+1):-1<l.indexOf(" between ")&&-1===l.indexOf(" and ")?h=c.indexOf(b,h+1):(a.push({expr:k}),g=h+b.length,h=c.indexOf(b,g))}a.push({expr:d.substring(g)});for(c=a.length-1;0<=c;c--)!this.hasOperator(a[c].expr)&&0<c&&(a[c-1].expr+=" "+e+" "+a[c].expr,a.splice(c,1));return{expr:d,
parts:a,logicalOperator:e}},hasOperator:function(d){d=d.toLowerCase();return-1<d.indexOf("{")&&-1<d.indexOf("}")||-1<d.indexOf(" \x3d ")||-1<d.indexOf(" \x3c ")||-1<d.indexOf(" \x3e ")||-1<d.indexOf(" \x3c\x3e ")||-1<d.indexOf(" \x3c\x3d ")||-1<d.indexOf(" \x3e\x3d ")||-1<d.indexOf(" like ")||-1<d.indexOf(" between ")||-1<d.indexOf(" date")||-1<d.indexOf(" is null")||-1<d.indexOf(" is not null")?!0:!1},parseExpr:function(h){d.forEach(h.parts,function(d){d.parts?this.parseExpr(d):this.parseSingleExpr(d)},
this)},_preParseSingleExpr:function(d){var e=null;try{if(e=l.clone(d),e.expr=e.expr.trim(),/^UPPER\((.*)\)(\s+|\s+NOT\s+)LIKE\s+UPPER\(N?'(.*)'\)$/i.test(e.expr)){var c=d="",b=e.expr.match(/^UPPER\((.*)\)\s+/i);if(b&&2<=b.length)d=b[1];else return null;var a=e.expr.match(/UPPER\(N?'(.*)'\)$/i);if(a&&2<=a.length)c="'"+a[1]+"'";else return null;e.expr=e.expr.replace(/^UPPER\((.*)\)\s+/i,d+" ");e.expr=e.expr.replace(/UPPER\(N?'(.*)'\)$/i,c);e.caseSensitive=!1}else/^(.+)(\s+|\s+NOT\s+)LIKE\s+N?'(.*)'$/i.test(e.expr)&&
(e.caseSensitive=!0)}catch(g){return console.log(g),null}e&&this.isHosted&&(e.caseSensitive=!1);return e},_removeOperator:function(d,e,c){e=e.substring(c).trim();"date"===d&&!this.isHosted&&e.toLowerCase().startsWith("timestamp ")&&(e=e.substring(10).trim());return e},parseSingleExpr:function(d){var e=this._preParseSingleExpr(d);e&&(d=l.mixin(d,e));var e=d.expr.trim(),c=e.indexOf(" "),b=e.substring(0,c);d.fieldObj={name:b};d.valueObj={};this.getFieldItemByName({name:b},function(a){d.fieldObj.shortType=
a.shortType[0];d.fieldObj.label=a.label[0]},function(){d.error={msg:"unknown field name ("+b+")",code:1}});e=e.substring(c+1).trim();c=e.toLowerCase();c.startsWith("\x3d ")?(e=this._removeOperator(d.fieldObj.shortType,e,2),this.storeValue(e,d),d.operator="date"===d.fieldObj.shortType?this.OPERATORS.dateOperatorIsOn:"string"===d.fieldObj.shortType?this.OPERATORS.stringOperatorIs:this.OPERATORS.numberOperatorIs):c.startsWith("\x3c ")?(e=this._removeOperator(d.fieldObj.shortType,e,2),this.storeValue(e,
d),"date"===d.fieldObj.shortType?d.operator=this.OPERATORS.dateOperatorIsBefore:"number"===d.fieldObj.shortType?d.operator=this.OPERATORS.numberOperatorIsLessThan:d.error={msg:"operator ("+c+") not supported for string",code:3}):c.startsWith("\x3e ")?(e=this._removeOperator(d.fieldObj.shortType,e,2),this.storeValue(e,d),"date"===d.fieldObj.shortType?d.operator=this.OPERATORS.dateOperatorIsAfter:"number"===d.fieldObj.shortType?d.operator=this.OPERATORS.numberOperatorIsGreaterThan:d.error={msg:"operator ("+
c+") not supported for string",code:3}):c.startsWith("\x3c\x3e ")?(e=this._removeOperator(d.fieldObj.shortType,e,3),this.storeValue(e,d),d.operator="date"===d.fieldObj.shortType?this.OPERATORS.dateOperatorIsNotOn:"string"===d.fieldObj.shortType?this.OPERATORS.stringOperatorIsNot:this.OPERATORS.numberOperatorIsNot):c.startsWith("\x3c\x3d ")?(e=this._removeOperator(d.fieldObj.shortType,e,3),this.storeValue(e,d),"date"===d.fieldObj.shortType?d.operator=this.OPERATORS.dateOperatorIsOnOrBefore:"number"===
d.fieldObj.shortType?d.operator=this.OPERATORS.numberOperatorIsAtMost:d.error={msg:"operator ("+c+") not supported for string",code:3}):c.startsWith("\x3e\x3d ")?(e=this._removeOperator(d.fieldObj.shortType,e,3),this.storeValue(e,d),"date"===d.fieldObj.shortType?d.operator=this.OPERATORS.dateOperatorIsOnOrAfter:"number"===d.fieldObj.shortType?d.operator=this.OPERATORS.numberOperatorIsAtLeast:d.error={msg:"operator ("+c+") not supported for string",code:3}):c.startsWith("like ")?(e=e.substring(5).trim(),
e.startsWith("N'")&&(e=e.substring(1,e.length)),e.startsWith("'%")&&e.endsWith("%'")?(this.storeValue(e.substring(2,e.length-2),d),d.operator=this.OPERATORS.stringOperatorContains):e.startsWith("'%")&&e.endsWith("'")?(this.storeValue(e.substring(2,e.length-1),d),d.operator=this.OPERATORS.stringOperatorEndsWith):e.startsWith("'")&&e.endsWith("%'")?(this.storeValue(e.substring(1,e.length-2),d),d.operator=this.OPERATORS.stringOperatorStartsWith):d.error={msg:"value ("+c+") not supported for LIKE",code:3}):
c.startsWith("not like ")?(e=e.substring(9).trim(),e.startsWith("N'")&&(e=e.substring(1,e.length)),e.startsWith("'%")&&e.endsWith("%'")?(this.storeValue(e.substring(2,e.length-2),d),d.operator=this.OPERATORS.stringOperatorDoesNotContain):d.error={msg:"value ("+c+") not supported for NOT LIKE",code:3}):c.startsWith("between ")?this._updatePartForBetween(e,!0,d):c.startsWith("not between ")?this._updatePartForBetween(e,!1,d):"is null"===c?(d.valueObj.value=null,d.operator="date"===d.fieldObj.shortType?
this.OPERATORS.dateOperatorIsBlank:"string"===d.fieldObj.shortType?this.OPERATORS.stringOperatorIsBlank:this.OPERATORS.numberOperatorIsBlank):"is not null"===c?(d.valueObj.value=null,d.operator="date"===d.fieldObj.shortType?this.OPERATORS.dateOperatorIsNotBlank:"string"===d.fieldObj.shortType?this.OPERATORS.stringOperatorIsNotBlank:this.OPERATORS.numberOperatorIsNotBlank):d.error={msg:"unknown operator ("+c+")",code:2};if(k.isDefined(d.valueObj.value)&&"string"===typeof d.valueObj.value&&d.valueObj.value.startsWith("{")&&
d.valueObj.value.endsWith("}")||k.isDefined(d.valueObj.value1)&&"string"===typeof d.valueObj.value1&&d.valueObj.value1.startsWith("{")&&d.valueObj.value1.endsWith("}"))d.isInteractive=!0},getFieldItemByName:function(d,e,c){this.fieldsStore.fetch({query:d,onComplete:l.hitch(this,function(b){b&&b.length?e(b[0]):c()})})},subtractDay:function(d){return new Date(d.getTime()-this.dayInMS)},_updatePartForBetween:function(d,e,c){var b,a,g,h,k;d=this._removeOperator(c.fieldObj.shortType,d,(e?"between ":"not between ").length);
b=d.toLowerCase().indexOf(" and ");if(-1<b)if(a=d.substring(0,b).trim(),a.startsWith("CURRENT_TIMESTAMP "))if(a=a.substring(18).trim(),a.startsWith("-")){c.operator=e?this.OPERATORS.dateOperatorInTheLast:this.OPERATORS.dateOperatorNotInTheLast;try{k=parseFloat(a.substring(1).trim()),1<=k?(g=this.OPERATORS.dateOperatorDays,h=k/365,1E-4>Math.abs(h-Math.round(h))?(k=Math.round(h),g=this.OPERATORS.dateOperatorYears):(h=k/30,1E-4>Math.abs(h-Math.round(h))?(k=Math.round(h),g=this.OPERATORS.dateOperatorMonths):
(h=k/7,1E-4>Math.abs(h-Math.round(h))&&(k=Math.round(h),g=this.OPERATORS.dateOperatorWeeks)))):(g=this.OPERATORS.dateOperatorMinutes,k*=24,1E-4>Math.abs(k-Math.round(k))?g=this.OPERATORS.dateOperatorHours:k*=60),c.valueObj.value=k,c.valueObj.range=g}catch(t){c.error={msg:"missing count for '"+(e?"":"not ")+"in the last'",code:3}}}else c.error={msg:"'"+(e?"":"not ")+"in the next' not supported",code:3};else if(d=this._removeOperator(c.fieldObj.shortType,d.substring(b),5),this.storeValue1(a,c),this.storeValue2(d,
c),"date"===c.fieldObj.shortType){if(c.operator=e?this.OPERATORS.dateOperatorIsBetween:this.OPERATORS.dateOperatorIsNotBetween,"object"===typeof c.valueObj.value1&&"object"===typeof c.valueObj.value2)try{1E3>Math.abs(this.subtractDay(c.valueObj.value2).getTime()-c.valueObj.value1.getTime())&&(c.valueObj.value=c.valueObj.value1,delete c.valueObj.value1,delete c.valueObj.value2,c.operator=e?this.OPERATORS.dateOperatorIsOn:this.OPERATORS.dateOperatorIsNotOn)}catch(t){}}else"number"===c.fieldObj.shortType||
"oid"===c.fieldObj.shortType?c.operator=e?this.OPERATORS.numberOperatorIsBetween:this.OPERATORS.numberOperatorIsNotBetween:c.error={msg:c.fieldObj.shortType+" field not supported for "+(e?"":"NOT ")+"BETWEEN",code:3};else c.error={msg:"missing AND operator for "+(e?"":"NOT ")+"BETWEEN",code:3}},storeValue:function(d,e){if(d.startsWith("{")&&d.endsWith("}"))e.valueObj.value=d;else if(d.startsWith("'{")&&d.endsWith("}'"))e.valueObj.value=d.substring(1,d.length-1);else if("date"===e.fieldObj.shortType)if(d.startsWith("'")&&
d.endsWith("'")){var c=d.substring(1,d.length-1);e.valueObj.value=this.parseDate(c)}else e.valueObj.value=d,e.valueObj.type="field";else"string"===e.fieldObj.shortType?(d.startsWith("#")||d.startsWith("%#"))&&(d.endsWith("#")||d.endsWith("#%"))?e.valueObj.value=d:d.startsWith("'")&&d.endsWith("'")?e.valueObj.value=d.substring(1,d.length-1).replace(/\'\'/g,"'"):(e.valueObj.value=d,e.valueObj.type="field",this.getFieldItemByName({name:d},function(b){e.valueObj.label=b.label[0]},function(){e.error={msg:"unknown field name ("+
d+")",code:1}})):(e.valueObj.value=d,isNaN(d)&&(e.valueObj.type="field",this.getFieldItemByName({name:d},function(b){e.valueObj.label=b.label[0]},function(){e.error={msg:"unknown field name ("+d+")",code:1}})))},storeValue1:function(d,e){if(d.startsWith("{")&&d.endsWith("}"))e.valueObj.value1=d;else if(d.startsWith("'{")&&d.endsWith("}'"))e.valueObj.value1=d.substring(1,d.length-1);else if("date"===e.fieldObj.shortType)if(d.startsWith("'")&&d.endsWith("'")){var c=d.substring(1,d.length-1);e.valueObj.value1=
this.parseDate(c)}else e.valueObj.value1=d,e.valueObj.type="field";else e.valueObj.value1=d,isNaN(d)&&(e.valueObj.type="field")},storeValue2:function(d,e){if(d.startsWith("{")&&d.endsWith("}"))e.valueObj.value2=d;else if(d.startsWith("'{")&&d.endsWith("}'"))e.valueObj.value2=d.substring(1,d.length-1);else if("date"===e.fieldObj.shortType)if(d.startsWith("'")&&d.endsWith("'")){var c=d.substring(1,d.length-1);e.valueObj.value2=this.parseDate(c)}else e.valueObj.value2=d,e.valueObj.type="field";else e.valueObj.value2=
d,isNaN(d)&&(e.valueObj.type="field")},parseDate:function(d){var e=q.parse(d,{datePattern:"yyyy-MM-dd",timePattern:"HH:mm:ss"});e||(e=q.parse(d.replace(" ",", "),{datePattern:"yyyy-MM-dd",timePattern:"HH:mm:ss"}))||(e=q.parse(d.replace(" "," - "),{datePattern:"yyyy-MM-dd",timePattern:"HH:mm:ss"}));return e}})})},"dojo/data/ItemFileWriteStore":function(){define("../_base/lang ../_base/declare ../_base/array ../_base/json ../_base/kernel ./ItemFileReadStore ../date/stamp".split(" "),function(r,l,d,
q,k,m,p){return l("dojo.data.ItemFileWriteStore",m,{constructor:function(d){this._features["dojo.data.api.Write"]=!0;this._features["dojo.data.api.Notification"]=!0;this._pending={_newItems:{},_modifiedItems:{},_deletedItems:{}};this._datatypeMap.Date.serialize||(this._datatypeMap.Date.serialize=function(d){return p.toISOString(d,{zulu:!0})});d&&!1===d.referenceIntegrity&&(this.referenceIntegrity=!1);this._saveInProgress=!1},referenceIntegrity:!0,_assert:function(d){if(!d)throw Error("assertion failed in ItemFileWriteStore");
},_getIdentifierAttribute:function(){return this.getFeatures()["dojo.data.api.Identity"]},newItem:function(d,e){this._assert(!this._saveInProgress);this._loadFinished||this._forceLoad();if("object"!=typeof d&&"undefined"!=typeof d)throw Error("newItem() was passed something other than an object");var c=null,b=this._getIdentifierAttribute();if(b===Number)c=this._arrayOfAllItems.length;else{c=d[b];if("undefined"===typeof c)throw Error("newItem() was not passed an identity for the new item");if(r.isArray(c))throw Error("newItem() was not passed an single-valued identity");
}this._itemsByIdentity&&this._assert("undefined"===typeof this._itemsByIdentity[c]);this._assert("undefined"===typeof this._pending._newItems[c]);this._assert("undefined"===typeof this._pending._deletedItems[c]);var a={};a[this._storeRefPropName]=this;a[this._itemNumPropName]=this._arrayOfAllItems.length;this._itemsByIdentity&&(this._itemsByIdentity[c]=a,a[b]=[c]);this._arrayOfAllItems.push(a);b=null;if(e&&e.parent&&e.attribute){var b={item:e.parent,attribute:e.attribute,oldValue:void 0},g=this.getValues(e.parent,
e.attribute);if(g&&0<g.length){var h=g.slice(0,g.length);b.oldValue=1===g.length?g[0]:g.slice(0,g.length);h.push(a);this._setValueOrValues(e.parent,e.attribute,h,!1);b.newValue=this.getValues(e.parent,e.attribute)}else this._setValueOrValues(e.parent,e.attribute,a,!1),b.newValue=a}else a[this._rootItemPropName]=!0,this._arrayOfTopLevelItems.push(a);this._pending._newItems[c]=a;for(var k in d){if(k===this._storeRefPropName||k===this._itemNumPropName)throw Error("encountered bug in ItemFileWriteStore.newItem");
c=d[k];r.isArray(c)||(c=[c]);a[k]=c;if(this.referenceIntegrity)for(g=0;g<c.length;g++)h=c[g],this.isItem(h)&&this._addReferenceToMap(h,a,k)}this.onNew(a,b);return a},_removeArrayElement:function(h,e){var c=d.indexOf(h,e);return-1!=c?(h.splice(c,1),!0):!1},deleteItem:function(h){this._assert(!this._saveInProgress);this._assertIsItem(h);var e=h[this._itemNumPropName],c=this.getIdentity(h);if(this.referenceIntegrity){var b=this.getAttributes(h);h[this._reverseRefMap]&&(h["backup_"+this._reverseRefMap]=
r.clone(h[this._reverseRefMap]));d.forEach(b,function(a){d.forEach(this.getValues(h,a),function(b){this.isItem(b)&&(h["backupRefs_"+this._reverseRefMap]||(h["backupRefs_"+this._reverseRefMap]=[]),h["backupRefs_"+this._reverseRefMap].push({id:this.getIdentity(b),attr:a}),this._removeReferenceFromMap(b,h,a))},this)},this);if(b=h[this._reverseRefMap])for(var a in b){var g=null;if(g=this._itemsByIdentity?this._itemsByIdentity[a]:this._arrayOfAllItems[a])for(var k in b[a]){var l=this.getValues(g,k)||[],
m=d.filter(l,function(a){return!(this.isItem(a)&&this.getIdentity(a)==c)},this);this._removeReferenceFromMap(h,g,k);m.length<l.length&&this._setValueOrValues(g,k,m,!0)}}}this._arrayOfAllItems[e]=null;h[this._storeRefPropName]=null;this._itemsByIdentity&&delete this._itemsByIdentity[c];this._pending._deletedItems[c]=h;h[this._rootItemPropName]&&this._removeArrayElement(this._arrayOfTopLevelItems,h);this.onDelete(h);return!0},setValue:function(d,e,c){return this._setValueOrValues(d,e,c,!0)},setValues:function(d,
e,c){return this._setValueOrValues(d,e,c,!0)},unsetAttribute:function(d,e){return this._setValueOrValues(d,e,[],!0)},_setValueOrValues:function(h,e,c,b){this._assert(!this._saveInProgress);this._assertIsItem(h);this._assert(r.isString(e));this._assert("undefined"!==typeof c);var a=this._getIdentifierAttribute();if(e==a)throw Error("ItemFileWriteStore does not have support for changing the value of an item's identifier.");var a=this._getValueOrValues(h,e),g=this.getIdentity(h);if(!this._pending._modifiedItems[g]){var k=
{},l;for(l in h)k[l]=l===this._storeRefPropName||l===this._itemNumPropName||l===this._rootItemPropName?h[l]:l===this._reverseRefMap?r.clone(h[l]):h[l].slice(0,h[l].length);this._pending._modifiedItems[g]=k}g=!1;if(r.isArray(c)&&0===c.length){if(g=delete h[e],c=void 0,this.referenceIntegrity&&a){l=a;r.isArray(l)||(l=[l]);for(var m=0;m<l.length;m++)k=l[m],this.isItem(k)&&this._removeReferenceFromMap(k,h,e)}}else{g=r.isArray(c)?c.slice(0,c.length):[c];if(this.referenceIntegrity)if(a){l=a;r.isArray(l)||
(l=[l]);var f={};d.forEach(l,function(a){this.isItem(a)&&(a=this.getIdentity(a),f[a.toString()]=!0)},this);d.forEach(g,function(a){if(this.isItem(a)){var b=this.getIdentity(a);f[b.toString()]?delete f[b.toString()]:this._addReferenceToMap(a,h,e)}},this);for(m in f)this._removeReferenceFromMap(this._itemsByIdentity?this._itemsByIdentity[m]:this._arrayOfAllItems[m],h,e)}else for(m=0;m<g.length;m++)k=g[m],this.isItem(k)&&this._addReferenceToMap(k,h,e);h[e]=g;g=!0}if(b)this.onSet(h,e,a,c);return g},_addReferenceToMap:function(d,
e,c){e=this.getIdentity(e);var b=d[this._reverseRefMap];b||(b=d[this._reverseRefMap]={});(d=b[e])||(d=b[e]={});d[c]=!0},_removeReferenceFromMap:function(d,e,c){e=this.getIdentity(e);var b=d[this._reverseRefMap],a;if(b){for(a in b)a==e&&(delete b[a][c],this._isEmpty(b[a])&&delete b[a]);this._isEmpty(b)&&delete d[this._reverseRefMap]}},_dumpReferenceMap:function(){var d;for(d=0;d<this._arrayOfAllItems.length;d++){var e=this._arrayOfAllItems[d];e&&e[this._reverseRefMap]&&console.log("Item: ["+this.getIdentity(e)+
"] is referenced by: "+q.toJson(e[this._reverseRefMap]))}},_getValueOrValues:function(d,e){var c=void 0;this.hasAttribute(d,e)&&(c=this.getValues(d,e),c=1==c.length?c[0]:c);return c},_flatten:function(d){if(this.isItem(d))return{_reference:this.getIdentity(d)};if("object"===typeof d)for(var e in this._datatypeMap){var c=this._datatypeMap[e];if(r.isObject(c)&&!r.isFunction(c)){if(d instanceof c.type){if(!c.serialize)throw Error("ItemFileWriteStore:  No serializer defined for type mapping: ["+e+"]");
return{_type:e,_value:c.serialize(d)}}}else if(d instanceof c)return{_type:e,_value:d.toString()}}return d},_getNewFileContentString:function(){var d={},e=this._getIdentifierAttribute();e!==Number&&(d.identifier=e);this._labelAttr&&(d.label=this._labelAttr);d.items=[];for(e=0;e<this._arrayOfAllItems.length;++e){var c=this._arrayOfAllItems[e];if(null!==c){var b={},a;for(a in c)if(a!==this._storeRefPropName&&a!==this._itemNumPropName&&a!==this._reverseRefMap&&a!==this._rootItemPropName){var g=this.getValues(c,
a);if(1==g.length)b[a]=this._flatten(g[0]);else for(var k=[],l=0;l<g.length;++l)k.push(this._flatten(g[l])),b[a]=k}d.items.push(b)}}return q.toJson(d,!0)},_isEmpty:function(d){var e=!0;if(r.isObject(d))for(var c in d){e=!1;break}else r.isArray(d)&&0<d.length&&(e=!1);return e},save:function(d){this._assert(!this._saveInProgress);this._saveInProgress=!0;var e=this,c=function(){e._pending={_newItems:{},_modifiedItems:{},_deletedItems:{}};e._saveInProgress=!1;d&&d.onComplete&&d.onComplete.call(d.scope||
k.global)},b=function(a){e._saveInProgress=!1;d&&d.onError&&d.onError.call(d.scope||k.global,a)};if(this._saveEverything){var a=this._getNewFileContentString();this._saveEverything(c,b,a)}this._saveCustom&&this._saveCustom(c,b);this._saveEverything||this._saveCustom||c()},revert:function(){this._assert(!this._saveInProgress);for(var h in this._pending._modifiedItems){var e=this._pending._modifiedItems[h],c=null,c=this._itemsByIdentity?this._itemsByIdentity[h]:this._arrayOfAllItems[h];e[this._storeRefPropName]=
this;for(var b in c)delete c[b];r.mixin(c,e)}var a;for(h in this._pending._deletedItems)a=this._pending._deletedItems[h],a[this._storeRefPropName]=this,e=a[this._itemNumPropName],a["backup_"+this._reverseRefMap]&&(a[this._reverseRefMap]=a["backup_"+this._reverseRefMap],delete a["backup_"+this._reverseRefMap]),this._arrayOfAllItems[e]=a,this._itemsByIdentity&&(this._itemsByIdentity[h]=a),a[this._rootItemPropName]&&this._arrayOfTopLevelItems.push(a);for(h in this._pending._deletedItems)a=this._pending._deletedItems[h],
a["backupRefs_"+this._reverseRefMap]&&(d.forEach(a["backupRefs_"+this._reverseRefMap],function(b){this._addReferenceToMap(this._itemsByIdentity?this._itemsByIdentity[b.id]:this._arrayOfAllItems[b.id],a,b.attr)},this),delete a["backupRefs_"+this._reverseRefMap]);for(h in this._pending._newItems)e=this._pending._newItems[h],e[this._storeRefPropName]=null,this._arrayOfAllItems[e[this._itemNumPropName]]=null,e[this._rootItemPropName]&&this._removeArrayElement(this._arrayOfTopLevelItems,e),this._itemsByIdentity&&
delete this._itemsByIdentity[h];this._pending={_newItems:{},_modifiedItems:{},_deletedItems:{}};return!0},isDirty:function(d){return d?(d=this.getIdentity(d),(new Boolean(this._pending._newItems[d]||this._pending._modifiedItems[d]||this._pending._deletedItems[d])).valueOf()):!this._isEmpty(this._pending._newItems)||!this._isEmpty(this._pending._modifiedItems)||!this._isEmpty(this._pending._deletedItems)},onSet:function(d,e,c,b){},onNew:function(d,e){},onDelete:function(d){},close:function(d){if(this.clearOnClose){if(this.isDirty())throw Error("dojo.data.ItemFileWriteStore: There are unsaved changes present in the store.  Please save or revert the changes before invoking close.");
this.inherited(arguments)}}})})},"dojo/data/ItemFileReadStore":function(){define("../_base/kernel ../_base/lang ../_base/declare ../_base/array ../_base/xhr ../Evented ./util/filter ./util/simpleFetch ../date/stamp".split(" "),function(r,l,d,q,k,m,p,h,e){d=d("dojo.data.ItemFileReadStore",[m],{constructor:function(c){this._arrayOfAllItems=[];this._arrayOfTopLevelItems=[];this._loadFinished=!1;this.url=this._ccUrl=this._jsonFileUrl=c.url;this._jsonData=c.data;this.data=null;this._datatypeMap=c.typeMap||
{};this._datatypeMap.Date||(this._datatypeMap.Date={type:Date,deserialize:function(b){return e.fromISOString(b)}});this._features={"dojo.data.api.Read":!0,"dojo.data.api.Identity":!0};this._itemsByIdentity=null;this._storeRefPropName="_S";this._itemNumPropName="_0";this._rootItemPropName="_RI";this._reverseRefMap="_RRM";this._loadInProgress=!1;this._queuedFetches=[];void 0!==c.urlPreventCache&&(this.urlPreventCache=c.urlPreventCache?!0:!1);void 0!==c.hierarchical&&(this.hierarchical=c.hierarchical?
!0:!1);c.clearOnClose&&(this.clearOnClose=!0);"failOk"in c&&(this.failOk=c.failOk?!0:!1)},url:"",_ccUrl:"",data:null,typeMap:null,clearOnClose:!1,urlPreventCache:!1,failOk:!1,hierarchical:!0,_assertIsItem:function(c){if(!this.isItem(c))throw Error(this.declaredClass+": Invalid item argument.");},_assertIsAttribute:function(c){if("string"!==typeof c)throw Error(this.declaredClass+": Invalid attribute argument.");},getValue:function(c,b,a){c=this.getValues(c,b);return 0<c.length?c[0]:a},getValues:function(c,
b){this._assertIsItem(c);this._assertIsAttribute(b);return(c[b]||[]).slice(0)},getAttributes:function(c){this._assertIsItem(c);var b=[],a;for(a in c)a!==this._storeRefPropName&&a!==this._itemNumPropName&&a!==this._rootItemPropName&&a!==this._reverseRefMap&&b.push(a);return b},hasAttribute:function(c,b){this._assertIsItem(c);this._assertIsAttribute(b);return b in c},containsValue:function(c,b,a){var d=void 0;"string"===typeof a&&(d=p.patternToRegExp(a,!1));return this._containsValue(c,b,a,d)},_containsValue:function(c,
b,a,d){return q.some(this.getValues(c,b),function(b){if(null!==b&&!l.isObject(b)&&d){if(b.toString().match(d))return!0}else if(a===b)return!0})},isItem:function(c){return c&&c[this._storeRefPropName]===this&&this._arrayOfAllItems[c[this._itemNumPropName]]===c?!0:!1},isItemLoaded:function(c){return this.isItem(c)},loadItem:function(c){this._assertIsItem(c.item)},getFeatures:function(){return this._features},getLabel:function(c){if(this._labelAttr&&this.isItem(c))return this.getValue(c,this._labelAttr)},
getLabelAttributes:function(c){return this._labelAttr?[this._labelAttr]:null},filter:function(c,b,a){var d=[],e,h;if(c.query){var k;e=c.queryOptions?c.queryOptions.ignoreCase:!1;var f={};for(h in c.query)k=c.query[h],"string"===typeof k?f[h]=p.patternToRegExp(k,e):k instanceof RegExp&&(f[h]=k);for(e=0;e<b.length;++e){var l=!0,m=b[e];if(null===m)l=!1;else for(h in c.query)k=c.query[h],this._containsValue(m,h,k,f[h])||(l=!1);l&&d.push(m)}}else for(e=0;e<b.length;++e)h=b[e],null!==h&&d.push(h);a(d,c)},
_fetchItems:function(c,b,a){var d=this;if(this._loadFinished)this.filter(c,this._getItemsArray(c.queryOptions),b);else if(this._jsonFileUrl!==this._ccUrl?(r.deprecated(this.declaredClass+": ","To change the url, set the url property of the store, not _jsonFileUrl.  _jsonFileUrl support will be removed in 2.0"),this.url=this._ccUrl=this._jsonFileUrl):this.url!==this._ccUrl&&(this._ccUrl=this._jsonFileUrl=this.url),null!=this.data&&(this._jsonData=this.data,this.data=null),this._jsonFileUrl)if(this._loadInProgress)this._queuedFetches.push({args:c,
filter:l.hitch(d,"filter"),findCallback:l.hitch(d,b)});else{this._loadInProgress=!0;var e=k.get({url:d._jsonFileUrl,handleAs:"json-comment-optional",preventCache:this.urlPreventCache,failOk:this.failOk});e.addCallback(function(e){try{d._getItemsFromLoadedData(e),d._loadFinished=!0,d._loadInProgress=!1,d.filter(c,d._getItemsArray(c.queryOptions),b),d._handleQueuedFetches()}catch(f){d._loadFinished=!0,d._loadInProgress=!1,a(f,c)}});e.addErrback(function(b){d._loadInProgress=!1;a(b,c)});var h=null;c.abort&&
(h=c.abort);c.abort=function(){var a=e;a&&-1===a.fired&&(a.cancel(),a=null);h&&h.call(c)}}else if(this._jsonData)try{this._loadFinished=!0,this._getItemsFromLoadedData(this._jsonData),this._jsonData=null,d.filter(c,this._getItemsArray(c.queryOptions),b)}catch(t){a(t,c)}else a(Error(this.declaredClass+": No JSON source data was provided as either URL or a nested Javascript object."),c)},_handleQueuedFetches:function(){if(0<this._queuedFetches.length){for(var c=0;c<this._queuedFetches.length;c++){var b=
this._queuedFetches[c],a=b.args,d=b.filter,b=b.findCallback;d?d(a,this._getItemsArray(a.queryOptions),b):this.fetchItemByIdentity(a)}this._queuedFetches=[]}},_getItemsArray:function(c){return c&&c.deep?this._arrayOfAllItems:this._arrayOfTopLevelItems},close:function(c){this.clearOnClose&&this._loadFinished&&!this._loadInProgress&&(""!=this._jsonFileUrl&&null!=this._jsonFileUrl||""!=this.url&&null!=this.url||null!=this.data||console.debug(this.declaredClass+": WARNING!  Data reload  information has not been provided.  Please set 'url' or 'data' to the appropriate value before the next fetch"),
this._arrayOfAllItems=[],this._arrayOfTopLevelItems=[],this._loadFinished=!1,this._itemsByIdentity=null,this._loadInProgress=!1,this._queuedFetches=[])},_getItemsFromLoadedData:function(c){function b(a){return null!==a&&"object"===typeof a&&(!l.isArray(a)||d)&&!l.isFunction(a)&&(a.constructor==Object||l.isArray(a))&&"undefined"===typeof a._reference&&"undefined"===typeof a._type&&"undefined"===typeof a._value&&e.hierarchical}function a(c){e._arrayOfAllItems.push(c);for(var d in c){var f=c[d];if(f)if(l.isArray(f))for(var g=
0;g<f.length;++g){var h=f[g];b(h)&&a(h)}else b(f)&&a(f)}}var d=!1,e=this;this._labelAttr=c.label;var h,k;this._arrayOfAllItems=[];this._arrayOfTopLevelItems=c.items;for(h=0;h<this._arrayOfTopLevelItems.length;++h)k=this._arrayOfTopLevelItems[h],l.isArray(k)&&(d=!0),a(k),k[this._rootItemPropName]=!0;var f={},m;for(h=0;h<this._arrayOfAllItems.length;++h)for(m in k=this._arrayOfAllItems[h],k){if(m!==this._rootItemPropName){var p=k[m];null!==p?l.isArray(p)||(k[m]=[p]):k[m]=[null]}f[m]=m}for(;f[this._storeRefPropName];)this._storeRefPropName+=
"_";for(;f[this._itemNumPropName];)this._itemNumPropName+="_";for(;f[this._reverseRefMap];)this._reverseRefMap+="_";if(f=c.identifier)for(this._itemsByIdentity={},this._features["dojo.data.api.Identity"]=f,h=0;h<this._arrayOfAllItems.length;++h)if(k=this._arrayOfAllItems[h],c=k[f],c=c[0],Object.hasOwnProperty.call(this._itemsByIdentity,c)){if(this._jsonFileUrl)throw Error(this.declaredClass+":  The json data as specified by: ["+this._jsonFileUrl+"] is malformed.  Items within the list have identifier: ["+
f+"].  Value collided: ["+c+"]");if(this._jsonData)throw Error(this.declaredClass+":  The json data provided by the creation arguments is malformed.  Items within the list have identifier: ["+f+"].  Value collided: ["+c+"]");}else this._itemsByIdentity[c]=k;else this._features["dojo.data.api.Identity"]=Number;for(h=0;h<this._arrayOfAllItems.length;++h)k=this._arrayOfAllItems[h],k[this._storeRefPropName]=this,k[this._itemNumPropName]=h;for(h=0;h<this._arrayOfAllItems.length;++h)for(m in k=this._arrayOfAllItems[h],
k)for(c=k[m],f=0;f<c.length;++f)if(p=c[f],null!==p&&"object"==typeof p){if("_type"in p&&"_value"in p){var q=p._type,r=this._datatypeMap[q];if(r)if(l.isFunction(r))c[f]=new r(p._value);else if(l.isFunction(r.deserialize))c[f]=r.deserialize(p._value);else throw Error("dojo.data.ItemFileReadStore: Value provided in typeMap was neither a constructor, nor a an object with a deserialize function");else throw Error("dojo.data.ItemFileReadStore: in the typeMap constructor arg, no object class was specified for the datatype '"+
q+"'");}if(p._reference){p=p._reference;if(l.isObject(p))for(q=0;q<this._arrayOfAllItems.length;++q){var r=this._arrayOfAllItems[q],A=!0,y;for(y in p)r[y]!=p[y]&&(A=!1);A&&(c[f]=r)}else c[f]=this._getItemByIdentity(p);this.referenceIntegrity&&(p=c[f],this.isItem(p)&&this._addReferenceToMap(p,k,m))}else this.isItem(p)&&this.referenceIntegrity&&this._addReferenceToMap(p,k,m)}},_addReferenceToMap:function(c,b,a){},getIdentity:function(c){var b=this._features["dojo.data.api.Identity"];return b===Number?
c[this._itemNumPropName]:(c=c[b])?c[0]:null},fetchItemByIdentity:function(c){var b,a;if(this._loadFinished)b=this._getItemByIdentity(c.identity),c.onItem&&(a=c.scope?c.scope:r.global,c.onItem.call(a,b));else{var d=this;this._jsonFileUrl!==this._ccUrl?(r.deprecated(this.declaredClass+": ","To change the url, set the url property of the store, not _jsonFileUrl.  _jsonFileUrl support will be removed in 2.0"),this.url=this._ccUrl=this._jsonFileUrl):this.url!==this._ccUrl&&(this._ccUrl=this._jsonFileUrl=
this.url);null!=this.data&&null==this._jsonData&&(this._jsonData=this.data,this.data=null);this._jsonFileUrl?this._loadInProgress?this._queuedFetches.push({args:c}):(this._loadInProgress=!0,a=k.get({url:d._jsonFileUrl,handleAs:"json-comment-optional",preventCache:this.urlPreventCache,failOk:this.failOk}),a.addCallback(function(a){var e=c.scope?c.scope:r.global;try{d._getItemsFromLoadedData(a),d._loadFinished=!0,d._loadInProgress=!1,b=d._getItemByIdentity(c.identity),c.onItem&&c.onItem.call(e,b),d._handleQueuedFetches()}catch(t){d._loadInProgress=
!1,c.onError&&c.onError.call(e,t)}}),a.addErrback(function(a){d._loadInProgress=!1;c.onError&&c.onError.call(c.scope?c.scope:r.global,a)})):this._jsonData&&(d._getItemsFromLoadedData(d._jsonData),d._jsonData=null,d._loadFinished=!0,b=d._getItemByIdentity(c.identity),c.onItem&&(a=c.scope?c.scope:r.global,c.onItem.call(a,b)))}},_getItemByIdentity:function(c){var b=null;this._itemsByIdentity?Object.hasOwnProperty.call(this._itemsByIdentity,c)&&(b=this._itemsByIdentity[c]):Object.hasOwnProperty.call(this._arrayOfAllItems,
c)&&(b=this._arrayOfAllItems[c]);void 0===b&&(b=null);return b},getIdentityAttributes:function(c){c=this._features["dojo.data.api.Identity"];return c===Number?null:[c]},_forceLoad:function(){var c=this;this._jsonFileUrl!==this._ccUrl?(r.deprecated(this.declaredClass+": ","To change the url, set the url property of the store, not _jsonFileUrl.  _jsonFileUrl support will be removed in 2.0"),this.url=this._ccUrl=this._jsonFileUrl):this.url!==this._ccUrl&&(this._ccUrl=this._jsonFileUrl=this.url);null!=
this.data&&(this._jsonData=this.data,this.data=null);if(this._jsonFileUrl){var b=k.get({url:this._jsonFileUrl,handleAs:"json-comment-optional",preventCache:this.urlPreventCache,failOk:this.failOk,sync:!0});b.addCallback(function(a){try{if(!0!==c._loadInProgress&&!c._loadFinished)c._getItemsFromLoadedData(a),c._loadFinished=!0;else if(c._loadInProgress)throw Error(this.declaredClass+":  Unable to perform a synchronous load, an async load is in progress.");}catch(g){throw console.log(g),g;}});b.addErrback(function(a){throw a;
})}else this._jsonData&&(c._getItemsFromLoadedData(c._jsonData),c._jsonData=null,c._loadFinished=!0)}});l.extend(d,h);return d})},"dojo/data/util/filter":function(){define(["../../_base/lang"],function(r){var l={};r.setObject("dojo.data.util.filter",l);l.patternToRegExp=function(d,l){for(var k="^",m=null,p=0;p<d.length;p++)switch(m=d.charAt(p),m){case "\\":k+=m;p++;k+=d.charAt(p);break;case "*":k+=".*";break;case "?":k+=".";break;case "$":case "^":case "/":case "+":case ".":case "|":case "(":case ")":case "{":case "}":case "[":case "]":k+=
"\\";default:k+=m}k+="$";return l?new RegExp(k,"mi"):new RegExp(k,"m")};return l})},"dojo/data/util/simpleFetch":function(){define(["../../_base/lang","../../_base/kernel","./sorter"],function(r,l,d){var q={};r.setObject("dojo.data.util.simpleFetch",q);q.errorHandler=function(d,m){m.onError&&m.onError.call(m.scope||l.global,d,m)};q.fetchHandler=function(k,m){var p=m.abort||null,h=!1,e=m.start?m.start:0,c=m.count&&Infinity!==m.count?e+m.count:k.length;m.abort=function(){h=!0;p&&p.call(m)};var b=m.scope||
l.global;m.store||(m.store=this);m.onBegin&&m.onBegin.call(b,k.length,m);m.sort&&k.sort(d.createSortFunction(m.sort,this));if(m.onItem)for(var a=e;a<k.length&&a<c;++a){var g=k[a];h||m.onItem.call(b,g,m)}m.onComplete&&!h&&(a=null,m.onItem||(a=k.slice(e,c)),m.onComplete.call(b,a,m))};q.fetch=function(d){d=d||{};d.store||(d.store=this);this._fetchItems(d,r.hitch(this,"fetchHandler"),r.hitch(this,"errorHandler"));return d};return q})},"jimu/dijit/_filter/ValueProviderFactory":function(){define("dojo/_base/lang dojo/_base/array dojo/_base/declare ./BlankValueProvider ./SimpleValueProvider ./TwoNumbersValueProvider ./TwoDatesValueProvider ./ListValueProvider ./NumberListValueProvider jimu/LayerInfos/LayerInfos".split(" "),
function(r,l,d,q,k,m,p,h,e,c){var b={stringOperatorIs:{value:{normalProviderType:"SIMPLE_VALUE_PROVIDER",codedValueProviderType:"LIST_VALUE_PROVIDER",supportAskForValue:!0},field:{normalProviderType:"LIST_VALUE_PROVIDER"},unique:{normalProviderType:"LIST_VALUE_PROVIDER",supportAskForValue:!0,filterCodedValueIfPossible:!0}},stringOperatorIsNot:{value:{normalProviderType:"SIMPLE_VALUE_PROVIDER",supportAskForValue:!0},field:{normalProviderType:"LIST_VALUE_PROVIDER"},unique:{normalProviderType:"LIST_VALUE_PROVIDER",
supportAskForValue:!0,filterCodedValueIfPossible:!0}},stringOperatorStartsWith:{value:{normalProviderType:"SIMPLE_VALUE_PROVIDER",supportAskForValue:!0,supportCaseSensitive:!0}},stringOperatorEndsWith:{value:{normalProviderType:"SIMPLE_VALUE_PROVIDER",supportAskForValue:!0,supportCaseSensitive:!0}},stringOperatorContains:{value:{normalProviderType:"SIMPLE_VALUE_PROVIDER",supportAskForValue:!0,supportCaseSensitive:!0}},stringOperatorDoesNotContain:{value:{normalProviderType:"SIMPLE_VALUE_PROVIDER",
supportAskForValue:!0,supportCaseSensitive:!0}},stringOperatorIsBlank:{value:{normalProviderType:"BLANK_VALUE_PROVIDER"}},stringOperatorIsNotBlank:{value:{normalProviderType:"BLANK_VALUE_PROVIDER"}},numberOperatorIs:{value:{normalProviderType:"SIMPLE_VALUE_PROVIDER",codedValueProviderType:"LIST_VALUE_PROVIDER",supportAskForValue:!0},field:{normalProviderType:"LIST_VALUE_PROVIDER"},unique:{normalProviderType:"LIST_VALUE_PROVIDER",supportAskForValue:!0,filterCodedValueIfPossible:!0}},numberOperatorIsNot:{value:{normalProviderType:"SIMPLE_VALUE_PROVIDER",
supportAskForValue:!0},field:{normalProviderType:"LIST_VALUE_PROVIDER"},unique:{normalProviderType:"LIST_VALUE_PROVIDER",supportAskForValue:!0,filterCodedValueIfPossible:!0}},numberOperatorIsAtLeast:{value:{normalProviderType:"SIMPLE_VALUE_PROVIDER",supportAskForValue:!0},field:{normalProviderType:"LIST_VALUE_PROVIDER"},unique:{normalProviderType:"LIST_VALUE_PROVIDER",supportAskForValue:!0,filterCodedValueIfPossible:!0}},numberOperatorIsLessThan:{value:{normalProviderType:"SIMPLE_VALUE_PROVIDER",
supportAskForValue:!0},field:{normalProviderType:"LIST_VALUE_PROVIDER"},unique:{normalProviderType:"LIST_VALUE_PROVIDER",supportAskForValue:!0,filterCodedValueIfPossible:!0}},numberOperatorIsAtMost:{value:{normalProviderType:"SIMPLE_VALUE_PROVIDER",supportAskForValue:!0},field:{normalProviderType:"LIST_VALUE_PROVIDER"},unique:{normalProviderType:"LIST_VALUE_PROVIDER",supportAskForValue:!0,filterCodedValueIfPossible:!0}},numberOperatorIsGreaterThan:{value:{normalProviderType:"SIMPLE_VALUE_PROVIDER",
supportAskForValue:!0},field:{normalProviderType:"LIST_VALUE_PROVIDER"},unique:{normalProviderType:"LIST_VALUE_PROVIDER",supportAskForValue:!0,filterCodedValueIfPossible:!0}},numberOperatorIsBetween:{value:{normalProviderType:"TWO_NUMBERS_VALUE_PROVIDER",supportAskForValue:!0}},numberOperatorIsNotBetween:{value:{normalProviderType:"TWO_NUMBERS_VALUE_PROVIDER",supportAskForValue:!0}},numberOperatorIsBlank:{value:{normalProviderType:"BLANK_VALUE_PROVIDER"}},numberOperatorIsNotBlank:{value:{normalProviderType:"BLANK_VALUE_PROVIDER"}},
dateOperatorIsOn:{value:{normalProviderType:"SIMPLE_VALUE_PROVIDER",supportAskForValue:!0},field:{normalProviderType:"LIST_VALUE_PROVIDER"}},dateOperatorIsNotOn:{value:{normalProviderType:"SIMPLE_VALUE_PROVIDER",supportAskForValue:!0},field:{normalProviderType:"LIST_VALUE_PROVIDER"}},dateOperatorIsBefore:{value:{normalProviderType:"SIMPLE_VALUE_PROVIDER",supportAskForValue:!0},field:{normalProviderType:"LIST_VALUE_PROVIDER"}},dateOperatorIsAfter:{value:{normalProviderType:"SIMPLE_VALUE_PROVIDER",
supportAskForValue:!0},field:{normalProviderType:"LIST_VALUE_PROVIDER"}},dateOperatorIsOnOrBefore:{value:{normalProviderType:"SIMPLE_VALUE_PROVIDER",supportAskForValue:!0},field:{normalProviderType:"LIST_VALUE_PROVIDER"}},dateOperatorIsOnOrAfter:{value:{normalProviderType:"SIMPLE_VALUE_PROVIDER",supportAskForValue:!0},field:{normalProviderType:"LIST_VALUE_PROVIDER"}},dateOperatorInTheLast:{value:{normalProviderType:"NUMBER_LIST_VALUE_PROVIDER",supportAskForValue:!0}},dateOperatorNotInTheLast:{value:{normalProviderType:"NUMBER_LIST_VALUE_PROVIDER",
supportAskForValue:!0}},dateOperatorIsBetween:{value:{normalProviderType:"TWO_DATES_VALUE_PROVIDER",supportAskForValue:!0}},dateOperatorIsNotBetween:{value:{normalProviderType:"TWO_DATES_VALUE_PROVIDER",supportAskForValue:!0}},dateOperatorIsBlank:{value:{normalProviderType:"BLANK_VALUE_PROVIDER"}},dateOperatorIsNotBlank:{value:{normalProviderType:"BLANK_VALUE_PROVIDER"}}},a=d([],{nls:null,url:null,layerDefinition:null,layerInfo:null,featureLayerId:null,constructor:function(a){r.mixin(this,a);this.nls=
window.jimuNls.filterBuilder;a=c.getInstanceSync();this.featureLayerId&&(this.layerInfo=a.getLayerOrTableInfoById(this.featureLayerId))},getSupportedValueTypes:function(a,c){var d=[],e=b[c];e&&(e.value&&d.push("value"),e.field&&0<this._getSameShortTypeFieldNames(a).length&&d.push("field"),e.unique&&this.url&&(this._isStreamServer(this.url)||10.1<=parseFloat(this.layerDefinition.currentVersion)&&d.push("unique")));return d},_isStreamServer:function(a){a=(a||"").replace(/\/*$/g,"");return/\/StreamServer$/gi.test(a)},
_getSameShortTypeFieldNames:function(b){var c=[],d=this._getFieldInfo(this.layerDefinition,b),e=a.getShortTypeByEsriType(d.type);l.forEach(this.layerDefinition.fields,r.hitch(this,function(d){d.name!==b&&a.getShortTypeByEsriType(d.type)===e&&c.push(d.name)}));return c},getValueProvider:function(a,c){var d=null,g=r.clone(b[a.operator]);if(g){var f=a.valueObj.type,u=a.fieldObj.name,x=this._getFieldInfo(this.layerDefinition,u),w=g[f],z=w.normalProviderType,A=null,y=this._getCodedValues(x);y||this.layerDefinition.typeIdField&&
this.layerDefinition.typeIdField.toUpperCase()===u.toUpperCase()&&(y=this._getSubTypes(this.layerDefinition));"field"===f?(f=this._getSameShortTypeFieldNames(u),0<f.length&&(A=l.map(f,r.hitch(this,function(a){return{value:a,label:a}})))):y&&0<y.length&&w.codedValueProviderType&&(z=w.codedValueProviderType);g={nls:this.nls,url:this.url,layerDefinition:this.layerDefinition,partObj:a,fieldInfo:x,codedValues:y,staticValues:A,layerInfo:this.layerInfo,operatorInfo:g,filterCodedValueIfPossible:!!w.filterCodedValueIfPossible,
runtime:c};"BLANK_VALUE_PROVIDER"===z?d=new q(g):"SIMPLE_VALUE_PROVIDER"===z?d=new k(g):"TWO_NUMBERS_VALUE_PROVIDER"===z?d=new m(g):"TWO_DATES_VALUE_PROVIDER"===z?d=new p(g):"LIST_VALUE_PROVIDER"===z?(g.showNullValues=!1,d=new h(g)):"NUMBER_LIST_VALUE_PROVIDER"===z&&(d=new e(g))}return d},_getFieldInfo:function(a,b){for(var c=a.fields,d=0;d<c.length;d++){var e=c[d];if(b===e.name)return e}return null},_getCodedValues:function(a){var b=null;(a=a.domain)&&"codedValue"===a.type&&a.codedValues&&0<a.codedValues.length&&
(b=a.codedValues,b=l.map(b,r.hitch(this,function(a){return{value:a.code,label:a.name}})));return b},_getSubTypes:function(a){var b=null;a.typeIdField&&a.types&&0<a.types.length&&(b=l.map(a.types,r.hitch(this,function(a){return{value:a.id,label:a.name}})));return b}});a.getOperatorInfo=function(a){return r.clone(b[a])};a.getOperatorsByShortType=function(a){var b=[];"string"===a?b="stringOperatorIs stringOperatorIsNot stringOperatorStartsWith stringOperatorEndsWith stringOperatorContains stringOperatorDoesNotContain stringOperatorIsBlank stringOperatorIsNotBlank".split(" "):
"number"===a?b="numberOperatorIs numberOperatorIsNot numberOperatorIsAtLeast numberOperatorIsLessThan numberOperatorIsAtMost numberOperatorIsGreaterThan numberOperatorIsBetween numberOperatorIsNotBetween numberOperatorIsBlank numberOperatorIsNotBlank".split(" "):"date"===a&&(b="dateOperatorIsOn dateOperatorIsNotOn dateOperatorIsBefore dateOperatorIsAfter dateOperatorIsOnOrBefore dateOperatorIsOnOrAfter dateOperatorInTheLast dateOperatorNotInTheLast dateOperatorIsBetween dateOperatorIsNotBetween dateOperatorIsBlank dateOperatorIsNotBlank".split(" "));
return b};a.getShortTypeByEsriType=function(a){var b=null;"esriFieldTypeString"===a?b="string":"esriFieldTypeDate"===a?b="date":0<=["esriFieldTypeOID","esriFieldTypeSmallInteger","esriFieldTypeInteger","esriFieldTypeSingle","esriFieldTypeDouble"].indexOf(a)&&(b="number");return b};return a})},"jimu/dijit/_filter/BlankValueProvider":function(){define(["dojo/_base/html","dojo/_base/declare","./ValueProvider"],function(r,l,d){return l([d],{templateString:"\x3cdiv\x3e\x3c/div\x3e",postCreate:function(){this.inherited(arguments);
r.addClass(this.domNode,"jimu-filter-blank-value-provider")},getDijits:function(){return[]},getStatus:function(){return 1},setValueObject:function(){},getValueObject:function(){return{isValid:!0,type:this.partObj.valueObj.type,value:null}},isBlankValueProvider:function(){return!0}})})},"jimu/dijit/_filter/ValueProvider":function(){define("dojo/on dojo/Evented dojo/_base/lang dojo/_base/html dojo/_base/array dojo/_base/declare dijit/_WidgetBase dijit/_TemplatedMixin jimu/utils esri/lang".split(" "),
function(r,l,d,q,k,m,p,h,e,c){return m([p,h,l],{baseClass:"jimu-filter-value-provider",fieldName:null,shortType:null,_enabled:!1,cascade:"none",filterCodedValue:!1,nls:null,url:null,layerDefinition:null,fieldInfo:null,partObj:null,runtime:!0,staticValues:null,codedValues:null,layerInfo:null,operatorInfo:null,filterCodedValueIfPossible:!1,postMixInProperties:function(){this.inherited(arguments);this.shortType=this.partObj.fieldObj.shortType;this.fieldName=this.partObj.fieldObj.name;this.cascade=this.partObj.interactiveObj&&
this.partObj.interactiveObj.cascade;this.runtime&&this.codedValues&&this.filterCodedValueIfPossible&&e.isCodedValuesSupportFilter(this.layerDefinition,this.codedValues.length)?this.filterCodedValue=!0:this.filterCodedValue=!1},getDijits:function(){return[]},bindChangeEvents:function(){var b=this.getDijits();k.forEach(b,d.hitch(this,function(a){a.declaredClass&&0===a.declaredClass.indexOf("dijit.")&&q.addClass(a.domNode,a.declaredClass.replace(/\./g,"-"));this.own(r(a,"change",d.hitch(this,this._onChanged)))}))},
_onChanged:function(){this.emit("change")},tryLocaleNumber:function(b){var a=e.localizeNumber(b);if(null===a||void 0===a)a=b;return a},getPartObject:function(){var b=this.getValueObject();if(!b)return null;var a=d.clone(this.partObj);a.valueObj=b;return a},setValueObject:function(){},getValueObject:function(){},tryGetValueObject:function(){return this.getValueObject()},setRequired:function(){},getStatus:function(){var b=1,a=this.getDijits();0<a.length&&(b=k.map(a,d.hitch(this,function(a){return this.getStatusForDijit(a)})),
b=Math.min.apply(b,b));return b},getStatusForDijit:function(b){return b.validate()?b.get("DisplayedValue")?1:0:-1},isInvalidValue:function(){return 0>this.getStatus()},isEmptyValue:function(){return 0===this.getStatus()},isValidValue:function(){return 0<this.getStatus()},isBlankValueProvider:function(){return!1},getFilterExpr:function(){var b="1\x3d1",b=this.getLayerFilterExpr();if("all"===this.cascade||"previous"===this.cascade)var a=this.getCascadeFilterExpr(),b="("+b+") AND ("+a+")";return b},
getLayerFilterExpr:function(){var b="1\x3d1";this.layerInfo&&(b=this.layerInfo.getFilter());b||(b="1\x3d1");return b},getCascadeFilterExpr:function(){return"1\x3d1"},isDefined:function(b){return c.isDefined(b)},disable:function(){this._enabled=!1},enable:function(){this._enabled=!0},isEnabled:function(){return this._enabled}})})},"jimu/dijit/_filter/SimpleValueProvider":function(){define("dojo/_base/html dojo/_base/declare ./ValueProvider dijit/form/ValidationTextBox dijit/form/DateTextBox dijit/form/NumberTextBox".split(" "),
function(r,l,d,q,k,m){return l([d],{templateString:"\x3cdiv\x3e\x3c/div\x3e",_dijit:null,postCreate:function(){this.inherited(arguments);r.addClass(this.domNode,"jimu-filter-simple-value-provider");this._dijit="string"===this.shortType?new q({required:!1,trim:!0}):"number"===this.shortType?new m({required:!1,intermediateChanges:!0,constraints:{pattern:"#####0.##########"}}):new k({required:!1,trim:!0,value:new Date});r.setStyle(this._dijit.domNode,"width","100%");this._dijit.placeAt(this.domNode)},
getDijits:function(){return[this._dijit]},setValueObject:function(d){this.isDefined(d.value)&&("date"===this.shortType?this._dijit.set("value",new Date(d.value)):this._dijit.set("value",d.value))},getValueObject:function(){if(this.isValidValue()){var d=this._dijit.get("value");"date"===this.shortType?d=d.toDateString():"number"===this.shortType&&(d=parseFloat(d));return{isValid:!0,type:this.partObj.valueObj.type,value:d}}return null},tryGetValueObject:function(){return this.isValidValue()?this.getValueObject():
this.isEmptyValue()?{isValid:!0,type:this.partObj.valueObj.type,value:"string"===this.shortType?"":null}:null},setRequired:function(d){this._dijit.set("required",d)}})})},"dijit/form/DateTextBox":function(){define(["dojo/_base/declare","../Calendar","./_DateTimeTextBox"],function(r,l,d){return r("dijit.form.DateTextBox",d,{baseClass:"dijitTextBox dijitComboBox dijitDateTextBox",popupClass:l,_selector:"date",maxHeight:Infinity,value:new Date("")})})},"dijit/Calendar":function(){define("dojo/_base/array dojo/date dojo/date/locale dojo/_base/declare dojo/dom-attr dojo/dom-class dojo/dom-construct dojo/_base/kernel dojo/keys dojo/_base/lang dojo/on dojo/sniff ./CalendarLite ./_Widget ./_CssStateMixin ./_TemplatedMixin ./form/DropDownButton".split(" "),
function(r,l,d,q,k,m,p,h,e,c,b,a,g,u,n,t,f){var v=q("dijit.Calendar",[g,u,n],{baseClass:"dijitCalendar",cssStateNodes:{decrementMonth:"dijitCalendarArrow",incrementMonth:"dijitCalendarArrow",previousYearLabelNode:"dijitCalendarPreviousYear",nextYearLabelNode:"dijitCalendarNextYear"},setValue:function(a){h.deprecated("dijit.Calendar:setValue() is deprecated.  Use set('value', ...) instead.","","2.0");this.set("value",a)},_createMonthWidget:function(){return new v._MonthDropDownButton({id:this.id+"_mddb",
tabIndex:-1,onMonthSelect:c.hitch(this,"_onMonthSelect"),lang:this.lang,dateLocaleModule:this.dateLocaleModule},this.monthNode)},postCreate:function(){this.inherited(arguments);this.own(b(this.domNode,"keydown",c.hitch(this,"_onKeyDown")),b(this.dateRowsNode,"mouseover",c.hitch(this,"_onDayMouseOver")),b(this.dateRowsNode,"mouseout",c.hitch(this,"_onDayMouseOut")),b(this.dateRowsNode,"mousedown",c.hitch(this,"_onDayMouseDown")),b(this.dateRowsNode,"mouseup",c.hitch(this,"_onDayMouseUp")))},_onMonthSelect:function(a){var b=
new this.dateClassObj(this.currentFocus);b.setDate(1);b.setMonth(a);a=this.dateModule.getDaysInMonth(b);var c=this.currentFocus.getDate();b.setDate(Math.min(c,a));this._setCurrentFocusAttr(b)},_onDayMouseOver:function(a){(a=m.contains(a.target,"dijitCalendarDateLabel")?a.target.parentNode:a.target)&&(a.dijitDateValue&&!m.contains(a,"dijitCalendarDisabledDate")||a==this.previousYearLabelNode||a==this.nextYearLabelNode)&&(m.add(a,"dijitCalendarHoveredDate"),this._currentNode=a)},_onDayMouseOut:function(a){!this._currentNode||
a.relatedTarget&&a.relatedTarget.parentNode==this._currentNode||(a="dijitCalendarHoveredDate",m.contains(this._currentNode,"dijitCalendarActiveDate")&&(a+=" dijitCalendarActiveDate"),m.remove(this._currentNode,a),this._currentNode=null)},_onDayMouseDown:function(a){(a=a.target.parentNode)&&a.dijitDateValue&&!m.contains(a,"dijitCalendarDisabledDate")&&(m.add(a,"dijitCalendarActiveDate"),this._currentNode=a)},_onDayMouseUp:function(a){(a=a.target.parentNode)&&a.dijitDateValue&&m.remove(a,"dijitCalendarActiveDate")},
handleKey:function(a){var b=-1,c,d=this.currentFocus;switch(a.keyCode){case e.RIGHT_ARROW:b=1;case e.LEFT_ARROW:c="day";this.isLeftToRight()||(b*=-1);break;case e.DOWN_ARROW:b=1;case e.UP_ARROW:c="week";break;case e.PAGE_DOWN:b=1;case e.PAGE_UP:c=a.ctrlKey||a.altKey?"year":"month";break;case e.END:d=this.dateModule.add(d,"month",1),c="day";case e.HOME:d=new this.dateClassObj(d);d.setDate(1);break;default:return!0}c&&(d=this.dateModule.add(d,c,b));this._setCurrentFocusAttr(d);return!1},_onKeyDown:function(a){this.handleKey(a)||
(a.stopPropagation(),a.preventDefault())},onValueSelected:function(){},onChange:function(a){this.onValueSelected(a)},getClassForDate:function(){}});v._MonthDropDownButton=q("dijit.Calendar._MonthDropDownButton",f,{onMonthSelect:function(){},postCreate:function(){this.inherited(arguments);this.dropDown=new v._MonthDropDown({id:this.id+"_mdd",onChange:this.onMonthSelect})},_setMonthAttr:function(b){var c=this.dateLocaleModule.getNames("months","wide","standAlone",this.lang,b);this.dropDown.set("months",
c);this.containerNode.innerHTML=(6==a("ie")?"":"\x3cdiv class\x3d'dijitSpacer'\x3e"+this.dropDown.domNode.innerHTML+"\x3c/div\x3e")+"\x3cdiv class\x3d'dijitCalendarMonthLabel dijitCalendarCurrentMonthLabel'\x3e"+c[b.getMonth()]+"\x3c/div\x3e"}});v._MonthDropDown=q("dijit.Calendar._MonthDropDown",[u,t,n],{months:[],baseClass:"dijitCalendarMonthMenu dijitMenu",templateString:"\x3cdiv data-dojo-attach-event\x3d'ondijitclick:_onClick'\x3e\x3c/div\x3e",_setMonthsAttr:function(a){this.domNode.innerHTML=
"";r.forEach(a,function(a,b){p.create("div",{className:"dijitCalendarMonthLabel",month:b,innerHTML:a},this.domNode)._cssState="dijitCalendarMonthLabel"},this)},_onClick:function(a){this.onChange(k.get(a.target,"month"))},onChange:function(){}});return v})},"dijit/CalendarLite":function(){define("dojo/_base/array dojo/_base/declare dojo/cldr/supplemental dojo/date dojo/date/locale dojo/date/stamp dojo/dom dojo/dom-class dojo/dom-attr dojo/_base/lang dojo/on dojo/sniff dojo/string ./_WidgetBase ./_TemplatedMixin dojo/text!./templates/Calendar.html ./a11yclick ./hccss".split(" "),
function(r,l,d,q,k,m,p,h,e,c,b,a,g,u,n,t){var f=l("dijit.CalendarLite",[u,n],{templateString:t,dowTemplateString:'\x3cth class\x3d"dijitReset dijitCalendarDayLabelTemplate" role\x3d"columnheader" scope\x3d"col"\x3e\x3cspan class\x3d"dijitCalendarDayLabel"\x3e${d}\x3c/span\x3e\x3c/th\x3e',dateTemplateString:'\x3ctd class\x3d"dijitReset" role\x3d"gridcell" data-dojo-attach-point\x3d"dateCells"\x3e\x3cspan class\x3d"dijitCalendarDateLabel" data-dojo-attach-point\x3d"dateLabels"\x3e\x3c/span\x3e\x3c/td\x3e',
weekTemplateString:'\x3ctr class\x3d"dijitReset dijitCalendarWeekTemplate" role\x3d"row"\x3e${d}${d}${d}${d}${d}${d}${d}\x3c/tr\x3e',value:new Date(""),datePackage:"",dayWidth:"narrow",tabIndex:"0",dayOffset:-1,currentFocus:new Date,_setSummaryAttr:"gridNode",baseClass:"dijitCalendar dijitCalendarLite",_isValidDate:function(a){return a&&!isNaN(a)&&"object"==typeof a&&a.toString()!=this.constructor.prototype.value.toString()},_getValueAttr:function(){var a=this._get("value");if(a&&!isNaN(a)){var b=
new this.dateClassObj(a);b.setHours(0,0,0,0);b.getDate()<a.getDate()&&(b=this.dateModule.add(b,"hour",1));return b}return null},_setValueAttr:function(a,b){"string"==typeof a&&(a=m.fromISOString(a));a=this._patchDate(a);if(this._isValidDate(a)&&!this.isDisabledDate(a,this.lang)){if(this._set("value",a),this.set("currentFocus",a),this._markSelectedDates([a]),this._created&&(b||"undefined"==typeof b))this.onChange(this.get("value"))}else this._set("value",null),this._markSelectedDates([])},_patchDate:function(a){if(a||
0===a)a=new this.dateClassObj(a),a.setHours(1,0,0,0);return a},_setText:function(a,b){for(;a.firstChild;)a.removeChild(a.firstChild);a.appendChild(a.ownerDocument.createTextNode(b))},_populateGrid:function(){var a=new this.dateClassObj(this.currentFocus);a.setDate(1);var a=this._patchDate(a),b=a.getDay(),c=this.dateModule.getDaysInMonth(a),f=this.dateModule.getDaysInMonth(this.dateModule.add(a,"month",-1)),g=new this.dateClassObj,h=0<=this.dayOffset?this.dayOffset:d.getFirstDayOfWeek(this.lang);h>
b&&(h-=7);if(!this.summary){var l=this.dateLocaleModule.getNames("months","wide","standAlone",this.lang,a);this.gridNode.setAttribute("summary",l[a.getMonth()])}this._date2cell={};r.forEach(this.dateCells,function(d,l){var n=l+h,m=new this.dateClassObj(a),p="dijitCalendar",q=0;n<b?(n=f-b+n+1,q=-1,p+="Previous"):n>=b+c?(n=n-b-c+1,q=1,p+="Next"):(n=n-b+1,p+="Current");q&&(m=this.dateModule.add(m,"month",q));m.setDate(n);this.dateModule.compare(m,g,"date")||(p="dijitCalendarCurrentDate "+p);this.isDisabledDate(m,
this.lang)?(p="dijitCalendarDisabledDate "+p,d.setAttribute("aria-disabled","true")):(p="dijitCalendarEnabledDate "+p,d.removeAttribute("aria-disabled"),d.setAttribute("aria-selected","false"));(q=this.getClassForDate(m,this.lang))&&(p=q+" "+p);d.className=p+"Month dijitCalendarDateTemplate";p=m.valueOf();this._date2cell[p]=d;d.dijitDateValue=p;p=m.getDateLocalized?m.getDateLocalized(this.lang):m.getDate();this._setText(this.dateLabels[l],p);e.set(d,"aria-label",k.format(m,{selector:"date",formatLength:"long"}))},
this)},_populateControls:function(){var a=new this.dateClassObj(this.currentFocus);a.setDate(1);this.monthWidget.set("month",a);var b=a.getFullYear()-1,c=new this.dateClassObj;r.forEach(["previous","current","next"],function(a){c.setFullYear(b++);this._setText(this[a+"YearLabelNode"],this.dateLocaleModule.format(c,{selector:"year",locale:this.lang}))},this)},goToToday:function(){this.set("value",new this.dateClassObj)},constructor:function(a){this.dateModule=a.datePackage?c.getObject(a.datePackage,
!1):q;this.dateClassObj=this.dateModule.Date||Date;this.dateLocaleModule=a.datePackage?c.getObject(a.datePackage+".locale",!1):k},_createMonthWidget:function(){return f._MonthWidget({id:this.id+"_mddb",lang:this.lang,dateLocaleModule:this.dateLocaleModule},this.monthNode)},buildRendering:function(){var a=this.dowTemplateString,b=this.dateLocaleModule.getNames("days",this.dayWidth,"standAlone",this.lang),c=0<=this.dayOffset?this.dayOffset:d.getFirstDayOfWeek(this.lang);this.dayCellsHtml=g.substitute([a,
a,a,a,a,a,a].join(""),{d:""},function(){return b[c++%7]});a=g.substitute(this.weekTemplateString,{d:this.dateTemplateString});this.dateRowsHtml=[a,a,a,a,a,a].join("");this.dateCells=[];this.dateLabels=[];this.inherited(arguments);p.setSelectable(this.domNode,!1);a=new this.dateClassObj(this.currentFocus);this.monthWidget=this._createMonthWidget();this.set("currentFocus",a,!1)},postCreate:function(){this.inherited(arguments);this._connectControls()},_connectControls:function(){var a=c.hitch(this,function(a,
d,e){this[a].dojoClick=!0;return b(this[a],"click",c.hitch(this,function(){this._setCurrentFocusAttr(this.dateModule.add(this.currentFocus,d,e))}))});this.own(a("incrementMonth","month",1),a("decrementMonth","month",-1),a("nextYearLabelNode","year",1),a("previousYearLabelNode","year",-1))},_setCurrentFocusAttr:function(b,c){var d=this.currentFocus,e=this._getNodeByDate(d);b=this._patchDate(b);this._set("currentFocus",b);this._date2cell&&0==this.dateModule.difference(d,b,"month")||(this._populateGrid(),
this._populateControls(),this._markSelectedDates([this.value]));d=this._getNodeByDate(b);d.setAttribute("tabIndex",this.tabIndex);(this.focused||c)&&d.focus();e&&e!=d&&(a("webkit")?e.setAttribute("tabIndex","-1"):e.removeAttribute("tabIndex"))},focus:function(){this._setCurrentFocusAttr(this.currentFocus,!0)},_onDayClick:function(a){a.stopPropagation();a.preventDefault();for(a=a.target;a&&!a.dijitDateValue&&0!==a.dijitDateValue;a=a.parentNode);a&&!h.contains(a,"dijitCalendarDisabledDate")&&this.set("value",
a.dijitDateValue)},_getNodeByDate:function(a){return(a=this._patchDate(a))&&this._date2cell?this._date2cell[a.valueOf()]:null},_markSelectedDates:function(a){function b(a,b){h.toggle(b,"dijitCalendarSelectedDate",a);b.setAttribute("aria-selected",a?"true":"false")}r.forEach(this._selectedCells||[],c.partial(b,!1));this._selectedCells=r.filter(r.map(a,this._getNodeByDate,this),function(a){return a});r.forEach(this._selectedCells,c.partial(b,!0))},onChange:function(){},isDisabledDate:function(){},getClassForDate:function(){}});
f._MonthWidget=l("dijit.CalendarLite._MonthWidget",u,{_setMonthAttr:function(b){var c=this.dateLocaleModule.getNames("months","wide","standAlone",this.lang,b),d=6==a("ie")?"":"\x3cdiv class\x3d'dijitSpacer'\x3e"+r.map(c,function(a){return"\x3cdiv\x3e"+a+"\x3c/div\x3e"}).join("")+"\x3c/div\x3e";this.domNode.innerHTML=d+"\x3cdiv class\x3d'dijitCalendarMonthLabel dijitCalendarCurrentMonthLabel'\x3e"+c[b.getMonth()]+"\x3c/div\x3e"}});return f})},"dijit/form/_DateTimeTextBox":function(){define("dojo/date dojo/date/locale dojo/date/stamp dojo/_base/declare dojo/_base/lang ./RangeBoundTextBox ../_HasDropDown dojo/text!./templates/DropDownBox.html".split(" "),
function(r,l,d,q,k,m,p,h){new Date("X");return q("dijit.form._DateTimeTextBox",[m,p],{templateString:h,hasDownArrow:!0,cssStateNodes:{_buttonNode:"dijitDownArrowButton"},_unboundedConstraints:{},pattern:l.regexp,datePackage:"",postMixInProperties:function(){this.inherited(arguments);this._set("type","text")},compare:function(d,c){var b=this._isInvalidDate(d),a=this._isInvalidDate(c);if(b||a)return b&&a?0:b?-1:1;var b=this.format(d,this._unboundedConstraints),a=this.format(c,this._unboundedConstraints),
e=this.parse(b,this._unboundedConstraints),h=this.parse(a,this._unboundedConstraints);return b==a?0:r.compare(e,h,this._selector)},autoWidth:!0,format:function(d,c){return d?this.dateLocaleModule.format(d,c):""},parse:function(d,c){return this.dateLocaleModule.parse(d,c)||(this._isEmpty(d)?null:void 0)},serialize:function(e,c){e.toGregorian&&(e=e.toGregorian());return d.toISOString(e,c)},dropDownDefaultValue:new Date,value:new Date(""),_blankValue:null,popupClass:"",_selector:"",constructor:function(d){d=
d||{};this.dateModule=d.datePackage?k.getObject(d.datePackage,!1):r;this.dateClassObj=this.dateModule.Date||Date;this.dateClassObj instanceof Date||(this.value=new this.dateClassObj(this.value));this.dateLocaleModule=d.datePackage?k.getObject(d.datePackage+".locale",!1):l;this._set("pattern",this.dateLocaleModule.regexp);this._invalidDate=this.constructor.prototype.value.toString()},buildRendering:function(){this.inherited(arguments);this.hasDownArrow||(this._buttonNode.style.display="none");this.hasDownArrow||
(this._buttonNode=this.domNode,this.baseClass+=" dijitComboBoxOpenOnClick")},_setConstraintsAttr:function(e){e.selector=this._selector;e.fullYear=!0;var c=d.fromISOString;"string"==typeof e.min&&(e.min=c(e.min),this.dateClassObj instanceof Date||(e.min=new this.dateClassObj(e.min)));"string"==typeof e.max&&(e.max=c(e.max),this.dateClassObj instanceof Date||(e.max=new this.dateClassObj(e.max)));this.inherited(arguments);this._unboundedConstraints=k.mixin({},this.constraints,{min:null,max:null})},_isInvalidDate:function(d){return!d||
isNaN(d)||"object"!=typeof d||d.toString()==this._invalidDate},_setValueAttr:function(e,c,b){void 0!==e&&("string"==typeof e&&(e=d.fromISOString(e)),this._isInvalidDate(e)&&(e=null),e instanceof Date&&!(this.dateClassObj instanceof Date)&&(e=new this.dateClassObj(e)));this.inherited(arguments,[e,c,b]);this.value instanceof Date&&(this.filterString="");!1!==c&&this.dropDown&&this.dropDown.set("value",e,!1)},_set:function(d,c){if("value"==d){c instanceof Date&&!(this.dateClassObj instanceof Date)&&
(c=new this.dateClassObj(c));var b=this._get("value");if(b instanceof this.dateClassObj&&0==this.compare(c,b))return}this.inherited(arguments)},_setDropDownDefaultValueAttr:function(d){this._isInvalidDate(d)&&(d=new this.dateClassObj);this._set("dropDownDefaultValue",d)},openDropDown:function(d){this.dropDown&&this.dropDown.destroy();var c=k.isString(this.popupClass)?k.getObject(this.popupClass,!1):this.popupClass,b=this,a=this.get("value");this.dropDown=new c({onChange:function(a){b.set("value",
a,!0)},id:this.id+"_popup",dir:b.dir,lang:b.lang,value:a,textDir:b.textDir,currentFocus:this._isInvalidDate(a)?this.dropDownDefaultValue:a,constraints:b.constraints,filterString:b.filterString,datePackage:b.datePackage,isDisabledDate:function(a){return!b.rangeCheck(a,b.constraints)}});this.inherited(arguments)},_getDisplayedValueAttr:function(){return this.textbox.value},_setDisplayedValueAttr:function(d,c){this._setValueAttr(this.parse(d,this.constraints),c,d)}})})},"jimu/dijit/_filter/TwoNumbersValueProvider":function(){define("dojo/_base/html dojo/_base/declare ./ValueProvider dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dojo/text!./TwoNumbersValueProvider.html dijit/form/NumberTextBox".split(" "),
function(r,l,d,q,k,m){return l([d,q,k],{templateString:m,postCreate:function(){this.inherited(arguments);r.addClass(this.domNode,"jimu-two-numbers-filter-value-provider")},_onRangeNumberBlur:function(){if(this._dijit1.validate()&&this._dijit2.validate()){var d=parseFloat(this._dijit1.get("value")),h=parseFloat(this._dijit2.get("value"));d>h&&(this._dijit1.set("value",h),this._dijit2.set("value",d))}},getDijits:function(){return[this._dijit1,this._dijit2]},setValueObject:function(d){this.isDefined(d.value1)&&
this._dijit1.set("value",d.value1);this.isDefined(d.value2)&&this._dijit2.set("value",d.value2)},getValueObject:function(){return this.isValidValue()?{isValid:!0,type:this.partObj.valueObj.type,value1:parseFloat(this._dijit1.get("value")),value2:parseFloat(this._dijit2.get("value"))}:null},tryGetValueObject:function(){if(this.isValidValue())return this.getValueObject();if(this.isEmptyValue()){var d={isValid:!0,type:this.partObj.valueObj.type,value1:parseFloat(this._dijit1.get("value")),value2:parseFloat(this._dijit2.get("value"))};
isNaN(d.value1)&&(d.value1=null);isNaN(d.value2)&&(d.value2=null);return d}return null},setRequired:function(d){this._dijit1.set("required",d);this._dijit2.set("required",d)}})})},"jimu/dijit/_filter/TwoDatesValueProvider":function(){define("dojo/_base/html dojo/_base/declare ./ValueProvider dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dojo/text!./TwoDatesValueProvider.html dijit/form/DateTextBox".split(" "),function(r,l,d,q,k,m){return l([d,q,k],{templateString:m,postCreate:function(){this.inherited(arguments);
r.addClass(this.domNode,"jimu-two-dates-filter-value-provider")},_onRangeDateBlur:function(){if(this._dijit1.validate()&&this._dijit2.validate()){var d=this._dijit1.get("value"),h=d.getTime(),e=this._dijit2.get("value"),c=e.getTime();h>c&&(this._dijit1.set("value",e),this._dijit2.set("value",d))}},getDijits:function(){return[this._dijit1,this._dijit2]},setValueObject:function(d){this.isDefined(d.value1)&&this._dijit1.set("value",new Date(d.value1));this.isDefined(d.value2)&&this._dijit2.set("value",
new Date(d.value2))},getValueObject:function(){return this.isValidValue()?{isValid:!0,type:this.partObj.valueObj.type,value1:this._dijit1.get("value").toDateString(),value2:this._dijit2.get("value").toDateString()}:null},setRequired:function(d){this._dijit1.set("required",d);this._dijit2.set("required",d)}})})},"jimu/dijit/_filter/ListValueProvider":function(){define("dojo/aspect dojo/Deferred dojo/_base/lang dojo/_base/html dojo/_base/array dojo/_base/declare ./ValueProvider dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dojo/text!./ListValueProvider.html dojo/store/Memory jimu/utils dijit/form/FilteringSelect".split(" "),
function(r,l,d,q,k,m,p,h,e,c,b,a){return m([p,h,e],{templateString:c,codedValues:null,staticValues:null,showNullValues:!1,postCreate:function(){this.inherited(arguments);q.addClass(this.domNode,"jimu-filter-list-value-provider");this._uniqueValueCache={};var a=new b({idProperty:"id",data:[]});this.valuesSelect.set("store",a);this.staticValues||"function"!==typeof this.valuesSelect._onDropDownMouseDown||(!this.codedValues||this.codedValues&&this.filterCodedValue)&&this.own(r.before(this.valuesSelect,
"_onDropDownMouseDown",d.hitch(this,this._onBeforeDropDownMouseDown)))},_onFilteringSelectInput:function(){this.emit("change")},_onBeforeDropDownMouseDown:function(){this._tryUpdatingUniqueValues(void 0,!0);return arguments},getDijits:function(){return[this.valuesSelect]},setValueObject:function(a){return this.staticValues?this._setValueForStaticValues(a.value,this.staticValues):this.codedValues?this.filterCodedValue?this._tryUpdatingUniqueValues(a.value,!1):this._setValueForStaticValues(a.value,
this.codedValues):this._tryUpdatingUniqueValues(a.value,!1)},getValueObject:function(){if(this.isValidValue()){var a=this.valuesSelect.get("item").value;return{isValid:!0,type:this.partObj.valueObj.type,value:a}}return null},tryGetValueObject:function(){return this.isValidValue()?this.getValueObject():this.isEmptyValue()?{isValid:!0,type:this.partObj.valueObj.type,value:"string"===this.shortType?"":null}:null},setRequired:function(a){this.valuesSelect.set("required",a)},_setValueForStaticValues:function(a,
b){var c=null,e=-1,c=null;b&&(c=k.map(b,d.hitch(this,function(b,c){var d={id:c,value:b.value,label:b.label};d.value===a&&(e=c);return d})),this.valuesSelect.store.setData(c),0<=e&&(c=this.valuesSelect.store.get(e))&&this.valuesSelect.set("item",c))},_uniqueValueLoadingDef:null,_uniqueValueLoadingExpr:"",_uniqueValueCache:null,_tryUpdatingUniqueValues:function(a,b){var c=new l;if(this.valuesSelect._opened)c.resolve();else{var e=this.getFilterExpr();e!==this._uniqueValueLoadingExpr?(this.valuesSelect.readOnly=
!0,this._uniqueValueLoadingDef&&(this._uniqueValueLoadingDef.reject(),this._uniqueValueLoadingDef=null),this._uniqueValueLoadingExpr=e,this._uniqueValueLoadingDef=this._getUniqueValues(e),this._uniqueValueLoadingDef.then(d.hitch(this,function(d){this.domNode&&(this._uniqueValueLoadingDef=null,this.valuesSelect.readOnly=!1,this._setValueForUniqueValues(a,d),this._hideLoadingIcon(),b&&this.valuesSelect.toggleDropDown(),c.resolve())}),d.hitch(this,function(a){console.error(a);this.domNode&&(this._uniqueValueLoadingDef=
null,this.valuesSelect.readOnly=!1,this._hideLoadingIcon(),c.reject(a))}))):c.resolve()}return c},_setValueForUniqueValues:function(a,b){b.sort(function(a,b){return a.value<b.value?-1:a.value===b.value?0:1});this.showNullValues||(b=k.filter(b,d.hitch(this,function(a){return"\x3cNull\x3e"!==a.value&&null!==a.value})));if(void 0===a){var c=this.getValueObject();c&&(a=c.value)}var e=-1,c=null,f=k.map(b,d.hitch(this,function(b,c){var d={id:c,value:b.value,label:b.label};b.value===a&&(e=c);return d}));
this.valuesSelect.store.setData(f);0<=e&&(c=this.valuesSelect.store.get(e));this.valuesSelect.set("item",c)},_showLoadingIcon:function(){q.addClass(this.valuesSelect.domNode,"loading")},_hideLoadingIcon:function(){q.removeClass(this.valuesSelect.domNode,"loading")},_getUniqueValues:function(b){var c=new l;this._uniqueValueCache[b]?c.resolve(this._uniqueValueCache[b]):(this._showLoadingIcon(),a.getUniqueValues(this.url,this.fieldName,b,this.layerDefinition).then(d.hitch(this,function(a){this.domNode&&
(this._uniqueValueCache[b]=a,c.resolve(a),this._hideLoadingIcon())}),d.hitch(this,function(a){this.domNode&&(c.reject(a),this._hideLoadingIcon())})));return c}})})},"dijit/form/FilteringSelect":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/when","./MappedTextBox","./ComboBoxMixin"],function(r,l,d,q,k){return r("dijit.form.FilteringSelect",[q,k],{required:!0,_lastDisplayedValue:"",_isValidSubset:function(){return this._opened},isValid:function(){return!!this.item||!this.required&&
""==this.get("displayedValue")},_refreshState:function(){this.searchTimer||this.inherited(arguments)},_callbackSetLabel:function(d,k,h,e){k&&k[this.searchAttr]!==this._lastQuery||!k&&d.length&&this.store.getIdentity(d[0])!=this._lastQuery||(d.length?this.set("item",d[0],e):this.set("value","",e||void 0===e&&!this.focused,this.textbox.value,null))},_openResultList:function(d,k,h){k[this.searchAttr]===this._lastQuery&&(this.inherited(arguments),void 0===this.item&&this.validate(!0))},_getValueAttr:function(){return this.valueNode.value},
_getValueField:function(){return"value"},_setValueAttr:function(k,p,h,e){this._onChangeActive||(p=null);if(void 0===e){if(null===k||""===k)if(k="",!l.isString(h)){this._setDisplayedValueAttr(h||"",p);return}var c=this;this._lastQuery=k;d(this.store.get(k),function(b){c._callbackSetLabel(b?[b]:[],void 0,void 0,p)})}else this.valueNode.value=k,this.inherited(arguments,[k,p,h,e])},_setItemAttr:function(d,k,h){this.inherited(arguments);this._lastDisplayedValue=this.textbox.value},_getDisplayQueryString:function(d){return d.replace(/([\\\*\?])/g,
"\\$1")},_setDisplayedValueAttr:function(k,p){null==k&&(k="");if(!this._created){if(!("displayedValue"in this.params))return;p=!1}if(this.store){this.closeDropDown();var h=l.clone(this.query),e=this._getDisplayQueryString(k),c;this.store._oldAPI?c=e:(c=this._patternToRegExp(e),c.toString=function(){return e});this._lastQuery=h[this.searchAttr]=c;this._lastDisplayedValue=this.textbox.value=k;this._set("displayedValue",k);var b=this,a={queryOptions:{ignoreCase:this.ignoreCase,deep:!0}};l.mixin(a,this.fetchProperties);
this._fetchHandle=this.store.query(h,a);d(this._fetchHandle,function(c){b._fetchHandle=null;b._callbackSetLabel(c||[],h,a,p)},function(a){b._fetchHandle=null;b._cancelingQuery||console.error("dijit.form.FilteringSelect: "+a.toString())})}},undo:function(){this.set("displayedValue",this._lastDisplayedValue)}})})},"dijit/form/ComboBoxMixin":function(){define("dojo/_base/declare dojo/Deferred dojo/_base/kernel dojo/_base/lang dojo/store/util/QueryResults ./_AutoCompleterMixin ./_ComboBoxMenu ../_HasDropDown dojo/text!./templates/DropDownBox.html".split(" "),
function(r,l,d,q,k,m,p,h,e){return r("dijit.form.ComboBoxMixin",[h,m],{dropDownClass:p,hasDownArrow:!0,templateString:e,baseClass:"dijitTextBox dijitComboBox",cssStateNodes:{_buttonNode:"dijitDownArrowButton"},_setHasDownArrowAttr:function(c){this._set("hasDownArrow",c);this._buttonNode.style.display=c?"":"none"},_showResultList:function(){this.displayMessage("");this.inherited(arguments)},_setStoreAttr:function(c){c.get||q.mixin(c,{_oldAPI:!0,get:function(b){var a=new l;this.fetchItemByIdentity({identity:b,
onItem:function(b){a.resolve(b)},onError:function(b){a.reject(b)}});return a.promise},query:function(b,a){var c=new l(function(){d.abort&&d.abort()});c.total=new l;var d=this.fetch(q.mixin({query:b,onBegin:function(a){c.total.resolve(a)},onComplete:function(a){c.resolve(a)},onError:function(a){c.reject(a)}},a));return k(c)}});this._set("store",c)},postMixInProperties:function(){var c=this.params.store||this.store;c&&this._setStoreAttr(c);this.inherited(arguments);if(!this.params.store&&this.store&&
!this.store._oldAPI){var b=this.declaredClass;q.mixin(this.store,{getValue:function(a,c){d.deprecated(b+".store.getValue(item, attr) is deprecated for builtin store.  Use item.attr directly","","2.0");return a[c]},getLabel:function(a){d.deprecated(b+".store.getLabel(item) is deprecated for builtin store.  Use item.label directly","","2.0");return a.name},fetch:function(a){d.deprecated(b+".store.fetch() is deprecated for builtin store.","Use store.query()","2.0");require(["dojo/data/ObjectStore"],
q.hitch(this,function(b){(new b({objectStore:this})).fetch(a)}))}})}},buildRendering:function(){this.inherited(arguments);this.focusNode.setAttribute("aria-autocomplete",this.autoComplete?"both":"list")}})})},"dijit/form/_AutoCompleterMixin":function(){define("dojo/aspect dojo/_base/declare dojo/dom-attr dojo/keys dojo/_base/lang dojo/query dojo/regexp dojo/sniff ./DataList ./_TextBoxMixin ./_SearchMixin".split(" "),function(r,l,d,q,k,m,p,h,e,c,b){l=l("dijit.form._AutoCompleterMixin",b,{item:null,
autoComplete:!0,highlightMatch:"first",labelAttr:"",labelType:"text",maxHeight:-1,_stopClickEvents:!1,_getCaretPos:function(a){var b=0;if("number"==typeof a.selectionStart)b=a.selectionStart;else if(h("ie")){var c=a.ownerDocument.selection.createRange().duplicate();a=a.createTextRange();c.move("character",0);a.move("character",0);try{a.setEndPoint("EndToEnd",c),b=String(a.text).replace(/\r/g,"").length}catch(n){}}return b},_setCaretPos:function(a,b){b=parseInt(b);c.selectInputText(a,b,b)},_setDisabledAttr:function(a){this.inherited(arguments);
this.domNode.setAttribute("aria-disabled",a?"true":"false")},_onKey:function(a){if(!(32<=a.charCode)){var b=a.charCode||a.keyCode;if(b!=q.ALT&&b!=q.CTRL&&b!=q.META&&b!=q.SHIFT){var c=this.dropDown,d=null;this._abortQuery();this.inherited(arguments);if(!(a.altKey||a.ctrlKey||a.metaKey))switch(this._opened&&(d=c.getHighlightedOption()),b){case q.PAGE_DOWN:case q.DOWN_ARROW:case q.PAGE_UP:case q.UP_ARROW:this._opened&&this._announceOption(d);a.stopPropagation();a.preventDefault();break;case q.ENTER:if(d){if(d==
c.nextButton){this._nextSearch(1);a.stopPropagation();a.preventDefault();break}else if(d==c.previousButton){this._nextSearch(-1);a.stopPropagation();a.preventDefault();break}a.stopPropagation();a.preventDefault()}else this._setBlurValue(),this._setCaretPos(this.focusNode,this.focusNode.value.length);case q.TAB:b=this.get("displayedValue");if(c&&(b==c._messages.previousMessage||b==c._messages.nextMessage))break;d&&this._selectOption(d);case q.ESCAPE:this._opened&&(this._lastQuery=null,this.closeDropDown())}}}},
_autoCompleteText:function(a){var b=this.focusNode;c.selectInputText(b,b.value.length);var d=this.ignoreCase?"toLowerCase":"substr";0==a[d](0).indexOf(this.focusNode.value[d](0))?(d=this.autoComplete?this._getCaretPos(b):b.value.length,d+1>b.value.length&&(b.value=a,c.selectInputText(b,d))):(b.value=a,c.selectInputText(b))},_openResultList:function(a,b,c){var d=this.dropDown.getHighlightedOption();this.dropDown.clearResultList();a.length||0!=c.start?(this._nextSearch=this.dropDown.onPage=k.hitch(this,
function(b){a.nextPage(-1!==b);this.focus()}),this.dropDown.createOptions(a,c,k.hitch(this,"_getMenuLabelFromItem")),this._showResultList(),"direction"in c?(c.direction?this.dropDown.highlightFirstOption():c.direction||this.dropDown.highlightLastOption(),d&&this._announceOption(this.dropDown.getHighlightedOption())):!this.autoComplete||this._prev_key_backspace||/^[*]+$/.test(b[this.searchAttr].toString())||this._announceOption(this.dropDown.containerNode.firstChild.nextSibling)):this.closeDropDown()},
_showResultList:function(){this.closeDropDown(!0);this.openDropDown();this.domNode.setAttribute("aria-expanded","true")},loadDropDown:function(){this._startSearchAll()},isLoaded:function(){return!1},closeDropDown:function(){this._abortQuery();this._opened&&(this.inherited(arguments),this.domNode.setAttribute("aria-expanded","false"))},_setBlurValue:function(){var a=this.get("displayedValue"),b=this.dropDown;!b||a!=b._messages.previousMessage&&a!=b._messages.nextMessage?"undefined"==typeof this.item?
(this.item=null,this.set("displayedValue",a)):(this.value!=this._lastValueReported&&this._handleOnChange(this.value,!0),this._refreshState()):this._setValueAttr(this._lastValueReported,!0);this.focusNode.removeAttribute("aria-activedescendant")},_setItemAttr:function(a,b,c){var d="";a&&(c||(c=this.store._oldAPI?this.store.getValue(a,this.searchAttr):a[this.searchAttr]),d=this._getValueField()!=this.searchAttr?this.store.getIdentity(a):c);this.set("value",d,b,c,a)},_announceOption:function(a){if(a){var b;
if(a==this.dropDown.nextButton||a==this.dropDown.previousButton)b=a.innerHTML,this.item=void 0,this.value="";else{var c=this.dropDown.items[a.getAttribute("item")];b=(this.store._oldAPI?this.store.getValue(c,this.searchAttr):c[this.searchAttr]).toString();this.set("item",c,!1,b)}this.focusNode.value=this.focusNode.value.substring(0,this._lastInput.length);this.focusNode.setAttribute("aria-activedescendant",d.get(a,"id"));this._autoCompleteText(b)}},_selectOption:function(a){this.closeDropDown();a&&
this._announceOption(a);this._setCaretPos(this.focusNode,this.focusNode.value.length);this._handleOnChange(this.value,!0);this.focusNode.removeAttribute("aria-activedescendant")},_startSearchAll:function(){this._startSearch("")},_startSearchFromInput:function(){this.item=void 0;this.inherited(arguments)},_startSearch:function(a){if(!this.dropDown){var b=this.id+"_popup";this.dropDown=new (k.isString(this.dropDownClass)?k.getObject(this.dropDownClass,!1):this.dropDownClass)({onChange:k.hitch(this,
this._selectOption),id:b,dir:this.dir,textDir:this.textDir})}this._lastInput=a;this.inherited(arguments)},_getValueField:function(){return this.searchAttr},postMixInProperties:function(){this.inherited(arguments);if(!this.store&&this.srcNodeRef&&(this.store=new e({},this.srcNodeRef),!("value"in this.params))){var a=this.item=this.store.fetchSelectedItem();if(a){var b=this._getValueField();this.value=this.store._oldAPI?this.store.getValue(a,b):a[b]}}},postCreate:function(){var a=m('label[for\x3d"'+
this.id+'"]');a.length&&(a[0].id||(a[0].id=this.id+"_label"),this.domNode.setAttribute("aria-labelledby",a[0].id));this.inherited(arguments);r.after(this,"onSearch",k.hitch(this,"_openResultList"),!0)},_getMenuLabelFromItem:function(a){a=this.labelFunc(a,this.store);var b=this.labelType;"none"!=this.highlightMatch&&"text"==this.labelType&&this._lastInput&&(a=this.doHighlight(a,this._lastInput),b="html");return{html:"html"==b,label:a}},doHighlight:function(a,b){var c=(this.ignoreCase?"i":"")+("all"==
this.highlightMatch?"g":""),d=this.queryExpr.indexOf("${0}");b=p.escapeString(b);return this._escapeHtml(a.replace(new RegExp((0==d?"^":"")+"("+b+")"+(d==this.queryExpr.length-4?"$":""),c),"\uffff$1\uffff")).replace(/\uFFFF([^\uFFFF]+)\uFFFF/g,'\x3cspan class\x3d"dijitComboBoxHighlightMatch"\x3e$1\x3c/span\x3e')},_escapeHtml:function(a){return a=String(a).replace(/&/gm,"\x26amp;").replace(/</gm,"\x26lt;").replace(/>/gm,"\x26gt;").replace(/"/gm,"\x26quot;")},reset:function(){this.item=null;this.inherited(arguments)},
labelFunc:function(a,b){return(b._oldAPI?b.getValue(a,this.labelAttr||this.searchAttr):a[this.labelAttr||this.searchAttr]).toString()},_setValueAttr:function(a,b,c,d){this._set("item",d||null);null==a&&(a="");this.inherited(arguments)}});h("dojo-bidi")&&l.extend({_setTextDirAttr:function(a){this.inherited(arguments);this.dropDown&&this.dropDown._set("textDir",a)}});return l})},"dijit/form/DataList":function(){define("dojo/_base/declare dojo/dom dojo/_base/lang dojo/query dojo/store/Memory ../registry".split(" "),
function(r,l,d,q,k,m){function p(h){return{id:h.value,value:h.value,name:d.trim(h.innerText||h.textContent||"")}}return r("dijit.form.DataList",k,{constructor:function(h,e){this.domNode=l.byId(e);d.mixin(this,h);this.id&&m.add(this);this.domNode.style.display="none";this.inherited(arguments,[{data:q("option",this.domNode).map(p)}])},destroy:function(){m.remove(this.id)},fetchSelectedItem:function(){var d=q("\x3e option[selected]",this.domNode)[0]||q("\x3e option",this.domNode)[0];return d&&p(d)}})})},
"dijit/form/_SearchMixin":function(){define("dojo/_base/declare dojo/keys dojo/_base/lang dojo/query dojo/string dojo/when ../registry".split(" "),function(r,l,d,q,k,m,p){return r("dijit.form._SearchMixin",null,{pageSize:Infinity,store:null,fetchProperties:{},query:{},list:"",_setListAttr:function(d){this._set("list",d)},searchDelay:200,searchAttr:"name",queryExpr:"${0}*",ignoreCase:!0,_patternToRegExp:function(d){return new RegExp("^"+d.replace(/(\\.)|(\*)|(\?)|\W/g,function(d,c,b,a){return b?".*":
a?".":c?c:"\\"+d})+"$",this.ignoreCase?"mi":"m")},_abortQuery:function(){this.searchTimer&&(this.searchTimer=this.searchTimer.remove());this._queryDeferHandle&&(this._queryDeferHandle=this._queryDeferHandle.remove());this._fetchHandle&&(this._fetchHandle.abort&&(this._cancelingQuery=!0,this._fetchHandle.abort(),this._cancelingQuery=!1),this._fetchHandle.cancel&&(this._cancelingQuery=!0,this._fetchHandle.cancel(),this._cancelingQuery=!1),this._fetchHandle=null)},_processInput:function(d){if(!this.disabled&&
!this.readOnly){d=d.charOrCode;this._prev_key_backspace=!1;if(d==l.DELETE||d==l.BACKSPACE)this._maskValidSubsetError=this._prev_key_backspace=!0;if(this.store)this.searchTimer=this.defer("_startSearchFromInput",1);else this.onSearch()}},onSearch:function(){},_startSearchFromInput:function(){this._startSearch(this.focusNode.value)},_startSearch:function(h){this._abortQuery();var e=this,c=d.clone(this.query),b={start:0,count:this.pageSize,queryOptions:{ignoreCase:this.ignoreCase,deep:!0}},a=k.substitute(this.queryExpr,
[h.replace(/([\\\*\?])/g,"\\$1")]),g,l=function(){var a=e._fetchHandle=e.store.query(c,b);e.disabled||e.readOnly||g!==e._lastQuery||m(a,function(d){e._fetchHandle=null;e.disabled||e.readOnly||g!==e._lastQuery||m(a.total,function(a){d.total=a;var f=e.pageSize;if(isNaN(f)||f>d.total)f=d.total;d.nextPage=function(a){b.direction=a=!1!==a;b.count=f;a?(b.start+=d.length,b.start>=d.total&&(b.count=0)):(b.start-=f,0>b.start&&(b.count=Math.max(f+b.start,0),b.start=0));0>=b.count?(d.length=0,e.onSearch(d,c,
b)):l()};e.onSearch(d,c,b)})},function(a){e._fetchHandle=null;e._cancelingQuery||console.error(e.declaredClass+" "+a.toString())})};d.mixin(b,this.fetchProperties);this.store._oldAPI?g=a:(g=this._patternToRegExp(a),g.toString=function(){return a});this._lastQuery=c[this.searchAttr]=g;this._queryDeferHandle=this.defer(l,this.searchDelay)},constructor:function(){this.query={};this.fetchProperties={}},postMixInProperties:function(){if(!this.store){var d=this.list;d&&(this.store=p.byId(d))}this.inherited(arguments)}})})},
"dijit/form/_ComboBoxMenu":function(){define("dojo/_base/declare dojo/dom-class dojo/dom-style dojo/keys ../_WidgetBase ../_TemplatedMixin ./_ComboBoxMenuMixin ./_ListMouseMixin".split(" "),function(r,l,d,q,k,m,p,h){return r("dijit.form._ComboBoxMenu",[k,m,h,p],{templateString:"\x3cdiv class\x3d'dijitReset dijitMenu' data-dojo-attach-point\x3d'containerNode' style\x3d'overflow: auto; overflow-x: hidden;' role\x3d'listbox'\x3e\x3cdiv class\x3d'dijitMenuItem dijitMenuPreviousButton' data-dojo-attach-point\x3d'previousButton' role\x3d'option'\x3e\x3c/div\x3e\x3cdiv class\x3d'dijitMenuItem dijitMenuNextButton' data-dojo-attach-point\x3d'nextButton' role\x3d'option'\x3e\x3c/div\x3e\x3c/div\x3e",
baseClass:"dijitComboBoxMenu",postCreate:function(){this.inherited(arguments);this.isLeftToRight()||(l.add(this.previousButton,"dijitMenuItemRtl"),l.add(this.nextButton,"dijitMenuItemRtl"));this.containerNode.setAttribute("role","listbox")},_createMenuItem:function(){var d=this.ownerDocument.createElement("div");d.className="dijitReset dijitMenuItem"+(this.isLeftToRight()?"":" dijitMenuItemRtl");d.setAttribute("role","option");return d},onHover:function(d){l.add(d,"dijitMenuItemHover")},onUnhover:function(d){l.remove(d,
"dijitMenuItemHover")},onSelect:function(d){l.add(d,"dijitMenuItemSelected")},onDeselect:function(d){l.remove(d,"dijitMenuItemSelected")},_page:function(e){var c=0,b=this.domNode.scrollTop,a=d.get(this.domNode,"height");for(this.getHighlightedOption()||this.selectNextNode();c<a;){var g=this.getHighlightedOption();if(e){if(!g.previousSibling||"none"==g.previousSibling.style.display)break;this.selectPreviousNode()}else{if(!g.nextSibling||"none"==g.nextSibling.style.display)break;this.selectNextNode()}g=
this.domNode.scrollTop;c+=(g-b)*(e?-1:1);b=g}},handleKey:function(d){switch(d.keyCode){case q.DOWN_ARROW:return this.selectNextNode(),!1;case q.PAGE_DOWN:return this._page(!1),!1;case q.UP_ARROW:return this.selectPreviousNode(),!1;case q.PAGE_UP:return this._page(!0),!1;default:return!0}}})})},"dijit/form/_ComboBoxMenuMixin":function(){define("dojo/_base/array dojo/_base/declare dojo/dom-attr dojo/has dojo/i18n dojo/i18n!./nls/ComboBox".split(" "),function(r,l,d,q,k){var m=l("dijit.form._ComboBoxMenuMixin"+
(q("dojo-bidi")?"_NoBidi":""),null,{_messages:null,postMixInProperties:function(){this.inherited(arguments);this._messages=k.getLocalization("dijit.form","ComboBox",this.lang)},buildRendering:function(){this.inherited(arguments);this.previousButton.innerHTML=this._messages.previousMessage;this.nextButton.innerHTML=this._messages.nextMessage},_setValueAttr:function(d){this._set("value",d);this.onChange(d)},onClick:function(d){if(d==this.previousButton)this._setSelectedAttr(null),this.onPage(-1);else if(d==
this.nextButton)this._setSelectedAttr(null),this.onPage(1);else this.onChange(d)},onChange:function(){},onPage:function(){},onClose:function(){this._setSelectedAttr(null)},_createOption:function(d,h){var e=this._createMenuItem(),c=h(d);c.html?e.innerHTML=c.label:e.appendChild(e.ownerDocument.createTextNode(c.label));""==e.innerHTML&&(e.innerHTML="\x26#160;");return e},createOptions:function(k,h,e){this.items=k;this.previousButton.style.display=0==h.start?"none":"";d.set(this.previousButton,"id",this.id+
"_prev");r.forEach(k,function(b,a){var c=this._createOption(b,e);c.setAttribute("item",a);d.set(c,"id",this.id+a);this.nextButton.parentNode.insertBefore(c,this.nextButton)},this);var c=!1;k.total&&!k.total.then&&-1!=k.total?h.start+h.count<k.total?c=!0:h.start+h.count>k.total&&h.count==k.length&&(c=!0):h.count==k.length&&(c=!0);this.nextButton.style.display=c?"":"none";d.set(this.nextButton,"id",this.id+"_next")},clearResultList:function(){for(var d=this.containerNode;2<d.childNodes.length;)d.removeChild(d.childNodes[d.childNodes.length-
2]);this._setSelectedAttr(null)},highlightFirstOption:function(){this.selectFirstNode()},highlightLastOption:function(){this.selectLastNode()},selectFirstNode:function(){this.inherited(arguments);this.getHighlightedOption()==this.previousButton&&this.selectNextNode()},selectLastNode:function(){this.inherited(arguments);this.getHighlightedOption()==this.nextButton&&this.selectPreviousNode()},getHighlightedOption:function(){return this.selected}});q("dojo-bidi")&&(m=l("dijit.form._ComboBoxMenuMixin",
m,{_createOption:function(){var d=this.inherited(arguments);this.applyTextDir(d);return d}}));return m})},"dijit/form/_ListMouseMixin":function(){define(["dojo/_base/declare","dojo/on","dojo/touch","./_ListBase"],function(r,l,d,q){return r("dijit.form._ListMouseMixin",q,{postCreate:function(){this.inherited(arguments);this.domNode.dojoClick=!0;this._listConnect("click","_onClick");this._listConnect("mousedown","_onMouseDown");this._listConnect("mouseup","_onMouseUp");this._listConnect("mouseover",
"_onMouseOver");this._listConnect("mouseout","_onMouseOut")},_onClick:function(d,l){this._setSelectedAttr(l,!1);this._deferredClick&&this._deferredClick.remove();this._deferredClick=this.defer(function(){this._deferredClick=null;this.onClick(l)})},_onMouseDown:function(d,l){this._hoveredNode&&(this.onUnhover(this._hoveredNode),this._hoveredNode=null);this._isDragging=!0;this._setSelectedAttr(l,!1)},_onMouseUp:function(d,l){this._isDragging=!1;var k=this.selected,h=this._hoveredNode;k&&l==k?this.defer(function(){this._onClick(d,
k)}):h&&this.defer(function(){this._onClick(d,h)})},_onMouseOut:function(d,l){this._hoveredNode&&(this.onUnhover(this._hoveredNode),this._hoveredNode=null);this._isDragging&&(this._cancelDrag=(new Date).getTime()+1E3)},_onMouseOver:function(d,l){this._cancelDrag&&((new Date).getTime()>this._cancelDrag&&(this._isDragging=!1),this._cancelDrag=null);this._hoveredNode=l;this.onHover(l);this._isDragging&&this._setSelectedAttr(l,!1)}})})},"dijit/form/_ListBase":function(){define(["dojo/_base/declare","dojo/on",
"dojo/window"],function(r,l,d){return r("dijit.form._ListBase",null,{selected:null,_listConnect:function(d,k){var m=this;return m.own(l(m.containerNode,l.selector(function(d,h,e){return d.parentNode==e},d),function(d){m[k](d,this)}))},selectFirstNode:function(){for(var d=this.containerNode.firstChild;d&&"none"==d.style.display;)d=d.nextSibling;this._setSelectedAttr(d,!0)},selectLastNode:function(){for(var d=this.containerNode.lastChild;d&&"none"==d.style.display;)d=d.previousSibling;this._setSelectedAttr(d,
!0)},selectNextNode:function(){var d=this.selected;if(d){for(d=d.nextSibling;d&&"none"==d.style.display;)d=d.nextSibling;d?this._setSelectedAttr(d,!0):this.selectFirstNode()}else this.selectFirstNode()},selectPreviousNode:function(){var d=this.selected;if(d){for(d=d.previousSibling;d&&"none"==d.style.display;)d=d.previousSibling;d?this._setSelectedAttr(d,!0):this.selectLastNode()}else this.selectLastNode()},_setSelectedAttr:function(l,k){if(this.selected!=l){var m=this.selected;if(m)this.onDeselect(m);
l&&(k&&d.scrollIntoView(l),this.onSelect(l));this._set("selected",l)}else if(l)this.onSelect(l)}})})},"jimu/dijit/_filter/NumberListValueProvider":function(){define("dojo/_base/lang dojo/_base/html dojo/_base/array dojo/_base/declare ./ValueProvider dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dojo/text!./NumberListValueProvider.html dijit/form/NumberTextBox dijit/form/Select".split(" "),function(r,l,d,q,k,m,p,h){return q([k,m,p],{templateString:h,postCreate:function(){this.inherited(arguments);
l.addClass(this.domNode,"jimu-number-list-filter-value-provider");this.rangeSelect.removeOption(this.rangeSelect.getOptions());d.forEach("dateOperatorMinutes dateOperatorHours dateOperatorDays dateOperatorWeeks dateOperatorMonths dateOperatorYears".split(" "),r.hitch(this,function(d){this.rangeSelect.addOption({value:d,label:this.nls[d]})}));this.rangeSelect.set("value","dateOperatorDays")},getDijits:function(){return[this._dijit1,this.rangeSelect]},setValueObject:function(d){this.isDefined(d.value)&&
this._dijit1.set("value",d.value);this.isDefined(d.range)&&this.rangeSelect.set("value",d.range)},getValueObject:function(){return this.isValidValue()?{isValid:!0,type:this.partObj.valueObj.type,value:parseFloat(this._dijit1.get("value")),range:this._getRangeByUI()}:null},_getRangeByUI:function(){var d=this.rangeSelect.get("value");"none"===d&&(d=null);return d},tryGetValueObject:function(){if(this.isValidValue())return this.getValueObject();if(this.isEmptyValue()){var d={isValid:!0,type:this.partObj.valueObj.type,
value:parseFloat(this._dijit1.get("value")),range:this._getRangeByUI()};isNaN(d.value)&&(d.value=null);return d}return null},setRequired:function(d){this._dijit1.set("required",d);this.rangeSelect.set("required",d)}})})},"jimu/dijit/_SingleFilter":function(){define("dojo/_base/declare dijit/_WidgetBase dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dojo/text!./templates/_SingleFilter.html dojo/_base/lang dojo/_base/html dojo/_base/array dojo/on dojo/store/Memory jimu/utils jimu/dijit/_filter/ValueProviderFactory jimu/dijit/CheckBox dijit/form/Select dijit/form/FilteringSelect dijit/form/ValidationTextBox".split(" "),
function(r,l,d,q,k,m,p,h,e,c,b,a){return r([l,d,q],{templateString:k,baseClass:"jimu-single-filter",declaredClass:"jimu.dijit._SingleFilter",nls:null,url:null,layerInfo:null,stringFieldType:"",dateFieldType:"",numberFieldTypes:[],supportFieldTypes:[],part:null,OPERATORS:null,enableAskForValues:!1,isHosted:!1,valueProviderFactory:null,valueProvider:null,postMixInProperties:function(){this.supportFieldTypes=[];this.supportFieldTypes.push(this.stringFieldType);this.supportFieldTypes.push(this.dateFieldType);
this.supportFieldTypes=this.supportFieldTypes.concat(this.numberFieldTypes);this.nls=window.jimuNls.filterBuilder},postCreate:function(){this.inherited(arguments);this._initSelf()},toJson:function(){var a={fieldObj:"",operator:"",valueObj:"",interactiveObj:"",caseSensitive:!1},b=this._getFieldObjByUI();if(!b)return null;a.fieldObj=b;b=this._getOperatorByUI();if(!b)return null;a.operator=b;a.caseSensitive=this.cbxCaseSensitive.getStatus()&&this.cbxCaseSensitive.getValue();if(b=this._isUseAskForValues()){if(!this.promptTB.validate())return this._showValidationErrorTip(this.promptTB),
null;a.interactiveObj={prompt:this.promptTB.get("value"),hint:this.hintTB.get("value"),cascade:"none"};this.uniqueRadio&&this.uniqueRadio.checked&&(a.interactiveObj.cascade=this.cascadeSelect.get("value"))}a.valueObj={isValid:!0,type:""};b=b?this.valueProvider.tryGetValueObject():this.valueProvider.getValueObject();if(!b)return null;this.valueRadio.checked?b.type="value":this.fieldRadio.checked?b.type="field":this.uniqueRadio.checked&&(b.type="unique");a.valueObj=b;return a},_getFieldObjByUI:function(){var a=
this._getSelectedFilteringItem(this.fieldsSelect);return a?{name:a.name,label:a.name,shortType:a.shortType,type:a.type}:null},_getOperatorByUI:function(){var a=this.operatorsSelect.get("value");"none"===a&&(a=null);return a},showDelteIcon:function(){p.setStyle(this.btnDelete,"display","inline-block")},hideDeleteIcon:function(){p.setStyle(this.btnDelete,"display","none")},_showAndEnableCaseSensitive:function(){this.cbxCaseSensitive.setStatus(!0);p.setStyle(this.cbxCaseSensitive.domNode,"display","inline-block")},
_hideAndDisableCaseSensitive:function(){this.cbxCaseSensitive.setStatus(!1);p.setStyle(this.cbxCaseSensitive.domNode,"display","none")},_initSelf:function(){this.layerInfo=m.mixin({},this.layerInfo);this.isHosted&&(this.cbxCaseSensitive.setValue(!1),this.cbxCaseSensitive.setStatus(!1),this.cbxCaseSensitive.domNode.title=this.nls.notSupportCaseSensitiveTip);this.own(e(this.fieldsSelect,"MouseEnter",m.hitch(this,this._updateFieldsSelectTitle)));this.own(e(this.operatorsSelect,"MouseEnter",m.hitch(this,
this._updateOperatorsSelectTitle)));this.enableAskForValues?(p.setStyle(this.cbxAskValues.domNode,"display","inline-block"),p.setStyle(this.promptSection,"display","block"),this.own(e(this.cbxAskValues,"status-change",m.hitch(this,this._onCbxAskValuesStatusChanged))),this.cbxAskValues.onChange=m.hitch(this,this._onCbxAskValuesClicked)):(p.setStyle(this.cbxAskValues.domNode,"display","none"),p.setStyle(this.promptSection,"display","none"));this._initValueTypeRadios();var a=this.layerInfo.fields;a&&
0<a.length&&(a=h.filter(a,m.hitch(this,function(a){return 0<=this.supportFieldTypes.indexOf(a.type)})),0<a.length&&(this._enableRadios(),this._initFieldsSelect(a),this.part?this._showPart(this.part):this._resetByFieldAndOperator(),setTimeout(m.hitch(this,function(){this._bindFieldsSelectChangeAndOperatorChangeEvents()}),10)))},_bindFieldsSelectChangeAndOperatorChangeEvents:function(){this._removeFieldsSelectChangeAndOperatorChangeEvents();this._handle1=e(this.fieldsSelect,"change",m.hitch(this,this._onFieldsSelectChange));
this._handle2=e(this.operatorsSelect,"change",m.hitch(this,this._onOperatorsSelectChange))},_removeFieldsSelectChangeAndOperatorChangeEvents:function(){this._handle1&&this._handle1.remove();this._handle2&&this._handle2.remove();this._handle2=this._handle1=null},_isServiceSupportDistinctValues:function(a,b){return this._isStreamServer(a)?!1:10.1<=parseFloat(b.currentVersion)},_isStreamServer:function(a){a=(a||"").replace(/\/*$/g,"");return/\/StreamServer$/gi.test(a)},_updateFieldsSelectTitle:function(){this.fieldsSelect.domNode.title=
"";var a=this._getSelectedFilteringItem(this.fieldsSelect);a&&(this.fieldsSelect.domNode.title=a.displayName||a.alias||a.name)},_updateOperatorsSelectTitle:function(){this.operatorsSelect.domNode.title="";var a=this.operatorsSelect.get("value");a&&(a=this.operatorsSelect.getOptions(a),this.operatorsSelect.domNode.title=a.label)},_showValidationErrorTip:function(a){try{!a.validate()&&a.domNode&&a.focusNode&&(a.focusNode.focus(),a.focusNode.blur())}catch(u){console.error(u)}},_getSelectedFilteringItem:function(a){if(a.validate()){var b=
a.get("item");if(b)return b}this._showValidationErrorTip(a);return null},_getShortTypeByFieldType:function(a){return a===this.stringFieldType?"string":a===this.dateFieldType?"date":0<=this.numberFieldTypes.indexOf(a)?"number":null},_initFieldsSelect:function(a){a=h.map(a,m.hitch(this,function(a,b){var c=m.mixin({},a);c.id=b;c.shortType=this._getShortTypeByFieldType(a.type);c.alias||(c.alias=c.name);var d="";"string"===c.shortType?d=this.nls.string:"number"===c.shortType?d=this.nls.number:"date"===
c.shortType&&(d=this.nls.date);c.displayName=c.alias+" ("+d+")";return c}));if(0<a.length){var b=new c({data:a});this.fieldsSelect.set("store",b);this.fieldsSelect.set("value",a[0].id)}this._updateOperatorsByFieldsSelect()},_showPart:function(a){if((this.part=a)&&this.part.fieldObj&&this.part.operator&&this.part.valueObj){this._removeFieldsSelectChangeAndOperatorChangeEvents();var b=this.part.fieldObj.name;a=this.part.operator;this.part.caseSensitive=!!this.part.caseSensitive;b=this.fieldsSelect.store.query({name:b});
0!==b.length&&(b=b[0])&&(this.fieldsSelect.set("value",b.id),this._updateOperatorsByFieldsSelect(),this.operatorsSelect.set("value",a),this._resetByFieldAndOperator(this.part),a=this.part.interactiveObj)&&(this.cbxAskValues.check(),this._updatePrompt(),this.promptTB.set("value",a.prompt||""),this.hintTB.set("value",a.hint||""),"unique"===this.part.valueObj.type?this.cascadeSelect.set("value",a.cascade):this.cascadeSelect.set("value","none"))}},_onFieldsSelectChange:function(){this._updateOperatorsByFieldsSelect();
this._resetByFieldAndOperator()},_updateOperatorsByFieldsSelect:function(){this._updateFieldsSelectTitle();this.operatorsSelect.removeOption(this.operatorsSelect.getOptions());this.operatorsSelect.addOption({value:"none",label:this.nls.none});var b=this._getSelectedFilteringItem(this.fieldsSelect);b&&(this.operatorsSelect.shortType=b.shortType,b=a.getOperatorsByShortType(b.shortType),this.operatorsSelect.removeOption(this.operatorsSelect.getOptions()),h.forEach(b,m.hitch(this,function(a){this.operatorsSelect.addOption({value:a,
label:this.nls[a]})})))},_onOperatorsSelectChange:function(){this._resetByFieldAndOperator()},_initValueTypeRadios:function(){var a="radio_"+b.getRandomString();this.valueRadio.name=a;this.fieldRadio.name=a;this.uniqueRadio.name=a;this.valueRadio.valueType="value";this.fieldRadio.valueType="field";this.uniqueRadio.valueType="unique";b.combineRadioCheckBoxWithLabel(this.valueRadio,this.valueLabel);b.combineRadioCheckBoxWithLabel(this.fieldRadio,this.fieldLabel);b.combineRadioCheckBoxWithLabel(this.uniqueRadio,
this.uniqueLabel);this.own(e(this.valueRadio,"click",m.hitch(this,function(){this._resetByFieldAndOperator(null,"value")})));this.own(e(this.fieldRadio,"click",m.hitch(this,function(){this._resetByFieldAndOperator(null,"field")})));this.own(e(this.uniqueRadio,"click",m.hitch(this,function(){this._resetByFieldAndOperator(null,"unique")})));this._isServiceSupportDistinctValues(this.url,this.layerInfo)||(this.uniqueTd.style.display="none")},_updateValueTypeClass:function(){p.removeClass(this.domNode,
"value-type");p.removeClass(this.domNode,"field-type");p.removeClass(this.domNode,"unique-type");p.removeClass(this.domNode,"support-cascade");if(this.valueRadio.checked)p.addClass(this.domNode,"value-type"),this.cascadeSelect.set("value","none");else if(this.fieldRadio.checked)p.addClass(this.domNode,"field-type"),this.cascadeSelect.set("value","none");else{p.addClass(this.domNode,"unique-type");this.cascadeSelect.set("value","previous");var a=!0,a=this._getSelectedFilteringItem(this.fieldsSelect),
a=this._getCodedValuesOrTypesCount(a);(a=0<a?b.isCodedValuesSupportFilter(this.layerInfo,a):!0)?(this.cascadeSelect.set("value","previous"),p.addClass(this.domNode,"support-cascade")):this.cascadeSelect.set("value","none")}},_getCodedValuesOrTypesCount:function(a){if(a){if(a.domain&&"codedValue"===a.domain.type&&a.domain.codedValues)return a.domain.codedValues.length;if(this.layerInfo.typeIdField===a.name&&this.layerInfo.types)return this.layerInfo.types.length}return 0},_enableRadios:function(){this.valueRadio.disabled=
!1;this.fieldRadio.disabled=!1;this.uniqueRadio.disabled=!1},_disableAndUncheckRadios:function(){this._enableRadios();this.valueRadio.checked=!1;this.fieldRadio.checked=!1;this.uniqueRadio.checked=!1;this.valueRadio.disabled=!0;this.fieldRadio.disabled=!0;this.uniqueRadio.disabled=!0},_resetByFieldAndOperator:function(b,c){this._updateOperatorsSelectTitle();this.valueProvider&&this.valueProvider.destroy();this._hideAndDisableCaseSensitive();this._disableAndUncheckRadios();b||(b={fieldObj:"",operator:"",
valueObj:"",interactiveObj:"",caseSensitive:!1},b.fieldObj=this._getFieldObjByUI(),b.operator=this._getOperatorByUI());var d=[],e=null;if(b.fieldObj&&b.operator){var d=this.valueProviderFactory.getSupportedValueTypes(b.fieldObj.name,b.operator),f=null;b.valueObj?e=b.valueObj.type:(e=c&&0<=d.indexOf(c)?c:d[0],b.valueObj={type:e});0<=d.indexOf("value")&&(this.valueRadio.disabled=!1);0<=d.indexOf("field")&&(this.fieldRadio.disabled=!1);0<=d.indexOf("unique")&&(this.uniqueRadio.disabled=!1);"value"===
e?f=this.valueRadio:"field"===e?f=this.fieldRadio:"unique"===e&&(f=this.uniqueRadio);f&&(f.disabled=!1,f.checked=!0)}0<d.length?(this.valueProvider=this.valueProviderFactory.getValueProvider(b,!1),this.valueProvider.placeAt(this.attributeValueContainer,"first"),this.valueProvider.setValueObject(b.valueObj),this.valueProvider.isBlankValueProvider()?(p.addClass(this.valueProvider.domNode,"hidden"),p.addClass(this.attributeValueContainer,"hidden")):p.removeClass(this.attributeValueContainer,"hidden"),
(d=a.getOperatorInfo(b.operator))&&e&&(d[e]&&d[e].supportCaseSensitive&&this._showAndEnableCaseSensitive(),b&&this.cbxCaseSensitive.setValue(b.caseSensitive))):p.addClass(this.attributeValueContainer,"hidden");this._updateWhenValueRadioChanged()},_updateWhenValueRadioChanged:function(){this._updatePrompt();this._updateValueTypeClass()},_getRadioByValueType:function(a){return"value"===a?this.valueRadio:"field"===a?this.fieldRadio:"unique"===a?this.uniqueRadio:null},_onCbxAskValuesClicked:function(){this._updateRequiredProperty();
this._updatePrompt()},_onCbxAskValuesStatusChanged:function(){this._updateRequiredProperty()},_isUseAskForValues:function(){return this.cbxAskValues.status&&this.cbxAskValues.checked},_isValueRequired:function(){return!this._isUseAskForValues()},_updateRequiredProperty:function(){var a=this._isValueRequired();this.valueProvider.setRequired(a)},_getValueTypeByUI:function(){return!this.valueRadio.disabled&&this.valueRadio.checked?"value":!this.fieldRadio.disabled&&this.fieldRadio.checked?"field":!this.uniqueRadio.disabled&&
this.uniqueRadio.checked?"unique":null},_updatePrompt:function(){this.promptTB.set("value","");this.hintTB.set("value","");this.cbxAskValues.setStatus(!0);p.setStyle(this.promptTable,"display","table");var b=this.operatorsSelect.get("value"),c=this.nls[b],d=!1,e=this._getValueTypeByUI(),f=a.getOperatorInfo(b);f&&e&&(e=f[e])&&e.supportAskForValue&&(d=!0);d||this.cbxAskValues.setStatus(!1);this.cbxAskValues.status&&this.cbxAskValues.checked?(p.setStyle(this.promptTable,"display","table"),(d=this._getSelectedFilteringItem(this.fieldsSelect))&&
"none"!==b&&this.promptTB.set("value",(d.alias||d.name)+" "+c)):p.setStyle(this.promptTable,"display","none")},_destroySelf:function(){this.destroy()},destroy:function(){this._removeFieldsSelectChangeAndOperatorChangeEvents();this.inherited(arguments)}})})},"jimu/dijit/_FilterSet":function(){define("dojo/_base/declare dijit/_WidgetBase dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dojo/text!./templates/_FilterSet.html dijit/registry dojo/_base/lang dojo/_base/html dojo/_base/array dojo/on dojo/aspect dojo/query ./_SingleFilter".split(" "),
function(r,l,d,q,k,m,p,h,e,c,b,a,g){return r([l,d,q],{templateString:k,baseClass:"jimu-filter-set",nls:null,url:null,layerInfo:null,stringFieldType:"",dateFieldType:"",numberFieldTypes:[],partsObj:null,OPERATORS:null,enableAskForValues:!1,isHosted:!1,valueProviderFactory:null,postMixInProperties:function(){this.nls=window.jimuNls.filterBuilder;var a=this.nls.matchMsgSet.split("${any_or_all}");this.nls.strMatchMsgPart1=a[0]||"";this.nls.strMatchMsgPart2=a[1]||"";this.inherited(arguments)},postCreate:function(){this.inherited(arguments);
this._initSelf()},toJson:function(){var b=a(".jimu-single-filter",this.allExpsBox),b=e.map(b,p.hitch(this,function(a){return m.byNode(a).toJson()}));return e.every(b,p.hitch(this,function(a){return!!a}))&&0<b.length?{logicalOperator:this.allAnySelect.value,parts:b}:null},showDelteIcon:function(){h.setStyle(this.btnDelete,"display","block")},hideDeleteIcon:function(){h.setStyle(this.btnDelete,"display","none")},_initSelf:function(){this.own(c(this.btnAdd,"click",p.hitch(this,this._addSingleFilter)));
if(this.partsObj){this.allAnySelect.value=this.partsObj.logicalOperator;var a=this.partsObj.parts||[];0===a.length?(this._addSingleFilter(),this._addSingleFilter()):1===a.length?(this._addSingleFilter(a[0]),this._addSingleFilter()):e.forEach(a,p.hitch(this,function(a){this._addSingleFilter(a)}))}else this._addSingleFilter(),this._addSingleFilter()},_addSingleFilter:function(a){a=new g({url:this.url,layerInfo:this.layerInfo,stringFieldType:this.stringFieldType,dateFieldType:this.dateFieldType,numberFieldTypes:this.numberFieldTypes,
part:a,OPERATORS:this.OPERATORS,enableAskForValues:this.enableAskForValues,isHosted:this.isHosted,valueProviderFactory:this.valueProviderFactory,style:{margin:"15px auto 0 auto",border:0,background:"inherit"}});a.placeAt(this.allExpsBox);a.startup();this.own(b.after(a,"_destroySelf",p.hitch(this,this._checkFilterNumbers)));this._checkFilterNumbers()},_checkFilterNumbers:function(){var b=a(".jimu-single-filter",this.allExpsBox),c=2<b.length;e.forEach(b,p.hitch(this,function(a){a=m.byNode(a);c?a.showDelteIcon():
a.hideDeleteIcon()}))},_destroySelf:function(){this.destroy()}})})},"builder/plugins/attribute-config/dataSource/DataFields":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/html dojo/_base/query dojo/on dijit/_WidgetBase dijit/_TemplatedMixin dojo/Evented dojo/text!./DataFields.html".split(" "),function(r,l,d,q,k,m,p,h,e,c){return r([p,e,h],{baseClass:"jimu-widget-chart-setting-data-fields",templateString:c,postCreate:function(){this.inherited(arguments);this.own(m(this.domNode,
"click",l.hitch(this,this._onDomClicked)))},clear:function(){q.empty(this.fieldsContent);this.emit("change")},setFields:function(b){this.clear();d.forEach(b,l.hitch(this,function(a){var b=q.toDom('\x3cdiv class\x3d"field-item"\x3e\x3cinput type\x3d"checkbox" /\x3e\x3cspan class\x3d"jimu-ellipsis" /\x3e\x3c/div\x3e'),c=k("input",b)[0],d=k("span",b)[0];c.checked=!!a.checked;c.disabled=!!a.disabled;d.innerHTML=a.alias||a.name;d.title=a.alias||a.name;b.fieldName=a.name;q.place(b,this.fieldsContent);this.own(m(c,
"change",l.hitch(this,function(){this.emit("change")})))}));this.emit("change")},selectFields:function(b){l.isArrayLike(b)&&(b=l.clone(b),b.reverse(),d.forEach(b,l.hitch(this,function(a){if(a=this._getFieldItemDivByName(a))q.place(a,a.parentNode,"first"),k("input",a)[0].checked=!0})));this.emit("change")},getSelectedFieldNames:function(){var b=k(".field-item",this.fieldsContent),a=[];d.forEach(b,l.hitch(this,function(b){k("input",b)[0].checked&&a.push(b.fieldName)}));return a},_getFieldItemDivByName:function(b){var a=
k(".field-item",this.fieldsContent);return d.filter(a,l.hitch(this,function(a){return a.fieldName===b}))[0]},_onDomClicked:function(b){b=b.target||b.srcElement;if(q.isDescendant(b,this.fieldsContent)&&b!==this.fieldsContent){var a=b.tagName.toLowerCase(),c=null;q.hasClass(b,"field-item")?this._selectFieldItemDom(b):"span"===a?(c=b.parentNode,this._selectFieldItemDom(c)):"input"===a&&(c=b.parentNode,b.checked?this._selectFieldItemDom(c):q.removeClass(c,"selected"));this._updateHighLightIcons()}},_updateHighLightIcons:function(){var b=
this._getSelectedFieldItemDiv();b&&q.hasClass(b,"selected")&&(b.previousSibling?q.addClass(this.btnUp,"high-light"):q.removeClass(this.btnUp,"high-light"),b.nextSibling?q.addClass(this.btnDown,"high-light"):q.removeClass(this.btnDown,"high-light"))},_selectFieldItemDom:function(b){k(".field-item",this.fieldsContent).removeClass("selected");q.addClass(b,"selected")},_getSelectedFieldItemDiv:function(){var b=null,a=k(".field-item.selected",this.fieldsContent);0<a.length&&(b=a[0]);return b},_moveUp:function(){var b=
this._getSelectedFieldItemDiv();b&&b.previousSibling&&q.place(b,b.previousSibling,"before");this._updateHighLightIcons()},_moveDown:function(){var b=this._getSelectedFieldItemDiv();b&&b.nextSibling&&q.place(b,b.nextSibling,"after");this._updateHighLightIcons()}})})},"builder/plugins/attribute-config/dataSource/utils":function(){define(["jimu/utils"],function(r){return{createDataSourceId:function(l,d){var q="";return q="map"===l&&d?"map~"+d+"~"+r.getRandomString():"external~"+r.getRandomString()}}})},
"jimu/dijit/DataPreviewTable":function(){define("dojo/_base/declare dojo/_base/html dijit/_WidgetBase dojo/_base/lang dojo/_base/array jimu/utils dgrid/OnDemandGrid dgrid/extensions/ColumnResizer dgrid/extensions/ColumnReorder".split(" "),function(r,l,d,q,k,m,p,h,e){return r([d],{declaredClass:"jimu.dijit.DataPreviewTable",baseClass:"jimu-data-preview-table",featureSet:null,loadingIndicator:null,_AUTO_WIDTH_COLS:6,postCreate:function(){this.inherited(arguments);m.loadStyleLink("dgrid",apiUrl+"dgrid/css/dgrid.css");
this.tableContainer=l.create("div",{"class":"table-container"},this.domNode);this.height&&l.style(this.tableContainer,"height",this.height-80+"px");var c=this._getColumns();this.grid=new (r([p,h,e]))({columns:c},this.tableContainer);c=this._getData();this.grid.renderArray(c)},_getColumns:function(){var c="auto";this.featureSet.fields&&this.featureSet.fields.length&&this.featureSet.fields.length>this._AUTO_WIDTH_COLS&&(c=120);var b={};k.forEach(this.featureSet.fields,function(a){b[a.name]={label:a.alias,
width:c}});return b},_getData:function(){var c=[];k.forEach(this.featureSet.features,function(b,a){var d={};k.forEach(this.featureSet.fields,function(a){d[a.name]=b.attributes[a.name]},this);c.push(q.clone(q.mixin({id:a+1},d)))},this);return c}})})},"dgrid/extensions/ColumnResizer":function(){define("dojo/_base/declare dojo/on dojo/query dojo/_base/lang dojo/dom dojo/dom-geometry dojo/has ../util/misc put-selector/put dojo/_base/html xstyle/css!../css/extensions/ColumnResizer.css".split(" "),function(r,
l,d,q,k,m,p,h,e){function c(a){for(var b=a.length,c=b,d=a[0].length,e=Array(b);b--;)e[b]=Array(d);for(var g={},b=0;b<c;b++)for(var h=e[b],k=a[b],l=0,n=0;l<d;l++){var m=k[n],p;if("undefined"==typeof h[l]){h[l]=m.id;if(m.rowSpan&&1<m.rowSpan){p=e;for(var q=m.rowSpan,r=b,u=l,J=m.id,N=1;N<q;N++)p[r+N][u]=J}if(0<b&&m.colSpan&&1<m.colSpan)for(p=1;p<m.colSpan;p++)if(h[++l]=m.id,m.rowSpan&&1<m.rowSpan)for(var q=e,r=m.rowSpan,u=b,J=l,N=m.id,M=1;M<r;M++)q[u+M][J]=N;g[m.id]=a[0][l].id;n++}}return g}function b(a,
b,c,d,e){if(!(0>=c)){var f=a.columns[b],g;if(f&&(g={grid:a,columnId:b,width:c,bubbles:!0,cancelable:!0},d&&(g.parentType=d),!a._resizedColumns||l.emit(a.headerNode,"dgrid-columnresize",g)))return"auto"===c?delete f.width:(f.width=c,c+="px"),(d=a._columnSizes[b])?d.set("width",c):d=h.addCssRule("#"+h.escapeCssIdentifier(a.domNode.id)+" .dgrid-column-"+h.escapeCssIdentifier(b,"-"),"width: "+c+";"),a._columnSizes[b]=d,!1!==e&&a.resize(),!0}}var a,g=0,u={create:function(){a=e("div.dgrid-column-resizer")},
destroy:function(){e(a,"!");a=null},show:function(b){b=m.position(b.domNode,!0);a.style.top=b.y+"px";a.style.height=b.h+"px";e(document.body,a)},move:function(b){a.style.left=b+"px"},hide:function(){a.parentNode.removeChild(a)}};return r("dgrid.extensions.ColumnResizer",null,{resizeNode:null,minWidth:40,adjustLastColumn:!0,_resizedColumns:!1,buildRendering:function(){this.inherited(arguments);g++||u.create()},destroy:function(){this.inherited(arguments);for(var a in this._columnSizes)this._columnSizes[a].remove();
--g||u.destroy()},resizeColumnWidth:function(a,c){return b(this,a,c)},configStructure:function(){var a=this._oldColumnSizes=q.mixin({},this._columnSizes),b;this._resizedColumns=!1;this._columnSizes={};this.inherited(arguments);for(b in a)b in this._columnSizes||a[b].remove();delete this._oldColumnSizes},_configColumn:function(a){this.inherited(arguments);var b=a.id,c;"width"in a&&((c=this._oldColumnSizes[b])?c.set("width",a.width+"px"):c=h.addCssRule("#"+h.escapeCssIdentifier(this.domNode.id)+" .dgrid-column-"+
h.escapeCssIdentifier(b,"-"),"width: "+a.width+"px;"),this._columnSizes[b]=c)},renderHeader:function(){this.inherited(arguments);var a=this,b;if(this.columnSets&&this.columnSets.length)for(var f=this.columnSets.length;f--;)b=q.mixin(b||{},c(this.columnSets[f]));else this.subRows&&1<this.subRows.length&&(b=c(this.subRows));for(var f=d(".dgrid-cell",a.headerNode),g=f.length;g--;){var k=f[g],m=k.columnId,r=a.columns[m],u=k.childNodes;if(r&&!1!==r.resizable){r=e("div.dgrid-resize-header-container");for(k.contents=
r;0<u.length;)e(r,u[0]);e(k,r,"div.dgrid-resize-handle.resizeNode-"+h.escapeCssIdentifier(m,"-")).columnId=b&&b[m]||m}}a.mouseMoveListen||(l(a.headerNode,".dgrid-resize-handle:mousedown"+(p("touch")?",.dgrid-resize-handle:touchstart":""),function(b){a._resizeMouseDown(b,this);a.mouseMoveListen.resume();a.mouseUpListen.resume()}),a._listeners.push(a.mouseMoveListen=l.pausable(document,"mousemove"+(p("touch")?",touchmove":""),h.throttleDelayed(function(b){a._updateResizerPosition(b)}))),a._listeners.push(a.mouseUpListen=
l.pausable(document,"mouseup"+(p("touch")?",touchend":""),function(b){a._resizeMouseUp(b);a.mouseMoveListen.pause();a.mouseUpListen.pause()})),a.mouseMoveListen.pause(),a.mouseUpListen.pause())},_resizeMouseDown:function(a,b){a.preventDefault();k.setSelectable(this.domNode,!1);this._startX=this._getResizeMouseLocation(a);this._targetCell=d(".dgrid-column-"+h.escapeCssIdentifier(b.columnId,"-"),this.headerNode)[0];this._updateResizerPosition(a);u.show(this)},_resizeMouseUp:function(a){var c=this._columnSizes,
e,g,l;this.adjustLastColumn&&(l=this.headerNode.clientWidth-1);this._resizedColumns||(e=d(".dgrid-cell",this.headerNode),this.columnSets&&this.columnSets.length?e=e.filter(function(a){return"0"==a.columnId.split("-")[0]&&!(a.columnId in c)}):this.subRows&&1<this.subRows.length&&(e=e.filter(function(a){return"0"==a.columnId.charAt(0)&&!(a.columnId in c)})),g=e.map(function(a){return a.offsetWidth}),e.forEach(function(a,c){b(this,a.columnId,g[c],null,!1)},this),this._resizedColumns=!0);k.setSelectable(this.domNode,
!0);e=this._targetCell;var n=this._getResizeMouseLocation(a)-this._startX,m=e.offsetWidth+n,p=this._getResizedColumnWidths(),q=p.totalWidth,p=p.lastColId,r=d(".dgrid-column-"+h.escapeCssIdentifier(p,"-"),this.headerNode)[0].offsetWidth;m<this.minWidth&&(m=this.minWidth);b(this,e.columnId,m,a.type)&&e.columnId!=p&&this.adjustLastColumn&&(q+n<l?b(this,p,"auto",a.type):r-n<=this.minWidth&&b(this,p,this.minWidth,a.type));u.hide();delete this._startX;delete this._targetCell},_updateResizerPosition:function(a){if(this._targetCell){a=
this._getResizeMouseLocation(a);var b=this._targetCell.offsetWidth,c=a;b+(a-this._startX)<this.minWidth&&(c=this._startX-(b-this.minWidth));u.move(c)}},_getResizeMouseLocation:function(a){var b=0;a.pageX?b=a.pageX:a.clientX&&(b=a.clientX+document.body.scrollLeft+document.documentElement.scrollLeft);return b},_getResizedColumnWidths:function(){var a=0,b=d((this.columnSets?".dgrid-column-set-cell ":"")+"tr:first-child .dgrid-cell",this.headerNode),c=b.length;if(!c)return{};for(var e=b[c-1].columnId;c--;)a+=
b[c].offsetWidth;return{totalWidth:a,lastColId:e}}})})},"dgrid/extensions/ColumnReorder":function(){define("dojo/_base/lang dojo/_base/declare dojo/_base/array dojo/on dojo/query dojo/dnd/Source put-selector/put xstyle/css!../css/extensions/ColumnReorder.css".split(" "),function(r,l,d,q,k,m,p){function h(a,b){var c=b[2],d=a[c?"columnSets":"subRows"][b[1]];return c?d[b[2]]:d}function e(a,b,c){b[2]?a.columnSets[b[1]][b[2]]=c:a.subRows[b[1]]=c}function c(a,b){return b.slice(("dgrid-"+a+"-").length)}
var b=/(\d+)(?:-(\d+))?$/;r=l(m,{copyState:function(){return!1},checkAcceptance:function(a,b){return a==this},_legalMouseDown:function(a){return-1<a.target.className.indexOf("dgrid-resize-handle")?!1:this.inherited(arguments)},onDropInternal:function(a){var g=this.grid,k=b.exec(c(g.id,a[0].getAttribute("dndType"))),l=k[2]?"columnSets":"subRows",m=h(g,k),f=g.columns;this.inherited(arguments);k&&setTimeout(function(){var b=d.map(a[0].parentNode.childNodes,function(a){return f[a.columnId]});e(g,k,b);
b={grid:g,subRow:b,column:f[a[0].columnId],bubbles:!0,cancelable:!0,parentType:"dnd"};b[l]=g[l];q.emit(g.domNode,"dgrid-columnreorder",b)?g.set(l,g[l]):(e(g,k,m),g.renderHeader(),this._sort&&this._sort.length&&this.updateSortArrow(this._sort))},0)}});l=l("dgrid.extensions.ColumnReorder",null,{columnDndConstructor:r,_initSubRowDnd:function(a,b){var c,d,e,f;d=0;for(e=a.length;d<e;d++)f=a[d],!1!==f.reorderable&&(f=f.headerNode,"TH"!=f.tagName&&(f=f.parentNode),p(f,".dojoDndItem[dndType\x3d"+b+"]"),c||
(c=f.parentNode));c&&this._columnDndSources.push(new this.columnDndConstructor(c,{horizontal:!0,grid:this}))},renderHeader:function(){var a="dgrid-"+this.id+"-",b,c;this.inherited(arguments);this._columnDndSources=[];if(this.columnSets)for(c=0,b=this.columnSets.length;c<b;c++)d.forEach(this.columnSets[c],function(b,d){this._initSubRowDnd(b,a+c+"-"+d)},this);else d.forEach(this.subRows,function(b,c){this._initSubRowDnd(b,a+c)},this)},_destroyColumns:function(){this._columnDndSources&&d.forEach(this._columnDndSources,
function(a){a.destroy()});this.inherited(arguments)}});l.ColumnDndSource=r;return l})},"dojo/dnd/Source":function(){define("../_base/array ../_base/declare ../_base/kernel ../_base/lang ../dom-class ../dom-geometry ../mouse ../ready ../topic ./common ./Selector ./Manager".split(" "),function(r,l,d,q,k,m,p,h,e,c,b,a){d.isAsync||h(0,function(){require(["dojo/dnd/AutoSource","dojo/dnd/Target"])});var g=l("dojo.dnd.Source",b,{isSource:!0,horizontal:!1,copyOnly:!1,selfCopy:!1,selfAccept:!0,skipForm:!1,
withHandles:!1,autoSync:!1,delay:0,accept:["text"],generateText:!0,constructor:function(a,b){q.mixin(this,q.mixin({},b));var c=this.accept;if(c.length){this.accept={};for(var d=0;d<c.length;++d)this.accept[c[d]]=1}this.mouseDown=this.isDragging=!1;this.targetBox=this.targetAnchor=null;this.before=!0;this._lastY=this._lastX=0;this.sourceState="";this.isSource&&k.add(this.node,"dojoDndSource");this.targetState="";this.accept&&k.add(this.node,"dojoDndTarget");this.horizontal&&k.add(this.node,"dojoDndHorizontal");
this.topics=[e.subscribe("/dnd/source/over",q.hitch(this,"onDndSourceOver")),e.subscribe("/dnd/start",q.hitch(this,"onDndStart")),e.subscribe("/dnd/drop",q.hitch(this,"onDndDrop")),e.subscribe("/dnd/cancel",q.hitch(this,"onDndCancel"))]},checkAcceptance:function(a,b){if(this==a)return!this.copyOnly||this.selfAccept;for(var c=0;c<b.length;++c){for(var d=a.getItem(b[c].id).type,e=!1,g=0;g<d.length;++g)if(d[g]in this.accept){e=!0;break}if(!e)return!1}return!0},copyState:function(b,c){if(b)return!0;2>
arguments.length&&(c=this==a.manager().target);if(c){if(this.copyOnly)return this.selfCopy}else return this.copyOnly;return!1},destroy:function(){g.superclass.destroy.call(this);r.forEach(this.topics,function(a){a.remove()});this.targetAnchor=null},onMouseMove:function(b){if(!this.isDragging||"Disabled"!=this.targetState){g.superclass.onMouseMove.call(this,b);var d=a.manager();if(!this.isDragging&&this.mouseDown&&this.isSource&&(Math.abs(b.pageX-this._lastX)>this.delay||Math.abs(b.pageY-this._lastY)>
this.delay)){var e=this.getSelectedNodes();e.length&&d.startDrag(this,e,this.copyState(c.getCopyKeyState(b),!0))}this.isDragging&&(e=!1,this.current&&(this.targetBox&&this.targetAnchor==this.current||(this.targetBox=m.position(this.current,!0)),e=this.horizontal?b.pageX-this.targetBox.x<this.targetBox.w/2==m.isBodyLtr(this.current.ownerDocument):b.pageY-this.targetBox.y<this.targetBox.h/2),this.current!=this.targetAnchor||e!=this.before)&&(this._markTargetAnchor(e),d.canDrop(!this.current||d.source!=
this||!(this.current.id in this.selection)))}},onMouseDown:function(a){this.mouseDown||!this._legalMouseDown(a)||this.skipForm&&c.isFormElement(a)||(this.mouseDown=!0,this._lastX=a.pageX,this._lastY=a.pageY,g.superclass.onMouseDown.call(this,a))},onMouseUp:function(a){this.mouseDown&&(this.mouseDown=!1,g.superclass.onMouseUp.call(this,a))},onDndSourceOver:function(b){this!==b?(this.mouseDown=!1,this.targetAnchor&&this._unmarkTargetAnchor()):this.isDragging&&(b=a.manager(),b.canDrop("Disabled"!=this.targetState&&
(!this.current||b.source!=this||!(this.current.id in this.selection))))},onDndStart:function(b,c,d){this.autoSync&&this.sync();this.isSource&&this._changeState("Source",this==b?d?"Copied":"Moved":"");c=this.accept&&this.checkAcceptance(b,c);this._changeState("Target",c?"":"Disabled");this==b&&a.manager().overSource(this);this.isDragging=!0},onDndDrop:function(a,b,c,d){if(this==d)this.onDrop(a,b,c);this.onDndCancel()},onDndCancel:function(){this.targetAnchor&&(this._unmarkTargetAnchor(),this.targetAnchor=
null);this.before=!0;this.mouseDown=this.isDragging=!1;this._changeState("Source","");this._changeState("Target","")},onDrop:function(a,b,c){if(this!=a)this.onDropExternal(a,b,c);else this.onDropInternal(b,c)},onDropExternal:function(a,b,d){var e=this._normalizedCreator;this._normalizedCreator=this.creator?function(b,c){return e.call(this,a.getItem(b.id).data,c)}:d?function(b){var d=a.getItem(b.id);b=b.cloneNode(!0);b.id=c.getUniqueId();return{node:b,data:d.data,type:d.type}}:function(b){var c=a.getItem(b.id);
a.delItem(b.id);return{node:b,data:c.data,type:c.type}};this.selectNone();d||this.creator||a.selectNone();this.insertNodes(!0,b,this.before,this.current);!d&&this.creator&&a.deleteSelectedNodes();this._normalizedCreator=e},onDropInternal:function(a,b){var d=this._normalizedCreator;if(!(this.current&&this.current.id in this.selection)){if(b)this._normalizedCreator=this.creator?function(a,b){return d.call(this,this.getItem(a.id).data,b)}:function(a){var b=this.getItem(a.id);a=a.cloneNode(!0);a.id=c.getUniqueId();
return{node:a,data:b.data,type:b.type}};else{if(!this.current)return;this._normalizedCreator=function(a){var b=this.getItem(a.id);return{node:a,data:b.data,type:b.type}}}this._removeSelection();this.insertNodes(!0,a,this.before,this.current);this._normalizedCreator=d}},onDraggingOver:function(){},onDraggingOut:function(){},onOverEvent:function(){g.superclass.onOverEvent.call(this);a.manager().overSource(this);if(this.isDragging&&"Disabled"!=this.targetState)this.onDraggingOver()},onOutEvent:function(){g.superclass.onOutEvent.call(this);
a.manager().outSource(this);if(this.isDragging&&"Disabled"!=this.targetState)this.onDraggingOut()},_markTargetAnchor:function(a){if(this.current!=this.targetAnchor||this.before!=a)this.targetAnchor&&this._removeItemClass(this.targetAnchor,this.before?"Before":"After"),this.targetAnchor=this.current,this.targetBox=null,this.before=a,this.targetAnchor&&this._addItemClass(this.targetAnchor,this.before?"Before":"After")},_unmarkTargetAnchor:function(){this.targetAnchor&&(this._removeItemClass(this.targetAnchor,
this.before?"Before":"After"),this.targetBox=this.targetAnchor=null,this.before=!0)},_markDndStatus:function(a){this._changeState("Source",a?"Copied":"Moved")},_legalMouseDown:function(a){if("touchstart"!=a.type&&!p.isLeft(a))return!1;if(!this.withHandles)return!0;for(a=a.target;a&&a!==this.node;a=a.parentNode){if(k.contains(a,"dojoDndHandle"))return!0;if(k.contains(a,"dojoDndItem")||k.contains(a,"dojoDndIgnore"))break}return!1}});return g})},"dojo/dnd/Selector":function(){define("../_base/array ../_base/declare ../_base/kernel ../_base/lang ../dom ../dom-construct ../mouse ../_base/NodeList ../on ../touch ./common ./Container".split(" "),
function(r,l,d,q,k,m,p,h,e,c,b,a){var g=l("dojo.dnd.Selector",a,{constructor:function(a,b){b||(b={});this.singular=b.singular;this.autoSync=b.autoSync;this.selection={};this.anchor=null;this.simpleSelection=!1;this.events.push(e(this.node,c.press,q.hitch(this,"onMouseDown")),e(this.node,c.release,q.hitch(this,"onMouseUp")))},singular:!1,getSelectedNodes:function(){var a=new h,c=b._empty,d;for(d in this.selection)d in c||a.push(k.byId(d));return a},selectNone:function(){return this._removeSelection()._removeAnchor()},
selectAll:function(){this.forInItems(function(a,b){this._addItemClass(k.byId(b),"Selected");this.selection[b]=1},this);return this._removeAnchor()},deleteSelectedNodes:function(){var a=b._empty,c;for(c in this.selection)if(!(c in a)){var d=k.byId(c);this.delItem(c);m.destroy(d)}this.anchor=null;this.selection={};return this},forInSelectedItems:function(a,c){c=c||d.global;var e=this.selection,f=b._empty,g;for(g in e)g in f||a.call(c,this.getItem(g),g,this)},sync:function(){g.superclass.sync.call(this);
this.anchor&&!this.getItem(this.anchor.id)&&(this.anchor=null);var a=[],c=b._empty,d;for(d in this.selection)d in c||this.getItem(d)||a.push(d);r.forEach(a,function(a){delete this.selection[a]},this);return this},insertNodes:function(a,b,c,d){var e=this._normalizedCreator;this._normalizedCreator=function(b,c){var d=e.call(this,b,c);a?(this.anchor?this.anchor!=d.node&&(this._removeItemClass(d.node,"Anchor"),this._addItemClass(d.node,"Selected")):(this.anchor=d.node,this._removeItemClass(d.node,"Selected"),
this._addItemClass(this.anchor,"Anchor")),this.selection[d.node.id]=1):(this._removeItemClass(d.node,"Selected"),this._removeItemClass(d.node,"Anchor"));return d};g.superclass.insertNodes.call(this,b,c,d);this._normalizedCreator=e;return this},destroy:function(){g.superclass.destroy.call(this);this.selection=this.anchor=null},onMouseDown:function(a){this.autoSync&&this.sync();if(this.current)if(!this.singular&&!b.getCopyKeyState(a)&&!a.shiftKey&&this.current.id in this.selection)this.simpleSelection=
!0,p.isLeft(a)&&(a.stopPropagation(),a.preventDefault());else{if(!this.singular&&a.shiftKey){b.getCopyKeyState(a)||this._removeSelection();var c=this.getAllNodes();if(c.length&&(this.anchor||(this.anchor=c[0],this._addItemClass(this.anchor,"Anchor")),this.selection[this.anchor.id]=1,this.anchor!=this.current)){for(var d=0,e;d<c.length&&(e=c[d],e!=this.anchor&&e!=this.current);++d);for(++d;d<c.length;++d){e=c[d];if(e==this.anchor||e==this.current)break;this._addItemClass(e,"Selected");this.selection[e.id]=
1}this._addItemClass(this.current,"Selected");this.selection[this.current.id]=1}}else this.singular?this.anchor==this.current?b.getCopyKeyState(a)&&this.selectNone():(this.selectNone(),this.anchor=this.current,this._addItemClass(this.anchor,"Anchor"),this.selection[this.current.id]=1):b.getCopyKeyState(a)?this.anchor==this.current?(delete this.selection[this.anchor.id],this._removeAnchor()):this.current.id in this.selection?(this._removeItemClass(this.current,"Selected"),delete this.selection[this.current.id]):
(this.anchor&&(this._removeItemClass(this.anchor,"Anchor"),this._addItemClass(this.anchor,"Selected")),this.anchor=this.current,this._addItemClass(this.current,"Anchor"),this.selection[this.current.id]=1):this.current.id in this.selection||(this.selectNone(),this.anchor=this.current,this._addItemClass(this.current,"Anchor"),this.selection[this.current.id]=1);a.stopPropagation();a.preventDefault()}},onMouseUp:function(){this.simpleSelection&&(this.simpleSelection=!1,this.selectNone(),this.current&&
(this.anchor=this.current,this._addItemClass(this.anchor,"Anchor"),this.selection[this.current.id]=1))},onMouseMove:function(){this.simpleSelection=!1},onOverEvent:function(){this.onmousemoveEvent=e(this.node,c.move,q.hitch(this,"onMouseMove"))},onOutEvent:function(){this.onmousemoveEvent&&(this.onmousemoveEvent.remove(),delete this.onmousemoveEvent)},_removeSelection:function(){var a=b._empty,c;for(c in this.selection)if(!(c in a)){var d=k.byId(c);d&&this._removeItemClass(d,"Selected")}this.selection=
{};return this},_removeAnchor:function(){this.anchor&&(this._removeItemClass(this.anchor,"Anchor"),this.anchor=null);return this}});return g})},"dojo/dnd/Container":function(){define("../_base/array ../_base/declare ../_base/kernel ../_base/lang ../_base/window ../dom ../dom-class ../dom-construct ../Evented ../has ../on ../query ../touch ./common".split(" "),function(r,l,d,q,k,m,p,h,e,c,b,a,g,u){l=l("dojo.dnd.Container",e,{skipForm:!1,allowNested:!1,constructor:function(a,c){this.node=m.byId(a);
c||(c={});this.creator=c.creator||null;this.skipForm=c.skipForm;this.parent=c.dropParent&&m.byId(c.dropParent);this.map={};this.current=null;this.containerState="";p.add(this.node,"dojoDndContainer");c&&c._skipStartup||this.startup();this.events=[b(this.node,g.over,q.hitch(this,"onMouseOver")),b(this.node,g.out,q.hitch(this,"onMouseOut")),b(this.node,"dragstart",q.hitch(this,"onSelectStart")),b(this.node,"selectstart",q.hitch(this,"onSelectStart"))]},creator:function(){},getItem:function(a){return this.map[a]},
setItem:function(a,b){this.map[a]=b},delItem:function(a){delete this.map[a]},forInItems:function(a,b){b=b||d.global;var c=this.map,e=u._empty,g;for(g in c)g in e||a.call(b,c[g],g,this);return b},clearItems:function(){this.map={}},getAllNodes:function(){return a((this.allowNested?"":"\x3e ")+".dojoDndItem",this.parent)},sync:function(){var a={};this.getAllNodes().forEach(function(b){if(b.id){var c=this.getItem(b.id);if(c){a[b.id]=c;return}}else b.id=u.getUniqueId();var c=b.getAttribute("dndType"),
d=b.getAttribute("dndData");a[b.id]={data:d||b.innerHTML,type:c?c.split(/\s*,\s*/):["text"]}},this);this.map=a;return this},insertNodes:function(a,b,c){this.parent.firstChild?b?c||(c=this.parent.firstChild):c&&(c=c.nextSibling):c=null;var d;if(c)for(b=0;b<a.length;++b)d=this._normalizedCreator(a[b]),this.setItem(d.node.id,{data:d.data,type:d.type}),c.parentNode.insertBefore(d.node,c);else for(b=0;b<a.length;++b)d=this._normalizedCreator(a[b]),this.setItem(d.node.id,{data:d.data,type:d.type}),this.parent.appendChild(d.node);
return this},destroy:function(){r.forEach(this.events,function(a){a.remove()});this.clearItems();this.node=this.parent=this.current=null},markupFactory:function(a,b,c){a._skipStartup=!0;return new c(b,a)},startup:function(){if(!this.parent&&(this.parent=this.node,"table"==this.parent.tagName.toLowerCase())){var a=this.parent.getElementsByTagName("tbody");a&&a.length&&(this.parent=a[0])}this.defaultCreator=u._defaultCreator(this.parent);this.sync()},onMouseOver:function(a){for(var b=a.relatedTarget;b&&
b!=this.node;)try{b=b.parentNode}catch(f){b=null}b||(this._changeState("Container","Over"),this.onOverEvent());b=this._getChildByEvent(a);this.current!=b&&(this.current&&this._removeItemClass(this.current,"Over"),b&&this._addItemClass(b,"Over"),this.current=b)},onMouseOut:function(a){for(a=a.relatedTarget;a;){if(a==this.node)return;try{a=a.parentNode}catch(t){a=null}}this.current&&(this._removeItemClass(this.current,"Over"),this.current=null);this._changeState("Container","");this.onOutEvent()},onSelectStart:function(a){this.skipForm&&
u.isFormElement(a)||(a.stopPropagation(),a.preventDefault())},onOverEvent:function(){},onOutEvent:function(){},_changeState:function(a,b){var c="dojoDnd"+a,d=a.toLowerCase()+"State";p.replace(this.node,c+b,c+this[d]);this[d]=b},_addItemClass:function(a,b){p.add(a,"dojoDndItem"+b)},_removeItemClass:function(a,b){p.remove(a,"dojoDndItem"+b)},_getChildByEvent:function(a){if(a=a.target)for(var b=a.parentNode;b;a=b,b=a.parentNode)if((b==this.parent||this.allowNested)&&p.contains(a,"dojoDndItem"))return a;
return null},_normalizedCreator:function(a,b){var c=(this.creator||this.defaultCreator).call(this,a,b);q.isArray(c.type)||(c.type=["text"]);c.node.id||(c.node.id=u.getUniqueId());p.add(c.node,"dojoDndItem");return c}});u._createNode=function(a){return a?function(b){return h.create(a,{innerHTML:b})}:u._createSpan};u._createTrTd=function(a){var b=h.create("tr");h.create("td",{innerHTML:a},b);return b};u._createSpan=function(a){return h.create("span",{innerHTML:a})};u._defaultCreatorNodes={ul:"li",ol:"li",
div:"div",p:"div"};u._defaultCreator=function(a){a=a.tagName.toLowerCase();var b="tbody"==a||"thead"==a?u._createTrTd:u._createNode(u._defaultCreatorNodes[a]);return function(a,c){var d=a&&q.isObject(a),e,f;d&&a.tagName&&a.nodeType&&a.getAttribute?(e=a.getAttribute("dndData")||a.innerHTML,d=(d=a.getAttribute("dndType"))?d.split(/\s*,\s*/):["text"],f=a):(e=d&&a.data?a.data:a,d=d&&a.type?a.type:["text"],f=("avatar"==c?u._createSpan:b)(String(e)));f.id||(f.id=u.getUniqueId());return{node:f,data:e,type:d}}};
return l})},"dojo/dnd/Manager":function(){define("../_base/array ../_base/declare ../_base/lang ../_base/window ../dom-class ../Evented ../has ../keys ../on ../topic ../touch ./common ./autoscroll ./Avatar".split(" "),function(r,l,d,q,k,m,p,h,e,c,b,a,g,u){var n=l("dojo.dnd.Manager",[m],{constructor:function(){this.source=this.avatar=null;this.nodes=[];this.copy=!0;this.target=null;this.canDropFlag=!1;this.events=[]},OFFSET_X:p("touch")?4:16,OFFSET_Y:p("touch")?4:16,overSource:function(a){this.avatar&&
(this.target=a&&"Disabled"!=a.targetState?a:null,this.canDropFlag=!!this.target,this.avatar.update());c.publish("/dnd/source/over",a)},outSource:function(a){this.avatar?this.target==a&&(this.target=null,this.canDropFlag=!1,this.avatar.update(),c.publish("/dnd/source/over",null)):c.publish("/dnd/source/over",null)},startDrag:function(a,f,h){function l(a){a.preventDefault();a.stopPropagation()}g.autoScrollStart(q.doc);this.source=a;this.nodes=f;this.copy=!!h;this.avatar=this.makeAvatar();q.body().appendChild(this.avatar.node);
c.publish("/dnd/start",a,f,this.copy);this.events=[e(q.doc,b.move,d.hitch(this,"onMouseMove")),e(q.doc,b.release,d.hitch(this,"onMouseUp")),e(q.doc,"keydown",d.hitch(this,"onKeyDown")),e(q.doc,"keyup",d.hitch(this,"onKeyUp")),e(q.doc,"dragstart",l),e(q.body(),"selectstart",l)];a="dojoDnd"+(h?"Copy":"Move");k.add(q.body(),a)},canDrop:function(a){a=!(!this.target||!a);this.canDropFlag!=a&&(this.canDropFlag=a,this.avatar.update())},stopDrag:function(){k.remove(q.body(),["dojoDndCopy","dojoDndMove"]);
r.forEach(this.events,function(a){a.remove()});this.events=[];this.avatar.destroy();this.source=this.target=this.avatar=null;this.nodes=[]},makeAvatar:function(){return new u(this)},updateAvatar:function(){this.avatar.update()},onMouseMove:function(b){var c=this.avatar;c&&(g.autoScrollNodes(b),c=c.node.style,c.left=b.pageX+this.OFFSET_X+"px",c.top=b.pageY+this.OFFSET_Y+"px",c=!!this.source.copyState(a.getCopyKeyState(b)),this.copy!=c&&this._setCopyStatus(c));p("touch")&&b.preventDefault()},onMouseUp:function(b){if(this.avatar){if(this.target&&
this.canDropFlag){var d=!!this.source.copyState(a.getCopyKeyState(b));c.publish("/dnd/drop/before",this.source,this.nodes,d,this.target,b);c.publish("/dnd/drop",this.source,this.nodes,d,this.target,b)}else c.publish("/dnd/cancel");this.stopDrag()}},onKeyDown:function(a){if(this.avatar)switch(a.keyCode){case h.CTRL:a=!!this.source.copyState(!0);this.copy!=a&&this._setCopyStatus(a);break;case h.ESCAPE:c.publish("/dnd/cancel"),this.stopDrag()}},onKeyUp:function(a){this.avatar&&a.keyCode==h.CTRL&&(a=
!!this.source.copyState(!1),this.copy!=a&&this._setCopyStatus(a))},_setCopyStatus:function(a){this.copy=a;this.source._markDndStatus(this.copy);this.updateAvatar();k.replace(q.body(),"dojoDnd"+(this.copy?"Copy":"Move"),"dojoDnd"+(this.copy?"Move":"Copy"))}});a._manager=null;n.manager=a.manager=function(){a._manager||(a._manager=new n);return a._manager};return n})},"dojo/dnd/Avatar":function(){define("../_base/declare ../_base/window ../dom ../dom-attr ../dom-class ../dom-construct ../hccss ../query".split(" "),
function(r,l,d,q,k,m,p,h){return r("dojo.dnd.Avatar",null,{constructor:function(d){this.manager=d;this.construct()},construct:function(){var d=m.create("table",{"class":"dojoDndAvatar",style:{position:"absolute",zIndex:"1999",margin:"0px"}}),c=this.manager.source,b,a=m.create("tbody",null,d),g=m.create("tr",null,a),h=m.create("td",null,g),k=Math.min(5,this.manager.nodes.length),l=0;p("highcontrast")&&m.create("span",{id:"a11yIcon",innerHTML:this.manager.copy?"+":"\x3c"},h);m.create("span",{innerHTML:c.generateText?
this._generateText():""},h);for(q.set(g,{"class":"dojoDndAvatarHeader",style:{opacity:.9}});l<k;++l)c.creator?b=c._normalizedCreator(c.getItem(this.manager.nodes[l].id).data,"avatar").node:(b=this.manager.nodes[l].cloneNode(!0),"tr"==b.tagName.toLowerCase()&&(g=m.create("table"),m.create("tbody",null,g).appendChild(b),b=g)),b.id="",g=m.create("tr",null,a),h=m.create("td",null,g),h.appendChild(b),q.set(g,{"class":"dojoDndAvatarItem",style:{opacity:(9-l)/10}});this.node=d},destroy:function(){m.destroy(this.node);
this.node=!1},update:function(){k.toggle(this.node,"dojoDndAvatarCanDrop",this.manager.canDropFlag);if(p("highcontrast")){var e=d.byId("a11yIcon"),c="+";this.manager.canDropFlag&&!this.manager.copy?c="\x3c ":this.manager.canDropFlag||this.manager.copy?this.manager.canDropFlag||(c="x"):c="o";e.innerHTML=c}h("tr.dojoDndAvatarHeader td span"+(p("highcontrast")?" span":""),this.node).forEach(function(b){b.innerHTML=this.manager.source.generateText?this._generateText():""},this)},_generateText:function(){return this.manager.nodes.length.toString()}})})},
"builder/dijit/RefreshInterval":function(){define("dojo/on dojo/Evented dojo/_base/html dojo/_base/lang dojo/_base/declare dijit/_WidgetBase dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dojo/text!./templates/RefreshInterval.html jimu/utils dijit/form/Select dijit/form/NumberTextBox".split(" "),function(r,l,d,q,k,m,p,h,e,c){return k([m,p,h,l],{templateString:e,baseClass:"refresh-interval",handle1:null,handle2:null,lastRefreshInterval:null,defaultRefreshInterval:{useWebMapRefreshInterval:!0},
defaultRefreshTip:"",singleRefreshTip:"",postMixInProperties:function(){this.nls=window.builderNls;this.defaultRefreshTip||(this.defaultRefreshTip=this.nls.defaultRefreshTip);this.singleRefreshTip||(this.singleRefreshTip=this.nls.singleRefreshTip)},postCreate:function(){this.inherited(arguments);this.refreshSelect.dropDown&&this.refreshSelect.dropDown.domNode&&d.addClass(this.refreshSelect.dropDown.domNode,"refresh-interval-select-dropdown");this.lastRefreshInterval=this.defaultRefreshInterval;this._bindEvents()},
getValue:function(){var b=null;"defaultRefresh"===this.refreshSelect.get("value")?(b={useWebMapRefreshInterval:!0},d.addClass(this.refreshIntervalInputs,"hidden")):(d.removeClass(this.refreshIntervalInputs,"hidden"),b=this.refreshIntervalNTB.get("value"),b=0<=b&&this.refreshIntervalNTB.validate()?{useWebMapRefreshInterval:!1,minutes:b}:null);return b},setValue:function(b){b||(b=this.defaultRefreshInterval);this.lastRefreshInterval=b;this._releaseEvents();b.useWebMapRefreshInterval?this.refreshSelect.set("value",
"defaultRefresh"):(this.refreshSelect.set("value","singleRefresh"),this.refreshIntervalNTB.set("value",b.minutes));this._bindEvents()},reset:function(){this.setValue(this.defaultRefreshInterval)},_releaseEvents:function(){this.handle1&&this.handle1.remove();this.handle2&&this.handle2.remove();this.handle2=this.handle1=null},_bindEvents:function(){this._releaseEvents();this.handle1=r(this.refreshSelect,"change",q.hitch(this,this._onChanged));this.handle2=r(this.refreshIntervalNTB,"change",q.hitch(this,
this._onChanged))},_onChanged:function(){var b=this.getValue();b&&!c.isEqual(b,this.lastRefreshInterval)&&(this.lastRefreshInterval=b,this.emit("user-input-change",b))},destroy:function(){this._releaseEvents();this.inherited(arguments)}})})},"dojo/NodeList-data":function(){define(["./_base/kernel","./query","./_base/lang","./_base/array","./dom-attr"],function(r,l,d,q,k){var m=l.NodeList,p={},h=0,e=function(a){var b=k.get(a,"data-dojo-dataid");b||(b="pid"+h++,k.set(a,"data-dojo-dataid",b));return b},
c=r._nodeData=function(a,b,c){var g=e(a),h;p[g]||(p[g]={});if(1==arguments.length)return p[g];"string"==typeof b?2<arguments.length?p[g][b]=c:h=p[g][b]:h=d.mixin(p[g],b);return h},b=r._removeNodeData=function(a,b){var c=e(a);p[c]&&(b?delete p[c][b]:delete p[c])};m._gcNodeData=r._gcNodeData=function(){var a=l("[data-dojo-dataid]").map(e),b;for(b in p)0>q.indexOf(a,b)&&delete p[b]};d.extend(m,{data:m._adaptWithCondition(c,function(a){return 0===a.length||1==a.length&&"string"==typeof a[0]}),removeData:m._adaptAsForEach(b)});
return m})},"jimu/dijit/ColorPicker":function(){define("dojo/_base/declare dijit/_WidgetBase dijit/_TemplatedMixin dojo/_base/lang dojo/_base/html dojo/on dojo/_base/Color dijit/TooltipDialog dijit/popup dojox/widget/ColorPicker jimu/utils".split(" "),function(r,l,d,q,k,m,p,h,e,c,b){return r([l,d],{baseClass:"jimu-color-picker",declaredClass:"jimu.dijit.ColorPicker",templateString:"\x3cdiv\x3e\x3c/div\x3e",_isTooltipDialogOpened:!1,color:null,showHex:!0,showHsv:!0,showRgb:!0,ensureMode:!1,showLabel:!1,
postMixInProperties:function(){this.nls=window.jimuNls.common},postCreate:function(){this.inherited(arguments);this.color?this.color instanceof p||(this.color=new p(this.color)):this.color=new p("#ccc");k.setStyle(this.domNode,"backgroundColor",this.color.toHex());this.showLabel&&this._changeLabel(this.color);this._createTooltipDialog(this.domNode);this._hideTooltipDialog()},destroy:function(){e.close(this.tooltipDialog);this.picker.destroy();this.tooltipDialog.destroy();this.inherited(arguments)},
isPartOfPopup:function(a){var b=this.tooltipDialog.domNode;return a===b||k.isDescendant(a,b)},hideTooltipDialog:function(){this._hideTooltipDialog()},_showTooltipDialog:function(){e.open({parent:this.getParent(),popup:this.tooltipDialog,around:this.domNode});this._isTooltipDialogOpened=!0},_hideTooltipDialog:function(){this._isTooltipDialogOpened=!1;this.onClose();e.close(this.tooltipDialog)},_createTooltipDialog:function(){var a=k.create("div");this.tooltipDialog=new h({content:a});k.addClass(this.tooltipDialog.domNode,
"jimu-color-picker-dialog");var b=new c({showHex:this.showHex,showRgb:this.showRgb,showHsv:this.showHsv,value:this.color.toHex(),onChange:q.hitch(this,function(a){this.ensureMode||(a=new p(a),this.setColor(a))})});b.placeAt(a);b.startup();if(this.ensureMode){var d=k.create("div",{"class":"jimu-btn jimu-btn-vacation jimu-float-trailing",title:this.nls.cancel,innerHTML:this.nls.cancel},a);this.own(m(d,"click",q.hitch(this,function(){this._hideTooltipDialog()})));"undefined"===typeof this.showOk&&(d=
k.create("div",{"class":"jimu-btn jimu-float-trailing ok",title:this.nls.ok,innerHTML:this.nls.ok},a),this.own(m(d,"click",q.hitch(this,function(){var a=this.picker.get("value");this.setColor(new p(a));this._hideTooltipDialog()}))));a=k.create("div",{"class":"jimu-btn jimu-float-trailing",title:this.nls.apply,innerHTML:this.nls.apply},a);this.own(m(a,"click",q.hitch(this,function(){var a=this.picker.get("value");this.setColor(new p(a))})))}this.own(m(this.domNode,"click",q.hitch(this,function(a){a.stopPropagation();
a.preventDefault();this._isTooltipDialogOpened?this._hideTooltipDialog():this._showTooltipDialog()})));this.own(m(document.body,"click",q.hitch(this,function(a){this.isPartOfPopup(a.target||a.srcElement)||this._hideTooltipDialog()})));this.picker=b},setColor:function(a,b){if(a instanceof p){var c=this.color,d="";c&&(d=c.toHex());c=a.toHex();this.color=a;k.setStyle(this.domNode,"backgroundColor",c);if(d!==c&&(this.picker.set("value",c),!1!==b))this.onChange(new p(c))}},getColor:function(){return this.color},
_changeLabel:function(a){k.empty(this.domNode);k.create("span",{innerHTML:a.toHex(),className:"color-label",style:{color:b.invertColor(a.toHex())}},this.domNode)},onChange:function(a){this.showLabel&&this._changeLabel(a)},onClose:function(){},getPopup:function(){return this.tooltipDialog||null},setLabel:function(a){k.empty(this.domNode);k.create("span",{innerHTML:a||"",className:"text-label"},this.domNode)},isTooltipDialogOpened:function(){return this._isTooltipDialogOpened}})})},"dojox/widget/ColorPicker":function(){define("dojo/_base/kernel dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/html dojo/_base/connect dojo/_base/sniff dojo/_base/window dojo/_base/event dojo/dom dojo/dom-class dojo/keys dojo/fx dojo/dnd/move dijit/registry dijit/_base/focus dijit/form/_FormWidget dijit/typematic dojox/color dojo/i18n dojo/i18n!./nls/ColorPicker dojo/i18n!dojo/cldr/nls/number dojo/text!./ColorPicker/ColorPicker.html".split(" "),
function(r,l,d,q,k,m,p,h,e,c,b,a,g,u,n,t,f,v,x,w,z,A,y){r.experimental("dojox.widget.ColorPicker");return l("dojox.widget.ColorPicker",f,{showRgb:!0,showHsv:!0,showHex:!0,webSafe:!0,animatePoint:!0,slideDuration:250,liveUpdate:!1,PICKER_HUE_H:150,PICKER_SAT_VAL_H:150,PICKER_SAT_VAL_W:150,PICKER_HUE_SELECTOR_H:8,PICKER_SAT_SELECTOR_H:10,PICKER_SAT_SELECTOR_W:10,value:"#ffffff",_underlay:require.toUrl("dojox/widget/ColorPicker/images/underlay.png"),_hueUnderlay:require.toUrl("dojox/widget/ColorPicker/images/hue.png"),
_pickerPointer:require.toUrl("dojox/widget/ColorPicker/images/pickerPointer.png"),_huePickerPointer:require.toUrl("dojox/widget/ColorPicker/images/hueHandle.png"),_huePickerPointerAlly:require.toUrl("dojox/widget/ColorPicker/images/hueHandleA11y.png"),templateString:y,postMixInProperties:function(){b.contains(h.body(),"dijit_a11y")&&(this._huePickerPointer=this._huePickerPointerAlly);this._uId=n.getUniqueId(this.id);d.mixin(this,w.getLocalization("dojox.widget","ColorPicker"));d.mixin(this,w.getLocalization("dojo.cldr",
"number"));this.inherited(arguments)},postCreate:function(){this.inherited(arguments);7>p("ie")&&(this.colorUnderlay.style.filter="progid:DXImageTransform.Microsoft.AlphaImageLoader(src\x3d'"+this._underlay+"', sizingMethod\x3d'scale')",this.colorUnderlay.src=this._blankGif.toString());this.showRgb||(this.rgbNode.style.visibility="hidden");this.showHsv||(this.hsvNode.style.visibility="hidden");this.showHex||(this.hexNode.style.visibility="hidden");this.webSafe||(this.safePreviewNode.style.visibility=
"hidden")},startup:function(){this._started||(this._started=!0,this.set("value",this.value),this._mover=new u.boxConstrainedMoveable(this.cursorNode,{box:{t:-(this.PICKER_SAT_SELECTOR_H/2),l:-(this.PICKER_SAT_SELECTOR_W/2),w:this.PICKER_SAT_VAL_W,h:this.PICKER_SAT_VAL_H}}),this._hueMover=new u.boxConstrainedMoveable(this.hueCursorNode,{box:{t:-(this.PICKER_HUE_SELECTOR_H/2),l:0,w:0,h:this.PICKER_HUE_H}}),this._subs=[],this._subs.push(m.subscribe("/dnd/move/stop",d.hitch(this,"_clearTimer"))),this._subs.push(m.subscribe("/dnd/move/start",
d.hitch(this,"_setTimer"))),this._keyListeners=[],this._connects.push(v.addKeyListener(this.hueCursorNode,{charOrCode:a.UP_ARROW,shiftKey:!1,metaKey:!1,ctrlKey:!1,altKey:!1},this,d.hitch(this,this._updateHueCursorNode),25,25)),this._connects.push(v.addKeyListener(this.hueCursorNode,{charOrCode:a.DOWN_ARROW,shiftKey:!1,metaKey:!1,ctrlKey:!1,altKey:!1},this,d.hitch(this,this._updateHueCursorNode),25,25)),this._connects.push(v.addKeyListener(this.cursorNode,{charOrCode:a.UP_ARROW,shiftKey:!1,metaKey:!1,
ctrlKey:!1,altKey:!1},this,d.hitch(this,this._updateCursorNode),25,25)),this._connects.push(v.addKeyListener(this.cursorNode,{charOrCode:a.DOWN_ARROW,shiftKey:!1,metaKey:!1,ctrlKey:!1,altKey:!1},this,d.hitch(this,this._updateCursorNode),25,25)),this._connects.push(v.addKeyListener(this.cursorNode,{charOrCode:a.LEFT_ARROW,shiftKey:!1,metaKey:!1,ctrlKey:!1,altKey:!1},this,d.hitch(this,this._updateCursorNode),25,25)),this._connects.push(v.addKeyListener(this.cursorNode,{charOrCode:a.RIGHT_ARROW,shiftKey:!1,
metaKey:!1,ctrlKey:!1,altKey:!1},this,d.hitch(this,this._updateCursorNode),25,25)))},_setValueAttr:function(a,b){this._started&&this.setColor(a,b)},setColor:function(a,b){a=x.fromString(a);this._updatePickerLocations(a);this._updateColorInputs(a);this._updateValue(a,b)},_setTimer:function(a){if(a.node==this.cursorNode||a.node==this.hueCursorNode)t.focus(a.node),c.setSelectable(this.domNode,!1),this._timer=setInterval(d.hitch(this,"_updateColor"),45)},_clearTimer:function(a){this._timer&&(clearInterval(this._timer),
this._timer=null,this.onChange(this.value),c.setSelectable(this.domNode,!0))},_setHue:function(a){k.style(this.colorUnderlay,"backgroundColor",x.fromHsv(a,100,100).toHex())},_updateHueCursorNode:function(b,c,d){if(-1!==b){b=k.style(this.hueCursorNode,"top");c=this.PICKER_HUE_SELECTOR_H/2;b+=c;var e=!1;d.charOrCode==a.UP_ARROW?0<b&&(--b,e=!0):d.charOrCode==a.DOWN_ARROW&&b<this.PICKER_HUE_H&&(b+=1,e=!0);e&&k.style(this.hueCursorNode,"top",b-c+"px")}else this._updateColor(!0)},_updateCursorNode:function(b,
c,d){c=this.PICKER_SAT_SELECTOR_H/2;var e=this.PICKER_SAT_SELECTOR_W/2;if(-1!==b){b=k.style(this.cursorNode,"top");var f=k.style(this.cursorNode,"left");b+=c;var f=f+e,g=!1;d.charOrCode==a.UP_ARROW?0<b&&(--b,g=!0):d.charOrCode==a.DOWN_ARROW?b<this.PICKER_SAT_VAL_H&&(b+=1,g=!0):d.charOrCode==a.LEFT_ARROW?0<f&&(--f,g=!0):d.charOrCode==a.RIGHT_ARROW&&f<this.PICKER_SAT_VAL_W&&(f+=1,g=!0);g&&(f-=e,k.style(this.cursorNode,"top",b-c+"px"),k.style(this.cursorNode,"left",f+"px"))}else this._updateColor(!0)},
_updateColor:function(a){var b=this.PICKER_HUE_SELECTOR_H/2,c=this.PICKER_SAT_SELECTOR_H/2,d=this.PICKER_SAT_SELECTOR_W/2,b=k.style(this.hueCursorNode,"top")+b,c=k.style(this.cursorNode,"top")+c,d=k.style(this.cursorNode,"left")+d,b=Math.round(360-b/this.PICKER_HUE_H*360),d=x.fromHsv(b,d/this.PICKER_SAT_VAL_W*100,100-c/this.PICKER_SAT_VAL_H*100);this._updateColorInputs(d);this._updateValue(d,a);b!=this._hue&&this._setHue(b)},_colorInputChange:function(a){var b,c=!1;switch(a.target){case this.hexCode:b=
x.fromString(a.target.value);c=!0;break;case this.Rval:case this.Gval:case this.Bval:b=x.fromArray([this.Rval.value,this.Gval.value,this.Bval.value]);c=!0;break;case this.Hval:case this.Sval:case this.Vval:b=x.fromHsv(this.Hval.value,this.Sval.value,this.Vval.value),c=!0}c&&(this._updatePickerLocations(b),this._updateColorInputs(b),this._updateValue(b,!0))},_updateValue:function(a,b){var c=a.toHex();this.value=this.valueNode.value=c;if(b&&(!this._timer||this.liveUpdate))this.onChange(c)},_updatePickerLocations:function(a){var b=
this.PICKER_HUE_SELECTOR_H/2,c=this.PICKER_SAT_SELECTOR_H/2,d=this.PICKER_SAT_SELECTOR_W/2;a=a.toHsv();b=Math.round(this.PICKER_HUE_H-a.h/360*this.PICKER_HUE_H)-b;d=Math.round(a.s/100*this.PICKER_SAT_VAL_W)-d;c=Math.round(this.PICKER_SAT_VAL_H-a.v/100*this.PICKER_SAT_VAL_H)-c;this.animatePoint?(g.slideTo({node:this.hueCursorNode,duration:this.slideDuration,top:b,left:0}).play(),g.slideTo({node:this.cursorNode,duration:this.slideDuration,top:c,left:d}).play()):(k.style(this.hueCursorNode,"top",b+"px"),
k.style(this.cursorNode,{left:d+"px",top:c+"px"}));a.h!=this._hue&&this._setHue(a.h)},_updateColorInputs:function(a){var b=a.toHex();this.showRgb&&(this.Rval.value=a.r,this.Gval.value=a.g,this.Bval.value=a.b);this.showHsv&&(a=a.toHsv(),this.Hval.value=Math.round(a.h),this.Sval.value=Math.round(a.s),this.Vval.value=Math.round(a.v));this.showHex&&(this.hexCode.value=b);this.previewNode.style.backgroundColor=b;this.webSafe&&(this.safePreviewNode.style.backgroundColor=b)},_setHuePoint:function(a){var b=
this.PICKER_HUE_SELECTOR_H/2;a=a.layerY||a.y-a.target.getBoundingClientRect().top;a-=b;this.animatePoint?g.slideTo({node:this.hueCursorNode,duration:this.slideDuration,top:a,left:0,onEnd:d.hitch(this,function(){this._updateColor(!0);t.focus(this.hueCursorNode)})}).play():(k.style(this.hueCursorNode,"top",a+"px"),this._updateColor(!0))},_setPoint:function(a){var b=this.PICKER_SAT_SELECTOR_H/2,c=this.PICKER_SAT_SELECTOR_W/2,e=a.layerY||a.y-a.target.getBoundingClientRect().top,e=e-b,b=a.layerX||a.x-
a.target.getBoundingClientRect().left,b=b-c;a&&t.focus(a.target);this.animatePoint?g.slideTo({node:this.cursorNode,duration:this.slideDuration,top:e,left:b,onEnd:d.hitch(this,function(){this._updateColor(!0);t.focus(this.cursorNode)})}).play():(k.style(this.cursorNode,{left:b+"px",top:e+"px"}),this._updateColor(!0))},_handleKey:function(a){},focus:function(){this.focused||t.focus(this.focusNode)},_stopDrag:function(a){e.stop(a)},destroy:function(){this.inherited(arguments);q.forEach(this._subs,function(a){m.unsubscribe(a)});
delete this._subs}})})},"dojox/color":function(){define(["./color/_base"],function(r){return r})},"dojox/color/_base":function(){define(["../main","dojo/_base/lang","dojo/_base/Color","dojo/colors"],function(r,l,d,q){r=l.getObject("color",!0,r);r.Color=d;r.blend=d.blendColors;r.fromRgb=d.fromRgb;r.fromHex=d.fromHex;r.fromArray=d.fromArray;r.fromString=d.fromString;r.greyscale=q.makeGrey;l.mixin(r,{fromCmy:function(k,m,p){l.isArray(k)?(m=k[1],p=k[2],k=k[0]):l.isObject(k)&&(m=k.m,p=k.y,k=k.c);return new d({r:Math.round(255*
(1-k/100)),g:Math.round(255*(1-m/100)),b:Math.round(255*(1-p/100))})},fromCmyk:function(k,m,p,h){l.isArray(k)?(m=k[1],p=k[2],h=k[3],k=k[0]):l.isObject(k)&&(m=k.m,p=k.y,h=k.b,k=k.c);h/=100;return new d({r:Math.round(255*(1-Math.min(1,k/100*(1-h)+h))),g:Math.round(255*(1-Math.min(1,m/100*(1-h)+h))),b:Math.round(255*(1-Math.min(1,p/100*(1-h)+h)))})},fromHsl:function(k,m,p){l.isArray(k)?(m=k[1],p=k[2],k=k[0]):l.isObject(k)&&(m=k.s,p=k.l,k=k.h);m/=100;for(p/=100;0>k;)k+=360;for(;360<=k;)k-=360;var h,e;
120>k?(h=(120-k)/60,e=k/60,k=0):240>k?(h=0,e=(240-k)/60,k=(k-120)/60):(h=(k-240)/60,e=0,k=(360-k)/60);h=2*m*Math.min(h,1)+(1-m);e=2*m*Math.min(e,1)+(1-m);k=2*m*Math.min(k,1)+(1-m);.5>p?(h*=p,e*=p,k*=p):(h=(1-p)*h+2*p-1,e=(1-p)*e+2*p-1,k=(1-p)*k+2*p-1);return new d({r:Math.round(255*h),g:Math.round(255*e),b:Math.round(255*k)})}});r.fromHsv=function(k,m,p){l.isArray(k)?(m=k[1],p=k[2],k=k[0]):l.isObject(k)&&(m=k.s,p=k.v,k=k.h);360==k&&(k=0);m/=100;p/=100;var h,e,c;if(0==m)e=c=h=p;else{var b=k/60;k=Math.floor(b);
var a=b-k,b=p*(1-m),g=p*(1-m*a);m=p*(1-m*(1-a));switch(k){case 0:h=p;e=m;c=b;break;case 1:h=g;e=p;c=b;break;case 2:h=b;e=p;c=m;break;case 3:h=b;e=g;c=p;break;case 4:h=m;e=b;c=p;break;case 5:h=p,e=b,c=g}}return new d({r:Math.round(255*h),g:Math.round(255*e),b:Math.round(255*c)})};l.extend(d,{toCmy:function(){return{c:Math.round(100*(1-this.r/255)),m:Math.round(100*(1-this.g/255)),y:Math.round(100*(1-this.b/255))}},toCmyk:function(){var d,l=this.r/255,p=this.g/255,h=this.b/255;d=Math.min(1-l,1-p,1-
h);return{c:Math.round((1-l-d)/(1-d)*100),m:Math.round((1-p-d)/(1-d)*100),y:Math.round((1-h-d)/(1-d)*100),b:Math.round(100*d)}},toHsl:function(){var d=this.r/255,l=this.g/255,p=this.b/255,h=Math.min(d,p,l),e=Math.max(d,l,p),c=e-h,b=0,a=0,h=(h+e)/2;0<h&&1>h&&(a=c/(.5>h?2*h:2-2*h));0<c&&(e==d&&e!=l&&(b+=(l-p)/c),e==l&&e!=p&&(b+=2+(p-d)/c),e==p&&e!=d&&(b+=4+(d-l)/c),b*=60);return{h:b,s:Math.round(100*a),l:Math.round(100*h)}},toHsv:function(){var d=this.r/255,l=this.g/255,p=this.b/255,h=Math.max(d,l,
p),e=h-Math.min(d,p,l),c=null,b=0==h?0:e/h;0==b?c=0:(c=d==h?60*(l-p)/e:l==h?120+60*(p-d)/e:240+60*(d-l)/e,0>c&&(c+=360));return{h:c,s:Math.round(100*b),v:Math.round(100*h)}}});return r})},"dijit/_editor/plugins/FontChoice":function(){define("require dojo/_base/array dojo/_base/declare dojo/dom-construct dojo/i18n dojo/_base/lang dojo/store/Memory ../../registry ../../_Widget ../../_TemplatedMixin ../../_WidgetsInTemplateMixin ../../form/FilteringSelect ../_Plugin ../range dojo/i18n!../nls/FontChoice".split(" "),
function(r,l,d,q,k,m,p,h,e,c,b,a,g,u){r=d("dijit._editor.plugins._FontDropDown",[e,c,b],{label:"",plainText:!1,templateString:"\x3cspan style\x3d'white-space: nowrap' class\x3d'dijit dijitReset dijitInline'\x3e\x3clabel class\x3d'dijitLeft dijitInline' for\x3d'${selectId}'\x3e${label}\x3c/label\x3e\x3cinput data-dojo-type\x3d'../../form/FilteringSelect' required\x3d'false' data-dojo-props\x3d'labelType:\"html\", labelAttr:\"label\", searchAttr:\"name\"' class\x3d'${comboClass}' tabIndex\x3d'-1' id\x3d'${selectId}' data-dojo-attach-point\x3d'select' value\x3d''/\x3e\x3c/span\x3e",
contextRequire:r,postMixInProperties:function(){this.inherited(arguments);this.strings=k.getLocalization("dijit._editor","FontChoice");this.label=this.strings[this.command];this.id=h.getUniqueId(this.declaredClass.replace(/\./g,"_"));this.selectId=this.id+"_select";this.inherited(arguments)},postCreate:function(){this.select.set("store",new p({idProperty:"value",data:l.map(this.values,function(a){var b=this.strings[a]||a;return{label:this.getLabel(a,b),name:b,value:a}},this)}));this.select.set("value",
"",!1);this.disabled=this.select.get("disabled")},_setValueAttr:function(a,b){b=!1!==b;this.select.set("value",0>l.indexOf(this.values,a)?"":a,b);b||(this.select._lastValueReported=null)},_getValueAttr:function(){return this.select.get("value")},focus:function(){this.select.focus()},_setDisabledAttr:function(a){this._set("disabled",a);this.select.set("disabled",a)}});var n=d("dijit._editor.plugins._FontNameDropDown",r,{generic:!1,command:"fontName",comboClass:"dijitFontNameCombo",postMixInProperties:function(){this.values||
(this.values=this.generic?["serif","sans-serif","monospace","cursive","fantasy"]:["Arial","Times New Roman","Comic Sans MS","Courier New"]);this.inherited(arguments)},getLabel:function(a,b){return this.plainText?b:"\x3cdiv style\x3d'font-family: "+a+"'\x3e"+b+"\x3c/div\x3e"},_setValueAttr:function(a,b){this.generic&&(a={Arial:"sans-serif",Helvetica:"sans-serif",Myriad:"sans-serif",Times:"serif","Times New Roman":"serif","Comic Sans MS":"cursive","Apple Chancery":"cursive",Courier:"monospace","Courier New":"monospace",
Papyrus:"fantasy","Estrangelo Edessa":"cursive",Gabriola:"fantasy"}[a]||a);this.inherited(arguments,[a,!1!==b])}}),t=d("dijit._editor.plugins._FontSizeDropDown",r,{command:"fontSize",comboClass:"dijitFontSizeCombo",values:[1,2,3,4,5,6,7],getLabel:function(a,b){return this.plainText?b:"\x3cfont size\x3d"+a+"'\x3e"+b+"\x3c/font\x3e"},_setValueAttr:function(a,b){b=!1!==b;a.indexOf&&-1!=a.indexOf("px")&&(a={10:1,13:2,16:3,18:4,24:5,32:6,48:7}[parseInt(a,10)]||a);this.inherited(arguments,[a,b])}}),f=d("dijit._editor.plugins._FormatBlockDropDown",
r,{command:"formatBlock",comboClass:"dijitFormatBlockCombo",values:"noFormat p h1 h2 h3 pre".split(" "),postCreate:function(){this.inherited(arguments);this.set("value","noFormat",!1)},getLabel:function(a,b){return this.plainText||"noFormat"==a?b:"\x3c"+a+"\x3e"+b+"\x3c/"+a+"\x3e"},_execCommand:function(a,b,c){if("noFormat"===c){var d;if((b=u.getSelection(a.window))&&0<b.rangeCount){c=b.getRangeAt(0);var e;if(c){b=c.startContainer;for(d=c.endContainer;b&&b!==a.editNode&&b!==a.document.body&&1!==b.nodeType;)b=
b.parentNode;for(;d&&d!==a.editNode&&d!==a.document.body&&1!==d.nodeType;)d=d.parentNode;var f=m.hitch(this,function(b,c){if(b.childNodes&&b.childNodes.length){var d;for(d=0;d<b.childNodes.length;d++){var e=b.childNodes[d];if(1==e.nodeType&&a.selection.inSelection(e)){var g=e.tagName?e.tagName.toLowerCase():"";-1!==l.indexOf(this.values,g)&&c.push(e);f(e,c)}}}});c=m.hitch(this,function(b){if(b&&b.length){for(a.beginEditing();b.length;)this._removeFormat(a,b.pop());a.endEditing()}});var g=[];if(b==
d){var h;for(d=b;d&&d!==a.editNode&&d!==a.document.body;){if(1==d.nodeType&&(e=d.tagName?d.tagName.toLowerCase():"",-1!==l.indexOf(this.values,e))){h=d;break}d=d.parentNode}f(b,g);h&&(g=[h].concat(g))}else for(d=b;a.selection.inSelection(d);)1==d.nodeType&&(e=d.tagName?d.tagName.toLowerCase():"",-1!==l.indexOf(this.values,e)&&g.push(d),f(d,g)),d=d.nextSibling;c(g);a.onDisplayChanged()}}}else a.execCommand(b,c)},_removeFormat:function(a,b){if(a.customUndo){for(;b.firstChild;)q.place(b.firstChild,b,
"before");b.parentNode.removeChild(b)}else{a.selection.selectElementChildren(b);var c=a.selection.getSelectedHtml();a.selection.selectElement(b);a.execCommand("inserthtml",c||"")}}}),v=d("dijit._editor.plugins.FontChoice",g,{useDefaultCommand:!1,_initButton:function(){var a={fontName:n,fontSize:t,formatBlock:f}[this.command],b=this.params;this.params.custom&&(b.values=this.params.custom);var c=this.editor;this.button=new a(m.delegate({dir:c.dir,lang:c.lang},b));this.own(this.button.select.on("change",
m.hitch(this,function(a){this.editor.focused&&this.editor.focus();"fontName"==this.command&&-1!=a.indexOf(" ")&&(a="'"+a+"'");this.button._execCommand?this.button._execCommand(this.editor,this.command,a):this.editor.execCommand(this.command,a)})))},updateState:function(){var a=this.editor,b=this.command;if(a&&a.isLoaded&&b.length&&this.button){var c=this.get("disabled");this.button.set("disabled",c);if(!c){var d;try{d=a.queryCommandValue(b)||""}catch(B){d=""}(c=m.isString(d)&&(d.match(/'([^']*)'/)||
d.match(/"([^"]*)"/)))&&(d=c[1]);if("formatBlock"===b)if(d&&"p"!=d)0>l.indexOf(this.button.values,d)&&(d="noFormat");else{d=null;var e;(b=u.getSelection(this.editor.window))&&0<b.rangeCount&&(b=b.getRangeAt(0))&&(e=b.endContainer);for(;e&&e!==a.editNode&&e!==a.document;){if((b=e.tagName?e.tagName.toLowerCase():"")&&-1<l.indexOf(this.button.values,b)){d=b;break}e=e.parentNode}d||(d="noFormat")}d!==this.button.get("value")&&this.button.set("value",d,!1)}}}});l.forEach(["fontName","fontSize","formatBlock"],
function(a){g.registry[a]=function(b){return new v({command:a,plainText:b.plainText})}});v._FontDropDown=r;v._FontNameDropDown=n;v._FontSizeDropDown=t;v._FormatBlockDropDown=f;return v})},"jimu/dijit/EditorTextColor":function(){define("require dojo dijit dojo/_base/declare dijit/_editor/_Plugin dijit/form/DropDownButton".split(" "),function(r,l,d,q,k,m){l.experimental("dijit.editor.plugins.EditorTextColor");var p=q("dijit.editor.plugins.EditorTextColor",k,{buttonClass:m,colorPicker:"jimu/dijit/ColorPalette",
useDefaultCommand:!1,_initButton:function(){this.command="editorTextColor";this.hackCommand="foreColor";this.inherited(arguments);var d="",e=!1;this.params.custom&&(this.params.custom.recordUID&&(d=this.params.custom.recordUID),this.params.custom.forceAttr&&(e=this.params.custom.forceAttr));var c=this;this.button.set("iconClass",this.iconClassPrefix+" "+this.iconClassPrefix+"ForeColor");this.button.set("title",this.getLabel(this.hackCommand));this.button.loadDropDown=function(b){function a(a){c.button.dropDown=
new a({dir:c.editor.dir,ownerDocument:c.editor.ownerDocument,value:c.value,appearance:{showTransparent:!1,showColorPalette:!0,showCoustom:!0,showCoustomRecord:!0},recordUID:d,onChange:function(a){c.editor.execCommand("useCSS",e);c.editor.execCommand("styleWithCSS",!e);c.editor.execCommand(c.hackCommand,a)}});b()}"string"===typeof c.colorPicker?r([c.colorPicker],a):a(c.colorPicker)}},updateState:function(){var d=this.editor,e=this.hackCommand;if(d&&d.isLoaded&&e.length){var c;if(this.button){var b=
this.get("disabled");this.button.set("disabled",b);if(b)return;try{c=d.queryCommandValue(e)||""}catch(a){c=""}}""===c?c="#000000":"transparent"===c&&(c="rgba(0, 0, 0, 0)");this.value=c;(d=this.button.dropDown)&&d.getColor&&c!==d.getColor()&&(d.refreshRecords(),d.setColor(c))}}});l.subscribe(d._scopeName+".Editor.getPlugin",null,function(d){if(!d.plugin)switch(d.args.name){case "editorTextColor":d.plugin=new p}});return p})},"jimu/dijit/EditorBackgroundColor":function(){define("require dojo dijit dojo/_base/declare dijit/_editor/_Plugin dijit/form/DropDownButton".split(" "),
function(r,l,d,q,k,m){l.experimental("dijit.editor.plugins.EditorBackgroundColor");var p=q("dijit.editor.plugins.EditorBackgroundColor",k,{buttonClass:m,colorPicker:"jimu/dijit/ColorPalette",useDefaultCommand:!1,_initButton:function(){this.command="editorBackgroundColor";this.hackCommand="hiliteColor";this.inherited(arguments);var d="";this.params.custom&&this.params.custom.recordUID&&(d=this.params.custom.recordUID);var e=this;this.button.set("iconClass",this.iconClassPrefix+" "+this.iconClassPrefix+
"HiliteColor");this.button.set("title",this.getLabel(this.hackCommand));this.button.loadDropDown=function(c){function b(a){e.button.dropDown=new a({dir:e.editor.dir,ownerDocument:e.editor.ownerDocument,value:e.value,appearance:{showTransparent:!0,showColorPalette:!0,showCoustom:!0,showCoustomRecord:!0},recordUID:d,onChange:function(a){e.editor.execCommand("useCSS",!1);e.editor.execCommand("styleWithCSS",!0);e.editor.execCommand(e.hackCommand,a)},onExecute:function(){e.editor.execCommand(e.hackCommand,
this.get("value"))}});c()}"string"===typeof e.colorPicker?r([e.colorPicker],b):b(e.colorPicker)}},updateState:function(){var d=this.editor,e=this.hackCommand;if(d&&d.isLoaded&&e.length){var c;if(this.button){var b=this.get("disabled");this.button.set("disabled",b);if(b)return;try{c=d.queryCommandValue(e)||""}catch(a){c=""}}""===c?c="#000000":"transparent"===c&&(c="rgba(0, 0, 0, 0)");this.value=c;(d=this.button.dropDown)&&d.getColor&&c!==d.getColor()&&(d.refreshRecords(),d.setColor(c))}}});l.subscribe(d._scopeName+
".Editor.getPlugin",null,function(d){if(!d.plugin)switch(d.args.name){case "editorBackgroundColor":d.plugin=new p}});return p})},"builder/plugins/creation-entry/_build-generate_module":function(){define(["builder/plugins/creation-entry/Plugin","dojo/text!builder/plugins/creation-entry/Plugin.html","dojo/text!builder/plugins/creation-entry/css/style.css","dojo/i18n!builder/plugins/creation-entry/nls/strings"],function(){})},"builder/plugins/creation-entry/Plugin":function(){define("dojo/_base/declare dojo/_base/html dojo/Deferred dojo/keys builder/BasePlugin dijit/_WidgetsInTemplateMixin dojo/text!./Plugin.html dojo/_base/lang dojo/query dojo/promise/all jimu/dijit/Message jimu/dijit/Popup builder/portalUtils jimu/portalUrlUtils jimu/dijit/LoadingShelter builder/serviceUtils ./SaveAsPage ./CreateNewAppPage builder/dijit/FullScreenPopup".split(" "),
function(r,l,d,q,k,m,p,h,e,c,b,a,g,u,n,t,f,v,x){return r([k,m],{templateString:p,baseClass:"plugin-creation-app",fromAppId:null,postMixInProperties:function(){this.inherited(arguments);this.nls=h.mixin(this.nls,builderNls)},postCreate:function(){this.inherited(arguments)},popupNewCreateDlg:function(a,b){this._getInitAppInfo().then(h.hitch(this,function(c){this.createAppPage=new v({appInfo:c,pluginManager:this.pluginManager,createFromAppInfo:b,nls:this.nls,isPortalSupport3D:window.isPortalSupport3D});
c=e("#main-page")[0];this.createAppPopup=new x({zIndex:101,subDijit:this.createAppPage,titleStr:a||this.nls.appCreateNewAppTitle,content:this.createAppPage.domNode,blurContainer:c.firstElementChild,buttons:[{label:this.nls.next,key:q.ENTER,isHighLight:!0,onClick:h.hitch(this.createAppPage,this.createAppPage._onNextClick)},{label:this.nls.back,key:q.ENTER,isHighLight:!0,onClick:h.hitch(this.createAppPage,this.createAppPage._onBackClick)},{label:this.nls.ok,key:q.ENTER,isHighLight:!0,onClick:h.hitch(this,
this._onCreateNewClick)},{label:this.nls.cancel,key:q.ESCAPE,isHighLight:!1,onClick:h.hitch(this,this._onCreateNewCancelClick)}],btnsAtuoBottom:!0});this.createAppPopup.placeAt(c);this.createAppPopup.show();this.createAppPage.setPopup(this.createAppPopup);this.createAppPage.startup()}))},createNewApp:function(c){var e=new d;t.createApp(c).then(h.hitch(this,function(b){if(b.success){var d=h.clone(c);d.id=b.newAppId;this.pluginManager.getPluginByName("startup").switchToAppConfig(d);e.resolve();c.sharing&&
(c.webmap?this._shareAppWithWebmapOrWebscene(b.newAppId,c.folderId,c.webmap):c.webscene&&this._shareAppWithWebmapOrWebscene(b.newAppId,c.folderId,c.webscene))}else{var f=new a({content:b.message,container:"main-page",titleLabel:builderNls.createError||"",width:400,autoHeight:!0,buttons:[{label:this.nls.ok,key:q.ENTER,onClick:h.hitch(this,function(){b.href&&(l.setStyle(f.domNode,"display","none"),window.location.href=b.href);f.close()})}]});e.reject()}}),h.hitch(this,function(a){new b({message:a.message});
e.reject(a)}));return e},popupSaveAsDlg:function(b,c,d){this._getInitAppInfo(c).then(h.hitch(this,function(e){this.saveAsPage=new f({fromAppId:c,appInfo:e,nls:this.nls});this.saveAsPage.startup();this.saveAsPopup=new a({content:this.saveAsPage,container:"main-page",titleLabel:b||"",width:669,autoHeight:!0,buttons:[{label:this.nls.ok,key:q.ENTER,onClick:h.hitch(this,this._onSaveAsPopupNextClick,d)},{label:this.nls.cancel,classNames:["jimu-btn-vacation"],key:q.ESCAPE,onClick:h.hitch(this,this._onSaveAsPopupCancelClick)}]})}))},
_onSaveAsPopupCancelClick:function(){this._close()},_onSaveAsPopupNextClick:function(a){var c=this.saveAsPage._getAppInfoFromDlg(),d=this.pluginManager.getPluginByName("app-list");if(c.name){var e=new n;e.placeAt(this.saveAsPopup.domNode);e.startup();this._saveAs(c,a).then(h.hitch(this,function(){d&&window.isXT&&(c.isTemplate?d.refreshTemplatePage():d.refreshAppPage());e.destroy()}),function(){e.destroy()})}else new b({message:this.nls.noAppName})},_close:function(){this.saveAsPopup?(this.saveAsPopup.close(),
this.saveAsPopup=null):this.saveAsPage&&this.saveAsPage.destroy();this.createAppPopup&&(this.createAppPopup.close(),this.createAppPopup=null,this.createAppPage.destroy())},_saveAs:function(a,c){var e=new d;t.saveAs(a,c).then(h.hitch(this,function(c){if(c.success){var d=h.clone(a);d.id=c.newAppId;d.name=a.name;this._close();this.pluginManager.getPluginByName("startup").switchToAppConfig(d);e.resolve()}else new b({message:c.message}),e.reject()}),h.hitch(this,function(a){new b({message:a.message});
e.reject()}));return e},_onCreateNewClick:function(){var a=this.createAppPage._getAppInfoFromDlg(),c=this.pluginManager.getPluginByName("app-list");if(a.name){var d=new n;d.placeAt(this.createAppPopup.domNode);d.startup();this.createNewApp(a).then(h.hitch(this,function(){c&&window.isXT&&c.refreshAppPage();d.destroy();setTimeout(h.hitch(this,function(){this._close()}),300)}),function(){d.destroy()})}else new b({message:this.nls.noAppName})},_onCreateNewCancelClick:function(){this._close()},_getInitAppInfo:function(a){var b=
new d,c=this._getEmptyAppInfo();window.isXT?a?t.getAppInfo(a).then(h.hitch(this,function(a){c.name=a.name+this.nls._copy;c.description=a.description;c.appType=a.appType;c.isTemplate=a.isTemplate;c.thumbnail=a.thumbnail;b.resolve(c)}),h.hitch(this,function(a){console.error(this.nls.saveAsFaied,a);b.reject()})):b.resolve(c):a?g.getPortal(u.getPortalUrlFromLocation()).getItemById(a).then(h.hitch(this,function(a){c.name=a.title+this.nls._copy;c.tags=a.tags;c.description=a.snippet;b.resolve(c)}),h.hitch(this,
function(a){console.error(this.nls.saveAsFaied,a);b.reject()})):b.resolve(c);return b},_getEmptyAppInfo:function(){return{name:"",description:"",tags:["AppBuilder App"],folderId:"",sharing:!1,appType:window.appInfo.appType,webmap:null,fromAppId:null,creator:null,isPredefined:!0,isTemplate:!1,thumbnail:"/webappbuilder/builder/images/appthumbnail_2d.jpg",icon:"/webappbuilder/builder/images/logo.png"}},_shareAppWithWebmapOrWebscene:function(a,e,f){var k=g.getPortal(u.getPortalUrlFromLocation()),l=new d,
n=new d,m=new d,p=new d;k.getUser().then(h.hitch(this,function(a){l.resolve(a)}),h.hitch(this,function(a){new b({message:this.nls.createAppUrlError});console.error(a.message);l.reject()}));k.getItemById(f).then(h.hitch(this,function(a){n.resolve(a)}),h.hitch(this,function(a){new b({message:this.nls.createAppUrlError});console.error(a.message);n.reject(a)}));c({user:l,userItem:m}).then(h.hitch(this,function(c){var d={};switch(c.userItem.sharing.access){case "public":d.everyone=!0;d.groups=c.userItem.sharing.groups.toString();
break;case "account":case "org":d.org=!0;d.groups=c.userItem.sharing.groups.toString();break;case "shared":d.groups=c.userItem.sharing.groups.toString()}c.user.shareItem(d,a,e).then(h.hitch(this,function(a){p.resolve(a)}),h.hitch(this,function(a){new b({message:this.nls.createAppUrlError});console.error(a.message);p.reject()}))}));c({user:l,webmapItem:n}).then(h.hitch(this,function(c){if(c.webmapItem.owner===c.user.username)c.user.getItemById(f,c.webmapItem.ownerFolder).then(h.hitch(this,function(a){m.resolve(a)}),
h.hitch(this,function(a){new b({message:this.nls.createAppUrlError});console.error(a.message);m.reject(a)}));else{var d={};switch(c.webmapItem.access){case "public":d.everyone=!0;break;case "account":case "org":d.org=!0}c.user.shareItem(d,a,e).then(h.hitch(this,function(a){p.resolve(a)}),h.hitch(this,function(a){new b({message:this.nls.createAppUrlError});console.error(a.message);p.reject()}))}}))}})})},"builder/plugins/creation-entry/SaveAsPage":function(){define(["dojo/_base/declare","builder/BasePlugin",
"dijit/_WidgetsInTemplateMixin","dojo/text!./SaveAsPage.html","builder/dijit/ItemInfo"],function(r,l,d,q,k){return r([l,d],{templateString:q,baseClass:"saveas-app-page",fromAppId:null,appInfo:null,appType:null,_stemappExtensions:null,webmap:null,postMixInProperties:function(){this.inherited(arguments)},postCreate:function(){this.inherited(arguments)},startup:function(){window.isXT?(this.appInfo.tags=void 0,this.appInfo.folderId=void 0,this.appInfo.sharing=void 0):this.fromAppId&&(this.appInfo.sharing=
void 0,this.appInfo.thumbnail=void 0);this.itemInfoDijit=new k({itemInfo:this.appInfo});this.itemInfoDijit.placeAt(this.itemInfoBox)},_getAppInfoFromDlg:function(){var d=this.itemInfoDijit.getProperties();d.appType=this.appInfo.appType;d.webmap=this.webmap;d.fromAppId=this.fromAppId;d.isPredefined="default"!==this.fromAppId&&this.fromAppId?!1:!0;d.isTemplate=this.appInfo.isTemplate?!0:!1;d.saveAsTemplate=!1;return d}})})},"builder/plugins/creation-entry/CreateNewAppPage":function(){define("dojo/_base/declare dojo/_base/array dojo/_base/html builder/BasePlugin dojo/dom-style dijit/_WidgetsInTemplateMixin dojo/text!./CreateNewAppPage.html dojo/query dojo/on dojo/dom-class dojo/_base/lang dojo/Evented builder/dijit/EditItemInfo builder/serviceUtils jimu/portalUrlUtils builder/portalUtils jimu/utils".split(" "),
function(r,l,d,q,k,m,p,h,e,c,b,a,g,u,n,t,f){return r([q,m,a],{templateString:p,baseClass:"create-app-page",appInfo:null,pluginManager:null,postMixInProperties:function(){this.inherited(arguments)},postCreate:function(){this.inherited(arguments)},startup:function(){"undefined"===typeof this.isPortalSupport3D&&(this.isPortalSupport3D=!1);this.isPortalSupport3D=!!this.isPortalSupport3D;this.initAppInfoPage();this.createFromAppInfo?(this.selectedApp=this.createFromAppInfo,this._displaySecondPage(),this._hideButton(1)):
(this.initAppSelectPage(),this._displayFirstPage())},destroy:function(){this.itemInfoDijit&&(this.itemInfoDijit.destroy(),this.itemInfoDijit=null);this.popup&&(this.popup=null);d.destroy(this.domNode);this.inherited(arguments)},initAppSelectPage:function(){this._stemappExtensions=this.pluginManager.getExtensions("startup.stemapps");this._stemappExtensions.sort(function(a,b){return a.parameters.index-b.parameters.index});u.getTemplateList(!0).then(b.hitch(this,function(a){var c=this._filterInfosByIsPortalSupport3D(a);
l.forEach(c,function(a){!a.id||"HTML_default"!==a.id&&"HTML3D_default"!==a.id?this._createAppNodeAndBindEvent(a,this.othersApps):("HTML_default"===a.id?a.name=this.nls.Default2D:"HTML3D_default"===a.id&&(a.name=this.nls.Default3D),this._createAppNodeAndBindEvent(a,this.defaultApps))},this);this._selecteApp(h(".app-image-border-div",this.allAppContent)[0]);c=n.getStandardPortalUrl(window.portalUrl);t.getPortal(c).getUser().then(b.hitch(this,function(b){var c=l.filter(a,function(a){return a.isTemplate&&
a.creator===b.username}),c=this._filterInfosByIsPortalSupport3D(c);l.forEach(c,function(a){this._createAppNodeAndBindEvent(a,this.ownAppContent)},this)}))}))},_filterInfosByIsPortalSupport3D:function(a){var b=this.isPortalSupport3D;return l.filter(a,function(a){return!1===b?"HTML3D"!==a.appType:!0})},initAppInfoPage:function(){this.itemInfoDijit=new g({itemInfo:this.appInfo,nls:this.nls});this.itemInfoDijit.placeAt(this.appInfoTable)},_createAppNode:function(a,b,c){this.zIndex=10;b=d.create("div",
{"class":"app-node jimu-float-leading",style:c},b);c=d.create("div",{"class":"app-image-border-div"},b);d.create("div",{"class":"app-image-div",style:{backgroundImage:"url("+a.thumbnail+")"}},c);var e;"HTML"===a.appType?e="2D":"HTML3D"===a.appType&&(e="3D");e=d.create("div",{"class":"flag-image flag-image-"+e},c);k.set(e,"z-index",this.zIndex++);d.create("div",{"class":"app-name",innerHTML:f.stripHTML(a.name),title:f.stripHTML(a.name)},b);return c},_createAppNodeAndBindEvent:function(a,c){var d=this._createAppNode(a,
c);this.own(e(d,"click",b.hitch(this,this._onAppNodeClick,d)));d.appInfo=a;return d},_onAppNodeClick:function(a){var b=h(".app-image-border-div",this.appSelectPage);l.forEach(b,function(a){this._unselecteApp(a)},this);this._selecteApp(a)},_selecteApp:function(a){this.selectedApp=a.appInfo;c.add(a,"jimu-state-active")},_unselecteApp:function(a){c.remove(a,"jimu-state-active")},_onAllAppBtnClick:function(){var a=h(".app-image-border-div",this.allAppContent)[0];a&&this._onAppNodeClick(a);d.setStyle(this.allAppContent,
"display","block");d.setStyle(this.ownAppContent,"display","none");d.addClass(this.allAppBtn,"selected");d.removeClass(this.ownAppBtn,"selected")},_onOwnAppBtnClick:function(){var a=h(".app-image-border-div",this.ownAppContent)[0];a&&this._onAppNodeClick(a);d.setStyle(this.allAppContent,"display","none");d.setStyle(this.ownAppContent,"display","block");d.addClass(this.ownAppBtn,"selected");d.removeClass(this.allAppBtn,"selected")},_onNextClick:function(){this._displaySecondPage();"HTML"===this.selectedApp.appType?
this.itemInfoDijit.imageChooser.setDefaultSelfSrc("/webappbuilder/builder/images/appthumbnail_2d.jpg"):this.itemInfoDijit.imageChooser.setDefaultSelfSrc("/webappbuilder/builder/images/appthumbnail_3d.jpg")},_onBackClick:function(){this._displayFirstPage()},_displayFirstPage:function(){d.setStyle(this.appInfoPage,"display","none");d.setStyle(this.appSelectPage,"display","block");this._displayButtion(0);this._hideButton(1);this._hideButton(2);this.popup&&this.popup.resize()},_displaySecondPage:function(){d.setStyle(this.appSelectPage,
"display","none");d.setStyle(this.appInfoPage,"display","block");this._hideButton(0);this._displayButtion(1);this._displayButtion(2);this.popup&&this.popup.resize();this.itemInfoDijit&&this.itemInfoDijit.focusItemByName("appName")},setPopup:function(a){this.popup=a},_hideButton:function(a){d.setStyle(this.popup.enableButton(a),"display","none")},_displayButtion:function(a){d.setStyle(this.popup.enableButton(a),"display","inline-block")},_getAppInfoFromDlg:function(){var a=this.itemInfoDijit.getProperties();
a.appType=this.selectedApp.appType;a.webmap=this.webmap;a.fromAppId=this.selectedApp.id;a.isPredefined=!1;a.isTemplateApp=this.selectedApp.isTemplate;0===a.icon.indexOf("/webappbuilder/builder/images/")&&(a.icon=null);0===a.thumbnail.indexOf("/webappbuilder/builder/images/")&&(a.thumbnail=null);return a}})})},"builder/plugins/header/_build-generate_module":function(){define(["builder/plugins/header/Plugin","dojo/text!builder/plugins/header/Plugin.html","dojo/text!builder/plugins/header/css/style.css",
"dojo/i18n!builder/plugins/header/nls/strings"],function(){})},"builder/plugins/header/Plugin":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/html dojo/on dojo/topic dojo/Deferred dojo/request dojo/request/script builder/portalUtils jimu/portalUrlUtils builder/tokenUtils jimu/utils builder/BasePlugin dojo/_base/config".split(" "),function(r,l,d,q,k,m,p,h,e,c,b,a,g,u){return r([g],{baseClass:"plugin-header",_trainingUrls:{administrator:"//www.esri.com/training/main/arcgis-online-administrators",
publisher:"//www.esri.com/training/main/arcgis-online-publishers",user:"//www.esri.com/training/main/arcgis-online-users","public":"//www.esri.com/training/main/arcgis-online-training",custom:"//www.esri.com/training/main/arcgis-online-training"},_esriCommunityLink:"https://community.esri.com",_myEsriLink:"https://my.esri.com",postCreate:function(){this.inherited(arguments);this._initSelf()},_initSelf:function(){this._isWebTier(window.portalUrl).then(l.hitch(this,function(a){a&&d.setStyle(this.signOutItem,
"display","none")}));window.isXT?(d.addClass(this.domNode,"xt"),d.destroy(this.homeSection),this._bindXtEvents()):(d.addClass(this.homeLabel,"js-home-dropdown"),d.destroy(this.switchSection),this._bindIntegratedEvents(window.portalUrl));var a=e.getPortal(window.portalUrl);a.haveSignIn()&&a.getUser().then(l.hitch(this,function(a){if(a){!window.isXT&&a.privileges&&0<=a.privileges.indexOf("portal:user:viewOrgUsers")&&d.removeClass(this.organizationItem,"hidden");var b=a.firstName||a.username;b&&(this.userNameNode.innerHTML=
b);if(a.thumbnail&&(b=c.getUserThumbnailUrl(window.portalUrl,a.username,a.thumbnail))){var e=a.credential&&a.credential.token;e&&(b+="?token\x3d"+e);this.userIcon.src=b;this.profileImg.src=b}this.profileNameNode.innerHTML=a.username;c.isOnline(window.portalUrl)?(b="",b=a.isAdminRole()?this._trainingUrls.administrator:a.isPublisherRole()?this._trainingUrls.publisher:a.isUserRole()?this._trainingUrls.user:this._trainingUrls.custom,this.trainingNode.href=b,d.removeClass(this.trainingNode,"hidden"),"both"===
a.userType&&(this.communityNode.href=this._esriCommunityLink,this.myesriNode.href=this._myEsriLink,d.removeClass(this.communityNode,"hidden"),d.removeClass(this.myesriNode,"hidden"))):a.isAdminRole()&&(this.adminHelpNode.href=c.getPortalAdminHelpUrl(window.portalUrl,u.locale),d.removeClass(this.adminHelpNode,"hidden"))}}),l.hitch(this,function(a){console.error(a)}))},_isWebTier:function(a){var c=new m,d=esri.id.findServerInfo(a);d&&d.webTierAuth?c.resolve(!0):c=b.isWebTierPortal(a);return c},_isUserMenuShow:function(){return d.hasClass(this.userSection,
"is-active")},_showUserMenu:function(){d.addClass(this.userSection,"is-active")},_hideUserMenu:function(){d.removeClass(this.userSection,"is-active")},_bindXtEvents:function(){this.own(q(document.body,"click",l.hitch(this,function(a){a=a.target||a.srcElement;a===this.userSection||d.isDescendant(a,this.userSection)||this._hideUserMenu()})));this.own(k.subscribe("iframeClick",l.hitch(this,function(){this._hideUserMenu()})));this.own(k.subscribe("userSignOut",l.hitch(this,function(){this.userNameNode.innerHTML=
""})));this.own(k.subscribe("userSignIn",l.hitch(this,function(a){this.userNameNode.innerHTML=a.userId||""})));this.logoTitle.title=this.nls.backToHomePage||"";this.own(q(this.logoTitle,"click",l.hitch(this,function(a){a.preventDefault();d.hasClass(this.domNode,"app-opened")&&this.pluginManager.getPluginByName("startup").switchToAppList()})));this.own(q(this.profileItem,"click",l.hitch(this,function(){var a=l.hitch(this,function(){window.location.href=c.getHomeUserUrl(window.portalUrl)});this._isInConfig()?
k.publish("closeAppConfigPage",a):a()})));this.helpNode.href="help";this.signOutItem&&this.own(q(this.signOutItem,"click",l.hitch(this,function(){var d=l.hitch(this,function(){this.userNameNode.innerHTML="";b.signOutAll();var d=c.getOAuth2SignOutUrl(window.portalUrl),d=c.setHttpsProtocol(d),e=function(){var b=a.getLocationUrlWithoutHashAndQueryParams(),b=a.url.addQueryParamToUrl(b,"action","setportalurl");window.location.href=b};this._getSigninInfo(window.portalUrl).then(function(a){if(a.success&&
a.info&&a.info.portalUrl&&a.info.supportsOAuth)try{h.get(d).always(function(){e()})}catch(x){console.error(x),e()}else e()},function(){e()})});this._isInConfig()?k.publish("closeAppConfigPage",d):d()})));this.own(q(window,"resize",l.hitch(this,function(){this._calculateWidth()})));this.own(q(this.appSwitch,"click",l.hitch(this,this._onAppsClicked)));this.own(q(this.templateSwitch,"click",l.hitch(this,this._onTemplatesClicked)));this._calculateWidth()},_calculateWidth:function(){1816>=window.innerWidth?
d.addClass(this.domNode,"width-less1816"):d.removeClass(this.domNode,"width-less1816")},_getSigninInfo:function(a){return p("/webappbuilder/rest/signininfo/getsignininfo",{handleAs:"json",query:"portalUrl\x3d"+a,method:"GET"})},_bindIntegratedEvents:function(a){c.isOnline(window.portalUrl)&&(d.removeClass(this.switchAccountsNode,"hidden"),this.switchAccountsNode.href=c.getSwitchAccoutnsUrl(window.portalUrl,"arcgisonline",""));this.own(q(document.body,"click",l.hitch(this,function(a){a=a.target||a.srcElement;
a!==this.homeLabel&&d.removeClass(this.homeSection,"is-active");a===this.userSection||d.isDescendant(a,this.userSection)||this._hideUserMenu()})));this.own(k.subscribe("iframeClick",l.hitch(this,function(){d.removeClass(this.homeSection,"is-active");this._hideUserMenu()})));this.own(q(this.homeLabel,"click",l.hitch(this,function(a){a.preventDefault();d.hasClass(this.homeSection,"is-active")?d.removeClass(this.homeSection,"is-active"):d.addClass(this.homeSection,"is-active")})));this.own(q(this.homeItem,
"click",l.hitch(this,function(){k.publish("closeAppConfigPage",function(){window.location.href=c.getHomeIndexUrl(a)})})));this.own(q(this.galleryItem,"click",l.hitch(this,function(){k.publish("closeAppConfigPage",function(){window.location.href=c.getHomeGalleryUrl(a)})})));this.own(q(this.mapItem,"click",l.hitch(this,function(){window.appConfig&&window.appConfig.map&&k.publish("closeAppConfigPage",function(){window.location.href=c.getHomeMapViewerUrl(window.appConfig.map.portalUrl||window.appConfig.portalUrl,
window.appConfig.map.itemId)})})));this.own(q(this.sceneItem,"click",l.hitch(this,function(){window.appConfig&&window.appConfig.map&&k.publish("closeAppConfigPage",function(){window.location.href=c.getHomeSceneViewerUrl(window.appConfig.map.portalUrl||window.appConfig.portalUrl)})})));this.own(q(this.groupsItem,"click",l.hitch(this,function(){k.publish("closeAppConfigPage",function(){window.location.href=c.getHomeGroupsUrl(a)})})));this.own(q(this.contentItem,"click",l.hitch(this,function(){k.publish("closeAppConfigPage",
function(){window.location.href=c.getHomeMyContentUrl(a)})})));this.own(q(this.organizationItem,"click",l.hitch(this,function(){k.publish("closeAppConfigPage",function(){window.location.href=c.getHomeMyOrganizationUrl(a)})})));this.own(q(this.profileItem,"click",l.hitch(this,function(){k.publish("closeAppConfigPage",function(){window.location.href=c.getHomeUserUrl(a)})})));0<=a.toLowerCase().indexOf(".arcgis.com")?this.helpNode.href="http://doc.arcgis.com/en/web-appbuilder/":this.helpNode.href=c.getPortalHelpUrl(a,
u.locale);this.signOutItem&&this.own(q(this.signOutItem,"click",l.hitch(this,function(){k.publish("closeAppConfigPage",function(){if(c.isOnline(window.portalUrl)){var a=c.getSwitchAccoutnsUrl(window.portalUrl,"arcgisonline","");window.location.href=a+"\x26signout\x3dtrue"}else b.signOutAll(),window.location.href=c.getPortalSignInUrlFromLocation()})})))},setAppName:function(a){a=a||"";(this.appName.innerHTML=a)?(window.isXT?this.logoTitle.title=this.nls.backToHomePage||"":d.setStyle(this.logoTitle,
"color","#4c4c4c"),d.addClass(this.domNode,"app-opened"),d.removeClass(this.domNode,"app-not-opened"),window.isXT||(d.setAttr(this.appName,"href",window.portalUrl+"/home/item.html?id\x3d"+window.appInfo.id),d.setAttr(this.appName,"title",this.nls.showItemDetails),d.addClass(this.appName,"highlight"))):(this.logoTitle.title="",d.removeClass(this.domNode,"app-opened"),d.addClass(this.domNode,"app-not-opened"))},getAppName:function(){return this.appName.innerHTML||""},_isInConfig:function(){return"appconfig"===
this.pluginManager.getPluginByName("startup").getCurrentView().label},_onUserSectionClicked:function(a){a=a.target||a.srcElement;var b=!0;if(d.isDescendant(a,this.userInfoDom)||a===this.userInfoDom)this._isUserMenuShow()||(b=!1);b?this._hideUserMenu():this._showUserMenu()},_onAppsClicked:function(){d.removeClass(this.templateSwitch,"selected");d.addClass(this.appSwitch,"selected");k.publish("switchToAppListApps")},_onTemplatesClicked:function(){d.removeClass(this.appSwitch,"selected");d.addClass(this.templateSwitch,
"selected");k.publish("switchToAppListTemplates")}})})},"builder/plugins/map-config/_build-generate_module":function(){define(["builder/plugins/map-config/Plugin","dojo/text!builder/plugins/map-config/Plugin.html","dojo/text!builder/plugins/map-config/css/style.css","dojo/i18n!builder/plugins/map-config/nls/strings"],function(){})},"builder/plugins/map-config/Plugin":function(){define("dojo/on dojo/keys dojo/json dojo/topic dojo/Deferred dojo/_base/lang dojo/_base/array dojo/_base/html dojo/_base/query dojo/_base/event dojo/promise/all dojo/dom-construct dojo/_base/declare dojo/text!./Plugin.html dijit/_WidgetsInTemplateMixin builder/BasePlugin builder/portalUtils jimu/Role jimu/utils jimu/dijit/Popup jimu/portalUrlUtils jimu/dijit/Message ./MapSelector ./CustomizeScale builder/dijit/RefreshInterval".split(" "),
function(r,l,d,q,k,m,p,h,e,c,b,a,g,u,n,t,f,v,x,w,z,A,y,B){return g([t,n],{templateString:u,baseClass:"map-config",appConfig:null,map:null,sceneView:null,item:null,widgetsConfigCache:null,postMixInProperties:function(){var a=m.clone(window.builderNls);this.nls=m.mixin(a,this.nls);this.nls.scaleDisabledTip2=this.nls.scaleDisabledTip.replace("${scaleTitle}",'"'+this.nls.scaleTitle+'"');this._is3D()?(this.nls.clickChooseWebMapOrWebScene=this.nls.clickChooseWebScene,this.nls.chooseWebMapOrWebScene=this.nls.chooseWebScene):
(this.nls.clickChooseWebMapOrWebScene=this.nls.clickChooseWebMap,this.nls.chooseWebMapOrWebScene=this.nls.selectWebMap)},postCreate:function(){this.inherited(arguments);this._init()},destroy:function(){this.appConfigPlugin=null;this.inherited(arguments)},_is3D:function(){return"HTML3D"===window.appInfo.appType},_init:function(){this.widgetsConfigCache={};this.own(q.subscribe("app/appConfigChanged",m.hitch(this,this.appConfigChanged)));this.own(q.subscribe("app/appConfigLoaded",m.hitch(this,this.appConfigLoaded)));
this.own(q.subscribe("app/mapLoaded",m.hitch(this,function(a){this._setMap(a)})));this.own(q.subscribe("app/mapChanged",m.hitch(this,function(a){this._setMap(a);this.refreshIntervalDijit.reset()})));this.own(q.subscribe("app/sceneViewLoaded",m.hitch(this,function(a){this.sceneView=a})));this.own(q.subscribe("app/sceneViewChanged",m.hitch(this,function(a){this.sceneView=a})));this.appConfigPlugin=this.pluginManager.getPluginByName("app-config");this.embeddedMapViewerHelper={portalUrl:void 0,container:void 0,
popup:void 0,webmapId:void 0,frameName:"embeddedMapViewer",hideItems:"hide\x3dshare,lnk,analysis,directions",params:"embedded\x3d1\x26locale\x3d"+dojoConfig.locale,loadingShelter:void 0,loaded:void 0,hasUnsavedChanged:void 0,readyToClose:void 0,loadInterval:void 0,unsavedInterval:void 0,webmapIdInterval:void 0,isClosing:!1};this.own(r(window,"message",m.hitch(this,this.receiveViewerMessage)));this._is3D()?h.addClass(this.mapOptions3D,"enabled"):(h.addClass(this.mapOptions2D,"enabled"),this.own(r(this.refreshIntervalDijit,
"user-input-change",m.hitch(this,this._onRefreshIntervalChange))))},_onRefreshIntervalChange:function(a){q.publish("mapRefreshIntervalChanged",a)},_setInitialExtent:function(){try{q.publish("mapOptionsChanged",{extent:this.map.extent.toJson()})}catch(C){console.error(C)}},_blinkMapContainer:function(){var a=null;if(a=this._is3D()?this.sceneView.container:this.map.container){var b=h.create("div");h.addClass(b,"blink-map-border");h.place(b,a);var c=0,d=setInterval(m.hitch(this,function(){h.toggleClass(b,
"blink-map-border-show");c++;6===c&&(b.parentNode.removeChild(b),clearInterval(d))}),200)}},_useCurrentMapExtent:function(){this.map&&(this._setInitialExtent(),this._blinkMapContainer())},_useDefaultMapExtent:function(a){x.restoreToDefaultWebMapExtent(this.map,this.map.webMapResponse,this.appConfig&&this.appConfig.geometryService).then(m.hitch(this,function(){this._setInitialExtent();a&&this._blinkMapContainer()}),m.hitch(this,function(a){"string"===typeof a&&new A({message:a});console.error(a)}))},
showMapSelector:function(){this.hideMapOptions();var a=new y({nls:this.nls,type:"HTML3D"===window.appInfo.appType?"Web Scene":"Web Map"}),b=new w({width:1024,titleLabel:this.nls.chooseWebMapOrWebScene,content:a,container:"main-page",onClose:m.hitch(this,function(){try{a&&a.domNode&&a.destroy()}catch(D){console.error(D)}a=null;return!0}),buttons:[{label:this.nls.ok,key:l.ENTER,classNames:["map-selector-btn-ok"],onClick:m.hitch(this,function(){var c=a.getSelectedMapItem();this._selectItem(c,b)})},{label:this.nls.cancel,
key:l.ESCAPE,classNames:["map-selector-btn-cancel","jimu-btn-vacation"],onClick:m.hitch(this,function(){b.close()})}]})},embedWebMap:function(b,c,d){this.embeddedMapViewerHelper.portalUrl=z.getStandardPortalUrl(b);b=this.embeddedMapViewerHelper.portalUrl+"/home/webmap/viewer.html?"+(d?"webmap\x3d"+d+"\x26":"")+this.embeddedMapViewerHelper.params+"\x26"+this.embeddedMapViewerHelper.hideItems;d=f.getPortal(this.embeddedMapViewerHelper.portalUrl);b+="#"+d.credential.token;this.embeddedMapViewerHelper.container=
a.create("div",{"class":"embed-mapviewer-content"});a.create("iframe",{src:b,name:this.embeddedMapViewerHelper.frameName,style:"width:100%;height:99%"},this.embeddedMapViewerHelper.container);this.embeddedMapViewerHelper.loadingShelter=a.create("div",{"class":"load-container map-loading"},this.embeddedMapViewerHelper.container);h.setStyle(this.embeddedMapViewerHelper.loadingShelter,"display","block");c=new w({titleLabel:c,content:this.embeddedMapViewerHelper.container,container:"main-page",onClose:m.hitch(this,
function(){if(!0===this.embeddedMapViewerHelper.readyToClose)return!0;this._closeEmbeddedMapViewer();return!1})});h.setStyle(c.domNode,{top:"5%",left:"5%",width:"90%",height:"90%"});c.startup();this.embeddedMapViewerHelper.popup=c;this.embeddedMapViewerHelper.loaded=!1;this.embeddedMapViewerHelper.readyToClose=!1;this.embeddedMapViewerHelper.isClosing=!1;this.embeddedMapViewerHelper.loadInterval=setInterval(m.hitch(this,function(){this.embeddedMapViewerHelper.loaded?(h.setStyle(this.embeddedMapViewerHelper.loadingShelter,
"display","none"),clearInterval(this.embeddedMapViewerHelper.loadInterval),this.embeddedMapViewerHelper.loadInterval=null):this.sendPostMessage({type:"isLoaded"})}),500)},showMapOptions:function(a){c.stop(a);h.setStyle(this.webMapEditOptions,"display","");h.setStyle(this.webMapOptionsMask,"display","")},hideMapOptions:function(){h.setStyle(this.webMapEditOptions,"display","none");h.setStyle(this.webMapOptionsMask,"display","none")},editWebMap:function(){this.hideMapOptions();this.embedWebMap(this.appConfig.map.portalUrl,
this.nls.editMap,this.appConfig.map.itemId)},createWebMap:function(){this.hideMapOptions();this.embedWebMap(this.appConfig.portalUrl,this.nls.createMap)},_closeEmbeddedMapViewer:function(){this.embeddedMapViewerHelper.isClosing||(this.embeddedMapViewerHelper.isClosing=!0,h.setStyle(this.embeddedMapViewerHelper.loadingShelter,"display",""),this.embeddedMapViewerHelper.loaded?(this.embeddedMapViewerHelper.hasUnsavedChanged=void 0,this.embeddedMapViewerHelper.unsavedInterval=setInterval(m.hitch(this,
function(){if("undefined"===typeof this.embeddedMapViewerHelper.hasUnsavedChanged)this.sendPostMessage({type:"hasUnsavedChanges"});else if(clearInterval(this.embeddedMapViewerHelper.unsavedInterval),this.embeddedMapViewerHelper.unsavedInterval=null,this.embeddedMapViewerHelper.hasUnsavedChanged)var a=new w({content:this.nls.hasUnsavedChanges,titleLabel:this.nls.customMap,autoHeight:!0,width:600,buttons:[{label:this.nls.ok,onClick:m.hitch(this,function(){a.close();this._doCloseEmbeddedMapViewer()})},
{label:this.nls.cancel,onClick:m.hitch(this,function(){h.setStyle(this.embeddedMapViewerHelper.loadingShelter,"display","none");this.embeddedMapViewerHelper.isClosing=!1;a.close()})}]});else this._doCloseEmbeddedMapViewer()}),500)):this._doCloseEmbeddedMapViewer())},_doCloseEmbeddedMapViewer:function(){h.setStyle(this.embeddedMapViewerHelper.loadingShelter,"display","none");this.embeddedMapViewerHelper.loadInterval&&(clearInterval(this.embeddedMapViewerHelper.loadInterval),this.embeddedMapViewerHelper.loadInterval=
null);this.embeddedMapViewerHelper.unsavedInterval&&(clearInterval(this.embeddedMapViewerHelper.unsavedInterval),this.embeddedMapViewerHelper.unsavedInterval=null);this.embeddedMapViewerHelper.loaded?(this.embeddedMapViewerHelper.webmapId=void 0,this.sendPostMessage({type:"getWebmapId"}),this.embeddedMapViewerHelper.webmapIdInterval=setInterval(m.hitch(this,function(){"undefined"!==typeof this.embeddedMapViewerHelper.webmapId&&(clearInterval(this.embeddedMapViewerHelper.webmapIdInterval),this.embeddedMapViewerHelper.webmapIdInterval=
null,a.destroy(this.embeddedMapViewerHelper.container),this.embeddedMapViewerHelper.container=null,this.embeddedMapViewerHelper.readyToClose=!0,this.embeddedMapViewerHelper.popup.close(),this.embeddedMapViewerHelper.webmapId&&f.getPortal(this.embeddedMapViewerHelper.portalUrl).getItemById(this.embeddedMapViewerHelper.webmapId).then(m.hitch(this,function(a){this._updateWebMap(a)})))}),500)):(a.destroy(this.embeddedMapViewerHelper.container),this.embeddedMapViewerHelper.container=null,this.embeddedMapViewerHelper.readyToClose=
!0,this.embeddedMapViewerHelper.popup.close())},sendPostMessage:function(a){this.embeddedMapViewerHelper.portalUrl&&window.frames[this.embeddedMapViewerHelper.frameName]&&window.frames[this.embeddedMapViewerHelper.frameName].postMessage(d.stringify(a),this.embeddedMapViewerHelper.portalUrl)},receiveViewerMessage:function(a){console.log("received",a.origin,a.data);if(!(0>this.embeddedMapViewerHelper.portalUrl.indexOf(a.origin)))switch(a=d.parse(a.data),a.type){case "webmapId":this.embeddedMapViewerHelper.webmapId=
a.webmapId;break;case "loaded":this.embeddedMapViewerHelper.loaded=a.value;break;case "unsavedChanges":this.embeddedMapViewerHelper.hasUnsavedChanged=a.value;break;case "message":console.log(a.message)}},_selectItem:function(a,b){a&&(this._hasSameWebMap(this.appConfig,{map:{portalUrl:a.portalUrl,itemId:a.id}})?b.close():this._updateWebMap(a,b))},_updateWebMap:function(a,b){var c=this.appConfig,c=this._getHttpWebMapItemUrl(c.map.portalUrl||c.portalUrl,c.map.itemId);this.widgetsConfigCache[c]||(this.widgetsConfigCache[c]=
{});var d=this.widgetsConfigCache[c],f=m.clone(this.appConfig);f.map.portalUrl=a.portalUrl;f.map.itemId=a.id;var g=this._tryResetWidgetsConfigWhenMapSwitched(f);if(0<g.length){var c=p.map(g,m.hitch(this,function(a){return a.label})),k=h.toDom("\x3cdiv style\x3d'font-size:14px;line-height:22px;'\x3e\x3cdiv\x3e"+this.nls.mapSwitchConfimationTip+"\x3c/div\x3e\x3cdiv style\x3d'margin-top:25px;margin-bottom:20px;color:#596679;'\x3e"+this.nls.theseWidgetsAre+":\x3c/div\x3e\x3cul class\x3d'reset-widget-list' style\x3d'color:#596679;'\x3e\x3c/ul\x3e\x3cdiv style\x3d'margin-top:25px;'\x3e"+
this.nls.sureToSwitch+"\x3c/div\x3e\x3c/div\x3e"),l=e(".reset-widget-list",k)[0];p.forEach(c,m.hitch(this,function(a,b){var c=h.create("li",{innerHTML:a},l);0!==b&&(c.style.marginTop="8px")}));var n=new w({content:k,titleLabel:this.nls.mapSwitchConfimation,autoHeight:!0,width:640,buttons:[{label:this.nls.ok,onClick:m.hitch(this,function(){b&&b.close();n.close();this.appConfigPlugin.showLoadingCover();q.publish("new-webmap-item-selected",a);q.publish("setAppConfig",f);p.forEach(g,m.hitch(this,function(a){d[a.id]=
a.config}))})},{label:this.nls.cancel,onClick:m.hitch(this,function(){n.close()})}]})}else b&&b.close(),this.appConfigPlugin.showLoadingCover(),this._publishMapChange(a)},_publishMapChange:function(a){q.publish("new-webmap-item-selected",a);this._is3D()?q.publish("sceneViewChanged",{portalUrl:a.portalUrl,itemId:a.id}):q.publish("mapChanged",{portalUrl:a.portalUrl,itemId:a.id})},_hasSameWebMap:function(a,b){var c=a&&a.map,d=c&&c.itemId,e=b&&b.map,f=e&&e.itemId;return z.isSamePortalUrl(c&&c.portalUrl,
e&&e.portalUrl)&&d===f},_setMap:function(a){this.map=a;this._checkCustomScaleAvailablity()},_updateChoseMapButtons:function(a){var c=this._checkUpdatePrivileges(a.map.portalUrl);a=this._checkUpdatePrivileges(a.portalUrl);b([c,a]).then(m.hitch(this,function(a){var b=a[0];a=a[1];b||a?(h.setStyle(this.mapOptions,"display",""),h.setStyle(this.chooseMapButton,"width","140px"),h.setStyle(this.chooseMapButton,"max-width","140px"),b?h.setStyle(this.btnEditWebMap,"display",""):h.setStyle(this.btnEditWebMap,
"display","none"),a?h.setStyle(this.btnCreateWebMap,"display",""):h.setStyle(this.btnCreateWebMap,"display","none")):(h.setStyle(this.mapOptions,"display","none"),h.setStyle(this.chooseMapButton,"width","100%"),h.setStyle(this.chooseMapButton,"max-width","100%"))}),m.hitch(this,function(){h.setStyle(this.mapOptions,"display","none");h.setStyle(this.chooseMapButton,"width","100%");h.setStyle(this.chooseMapButton,"max-width","100%")}))},_checkUpdatePrivileges:function(a){var b=new k;this._is3D()||!z.isSameServer(a,
window.location.host)?b.resolve(!1):f.getPortal(a).getUser().then(m.hitch(this,function(a){var c=!1;if(a){var d=new v({id:a.roleId?a.roleId:a.role,role:a.role});a.privileges&&(d.setPrivileges(a.privileges),c=d.canCreateItem())}b.resolve(c)}),m.hitch(this,function(a){console.error(a);b.resolve(!1)}));return b},appConfigLoaded:function(a){this.setAppConfig(a);this._is3D()||this.refreshIntervalDijit.setValue(a.map.mapRefreshInterval)},appConfigChanged:function(a){this.setAppConfig(a)},setAppConfig:function(a){if(this.appConfig){var b=
this._hasSameWebMap(this.appConfig,a);this.appConfig=a;b||this._requestCurrentItem()}else this.appConfig=a,this._requestCurrentItem();this._updateChoseMapButtons(this.appConfig)},_getHttpWebMapItemUrl:function(a,b){var c=z.getItemUrl(a,b);return c=z.setHttpProtocol(c)},_tryResetWidgetsConfigWhenMapSwitched:function(a){var b=[],c=this._getHttpWebMapItemUrl(a.map.portalUrl||a.portalUrl,a.map.itemId);this.widgetsConfigCache[c]||(this.widgetsConfigCache[c]={});var d=this.widgetsConfigCache[c];a.visitElement(m.hitch(this,
function(a){if(!a.widgets&&a.uri&&!1===a.keepConfigAfterMapSwitched){var c=a.config,e=d&&d[a.id];e?a.config=e:delete a.config;if(!a.isDefaultConfig||e)a=m.clone(a),a.config=c,b.push(a)}}));return b},_requestCurrentItem:function(){var a=this.appConfig&&this.appConfig.map&&this.appConfig.map.itemId;if(a){var a={q:"id:"+a,num:1,f:"json"},b=f.getPortal(this.appConfig.map&&this.appConfig.map.portalUrl);b&&b.queryItems(a).then(m.hitch(this,function(a){this.domNode&&(a=a.results,0<a.length&&this._showSelectedItem(a[0]))}),
m.hitch(this,function(a){console.debug("query item from portal failed",a)}))}},_tryLocaleDate:function(a){var b=x.localizeDate(a,{selector:"date"});b||(b=a.toLocaleDateString());return b},_showSelectedItem:function(a){this.item=a;var b=a.type.toLowerCase();h.empty(this.thumbnailContainer);h.removeClass(this.webItemIcon,"webmap");h.removeClass(this.webItemIcon,"webscene");this.webItemType.innerHTML=a.type;var c=h.create("div",{"class":"thumbnail"},this.thumbnailContainer);a.thumbnailUrl?h.setStyle(c,
"backgroundImage","url("+a.thumbnailUrl+")"):"web map"===b?h.addClass(c,"default-webmap"):"web scene"===b&&h.addClass(c,"default-webscene");"web map"===b?h.addClass(this.webItemIcon,"webmap"):"web scene"===b&&h.addClass(this.webItemIcon,"webscene");this.snippet.innerHTML=a.snippet||"";this.lastModified.innerHTML=this._tryLocaleDate(new Date(a.modified));this.lastModified.title=this.lastModified.innerHTML;this.webMapDetails.href=a.detailsPageUrl;b=a.owner||"";this.ownerName.innerHTML=b;this.ownerName.title=
b;this.ownerName.href=a.ownerPageUrl||"";this.mapTitle.innerHTML=a.title;this.mapTitle.title=a.title},_checkCustomScaleAvailablity:function(){this._isBasemapLayerSupportLods()?(h.removeClass(this.btnScale,"jimu-state-disabled"),this.btnScale.title=""):(h.addClass(this.btnScale,"jimu-state-disabled"),this.btnScale.title=this.nls.scaleDisabledTip2)},_isBasemapLayerSupportLods:function(){var a=!1;if(this.map){var b=this.map.layerIds;b&&0<b.length&&(a=(a=this.map.getLayer(b[0]))&&a.tileInfo&&a.tileInfo.lods)}return a},
_onBtnScaleClicked:function(){if(this._isBasemapLayerSupportLods())var a=new B({nls:this.nls,map:this.map}),b=new w({width:640,height:590,titleLabel:this.nls.scaleTitle,content:a,container:"main-page",onClose:m.hitch(this,function(){try{a&&a.domNode&&a.destroy()}catch(D){console.error(D)}a=null;return!0}),buttons:[{label:this.nls.ok,onClick:m.hitch(this,function(){var c=a.getLodsFromListNode(),d=a.getLodsFromMap();b.close();var e=!1,e=c.length===d.length?p.every(c,m.hitch(this,function(a,b){var c=
d[b],e=a.scale===c.scale,f=a.resolution===c.resolution;return a.level===c.level&&e&&f})):!1;e||(this.appConfigPlugin.showLoadingCover(),q.publish("mapOptionsChanged",{lods:c}))})},{label:this.nls.cancel,classNames:["jimu-btn-vacation"],onClick:m.hitch(this,function(){b.close()})}]})},_setInitialViewpoint:function(a){try{q.publish("mapOptionsChanged",{initialState:{viewpoint:a}})}catch(E){console.error(E)}},_useCurrentViewpoint:function(){if(this.sceneView){var a=this.sceneView.viewpoint.toJSON();
this._setInitialViewpoint(a);this._blinkMapContainer()}},_useDefaultViewpoint:function(){var a=this.sceneView.map.itemInfo.itemData.initialState.viewpoint,a=m.clone(a);this._setInitialViewpoint(a);this._blinkMapContainer()}})})},"builder/plugins/map-config/MapSelector":function(){define("dojo/_base/declare dojo/topic dijit/_WidgetBase dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dojo/text!./MapSelector.html dojo/_base/config dojo/_base/lang dojo/_base/array dojo/_base/html dojo/query dojo/on jimu/utils jimu/dijit/TabContainer3 jimu/portalUrlUtils jimu/dijit/Search builder/portalUtils ./MapTable dijit/form/Select".split(" "),
function(r,l,d,q,k,m,p,h,e,c,b,a,g,u,n,t,f,v){return r([d,q,k],{templateString:m,baseClass:"map-selector",tab:null,isPublicTabShow:!1,nls:null,type:"",_user:null,_group:null,_webMapQueryString:"",_allPublicPortalQuery:null,_filterPublicPortalQuery:null,_allPublicOnlineQuery:null,_filterPublicOnlineQuery:null,_allOrganizationQuery:null,_filterOrganizationQuery:null,_allMyContentQuery:null,_filterMyContentQuery:null,_allGroupQuery:null,_filterGroupQuery:null,_signIn:!1,portal:null,postCreate:function(){this.inherited(arguments);
this._webMapQueryString=" "+g.getItemQueryStringByTypes([this.type])+" ";this.portal=f.getPortal(this._getPortalUrl());this._initSearchQuery();this._initTabs();this._initPortalRadio();this._initMapTables();this._initPrivate();this._initPublic();this._bindMapTableEvents();this._updateUIbySignIn()},startup:function(){this.tab._started||(this.tab.startup(),this.tab._started=!0)},_initTabs:function(){var b={title:this.nls.myContent,content:this.mycontentTabNode},d={title:this.nls.myOrganization,content:this.organizationTabNode},
e={title:this.nls.myGroup,content:this.groupTabNode},f={title:this.nls.publicMap,content:this.publicTabNode};this.isPublicTabShow=!1;this.tab=new u({tabs:[b,d,e,f]},this.tabNode);this.own(a(this.tab,"tabChanged",h.hitch(this,function(a){c.addClass(this.signinSection,"hidden");a!==this.nls.publicMap?(this.isPublicTabShow=!1,this._updateUIbySignIn(),this.portal.getUser().then(h.hitch(this,function(b){a===this.nls.myContent?this._searchMyContent(b):a===this.nls.myOrganization?this._searchOrganization(b):
a===this.nls.myGroup&&this._searchGroups(b)}))):(this.isPublicTabShow=!0,this._searchPublic())})))},_bindMapTableEvents:function(){this.own(a(this.mycontentMapTable,"select",h.hitch(this,this._onMapSelected)));this.own(a(this.organizationMapTable,"select",h.hitch(this,this._onMapSelected)));this.own(a(this.groupMapTable,"select",h.hitch(this,this._onMapSelected)));this.own(a(this.publicPortalMapTable,"select",h.hitch(this,this._onMapSelected)));this.own(a(this.publicOnlineMapTable,"select",h.hitch(this,
this._onMapSelected)))},_onMapSelected:function(a){if(a=a&&a.selectedNode)this.mycontentMapTable.unselect(),this.organizationMapTable.unselect(),this.groupMapTable.unselect(),this.publicPortalMapTable.unselect(),this.publicOnlineMapTable.unselect(),c.addClass(a,"selected")},_updateUIbySignIn:function(){c.addClass(this.signinSection,"hidden");var a=b(".organization-tab-content-main,.group-tab-content-main,.mycontent-tab-content-main",this.domNode);this.portal.haveSignIn()?a.removeClass("hidden"):(a.addClass("hidden"),
this.isPublicTabShow||c.removeClass(this.signinSection,"hidden"))},_initPortalRadio:function(){g.combineRadioCheckBoxWithLabel(this.portalPublicRaido,this.portalNameLabel);g.combineRadioCheckBoxWithLabel(this.onlinePublicRaido,this.onlineNameLabel);var a=this._getPortalUrl(),a=n.getServerByUrl(a);n.isArcGIScom(a)?(this.portalPublicRaido.disabled=!0,this.onlinePublicRaido.checked=!0,c.addClass(this.portalPublicRaido,"hidden"),c.addClass(this.portalNameLabel,"hidden")):(this.portalPublicRaido.disabled=
!1,this.portalPublicRaido.checked=!0,this.portalNameLabel.innerHTML=a)},_initSearchQuery:function(){var a="esri_"+(p.locale&&p.locale.slice(0,2)||"en").toLowerCase(),b=e.filter("esri_he esri_fr esri_ja esri_nl esri_th esri_tr esri_nb esri_ro esri_it esri_pl esri_po esri_ru esri_pt esri_en esri_ar esri_et esri_es esri_ko esri_cs esri_da esri_zh esri_sv esri_lt esri_fi esri_lv esri_de esri_vi".split(" "),h.hitch(this,function(b){return b!==a})),c="";e.forEach(b,h.hitch(this,function(a){c+=" -owner:"+
a+" "}));b=" ";this.portal.user&&this.portal.user.orgId&&(b=" orgid:"+this.portal.user.orgId+" ");b=b+this._webMapQueryString+" AND access:public "+c;this._allPublicPortalQuery=this._getQuery({q:b});this._filterPublicPortalQuery=this._getQuery({q:b});this._allPublicOnlineQuery=this._getQuery({q:'(group:"c755678be14e4a0984af36a15f5b643e" OR  group:"b8787a74b4d74f7fb9b8fac918735153") '+this._webMapQueryString+" AND access:public"});this._filterPublicOnlineQuery=this._getQuery({q:this._webMapQueryString+
" AND access:public"});this._allOrganizationQuery=this._getQuery();this._filterOrganizationQuery=this._getQuery();this._allMyContentQuery=this._getQuery();this._filterMyContentQuery=this._getQuery();this._allGroupQuery=this._getQuery();this._filterGroupQuery=this._getQuery()},_getQuery:function(a){return h.mixin({start:1,num:16,f:"json"},a||{})},_getPortalUrl:function(){return n.getStandardPortalUrl(window.portalUrl)},_initMapTables:function(){var a=this._getPortalUrl();this.portalPublicRaido.disabled||
(this.publicPortalMapTable.set("portalUrl",a),this.publicPortalMapTable.set("filteredQuery",this._filterPublicPortalQuery));this.publicOnlineMapTable.set("portalUrl",window.location.protocol+"//www.arcgis.com");this.publicOnlineMapTable.set("filteredQuery",this._filterPublicOnlineQuery)},_initPublic:function(){this.own(a(this.portalPublicRaido,"click",h.hitch(this,function(){this._onPublicRaidoClicked();this._searchPublicByRadio()})));this.own(a(this.onlinePublicRaido,"click",h.hitch(this,function(){this._onPublicRaidoClicked();
this._searchPublicByRadio()})));this._onPublicRaidoClicked()},_onPublicRaidoClicked:function(){this.portalPublicRaido.checked?(this.publicPortalMapTable.show(),this.publicOnlineMapTable.hide()):this.onlinePublicRaido.checked&&(this.publicPortalMapTable.hide(),this.publicOnlineMapTable.show())},_onPublicSearch:function(){var a=this._getSortFieldAndSortOrder(this.publicSelect),b=this.publicSearch.getValue();(b=b&&h.trim(b))?(this.publicPortalMapTable.showFilterMapsSection(),this.publicOnlineMapTable.showFilterMapsSection(),
this._filterPublicPortalQuery.q=b+this._allPublicPortalQuery.q,this._filterPublicPortalQuery.start=1,h.mixin(this._filterPublicPortalQuery,a),this.publicPortalMapTable.searchFilteredMaps(this._filterPublicPortalQuery),this._filterPublicOnlineQuery.q=b+this._webMapQueryString+" AND access:public",this._filterPublicOnlineQuery.start=1,h.mixin(this._filterPublicOnlineQuery,a),this.publicOnlineMapTable.searchFilteredMaps(this._filterPublicOnlineQuery)):(this.publicPortalMapTable.showAllMapsSection(),
this.publicOnlineMapTable.showAllMapsSection(),this._allPublicPortalQuery.start=1,h.mixin(this._allPublicPortalQuery,a),this.publicPortalMapTable.showAllMapsSection(this._allPublicPortalQuery),this._allPublicOnlineQuery.start=1,h.mixin(this._allPublicOnlineQuery,a),this.publicOnlineMapTable.showAllMapsSection(this._allPublicOnlineQuery))},_searchPublic:function(){this.tab.getSelectedTitle()===this.nls.publicMap&&(this.publicTabNode.isSearched||this._searchPublicByRadio())},_searchPublicByRadio:function(){this.portalPublicRaido.checked?
this.publicPortalMapTable.isSearched||(this._onPublicSearch(),this.publicPortalMapTable.isSearched=!0):this.publicOnlineMapTable.isSearched||(this._onPublicSearch(),this.publicOnlineMapTable.isSearched=!0)},_initPrivate:function(){this._resetPortalMaps();this.own(l.subscribe("userSignIn",h.hitch(this,this._onSignIn)));this.own(l.subscribe("userSignOut",h.hitch(this,this._onSignOut)));this.own(a(this.groupsSelect,"change",h.hitch(this,this._onGroupsSelectChange)));var b=n.getServerByUrl(this._getPortalUrl());
n.isArcGIScom(b)&&(b="ArcGIS.com");this.portal.haveSignIn()&&this._onSignIn()},_getSortFieldAndSortOrder:function(a){var b={};a=a.get("value");b.sortField=a;"modified"===a?b.sortOrder="desc":"numviews"===a?b.sortOrder="desc":"avgrating"===a?b.sortOrder="desc":"title"===a?b.sortOrder="asc":"owner"===a&&(b.sortOrder="asc");return b},_onOrganizationSearch:function(){var a=this._getSortFieldAndSortOrder(this.organizationSelect),b=this.organizationSearch.getValue();(b=b&&h.trim(b))?(this._filterOrganizationQuery.q=
b+" "+this._allOrganizationQuery.q,this._filterOrganizationQuery.start=1,h.mixin(this._filterOrganizationQuery,a),this.organizationMapTable.searchFilteredMaps(this._filterOrganizationQuery)):(this._allOrganizationQuery.start=1,h.mixin(this._allOrganizationQuery,a),this.organizationMapTable.showAllMapsSection(this._allOrganizationQuery))},_onMyContentSearch:function(){var a=this._getSortFieldAndSortOrder(this.mycontentSelect),b=this.mycontentSearch.getValue();(b=b&&h.trim(b))?(this._filterMyContentQuery.q=
b+" "+this._allMyContentQuery.q,this._filterMyContentQuery.start=1,h.mixin(this._filterMyContentQuery,a),this.mycontentMapTable.searchFilteredMaps(this._filterMyContentQuery)):(this._allMyContentQuery.start=1,h.mixin(this._allMyContentQuery,a),this.mycontentMapTable.showAllMapsSection(this._allMyContentQuery))},_onGroupSearch:function(){var a=this._getSortFieldAndSortOrder(this.groupSelect),b=this.groupSearch.getValue();(b=b&&h.trim(b))?(this._filterGroupQuery.q=b+" "+this._allGroupQuery.q,this._filterGroupQuery.start=
1,h.mixin(this._filterGroupQuery,a),this.groupMapTable.searchFilteredMaps(this._filterGroupQuery)):(this._allGroupQuery.start=1,h.mixin(this._allGroupQuery,a),this.groupMapTable.showAllMapsSection(this._allGroupQuery))},_onSignIn:function(){this._updateUIbySignIn();this._signIn||(this._signIn=!0,this.portal.getUser().then(h.hitch(this,function(a){this.domNode&&(this._resetPortalMaps(),this._searchOrganization(a),this._searchMyContent(a),this._searchGroups(a))})))},_onSignOut:function(){this._signIn=
!1;this._resetPortalMaps();this._updateUIbySignIn()},_resetPortalMaps:function(){this.organizationMapTable.clear();this.mycontentMapTable.clear();this._resetGroupsSection()},_searchOrganization:function(a){if(this.tab.getSelectedTitle()===this.nls.myOrganization&&!this.organizationTabNode.isSearched){this.organizationMapTable.clear();a=" orgid:"+a.orgId+" AND "+this._webMapQueryString+" AND (access:org OR access:public) ";var b=this._getPortalUrl();this._allOrganizationQuery=this._getQuery({q:a});
this._filterOrganizationQuery=this._getQuery({q:a});this.organizationMapTable.set("portalUrl",b);this._onOrganizationSearch();this.organizationTabNode.isSearched=!0}},_searchMyContent:function(a){if(this.tab.getSelectedTitle()===this.nls.myContent&&!this.mycontentTabNode.isSearched){this.mycontentMapTable.clear();var b=this._getPortalUrl();a="owner:"+a.username+" AND "+this._webMapQueryString;this._allMyContentQuery=this._getQuery({q:a});this._filterMyContentQuery=this._getQuery({q:a});this.mycontentMapTable.set("portalUrl",
b);this._onMyContentSearch();this.mycontentTabNode.isSearched=!0}},_searchGroups:function(a){if(this.tab.getSelectedTitle()===this.nls.myGroup&&!this.groupTabNode.isSearched){this._resetGroupsSection();c.removeClass(this.groupsSection,"hidden");a=a.getGroups();if(0<a.length){c.removeClass(this.groupSearchSection,"hidden");this.groupMapTable.show();c.empty(this.groupsSelect);for(var b=0;b<a.length;b++){var d=a[b];c.create("option",{value:d.id,innerHTML:d.title},this.groupsSelect)}this._onGroupsSelectChange()}this._updateUIbyGroups(a.length);
this.groupTabNode.isSearched=!0}},_resetGroupsSection:function(){c.addClass(this.groupsSection,"hidden");c.empty(this.groupsSelect);c.create("option",{value:"nodata",innerHTML:this.nls.noneGroups},this.groupsSelect);this.groupMapTable.clear();c.addClass(this.groupSearchSection,"hidden");this.groupMapTable.hide();this._updateUIbyGroups(0)},_updateUIbyGroups:function(a){0===a?c.setStyle(this.groupsSection,"top","15px"):c.setStyle(this.groupsSection,"top","70px")},_onGroupsSelectChange:function(){var a=
this.groupsSelect.value;this.groupMapTable.clear();if("nodata"===a)c.addClass(this.groupSearch,"hidden"),this.groupMapTable.hide();else{c.addClass(this.groupSearch,"hidden");this.groupMapTable.show();var b=this._getPortalUrl(),a="group:"+a+" AND "+this._webMapQueryString;this._allGroupQuery=this._getQuery({q:a});this._filterGroupQuery=this._getQuery({q:a});this.groupMapTable.set("portalUrl",b);this._onGroupSearch()}},_onMyContentRefreshIconClicked:function(){this._onMyContentSearch()},_onOrgRefreshIconClicked:function(){this._onOrganizationSearch()},
_onGroupRefreshIconClicked:function(){this._onGroupSearch()},_onPublicRefreshIconClicked:function(){this._onPublicSearch()},getSelectedMapItem:function(){var a=null,c=b(".map-item-bg.selected",this.domNode);0<c.length&&(a=c[0].parentNode.item);return a}})})},"builder/plugins/map-config/MapTable":function(){define("dojo/_base/declare dijit/_WidgetBase dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dojo/text!./MapTable.html dojo/Evented dojo/_base/lang dojo/_base/array dojo/_base/html dojo/_base/Deferred dojo/query dojo/on jimu/utils builder/portalUtils jimu/portalUrlUtils jimu/dijit/LoadingIndicator dojo/i18n!./nls/strings".split(" "),
function(r,l,d,q,k,m,p,h,e,c,b,a,g,u,n,t,f){return r([l,d,q,m],{templateString:k,baseClass:"map-table",query:null,filteredQuery:null,portalUrl:null,hidden:!1,nls:null,originalSelectedId:null,type:"",postMixInProperties:function(){this.nls=f},postCreate:function(){this.inherited(arguments);(this.hidden=!0===this.hidden)&&this.hide();this.portalUrl&&(this.portalUrl=n.getStandardPortalUrl(this.portalUrl));this.own(a(this.allMapsTableDiv,"scroll",p.hitch(this,this._onAllMapsSectionScroll)));this.own(a(this.filteredMapsTableDiv,
"scroll",p.hitch(this,this._onFilteredMapsSectionScroll)));this._showAllMapsSection();this.searchAllMaps()},show:function(){e.removeClass(this.domNode,"hidden")},hide:function(){e.addClass(this.domNode,"hidden")},searchAllMaps:function(a){this._showAllMapsSection();a&&(this.query=p.clone(a),this.query.start=1,this.clearAllMapsSection());this.portalUrl&&this.query&&0<this.query.start&&(this.allMapsShelter.show(),u.getPortal(this.portalUrl).queryItems(this.query).then(p.hitch(this,function(a){this.domNode&&
(this.allMapsShelter.hide(),this.query.start=a.nextStart,this._createMapItems(a,this.allMapsTbody))}),p.hitch(this,function(a){console.error(a);this.domNode&&this.allMapsShelter.hide()})))},searchFilteredMaps:function(a){this._showFilterMapsSection();a&&(this.filteredQuery=p.clone(a),this.filteredQuery.start=1,this.clearFilteredMapsSection());this.portalUrl&&this.filteredQuery&&0<this.filteredQuery.start&&(this.filteredMapsShelter.show(),u.getPortal(this.portalUrl).queryItems(this.filteredQuery).then(p.hitch(this,
function(b){this.domNode&&(this._showFilterMapsSection(),a&&this.clearFilteredMapsSection(),this.filteredQuery.start=b.nextStart,this._createMapItems(b,this.filteredMapsTbody),this._filterMapCallback())}),p.hitch(this,function(a){console.error(a);this.domNode&&this._filterMapCallback()})))},_filterMapCallback:function(){this.filteredMapsShelter.hide();0<this._getWebMapCount(this.filteredMapsTbody)?(e.removeClass(this.filteredMapsTableDiv,"hidden"),e.addClass(this.searchNoneTipSection,"hidden")):(e.addClass(this.filteredMapsTableDiv,
"hidden"),e.removeClass(this.searchNoneTipSection,"hidden"))},clear:function(){this.clearAllMapsSection();this.clearFilteredMapsSection()},clearAllMapsSection:function(){e.empty(this.allMapsTbody)},clearFilteredMapsSection:function(){e.empty(this.filteredMapsTbody)},showAllMapsSection:function(a){this._showAllMapsSection();a&&this.searchAllMaps(a)},_showAllMapsSection:function(){e.removeClass(this.allMapsSection,"hidden");e.addClass(this.filteredMapsSection,"hidden")},showFilterMapsSection:function(a){this._showFilterMapsSection();
a&&this.searchFilteredMaps(a)},_showFilterMapsSection:function(){e.addClass(this.allMapsSection,"hidden");e.removeClass(this.filteredMapsSection,"hidden");e.removeClass(this.filteredMapsTableDiv,"hidden");e.addClass(this.searchNoneTipSection,"hidden")},_onAllMapsSectionScroll:function(){this._isScrollToBottom(this.allMapsTableDiv)&&this.searchAllMaps()},_onFilteredMapsSectionScroll:function(){this._isScrollToBottom(this.filteredMapsTableDiv)&&this.searchFilteredMaps()},_isScrollToBottom:function(a){return g.isScrollToBottom(a)},
_createMapItems:function(a,c){var d=h.filter(a.results,p.hitch(this,function(a){return a.type.toLowerCase()===this.type.toLowerCase()}));if(0!==d.length){var f={},g,k=b("td.empty",c),l;if(0<k.length){var n=Math.min(d.length,k.length),m=d.splice(0,n);for(l=0;l<n;l++){var q=k[l];g=this._createMapItem(m[l]);f[g.item.id]=g;e.place(g,q);e.removeClass(q,"empty")}}if(0!==d.length){k=Math.ceil(d.length/5);for(l=0;l<k;l++)for(g=e.toDom("\x3ctr\x3e\x3ctd\x3e\x3c/td\x3e\x3ctd\x3e\x3c/td\x3e\x3ctd\x3e\x3c/td\x3e\x3ctd\x3e\x3c/td\x3e\x3ctd\x3e\x3c/td\x3e\x3c/tr\x3e"),
e.place(g,c),n=b("td",g),m=0;m<n.length;m++)q=n[m],(g=d[5*l+m])?(g=this._createMapItem(g),f[g.item.id]=g,e.place(g,q)):e.addClass(q,"empty");!this.getSelectedMapItem()&&this.appConfig&&this.appConfig.map.itemId&&(g=f[this.appConfig.itemId])&&(d=b(".map-item-bg",g),e.addClass(d,"selected"))}}},_getWebMapCount:function(a){return b(".map-item-div",a).length},_createMapItem:function(c){var d=e.toDom("\x3cdiv class\x3d'map-item-div'\x3e\x3cdiv class\x3d'map-item-bg'\x3e\x3cdiv class\x3d'map-item-thumbnail jimu-auto-vertical'\x3e\x3cdiv class\x3d'none-thumbnail-tip jimu-auto-vertical-content'\x3e\x3c/div\x3e\x3c/div\x3e\x3ca target\x3d'_blank' class\x3d'map-item-detail-icon'\x3e\x3c/a\x3e\x3c/div\x3e\x3cspan class\x3d'map-item-title'\x3e\x3c/span\x3e\x3c/div\x3e"),
f=b(".map-item-bg",d)[0],h=b(".map-item-thumbnail",d)[0],k=b(".map-item-title",d)[0],l=b(".map-item-detail-icon",d)[0];b(".none-thumbnail-tip",d);l.href=c.detailsPageUrl;l.title=this.nls.viewItemDetails||"";d.item=c;l=c.thumbnailUrl||g.getDefaultWebMapThumbnail();e.setStyle(h,"backgroundImage","url("+l+")");this.own(a(f,"click",p.hitch(this,this._onMapItemBgClick)));k.innerHTML=c.title;k.title=c.title;return d},unselect:function(){b(".map-item-bg",this.domNode).removeClass("selected")},_onMapItemBgClick:function(a){a=
a.target||a.srcElement;var b=null;e.hasClass(a,"map-item-thumbnail")?b=a.parentNode:e.hasClass(a,"none-thumbnail-tip")&&(b=a.parentNode.parentNode);b&&e.hasClass(b,"map-item-bg")&&(this.unselect(),e.addClass(b,"selected"),this.emit("select",{mapTable:this,selectedNode:b}))},getSelectedMapItem:function(){var a=null,c=b(".map-item-bg.selected",this.domNode);0<c.length&&(a=c[0].parentNode.item);return a}})})},"builder/plugins/map-config/CustomizeScale":function(){define("dojo/_base/declare dijit/_WidgetBase dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dojo/text!./CustomizeScale.html dojo/query dojo/_base/lang dojo/_base/array dojo/_base/html jimu/utils jimu/dijit/Message dijit/form/NumberTextBox".split(" "),
function(r,l,d,q,k,m,p,h,e,c,b,a){return r([l,d,q],{templateString:k,baseClass:"mapconfig-customize-scale",map:null,postCreate:function(){this.inherited(arguments);this._initSelf()},_initSelf:function(){this.scaleNumberBox=new a({placeholder:this.nls.scale,intermediateChanges:!0,trim:!0,constraints:{min:1,pattern:"###############0.################"},style:"width:550px;height:100%;"});e.addClass(this.scaleNumberBox.domNode,"jimu-float-leading");this.scaleNumberBox.placeAt(this.scaleInputDiv,"first");
var b=this.getLodsFromMap();this._resetLodListByLods(b)},getLodsFromMap:function(){var a=[];this.map._params&&this.map._params.lods&&(a=h.map(this.map._params.lods,p.hitch(this,function(a){return a.toJson()})));return a},_getLodsFromBasemapLayer:function(){var a=[],b=this.map.getLayer(this.map.layerIds[0]);b&&b.tileInfo&&b.tileInfo.lods&&(a=h.map(b.tileInfo.lods,p.hitch(this,function(a){return{level:a.level,resolution:a.resolution,scale:a.scale}})));return a},getLodsFromListNode:function(){for(var a=
this._getLodItems(),b=[],c=null,d=0;d<a.length;d++)c=a[d].lod,b.push({level:c.level,scale:c.scale,resolution:c.resolution});return b},_resetLodListByLods:function(a){e.empty(this.listNode);h.forEach(a,p.hitch(this,function(a){a=this._createLodItem(a);e.place(a,this.listNode)}))},_createLodItem:function(a){var b=e.create("div",{innerHTML:c.localizeNumber(a.scale),"class":"lod-item"});b.lod=a;return b},_getLodItems:function(){return m(".lod-item",this.listNode)},_getSelectedLodItem:function(){var a=
null,b=m(".selected",this.listNode);0<b.length&&(a=b[0]);return a},_selectLodItem:function(a){this._removeSelectedClass();e.addClass(a,"selected");e.addClass(this.btnDelete,"enabled-operation");a.previousSibling||e.setStyle(a,"borderTop","0")},_removeSelectedClass:function(){m(".lod-item",this.listNode).removeClass("selected");e.removeClass(this.btnDelete,"enabled-operation")},_onLodListClicked:function(a){a=a.target||a.srcElement;e.hasClass(a,"lod-item")&&this._selectLodItem(a)},_onBtnAddClicked:function(){if(this.scaleNumberBox.validate()){var a=
this.scaleNumberBox.get("value");this.scaleNumberBox.set("displayedValue","");var b=this._getLodItems();if(0!==b.length&&!h.some(b,p.hitch(this,function(b){return b.lod.scale===a}))){var c=b.length-1,d=b[0].lod,f=b[c].lod,k=null,k={level:null,resolution:d.resolution/d.scale*a,scale:a};if(k.scale>d.scale)k.level=d.level-1,k=this._createLodItem(k),e.place(k,this.listNode,"first");else if(k.scale<f.scale)k.level=f.level+1,k=this._createLodItem(k),e.place(k,this.listNode);else for(var l=null,d=null,f=
c;1<=f;f--)if(l=b[f],d=b[f-1],k.scale>l.lod.scale&&k.scale<d.lod.scale){k.level=l.lod.level;k=this._createLodItem(k);e.place(k,d,"after");for(k=f;k<=c;k++)b[k].lod.level+=1;break}}}},_onBtnDeleteClicked:function(){var a=this._getSelectedLodItem();if(a)if(1===this.getLodsFromListNode().length)new b({message:this.nls.atLeastOneScale});else{var c=a;if(!a.previousSibling)for(;a.nextSibling;)a=a.nextSibling,--a.lod.level;e.destroy(c);this._removeSelectedClass()}},_onBtnResetClicked:function(){this._removeSelectedClass();
var a=this._getLodsFromBasemapLayer();this._resetLodListByLods(a)}})})},"builder/plugins/popup-actions/configmode-switch/_build-generate_module":function(){define(["builder/plugins/popup-actions/configmode-switch/Plugin","dojo/i18n!builder/plugins/popup-actions/configmode-switch/nls/strings"],function(){})},"builder/plugins/popup-actions/configmode-switch/Plugin":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/topic","builder/BasePlugin"],function(r,l,d,q){return r([q],{baseClass:"plugin-app-actions-popup-saveas",
disabled:null,postCreate:function(){this.inherited(arguments);this._bindEvent();this.label=this.nls.advanceConfigLabel;this.isAdvance=!1},onClick:function(){var d=this.pluginManager.getPluginByName("app-config");this.isAdvance?(this.isAdvance=!1,this.label=this.nls.advanceConfigLabel,d.switchToTemplateConfigPart()):(this.isAdvance=!0,this.label=this.nls.templateConfigLabel,d.switchToPreviewConfig())},_bindEvent:function(){this.own(d.subscribe("app/appConfigLoaded",l.hitch(this,this._setAppConfig)))},
_setAppConfig:function(d){this.appConfig=d;d.templateConfig&&d.isTemplateApp||d.templateConfig&&d._appData?(this.visible=!0,this.isAdvance=!1):(this.visible=!1,this.isAdvance=!0)}})})},"builder/plugins/popup-actions/popup-agoltemplate/_build-generate_module":function(){define(["builder/plugins/popup-actions/popup-agoltemplate/Plugin","dojo/text!builder/plugins/popup-actions/popup-agoltemplate/css/style.css","dojo/i18n!builder/plugins/popup-actions/popup-agoltemplate/nls/strings"],function(){})},"builder/plugins/popup-actions/popup-agoltemplate/Plugin":function(){define("dojo/_base/declare dojo/_base/array dojo/_base/lang dojo/promise/all dojo/Deferred dojo/on dojo/topic dojo/_base/html dojo/json builder/BasePlugin builder/serviceUtils builder/portalUtils jimu/portalUrlUtils jimu/dijit/LoadingShelter jimu/dijit/Popup jimu/Role builder/dijit/template-config/Template builder/dijit/template-config/utils builder/dijit/TemplateAttributes".split(" "),
function(r,l,d,q,k,m,p,h,e,c,b,a,g,u,n,t,f,v,x){return r([c],{baseClass:"plugin-app-actions-popup-template",disabled:null,postMixInProperties:function(){this.inherited(arguments);this.nls=d.mixin(this.nls,builderNls)},constructor:function(){"HTML"===window.appInfo.id||"HTML3D"===window.appInfo.id?this.disabled=!0:a.getPortal(window.portalUrl).getUser().then(d.hitch(this,function(a){this.user=a;var b=new t({id:a.roleId?a.roleId:a.role,role:a.role});a.privileges&&b.setPrivileges(a.privileges);b.isAdmin()?
this.disabled=!1:a.username===window.appInfo.appOwner&&(window.isXT||b.canCreateItem())?this.disabled=!1:this.disabled=!0}),d.hitch(this,function(a){this.disabled=!0;console.log(a)}))},postCreate:function(){this.inherited(arguments);this.label=this.nls.exportTitle;var a=this.pluginManager.getPluginByName("startup");this.shelter=(new u({hidden:!0})).placeAt(a.domNode);this._bindEvent()},onClick:function(){if(!this.disabled){var c=new k,e=window.appInfo.id;this.shelter.show();window.isXT?b.getAppInfo(e).then(d.hitch(this,
function(a){c.resolve(a)}),function(){c.reject()}):a.getPortal(g.getPortalUrlFromLocation()).getItemData(e).then(d.hitch(this,function(a){a=a.agolTemplateInfo;!a&&this.appConfig.agolTemplateJson&&(a={itemId:null,json:this.appConfig.agolTemplateJson});a={id:e,name:this.pluginManager.getPluginByName("header").getAppName(),agolTemplateInfo:a};c.resolve(a)}),function(){c.reject()});var f=v.loadAllWidgetConfigs(d.clone(this.appConfig)),h=this.pluginManager.getPluginByName("app-actions.save-app").saveApp();
q({app:c,appConfig:f,saveApp:h}).then(d.hitch(this,function(a){var b=a.app;this._createAGOLTemplate(b,a.appConfig);this._createAGOLTemplatePrview();this.popupDlg(b);this.shelter.hide()}),d.hitch(this,function(a){console.error(a.message);this.shelter.hide()}))}},popupDlg:function(a){var b=h.create("div",{"class":"template-popup-content"}),c=h.getMarginBox(window.document.body).w,c=.9*c;1024>c&&(c=1024);this.popup=new n({content:b,"class":"plugin-app-actions-template-popup",container:"main-page",titleLabel:this.nls.title,
width:c,height:668,buttons:[{label:this.nls.exportStr,onClick:d.hitch(this,this._onExportClick)},{label:this.nls.saved,onClick:d.hitch(this,this._onSaveClick)},{label:this.nls.close,classNames:["jimu-btn-vacation"],onClick:d.hitch(this,this._onCancelClick)}]});this._initPopup(a);this.agoltemplateDijit.loading.placeAt(this.popup.domNode);this.popup.configPart=h.create("div",{"class":"config-part jimu-float-leading"},b);a=h.create("div",{"class":"privew-part-box jimu-float-leading"},b);a=h.create("div",
{"class":"privew-part-inset-box"},a);this.popup.previewPart=h.create("div",{"class":"privew-part"},a);h.place(this.agoltemplateDijit.domNode,this.popup.configPart);h.place(this.agoltemplatePrivew.domNode,this.popup.previewPart)},_onExportClick:function(a){window.isXT?h.hasClass(this.popup.exportDrawBoxDomNode,"export-draw-box-hiden")?h.removeClass(this.popup.exportDrawBoxDomNode,"export-draw-box-hiden"):h.addClass(this.popup.exportDrawBoxDomNode,"export-draw-box-hiden"):this.agoltemplateDijit.exportOrUpdateAGOLTemplate();
a.stopPropagation()},_onExportAGOLTemplateClick:function(a){this._hasCreateItemPrivilege()?this.agoltemplateDijit.exportOrUpdateAGOLTemplate():a.stopPropagation()},_onExportWABTemplateClick:function(){this.agoltemplateDijit.exportWABTemplate()},_onSaveClick:function(){h.setAttr(this.popup.enabledButtons[1],"innerHTML",this.nls.saving);this.agoltemplateDijit.saveAgolTemplate().then(d.hitch(this,function(){this._disablePopupButton(1,this.nls.saved)}))},_onCancelClick:function(){if(this.agoltemplateDijit.hasChanged())var a=
new n({content:"\x3cdiv\x3e\x3cimg class\x3d'alert-image jimu-float-leading'src\x3d'"+this.folderUrl+"/css/images/alert.png' style\x3d'margin-left:20px;margin-right:20px;'\x3e\x3c/img\x3e\x3cspan style\x3d'display:inline-block;width:285px'\x3e"+this.nls.unSaveMeg+"\x3c/span\x3e\x3c/div\x3e",titleLabel:this.nls.cancelPopupTitle,width:"425",autoHeight:!0,buttons:[{label:this.nls.save,onClick:d.hitch(this,function(){this.agoltemplateDijit.saveAgolTemplate().then(d.hitch(this,function(){a.close();this._closePopup();
this.agoltemplateDijit.destroyRecursive()}))})},{label:this.nls.doNotSave,onClick:d.hitch(this,function(){a.close();this._closePopup();this.agoltemplateDijit.destroyRecursive()})},{label:this.nls.cancel,classNames:["jimu-btn-vacation"],onClick:d.hitch(this,function(){a.close()})}]});else this._closePopup(),this.agoltemplateDijit.destroyRecursive()},_closePopup:function(){this.popup&&(this.popup.closeTemplate=!0,this.popup.close())},_initPopup:function(b){this.popup.disableButton(1);this.popup.onClose=
d.hitch(this,function(){if(this.popup.closeTemplate)return!0;this._onCancelClick();return!1});if(window.isXT){this.popup.exportDrawBoxDomNode=h.create("div",{"class":"export-draw-box export-draw-box-hiden"});var c;c=this._hasCreateItemPrivilege()?"export-draw-box-btn":"export-draw-box-btn export-draw-box-btn-disable";this.popup.exportAGOLTemplateDomNode=h.create("div",{"class":c,innerHTML:this.nls.exportAGOLTemplate},this.popup.exportDrawBoxDomNode);this.popup.exportWABTemplateDomNode=h.create("div",
{"class":"export-draw-box-btn",innerHTML:this.nls.exportWABTemplate},this.popup.exportDrawBoxDomNode);h.addClass(this.popup.domNode,"plugin-app-actions-template-popup-for-xt");h.addClass(this.popup.enabledButtons[0],"export-btn");h.place(this.popup.exportDrawBoxDomNode,this.popup.enabledButtons[0]);this.popup.own(m(this.popup,"click",d.hitch(this,function(){h.addClass(this.popup.exportDrawBoxDomNode,"export-draw-box-hiden")})));this.popup.own(m(this.popup.exportAGOLTemplateDomNode,"click",d.hitch(this,
this._onExportAGOLTemplateClick)));this.popup.own(m(this.popup.exportWABTemplateDomNode,"click",d.hitch(this,this._onExportWABTemplateClick)))}else this._hasCreateItemPrivilege()||this.popup.disableButton(0);b.agolTemplateInfo&&b.agolTemplateInfo.itemId&&a.getPortal(window.portalUrl).getItemById(b.agolTemplateInfo.itemId).then(d.hitch(this,function(){window.isXT?h.setAttr(this.popup.exportAGOLTemplateDomNode,"innerHTML",this.nls.updateAGOLTemplate):h.setAttr(this.popup.enabledButtons[0],"innerHTML",
this.nls.update)}),d.hitch(this,function(){b.agolTemplateInfo.itemId=null;window.isXT?h.setAttr(this.popup.exportAGOLTemplateDomNode,"innerHTML",this.nls.exportAGOLTemplate):h.setAttr(this.popup.enabledButtons[0],"innerHTML",this.nls.exportStr)}))},_disablePopupButton:function(a,b){this.popup.disableButton(a);h.setAttr(this.popup.disabledButtons[a],"innerHTML",b)},_enablePopupButton:function(a,b){this.popup.enableButton(a);h.setAttr(this.popup.enabledButtons[a],"innerHTML",b)},_createAGOLTemplate:function(a,
b){var c;c=a.agolTemplateInfo&&a.agolTemplateInfo.json?e.parse(a.agolTemplateInfo.json):b.templateConfig?b.templateConfig:null;this.agoltemplateDijit=new f({appConfig:b,appInfo:a,templateConfig:c});this.own(this.agoltemplateDijit.on("hasChanged",d.hitch(this,function(a){a?this._enablePopupButton(1,this.nls.save):this._disablePopupButton(1,this.nls.saved);this._refreshAGOLTempaltePrview()})));this.own(this.agoltemplateDijit.on("exported",d.hitch(this,function(a){a&&(window.isXT&&this.popup.exportAGOLTemplateDomNode?
h.setAttr(this.popup.exportAGOLTemplateDomNode,"innerHTML",this.nls.updateAGOLTemplate):this._enablePopupButton(0,this.nls.update))})));this.agoltemplateDijit.startup()},_createAGOLTemplatePrview:function(){var a;this.agoltemplateDijit&&(a=this.agoltemplateDijit.getTemplateConfig());this.agoltemplatePrivew=new x({templateConfig:a});this.agoltemplatePrivew.startup()},_refreshAGOLTempaltePrview:function(){this.agoltemplatePrivew&&this.agoltemplatePrivew.destroy();this._createAGOLTemplatePrview();h.place(this.agoltemplatePrivew.domNode,
this.popup.previewPart)},_bindEvent:function(){this.own(p.subscribe("app/appConfigLoaded",d.hitch(this,this._setAppConfig)));this.own(p.subscribe("app/appConfigChanged",d.hitch(this,this._setAppConfig)))},_setAppConfig:function(a){this.appConfig=a;this.visible=a.templateConfig&&a.isTemplateApp||!a.templateConfig?!0:!1},_hasCreateItemPrivilege:function(){var a=!1;this.user?l.forEach(this.user.privileges,function(b){0<=b.indexOf("createItem")&&(a=!0)},this):a=!0;return a}})})},"builder/plugins/popup-actions/popup-saveas/_build-generate_module":function(){define(["builder/plugins/popup-actions/popup-saveas/Plugin",
"dojo/i18n!builder/plugins/popup-actions/popup-saveas/nls/strings"],function(){})},"builder/plugins/popup-actions/popup-saveas/Plugin":function(){define("dojo/_base/declare dojo/_base/lang builder/BasePlugin jimu/Role jimu/portalUrlUtils builder/portalUtils".split(" "),function(r,l,d,q,k,m){return r([d],{baseClass:"plugin-app-actions-popup-saveas",disabled:null,constructor:function(){if("HTML"===window.appInfo.id||"HTML3D"===window.appInfo.id)this.disabled=!0;else if(window.isXT)this.disabled=!1;
else{var d=k.getStandardPortalUrl(window.portalUrl);m.getPortal(d).getUser().then(l.hitch(this,function(d){var e=new q({id:d.roleId?d.roleId:d.role,role:d.role});d.privileges&&e.setPrivileges(d.privileges);e.canCreateItem()||(this.disabled=!0)}),l.hitch(this,function(){this.disable=!0}))}},postCreate:function(){this.inherited(arguments);this.label=this.nls.label},onClick:function(){if(!this.disabled){var d=this.pluginManager.getExtensions("startup.creation-entry")[0];this.pluginManager.loadPlugin(this.pluginsMeta[d.pluginName]).then(l.hitch(this,
function(d){d.popupSaveAsDlg(this.nls.saveAsTitle,window.appInfo.id,window.appConfig)}))}}})})},"builder/plugins/popup-actions/popup-share/_build-generate_module":function(){define(["builder/plugins/popup-actions/popup-share/Plugin"],function(){})},"builder/plugins/popup-actions/popup-share/Plugin":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/html dojo/on dojo/keys jimu/dijit/Popup builder/BasePlugin jimu/portalUrlUtils jimu/dijit/ShareOptions jimu/dijit/ShareLink dojo/topic dojo/query jimu/utils".split(" "),
function(r,l,d,q,k,m,p,h,e,c,b,a){return r([p],{baseClass:"plugin-app-actions-popup-share",disabled:null,_isShowFindLocation:!0,postCreate:function(){this.inherited(arguments);this.label=window.jimuNls.common.share;this.own(b.subscribe("app/appConfigChanged",l.hitch(this,this._onAppConfigLoadedOrChanged)));this.own(b.subscribe("app/appConfigLoaded",l.hitch(this,this._onAppConfigLoadedOrChanged)));this.own(b.subscribe("ShareOptions/onClickEveryone",l.hitch(this,function(a){if(this.shareLink&&this.shareLink.onShareToPublicChanged)this.shareLink.onShareToPublicChanged(a)})));
this.own(b.subscribe("ShareLink/onHideContainer",l.hitch(this,function(){this.hide()})));this.own(b.subscribe("ShareLink/onShowContainer",l.hitch(this,function(){this.show()})));this.own(b.subscribe("ShareLink/onHideLinkOptions",l.hitch(this,function(){this._changeBtnsByShareLink("hide")})));this.own(b.subscribe("ShareLink/onShowLinkOptions",l.hitch(this,function(){this._changeBtnsByShareLink("show")})))},onClick:function(){this.disabled||this.popupDlg()},_onAppConfigLoadedOrChanged:function(a){this._isShowFindLocation=
this._findSearchWidget(a);this.shareLink&&this.shareLink.updateShareLinkOptionsUI({isShowFindLocation:this._isShowFindLocation})},_findSearchWidget:function(a){a=a.getConfigElementsByName("Search");return 0<a.length&&a[0].visible},popupDlg:function(){var a=this._initContent(),b=this._initPupupBtns(),c=this._initPopupHeight();this.sharePopup=new m({content:a,"class":"share-container",container:"main-page",titleLabel:window.jimuNls.common.share,width:640,height:c,buttons:b});this.shareLink.startup();
this.shareOptions&&this.shareOptions.startup()},_onOkClick:function(){this.shareOptions&&this.shareOptions.share();this.sharePopup.close()},_onCancelClick:function(){this.sharePopup.close()},_initContent:function(){var a=d.create("div",{"class":"template-popup-content"});d.create("div",{"class":"app-name"},a);window.isXT||(this.shareOptions=new e(window.appConfig.portalUrl),this.shareOptions.placeAt(a));this.shareLink=new c({portalUrl:window.appConfig.portalUrl,appTitle:window.appInfo.name,isOnline:h.isOnline(window.top.location.href),
isShowSocialMediaLinks:!0,isSharedToPublic:!1,isShowBackBtn:!1,isShowFindLocation:this._isShowFindLocation});this.shareLink.placeAt(a);return a},_initPupupBtns:function(){var a=[];this.shareOptions&&a.push({label:window.jimuNls.common.ok,key:k.ENTER,isHighLight:!0,onClick:l.hitch(this,this._onOkClick)});a.push({label:window.jimuNls.common.cancel,classNames:["jimu-btn-vacation"],key:k.ESCAPE,onClick:l.hitch(this,this._onCancelClick)});return a},_initPopupHeight:function(){var a=560;this.shareOptions&&
(a=600);return a},_changeBtnsByShareLink:function(a){var b=this.shareOptions?1:0;"hide"===a?(this.sharePopup.setTitleLabel(window.jimuNls.common.share),this.sharePopup.setButtonProps(b,{title:window.jimuNls.common.cancel}),this.sharePopup.setButtonProps(b,{label:window.jimuNls.common.cancel})):"show"===a&&(this.sharePopup.setTitleLabel(window.jimuNls.shareLink.linkOptions),this.sharePopup.setButtonProps(b,{label:window.jimuNls.common.back}),this.sharePopup.setButtonProps(b,{title:window.jimuNls.common.back}),
this._disableShareBtn(),this.own(q.once(this.sharePopup,"Close",l.hitch(this,function(){this.sharePopup.setTitleLabel(window.jimuNls.common.share);this.sharePopup.setButtonProps(b,{title:window.jimuNls.common.cancel});this.sharePopup.setButtonProps(b,{label:window.jimuNls.common.cancel});this._enableShareBtn();this.shareLink._toggleLinkOptions();return!1}))))},_disableShareBtn:function(){this.shareOptions&&this.sharePopup.hideButton(0)},_enableShareBtn:function(){this.shareOptions&&this.sharePopup.showButton(0)},
hide:function(){a("#main-page \x3e .jimu-overlay").style("display","none");a("#main-page \x3e .jimu-popup").style("display","none")},show:function(){a("#main-page \x3e .jimu-overlay").style("display","block");a("#main-page \x3e .jimu-popup").style("display","block")}})})},"jimu/dijit/ShareOptions":function(){define("dojo/_base/declare dijit/_WidgetBase dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dojo/_base/lang esri/lang dojo/_base/array dojo/dom-style dojo/on dojo/dom dojo/query dojo/topic dojo/text!./templates/ShareOptions.html jimu/shareUtils dijit/form/Textarea dijit/form/CheckBox dijit/layout/BorderContainer".split(" "),
function(r,l,d,q,k,m,p,h,e,c,b,a,g,u){return r([l,d,q],{templateString:g,declaredClass:"jimu.dijit.ShareOptions",postMixInProperties:function(){this.inherited(arguments);this.nls=window.jimuNls.shareOptions},constructor:function(a){this.portalUrl=a},startup:function(){u.getShareInfo(this.portalUrl).then(k.hitch(this,function(a){this._initShow(a);this.own(e(c.byId("share-everyone-check"),"change",k.hitch(this,this.clickEveryone)))}))},_initShow:function(a){this.shareInfo=a;this.shareInfo.items=[this.shareInfo.item];
this.shareInfo.sortField="title";(this.shareInfo.userRole.isAdmin()||this.shareInfo._roleCanUpdateItems&&this.shareInfo._roleCanShare||this.shareInfo._roleCanShareOthersItems)&&this.shareInfo.itemUser?this.showAdmin(this.shareInfo.user.groups,this.shareInfo.itemUser,this.shareInfo.adminGroups):this.shareInfo.user&&u._isUserOwnTheApp(this.shareInfo.user)?this.show(this.shareInfo.user.groups):this.shareInfo.user&&("public"===this.shareInfo.item.access||"shared"===this.shareInfo.item.access||"org"===
this.shareInfo.item.access&&this.shareInfo.currentUser.orgId)?this.showGroups(this.shareInfo.user.groups):this.show(this.shareInfo.user.groups)},clear:function(){c.byId("share-groups-list").innerHTML="";c.byId("share-everyone-check").setAttribute("value",!1);c.byId("share-account-check").setAttribute("value",!1);c.byId("share-groups-check").setAttribute("value",!1);h.set(c.byId("share-everyone-check_div"),"display","none");h.set(c.byId("share-account-check_div"),"display","none");this.shareInfo.shareType=
"item"},showAdmin:function(a,b,c){this.shareInfo.itemUser=b;this.shareInfo.userGroups=p.filter(a||[],k.hitch(this,function(){return!this.shareInfo.item.capabilities||!this.shareInfo.item.capabilities.length}));this.shareInfo.userGroups.sort(k.hitch(this,this._sortFunc));this.shareInfo.adminGroups=this.filterAdminGroups(c);this.checkForAccount("admin")},filterAdminGroups:function(a){if(a){for(var b=[],c=0;c<this.shareInfo.user.groups.length;c++)b.push(this.shareInfo.user.groups[c].id);for(var d=[],
c=0;c<a.length;c++)-1!==p.indexOf(b,a[c].id)||a[c].capabilities&&a[c].capabilities.length||d.push(a[c]);return d}return null},showGroups:function(a){this.shareInfo.userGroups=this.filterOwnedGroups(a);this.shareInfo.userGroups&&this.shareInfo.userGroups.sort(k.hitch(this,this._sortFunc));this.clear();this.shareInfo.shareType="group";this.checkForAccount("group")},filterOwnedGroups:function(a){if(a){for(var b=[],c,d=0;d<a.length;d++)c=a[d],!c.userMembership||"owner"!==c.userMembership.memberType&&
"admin"!==c.userMembership.memberType||c.capabilities&&c.capabilities.length||b.push(c);return b}return null},show:function(a){this.shareInfo.userGroups=this.filterViewOnlyGroups(a);this.shareInfo.userGroups.sort(k.hitch(this,this._sortFunc));this.checkForAccount("item")},filterViewOnlyGroups:function(a){if(a){for(var b=[],c,d=0;d<a.length;d++)c=a[d],c.capabilities&&c.capabilities.length||(!c.userMembership||"owner"!==c.userMembership.memberType&&"admin"!==c.userMembership.memberType)&&m.isDefined(c.isViewOnly)&&
c.isViewOnly||b.push(c);return b}return null},checkForAccount:function(a){c.byId("share-account-check-label").innerHTML=this.shareInfo.organization.name;!this.shareInfo._isCustomRole||this.shareInfo._roleCanShareToOrg||this.shareInfo._roleCanShareOthersItemsToOrg||h.set(c.byId("share-account-check_div"),"display","none");this.clear();this.shareInfo.shareType=a;var b=this.shareInfo.items[0];this.shareInfo.lowestAccess=this.findLowestAccessLevel(this.shareInfo.items);u.getItemById(b,this.portalUrl).then(k.hitch(this,
function(a){b.sharing=a.sharing;"admin"===this.shareInfo.shareType?u.getItemByUserAndItemId(b,this.shareInfo.itemUser,this.shareInfo.user,this.portalUrl).then(k.hitch(this,function(a){b.sharing=a.sharing;this.buildAdminList()})):"group"===this.shareInfo.shareType?u.getItemsGroups(b,this.portalUrl).then(k.hitch(this,function(a){var c=[];if(a.admin)for(var d=0;d<a.admin.length;d++)c.push(a.admin[d].id);b.sharing={groups:c};this.buildGroupList()})):"item"===this.shareInfo.shareType&&u.getItemByUserAndItemId(b,
this.shareInfo.itemUser,this.shareInfo.user,this.portalUrl).then(k.hitch(this,function(a){b.sharing=a.sharing;this.buildList()}))}))},buildAdminList:function(){var a,b,d;if(this.shareInfo.user.groups&&0<this.shareInfo.user.groups.length||this.shareInfo.adminGroups&&0<this.shareInfo.adminGroups.length&&1<this.shareInfo.lowestAccess)!this.shareInfo._isCustomRole||this.shareInfo._roleCanShareToGroup||this.shareInfo._roleCanShareOthersItemsToGroup?h.set(c.byId("share-groups-div"),"display","block"):h.set(c.byId("share-groups-div"),
"display","none");this.shareInfo.itemsAreSharedToGroups=",";var g=[],l=null,m=null;b=[];for(a=0;a<this.shareInfo.items.length;a++)if(l=this.shareInfo.items[a],l.sharing)for(d=0;d<l.sharing.groups.length;d++)if(m=l.sharing.groups[d],-1===this.shareInfo.itemsAreSharedToGroups.indexOf(","+m+","))this.shareInfo.itemsAreSharedToGroups+=m+",",b=[],b[0]=m,b[1]=1,g[g.length]=b;else for(b=0;b<g.length;b++)if(g[b][0]===m){g[b][1]+=1;break}l="";d=!1;var p,q;for(a=0;a<this.shareInfo.user.groups.length;a++){m=
this.shareInfo.user.groups[a];p="";q=this.shareInfo.items.length;if(-1<this.shareInfo.itemsAreSharedToGroups.indexOf(","+m.id+","))for(p="checked",d=!0,b=0;b<g.length;b++)if(g[b][0]===m.id){q=g[b][1];break}l=q<this.shareInfo.items.length?l+('\x3cdiv id\x3d"img_group_'+a+"_div\" style\x3d\"display:block;\"\x3e\x3ctable cellpadding\x3d'0' cellspacing\x3d'0' class\x3d'share-groups-table'\x3e\x3ctr\x3e\x3ctd width\x3d'17' valign\x3d'bottom'\x3e\x3cimg id\x3d\"img_group_"+a+'" src\x3d"'+this._checkboxImgUrl+
'" border\x3d"0"\x3e\x3c/td\x3e\x3ctd\x3e'+m.title+'\x3c/td\x3e\x3c/tr\x3e\x3c/table\x3e\x3c/div\x3e\x3cdiv id\x3d"group_'+a+"_div\" style\x3d\"display:none;\"\x3e\x3ctable cellpadding\x3d'0' cellspacing\x3d'0' class\x3d'share-groups-table'\x3e\x3ctr\x3e\x3ctd width\x3d'17' valign\x3d'bottom'\x3e\x3cinput id\x3d\"group_"+a+'" '+p+' value\x3d"'+m.id+'" type\x3d"checkbox" class\x3d\'share-groups-input-checkbox\' dojoType\x3d"dijit.form.Checkbox" /\x3e\x3c/td\x3e\x3ctd\x3e\x3clabel for\x3d\'group_'+
a+"' class\x3d'labels'\x3e"+m.title+"\x3c/label\x3e"):l+('\x3cdiv id\x3d"group_'+a+"_div\" style\x3d\"display:block;\"\x3e\x3ctable cellpadding\x3d'0' cellspacing\x3d'0' class\x3d'share-groups-table'\x3e\x3ctr\x3e\x3ctd width\x3d'17' valign\x3d'bottom'\x3e\x3cinput id\x3d\"group_"+a+'" '+p+' value\x3d"'+m.id+'" type\x3d"checkbox" class\x3d\'share-groups-input-checkbox\' dojoType\x3d"dijit.form.Checkbox" /\x3e\x3c/td\x3e\x3ctd\x3e\x3clabel for\x3d\'group_'+a+"' class\x3d'labels'\x3e"+m.title+"\x3c/label\x3e");
l=this._addOpenDataStr(m,l);l+="\x3c/td\x3e\x3c/tr\x3e\x3c/table\x3e\x3c/div\x3e"}if(this.shareInfo.adminGroups&&this.shareInfo.adminGroups.length&&1<this.shareInfo.lowestAccess)for(l+='\x3cdiv style\x3d"display:block;"\x3e\x3chr/\x3e\x3c/div\x3e',b=0;b<this.shareInfo.adminGroups.length;b++){m=this.shareInfo.adminGroups[b];p="";q=this.shareInfo.items.length;if(-1<this.shareInfo.itemsAreSharedToGroups.indexOf(","+m.id+",")){p="checked";d=!0;for(var r=0;r<g.length;r++)if(g[r][0]===m.id){q=g[r][1];break}}l=
q<this.shareInfo.items.length?l+('\x3cdiv id\x3d"img_group_'+(b+a)+"_div\" style\x3d\"display:block;\"\x3e\x3ctable cellpadding\x3d'0' cellspacing\x3d'0' class\x3d'share-groups-table'\x3e\x3ctr\x3e\x3ctd width\x3d'17' valign\x3d'bottom'\x3e\x3cimg id\x3d\"img_group_"+(b+a)+'" src\x3d"'+this._checkboxImgUrl+'" border\x3d"0"\x3e\x3c/td\x3e\x3ctd\x3e'+m.title+'\x3c/td\x3e\x3c/tr\x3e\x3c/table\x3e\x3c/div\x3e\x3cdiv id\x3d"group_'+(b+a)+"_div\" style\x3d\"display:none;\"\x3e\x3ctable cellpadding\x3d'0' cellspacing\x3d'0'\x3e\x3ctr\x3e\x3ctd width\x3d'17' valign\x3d'bottom'\x3e\x3cinput id\x3d\"group_"+
(b+a)+'" '+p+' value\x3d"'+m.id+'" type\x3d"checkbox"class\x3d\'share-groups-input-checkbox\' dojoType\x3d"dijit.form.Checkbox" /\x3e\x3c/td\x3e\x3ctd\x3e\x3clabel for\x3d\'group_'+a+"'\x3e"+m.title+"\x3c/label\x3e"):l+('\x3cdiv id\x3d"group_'+(b+a)+"_div\" style\x3d\"display:block;\"\x3e\x3ctable cellpadding\x3d'0' cellspacing\x3d'0' class\x3d'share-groups-table'\x3e\x3ctr\x3e\x3ctd width\x3d'17' valign\x3d'bottom'\x3e\x3cinput id\x3d\"group_"+(b+a)+'" '+p+' value\x3d"'+m.id+'" type\x3d"checkbox"class\x3d\'share-groups-input-checkbox\' dojoType\x3d"dijit.form.Checkbox" /\x3e\x3c/td\x3e\x3ctd\x3e\x3clabel for\x3d\'group_'+
a+"'\x3e"+m.title+"\x3c/label\x3e");l=this._addOpenDataStr(m,l);l+="\x3c/td\x3e\x3c/tr\x3e\x3c/table\x3e\x3c/div\x3e"}this.own(e(c.byId("share-groups-list"),"click",k.hitch(this,this.checkGroup)));c.byId("share-groups-list").innerHTML=l;if(this.shareInfo.organization){for(a=g=0;a<this.shareInfo.items.length;a++)this.shareInfo.items[a].sharing&&"org"===this.shareInfo.items[a].sharing.access&&g++;!this.shareInfo._isCustomRole||this.shareInfo._roleCanShareToOrg||this.shareInfo._roleCanShareOthersItemsToOrg?
(0===g?(dijit.byId("share-account-check").set("checked",!1),dijit.byId("share-account-check").set("disabled",!1)):g===this.shareInfo.items.length?(dijit.byId("share-account-check").set("checked",!0),dijit.byId("share-account-check").set("disabled",!1)):(dijit.byId("share-account-check").set("checked",!0),dijit.byId("share-account-check").set("disabled",!0)),h.set(c.byId("share-account-check_div"),"display","block")):(dijit.byId("share-account-check").set("disabled",!0),h.set(c.byId("share-account-check_div"),
"display","none"))}if(!this.shareInfo.organization||this.shareInfo._orgUserCanSharePublicOrOverride){for(a=g=0;a<this.shareInfo.items.length;a++)this.shareInfo.items[a].sharing&&"public"===this.shareInfo.items[a].sharing.access&&g++;0===g?(dijit.byId("share-everyone-check").set("checked",!1),h.set(c.byId("share-everyone-check_div"),"display","block")):(g===this.shareInfo.items.length?(dijit.byId("share-everyone-check").set("checked",!0),h.set(c.byId("share-everyone-check_div"),"display","block")):
dijit.byId("share-everyone-check").set("checked",!0),this.shareInfo.organization&&(!this.shareInfo._isCustomRole||this.shareInfo._roleCanShareToOrg||this.shareInfo._roleCanShareOthersItemsToOrg)&&(dijit.byId("share-account-check").set("checked",!0),dijit.byId("share-account-check").set("disabled",dijit.byId("share-everyone-check").get("checked"))));this.clickEveryone()}else dijit.byId("share-everyone-check").set("checked",!1),h.set(c.byId("share-everyone-check_div"),"display","none");d?dijit.byId("share-groups-check").set("checked",
!0):dijit.byId("share-groups-check").set("checked",!1);this.own(e(c.byId("share-groups-check"),"click",k.hitch(this,this.checkGroups)));this.shareInfo.organization&&(!this.shareInfo._isCustomRole||this.shareInfo._roleCanShareToOrg||this.shareInfo._roleCanShareOthersItemsToOrg)&&this.own(e(c.byId("share-account-check"),"click",k.hitch(this,this.clickAccount)))},buildList:function(){var a,b;!this.shareInfo._isCustomRole||this.shareInfo._roleCanShareToGroup||this.shareInfo._roleCanShareOthersItemsToGroup?
this.shareInfo.userGroups&&0<this.shareInfo.userGroups.length&&h.set(c.byId("share-groups-div"),"display","block"):h.set(c.byId("share-groups-div"),"display","none");this.shareInfo.itemsAreSharedToGroups=",";var d=[];for(a=0;a<this.shareInfo.items.length;a++){var g=this.shareInfo.items[a];if(g.sharing)for(var l=0;l<g.sharing.groups.length;l++){var m=g.sharing.groups[l];if(-1===this.shareInfo.itemsAreSharedToGroups.indexOf(","+m+","))this.shareInfo.itemsAreSharedToGroups+=m+",",b=[],b[0]=m,b[1]=1,
d[d.length]=b;else for(b=0;b<d.length;b++)if(d[b][0]===m){d[b][1]+=1;break}}}l="";g=!1;for(a=0;a<this.shareInfo.userGroups.length;a++){var m=this.shareInfo.userGroups[a],p="",q=this.shareInfo.items.length;if(-1<this.shareInfo.itemsAreSharedToGroups.indexOf(","+m.id+","))for(p="checked",g=!0,b=0;b<d.length;b++)if(d[b][0]===m.id){q=d[b][1];break}l=q<this.shareInfo.items.length?l+('\x3cdiv id\x3d"img_group_'+a+"_div\" style\x3d\"display:block;\"\x3e\x3ctable cellpadding\x3d'0' cellspacing\x3d'0' class\x3d'share-groups-table'\x3e\x3ctr\x3e\x3ctd width\x3d'17' valign\x3d'bottom'\x3e\x3cimg id\x3d\"img_group_"+
a+'" src\x3d"'+this._checkboxImgUrl+'" border\x3d"0"\x3e\x3c/td\x3e\x3ctd\x3e'+m.title+'\x3c/td\x3e\x3c/tr\x3e\x3c/table\x3e\x3c/div\x3e\x3cdiv id\x3d"group_'+a+"_div\" style\x3d\"display:none;\"\x3e\x3ctable cellpadding\x3d'0' cellspacing\x3d'0'\x3e\x3ctr\x3e\x3ctd width\x3d'17' valign\x3d'bottom'\x3e\x3cinput id\x3d\"group_"+a+'" '+p+' value\x3d"'+m.id+'" type\x3d"checkbox"class\x3d\'share-groups-input-checkbox\' dojoType\x3d"dijit.form.Checkbox" /\x3e\x3c/td\x3e\x3ctd\x3e\x3clabel for\x3d\'group_'+
a+"'\x3e"+m.title+"\x3c/label\x3e"):l+('\x3cdiv id\x3d"group_'+a+"_div\" style\x3d\"display:block;\"\x3e\x3ctable cellpadding\x3d'0' cellspacing\x3d'0' class\x3d'share-groups-table'\x3e\x3ctr\x3e\x3ctd width\x3d'17' valign\x3d'bottom'\x3e\x3cinput id\x3d\"group_"+a+'" '+p+' value\x3d"'+m.id+'" type\x3d"checkbox"class\x3d\'share-groups-input-checkbox\' dojoType\x3d"dijit.form.Checkbox" /\x3e\x3c/td\x3e\x3ctd\x3e\x3clabel for\x3d\'group_'+a+"'\x3e"+m.title+"\x3c/label\x3e");l=this._addOpenDataStr(m,
l);l+="\x3c/td\x3e\x3c/tr\x3e\x3c/table\x3e\x3c/div\x3e"}this.own(e(c.byId("share-groups-list"),"click",k.hitch(this,this.checkGroup)));c.byId("share-groups-list").innerHTML=l;if(this.shareInfo.organization&&this.shareInfo.userRole&&(!this.shareInfo._isCustomRole||this.shareInfo._roleCanShareToOrg||this.shareInfo._roleCanShareOthersItemsToOrg)){for(a=d=0;a<this.shareInfo.items.length;a++)this.shareInfo.items[a].sharing&&"org"===this.shareInfo.items[a].sharing.access&&d++;0===d?dijit.byId("share-account-check").set("checked",
!1):dijit.byId("share-account-check").set("checked",!0);h.set(c.byId("share-account-check_div"),"display","block")}if(!this.shareInfo.organization||this.shareInfo._orgUserCanSharePublicOrOverride){for(a=d=0;a<this.shareInfo.items.length;a++)this.shareInfo.items[a].sharing&&"public"===this.shareInfo.items[a].sharing.access&&d++;0===d?(dijit.byId("share-everyone-check").set("checked",!1),h.set(c.byId("share-everyone-check_div"),"display","block")):(d===this.shareInfo.items.length?(dijit.byId("share-everyone-check").set("checked",
!0),h.set(c.byId("share-everyone-check_div"),"display","block")):dijit.byId("share-everyone-check").set("checked",!0),this.shareInfo.organization&&this.shareInfo.userRole&&(!this.shareInfo._isCustomRole||this.shareInfo._roleCanShareToOrg||this.shareInfo._roleCanShareOthersItemsToOrg)&&(dijit.byId("share-account-check").set("checked",!0),h.set(c.byId("share-everyone-check_div"),"display","block")));this.clickEveryone()}else if(this.shareInfo.organization&&!this.shareInfo.organization.canSharePublic){for(a=
d=0;a<this.shareInfo.items.length;a++)this.shareInfo.items[a].sharing&&"public"===this.shareInfo.items[a].sharing.access&&d++;d?(dijit.byId("share-everyone-check").set("checked",!0),this.shareInfo.organization&&this.shareInfo.userRole&&(!this.shareInfo._isCustomRole||this.shareInfo._roleCanShareToOrg||this.shareInfo._roleCanShareOthersItemsToOrg)&&(dijit.byId("share-account-check").set("checked",!0),h.set(c.byId("share-account-check_div"),"display","block"))):(dijit.byId("share-everyone-check").set("checked",
!1),h.set(c.byId("share-everyone-check_div"),"display","none"))}else dijit.byId("share-everyone-check").set("checked",!1),h.set(c.byId("share-everyone-check_div"),"display","none");g?dijit.byId("share-groups-check").set("checked",!0):dijit.byId("share-groups-check").set("checked",!1);this.own(e(c.byId("share-groups-check"),"click",k.hitch(this,this.checkGroups)));this.shareInfo.organization&&(!this.shareInfo._isCustomRole||this.shareInfo._roleCanShareToOrg||this.shareInfo._roleCanShareOthersItemsToOrg)&&
this.own(e(c.byId("share-account-check"),"click",k.hitch(this,this.clickAccount)))},buildGroupList:function(){var a,b;!this.shareInfo._isCustomRole||this.shareInfo._roleCanShareToGroup||this.shareInfo._roleCanShareOthersItemsToGroup?0<this.shareInfo.userGroups.length&&h.set(c.byId("share-groups-div"),"display","block"):h.set(c.byId("share-groups-div"),"display","none");this.shareInfo.itemsAreSharedToGroups=",";var d=[];for(a=0;a<this.shareInfo.items.length;a++){var g=this.shareInfo.items[a];if(g.sharing)for(var l=
0;l<g.sharing.groups.length;l++){var m=g.sharing.groups[l];if(-1===this.shareInfo.itemsAreSharedToGroups.indexOf(","+m+","))this.shareInfo.itemsAreSharedToGroups+=m+",",b=[],b[0]=m,b[1]=1,d[d.length]=b;else for(b=0;b<d.length;b++)if(d[b][0]===m){d[b][1]+=1;break}}}var g="",l=!1,p,q;for(a=0;a<this.shareInfo.userGroups.length;a++){m=this.shareInfo.userGroups[a];p="";q=this.shareInfo.items.length;if(-1<this.shareInfo.itemsAreSharedToGroups.indexOf(","+m.id+","))for(p="checked",l=!0,b=0;b<d.length;b++)if(d[b][0]===
m.id){q=d[b][1];break}g=q<this.shareInfo.items.length?g+('\x3cdiv id\x3d"img_group_'+a+"_div\" style\x3d\"display:block;\"\x3e\x3ctable cellpadding\x3d'0' cellspacing\x3d'0' class\x3d'share-groups-table'\x3e\x3ctr\x3e\x3ctd width\x3d'17' valign\x3d'bottom'\x3e\x3cimg id\x3d\"img_group_"+a+'" src\x3d"'+this._checkboxImgUrl+'" border\x3d"0"\x3e\x3c/td\x3e\x3ctd\x3e'+m.title+'\x3c/td\x3e\x3c/tr\x3e\x3c/table\x3e\x3c/div\x3e\x3cdiv id\x3d"group_'+a+"_div\"style\x3d\"display:none;\"\x3e\x3ctable cellpadding\x3d'0' cellspacing\x3d'0'\x3e\x3ctr\x3e\x3ctd width\x3d'17' valign\x3d'bottom'\x3e\x3cinput id\x3d\"group_"+
a+'" '+p+' value\x3d"'+m.id+'" type\x3d"checkbox"class\x3d\'share-groups-input-checkbox\' dojoType\x3d"dijit.form.Checkbox" /\x3e\x3c/td\x3e\x3ctd\x3e\x3clabel for\x3d\''+m.id+"'\x3e"+m.title+"\x3c/label\x3e"):g+('\x3cdiv id\x3d"group_'+a+"_div\" style\x3d\"display:block;\"\x3e\x3ctable cellpadding\x3d'0' cellspacing\x3d'0' class\x3d'share-groups-table'\x3e\x3ctr\x3e\x3ctd width\x3d'17' valign\x3d'bottom'\x3e\x3cinput id\x3d\"group_"+a+'" '+p+' value\x3d"'+m.id+'" type\x3d"checkbox"class\x3d\'share-groups-input-checkbox\' dojoType\x3d"dijit.form.Checkbox" /\x3e\x3c/td\x3e\x3ctd\x3e\x3clabel for\x3d\'group_'+
a+"'\x3e"+m.title+"\x3c/label\x3e");g=this._addOpenDataStr(m,g);g+="\x3c/td\x3e\x3c/tr\x3e\x3c/table\x3e\x3c/div\x3e"}this.own(e(c.byId("share-groups-list"),"click",k.hitch(this,this.checkGroup)));c.byId("share-groups-list").innerHTML=g;l?dijit.byId("share-groups-check").set("checked",!0):dijit.byId("share-groups-check").set("checked",!1);this.own(e(c.byId("share-groups-check"),"click",k.hitch(this,this.checkGroups)))},share:function(a){"group"===this.shareInfo.shareType?this.shareItemToGroups():
"admin"===this.shareInfo.shareType?this.shareItemAsAdmin(a):this.shareItem(a)},checkGroup:function(a){-1<a.target.id.indexOf("img_group_")&&(h.set(c.byId(a.target.id+"_div"),"display","none"),h.set(c.byId(a.target.id.substring(4,a.target.id.length)+"_div"),"display","block"));!0===a.target.checked&&-1<a.target.id.indexOf("group_")&&dijit.byId("share-groups-check").set("checked",!0)},checkGroups:function(){},clickEveryone:function(){var b=dijit.byId("share-everyone-check").get("checked");if(!0===b){var d=
c.byId("share-account-check_div");this.shareInfo.organization&&d&&"block"===h.get(d,"display")&&(dijit.byId("share-account-check").set("checked",!0),dijit.byId("share-account-check").set("disabled",!0))}else this.shareInfo.organization&&this.shareInfo.userRole&&(!this.shareInfo._isCustomRole||this.shareInfo._roleCanShareToOrg||this.shareInfo._roleCanShareOthersItemsToOrg)&&h.set(c.byId("share-account-check_div"),"display","block"),dijit.byId("share-account-check").set("disabled",!1);a.publish("ShareOptions/onClickEveryone",
b)},clickAccount:function(){!0===dijit.byId("share-account-check").get("checked")?(this.shareInfo._orgUserCanSharePublicOrOverride&&("none"===h.get(c.byId("share-everyone-check_div"),"display")&&h.set(c.byId("share-everyone-check_div"),"display","block"),dijit.byId("share-everyone-check").set("checked",!1)),dijit.byId("share-account-check").set("checked",!0)):dijit.byId("share-account-check").set("checked",!1)},shareItemAsAdmin:function(){var a="",b="";p.forEach(this.shareInfo.items,function(c){a+=
b+c.id;b=","});var d=!1,e=!1;c.byId("share-everyone-check_div")&&"block"===h.get(c.byId("share-everyone-check_div"),"display")&&(d=dijit.byId("share-everyone-check").get("checked"));c.byId("share-account-check_div")&&"block"===h.get(c.byId("share-account-check_div"),"display")&&(e=dijit.byId("share-account-check").get("checked"));var g="",l="",m="",q="",r=0;if(dijit.byId("share-groups-check").get("checked")){var B;if(this.shareInfo.user.groups&&this.shareInfo.user.groups.length)for(r=0;r<this.shareInfo.user.groups.length;r++)B=
this.shareInfo.user.groups[r].id,"block"===h.get(c.byId("group_"+r+"_div"),"display")&&(c.byId("group_"+r).checked?(g+=m+B,m=","):(l+=q+B,q=","));if(this.shareInfo.adminGroups&&this.shareInfo.adminGroups.length&&1<this.shareInfo.lowestAccess)for(var C=0;C<this.shareInfo.adminGroups.length;C++)B=this.shareInfo.adminGroups[C].id,"block"===h.get(c.byId("group_"+(C+r)+"_div"),"display")&&(c.byId("group_"+(C+r)).checked?(g+=m+B,m=","):(l+=q+B,q=","))}else q="",this.shareInfo.user.groups&&this.shareInfo.user.groups.length&&
p.forEach(this.shareInfo.user.groups,function(a){l+=q+a.id;q=","}),this.shareInfo.adminGroups&&this.shareInfo.adminGroups.length&&1<this.shareInfo.lowestAccess&&p.forEach(this.shareInfo.adminGroups,function(a){l+=q+a.id;q=","});if(0<l.length)for(m={items:a,groups:l},r=0;r<this.shareInfo.items.length;r++)u._unshareItemById(m,this.shareInfo.items[r].id,this.portalUrl).then(k.hitch(this,this.unShareHandler_admin,this.shareInfo.items,a,g,d,e));else this.unShareHandler_admin(this.shareInfo.items,a,g,d,
e)},unShareHandler_admin:function(a,b,c,d,e){var f=a.length,g=function(){f--};b={items:b,groups:c,everyone:d,account:e};for(c=0;c<a.length;c++)d=a[c],this.shareInfo.user.shareItem(b,d.id,d.folderId).then(k.hitch(this,g))},shareItem:function(){var a="",b="";p.forEach(this.shareInfo.items,function(c){a+=b+c.id;b=","});var d=!1,e=!1;c.byId("share-everyone-check_div")&&"block"===h.get(c.byId("share-everyone-check_div"),"display")&&(d=dijit.byId("share-everyone-check").get("checked"));c.byId("share-account-check_div")&&
"block"===h.get(c.byId("share-account-check_div"),"display")&&(e=dijit.byId("share-account-check").get("checked"));var g=dijit.byId("share-groups-check").get("checked"),l="",m="",q="",r="";this.shareInfo.userGroups=this.shareInfo.user.group;g?this.shareInfo.userGroups&&this.shareInfo.userGroups.length&&p.forEach(this.shareInfo.userGroups,function(a,b){var d=a.id;"block"===h.get(c.byId("group_"+b+"_div"),"display")&&(c.byId("group_"+b).checked?(l+=q+d,q=","):(m+=r+d,r=","))}):(r="",this.shareInfo.userGroups&&
this.shareInfo.userGroups.length&&p.forEach(this.shareInfo.userGroups,function(a){m+=r+a.id;r=","}));0<m.length?(g={items:a,groups:m},this.shareInfo.itemUser&&null!==this.shareInfo.itemUser?u.unshareItemsByUser(this.shareInfo.itemUser.username?this.shareInfo.itemUser.username:this.shareInfo.itemUser.email,g,this.portalUrl).then(k.hitch(this,this.unShareHandler_item,this.shareInfo.itemUser,a,l,d,e)):u.unshareItems(this.shareInfo.itemUser,g,this.portalUrl).then(k.hitch(this,this.unShareHandler_item,
this.shareInfo.itemUser,a,l,d,e))):this.unShareHandler_item(this.shareInfo.itemUser,a,l,d,e)},unShareHandler_item:function(a,b,c,d,e){b={items:b,groups:c,everyone:d,account:e};a&&null!==a?u.shareItemsByUser(a.username?a.username:a.email,b,this.portalUrl).then(k.hitch()):u.shareItems(a,b,this.portalUrl).then()},findLowestAccessLevel:function(a){for(var b=3,c,d,e=0;e<a.length;e++)(d=a[e].access)||(d="private"),1===d.length&&(d=d[0]),"public"===d?c=3:"org"===d?c=2:"shared"===d?c=1:"private"===d&&(c=
0),c<b&&(b=c);return b},_sortFunc:function(a,b){var c=a[this.shareInfo.sortField].toLowerCase(),d=b[this.shareInfo.sortField].toLowerCase();return null===c||null===d||c===d?0:c<d?-1:1},_addOpenDataStr:function(a,b){a.isOpenData&&!u.portal.isPortal&&(b+=" "+this.i18n.openData);return b},_clearGroupCheckboxes:function(){if(!1===dijit.byId("share-groups-check").get("checked"))for(var a=b(".share-groups-input-checkbox"),c=0,d=a.length;c<d;c++)a[c].setAttribute("value",!1)}})})},"jimu/shareUtils":function(){define("dojo/_base/lang esri/request dojo/promise/all jimu/shared/basePortalUrlUtils dojo/Deferred esri/lang jimu/portalUtils jimu/Role jimu/utils esri/urlUtils".split(" "),
function(r,l,d,q,k,m,p,h,e,c){var b={getBaseHrefUrl:function(a){var b="HTML3D"===window.appInfo.appType?"webappviewer3d":"webappviewer",c="";window.isXT?c=window.location.protocol+"//"+window.location.host+window.appInfo.appPath:(c=e.urlToObject(window.location.href).query||{},c=c.appid?a+"apps/"+b+"/index.html?appid\x3d"+c.appid:c.id?a+"apps/"+b+"/index.html?id\x3d"+c.id:e.getAppHref());return c},addQueryParamToUrl:function(a,b,d,e){a=c.urlToObject(a);a.query||(a.query={});a.query[b]=d;b=a.path;
for(var g in a.query)d=a.query[g],!0===e&&(d=encodeURIComponent(d)),b=b===a.path?b+"?"+g+"\x3d"+d:b+"\x26"+g+"\x3d"+d;return b},removeQueryParamFromUrl:function(a,b,d){a=c.urlToObject(a);a.query&&delete a.query[b];b=a.path;for(var e in a.query){var g=a.query[e];!0===d&&(g=encodeURIComponent(g));b=b===a.path?b+"?"+e+"\x3d"+g:b+"\x26"+e+"\x3d"+g}return b},getShareUrlContent:function(a){return"\x3cdiv class\x3d'marker-feature-action-popup'\x3e\x3cdiv class\x3d'item'\x3e\x3cspan class\x3d'sub-title jimu-float-leading'\x3e"+
window.jimuNls.common.url+"\x3c/span\x3e\x3cinput type\x3d'text' class\x3d'jimu-float-leading' readonly\x3d'readonly' value\x3d"+a+"\x3e\x3c/input\x3e\x3c/div\x3e\x3c/div\x3e"},getShareUrl:function(a,c,d){var e=b.getBaseHrefUrl(window.portalUrl),g="",f,h,k,l,m;c&&(c.longitude&&c.latitude?(f=c.longitude,h=c.latitude,g=c.longitude+","+c.latitude+","):c.x&&c.y&&c.spatialReference&&c.spatialReference.wkid&&(k=c.x,l=c.y,m=c.spatialReference.wkid,g=c.x+","+c.y+","+c.spatialReference.wkid));e=b.addQueryParamToUrl(e,
"marker",g,!0);e=b.addQueryParamToUrl(e+",,,","markertemplate",encodeURIComponent(JSON.stringify({title:c.title,x:k,y:l,wkid:m,longitude:f,latitude:h,isIncludeShareUrl:d})));c=a.getLevel();return e="number"===typeof c&&-1!==c?b.addQueryParamToUrl(e,"level",a.getLevel(),!0):b.addQueryParamToUrl(e,"scale",a.getScale(),!0)},getXyContent:function(a){var b="\x3cdiv class\x3d'marker-feature-action-popup'\x3e";a.longitude&&a.latitude?b+="\x3cdiv class\x3d'item clearFix'\x3e\x3cspan class\x3d'sub-title'\x3e"+
window.jimuNls.common.longitude+"\x3c/span\x3e\x3cspan class\x3d'val'\x3e"+e.localizeNumber(parseFloat(a.longitude).toFixed(4))+"\x3c/span\x3e\x3c/div\x3e\x3cdiv class\x3d'item clearFix'\x3e\x3cspan class\x3d'sub-title'\x3e"+window.jimuNls.common.latitude+"\x3c/span\x3e\x3cspan class\x3d'val'\x3e"+e.localizeNumber(parseFloat(a.latitude).toFixed(4))+"\x3c/span\x3e\x3c/div\x3e":a.x&&a.y&&(b+="\x3cdiv class\x3d'item clearFix'\x3e\x3cspan class\x3d'sub-title'\x3ex\x3c/span\x3e\x3cspan class\x3d'val'\x3e"+
e.localizeNumber(parseFloat(a.x).toFixed(4))+"\x3c/span\x3e\x3c/div\x3e\x3cdiv class\x3d'item'\x3e\x3cspan class\x3d'sub-title'\x3ey\x3c/span\x3e\x3cspan class\x3d'val'\x3e"+e.localizeNumber(parseFloat(a.y).toFixed(4))+"\x3c/span\x3e\x3c/div\x3e");return b+"\x3c/div\x3e"},_isUserOwnTheApp:function(a){return a&&a.username&&a.username===window.appInfo.appOwner?!0:!1},getItemByUserAndItemId:function(a,b,c,d){var e=new k;d=q.getStandardPortalUrl(d);d=d+"/sharing/rest/content/users/"+(b?b.username?b.username:
b.email:c.email);if(m.isDefined(a.folderId)&&"/"!==a.folderId||m.isDefined(a.ownerFolder)&&"/"!==a.ownerFolder)d+="/"+(a.folderId||a.ownerFolder);d+="/items/"+a.id;l({url:d,handleAs:"json",content:{f:"json"},callbackParamName:"callback"}).then(r.hitch(this,function(a){e.resolve(a)}),r.hitch(this,function(a){console.error(a);e.reject(a)}));return e},_getProfile:function(a,b){var c=new k,d=q.getUserUrl(b,a.owner);l({url:d,handleAs:"json",content:{f:"json"},callbackParamName:"callback"}).then(r.hitch(this,
function(a){c.resolve(a)}),r.hitch(this,function(a){console.error(a);c.reject(a)}));return c},_unshareItemById:function(a,b,c){var d=new k;c=q.getStandardPortalUrl(c);c+="/sharing/rest/content/items/"+b+"/unshare";b={f:"json"};b=r.mixin(b,a);l({url:c,handleAs:"json",content:b,callbackParamName:"callback"},{usePost:!0}).then(r.hitch(this,function(a){d.resolve(a)}),r.hitch(this,function(a){console.error(a);d.reject(a)}));return d},canSharePublic:function(a){return!a.selfUrl||!0!==a.canSharePublic&&
!1!==a.canSharePublic?!0:a.canSharePublic},unshareItemsByUser:function(a,b,c){var d=new k;c=q.getStandardPortalUrl(c);c+="/sharing/rest/content/users/"+a+"/unshareItems";a={f:"json"};a=r.mixin(a,b);l({url:c,handleAs:"json",content:a,callbackParamName:"callback"},{usePost:!0}).then(r.hitch(this,function(a){d.resolve(a)}),r.hitch(this,function(a){console.error(a);d.reject(a)}));return d},unshareItems:function(a,b,c){var d=new k;c=q.getStandardPortalUrl(c);c+="/sharing/rest/content/users/"+(b.owner||
a.email)+"/unshareItems";a={f:"json"};a=r.mixin(a,b);l({url:c,handleAs:"json",content:a,callbackParamName:"callback"},{usePost:!0}).then(r.hitch(this,function(a){d.resolve(a)}),r.hitch(this,function(a){console.error(a);d.reject(a)}));return d},shareItemsByUser:function(a,b,c){var d=new k;c=q.getStandardPortalUrl(c);c+="/sharing/rest/content/users/"+a+"/shareItems";a={f:"json"};a=r.mixin(a,b);l({url:c,handleAs:"json",content:a,callbackParamName:"callback"},{usePost:!0}).then(r.hitch(this,function(a){d.resolve(a)}),
r.hitch(this,function(a){console.error(a);d.reject(a)}));return d},shareItems:function(a,b,c){var d=new k;c=q.getStandardPortalUrl(c);c+="/sharing/rest/content/users/"+(b.owner||a.email)+"/shareItems";a={f:"json"};a=r.mixin(a,b);l({url:c,handleAs:"json",content:a,callbackParamName:"callback"},{usePost:!0}).then(r.hitch(this,function(a){d.resolve(a)}),r.hitch(this,function(a){console.error(a);d.reject(a)}));return d},getItemsGroups:function(a,b){var c=new k,d=q.getStandardPortalUrl(b),d=d+("/sharing/rest/content/items/"+
a.id+"/groups");l({url:d,handleAs:"json",content:{f:"json"},callbackParamName:"callback"},{usePost:!0}).then(r.hitch(this,function(a){c.resolve(a)}),r.hitch(this,function(a){console.error(a);c.reject(a)}));return c},isSharedToPublic:function(a){return window.isXT?!1:null===a?!0:"undefined"!==typeof a&&"undefined"!==typeof a.item&&"undefined"!==typeof a.item.access&&"public"===a.item.access?!0:!1},isShowSocialMediaLinks:function(a){return window.isXT?!0:null===a?!0:"undefined"!==typeof a&&"undefined"!==
typeof a.item&&"undefined"!==typeof a.item.access&&"private"===a.item.access?!1:!0},getItemShareInfo:function(a){var b=new k,c="";if(window.isXT)return b.resolve(null);c=e.urlToObject(e.getAppHref()).query||{};c=c.id||c.appid;if("undefined"===typeof c||""===c)return b.resolve(null);p.getPortal(a).getItemById(c).then(r.hitch(this,function(a){var c={};c.item=a;c.item&&"undefined"===typeof c.item.sharing&&c.item.access&&(c.item.sharing={access:c.item.access});b.resolve(c)}),r.hitch(this,function(a){console.log(a);
b.resolve(null)}));return b},getShareInfo:function(a){var c=p.getPortal(a),h=new k,l="";if(window.isXT)return h.resolve(null);l=e.urlToObject(e.getAppHref()).query||{};l=l.id||l.appid;if("undefined"===typeof l||""===l)return h.resolve(null);d({getUser:c.getUser(),loadSelfInfo:c.loadSelfInfo(),getItem:c.getItemById(l)}).then(r.hitch(this,function(c){var d={};d.item=c.getItem;d.item&&d.item.ownerFolder&&d.item.ownerFolder.length&&"/"!==d.item.ownerFolder&&(d.item.folderId=d.item.ownerFolder);"undefined"===
typeof d.item.sharing&&d.item.access&&(d.item.sharing={access:d.item.access});d.user=c.getUser;b._setUserRole(c.loadSelfInfo,d);d.currentUser=d.user;d.isAdmin=!1;d.userRole&&(d.userRole.isAdmin()||d.userRole.isCustom()&&d.userRole.canUpdateOrgItems())?(d.isAdmin=!0,d.item.owner!==d.currentUser.name?b._getProfile(d.item,a).then(r.hitch(this,function(a){d.itemUser=a;d.itemUser.orgId!==d.currentUser.orgId&&(d.isAdmin=!1);h.resolve(d)})):(d.itemUser=d.currentUser,h.resolve(d))):(d.currentUser&&(d.itemUser=
d.currentUser),h.resolve(d))}),r.hitch(this,function(a){console.log(a);h.resolve(null)}));return h},_setUserRole:function(a,b){b.userPortalUrl=a.urlKey?a.urlKey+"."+a.customBaseUrl:this.portalUrl;!a||a.code||a.message||(b.organization=a);if(a&&a.user)b.userRole=new h({id:a.user.roleId?a.user.roleId:a.user.role,role:a.user.role}),b._isCustomRole=b.userRole.isCustom(),b._roleCanShareToGroup=b._isCustomRole&&b.userRole.canShareItemToGroup(),b._roleCanShareToOrg=b._isCustomRole&&b.userRole.canShareItemToOrg(),
b._roleCanSharePublic=b._isCustomRole&&b.userRole.canShareItemToPublic(),b._roleCanShare=b._roleCanShareToGroup||b._roleCanShareToOrg||b._roleCanShareToPublic,b._roleCanUpdateItems=b._isCustomRole&&b.userRole.canUpdateOrgItems(),b._roleCanShareOthersItemsToGroup=b._isCustomRole&&b.userRole.canShareOthersItemsToGroup(),b._roleCanShareOthersItemsToOrg=b._isCustomRole&&b.userRole.canShareOthersItemsToOrg(),b._roleCanShareOthersItemsToPublic=b._isCustomRole&&b.userRole.canShareOthersItemsToPublic(),b._roleCanShareOthersItems=
b._isCustomRole&&(b.userRole.canShareOthersItemsToGroup()||b.userRole.canShareOthersItemsToOrg()||b._roleCanShareOthersItemsToPublic),b._orgUserCanSharePublicOrOverride=b.organization&&(!0===b.organization.canSharePublic&&(!b._isCustomRole||b._roleCanSharePublic||b._roleCanShareOthersItemsToPublic)||b.userRole.isAdmin());else return!1},getItemById:function(a,b){var c=new k,d=q.getStandardPortalUrl(b),d=d+("/sharing/rest/content/items/"+a.id);l({url:d,handleAs:"json",content:{f:"json"},callbackParamName:"callback"}).then(r.hitch(this,
function(a){c.resolve(a)}),r.hitch(this,function(a){console.error(a);c.reject(a)}));return c}};return b})},"dijit/form/Textarea":function(){define(["dojo/_base/declare","dojo/dom-style","./_ExpandingTextAreaMixin","./SimpleTextarea"],function(r,l,d,q){return r("dijit.form.Textarea",[q,d],{baseClass:"dijitTextBox dijitTextArea dijitExpandingTextArea",cols:"",buildRendering:function(){this.inherited(arguments);l.set(this.textbox,{overflowY:"hidden",overflowX:"auto",boxSizing:"border-box",MsBoxSizing:"border-box",
WebkitBoxSizing:"border-box",MozBoxSizing:"border-box"})}})})},"dijit/form/_ExpandingTextAreaMixin":function(){define("dojo/_base/declare dojo/dom-construct dojo/has dojo/_base/lang dojo/on dojo/_base/window ../Viewport".split(" "),function(r,l,d,q,k,m,p){d.add("textarea-needs-help-shrinking",function(){var d=m.body(),e=l.create("textarea",{rows:"5",cols:"20",value:" ",style:{zoom:1,fontSize:"12px",height:"96px",overflow:"hidden",visibility:"hidden",position:"absolute",border:"5px solid white",margin:"0",
padding:"0",boxSizing:"border-box",MsBoxSizing:"border-box",WebkitBoxSizing:"border-box",MozBoxSizing:"border-box"}},d,"last"),c=e.scrollHeight>=e.clientHeight;d.removeChild(e);return c});return r("dijit.form._ExpandingTextAreaMixin",null,{_setValueAttr:function(){this.inherited(arguments);this.resize()},postCreate:function(){this.inherited(arguments);var d=this.textbox;d.style.overflowY="hidden";this.own(k(d,"focus, resize",q.hitch(this,"_resizeLater")))},startup:function(){this.inherited(arguments);
this.own(p.on("resize",q.hitch(this,"_resizeLater")));this._resizeLater()},_onInput:function(d){this.inherited(arguments);this.resize()},_estimateHeight:function(){var d=this.textbox;d.rows=(d.value.match(/\n/g)||[]).length+1},_resizeLater:function(){this.defer("resize")},resize:function(){function h(){var a=!1;""===e.value&&(e.value=" ",a=!0);var b=e.scrollHeight;a&&(e.value="");return b}var e=this.textbox;"hidden"==e.style.overflowY&&(e.scrollTop=0);if(!this.busyResizing){this.busyResizing=!0;if(h()||
e.offsetHeight){var c=h()+Math.max(e.offsetHeight-e.clientHeight,0),b=c+"px";b!=e.style.height&&(e.style.height=b,e.rows=1);if(d("textarea-needs-help-shrinking")){var a=h(),g=e.style.minHeight,k=4,l=e.scrollTop;e.style.minHeight=b;for(e.style.height="auto";0<c;){e.style.minHeight=Math.max(c-k,4)+"px";b=h();a-=b;c-=a;if(a<k)break;a=b;k<<=1}e.style.height=c+"px";e.style.minHeight=g;e.scrollTop=l}e.style.overflowY=h()>e.clientHeight?"auto":"hidden";"hidden"==e.style.overflowY&&(e.scrollTop=0)}else this._estimateHeight();
this.busyResizing=!1}}})})},"dijit/layout/BorderContainer":function(){define("dojo/_base/array dojo/cookie dojo/_base/declare dojo/dom-class dojo/dom-construct dojo/dom-geometry dojo/dom-style dojo/keys dojo/_base/lang dojo/on dojo/touch ../_WidgetBase ../_Widget ../_TemplatedMixin ./LayoutContainer ./utils".split(" "),function(r,l,d,q,k,m,p,h,e,c,b,a,g,u,n,t){var f=d("dijit.layout._Splitter",[g,u],{live:!0,templateString:'\x3cdiv class\x3d"dijitSplitter" data-dojo-attach-event\x3d"onkeydown:_onKeyDown,press:_startDrag,onmouseenter:_onMouse,onmouseleave:_onMouse" tabIndex\x3d"0" role\x3d"separator"\x3e\x3cdiv class\x3d"dijitSplitterThumb"\x3e\x3c/div\x3e\x3c/div\x3e',
constructor:function(){this._handlers=[]},postMixInProperties:function(){this.inherited(arguments);this.horizontal=/top|bottom/.test(this.region);this._factor=/top|left/.test(this.region)?1:-1;this._cookieName=this.container.id+"_"+this.region},buildRendering:function(){this.inherited(arguments);q.add(this.domNode,"dijitSplitter"+(this.horizontal?"H":"V"));if(this.container.persist){var a=l(this._cookieName);a&&(this.child.domNode.style[this.horizontal?"height":"width"]=a)}},_computeMaxSize:function(){var a=
this.horizontal?"h":"w",b=m.getMarginBox(this.child.domNode)[a],c=r.filter(this.container.getChildren(),function(a){return"center"==a.region})[0],a=m.getContentBox(c.domNode)[a]-10;return Math.min(this.child.maxSize,b+a)},_startDrag:function(a){this.cover||(this.cover=k.place("\x3cdiv class\x3ddijitSplitterCover\x3e\x3c/div\x3e",this.child.domNode,"after"));q.add(this.cover,"dijitSplitterCoverActive");this.fake&&k.destroy(this.fake);(this._resize=this.live)||((this.fake=this.domNode.cloneNode(!0)).removeAttribute("id"),
q.add(this.domNode,"dijitSplitterShadow"),k.place(this.fake,this.domNode,"after"));q.add(this.domNode,"dijitSplitterActive dijitSplitter"+(this.horizontal?"H":"V")+"Active");this.fake&&q.remove(this.fake,"dijitSplitterHover dijitSplitter"+(this.horizontal?"H":"V")+"Hover");var d=this._factor,f=this.horizontal,g=f?"pageY":"pageX",h=a[g],l=this.domNode.style,f=f?"h":"w",n=p.getComputedStyle(this.child.domNode),r=m.getMarginBox(this.child.domNode,n)[f],t=this._computeMaxSize(),u=Math.max(this.child.minSize,
m.getPadBorderExtents(this.child.domNode,n)[f]+10),f=this.region,v="top"==f||"bottom"==f?"top":"left",x=parseInt(l[v],10),N=this._resize,M=e.hitch(this.container,"_layoutChildren",this.child.id),f=this.ownerDocument;this._handlers=this._handlers.concat([c(f,b.move,this._drag=function(a,b){var c=a[g]-h,e=d*c+r,f=Math.max(Math.min(e,t),u);(N||b)&&M(f);l[v]=c+x+d*(f-e)+"px"}),c(f,"dragstart",function(a){a.stopPropagation();a.preventDefault()}),c(this.ownerDocumentBody,"selectstart",function(a){a.stopPropagation();
a.preventDefault()}),c(f,b.release,e.hitch(this,"_stopDrag"))]);a.stopPropagation();a.preventDefault()},_onMouse:function(a){a="mouseover"==a.type||"mouseenter"==a.type;q.toggle(this.domNode,"dijitSplitterHover",a);q.toggle(this.domNode,"dijitSplitter"+(this.horizontal?"H":"V")+"Hover",a)},_stopDrag:function(a){try{this.cover&&q.remove(this.cover,"dijitSplitterCoverActive"),this.fake&&k.destroy(this.fake),q.remove(this.domNode,"dijitSplitterActive dijitSplitter"+(this.horizontal?"H":"V")+"Active dijitSplitterShadow"),
this._drag(a),this._drag(a,!0)}finally{this._cleanupHandlers(),delete this._drag}this.container.persist&&l(this._cookieName,this.child.domNode.style[this.horizontal?"height":"width"],{expires:365})},_cleanupHandlers:function(){for(var a;a=this._handlers.pop();)a.remove()},_onKeyDown:function(a){this._resize=!0;var b=this.horizontal,c=1;switch(a.keyCode){case b?h.UP_ARROW:h.LEFT_ARROW:c*=-1;case b?h.DOWN_ARROW:h.RIGHT_ARROW:break;default:return}b=m.getMarginSize(this.child.domNode)[b?"h":"w"]+this._factor*
c;this.container._layoutChildren(this.child.id,Math.max(Math.min(b,this._computeMaxSize()),this.child.minSize));a.stopPropagation();a.preventDefault()},destroy:function(){this._cleanupHandlers();delete this.child;delete this.container;delete this.cover;delete this.fake;this.inherited(arguments)}}),v=d("dijit.layout._Gutter",[g,u],{templateString:'\x3cdiv class\x3d"dijitGutter" role\x3d"presentation"\x3e\x3c/div\x3e',postMixInProperties:function(){this.inherited(arguments);this.horizontal=/top|bottom/.test(this.region)},
buildRendering:function(){this.inherited(arguments);q.add(this.domNode,"dijitGutter"+(this.horizontal?"H":"V"))}});d=d("dijit.layout.BorderContainer",n,{gutters:!0,liveSplitters:!0,persist:!1,baseClass:"dijitBorderContainer",_splitterClass:f,postMixInProperties:function(){this.gutters||(this.baseClass+="NoGutter");this.inherited(arguments)},_setupChild:function(a){this.inherited(arguments);var b=a.region,c=a.isLeftToRight();"leading"==b&&(b=c?"left":"right");"trailing"==b&&(b=c?"right":"left");b&&
"center"!=b&&(a.splitter||this.gutters)&&!a._splitterWidget&&(c=a.splitter?this._splitterClass:v,e.isString(c)&&(c=e.getObject(c)),c=new c({id:a.id+"_splitter",container:this,child:a,region:b,live:this.liveSplitters}),c.isSplitter=!0,a._splitterWidget=c,b="bottom"==b||b==(this.isLeftToRight()?"right":"left"),k.place(c.domNode,a.domNode,b?"before":"after"),c.startup())},layout:function(){this._layoutChildren()},removeChild:function(a){var b=a._splitterWidget;b&&(b.destroy(),delete a._splitterWidget);
this.inherited(arguments)},getChildren:function(){return r.filter(this.inherited(arguments),function(a){return!a.isSplitter})},getSplitter:function(a){return r.filter(this.getChildren(),function(b){return b.region==a})[0]._splitterWidget},resize:function(a,b){if(!this.cs||!this.pe){var c=this.domNode;this.cs=p.getComputedStyle(c);this.pe=m.getPadExtents(c,this.cs);this.pe.r=p.toPixelValue(c,this.cs.paddingRight);this.pe.b=p.toPixelValue(c,this.cs.paddingBottom);p.set(c,"padding","0px")}this.inherited(arguments)},
_layoutChildren:function(a,b){if(this._borderBox&&this._borderBox.h){var c=[];r.forEach(this._getOrderedChildren(),function(a){c.push(a);a._splitterWidget&&c.push(a._splitterWidget)});t.layoutChildren(this.domNode,{l:this.pe.l,t:this.pe.t,w:this._borderBox.w-this.pe.w,h:this._borderBox.h-this.pe.h},c,a,b)}},destroyRecursive:function(){r.forEach(this.getChildren(),function(a){var b=a._splitterWidget;b&&b.destroy();delete a._splitterWidget});this.inherited(arguments)}});d.ChildWidgetProperties={splitter:!1,
minSize:0,maxSize:Infinity};e.mixin(d.ChildWidgetProperties,n.ChildWidgetProperties);e.extend(a,d.ChildWidgetProperties);d._Splitter=f;d._Gutter=v;return d})},"dijit/layout/LayoutContainer":function(){define("dojo/_base/array dojo/_base/declare dojo/dom-class dojo/dom-style dojo/_base/lang ../_WidgetBase ./_LayoutWidget ./utils".split(" "),function(r,l,d,q,k,m,p,h){l=l("dijit.layout.LayoutContainer",p,{design:"headline",baseClass:"dijitLayoutContainer",startup:function(){this._started||(r.forEach(this.getChildren(),
this._setupChild,this),this.inherited(arguments))},_setupChild:function(e){this.inherited(arguments);e.region&&d.add(e.domNode,this.baseClass+"Pane")},_getOrderedChildren:function(){var d=r.map(this.getChildren(),function(c,b){return{pane:c,weight:["center"==c.region?Infinity:0,c.layoutPriority,("sidebar"==this.design?1:-1)*(/top|bottom/.test(c.region)?1:-1),b]}},this);d.sort(function(c,b){for(var a=c.weight,d=b.weight,e=0;e<a.length;e++)if(a[e]!=d[e])return a[e]-d[e];return 0});return r.map(d,function(c){return c.pane})},
layout:function(){h.layoutChildren(this.domNode,this._contentBox,this._getOrderedChildren())},addChild:function(d,c){this.inherited(arguments);this._started&&this.layout()},removeChild:function(e){this.inherited(arguments);this._started&&this.layout();d.remove(e.domNode,this.baseClass+"Pane");q.set(e.domNode,{top:"auto",bottom:"auto",left:"auto",right:"auto",position:"static"});q.set(e.domNode,/top|bottom/.test(e.region)?"width":"height","auto")}});l.ChildWidgetProperties={region:"",layoutAlign:"",
layoutPriority:0};k.extend(m,l.ChildWidgetProperties);return l})},"jimu/dijit/ShareLink":function(){define("dojo/_base/declare dijit/_WidgetBase dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dojo/_base/lang dojo/_base/array dojo/dom-class dojo/on dojo/topic dojo/query jimu/utils jimu/shareUtils dojo/_base/config dojo/cookie dojo/text!./templates/ShareLink.html dojo/string dijit/form/Select dijit/form/NumberTextBox dojo/dom-attr dojo/Deferred esri/request esri/tasks/query esri/tasks/QueryTask esri/symbols/PictureMarkerSymbol esri/graphic esri/layers/GraphicsLayer jimu/dijit/FeaturelayerChooserFromMap jimu/dijit/LayerChooserFromMapWithDropbox dijit/form/TextBox dijit/form/Textarea dijit/form/RadioButton dijit/form/Select dijit/form/CheckBox dijit/form/NumberTextBox dijit/form/SimpleTextarea dijit/form/ValidationTextBox".split(" "),
function(r,l,d,q,k,m,p,h,e,c,b,a,g,u,n,t,f,v,x,w,z,A,y,B,C,E,D,F){return r([l,d,q],{templateString:n,declaredClass:"jimu.dijit.ShareLink",bitlyUrl:"https://arcg.is/prod/shorten",share:{shareEmailSubject:"",shareTwitterTxt:"",languages:"ar cs da de en el es et fi fr he hr it ja ko lt lv nb nl pl pt-br pt-pt ro ru sr sv th tr zh-cn vi zh-hk zh-tw".split(" "),DEFAULT_MOBILE_LAYOUT:600},_hasZoomLevelMarkerAdded:!1,_hasMapScaleMarkerAdded:!1,_hasAddMarkerMarkerAdded:!1,HAS_INIT_URL:!1,postMixInProperties:function(){this.inherited(arguments);
this.nls=window.jimuNls.shareLink;this.nls.symbol=window.jimuNls.common.symbol;this.nls.label=window.jimuNls.common.label;this.nls.WKID=window.jimuNls.common.wkid||"wkid";this.nls.popupTitle=window.jimuNls.shareLink.popupTitle||"Pop-up title";this.nls.zoomLevel=window.jimuNls.shareLink.zoomLevel||"Zoom level";this.share.shareEmailSubject=this.nls.shareEmailSubject+" ${appTitle} ";this.share.shareTwitterTxt=this.nls.shareEmailSubject+"${appTitle}\n"},postCreate:function(){this.inherited(arguments);
this._initUI();this._initMap();this._showSocialMediaLinksByConfig()},constructor:function(a){a&&(this._portalUrl=a.portalUrl,this._isOnline=a.isOnline,this._appTitle=a.appTitle,this._isShowBackBtn=a.isShowBackBtn,this._isShowSocialMediaLinks=a.isShowSocialMediaLinks,this._isSharedToPublic=a.isSharedToPublic,this._isShowFindLocation=a.isShowFindLocation,this._config=a.config)},startup:function(){this.baseHrefUrl=a.getBaseHrefUrl(this._portalUrl);"undefined"===typeof this.optionSrc&&(this.optionSrc=
"currentMapExtent");this.updateUrl(null);this._initOptions();this._initOptionsEvent()},destroy:function(){this._cleanMarkerStatus();this._mapClickHandler&&(this._mapClickHandler=null);this.inherited(arguments)},onShareToPublicChanged:function(a){this._isSharedToPublic=a;this.updateUrl(null);this._isSharedToPublic?p.add(this.shareTips,"displaynone"):p.remove(this.shareTips,"displaynone")},onCloseContainer:function(){this._cleanMarkerStatus()},updateShareLinkOptionsUI:function(a){a&&"undefined"!==typeof a.isShowFindLocation&&
this.findLocationRow&&(!1===a.isShowFindLocation?p.add(this.findLocationRow,"displaynone"):!0===a.isShowFindLocation&&p.remove(this.findLocationRow,"displaynone"))},_initMap:function(){window.isBuilder?(this.own(e.subscribe("app/mapLoaded",k.hitch(this,this._onMapLoaded))),this.own(e.subscribe("app/mapChanged",k.hitch(this,this._onMapLoaded)))):(this.own(e.subscribe("mapLoaded",k.hitch(this,this._onMapLoaded))),this.own(e.subscribe("mapChanged",k.hitch(this,this._onMapLoaded))));window._widgetManager.map&&
(this.map=window._widgetManager.map,this._mapEventUpdateUrls(),this._addGraphicsLayer())},_onMapLoaded:function(a){this.map=a;this._mapEventUpdateUrls();this._addGraphicsLayer()},_mapEventUpdateUrls:function(){this.map&&(this.own(h(this.map,"pan-end",k.hitch(this,function(){this._mapEventHandler("pan-end")}))),this.own(h(this.map,"resize",k.hitch(this,function(){this._mapEventHandler("resize")}))),this.own(h(this.map,"zoom-end",k.hitch(this,function(){this._mapEventHandler("zoom-end")}))))},_mapEventHandler:function(){this._isShareLinkOptionsShow()&&
this.updateUrl()},_showSocialMediaLinksByConfig:function(){this._config&&this._config.socialMedias&&("undefined"!==typeof this._config.socialMedias.email&&!1===this._config.socialMedias.email&&p.add(this.emailShare,"displaynone"),"undefined"!==typeof this._config.socialMedias.facebook&&!1===this._config.socialMedias.facebook&&p.add(this.FacebookShare,"displaynone"),"undefined"!==typeof this._config.socialMedias.twitter&&!1===this._config.socialMedias.twitter&&p.add(this.TwitterShare,"displaynone"),
"undefined"!==typeof this._config.socialMedias.googlePlus&&!1===this._config.socialMedias.googlePlus&&p.add(this.googlePlusShare,"displaynone"))},_initUI:function(){this._isShowBackBtn?(x.set(this.backBtn,"title",window.jimuNls.common.back),this.own(h(this.backBtn,"click",k.hitch(this,this._toggleLinkOptions)))):p.add(this.backBtn,"displaynone");!1===this._isShowSocialMediaLinks&&p.toggle(this.socialNetworkLinks,"displaynone");!0===this._isSharedToPublic&&p.toggle(this.shareTips,"displaynone");this.own(h(this.linkOptions,
"click",k.hitch(this,this._toggleLinkOptions)));this._setInputsClicktoSelect(this._linkUrlTextBox);this.own(h(this.googlePlusShare,"click",k.hitch(this,this._toGooglePlus)));this._setInputsClicktoSelect(this._embedCodeTextArea);this._sizeOptions=new f({options:[{label:this.nls.smallSize,value:"small",selected:!0},{label:this.nls.mediumSize,value:"medium",selected:!1},{label:this.nls.largeSize,value:"large",selected:!1},{label:this.nls.customSize,value:"custom",selected:!1}],"class":"sizeOptionsSelect"});
this._sizeOptions.placeAt(this.SizeSelect);this.own(h(this._sizeOptions,"change",function(a){switch(a){case "small":this._widthTextBox.set("value",300);this._heightTextBox.set("value",200);p.add(this.CustomSizeContainer,"disable");this._updateEmbedCodeFrameSize();break;case "medium":this._widthTextBox.set("value",800);this._heightTextBox.set("value",600);p.add(this.CustomSizeContainer,"disable");this._updateEmbedCodeFrameSize();break;case "large":this._widthTextBox.set("value",1080);this._heightTextBox.set("value",
720);p.add(this.CustomSizeContainer,"disable");this._updateEmbedCodeFrameSize();break;case "custom":p.remove(this.CustomSizeContainer,"disable")}}.bind(this)));this._widthTextBox=new v({"class":"sizeTextBox inputsText",value:300,constraints:{pattern:"#",places:0}});this._widthTextBox.placeAt(this.CustomSizeContainer,1);this.own(h(this._widthTextBox,"change",function(a){200>a?this._widthTextBox.set("value",200>a?200:a):this._updateEmbedCodeFrameSize()}.bind(this)));this._heightTextBox=new v({"class":"sizeTextBox inputsText",
value:200,constraints:{pattern:"#",places:0}});this._heightTextBox.placeAt(this.CustomSizeContainer,3);this.own(h(this._heightTextBox,"change",function(a){200>a?this._heightTextBox.set("value",200>a?200:a):this._updateEmbedCodeFrameSize()}.bind(this)));this.mobileLayout.set("value",this.share.DEFAULT_MOBILE_LAYOUT);this.updateShareLinkOptionsUI({isShowFindLocation:this._isShowFindLocation});this._setInputsClicktoSelect(this.preview)},_setLinkUrl:function(a){this._linkUrlTextBox.set("value",a);x.set(this._linkUrlTextBox.domNode,
"data-old",a)},_setEmbedCode:function(a){this._embedCodeTextArea.set("value",'\x3ciframe width\x3d"'+this._widthTextBox.value+'" height\x3d"'+this._heightTextBox.value+'" frameborder\x3d"0" scrolling\x3d"no" allowfullscreen src\x3d"'+a+'"\x3e\x3c/iframe\x3e');x.set(this._embedCodeTextArea.domNode,"data-old-shortened",a)},_updateEmbedCodeFrameSize:function(a){a=this._embedCodeTextArea.get("value");a=a.replace(/width=\"[0-9]*\"/i,'width\x3d"'+this._widthTextBox.value+'"');a=a.replace(/height=\"[0-9]*\"/i,
'height\x3d"'+this._heightTextBox.value+'"');this._embedCodeTextArea.set("value",a)},_initOptions:function(){var a=[],b=this.map.getLevel();"number"===typeof b&&-1!==b?p.remove(this.chooseCenterWithLevelRow,"displaynone"):p.add(this.chooseCenterWithLevelRow,"displaynone");a=[];this.setlanguage_languages.removeOption(this.setlanguage_languages.getOptions());m.forEach(this.share.languages,function(b){var c={label:b,value:b};c.selected=b===g.locale?!0:!1;a.push(c)});this.setlanguage_languages.addOption(a);
b="";try{b=JSON.parse(u("esri_auth")).token}catch(N){console.log("ShareLink can't parse Auth:"+N)}b&&this.authtoken.set("value",b);b=new D({createMapResponse:this.map.webMapResponse,showLayerFromFeatureSet:!1,onlyShowVisible:!1,updateWhenLayerInfosIsShowInMapChanged:!1});p.add(b.domNode,"share-layerChooser-dropbox");this.layerChooserFromMapWithDropbox=new F({layerChooser:b});this.layerChooserFromMapWithDropbox.placeAt(this.queryFeature_layer);this.own(h(this.layerChooserFromMapWithDropbox,"selection-change",
k.hitch(this,this._updateQueryFeature_Layer)));"undefined"!==typeof this.map.spatialReference&&"undefined"!==typeof this.map.spatialReference.wkid&&this.addMarker_spatialReference.set("value",this.map.spatialReference.wkid)},_initOptionsEvent:function(){var a=b.has("ie")||b.has("edge")?"change":"KeyUp",d=c(".shareRadios",this.domNode);this.own(h(d,"click",k.hitch(this,function(a){this.optionSrc=x.get(a.srcElement||a.target,"data-id");this.updateUrl()})));d=c(".shareCheckBoxes",this.domNode);this.own(h(d,
"click",k.hitch(this,function(){this.updateUrl()})));this.own(h(this.chooseCenterWithLevel_levels,"change",k.hitch(this,function(){this.updateUrl()})));this.own(h(this.chooseCenterWithScale_scales,"change",k.hitch(this,function(){this.updateUrl()})));this.own(h(this.setlanguage_languages,"change",k.hitch(this,function(){this.updateUrl()})));this.own(h(this.findLocation_input,a,k.hitch(this,this.updateUrl)));this.own(h(this.queryFeature_field,"change",k.hitch(this,this._updateQueryFeature_Value)));
this.own(h(this.queryFeature_value,"change",k.hitch(this,this.updateUrl)));this.own(h(this.mobileLayout,a,k.hitch(this,this.updateUrl)));this.own(h(this.authtoken,a,k.hitch(this,this.updateUrl)));this.own(h(this.addMarker_marker,"click",k.hitch(this,function(a){this._onMarkersClick(a)})));this.own(h(this.addMarker_spatialReference,"change",k.hitch(this,this.updateUrl)));this.own(h(this.addMarker_title,a,k.hitch(this,this.updateUrl)));this.own(h(this.addMarker_symbolURL,a,k.hitch(this,this.updateUrl)));
this.own(h(this.addMarker_label,a,k.hitch(this,this.updateUrl)));this.own(h(this.addMarker_level,"change",k.hitch(this,this.updateUrl)));this.own(h(this.chooseCenterWithLevel_marker,"click",k.hitch(this,function(a){this._onMarkersClick(a)})));this.own(h(this.chooseCenterWithScale_marker,"click",k.hitch(this,function(a){this._onMarkersClick(a)})))},_onMarkersClick:function(a){this._unselectMarkerBtn();this._selectMarkerBtn(a);this._hidePopup();this._removeGraphicsLayer();this._mapClickHandler=h.once(this.map,
"click",k.hitch(this,this._onMapClick))},_onMapClick:function(a){var b=a.mapPoint;this._addGraphicsLayerMarker(a);"chooseCenterWithLevel"===this.optionSrc?this._hasZoomLevelMarkerAdded=!1:"chooseCenterWithScale"===this.optionSrc?this._hasMapScaleMarkerAdded=!1:"addMarker"===this.optionSrc&&(this._hasAddMarkerMarkerAdded=!1);this._unselectMarkerBtn();this.updateUrl(b);this._showPopup()},_hidePopup:function(){e.publish("ShareLink/onHideContainer")},_showPopup:function(){e.publish("ShareLink/onShowContainer")},
_updateResUrls:function(b){"currentMapExtent"===this.optionSrc?(b=this.getMapExtent(this.map),this.resultUrl=a.addQueryParamToUrl(this.baseHrefUrl,"extent",b,!0)):"chooseCenterWithLevel"===this.optionSrc?(!1===this._hasZoomLevelMarkerAdded&&(this.resultUrl=a.addQueryParamToUrl(this.baseHrefUrl,"center",this.getMapCenter(this.map,b),!0),b&&b.x&&b.y&&(this._hasZoomLevelMarkerAdded=!0)),this.resultUrl=a.addQueryParamToUrl(this.resultUrl,"level",this._getMapLevel(),!0)):"chooseCenterWithScale"===this.optionSrc?
(!1===this._hasMapScaleMarkerAdded&&(this.resultUrl=a.addQueryParamToUrl(this.baseHrefUrl,"center",this.getMapCenter(this.map,b),!0),b&&b.x&&b.y&&(this._hasMapScaleMarkerAdded=!0)),this.resultUrl=a.addQueryParamToUrl(this.resultUrl,"scale",this._getMapScale(),!0)):"findLocation"===this.optionSrc?(b=this.findLocation_input.get("value"),this.resultUrl=a.addQueryParamToUrl(this.baseHrefUrl,"find",b,!0)):"queryFeature"===this.optionSrc?this._updateUrlByQueryFeatures():"addMarker"===this.optionSrc&&(!1===
this._hasAddMarkerMarkerAdded?(this.resultUrl=a.addQueryParamToUrl(this.baseHrefUrl,"marker",this.getMapCenter(this.map,b,null,this._getWkid()),!0),this.resultUrl+=",",b&&b.x&&b.y&&(this._hasAddMarkerMarkerAdded=!0,this._lastAddMarkerParamObj=b)):(this.resultUrl=a.addQueryParamToUrl(this.baseHrefUrl,"marker",this.getMapCenter(this.map,this._lastAddMarkerParamObj,null,this._getWkid()),!0),this.resultUrl+=","),this.resultUrl+=encodeURIComponent(this.addMarker_title.get("value")||""),this.resultUrl+=
",",this.resultUrl+=encodeURIComponent(this.addMarker_symbolURL.get("value")||""),this.resultUrl+=",",this.resultUrl+=encodeURIComponent(this.addMarker_label.get("value")||""),b=this._getMapLevel(),this.resultUrl="number"===typeof b&&-1!==b?a.addQueryParamToUrl(this.resultUrl,"level",this._getMapLevel(),!0):a.addQueryParamToUrl(this.resultUrl,"scale",this._getMapScale(),!0));this.resultUrl=a.removeQueryParamFromUrl(this.resultUrl,"mobileBreakPoint",!0);this.resultUrl=a.removeQueryParamFromUrl(this.resultUrl,
"locale",!0);this.resultUrl=a.removeQueryParamFromUrl(this.resultUrl,"token",!0);this.overwirteMobileLayout.checked&&(this.resultUrl=a.addQueryParamToUrl(this.resultUrl,"mobileBreakPoint",this.mobileLayout.getValue(),!0));this.setlanguage.checked&&(this.resultUrl=a.addQueryParamToUrl(this.resultUrl,"locale",this.setlanguage_languages.getValue(),!0));this.auth.checked&&(this.resultUrl=a.addQueryParamToUrl(this.resultUrl,"token",this.authtoken.getValue(),!0))},_updateUrlByQueryFeatures:function(){var b=
this._getIdFromLayerChoose()||"",c=this.queryFeature_field.get("value"),d=this.queryFeature_value.get("value");this.resultUrl=a.addQueryParamToUrl(this.baseHrefUrl,"query",b,!0);c&&(this.resultUrl+=",",this.resultUrl+=c,d&&(this.resultUrl+=",",this.resultUrl+=d))},_updateQueryFeature_Layer:function(){this._updateUrlByQueryFeatures();this._updateQueryFeature_Field();this._updateQueryFeature_Value();this.updateUrl()},_updateQueryFeature_Field:function(){var a=this._getFieldsFromLayerChoose(),b=[];this.queryFeature_field.removeOption(this.queryFeature_field.getOptions());
m.forEach(a,k.hitch(this,function(a){-1<"esriFieldTypeString esriFieldTypeOID esriFieldTypeSmallInteger esriFieldTypeInteger esriFieldTypeSingle esriFieldTypeDouble".split(" ").indexOf(a.type)&&b.push({label:a.name,value:a.name})}));this.queryFeature_field.addOption(b);this._updateUrlByQueryFeatures();this._updateQueryFeature_Value();this.updateUrl()},_updateQueryFeature_Value:function(){var a=[],b=this.queryFeature_field.get("value");a.push(b);this._query(a,this._getUrlFromLayerChoose(),this.map).then(k.hitch(this,
function(a){var c=[],c=this._getQueryedValues(b,a);this.queryFeature_value.removeOption(this.queryFeature_value.getOptions());this.queryFeature_value.addOption(c);this._updateUrlByQueryFeatures();this.updateUrl()}))},_getIdFromLayerChoose:function(){var a=null,b=this.layerChooserFromMapWithDropbox.getSelectedItem();b&&b.layerInfo&&b.layerInfo.id&&(a=b.layerInfo.id);return a},_getFieldsFromLayerChoose:function(){var a=[],b=this.layerChooserFromMapWithDropbox.getSelectedItem();b&&b.layerInfo&&b.layerInfo.layerObject&&
b.layerInfo.layerObject.fields&&(a=b.layerInfo.layerObject.fields);return a},_getUrlFromLayerChoose:function(){var a="",b=this.layerChooserFromMapWithDropbox.getSelectedItem();b&&b.url&&(a=b.url);return a},_updateLinkOptionsUI:function(){c(".optionsMore",this.domNode).style("display","none");c("."+this.optionSrc+"_optionsMore",this.domNode).style("display","block");this.overwirteMobileLayout.checked&&c(".share-options-overwirteMobileLayout_optionsMore",this.domNode).style("display","block");this.setlanguage.checked&&
c(".share-options-language_optionsMore",this.domNode).style("display","block");this.auth.checked&&c(".share-options-auth_optionsMore",this.domNode).style("display","block")},_fixUrlIfIsOnline:function(a){if(this._isOnline&&this._isSharedToPublic){var b="",b=window.isBuilder?window.top.location.protocol:window.location.protocol,c=this._getUrlQueryString(a);a=this._getOnlinePublicUrl(a);a=b+"//"+a+"/apps/webappviewer/index.html"+c}return a},updateUrl:function(a){this._updateResUrls(a);this._updateLinkOptionsUI();
this.preview.set("value",this._fixUrlIfIsOnline(this.resultUrl));null===a&&this._generateShortenUrl()},_generateShortenUrl:function(){var a=this.preview.get("value");try{this.isUseShortenUrl()?this.shortenUrl(a,this.bitlyUrl).then(k.hitch(this,function(a){this._useShortenUrl(a);this.HAS_INIT_URL=!0}),k.hitch(this,function(b){this._useLengthenUrl(a,b);this.HAS_INIT_URL=!0})):(this._useLengthenUrl(a),this.HAS_INIT_URL=!0)}catch(J){console.error(J),this.HAS_INIT_URL=!0}},_useShortenUrl:function(a){this.shortenedUrl=
a;this._setLinkUrl(a);this._setEmbedCode(a)},_useLengthenUrl:function(a){a=a||"";this._setLinkUrl(a);this._setEmbedCode(a)},_toFacebook:function(){var a="http://www.facebook.com/sharer/sharer.php?s\x3d100\x26u\x3d"+encodeURIComponent(this._linkUrlTextBox.get("value"))+"\x26t\x3d"+encodeURIComponent(b.stripHTML(this.socialNetworkTitle(this._appTitle)));window.open(a,"_blank")},_toTwitter:function(){var a=t.substitute(this.share.shareTwitterTxt,{appTitle:b.stripHTML(this._appTitle)}),c=this._linkUrlTextBox.get("value");
window.open("http://twitter.com/home?status\x3d"+encodeURIComponent(a+c+"\n@ArcGISOnline"),"_blank")},_toEmail:function(){var a="mailto:?subject\x3d"+t.substitute(this.share.shareEmailSubject,{appTitle:b.stripHTML(this._appTitle)}),c=this.preview.get("value"),a=a+("\x26body\x3d"+encodeURIComponent(this.nls.shareEmailTxt1)+"%0D%0A%0D%0A"+b.stripHTML(this._appTitle)),a=a+("%0D%0A"+encodeURIComponent(c)),a=a+("%0D%0A%0D%0A"+encodeURIComponent(this.nls.shareEmailTxt2)),a=a+("%0D%0A%0D%0A"+encodeURIComponent(this.nls.shareEmailTxt3));
window.top.location.href=a},_toGooglePlus:function(){var a=this._linkUrlTextBox.get("value"),a="http://plus.google.com/share?url\x3d"+encodeURIComponent(a);window.open(a,"_blank")},_toggleLinkOptions:function(){var a=c(".shareOptionsWrapper",this.domNode.parentNode||this.domNode.parentElement),b=c(".shareUrlsWrapper",this.domNode),d=c(".shareLinkOptionsWrapper",this.domNode);this._isShareLinkOptionsShow()?(e.publish("ShareLink/onHideLinkOptions"),this._cleanMarkerStatus(),this._generateShortenUrl()):
e.publish("ShareLink/onShowLinkOptions");a&&a[0]&&p.toggle(a[0],"displaynone");p.toggle(b[0],"displaynone");p.toggle(d[0],"displaynone")},_moreOptionsExpandCollapse:function(){p.toggle(this.MoreOptionsContainer,"displaynone");p.toggle(this.MoreOptionsIcon,"rotate")},_setInputsClicktoSelect:function(a){x.set(a,"onclick","this.select()");x.set(a,"onmouseup","return false;")},isUseShortenUrl:function(){return location.hostname.endWith("esri.com")||location.hostname.endWith("arcgis.com")?!0:!1},shortenUrl:function(b,
c){var d=new w,e=a.addQueryParamToUrl(c,"longUrl",b,!0),e=a.addQueryParamToUrl(e,"format","json",!0);z({url:e,handleAs:"json",callbackParamName:"callback"}).then(k.hitch(this,function(a){a&&200===a.status_code&&a.data&&a.data.url&&0<a.data.url.length?d.resolve(a.data.url):d.reject(a)}),k.hitch(this,function(a){console.log("can't fetch shortenUrl "+a);d.reject(a)}));return d},socialNetworkTitle:function(a){100<a.length&&(a=a.substring(0,97)+"...");return a},getMapExtent:function(a){a=a.extent;return null!==
a?this._roundValue(a.xmin,1E4)+","+this._roundValue(a.ymin,1E4)+","+this._roundValue(a.xmax,1E4)+","+this._roundValue(a.ymax,1E4)+","+a.spatialReference.wkid:""},_roundValue:function(a,b){return Math.round(a*b)/b},getMapCenter:function(a,b,c,d){c=c?c:",";var e=null;b&&b.x&&b.y?e=b:a.extent.getCenter()&&(e=a.extent.getCenter());a=d||e.spatialReference.wkid;return null!==e?this._roundValue(e.x,1E4)+c+this._roundValue(e.y,1E4)+c+a:""},_getMapLevel:function(){return this.map.getLevel()},_getMapScale:function(){return this.map.getScale()},
_getWkid:function(){return this.addMarker_spatialReference.get("value")||""},_query:function(a,b,c){var d=new A;d.where="1\x3d1";d.outSpatialReference=c.spatialReference;d.outFields=a;return(new y(b)).execute(d)},_getQueryedValues:function(a,b){var c=[];m.forEach(b.features,k.hitch(this,function(b){b=b.attributes[a]+"";c.push({label:b,value:b})}));return c},_addGraphicsLayer:function(){window.isBuilder||"undefined"!==typeof this._graphicsLayer||(this._graphicsLayer=new E,this.map.addLayer(this._graphicsLayer))},
_removeGraphicsLayer:function(){window.isBuilder||"undefined"===typeof this._graphicsLayer||(this._graphicsLayer.remove(this._markerGraphic),this._markerGraphic=null)},_addGraphicsLayerMarker:function(a){window.isBuilder||"undefined"===typeof this._graphicsLayer||(this._markerGraphic=this._getMarkerGraphic(a.mapPoint),this._graphicsLayer.add(this._markerGraphic))},_getMarkerGraphic:function(a){var b=new B(require.toUrl("jimu")+"/images/EsriBluePinCircle26.png",26,26);b.setOffset(0,12);return new C(a,
b)},_unselectMarkerBtn:function(){for(var a=c(".markers",this.domNode),b=0,d=a.length;b<d;b++)p.remove(a[b],"selected")},_selectMarkerBtn:function(a){p.add(a.srcElement||a.target,"selected")},_cleanMarkerStatus:function(){this._mapClickHandler&&this._mapClickHandler.remove&&this._mapClickHandler.remove();this._unselectMarkerBtn();this._removeGraphicsLayer()},_isShareLinkOptionsShow:function(){var a=c(".shareLinkOptionsWrapper",this.domNode);return!p.contains(a[0],"displaynone")},_getUrlQueryString:function(a){var b=
"";-1!==a.indexOf("?")&&(b=a.substring(a.indexOf("?")));return b},_getOnlinePublicUrl:function(){var a="www.arcgis.com",b=this._portalUrl;b&&"string"===typeof b&&(-1<b.indexOf("devext.arcgis.com")?a="devext.arcgis.com":-1<b.indexOf("qaext.arcgis.com")&&(a="qaext.arcgis.com"));return a}})})},"jimu/dijit/FeaturelayerChooserFromMap":function(){define(["dojo/_base/declare","dojo/Deferred","dojo/_base/html","dojo/_base/lang","./LayerChooserFromMap"],function(r,l,d,q,k){return r([k],{baseClass:"jimu-featurelayer-chooser-from-map",
declaredClass:"jimu.dijit.FeaturelayerChooserFromMap",types:null,showLayerFromFeatureSet:!1,showTable:!1,onlyShowVisible:!1,ignoredFeaturelayerIds:null,mustSupportStatistics:!1,ignoreVirtualLayer:!1,postMixInProperties:function(){this.inherited(arguments);this.ignoredFeaturelayerIds||(this.ignoredFeaturelayerIds=[]);this.basicFilter=q.hitch(this,this.basicFilter);this.filter=k.createFeaturelayerFilter(this.types,this.showLayerFromFeatureSet,this.showTable,this.mustSupportStatistics);this.ignoreVirtualLayer&&
(this.filter=k.andCombineFilters([this.filter,q.hitch(this,this._ignoreVirtualLayerFilter)]))},postCreate:function(){this.inherited(arguments);d.addClass(this.domNode,"jimu-basic-layer-chooser-from-map")},_ignoreVirtualLayerFilter:function(d){return d.getLayerType().then(function(d){return!("ArcGISDynamicMapServiceLayer"===d||"ArcGISTiledMapServiceLayer"===d||"GroupLayer"===d)})},basicFilter:function(d){var k=new l;0<=this.ignoredFeaturelayerIds.indexOf(d.id)?k.resolve(!1):this.onlyShowVisible&&"Table"!==
d.getLayerType()?k.resolve(d.isShowInMap()):k.resolve(!0);return k},getHandledItem:function(d){var k=this.inherited(arguments),h=d&&d.layerInfo,h=h&&h.layerObject;k.url=h&&h.url||"";return k}})})},"jimu/dijit/LayerChooserFromMapWithDropbox":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/html dojo/on dojo/Evented dojo/Deferred dijit/popup dijit/_WidgetBase dijit/_TemplatedMixin dojo/text!./templates/LayerChooserFromMapWithDropbox.html jimu/LayerInfos/LayerInfos".split(" "),function(r,
l,d,q,k,m,p,h,e,c,b){return r([h,e,k],{templateString:c,baseClass:"jimu-layer-chooser-from-map-withdropbox",declaredClass:"jimu.dijit.LayerChooserFromMapWithDropbox",_selectedItem:null,_isLayerChooserShow:!1,layerInfosObj:null,layerChooser:null,postCreate:function(){this.inherited(arguments);this.layerInfosObj=b.getInstanceSync();this.layerChooser.domNode.style.zIndex=1;this.layerChooser.tree.domNode.style.borderTop="0";this.layerChooser.tree.domNode.style.maxHeight="290px";this.own(q(this.layerChooser,
"tree-click",l.hitch(this,this._onTreeClick)));this.own(q(this.layerChooser,"update",l.hitch(this,this._onLayerChooserUpdate)));this.own(q(document.body,"click",l.hitch(this,this._onBodyClicked)))},destroy:function(){this.hideLayerChooser();this.layerChooser&&this.layerChooser.destroy();this.layerChooser=null;this.inherited(arguments)},getLayerChooser:function(){return this.layerChooser},setSelectedLayer:function(a){var b=new m;if(a){var c=this.layerInfosObj.getLayerInfoById(a.id);c?this.layerChooser.filter(c).then(l.hitch(this,
function(d){d?(this._onSelectNewItem({layerInfo:c,name:c.title,url:a.url}),b.resolve(!0)):b.resolve(!1)}),l.hitch(this,function(){b.resolve(!1)})):b.resolve(!1)}else this._onSelectNewItem(null),b.resolve(!0);return b},getSelectedItem:function(){return this._selectedItem},getSelectedItems:function(){return[this._selectedItem]},_onBodyClicked:function(a){a=a.target||a.srcElement;a===this.domNode||d.isDescendant(a,this.domNode)||a===this.layerChooser.domNode||d.isDescendant(a,this.layerChooser.domNode)||
this.hideLayerChooser()},_onDropDownClick:function(a){a.stopPropagation();a.preventDefault();this._isLayerChooserShow?this.hideLayerChooser():this.showLayerChooser()},_getSelectedItems:function(){return this.layerChooser.getSelectedItems()},showLayerChooser:function(){this.layerChooser.domNode.style.width=this.domNode.clientWidth+2+"px";p.open({parent:this,popup:this.layerChooser,around:this.domNode});var a=this.layerChooser.domNode.parentNode;a&&d.addClass(a,"jimu-layer-chooser-from-map-withdropbox-popup");
this._isLayerChooserShow=!0},hideLayerChooser:function(){p.close(this.layerChooser);this._isLayerChooserShow=!1},_onLayerChooserUpdate:function(){this._selectedItem&&this.layerChooser.onlyShowVisible&&!this._selectedItem.layerInfo.isShowInMap()&&(this._selectedItem=null,this.emit("selection-change",[]))},_onSelectNewItem:function(a){var b=l.getObject("layerInfo.id",!1,this._selectedItem)||-1,c=l.getObject("layerInfo.id",!1,a)||-1,b=b!==c;this._selectedItem=a;this.hideLayerChooser();a=l.getObject("layerInfo.title",
!1,this._selectedItem)||"";this.layerNameNode.innerHTML=a;a=l.getObject("layerInfo.layerObject",!1,this._selectedItem);b&&this.emit("selection-change",[a])},_onTreeClick:function(){var a=this._getSelectedItems();this._onSelectNewItem(0<a.length?a[0]:null)}})})},"builder/plugins/startup/_build-generate_module":function(){define(["builder/plugins/startup/Plugin","dojo/text!builder/plugins/startup/Plugin.html","dojo/text!builder/plugins/startup/css/style.css"],function(){})},"builder/plugins/startup/Plugin":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/html dojo/topic builder/BasePlugin builder/serviceUtils jimu/dijit/ViewStack jimu/utils".split(" "),
function(r,l,d,q,k,m,p,h){return r([k],{baseClass:"plugin-startup",constructor:function(){this.appTypes=["HTML","HTML3D"]},postCreate:function(){this.main=new p({viewType:"dijit",views:[]},this.viewStackNode)},startup:function(){this.main.startup();this._loadHeaderPlugin().then(l.hitch(this,function(){this._afterHeaderLoaded()}))},getCurrentView:function(){return this.main.getSelectedView()},switchToAppList:function(){var e=l.hitch(this,function(){if(window.history&&window.history.pushState){this._switchToAppList();
var c=h.url.removeQueryParamFromUrl(window.location.href,"id");window.history.pushState({path:c},"",c)}else window.location.href="index.html"});document.title="Web AppBuilder for ArcGIS";"appconfig"===this.main.getSelectedLabel()?q.publish("closeAppConfigPage",e):""===this.main.getSelectedLabel()&&(d.empty(this.viewStackNode),e())},switchToAppConfig:function(d){var c=window.location.href;window.queryObject.id?(c=h.url.removeQueryParamFromUrl(c,"id"),c=h.url.addQueryParamToUrl(c,"id",d.id)):window.queryObject.appid?
(c=h.url.removeQueryParamFromUrl(c,"appid"),c=h.url.addQueryParamToUrl(c,"appid",d.id)):(c=h.url.removeQueryParamFromUrl(c,"title"),c=h.url.removeQueryParamFromUrl(c,"tags"),c=h.url.removeQueryParamFromUrl(c,"summary"),c=h.url.removeQueryParamFromUrl(c,"folder"),c=h.url.removeQueryParamFromUrl(c,"sharewithwebmap"),c=h.url.removeQueryParamFromUrl(c,"webmap"),c=h.url.removeQueryParamFromUrl(c,"sharewithwebscene"),c=h.url.removeQueryParamFromUrl(c,"webscene"),c=h.url.removeQueryParamFromUrl(c,"appType"),
c=h.url.addQueryParamToUrl(c,"id",d.id));if(window.location.href!==c)if(window.history&&window.history.pushState)window.history.pushState({path:c},"",c);else{window.location.href=c;return}this._switchToApp(d)},_afterHeaderLoaded:function(){var d;if(window.isXT)queryObject.id?(d={id:queryObject.id.replace("#","")},this._switchToApp(d)):this._switchToAppList();else if(queryObject.id)d={id:queryObject.id.replace("#","")},this._switchToApp(d);else if(queryObject.appid)d={appid:queryObject.appid.replace("#",
"")},this._switchToApp(d);else if(queryObject.title){d={name:queryObject.title};queryObject.tags&&(d.tags=queryObject.tags);queryObject.summary&&(d.description=queryObject.summary);queryObject.folder&&(d.folderId=queryObject.folder);if(queryObject.sharewithwebmap||queryObject.sharewithwebscene)d.sharing="true"===queryObject.sharewithwebmap||"true"===queryObject.sharewithwebscene;queryObject.appType?(d.appType=queryObject.appType,queryObject.webmap&&(d.webmap=queryObject.webmap),queryObject.webscene&&
(d.webscene=queryObject.webscene)):queryObject.webmap?(d.webmap=queryObject.webmap,d.appType="HTML"):queryObject.webscene?(d.webscene=queryObject.webscene,d.appType="HTML3D"):d.appType="HTML";this._createApp(d)}else window.location.href=window.portalUrl},_switchToApp:function(d){var c=this.main.getViewByLabel("appconfig");c&&this.main.removeView(c);"stemapp"===d.id&&(d.id="HTML");"stemapp3d"===d.id&&(d.id="HTML3D");m.getAppInfo(d.id||d.appid).then(l.hitch(this,function(b){if("undefined"===typeof b.id)this.viewStackNode.innerHTML=
'\x3cimg class\x3d"image-404" src\x3d"'+this.folderUrl+'images/404.png"\x3e';else{var a=this.pluginManager.getStemappInfo(b.appType);a.name="HTML3D"===a.appType?"stemapp3d":"stemapp";var c;c=-1<this.appTypes.indexOf(d.id)?a.appPath:window.isXT?window.path+"apps/"+b.id+"/":"HTML3D"===b.appType?window.path+"stemapp3d/":window.path+"stemapp/";window.stemappInfo=a;window.appInfo={appType:b.appType,appPath:c,appOwner:b.creator||b.owner,id:b.id,name:b.name,isPredefined:b.isPredefined,isTemplate:b.isTemplate,
isTemplateApp:b.isTemplateApp};a=this.filterExtensionsByAppType("app-config",b.appType);0===a.length?console.error("Do not find app-config extension."):1<a.length?console.error("Find more than one app-config extension."):(a=this.pluginsMeta[a[0].pluginName],a.options={appInfo:b},this.pluginManager.loadPlugin(a).then(l.hitch(this,function(a){a.label="appconfig";this.main.addView(a);this.main.switchView("appconfig")})),this._showAppName(b))}}))},_showAppName:function(d){"stemapp"===d.id?this.header.setAppName("stemapp"):
d.isTemplate?this.header.setAppName(builderNls.templateLabel+" "+d.name):this.header.setAppName(d.name);document.title=d.name+" - Web AppBuilder for ArcGIS"},_hideAppName:function(){this.header.setAppName("")},_createApp:function(d){var c=this.pluginManager.getStemappInfo(d.appType);c.name="HTML3D"===c.appType?"stemapp3d":"stemapp";window.stemappInfo=c;c=this.pluginManager.getExtensions("startup.creation-entry")[0];this.pluginManager.loadPlugin(this.pluginsMeta[c.pluginName]).then(l.hitch(this,function(b){b.createNewApp(d)}))},
_switchToAppList:function(){if(this.main.getViewByLabel("applist"))this.main.switchView("applist");else{var d=this.getPluginsMetaByExtensionPoint("app-list")[0];this.pluginManager.loadPlugin(d).then(l.hitch(this,function(c){c.label="applist";this.main.addView(c);this.main.switchView("applist")}))}this._hideAppName()},_loadHeaderPlugin:function(){var e=this.getPluginsMetaByExtensionPoint("header")[0];return this.pluginManager.loadPlugin(e).then(l.hitch(this,function(c){d.place(c.domNode,this.headerNode);
c.startup();return this.header=c}))}})})},"builder/plugins/stemapps/web2d/_build-generate_module":function(){define([],function(){})},"builder/plugins/stemapps/web3d/_build-generate_module":function(){define([],function(){})},"builder/plugins/theme-config/_build-generate_module":function(){define(["builder/plugins/theme-config/Plugin","dojo/text!builder/plugins/theme-config/Plugin.html","dojo/text!builder/plugins/theme-config/css/style.css","dojo/i18n!builder/plugins/theme-config/nls/strings"],function(){})},
"builder/plugins/theme-config/Plugin":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/html dojo/_base/Color dojo/topic dojo/on dojo/dom dojo/cookie dojo/query dojo/text!./Plugin.html dojo/dom-construct dojo/dom-style dojo/_base/array dojo/Deferred dojo/promise/all jimu/dijit/Message jimu/dijit/CheckBox ./ThemeColorChooser ./ThemeManager builder/serviceUtils builder/BasePlugin jimu/utils jimu/portalUtils".split(" "),function(r,l,d,q,k,m,p,h,e,c,b,a,g,u,n,t,f,v,x,w,z,A,y){return r([z],
{baseClass:"plugin-theme-config",templateString:c,themeLoadDef:void 0,_themePageDef:void 0,_disableShowThemeSwitchMessage:null,constructor:function(){this._themePageDef=new u;this._disableShowThemeSwitchMessage=!0},postMixInProperties:function(){this.inherited(arguments);this.nls=l.mixin(this.nls,builderNls)},postCreate:function(){this.inherited(arguments);this.own(k.subscribe("app/appConfigLoaded",l.hitch(this,this._onAppConfigLoaded)));this.own(k.subscribe("app/appConfigChanged",l.hitch(this,this._onAppConfigChanged)));
this.own(k.subscribe("app/editLayout",l.hitch(this,this._onEditLayout)))},startup:function(){this.inherited(arguments);this.themeManager=new x;this.themeLoadDef=this.themeManager.loadThemes();this.themeLoadDef.then(l.hitch(this,function(a){this.initThemePage(a);this._themePageDef.resolve()}));this.portalSelfDef=y.getPortal(window.portalUrl).loadSelfInfo()},initThemePage:function(a){var c,e,f,h,k,n;g.forEach(a,function(a){h=d.create("div",{"class":"catalog-theme-content-div jimu-float-leading"},this.themeList);
c=d.create("div",{"class":"catalog-theme-div","data-themeName":a.getName()},h);d.create("div",{"class":"catalog-theme-name-div",innerHTML:a.getLabel(),title:a.getLabel()},h);k=d.create("div",{"class":"catalog-theme-img-box-div"},c);n=d.create("div",{"class":"catalog-theme-img-div"},k);b.create("img",{src:a.getIcon(),"class":"catalog-theme-img"},n);m(c,"click",l.hitch(this,this._onStartChangeTheme,a.getName()));e=b.create("div",{"class":""},this.styleList);this.initStyle(a,e);f=b.create("div",{"class":""},
this.layoutList);this.initLayout(a,f);a.domNodes.theme=c;a.domNodes.themeImgBox=k;a.domNodes.themeSL=void 0;a.domNodes.styleList=e;a.domNodes.layoutList=f},this)},initStyle:function(c,e){var f,h,n;f=b.create("div",{"class":"style-section"},e);b.create("div",{innerHTML:this.nls.styleTitle,"class":"style-text"},f);n=b.create("div",{"class":"style-color-content"},f);var p=c.getStyles().slice();f=p.pop();g.forEach(p,function(c){h=b.create("div",{"class":"style-div jimu-float-leading"},n);a.set(h,"backgroundColor",
c.styleColor);c.domNode=h;m(h,"click",l.hitch(this,this._onStyleChanged,c.name))},this);h=b.create("div",{"class":"style-div jimu-float-leading"},n);p=new v({showLabel:!0,recordUID:A.getColorRecordName("theme-config-Plugin")},h);f.domNode=p.domNode;f.isCustom=!0;p.domNode.className+=" style-div jimu-float-leading";c._wabDefaultColor=f.styleColor;p.setColor(new q(c._wabDefaultColor));p.setTitle(this.nls.setCustomColor);p.startup();this.own(m(p,"clickContainer",l.hitch(this,function(a,b){b.toHex()!==
(a.appConfig.theme.customStyles&&a.appConfig.theme.customStyles.mainBackgroundColor)&&this._setThemeStyleToColor(a,b,!0)},c)));this.own(m(p,"sharedThemeChanged",l.hitch(this,function(a,b,c){b.toHex()!==(a.appConfig.theme.customStyles&&a.appConfig.theme.customStyles.mainBackgroundColor)&&this._setThemeStyleToColor(a,b,!0);a=l.mixin(a.appConfig.theme.sharedTheme,c);k.publish("sharedThemeChanged",a)},c)));c._cp=p;c._lastStyle=f;d.setStyle(e,"display","none")},initLayout:function(a,c){var e;e=b.create("div",
{"class":"layout-section",id:a.getName()+"-layout-section"},c);b.create("div",{innerHTML:this.nls.layoutTitle,"class":"layout-text"},e);g.forEach(a.getLayouts(),function(b){this._drawLayout(a,b,e)},this);d.setStyle(c,"display","none")},_drawLayout:function(a,c,d){var e;c.domClass||(c.domClass=" ");d=b.create("div",{"class":"layout-out-div jimu-float-leading "},d);e=b.create("div",{"class":"layout-box-div "},d);d=b.create("div",{"class":"layout-div "+c.domClass},e);a=isRTL?c.RTLIcon?a.getUrl()+c.RTLIcon:
this.folderUrl+"css/images/current_layout.png":c.icon?a.getUrl()+c.icon:this.folderUrl+"css/images/current_layout.png";b.create("img",{"class":"layout-image",src:a},d);c.domNode=d;c.boxDomNode=e;m(d,"click",l.hitch(this,this._onLayoutChanged,c.name));a=b.create("div",{"class":"layout-selected-div"},d);b.create("img",{"class":"layout-selected-img",src:this.folderUrl+"css/images/check.png"},a);c.selectedNode=a},_onStyleChanged:function(a){this.changeStyle(a,null,!0)},_onLayoutChanged:function(a){this.changeLayout(a,
null,!0)},_onStartChangeTheme:function(a){if(this.themeManager.currentThemeName!==a)if(this._disableShowThemeSwitchMessage)this.changeTheme(a,!0);else if(h("disable_theme_switch_Message"))this.changeTheme(a,!0);else{var b=new t({message:"\x3cdiv\x3e"+this.nls.themeChangeMessage+"\x3c/div\x3e",width:500,buttons:[{label:this.nls.ok,onClick:l.hitch(this,function(){c.checked&&h("disable_theme_switch_Message",!0);b.close();this.changeTheme(a,!0)})},{label:this.nls.cancel}]}),c=new f({label:this.nls.disableThemeSwitchMessage,
"class":"jimu-float-leading",style:{marginTop:"10px"}});c.placeAt(b.contentContainerNode)}},changeStyle:function(a,b,c){b||(b=this.themeManager.getCurrentTheme());var e=b.getCurrentStyle();if(b.currentStyleName!==a||e&&e.name===a&&e.isCustom)b.currentStyleName&&d.removeClass(b.getCurrentStyle().domNode,"style-selected"),b.changeCurrentStyle(a),d.addClass(b.getCurrentStyle().domNode,"style-selected"),c&&k.publish("styleChanged",l.clone(b.getCurrentStyle()))},changeLayout:function(a,b,c){b||(b=this.themeManager.getCurrentTheme());
b.currentLayoutName!==a&&(b.currentLayoutName&&(d.removeClass(b.getCurrentLayout().domNode,"layout-selected"),d.removeClass(b.getCurrentLayout().boxDomNode,"layout-box-selected")),b.changeCurrentLayout(a),d.addClass(b.getCurrentLayout().domNode,"layout-selected"),d.addClass(b.getCurrentLayout().boxDomNode,"layout-box-selected"),c&&k.publish("layoutChanged",l.clone(b.getCurrentLayout())))},_copyThemeFromRepo:function(a){var b=new u,c=this.themeManager.getThemeByName(a);c.loadLayouts().then(l.hitch(this,
function(){var d=c.getLayoutByName("default");w.copyThemeToApp(window.appInfo.id,a,c.appConfig?c.appConfig.getCleanConfig():d.layoutConfig).then(l.hitch(this,function(a){a.success?b.resolve():(b.reject(),console.error("change theme error, response of 'copytheme' unsuccess"))}),function(a){b.reject(a);console.error("change theme error"+a)})}));return b},changeTheme:function(a,b){var c=new u;this.themeManager.currentThemeName!==a?(b&&this.pluginManager.getPluginByName("app-config").showLoadingCover(),
this._copyThemeFromRepo(a).then(l.hitch(this,function(){this.themeManager.currentThemeName&&(d.removeClass(this.themeManager.getCurrentTheme().domNodes.theme,"catalog-theme-selected"),d.removeClass(this.themeManager.getCurrentTheme().domNodes.themeImgBox,"selected"),d.setStyle(this.themeManager.getCurrentTheme().domNodes.styleList,"display","none"),d.setStyle(this.themeManager.getCurrentTheme().domNodes.layoutList,"display","none"));this.themeManager.changeCurrentTheme(a);if(b){var e=this.themeManager.getCurrentTheme(),
f=e._cp;delete e._cp;k.publish("themeChanged",l.clone(e));e._cp=f}d.addClass(this.themeManager.getCurrentTheme().domNodes.theme,"catalog-theme-selected");d.addClass(this.themeManager.getCurrentTheme().domNodes.themeImgBox,"selected");d.setStyle(this.themeManager.getCurrentTheme().domNodes.styleList,"display","block");d.setStyle(this.themeManager.getCurrentTheme().domNodes.layoutList,"display","block");e=p.byId(this.themeManager.getCurrentTheme().getName()+"-layout-section");this._toggleEditLayoutButton(this.themeManager.getCurrentTheme().getLayoutByName("default"),
e);c.resolve()}))):c.resolve();return c},_onAppConfigLoaded:function(a){this._setAppConfig(a,!0);this._listenConfigPreviewWindowResizeEvent()},_listenConfigPreviewWindowResizeEvent:function(){var a=e(".preview-config\x3eiframe")[0],b=a?a.contentWindow:null;b&&m(b,"resize",l.hitch(this,function(){this.editLayoutButton&&(b.appInfo.isRunInMobile?d.setStyle(this.editLayoutButton,"display","none"):d.setStyle(this.editLayoutButton,"display","block"))}))},_onAppConfigChanged:function(a,b){this._setAppConfig(a,
!1,b)},_setAppConfig:function(a,b,c){var e;n([this._themePageDef,this.portalSelfDef]).then(l.hitch(this,function(f){f=f[1];if(b){var h=l.getObject("portalProperties.sharedTheme.header.background",!1,f);g.forEach(this.themeManager.themes,function(b){a.theme.sharedTheme.isPortalSupport&&a.theme.sharedTheme.useHeader?(h||(h=b._wabDefaultColor),this._setThemeStyleToColor(b,h,!1)):this.changeStyle("default",b,!1);this.changeLayout("default",b,!1);var c=l.getObject("theme.sharedTheme",!1,a);b._cp.setSharedThemeConfig(c);
b.clear()},this);this.changeTheme(a.theme.name,!1).then(l.hitch(this,function(){a.theme.styles&&a.theme.styles[0]&&this.changeStyle(a.theme.styles[0],this.themeManager.getCurrentTheme(),!1);this._setLayout(a);e=this.themeManager.getCurrentTheme().getLayoutByAppConfig(a.getCleanConfig());e||(e=this.themeManager.getCurrentTheme().addLayout("appLayout",a.getCleanConfig(),"app-layout",this.nls.appLayout),this._drawLayout(this.themeManager.getCurrentTheme(),e,void 0));this.changeLayout(e.name,this.themeManager.getCurrentTheme(),
!1);this.resetStyleForOrgOrCustom(a,b,c);d.setStyle(this.themeList,"display","block")}))}else this.resetStyleForOrgOrCustom(a,b,c),this._setLayout(a)}))},_setLayout:function(a){var b,c=a.getCleanConfig();b=p.byId(this.themeManager.getCurrentTheme().getName()+"-layout-section");var d=this.themeManager.getCurrentTheme();a=d.getLayoutByAppConfig(a.getCleanConfig());a||((a=d.getLayoutByName("appLayout"))?a.layoutConfig=c:(a=d.addLayout("appLayout",c,"app-layout",this.nls.appLayout),this._drawLayout(d,
a,b)));this.changeLayout(a.name,d,!1)},_toggleEditLayoutButton:function(a,c){this._loadLayoutManager(a.layoutConfig.layoutDefinition?a.layoutConfig.layoutDefinition.manager:"jimu/layoutManagers/AbsolutePositionLayoutManager").then(l.hitch(this,function(a){a.isSupportEdit()&&!this.editLayoutButton?(this.editLayoutButton=b.create("div",{innerHTML:'\x3cspan class\x3d"modify-icon"\x3e\x3c/span\x3e\x3cspan\x3e'+this.nls.modifyLayout+"\x3c/span\x3e","class":"layout-action"},c),this.own(m(this.editLayoutButton,
"click",l.hitch(this,function(){this._editLayout()})))):this.editLayoutButton&&(b.destroy(this.editLayoutButton),this.editLayoutButton=null)}))},_onEditLayout:function(){this._editLayout()},_editLayout:function(){this.pluginManager.getPluginByName("app-config").showLoadingCover();k.publish("actionTriggered",{action:"editLayout"})},_loadLayoutManager:function(a){var b=new u;require([a],l.hitch(this,function(a){a=a.getInstance();b.resolve(a)}));return b},resetStyleForOrgOrCustom:function(a,b,c){var d=
this.themeManager.getCurrentTheme();d.setAppConfig(a);var e=l.getObject("theme.sharedTheme",!1,a);(e&&"sharedThemeChange"===c||"themeChange"===c||!0===b)&&d._cp.setSharedThemeConfig(e);a=l.getObject("theme.customStyles.mainBackgroundColor",!1,a);e&&!e.useHeader&&d._cp.setNoChecked(!e.useHeader&&!a);b=!1;e&&"undefined"!==typeof e.useHeader&&!a&&"undefined"!==typeof d._wabDefaultColor&&(b=!0);a&&(d._cp.setColor(new q(a)),"sharedThemeChange"===c&&this._setThemeStyleToColor(d,a,b||d._lastStyle.styleColor!==
a))},_setThemeStyleToColor:function(a,b,c){b=new q(b);a._lastStyle.styleColor=b.toHex();a._lastStyle.isCustom=!0;a._cp.setColor(b);this.changeStyle(a._lastStyle.name,a,c)}})})},"builder/plugins/theme-config/ThemeColorChooser":function(){define("dojo/Evented dojo/_base/declare dijit/_WidgetBase dijit/_TemplatedMixin dojo/_base/lang dojo/_base/html dojo/on dojo/sniff dojo/_base/Color builder/dijit/SharedThemeChooserPopup jimu/dijit/ColorPickerPopup jimu/utils".split(" "),function(r,l,d,q,k,m,p,h,e,
c,b,a){return l([d,q,r],{baseClass:"jimu-theme-color-chooser",declaredClass:"jimu.dijit.ThemeColorChooser",templateString:'\x3cdiv class\x3d"jimu-color-picker"\x3e\x3c/div\x3e',color:null,showLabel:!1,recordUID:"",isPortalSupport:!1,postCreate:function(){this.inherited(arguments)},startup:function(){this._createTooltipDialog();this.own(p(this.domNode,"click",k.hitch(this,function(a){a.stopPropagation();a.preventDefault();this.emit("clickContainer",this.getColor())})));this.own(p(this.domNode,"mouseenter",
k.hitch(this,function(){this.popup.showPopup()})));this.own(p(this.domNode,"mouseleave",k.hitch(this,function(){this.popup.hidePopup()})))},destroy:function(){this.customColorPicker.picker.destroy();this.popup.destroy();this.inherited(arguments)},showSharedThemeColor:function(a){this.popup.setChecked(this.popup.ACTION.SHARED);this.emitSharedThemeChangedEvent(!0,a)},showCustomColor:function(a){a&&(a.stopPropagation(),a.preventDefault());a=this.customColorPicker.domNode;if(h("safari")){var b=document.createEvent("MouseEvents");
b.initEvent("click",!0,!0);a.dispatchEvent(b)}else a.click()},emitSharedThemeChangedEvent:function(a,b){!1!==b&&(this._useHeader=a,this.emit("sharedThemeChanged",this.getColor(),{useHeader:this._useHeader}));this.popup.hideTooltipDialog()},_createTooltipDialog:function(){this.popup=new c({isPortalSupport:this.isPortalSupport,placeAt:this.getParent(),around:this.domNode});this.own(p(this.popup,"btnClick",k.hitch(this,function(a,b){a===this.popup.ACTION.SHARED?this.showSharedThemeColor():a===this.popup.ACTION.CUSTOM&&
this.showCustomColor(b)})));this.own(p(this.popup,"showPopup",k.hitch(this,function(){this._isNoChooseState()?this.popup.setChecked("clean"):this.popup.setChecked(this._useHeader?this.popup.ACTION.SHARED:this.popup.ACTION.CUSTOM)})));var a=new b({showColorPickerOK:!0,showLabel:!1,recordUID:this.recordUID});a.placeAt(this.popup.domNode);a.startup();this.own(p(a,"change",k.hitch(this,function(a){this.setColor(a);this.emitSharedThemeChangedEvent(!1);this.popup.setChecked(this.popup.ACTION.CUSTOM);this.customColorPicker.hideTooltipDialog()})));
this.customColorPicker=a;a=this.customColorPicker.getTooltipDialog();this.own(p(a.domNode,"mouseover",k.hitch(this,function(){this.popup.showPopup()})));this.own(p(a.domNode,"mouseleave",k.hitch(this,function(){!1===this.customColorPicker.isJimuColorPickerTooltipDialogOpened()&&(this.popup.hidePopup(),this.customColorPicker.hideTooltipDialog())})))},setSharedThemeConfig:function(a){a&&"undefined"!==typeof a.useHeader&&(this._useHeader=a.useHeader,this.popup.setIsPortalSupport(a.isPortalSupport),this._isNoChooseState()||
!0===a.useHeader&&this.showSharedThemeColor(!1))},_isNoChooseState:function(){return!1===this._useHeader&&!0===this._isNoChecked?!0:!1},setNoChecked:function(a){this._isNoChecked=!0===a?!0:!1},setColor:function(a){if(a instanceof e){null===this.color&&!0===this.showLabel&&this._changeLabel(a);var b=a.toHex();this.color=a;this.customColorPicker&&(m.setStyle(this.customColorPicker.domNode,"backgroundColor",b),this.customColorPicker.picker.refreshRecords(),this.customColorPicker.picker.setColor(b,!1,
!0));this.showLabel&&this._changeLabel(this.color);m.setStyle(this.domNode,"backgroundColor",b)}},getColor:function(){return this.color},_changeLabel:function(b){m.empty(this.domNode);m.create("span",{innerHTML:b.toHex(),className:"color-label",style:{color:a.invertColor(b.toHex())}},this.domNode)},onChange:function(a){a&&this.showLabel&&this._changeLabel(a)},changeColor:function(){this.customColorPicker&&this.customColorPicker.picker.changeColor();this.showLabel&&this._changeLabel(this.color)},setTitle:function(a){this.domNode.title=
a}})})},"jimu/dijit/ColorPickerPopup":function(){define("dojo/_base/declare dijit/_WidgetBase dijit/_TemplatedMixin dojo/_base/lang dojo/_base/html dojo/on dojo/_base/Color dijit/TooltipDialog dijit/popup jimu/dijit/ColorPalette jimu/utils".split(" "),function(r,l,d,q,k,m,p,h,e,c,b){return r([l,d],{baseClass:"jimu-color-pickerPopup",declaredClass:"jimu.dijit.ColorPickerPopup",templateString:'\x3cdiv class\x3d"jimu-color-picker"\x3e\x3c/div\x3e',_isTooltipDialogOpened:!1,color:null,showLabel:!1,recordUID:"",
postCreate:function(){this.inherited(arguments);this._createTooltipDialog(this.domNode);this._hideTooltipDialog()},destroy:function(){e.close(this.tooltipDialog);this.picker.destroy();this.tooltipDialog.destroy();this.inherited(arguments)},isPartOfPopup:function(a){var b=this.tooltipDialog.domNode,b=a===b||k.isDescendant(a,b),c=null;this.picker&&this.picker.getPickerTooltipDialog&&(c=this.picker.getPickerTooltipDialog().domNode);a=a===c||k.isDescendant(a,c);return b||a},hideTooltipDialog:function(){this._hideTooltipDialog()},
_showTooltipDialog:function(){e.open({parent:this.getParent(),popup:this.tooltipDialog,around:this.domNode});this._isTooltipDialogOpened=!0},_hideTooltipDialog:function(){e.close(this.tooltipDialog);this._isTooltipDialogOpened=!1},_createTooltipDialog:function(){var a=k.create("div");this.tooltipDialog=new h({content:a});k.addClass(this.tooltipDialog.domNode,"jimu-color-picker-popup-dialog");var b=new c({appearance:{showTransparent:!1,showColorPalette:!0,showCoustom:!0,showCoustomRecord:!0},recordUID:this.recordUID,
onChange:q.hitch(this,function(a){a&&(a=new p(a),this.setColor(a),this.onChange(a))})});b.placeAt(a);b.startup();this.own(m(b,"jimuColorPicker-popupClose",q.hitch(this,function(){this._hideTooltipDialog()})));this.own(m(this.domNode,"click",q.hitch(this,function(a){a.stopPropagation();a.preventDefault();this._isTooltipDialogOpened?this._hideTooltipDialog():this._showTooltipDialog()})));this.own(m(document,"click",q.hitch(this,function(a){this.isPartOfPopup(a.srcElement||a.target)||this._hideTooltipDialog()})));
this.picker=b},setColor:function(a){if(a instanceof p){null===this.color&&!0===this.showLabel&&this._changeLabel(a);var b=a.toHex();this.color=a;k.setStyle(this.domNode,"backgroundColor",b);this.picker&&(this.picker.refreshRecords(),this.picker.setColor(b,!1,!0));this.showLabel&&this._changeLabel(this.color)}},getColor:function(){return this.color},_changeLabel:function(a){k.empty(this.domNode);k.create("span",{innerHTML:a.toHex(),className:"color-label",style:{color:b.invertColor(a.toHex())}},this.domNode)},
onChange:function(a){a&&this.showLabel&&this._changeLabel(a)},changeColor:function(){this.picker&&this.picker.changeColor();this.showLabel&&this._changeLabel(this.color)},setTitle:function(a){this.domNode.title=a},getTooltipDialog:function(){return this.tooltipDialog||null},isJimuColorPickerTooltipDialogOpened:function(){return this.picker.isJimuColorPickerTooltipDialogOpened()}})})},"jimu/dijit/ColorPalette":function(){define("dojo/Evented dojo/_base/declare dijit/_WidgetBase dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dojo/_base/lang dojo/_base/html dojo/on dojo/_base/Color dojo/query jimu/dijit/ColorChooser jimu/dijit/ColorPicker jimu/dijit/ColorRecords dijit/popup jimu/utils dijit/a11yclick".split(" "),
function(r,l,d,q,k,m,p,h,e,c,b,a,g,u,n,t){return l([d,k,q,r],{templateString:"\x3cdiv\x3e\x3c/div\x3e",baseClass:"jimu-color-palette",declaredClass:"jimu.dijit.ColorPalette",_TRANSPARENT_STR:"rgba(0, 0, 0, 0)",value:"",_defaultAppearance:{showTransparent:!0,showColorPalette:!0,showColorPickerOK:!1,showCoustom:!0,showCoustomRecord:!0},recordUID:"",postMixInProperties:function(){this.nls=window.jimuNls.colorPalette},postCreate:function(){this.inherited(arguments);this.value=this.value?new e(this.value):
new e("#fff");this._createContent()},_createContent:function(){this.appearance=m.mixin(this._defaultAppearance,this.appearance);var a=p.create("div",{"class":"jimu-colorpalette"},this.domNode);this.appearance.showTransparent&&this._createSpecialColors(a);this.appearance.showColorPalette&&this._createColorChooser(a);this.appearance.showCoustom&&this._createJimuColorPicker(a);this.appearance.showCoustom&&this.appearance.showCoustomRecord&&this._createCoustomRecord(a)},setColor:function(a){this._isColorEqual(a)||
(this.value=new e(a),this._setSpatialColor(this.value),"undefined"!==typeof this.value.a&&0===this.value.a?(this.colorChooser.setColor(new e("transparent"),!1),this.picker.setColor(new e("#fff"),!1)):(this.colorChooser.setColor(this.value.toHex(),!1),this.picker.setColor(this.value,!1)),this.colorRecords&&this.colorRecords.selecteColor(this.value))},getColor:function(){return this.value},changeColor:function(){if("undefined"!==typeof this.value.a&&0===this.value.a)this.onChange(this.value);else this.onChange(this.value.toHex())},
refreshRecords:function(){this.colorRecords&&this.colorRecords.refresh()},destroy:function(){u.close(this.tooltipDialog);this.picker.destroy();this.inherited(arguments)},_createSpecialColors:function(a){a=p.create("div",{"class":"special-color"},a);this.transparentBtn=p.create("div",{"class":"transparent btn",innerHTML:'\x3cdiv class\x3d"btn-wapper"\x3e\x3cdiv class\x3d"transparent icon jimu-float-leading"\x3e\x3c/div\x3e\x3cdiv class\x3d"transparent text jimu-float-leading"\x3e'+this.nls.transparent+
"\x3c/div\x3e\x3c/div\x3e"},a);this.own(h(this.transparentBtn,t,m.hitch(this,this._onTransparentClick)))},_onTransparentClick:function(){this.setColor(new e("transparent"));this.changeColor()},_setSpatialColor:function(a){if(this.transparentBtn){var b=c(".btn-wapper",this.transparentBtn)[0];p.removeClass(b,"selected");a&&a.toString&&a.toString()===this._TRANSPARENT_STR&&p.addClass(b,"selected")}},_createColorChooser:function(a){this.colorChooser=new b({});this.colorChooser.placeAt(a);this.own(h(this.colorChooser,
"change",m.hitch(this,function(a){a=new e(a);this.setColor(a);this.changeColor()})))},_createJimuColorPicker:function(b){this.coustomtBtn=p.create("div",{"class":"coustom btn"},b);b='\x3cdiv class\x3d"btn-wapper"\x3e\x3cdiv class\x3d"custom icon jimu-float-leading"\x3e\x3c/div\x3e\x3cdiv class\x3d"custom text jimu-float-leading"\x3e'+this.nls.custom+"\x3c/div\x3e\x3c/div\x3e";this.picker=new a({ensureMode:!0,showOk:this.appearance.showColorPickerOK,showLabel:!1,value:this.value.toHex(),onChange:m.hitch(this,
function(a){a=new e(a);this.setColor(a);this.changeColor();this.colorRecords&&this.colorRecords.push&&this.colorRecords.push(a)}),onClose:m.hitch(this,function(){this.emit("jimuColorPicker-popupClose")})});this.picker.placeAt(this.coustomtBtn);this.picker.setLabel(b);this.picker.setColor(this.value)},isJimuColorPickerTooltipDialogOpened:function(){return this.picker.isTooltipDialogOpened()},_createCoustomRecord:function(a){this.colorRecords=new g({recordsLength:10,uid:this.recordUID||""});this.colorRecords.placeAt(a);
this.own(h(this.colorRecords,"choose",m.hitch(this,function(a){this.setColor(new e(a));this.changeColor()})))},_isColorEqual:function(a){return this.value.toString()===(new e(a)).toString()?!0:!1},_changeLabel:function(a){p.empty(this.domNode);p.create("span",{innerHTML:a.toHex(),className:"color-label",style:{color:n.invertColor(a.toHex())}},this.domNode)},getPickerTooltipDialog:function(){var a=null;this.picker&&this.picker.tooltipDialog&&(a=this.picker.tooltipDialog);return a}})})},"jimu/dijit/ColorChooser":function(){define("dojo/Evented dojo/_base/declare dijit/_WidgetBase dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dojo/_base/lang dojo/_base/html dojo/on dojo/query dojo/i18n dojo/_base/Color dijit/a11yclick dojo/i18n!dojo/nls/colors".split(" "),
function(r,l,d,q,k,m,p,h,e,c,b,a){return l([d,q,k,r],{templateString:'\x3cdiv\x3e\x3cdiv class\x3d"dijitInline dijitColorPalette" role\x3d"grid"\x3e\x3ctable class\x3d"dijitPaletteTable" cellspacing\x3d"0" cellpadding\x3d"0" role\x3d"presentation"\x3e\x3ctbody data-dojo-attach-point\x3d"gridNode"\x3e\x3c/tbody\x3e\x3c/table\x3e\x3c/div\x3e\x3c/div\x3e',baseClass:"jimu-color-chooser",declaredClass:"jimu.dijit.ColorChooser",uid:"",colorsArray:["white seashell cornsilk lemonchiffon lightyellow palegreen paleturquoise lightcyan lavender plum".split(" "),
"lightgray pink bisque moccasin khaki lightgreen lightseagreen lightskyblue cornflowerblue violet".split(" "),"silver lightcoral sandybrown orange palegoldenrod chartreuse mediumturquoise skyblue mediumslateblue orchid".split(" "),"gray red orangered darkorange yellow limegreen darkseagreen royalblue slateblue mediumorchid".split(" "),"dimgray crimson chocolate coral gold forestgreen seagreen blue blueviolet darkorchid".split(" "),"darkslategray firebrick saddlebrown sienna olive green darkcyan mediumblue darkslateblue darkmagenta".split(" "),
"rgb(0,0,1) darkred maroon brown darkolivegreen darkgreen midnightblue navy indigo purple".split(" ")],postCreate:function(){this.inherited(arguments);this.colorTitleNls=c.getLocalization("dojo","colors");this._createColorsBlocks()},_createColorsBlocks:function(){this._row=this.colorsArray.length;this._col=this.colorsArray[0].length;for(var c=0;c<this._row;c++)for(var d=p.create("tr",{role:"row"},this.gridNode),e=0;e<this._col;e++){var k=this.colorsArray[c][e],f=b.named[k],l="";f?l=k:"rgb(0,0,1)"===
k&&(l="black",f="rgb(0,0,1)");k=this.colorTitleNls[l];f=(new b(f)).toString();this["record"+e]=p.create("td",{"class":"dijitPaletteCell","data-title":f,role:"gridcell"},d);var q=p.create("span",{"class":"dijitInline dijitPaletteImg"},this["record"+e]);p.create("img",{"class":"dijitColorPaletteSwatch",src:require.toUrl("dojo/resources/blank.gif"),alt:k,title:k,"data-title":l,width:"16px",height:"16px",style:"background-color: "+f},q)}this.own(h(this.gridNode,a,m.hitch(this,this.onColorClick)))},onColorClick:function(a){for(var c=
a.target;"TD"!==c.tagName;){if(!c.parentNode||c===this.gridNode)return;c=c.parentNode}c=p.getAttr(c,"data-title");c=(new b(c)).toString();this.setColor(c);a.stopPropagation();a.preventDefault()},_onChange:function(a){this.emit("change",a)},setColor:function(a,c){for(var d=new b(a),g=null,f=e("td",this.domNode),h=0,k=f.length;h<k;h++)p.removeClass(f[h],"dijitPaletteCellSelected");h=0;for(k=f.length;h<k;h++)if(d.toString()===p.getAttr(f[h],"data-title")){g=f[h];break}g&&p.addClass(g,"dijitPaletteCellSelected");
(g&&"undefined"===typeof c||!0===c)&&this._onChange(d)}})})},"jimu/dijit/ColorRecords":function(){define("dojo/Evented dojo/_base/declare dijit/_WidgetBase dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dojo/_base/lang dojo/_base/html dojo/on dojo/query dojo/_base/Color dojo/cookie dojo/text!./templates/ColorRecords.html dijit/a11yclick".split(" "),function(r,l,d,q,k,m,p,h,e,c,b,a,g){return l([d,q,k,r],{templateString:a,baseClass:"jimu-color-records",declaredClass:"jimu.dijit.ColorRecords",uid:"",
recordsLength:10,colorList:null,postCreate:function(){this.inherited(arguments);this.colorList=[];this._createCoustomRecord();""===this.uid&&(this.uid="wab_colorRecords");this.refresh()},push:function(a){this.colorList.unshift(a);this.colorList.length>this.recordsLength&&this.colorList.pop();this._setColors()},selecteColor:function(a){a=new c(a);for(var b=null,d=e("td",this.domNode),f=0,g=d.length;f<g;f++)p.removeClass(d[f],"dijitPaletteCellSelected");f=0;for(g=d.length;f<g;f++)if(a.toString()===
p.getAttr(d[f],"title")){b=d[f];break}b&&(p.addClass(b,"dijitPaletteCellSelected"),this.onChoose(a))},refresh:function(){this._getCookie(this.uid);this._setColors()},_setColors:function(){for(var a=0;a<this.recordsLength;a++){var b=this["record"+a];if(b&&this.colorList[a]&&this.colorList[a].toString){var c=this.colorList[a].toString();p.setAttr(b,"title",c);b=this._findImg(b);p.setStyle(b,"background-color",c);p.setAttr(b,"alt",c);p.setAttr(b,"title",c)}}this._setCookie(this.uid)},_createCoustomRecord:function(){for(var a=
0;a<this.recordsLength;a++){this["record"+a]=p.create("td",{"class":"dijitPaletteCell",tabindex:a,title:"",role:"gridcell"},this.container);var b=p.create("span",{"class":"dijitInline dijitPaletteImg"},this["record"+a]);p.create("img",{"class":"dijitColorPaletteSwatch",src:require.toUrl("dojo/resources/blank.gif"),style:"background-color: #ffffff"},b)}this.own(h(this.gridNode,g,m.hitch(this,this.onRecordClick)))},onRecordClick:function(a){for(var b=a.target;"TD"!==b.tagName;){if(!b.parentNode||b===
this.gridNode)return;b=b.parentNode}b=p.getAttr(b,"title");b=(new c(b)).toString();this.onChoose(b);a.stopPropagation();a.preventDefault()},onChoose:function(a){this.emit("choose",a)},_findImg:function(a){var b=null;return a.nodeName&&"IMG"===a.nodeName.toUpperCase()?a:b=e(".dijitColorPaletteSwatch",a)[0]},_setCookie:function(a){for(var c=[],d=0,e=this.recordsLength;d<e;d++){var g=this.colorList[d];g&&g.toString&&(c[d]=g.toString())}this._cleanCookie(a);try{var h=JSON.stringify(c);b(a,h,{expires:1E3,
path:"/"})}catch(w){console.error("ColorRecords: cookieList JSON.stringify error."+w.stack)}},_getCookie:function(a){a=b(a);if("undefined"!==typeof a)try{var d=JSON.parse(a);if(d&&"undefined"!==typeof d.length){a=0;for(var e=this.recordsLength;a<e;a++){var f=d[a];f&&f.toString&&(this.colorList[a]=new c(f.toString()))}}}catch(v){console.error("ColorRecords: cookieList JSON.parse error."+v.stack)}},_cleanCookie:function(a){b(a,null,{expires:-1})}})})},"builder/plugins/theme-config/ThemeManager":function(){define("dojo/_base/declare dojo/_base/array dojo/_base/lang dojo/Deferred ./Theme builder/serviceUtils".split(" "),
function(r,l,d,q,k,m){return r(null,{themes:void 0,constructor:function(){this.currentThemeName=null;this.themes=[]},loadThemes:function(){var p=new q;m.getAllThemes().then(d.hitch(this,function(d){d.success?(l.forEach(d.themes,function(d){this.themes.push(new k(d))},this),p.resolve(this.themes)):(console.error("Gets themes failed! The response of getThemes is 'unsuccess'!"),p.reject(this.themes))}),function(d){console.error("Gets themes failed!"+d);p.reject(this.themes)});return p},changeCurrentTheme:function(d){this.currentThemeName=
d},getCurrentTheme:function(){return this.getThemeByName(this.currentThemeName)},getThemeByName:function(d){for(var h=0;h<this.themes.length;h++)if(d===this.themes[h].getName())return this.themes[h]}})})},"builder/plugins/theme-config/Theme":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/html dojo/_base/array dojo/Deferred dojo/promise/all dojo/request jimu/utils".split(" "),function(r,l,d,q,k,m,p,h){return r(null,{appConfig:void 0,currentStyleName:void 0,currentLayoutName:void 0,
_manifest:void 0,constructor:function(d){this._manifest=d;this.domNodes={}},clear:function(){var e;this.appConfig=null;for(e=0;e<this._manifest.layouts.length;e++)if("appLayout"===this._manifest.layouts[e].name){this._manifest.layouts[e].domNode&&d.destroy(this._manifest.layouts[e].domNode);this._manifest.layouts.splice(e,1);break}},loadLayouts:function(){var d=new k,c=[],b=q.filter(this._manifest.layouts,function(a){return"appLayout"!==a.name});q.forEach(b,function(a){c.push(p(this._manifest.url+
a.uri,{handleAs:"json"}))},this);m(c).then(l.hitch(this,function(a){var c;q.forEach(b,function(b,d){b.layoutConfig=a[d];if("default"===b.name)c=b.layoutConfig;else{var e=b.layoutConfig.layoutDefinition;b.layoutConfig=h.mixinAppConfigPosition(c,b.layoutConfig);b.layoutConfig.layoutDefinition=e}b.layoutConfig.mobileLayout&&(b.layoutConfig.mobileLayout=h.mixinAppConfigPosition(b.layoutConfig,b.layoutConfig.mobileLayout),delete b.layoutConfig.mobileLayout.mobileLayout)},this);d.resolve()}),function(){d.reject()});
return d},_processLayoutConfig:function(d,c){return h.mixinAppConfigPosition(d,c)},setAppConfig:function(d){this.appConfig=d},getName:function(){return this._manifest.name},getVersion:function(){return this._manifest.version},getLabel:function(){return this._manifest.label},getIcon:function(){return this._manifest.icon},getLayouts:function(){return this._manifest.layouts},getStyles:function(){return this._manifest.styles},getUrl:function(){return this._manifest.url},getCurrentStyle:function(){return this.getStyleByName(this.currentStyleName)},
getCurrentLayout:function(){return this.getLayoutByName(this.currentLayoutName)},changeCurrentStyle:function(d){this.currentStyleName=d},changeCurrentLayout:function(d){this.currentLayoutName=d},addLayout:function(d,c,b,a){var e,h=this.getLayouts();for(e=0;e<h.length;e++)if(h[e].name===d)return null;d={description:"this is current app layout",name:d,label:a,layoutConfig:c,domClass:b};this._manifest.layouts.push(d);return d},getStyleByName:function(d){var c,b=null;for(c=0;c<this._manifest.styles.length;c++)if(this._manifest.styles[c].name===
d){b=this._manifest.styles[c];break}return b},getLayoutByName:function(d){var c,b=null;for(c=0;c<this._manifest.layouts.length;c++)if(this._manifest.layouts[c].name===d){b=this._manifest.layouts[c];break}return b},getLayoutByAppConfig:function(d){var c,b=null;for(c=0;c<this._manifest.layouts.length;c++)if(this.isAppUseLayout(d,this._manifest.layouts[c].layoutConfig)){b=this._manifest.layouts[c];break}return b},isAppUseLayout:function(d,c){var b=l.clone(d),a=l.clone(c);b.map||(b.map={});a.map||(a.map=
b.map);b.map.position||(b.map.position={left:0,top:0});a.map.position||(a.map.position=b.map.position);if(!h.isEqual(b.layoutDefinition,a.layoutDefinition)||!h.isEqual(b.map.position,a.map.position))return!1;b.widgetOnScreen||(b.widgetOnScreen={});a.widgetOnScreen||(a.widgetOnScreen={});b.widgetOnScreen.widgets||(b.widgetOnScreen.widgets=[]);a.widgetOnScreen.widgets||(a.widgetOnScreen.widgets=[]);b.widgetOnScreen.groups||(b.widgetOnScreen.groups=[]);a.widgetOnScreen.groups||(a.widgetOnScreen.groups=
[]);var e,k;e=b.widgetOnScreen.widgets.length<a.widgetOnScreen.widgets.length?b.widgetOnScreen.widgets.length:a.widgetOnScreen.widgets.length;for(k=0;k<e;k++)if(b.widgetOnScreen.widgets[k].position||(b.widgetOnScreen.widgets[k].position={}),a.widgetOnScreen.widgets[k].position||(a.widgetOnScreen.widgets[k].position=b.widgetOnScreen.widgets[k].position),a.widgetOnScreen.widgets[k].position.relativeTo||(a.widgetOnScreen.widgets[k].position.relativeTo=b.widgetOnScreen.widgets[k].position.relativeTo),
!h.isEqual(b.widgetOnScreen.widgets[k].position,a.widgetOnScreen.widgets[k].position))return!1;e=b.widgetOnScreen.groups.length<a.widgetOnScreen.groups.length?b.widgetOnScreen.groups.length:a.widgetOnScreen.groups.length;for(k=0;k<e;k++)if(b.widgetOnScreen.groups[k].panel||(b.widgetOnScreen.groups[k].panel={}),a.widgetOnScreen.groups[k].panel||(a.widgetOnScreen.groups[k].panel=b.widgetOnScreen.groups[k].panel),b.widgetOnScreen.groups[k].panel.position||(b.widgetOnScreen.groups[k].panel.position={}),
a.widgetOnScreen.groups[k].panel.position||(a.widgetOnScreen.groups[k].panel.position=b.widgetOnScreen.groups[k].panel.position),a.widgetOnScreen.groups[k].panel.position.relativeTo||(a.widgetOnScreen.groups[k].panel.position.relativeTo=b.widgetOnScreen.groups[k].panel.position.relativeTo),!h.isEqual(b.widgetOnScreen.groups[k].panel.position,a.widgetOnScreen.groups[k].panel.position))return!1;return!0},getLayoutFromConfig:function(d){var c={};d=l.clone(d);d.widgetOnScreen&&(c.widgetOnScreen={},d.widgetOnScreen.widgets&&
(c.widgetOnScreen.widgets=[],q.forEach(d.widgetOnScreen.widgets,function(b,a){c.widgetOnScreen.widgets[a]={position:b.position?b.position:{left:0,top:0}}})),d.widgetOnScreen.groups&&(c.widgetOnScreen.groups=[],q.forEach(d.widgetOnScreen.groups,function(b,a){c.widgetOnScreen.groups[a]={position:b.position?b.position:{left:0,top:0}}})));d.map&&(c.map={position:d.map.position});return c}})})},"builder/plugins/widget-config/_build-generate_module":function(){define(["builder/plugins/widget-config/Plugin",
"dojo/text!builder/plugins/widget-config/Plugin.html","dojo/text!builder/plugins/widget-config/css/style.css","dojo/i18n!builder/plugins/widget-config/nls/strings"],function(){})},"builder/plugins/widget-config/Plugin":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/html dojo/_base/array dojo/_base/fx dojo/topic dojo/on dijit/_WidgetBase ./WidgetsList ./MoveableNode ./WidgetSettingPage ./GroupSettingPage ./WidgetChoosePage jimu/utils jimu/PoolControllerMixin jimu/dijit/ViewStack jimu/dijit/Popup builder/BasePlugin esri/lang".split(" "),
function(r,l,d,q,k,m,p,h,e,c,b,a,g,u,n,t,f,v,x){return r([v],{baseClass:"plugin-widget-config app-widgets",postMixInProperties:function(){this.nls=l.mixin(this.nls,window.builderNls)},postCreate:function(){this.inherited(arguments);this.notRemoveableWidgetOnScreen=new e({name:"notRemoveableWidgetOnScreen",nls:this.nls,folderUrl:this.folderUrl},this.notRemoveableOnScreenWidgetsListNode);this.removeableWidgetOnScreen=new e({name:"removeableWidgetOnScreen",nls:this.nls,folderUrl:this.folderUrl},this.removeableOnScreenWidgetsListNode);
this.groupOnScreen=new e({name:"groupOnScreen",nls:this.nls,folderUrl:this.folderUrl},this.onScreenGroupsListNode);this.poolWidgets=new e({name:"poolWidgets",nls:this.nls,folderUrl:this.folderUrl},this.poolWidgetsListNode);this.viewStack=new t({viewType:"dom",views:[this.preloadWidgetsNode,this.poolWidgetsNode]});this.viewStack.placeAt(this.domNode);this.poolControllerClass=r([h,n]);this.own(m.subscribe("editWidget",l.hitch(this,this._onEditWidget)));this.own(m.subscribe("chooseWidget",l.hitch(this,
this._onChooseWidget)));this.own(m.subscribe("editGroup",l.hitch(this,this._onEditGroup)));this.own(m.subscribe("app/appConfigChanged",l.hitch(this,this._onAppConfigChanged)));this.own(m.subscribe("app/appConfigLoaded",l.hitch(this,this._onAppConfigChanged)));this.own(m.subscribe("widgetSettingPageOk",l.hitch(this,this._onWidgetSettingPageOk)));this.own(p(this.poolWidgets,"offpanel-group-error",l.hitch(this,this._onOffPanelGroupError)));this.own(p(this.groupOnScreen,"group-exceed-max-error",l.hitch(this,
this._onGroupExceedMaxError)));this.own(p(this.groupOnScreen,"groupOpened",l.hitch(this,this._onOnScreenGroupOpenClose)));this.own(p(this.groupOnScreen,"groupClosed",l.hitch(this,this._onOnScreenGroupOpenClose)));window.isRTL&&(d.removeClass(this.backArrowNode,"icon-arrow-back"),d.addClass(this.backArrowNode,"icon-arrow-forward"))},startup:function(){this.inherited(arguments);this.viewStack.startup();this.poolWidgets.opened=!1;this._init(this.appConfig)},destroy:function(){q.forEach(this.controllers,
function(a){a.destroy()});this.controllers=[];this.inherited(arguments)},onShown:function(){this._init(this.appConfig)},onHidden:function(){},_onAppConfigChanged:function(a){this._started?this.appConfig&&u.isEqual(this.appConfig.widgetOnScreen,a.widgetOnScreen)&&u.isEqual(this.appConfig.widgetPool,a.widgetPool)?this.appConfig=a:this._init(a):this.appConfig=a},_init:function(a){this.appConfig=a;this._createControllerWidgetNodes();this.poolWidgets.opened?0<this.controllers.length?q.some(this.controllers,
function(a){if(this.poolWidgets.controller.id===a.id)return this._initWidgetPool(a),!0},this)||this._initWidgetPool(this.controllers[0]):(this._initWidgetPool(null),this._onBackWidgetsClick()):this._initOnScreenWidget(a);this.widgetChoosePage&&this.widgetChoosePage.setAppConfig(a);this.widgetSettingPage&&this.widgetSettingPage.setAppConfig(a)},_onOffPanelGroupError:function(){d.setStyle(this.offPanelToGroupErrorNode,{display:"block",opacity:1});k.fadeOut({node:this.offPanelToGroupErrorNode,duration:5E3,
onEnd:l.hitch(this,function(){d.setStyle(this.offPanelToGroupErrorNode,{display:"none"})})}).play()},_onGroupExceedMaxError:function(a){a=x.substitute({maxCount:a.maxWidgets},this.nls.addWidgetExceedMax);this.groupExceedMaxErrorStringNode.innerText=a;d.setStyle(this.groupExceedMaxErrorNode,{display:"block",opacity:1});k.fadeOut({node:this.groupExceedMaxErrorNode,duration:5E3,onEnd:l.hitch(this,function(){d.setStyle(this.groupExceedMaxErrorNode,{display:"none"})})}).play()},_onOnScreenGroupOpenClose:function(){d.setStyle(this.onScreenGroupsListNode,
{height:this.groupOnScreen.getListHeight()+"px"})},_getNonControllerAndNotRemoveableOnScreenWidgets:function(a){var b=[];if(!a.widgetOnScreen)return[];q.forEach(a.widgetOnScreen.widgets,function(a){a.isController||!1!==a.inPanel||!0===a.closeable||b.push(a)},this);return b},_getNonControllerAndRemoveableOnScreenWidgets:function(a){var b=[];if(!a.widgetOnScreen)return[];q.forEach(a.widgetOnScreen.widgets,function(a){a.isController||(!1!==a.inPanel||!0!==a.closeable)&&!0!==a.inPanel&&a.uri||b.push(a)},
this);return b},_getOnScreenGroups:function(a){return a.widgetOnScreen&&a.widgetOnScreen.groups?a.widgetOnScreen.groups:[]},_createControllerWidgetNodes:function(){q.forEach(this.controllers,function(a){d.destroy(a.node);a.destroy()},this);this.controllers=[];q.forEach(this.appConfig.widgetOnScreen.widgets,function(a){a.isController&&this._createControllerWidgetNode(a)},this);this.controllerWidgetsHeight=118*this.controllers.length;d.setStyle(this.controllerWidgetsNode,{height:this.controllerWidgetsHeight+
"px"})},_createControllerWidgetNode:function(a){var b=d.create("div",{"class":"controller-widget"},this.controllerWidgetsNode),e={};window.isRTL?e.right="30px":e.left="30px";e=new c({type:"widget",w:74,h:118,setting:a,listName:"controllerWidgets",style:e,nls:this.nls});d.place(e.domNode,b);e.startup();e=d.create("div",{"class":"action-node"},b);d.create("div",{"class":"action-text jimu-float-leading jimu-leading-margin1",title:this.nls.setControlledWidgets,innerHTML:this.nls.setControlledWidgets},
e);window.isRTL?d.create("div",{"class":"action-arrow feature-action icon-arrow-left jimu-float-trailing jimu-trailing-margin2"},e):d.create("div",{"class":"action-arrow feature-action icon-arrow-right jimu-float-trailing jimu-trailing-margin2"},e);a=new this.poolControllerClass(a);a.appConfig=this.appConfig;a.node=b;this.controllers.push(a);this.own(p(e,"click",l.hitch(this,this._openWidgetPool,a)))},_openWidgetPool:function(a){!1!==a.visible&&(this.currentController=a,this.viewStack.switchView(this.poolWidgetsNode),
this.poolWidgets.opened=!0,this.removeableWidgetOnScreen.opened=!1,this.notRemoveableWidgetOnScreen.opened=!1,this.controllerLabelNode.innerHTML=u.stripHTML(a.label),this.poolWidgets._started||this.poolWidgets.startup(),this._initWidgetPool(a))},_initWidgetPool:function(a){this.poolWidgets.controller=a;this.poolWidgets.setAppConfig(this.appConfig);this.poolWidgets.setSettings(a?a.getAllConfigs():[])},_initOnScreenWidget:function(a){this.groupOnScreen._started||this.groupOnScreen.startup();this.groupOnScreen.setSettings(this._getOnScreenGroups(a));
this.groupOnScreen.setAppConfig(a);0<this.controllers.length&&0<this.groupOnScreen.settings.length&&(0<this.controllers.length||0<this.groupOnScreen.settings.length)?d.setStyle(this.onScreenGroupsHline,"display",""):d.setStyle(this.onScreenGroupsHline,"display","none");d.setStyle(this.onScreenGroupsListNode,{height:this.groupOnScreen.getListHeight()+"px"});this.notRemoveableWidgetOnScreen._started||this.notRemoveableWidgetOnScreen.startup();this.notRemoveableWidgetOnScreen.setAppConfig(a);this.notRemoveableWidgetOnScreen.setSettings(this._getNonControllerAndNotRemoveableOnScreenWidgets(a));
0<this.notRemoveableWidgetOnScreen.settings.length?d.setStyle(this.notRemoveableOnScreenWidgetsHline,"display",""):d.setStyle(this.notRemoveableOnScreenWidgetsHline,"display","none");d.setStyle(this.notRemoveableOnScreenWidgetsListNode,{height:this.notRemoveableWidgetOnScreen.getListHeight()+"px"});this.removeableWidgetOnScreen._started||this.removeableWidgetOnScreen.startup();this.removeableWidgetOnScreen.setAppConfig(a);this.removeableWidgetOnScreen.setSettings(this._getNonControllerAndRemoveableOnScreenWidgets(a));
0<this.removeableWidgetOnScreen.settings.length&&(0<this.controllers.length||0<this.notRemoveableWidgetOnScreen.settings.length)?d.setStyle(this.removeableOnScreenWidgetsHline,"display",""):d.setStyle(this.removeableOnScreenWidgetsHline,"display","none");d.setStyle(this.removeableOnScreenWidgetsListNode,{height:this.removeableWidgetOnScreen.getListHeight()+"px"})},_onBackWidgetsClick:function(){this._createControllerWidgetNodes();this.viewStack.switchView(this.preloadWidgetsNode);this.poolWidgets.opened=
!1;this.removeableWidgetOnScreen.opened=!0;this.notRemoveableWidgetOnScreen.opened=!0;this._initOnScreenWidget(this.appConfig)},_onEditWidget:function(a,c){this.widgetSettingPage=new b({appConfig:this.appConfig,nls:this.nls},this.widgetSettingPageNode);this.widgetSettingPage.setting=l.clone(a);this.widgetSettingPage.fromNode=c;var e=new f({titleLabel:this.nls.configLabel+" "+a.label,content:this.widgetSettingPage,container:"main-page",buttons:[{label:this.nls.ok,onClick:l.hitch(this.widgetSettingPage,
this.widgetSettingPage.onOk)},{label:this.nls.cancel,classNames:["jimu-btn-vacation"],onClick:l.hitch(this.widgetSettingPage,this.widgetSettingPage.onCancel)}],onClose:l.hitch(this.widgetSettingPage,this.widgetSettingPage.onClose)});d.addClass(e.domNode,"widget-setting-popup");this.widgetSettingPage.startup()},_onChooseWidget:function(a,b){this.widgetChoosePage=new g({appConfig:this.appConfig,nls:this.nls,options:{includeOffPanel:"groupOnScreen"===b?!1:!0}},this.widgetChoosePageNode);this.widgetChoosePage.fromNode=
a;this.widgetChoosePage.fromList=b;new f({titleLabel:this.nls.chooseWidget,content:this.widgetChoosePage,container:"main-page",buttons:[{label:this.nls.ok,onClick:l.hitch(this.widgetChoosePage,this.widgetChoosePage.onOk)},{label:this.nls.cancel,classNames:["jimu-btn-vacation"]}]});this.widgetChoosePage.startup()},_onEditGroup:function(b,c){this.groupSettingPage=new a({setting:l.clone(c),nls:this.nls});new f({titleLabel:c.label,content:this.groupSettingPage,container:"main-page",buttons:[{label:this.nls.ok,
onClick:l.hitch(this.groupSettingPage,this.groupSettingPage.onOk)},{label:this.nls.cancel,classNames:["jimu-btn-vacation"]}]});this.groupSettingPage.startup()},_onWidgetSettingPageOk:function(a){a.isController&&m.publish("widgetChanged",a)},_getPopupSize:function(){var a=d.getContentBox("main-page"),b={};1024>=a.w?(b.width=a.w-20,b.height=a.h-20):(b.width=1024,b.height=768);return b}})})},"builder/plugins/widget-config/WidgetsList":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/html dojo/_base/array dojo/topic dojo/aspect dojo/Evented dojo/query dojo/NodeList-dom dijit/_WidgetBase ./MoveableNode ./LinkList jimu/utils".split(" "),
function(r,l,d,q,k,m,p,h,e,c,b,a,g){function u(a){var b={};isFinite(a.l)&&(b.left=a.l+"px");isFinite(a.t)&&(b.top=a.t+"px");isFinite(a.w)&&(b.width=a.w+"px");isFinite(a.h)&&(b.height=a.h+"px");return b}var n,t=r([c],{box:null,marginBox:null,postCreate:function(){this.inherited(arguments);this.domNode=d.create("div",{"class":"node-margin"});this.type="addBtn"===this.node.type?"addMargin":"margin"}});return r([c,p],{postCreate:function(){this.nodeList=new a({name:this.name});this.own(k.subscribe("widgetChoosePageOk",
l.hitch(this,this._onWidgetChoosePageOk)));this.own(k.subscribe("widgetSettingPageOk",l.hitch(this,this._onWidgetSettingPageOk)))},startup:function(){this.inherited(arguments);this.settings&&this.initNodes()},setSettings:function(a){this.settings=l.clone(a);this.initNodes()},setAppConfig:function(a){this.appConfig=a},addWidget:function(a){a=this.createMoveableNode("widget",a);this.nodeList.insertNode(a);this.placeNodes()},createMoveableNode:function(a,c){var e=l.clone(this.box);e.h=Infinity;var f=
new b({type:a,w:74,h:118,setting:c,listName:this.name,parentBox:e,nls:this.nls,folderUrl:this.folderUrl,appConfig:this.appConfig});d.place(f.domNode,this.domNode);f.startup();this.bindMoveEvent(f);"group"===a&&(m.after(f,"openGroup",l.hitch(this,this.openGroup,f)),m.after(f,"closeGroup",l.hitch(this,this.closeGroup,f)));f.on("removeNode",l.hitch(this,function(){"poolWidgets"===this.name||"groupOnScreen"===this.name?(f.gnode?(this.nodeList.removeNode(f),this._reopenGroup()):this.nodeList.removeNode(f),
this.placeNodes(),"poolWidgets"===this.name?this.publishPoolChangeEvent():k.publish("groupChanged",f.gnode.setting)):(f.setting.uri="",f.setting.label=this.nls.defaultWidgetLabel,f.setting.name=void 0,f.setting.placeholderIndex="?",f.setting.config=void 0,this.label=this.nls.defaultWidgetLabel,g.widgetJson.removeManifestFromWidgetJson(f.setting),k.publish("widgetChanged",f.setting))}));f.on("clickOpenAtStart",l.hitch(this,function(){var a={id:f.setting.id,openAtStart:!f.setting.openAtStart};a.isOnScreen=
"poolWidgets"===this.name?!1:!0;k.publish("openAtStartChange",a)}));this.createMarginNode(f);return f},openGroup:function(a){var b,c,d,e,f,g,h;this.openedGNode&&this.openedGNode!==a&&this.openedGNode.closeGroup(this.openedGNode);b=a.setting.widgets;f=this.getNodePosition(this.nodeList.getNodeIndex(a)).r;g=this._groupCanAddMoreWidget(a)?Math.ceil((b.length+1)/n):Math.ceil(b.length/n);c=f*n+1;d=this.nodeList.getNodeByIndex(c);for(e=this.nodeList.getCount()+1;e<c;e++)h=this.createMoveableNode("empty"),
h.gnode=a,this.nodeList.insertNode(h,d);this.openedGNode=a;this.openedGNode.panelRow=f+1;this.createGroupPanel(f+1,g);b.forEach(l.hitch(this,function(b){b=this.createMoveableNode("widget",b);b.gnode=a;this.nodeList.insertNode(b,d)}));"groupOnScreen"===this.name?this._groupCanAddMoreWidget(a)?(e=this.createMoveableNode("addBtn"),e.gnode=a,this.nodeList.insertNode(e,d),b=n*g-b.length-1):b=n*g-b.length:b=n*g-b.length;for(e=0;e<b;e++)h=this.createMoveableNode("empty"),h.gnode=a,this.nodeList.insertNode(h,
d);this.placeNodes();this.emit("groupOpened")},_groupCanAddMoreWidget:function(a){return"undefined"===typeof a.setting.maxWidgets||a.setting.maxWidgets>a.setting.widgets.length},createGroupPanel:function(a,b){var c={t:118*(a-1)-10,h:118*b+0*(b-1),w:89*n-15+20};window.isRTL?c.r=5:c.l=5;this.groupPanel=d.create("div",{"class":"widget-group-panel",style:u(c)},this.domNode);c=(this.openedGNode.pos.c-1)%n*89+37;window.isRTL&&(c=1===this.openedGNode.pos.c?89*n-37:(n-this.openedGNode.pos.c+1)%n*89-37);d.create("div",
{"class":"group-triangle",style:{left:c+"px"}},this.groupPanel);this.groupPanel.type="panel"},closeGroup:function(a){var b=[];a.setting.widgets=[];this.nodeList.visitNodes(l.hitch(this,function(c){c.gnode===a&&("empty"!==c.type&&"addBtn"!==c.type&&a.setting.widgets.push(c.setting),b.push(c))}));b.forEach(l.hitch(this,function(a){this.nodeList.removeNode(a)}));0===a.setting.widgets.length?"poolWidgets"===this.name&&this.nodeList.removeNode(a):a.updateSmallWidgets();this.placeNodes();d.destroy(this.groupPanel);
this.openedGNode=null;this.emit("groupClosed")},initNodes:function(){this.box=d.getContentBox(this.domNode);this.position=d.position(this.domNode,!0);n=Math.floor(this.box.w/89);this.destroyShadowNode();var a=this.settings;if("notRemoveableWidgetOnScreen"===this.name)a=a.sort(function(a,b){return a.label.localeCompare(b.label)});else if("removeableWidgetOnScreen"===this.name)var b=q.filter(a,function(a){return a.widgets}),b=b.sort(function(a,b){return a.label.localeCompare(b.label)}),c=q.filter(a,
function(a){return a.uri}),c=c.sort(function(a,b){return a.label.localeCompare(b.label)}),a=q.filter(a,function(a){return!a.widgets&&!a.uri}),a=a.sort(function(a,b){return a.placeholderIndex-b.placeholderIndex}),a=[].concat(b,c,a);else a=a.sort(function(a,b){return a.index-b.index});var e;this.openedGNode&&(e=this.openedGNode.label,this.closeGroup(this.openedGNode));this.nodeList.destroyAllNodes();"poolWidgets"===this.name&&(this.addBtn=this.createMoveableNode("addBtn"),this.nodeList.insertNode(this.addBtn));
a.forEach(l.hitch(this,function(a){(a=a.widgets?this.createMoveableNode("group",a):a.uri?this.createMoveableNode("widget",a):this.createMoveableNode("placeholder",a))&&this.nodeList.insertNode(a)}));"poolWidgets"===this.name&&this.nodeList.insertNode(this.createMoveableNode("empty"));this.placeNodes();e&&(b=this.nodeList.getNodeByLabel(e))&&(this.openGroup(b),b.status="open")},getListHeight:function(){var a=0;this.nodeList.visitNodes(function(b){a=Math.max(b.pos.r,a)});return 118*a},_removeActive:function(){h(".node-margin-active",
this.domNode).removeClass("node-margin-active");h(".empty-node-active",this.domNode).removeClass("empty-node-active");h(".node-active",this.domNode).removeClass("node-active")},bindMoveEvent:function(a){"addBtn"!==a.type&&a.dnd&&(m.after(a.dnd,"onMove",l.hitch(this,function(b,c,e){b=this.getMousePosition(e);this.mouseNode=this.getNodeByMousePosition(a,b);this._removeActive();this.mouseNode&&"margin"===this.mouseNode.type?d.addClass(this.mouseNode.domNode,"node-margin-active"):this.mouseNode&&"empty"===
this.mouseNode.type?d.addClass(this.mouseNode.domNode,"empty-node-active"):!this.mouseNode||"group"!==this.mouseNode.type&&"widget"!==this.mouseNode.type||d.addClass(this.mouseNode.domNode,"node-active")}),!0),m.after(a.dnd,"onMoveStart",l.hitch(this,function(){this.destroyShadowNode();this.createShadowNode(a);d.setStyle(a.boxNode,"cursor","move")}),!0),m.after(a.dnd,"onMoveStop",l.hitch(this,this._onMoveStop,a),!0))},_onMoveStop:function(a){var b=!1,c=[];d.setStyle(a.boxNode,"cursor","pointer");
this.mouseNode&&(a===this.mouseNode?console.log("move to the same node"):"margin"===this.mouseNode.type?(this.moveNodeToMargin(a,this.mouseNode),"groupOnScreen"===this.name&&c.push(a.gnode.setting),b=!0):"empty"===this.mouseNode.type?this.mouseNode.gnode&&"group"===a.type?console.log("not allow move group to opened group, revert"):(this.moveNodeToEmpty(a,this.mouseNode),"groupOnScreen"===this.name&&c.push(a.gnode.setting),b=!0):"group"===this.mouseNode.type?"group"===a.type?console.log("not allow move group to closed group, revert"):
"open"===this.mouseNode.status?console.log("please put widget into the opened group panel"):!1===a.setting.inPanel?this._showOffPanelToGroupError():a.gnode&&a.gnode===this.mouseNode?console.log("the moving widget is already in the group"):this.mouseNode.setting.maxWidgets&&this.mouseNode.setting.widgets&&this.mouseNode.setting.widgets.length+1>this.mouseNode.setting.maxWidgets?this._showGroupExceedMaxError(this.mouseNode.setting):(this.moveWidgetToGroup(a,this.mouseNode),"groupOnScreen"===this.name&&
(c.push(a.gnode.setting),c.push(this.mouseNode.setting)),b=!0):"widget"===this.mouseNode.type&&("group"===a.type?console.log("not allow move group to widget, revert"):!1===a.setting.inPanel||!1===this.mouseNode.setting.inPanel?this._showOffPanelToGroupError():a.gnode||this.mouseNode.gnode?console.log("can not nest group"):(this.moveWidgetToWidget(a,this.mouseNode),b=!0)),this._reopenGroup());this.destroyShadowNode();b&&("poolWidgets"===this.name?this.publishPoolChangeEvent():0<c.length&&this.publishOnScreenGroupsChangeEvent());
this.placeNodes()},_reopenGroup:function(){if(this.openedGNode){var a=this.openedGNode;this.closeGroup(a);this.nodeList.isExist(a)&&this.openGroup(a)}},getNodePosition:function(a){var b={},c;c=Math.ceil(a/n);a%=n;0===a&&(a=n);b.t=118*(c-1);var d=89*(a-1)+15;b.l=window.isRTL?this.box.w-d-74:d;b.w=74;b.h=118;b.r=c;b.c=a;return b},getMarginNodePosition:function(a){var b={};a=a.pos;b.l=window.isRTL?a.l+74+7.5:a.l-7.5-2.5;b.t=a.t;b.w=5;b.h=118;return b},createMarginNode:function(a){var b=new t({label:a.label,
node:a});d.place(b.domNode,this.domNode);return a.margin=b},getMousePosition:function(a){return{x:a.pageX-this.position.x,y:a.pageY-this.position.y}},moveNodeToMargin:function(a,b){var c=this.getNodeByMarginNode(b);console.log("moveNodeToMargin");h(".node-margin-active",this.domNode).removeClass("node-margin-active");c.gnode&&!a.gnode?a.gnode=c.gnode:!c.gnode&&a.gnode&&(a.gnode=null);this.nodeList.moveNode(a,c)},moveNodeToEmpty:function(a,b){h(".empty-node-active",this.domNode).removeClass("empty-node-active");
b.gnode&&!a.gnode?a.gnode=b.gnode:!b.gnode&&a.gnode&&(a.gnode=null);this.nodeList.moveNode(a,b)},getNodeByMarginNode:function(a){var b;this.nodeList.visitNodes(function(c){c.margin===a&&(b=c)});return b},placeNodes:function(){var a,b;this.nodeList.visitNodes(l.hitch(this,function(c,e){a=this.getNodePosition(e);c.pos=a;d.setStyle(c.domNode,u(a));b=this.getMarginNodePosition(c);c.margin.pos=b;d.setStyle(c.margin.domNode,u(b))}));this.nodeList.printNodeList()},moveWidgetToGroup:function(a,b){a&&a.setting&&
delete a.setting.openAtStart;b.addWidget(a);this.nodeList.removeNode(a)},moveWidgetToWidget:function(a,b){var c;a&&a.setting&&delete a.setting.openAtStart;c=this.createMoveableNode("group",{label:this._getGroupLabel(),widgets:[a.setting,b.setting]});this.nodeList.insertNode(c,b);this.nodeList.removeNode(a);this.nodeList.removeNode(b)},createShadowNode:function(a){this.shadowNode=d.create("div",{"class":"node-shadow",style:u(d.getMarginBox(a.domNode))},this.domNode)},destroyShadowNode:function(){this.shadowNode&&
d.destroy(this.shadowNode)},getNodeByMousePosition:function(a,b){var c;this.nodeList.visitNodes(function(d){if("addBtn"!==d.type){if(b.x>d.pos.l+10&&b.x<d.pos.l+d.pos.w-10&&b.y>d.pos.t+10&&b.y<d.pos.t+d.pos.h-10&&d!==a)return c=d,!0;if(b.x>d.margin.pos.l&&b.x<d.margin.pos.l+d.margin.pos.w&&b.y>d.margin.pos.t&&b.y<d.margin.pos.t+d.margin.pos.h&&d.margin!==a)return c=d.margin,!0}});return c},_getGroupLabel:function(){var a=-1;this.appConfig.visitElement(l.hitch(this,function(b){if(b.widgets)if(b.label===
this.nls.newGroup)a=0;else if(b.label.startWith(this.nls.newGroup)){var c=b.label.lastIndexOf("_");-1<c&&(b=parseInt(b.label.substr(c+1,b.label.length),10),a=Math.max(a,b))}}));return-1===a?this.nls.newGroup:this.nls.newGroup+"_"+(a+1)},_showOffPanelToGroupError:function(){console.log("Off panel widget is not allowed in group.");this.emit("offpanel-group-error")},_showGroupExceedMaxError:function(a){this.emit("group-exceed-max-error",a)},_onWidgetChoosePageOk:function(a,b){if(b.listName===this.name)if(1===
a.length){var c;"addBtn"===b.type?c=a[0]:"group"===b.type?c=a[0]:(c=l.clone(b.setting),l.mixin(c,a[0]));k.publish("editWidget",c,b)}else"poolWidgets"===this.name?(q.forEach(a,function(a){this.addWidget(a)},this),this.publishPoolChangeEvent()):("addBtn"===b.type?c=l.clone(this.appConfig.getConfigElementById(b.gnode.setting.id)):"group"===b.type&&(c=l.clone(this.appConfig.getConfigElementById(b.setting.id))),c.widgets=c.widgets.concat(a),k.publish("groupChanged",c))},_onWidgetSettingPageOk:function(a,
b){if(b.listName===this.name)if(a.id)k.publish("widgetChanged",a);else if("poolWidgets"===this.name)this.addWidget(a),this.publishPoolChangeEvent();else{var c;"addBtn"===b.type?c=l.clone(this.appConfig.getConfigElementById(b.gnode.setting.id)):"group"===b.type&&(c=l.clone(this.appConfig.getConfigElementById(b.setting.id)));c.widgets.push(a);c.label||(c.label=this._getGroupLabel());k.publish("groupChanged",c)}},publishPoolChangeEvent:function(){var a=[],b=[];this.nodeList.visitNodes(function(c,d){"widget"!==
c.type||c.gnode?"group"===c.type&&(c.setting.index=d,a.push(c.setting)):(c.setting.index=d,b.push(c.setting))});k.publish("widgetPoolChanged",{widgets:b,groups:a,controllerId:this.controller.id})},publishOnScreenGroupsChangeEvent:function(){var a=[];this.nodeList.visitNodes(function(b){"group"===b.type&&a.push(b.setting)});k.publish("onScreenGroupsChanged",{groups:a})}})})},"builder/plugins/widget-config/MoveableNode":function(){define("dojo/_base/declare dojo/_base/html dojo/_base/lang dojo/_base/array dojo/on dojo/Evented dojo/aspect dojo/mouse dojo/touch dojo/topic dojo/query ./Mover dojo/dnd/move dijit/_WidgetBase jimu/dijit/Message jimu/utils dojo/NodeList-dom dojo/NodeList-manipulate".split(" "),
function(r,l,d,q,k,m,p,h,e,c,b,a,g,u,n,t){var f="click",v=h.enter,x=h.leave;"ontouchstart"in document&&(f=e.press,v=e.enter,x=e.leave);return r([u,m],{type:"",label:"",isMoving:!1,isMouseDown:!1,postCreate:function(){this.inherited(arguments);if("addBtn"===this.type)this.label="addBtn",this.createAddBtn();else if("empty"===this.type)this.label="empty",this.createEmptyNode();else if("widget"===this.type){if(this.createWidgetNode(),"poolWidgets"===this.listName||"groupOnScreen"===this.listName)this.dnd=
new g.boxConstrainedMoveable(this.domNode,{handle:this.boxNode,box:this.parentBox,within:!0,delay:5,mover:a}),this.bindMoveEvent()}else"placeholder"===this.type?this.createPlaceholderNode():(this.createGroupNode(),"poolWidgets"===this.listName&&(this.dnd=new g.boxConstrainedMoveable(this.domNode,{handle:this.boxNode,box:this.parentBox,within:!0,delay:5,mover:a}),this.bindMoveEvent()));l.addClass(this.domNode,"moveable");l.setStyle(this.domNode,{width:this.w+"px",height:this.h+"px"})},bindMoveEvent:function(){p.after(this.dnd,
"onMoveStart",d.hitch(this,function(){this.isMoving=!0}),!0);p.after(this.dnd,"onMoveStop",d.hitch(this,function(){this.isMoving=!1}),!0)},_createWidgetIconNode:function(){var a=t.processUrlInAppConfig(this.setting.icon);this.iconNode=l.create("img",{"class":"icon",src:a,style:{width:"32px",height:"32px",margin:(this.w-32)/2+"px"}},this.boxNode)},_createPlaceholderNode:function(){this.placeholderNode=l.create("div",{"class":"placeholder",style:{width:"32px",height:"32px",margin:(this.w-32)/2+"px"}},
this.boxNode);l.create("div",{"class":"placeholder-inner",innerHTML:this.setting.placeholderIndex,style:{width:"16px",height:"16px",lineHeight:"16px",borderRadius:"8px",margin:"7px"}},this.placeholderNode)},createWidgetNode:function(){l.addClass(this.domNode,"widget-node");l.setAttr(this.domNode,"data-widget-name",this.setting.name);this.boxNode=l.create("div",{"class":"box",style:{width:this.w+"px",height:this.w+"px"}},this.domNode);this._createWidgetIconNode();this.label=this.setting.label?this.setting.label:
this.nls.defaultWidgetLabel;this.name=this.setting.name?this.setting.name:this.nls.defaultWidgetLabel;this.labelNode=l.create("div",{"class":"label",innerHTML:t.stripHTML(this.label),title:this.label},this.domNode);!1===this.setting.visible&&l.addClass(this.domNode,"hide");this.setting.openAtStart&&(this.openAtStartNode=this._createOpenAtStartNode(),this.own(k(this.openAtStartNode,f,d.hitch(this,function(a){a.stopPropagation();this.emit("clickOpenAtStart")}))));this.own(k(this.boxNode,v,d.hitch(this,
function(){c.publish("actionTriggered",{elementId:this.setting.id,action:"highLight"});this.editNode=this._createEditNode();this.own(k(this.editNode,f,d.hitch(this,function(a){a.stopPropagation();c.publish("editWidget",this.setting,this)})));this.supportOpenAtStart()&&!this.setting.openAtStart&&(this.openAtStartNode=this._createOpenAtStartNode(),this.own(k(this.openAtStartNode,f,d.hitch(this,function(a){a.stopPropagation();this.emit("clickOpenAtStart")}))));!1===this.setting.inPanel&&this.setting.isOnScreen&&
"undefined"===typeof this.setting.closeable?(this.switchNode=this._createSwitchNode(),this.own(k(this.switchNode,f,d.hitch(this,function(a){a.stopPropagation();a=d.clone(this.setting);!1===a.visible?(a.visible=!0,l.removeClass(this.domNode,"hide")):(a.visible=!1,l.addClass(this.domNode,"hide"));c.publish("widgetChanged",a)})))):(this.dropNode=this._createDropNode(),this.own(k(this.dropNode,f,d.hitch(this,function(a){a.stopPropagation();var b;b=this._checkDataSource(this.setting.id)?new n({message:this.nls.dataSourceIsUsed,
buttons:[{label:this.nls.ok,onClick:d.hitch(this,function(){this.emit("removeNode");b.close()})},{label:this.nls.cancel}]}):new n({message:this.nls.dropWidgetMessage,buttons:[{label:this.nls.ok,onClick:d.hitch(this,function(){this.emit("removeNode");b.close()})},{label:this.nls.cancel}]})}))))})));this.own(k(this.boxNode,x,d.hitch(this,function(){c.publish("actionTriggered",{elementId:this.setting.id,action:"removeHighLight"});this.editNode&&l.destroy(this.editNode);this.openAtStartNode&&!this.setting.openAtStart&&
l.destroy(this.openAtStartNode);this.dropNode&&l.destroy(this.dropNode);this.switchNode&&l.destroy(this.switchNode)})))},createPlaceholderNode:function(){l.addClass(this.domNode,"widget-node");l.addClass(this.domNode,"placeholder");l.setAttr(this.domNode,"data-placeholder-index",this.setting.placeholderIndex);this.boxNode=l.create("div",{"class":"box",style:{width:this.w+"px",height:this.w+"px"}},this.domNode);this._createPlaceholderNode();this.label=this.setting.label?this.setting.label:this.nls.defaultWidgetLabel;
this.name=this.setting.name?this.setting.name:this.nls.defaultWidgetLabel;this.labelNode=l.create("div",{"class":"label",innerHTML:t.stripHTML(this.label),title:this.label},this.domNode);this.own(k(this.boxNode,v,d.hitch(this,function(){c.publish("actionTriggered",{elementId:this.setting.id,action:"highLight"})})));this.own(k(this.boxNode,x,d.hitch(this,function(){c.publish("actionTriggered",{elementId:this.setting.id,action:"removeHighLight"})})));this.own(k(this.domNode,f,d.hitch(this,function(){c.publish("chooseWidget",
this,this.listName)})))},createGroupNode:function(){"poolWidgets"===this.listName?this._createPoolGroupNode():this._createOnScreenGroupNode()},_createOnScreenGroupNode:function(){l.addClass(this.domNode,"group-node");this.boxNode=l.create("div",{"class":"box",style:{width:this.w+"px",height:this.w+"px"}},this.domNode);if(0===this.setting.widgets.length)l.addClass(this.domNode,"placeholder"),this._createPlaceholderNode(),this.name=this.label=this.nls.defaultWidgetLabel;else if(1===this.setting.widgets.length){var a=
t.processUrlInAppConfig(this.setting.widgets[0].icon);this.iconNode=l.create("img",{"class":"icon",src:a,style:{width:"32px",height:"32px",margin:(this.w-32)/2+"px"}},this.boxNode);a=this.setting.widgets[0];this.label=a.label;this.name=a.name}else this._createSmallWidgets(),this.label=this.setting.label?this.setting.label:"Group",this.name=this.setting.name?this.setting.name:"Group";this.labelNode=l.create("div",{"class":"label",innerHTML:t.stripHTML(this.label),title:this.label},this.domNode);this.own(k(this.boxNode,
v,d.hitch(this,function(){c.publish("actionTriggered",{elementId:this.setting.id,action:"highLight"});if(0!==this.setting.widgets.length){if("undefined"===typeof this.setting.maxWidgets||this.setting.widgets.length<this.setting.maxWidgets)this.addNode=this._createAddNode(),this.own(k(this.addNode,f,d.hitch(this,function(a){c.publish("chooseWidget",this,this.listName);a.stopPropagation()}))),this.own(k(this.addNode,"mousedown",function(a){a.stopPropagation()})),this.own(k(this.addNode,"mouseup",function(a){a.stopPropagation()}));
1===this.setting.widgets.length&&(this.editNode=this._createEditNode(),this.own(k(this.editNode,f,d.hitch(this,function(a){a.stopPropagation();c.publish("editWidget",this.setting.widgets[0],this)}))),this.dropNode=this._createDropNode(),this.own(k(this.dropNode,f,d.hitch(this,function(a){var b=new n({message:this.nls.dropWidgetMessage,buttons:[{label:this.nls.ok,onClick:d.hitch(this,function(){this.setting.widgets=[];c.publish("groupChanged",this.setting);b.close()})},{label:this.nls.cancel}]});a.stopPropagation()}))))}})));
this.own(k(this.boxNode,x,d.hitch(this,function(){c.publish("actionTriggered",{elementId:this.setting.id,action:"removeHighLight"});this.addNode&&l.destroy(this.addNode);this.editNode&&l.destroy(this.editNode);this.dropNode&&l.destroy(this.dropNode)})));this.own(k(this.boxNode,f,d.hitch(this,function(){if(0===this.setting.widgets.length)c.publish("chooseWidget",this,this.listName);else if(1!==this.setting.maxWidgets||1!==this.setting.widgets.length)"open"===this.status?this.closeGroup():this.openGroup()})))},
_createPoolGroupNode:function(){l.addClass(this.domNode,"group-node");this.boxNode=l.create("div",{"class":"box",style:{width:this.w+"px",height:this.w+"px"}},this.domNode);this.label=this.setting.label?this.setting.label:"Group";this.name=this.setting.name?this.setting.name:"Group";this.labelNode=l.create("div",{"class":"label",innerHTML:t.stripHTML(this.setting.label),title:this.setting.label},this.domNode);this._createSmallWidgets();this.setting.openAtStart&&(this.openAtStartNode=this._createOpenAtStartNode(),
this.own(k(this.openAtStartNode,f,d.hitch(this,function(a){a.stopPropagation();this.emit("clickOpenAtStart")}))));this.own(k(this.boxNode,v,d.hitch(this,function(){c.publish("actionTriggered",{elementId:this.setting.id,action:"highLight"});this.editNode=this._createEditNode();this.own(k(this.editNode,f,d.hitch(this,function(a){a.stopPropagation();c.publish("editGroup",this,this.setting)})));this.own(k(this.editNode,"mousedown",function(a){a.stopPropagation()}));this.own(k(this.editNode,"mouseup",
function(a){a.stopPropagation()}));this.supportOpenAtStart()&&!this.setting.openAtStart&&(this.openAtStartNode=this._createOpenAtStartNode(),this.own(k(this.openAtStartNode,f,d.hitch(this,function(a){a.stopPropagation();this.emit("clickOpenAtStart")}))));this.dropNode=this._createDropNode();this.own(k(this.dropNode,f,d.hitch(this,function(a){var b=new n({message:this.nls.dropGroupMessage,buttons:[{label:this.nls.ok,onClick:d.hitch(this,function(){this.emit("removeNode");b.close()})},{label:this.nls.cancel}]});
a.stopPropagation()})));this.own(k(this.dropNode,"mousedown",function(a){a.stopPropagation()}));this.own(k(this.dropNode,"mouseup",function(a){a.stopPropagation()}))})));this.own(k(this.boxNode,x,d.hitch(this,function(){c.publish("actionTriggered",{elementId:this.setting.id,action:"removeHighLight"});this.editNode&&l.destroy(this.editNode);this.openAtStartNode&&!this.setting.openAtStart&&l.destroy(this.openAtStartNode);this.dropNode&&l.destroy(this.dropNode)})));this.own(k(this.boxNode,f,d.hitch(this,
function(a){a.preventDefault();a.stopPropagation();"open"===this.status?this.closeGroup():this.openGroup()})))},closeGroup:function(){this.status="close"},openGroup:function(){this.status="open"},createAddBtn:function(){l.addClass(this.domNode,"add-widget-node");var a=l.create("div",{"class":"box",style:{width:this.w+"px",height:this.w+"px"},title:this.nls.addWidget},this.domNode);l.create("img",{src:this.folderUrl+"css/images/add_widget.png"},a);this.own(k(this.domNode,f,d.hitch(this,function(){c.publish("chooseWidget",
this,this.listName)})))},createEmptyNode:function(){l.addClass(this.domNode,"empty-node");l.create("div",{"class":"box",style:{width:this.w+"px",height:this.w+"px"}},this.domNode)},_createEditNode:function(){var a={bottom:"0",width:"20px",height:"20px"};a[window.isRTL?"left":"right"]="0";return l.create("div",{"class":"edit-btn",style:a,title:this.nls.configureWidget},this.boxNode)},supportOpenAtStart:function(){var a=this.setting;return"group"===this.type?"poolWidgets"===this.listName?!0:!1:!a.isController&&
!a.isThemeWidget&&a.visible&&(a.isOnScreen&&(a.closeable||a.inPanel&&!this.gnode)||!a.isOnScreen&&!this.gnode)},_createOpenAtStartNode:function(){var a={bottom:"4px",width:"12px",height:"12px"};a[window.isRTL?"right":"left"]="4px";return l.create("div",{"class":this.setting.openAtStart?"open-at-start-btn active":"open-at-start-btn deactive",style:a,title:this.setting.openAtStart?this.nls.activeOpenAtStart:this.nls.deactiveOpenAtStart},this.boxNode)},_createDropNode:function(){var a={top:"0",width:"20px",
height:"20px"};a[window.isRTL?"left":"right"]="0";return l.create("div",{"class":"drop-btn",style:a,title:this.nls.removeWidget},this.boxNode)},_createAddNode:function(){var a={top:"0",width:"20px",height:"20px"};a[window.isRTL?"right":"left"]="0";return l.create("div",{"class":"small-add-btn",style:a,title:this.nls.addWidget},this.boxNode)},_createSwitchNode:function(){var a=l.hasClass(this.domNode,"hide")?this.nls.showWidget:this.nls.hideWidget,b={top:"3px",width:"15px",height:"10px"};b[window.isRTL?
"left":"right"]="3px";return l.create("div",{"class":"switch-btn",style:b,title:a},this.boxNode)},_createSmallWidgets:function(){b(".small",this.boxNode).remove();var a=[],c=!1;4<this.setting.widgets.length?(a=this.setting.widgets.slice(0,3),c=!0):(a=this.setting.widgets,c=!1);a.forEach(d.hitch(this,function(a){this._createSmallWidget(a)}));c&&this._createSmallMore()},_createSmallWidget:function(a){var b;b=l.create("div",{"class":"small small-widget","data-wid":a.id,style:{width:"20px",height:"20px",
marginLeft:(this.w-40)/3+"px",marginTop:(this.w-40)/3+"px"}},this.boxNode);var c=a.icon;if(a.icon.startWith("widgets")||a.icon.startWith("configs")||a.icon.startWith("themes"))c=require(t.getRequireConfig()).toUrl(a.icon);l.create("img",{src:c,style:{width:"20px",height:"20px"}},b);return b},_createSmallMore:function(){var a;a=l.create("div",{"class":"small small-more",style:{width:"20px",height:"20px",marginLeft:(this.w-40)/3+"px",marginTop:(this.w-40)/3+"px"}},this.boxNode);l.create("img",{src:"builder/images/more_widget.png",
style:{width:"20px"}},a);return a},addWidget:function(a){"group"!==this.type?console.log("can not add widget to widget"):(this.setting.widgets.push(a.setting),this._createSmallWidgets())},updateSmallWidgets:function(){this._createSmallWidgets()},destroy:function(){this.margin&&this.margin.destroy();this.inherited(arguments)},_checkDataSource:function(a){return this.appConfig.dataSource?q.some(Object.keys(this.appConfig.dataSource.dataSources),function(b){if(b.startWith("widget~"+a+"~")){var c=!1;
this.appConfig.visitElement(function(d){if(d.id!==a&&d.config&&"object"===typeof d.config&&-1<JSON.stringify(d.config).indexOf(b))return c=!0});return c}},this):!1}})})},"builder/plugins/widget-config/Mover":function(){define("dojo/_base/array dojo/_base/declare dojo/_base/lang dojo/sniff dojo/_base/window dojo/dom dojo/dom-geometry dojo/dom-style dojo/Evented dojo/on dojo/touch dojo/dnd/common dojo/dnd/autoscroll".split(" "),function(r,l,d,q,k,m,p,h,e,c,b,a,g){q.add("ie11",function(){var a=-1,b=
"",c=null;"Microsoft Internet Explorer"===navigator.appName?(b=navigator.userAgent,c=/MSIE ([0-9]{1,}[.0-9]{0,})/,null!==c.exec(b)&&(a=parseFloat(RegExp.$1))):"Netscape"===navigator.appName&&(b=navigator.userAgent,c=/Trident\/.*rv:([0-9]{1,}[.0-9]{0,})/,null!==c.exec(b)&&(a=parseFloat(RegExp.$1)));return a});return l("dojo.dnd.Mover",[e],{constructor:function(a,e,h){function f(a){a.preventDefault();a.stopPropagation()}this.node=m.byId(a);this.marginBox={l:e.pageX,t:e.pageY};this.mouseButton=e.button;
e=this.host=h;a=a.ownerDocument;this.events=[c(a,b.move,d.hitch(this,"onFirstMove")),c(a,b.move,d.hitch(this,"onMouseMove")),c(a,b.release,d.hitch(this,"onMouseUp")),c(a,"dragstart",f),c(a.body,"selectstart",f)];g.autoScrollStart(a);if(e&&e.onMoveStart)e.onMoveStart(this)},onMouseMove:function(a){g.autoScroll(a);var b=this.marginBox;this.host.onMove(this,{l:b.l+a.pageX,t:b.t+a.pageY},a);a.preventDefault();a.stopPropagation()},onMouseUp:function(a){var b=q("webkit")&&q("mac")&&2===this.mouseButton,
c=(q("ie")||q("ie11"))&&-1===this.mouseButton;(b||c?0===a.button:this.mouseButton===a.button)&&this.destroy();a.preventDefault();a.stopPropagation()},onFirstMove:function(a){var b=this.node.style,c,d=this.host;switch(b.position){case "relative":case "absolute":c=Math.round(parseFloat(b.left))||0;b=Math.round(parseFloat(b.top))||0;break;default:b.position="absolute";b=p.getMarginBox(this.node);c=k.doc.body;var e=h.getComputedStyle(c),g=p.getMarginBox(c,e),e=p.getContentBox(c,e);c=b.l-(e.l-g.l);b=b.t-
(e.t-g.t)}this.marginBox.l=c-this.marginBox.l;this.marginBox.t=b-this.marginBox.t;if(d&&d.onFirstMove)d.onFirstMove(this,a);this.events.shift().remove()},destroy:function(){r.forEach(this.events,function(a){a.remove()});var a=this.host;if(a&&a.onMoveStop)a.onMoveStop(this);this.events=this.node=this.host=null}})})},"builder/plugins/widget-config/LinkList":function(){define(["dojo/_base/declare","dojo/_base/html","dojo/_base/array"],function(r){return r(null,{headNode:null,currentNode:null,constructor:function(l){this.name=
l.name},visitNodes:function(l){for(var d=this.headNode,q=1;d;)l(d,q),q++,d=d.next},destroyAllNodes:function(){for(var l=this.headNode,d;l;)d=l.next,l.destroy(),l=null,l=d;this.headNode=null},getCount:function(){var l=0;this.visitNodes(function(d,q){l=q});return l},isExist:function(l){var d=!1;this.visitNodes(function(q){q===l&&(d=!0)});return d},printNodeList:function(){this.visitNodes(function(l){})},getPreNode:function(l){var d;this.visitNodes(function(q){q.next===l&&(d=q)});return d},getNodeByIndex:function(l){var d;
this.visitNodes(function(q,k){k===l&&(d=q)});return d},getNodeByLabel:function(l){var d;this.visitNodes(function(q){q.label===l&&(d=q)});return d},getNodeIndex:function(l){var d;this.visitNodes(function(q,k){q===l&&(d=k)});return d},removeNode:function(l){var d;(d=this.getPreNode(l))?d.next=l.next:this.headNode=l.next;l.destroy()},removeNodeByIndex:function(l){this.removeNode(this.getNodeByIndex(l))},insertNode:function(l,d){var q,k;q="number"===typeof d?this.getNodeByIndex(d):d;(k=this.getPreNode(q))?
k.next=l:this.headNode=l;l.next=q},moveNode:function(l,d){var q=this.getPreNode(l),k=this.getPreNode(d);l!==d&&l!==k&&(q?q.next=l.next:this.headNode=l.next,l.next=d,k?k.next=l:this.headNode=l)}})})},"builder/plugins/widget-config/WidgetSettingPage":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/html dojo/_base/array dojo/_base/config dojo/Deferred dojo/request dojo/topic dojo/aspect dojo/on dojo/mouse dojo/query dojo/string dojo/NodeList-dom dijit/_WidgetBase dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dojo/text!./WidgetSettingPage.html ./WidgetDefaultSettingPage jimu/utils jimu/WidgetManager jimu/portalUrlUtils jimu/portalUtils jimu/dijit/ViewStack jimu/dijit/ImageChooser jimu/dijit/LoadingIndicator jimu/dijit/Message dijit/form/CheckBox esri/request".split(" "),
function(r,l,d,q,k,m,p,h,e,c,b,a,g,u,n,t,f,v,x,w,z,A,y,B,C,E,D,F,G){var J="en de es fr ja ru zh-cn zh-tw zh-hk ar it ko pl pt-br pt-pt ro".split(" "),N=[],M=null;return r([n,t,f],{templateString:v,startup:function(){this.inherited(arguments);this.own(p("builder/widgethelp.json",{handleAs:"json"}).then(function(a){M=a},function(a){console.error(a)}).always(l.hitch(this,function(){this.domNode&&(this.own(c(window,"resize",l.hitch(this,this.resize))),this.init())})))},init:function(){this.loading=new E;
d.addClass(this.loading.domNode,"load-widget-setting");this.loading.placeAt(this.widgetSettingNode);this.initCommonAttr();this.initWidgetAttr();this.resize()},resize:function(){var a=d.getContentBox(this.domNode);d.setStyle(this.widgetSettingNode,{height:a.h-90+"px"})},onCancel:function(){this.onClose();this.popup.close()},onOk:function(){var a=this._checkLabelExist();if(a)return new D({message:a}),!1;this.imageChooser.imageData&&(this.setting.icon=this.imageChooser.imageData);this.setting.label=
w.stripHTML(this.labelNode.get("value"));if(this.settingDijit){var b=this.settingDijit.getConfig(!0);if(!1===b)return!1;b&&"function"===typeof b.then?b.then(l.hitch(this,function(a){if(!1===a)return!1;var b=this.settingDijit.getDataSources();b&&"function"===typeof b.then?b.then(l.hitch(this,function(b){this.setting.config=a;this.setting.provideDataSources=b;this._closeSettingPopup()})):(this.setting.config=a,this.setting.provideDataSources=b,this._closeSettingPopup())})):(a=this.settingDijit.getDataSources())&&
"function"===typeof a.then?a.then(l.hitch(this,function(a){this.setting.config=b;this.setting.provideDataSources=a;this._closeSettingPopup()})):(this.setting.config=b,this.setting.provideDataSources=a,this._closeSettingPopup())}else this._closeSettingPopup()},_closeSettingPopup:function(){delete this.setting.isDefaultConfig;h.publish("widgetSettingPageOk",this.setting,this.fromNode);this.onClose();this.popup.close()},_checkLabelExist:function(){var a=0,b=this.labelNode.get("value");if(""===g.trim(b))return this.nls.labelRequired;
var c=w.getControllerWidgets(this.appConfig);this.appConfig.visitElement(l.hitch(this,function(d){this.setting.id!==d.id&&d.label===b&&(0<c.length?a++:d.isOnScreen&&a++)}));return 0<a?this.nls.labelExists:""},onClose:function(){this.settingViewStack?(this.settingDijitUI.destroy(),this.settingDijitJSON.destroy(),this.settingViewStack.destroy()):this.settingDijit&&this.settingDijit.destroy()},_getHelpLink:function(a,b){var c=new m,d=null;a=a.toLowerCase();b="html"===(b||"html").toLowerCase()?"widgets2d":
"widgets3d";if(window.isXT)p("/webappbuilder/help/exists",{handleAs:"json"}).then(l.hitch(this,function(e){e&&e.exists?p("/webappbuilder/help/cxhelp.js",{handleAs:"json"}).then(l.hitch(this,function(e){var f="#";d=l.getObject("dev."+b+"."+a,!1,M);e&&e.m&&d&&e.m[d]?f="/webappbuilder/help/"+e.m[d]:d&&(f="/webappbuilder/help/"+d);c.resolve(f)}),l.hitch(this,function(a){console.warn(a);c.resolve("#")})):c.resolve("#")}),function(a){console.error(a);c.resolve("#")});else{var e=A.getPortalUrlFromLocation();
if(-1<e.indexOf("arcgis.com")){var f="#",d=l.getObject("online."+b+"."+a,!1,M);"widgets3d"===b||k.locale.toLowerCase().startWith("en")||-1<N.indexOf(a)||-1===J.indexOf(k.locale.toLowerCase())?(d&&(f="http://"+(-1<e.indexOf("maps.arcgis.com")?"doc":"docdev")+".arcgis.com/en/web-appbuilder/create-apps/"+d),c.resolve(f)):(f={url:A.getPortalSelfInfoUrl(e),content:{f:"json",culture:k.locale},handleAs:"json",callbackParamName:"callback",preventCache:!0},G(f).then(l.hitch(this,function(a){var b="#";if(a&&
a.helpBase&&d)try{b=a.helpBase.split("/").slice(0,4).join("/")+"/web-appbuilder/create-apps/"+d}catch(Y){b="http://doc.arcgis.com/en/web-appbuilder/create-apps/"+d}c.resolve(b)}),l.hitch(this,function(a){console.warn(a);c.resolve("#")})))}else{var g=k.locale||"en",d=l.getObject("portal."+b+"."+a,!1,M);p(e+"portalhelp/en/website/help/cxhelp.js",{handleAs:"json"}).then(l.hitch(this,function(a){var b="#";a&&a.m&&d&&a.m[d]&&(b=e+"portalhelp/"+g+"/website/help/"+a.m[d]);c.resolve(b)}),l.hitch(this,function(a){console.warn(a);
c.resolve("#")}))}}return c},initCommonAttr:function(){var a=w.processUrlInAppConfig(this.setting.icon);d.setAttr(this.iconNode,"src",a);this.labelNode.set("value",this.setting.label);this._getHelpLink(this.setting.name,l.getObject("manifest.platform",!1,this.setting)).then(l.hitch(this,function(a){"#"!==a&&(d.setStyle(this.helpNode,"display","inline-block"),d.setAttr(this.helpNode,"href",a))}));this.imageChooser=new C({goldenWidth:24,goldenHeight:24,format:[C.GIF,C.JPEG,C.PNG],label:this.nls.changeIcon},
this.imageChooserPlaceholder);d.addClass(this.imageChooser.domNode,"jimu-float-leading");!1===this.setting.inPanel&&!0===this.setting.isOnScreen&&!0!==this.setting.closeable?(this.imageChooser.disableChooseImage(),d.setAttr(this.imageChooser.domNode,"title",this.nls.unableChangeIcon)):(this.imageChooser.enableChooseImage(),this.own(c(this.imageChooser,"imageChange",l.hitch(this,function(a){this.iconNode.src=a;this.setting.icon=a}))))},initWidgetAttr:function(){!1===this.setting.hasConfig?this.widgetSettingNode.innerHTML=
'\x3cdiv class\x3d"noconfig-info"\x3e'+this.nls.noConfig+"\x3c/div\x3e":z.getInstance().tryLoadWidgetConfig(this.setting).then(l.hitch(this,function(a){this.setting.hasSettingPage?z.getInstance().loadWidgetSettingPage(this.setting).then(l.hitch(this,function(a){this.widgetSettingNode?(this.settingDijit=a,d.place(this.settingDijit.domNode,this.widgetSettingNode),this.settingDijit.startup(),this.loading.destroy(),d.setAttr(this.widgetSettingNode,"data-widget-loaded","true")):a.destroy()})):this.widgetSettingNode&&
(this.settingDijit=new x({config:this.setting.config}),d.place(this.settingDijit.domNode,this.widgetSettingNode),this.settingDijit.startup(),this.loading.destroy())}))},setAppConfig:function(a){this.appConfig=a}})})},"builder/plugins/widget-config/WidgetDefaultSettingPage":function(){define("dojo/_base/declare dojo/_base/lang dojo/on dojo/keys dijit/_WidgetBase ./JSONEditor".split(" "),function(r,l,d,q,k,m){return r([k],{baseClass:"widget-default-setting",postCreate:function(){this.inherited(arguments);
this.jsonEditor=new m({json:this.config});this.jsonEditor.placeAt(this.domNode);this.own(d(this.domNode,"keydown",l.hitch(this,"_onEnterPress")))},_onEnterPress:function(d){(void 0!==d.keyCode?d.keyCode:d.which)===q.ENTER&&d.stopPropagation()},getDataSources:function(){return[]},setConfig:function(d){return this.jsonEditor.setJSON(d)},getConfig:function(){return this.jsonEditor.getJSON()}})})},"builder/plugins/widget-config/JSONEditor":function(){define(["dojo/_base/declare","dijit/_WidgetBase"],
function(r,l){return r([l],{baseClass:"json-editor",postCreate:function(){this.inherited(arguments);this.editor=ace.edit(this.domNode);this.editor.setTheme("ace/theme/textmate");this.editor.setHighlightActiveLine(!0);this.editor.setValue(JSON.stringify(this.json,null,2));this.editor.getSession().setMode("ace/mode/json")},setJSON:function(d){this.json=d;this.editor.setValue(JSON.stringify(this.json,null,2))},getJSON:function(){return JSON.parse(this.editor.getValue())}})})},"builder/plugins/widget-config/GroupSettingPage":function(){define("dojo/_base/declare dojo/dom-attr dojo/topic dijit/_WidgetBase dijit/_TemplatedMixin dojo/text!./GroupSettingPage.html".split(" "),
function(r,l,d,q,k,m){return r([q,k],{templateString:m,baseClass:"group-setting-page",startup:function(){this.labelNode.value=this.setting.label},onOk:function(){this.setting.label=l.get(this.labelNode,"value");d.publish("groupChanged",this.setting);this.popup.close()},onCancel:function(){}})})},"builder/plugins/widget-config/WidgetChoosePage":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/html dojo/_base/array dojo/topic dojo/on dojo/Deferred dojo/promise/all dojo/query dojo/NodeList-dom dijit/_WidgetBase dijit/_TemplatedMixin dojo/text!./WidgetChoosePage.html jimu/dijit/Search jimu/WidgetManager jimu/dijit/LoadingShelter jimu/dijit/Message jimu/dijit/TabContainer3 jimu/utils jimu/portalUtils jimu/portalUrlUtils builder/serviceUtils esri/lang ./CustomWidgets".split(" "),
function(r,l,d,q,k,m,p,h,e,c,b,a,g,u,n,t,f,v,x,w,z,A,y,B){return r([b,a],{templateString:g,showCustomWidgets:!1,postMixInProperties:function(){this.widgetManager=n.getInstance()},startup:function(){this.inherited(arguments);this.showCustomWidgets||d.addClass(this.domNode,"hide-custom-widgets");this.tab=new v({tabs:[{title:this.nls.officialWidgets,content:this.officialSection},{title:this.nls.customWidgets,content:this.customSection}]});this.tab.placeAt(this.domNode);this.searchDijit1=new u({placeholder:this.nls.widgetSearchHint,
onSearch:l.hitch(this,this._onFilterDefaultWidget),searchWhenInput:!0},this.searchInputNode);this._getWidgets();this.own(m(window,"resize",l.hitch(this,this.resize)));setTimeout(l.hitch(this,function(){this.resize()}),100);this.loading=new t({hidden:!0});this.loading.placeAt(this.domNode);this.loading.startup();this.showCustomWidgets&&(this.searchDijit2=new u({placeholder:this.nls.widgetSearchHint,onChange:l.hitch(this,this._onFilterCustomWidget),onSearch:l.hitch(this,this._onSearchCustomWidget),
searchWhenInput:!1},this.customSearchInputNode),this.allCustomWidgets=new B({portalUrl:window.portalUrl,fromNode:this.fromNode}),this.allCustomWidgets.placeAt(this.customSection),this.filterCustomWidgets=new B({portalUrl:window.portalUrl,hidden:!0,fromNode:this.fromNode}),this.filterCustomWidgets.placeAt(this.customSection),this.own(m(this.tab,"tabChanged",l.hitch(this,function(a){a!==this.nls.customWidgets||this.allCustomWidgets.queried||(this.allCustomWidgets.queried=!0,this.allCustomWidgets.queryItems())}))))},
_onFilterCustomWidget:function(a){this.allCustomWidgets.show();this.filterCustomWidgets.hide();a?this.allCustomWidgets.filterLocally(function(b){return b.title&&0<=b.title.toUpperCase().indexOf(a.toUpperCase())}):this.allCustomWidgets.filterLocally(function(){return!0})},_onSearchCustomWidget:function(a){a?(this.allCustomWidgets.hide(),this.filterCustomWidgets.show(),this.filterCustomWidgets.queryItems({q:'title:"'+a+'"'})):(this.allCustomWidgets.show(),this.filterCustomWidgets.hide())},_onFilterDefaultWidget:function(a){var b;
b=""===a?this.allWidgets:q.filter(this.allWidgets,function(b){if(-1<b.label.toUpperCase().indexOf(a.toUpperCase()))return!0});this._createWidgetNodes(b)},resize:function(){var a=d.getContentBox(this.domNode).h,b=a-60;d.setStyle(this.searchSectionNode,{height:a+"px"});d.setStyle(this.widgetListNode,{height:b+"px"})},setAppConfig:function(a){this.appConfig=a},_getWidgets:function(){var a={};this.appConfig.map["2D"]&&(a.support2D=!0);this.appConfig.map["3D"]&&(a.support3D=!0);this.appConfig.map["2D"]&&
this.appConfig.map["3D"]&&(a.support2D=!0,a.support3D=!0);a.platform=window.stemappInfo.appType;this.options.includeOffPanel||(a["properties.inPanel"]=!0);A.searchWidgets(a).then(l.hitch(this,function(a){a.success?(this.allWidgets=this._filterSingletonWidgets(a.widgets),this._createWidgetNodes(this.allWidgets)):console.log(a.message)}))},_filterSingletonWidgets:function(a){return q.filter(a,function(a){return!1===a.properties.supportMultiInstance&&this._checkWidgetIsInAppConfig(this.appConfig,a.name)?
!1:!0},this)},_checkWidgetIsInAppConfig:function(a,b){var c=[];0===x.getControllerWidgets(a).length?a.visitElement(l.hitch(this,function(a){a.isOnScreen&&a.name===b&&c.push(a)})):c=a.getConfigElementsByName(b);return 0<c.length},_createWidgetNodes:function(a){d.empty(this.widgetListNode);q.forEach(a,function(a){this._createWidgetNode(a)},this)},_createWidgetNode:function(a){var b,c;b=d.create("div",{"class":"widget-node","data-widget-name":a.name},this.widgetListNode);c=d.create("div",{"class":"box"},
b);d.create("div",{"class":"box-selected"},b);d.create("img",{"class":"icon",src:a.icon},c);d.create("div",{"class":"label",innerHTML:x.stripHTML(a.label),title:a.label},b);b.setting={name:a.name,label:a.label,version:a.version,closeable:"removeableWidgetOnScreen"===this.fromList?!0:void 0};x.widgetJson.addManifest2WidgetJson(b.setting,a);b.setting.uri=a.amdFolder+"Widget";b.box=c;this.own(m(b,"click",l.hitch(this,this._onWidgetClick,b)));return b},_onWidgetClick:function(a){this._isMultipleSelection()?
d.hasClass(a,"jimu-state-selected")?d.removeClass(a,"jimu-state-selected"):d.addClass(a,"jimu-state-selected"):(e(".jimu-state-selected",this.domNode).removeClass("jimu-state-selected"),d.addClass(a,"jimu-state-selected"))},_isMultipleSelection:function(){var a=this.fromNode;return"addBtn"===a.type&&"poolWidgets"===this.fromList||"addBtn"===a.type&&"groupOnScreen"===this.fromList&&this._canAddMoreWidgetsInGroup(a.gnode)||"group"===a.type&&this._canAddMoreWidgetsInGroup(a)},_canAddMoreWidgetsInGroup:function(a){return a?
"undefined"===typeof a.setting.maxWidgets||a.setting.maxWidgets>a.setting.widgets.length+1:!1},onOk:function(){(0===this.tab.getSelectedIndex()?this._getOfficialSelection():this._getCustomSelection()).then(l.hitch(this,function(a){var b=[];"group"===this.fromNode.type&&"undefined"!==typeof this.fromNode.setting.maxWidgets&&this.fromNode.setting.widgets.length+a.length>this.fromNode.setting.maxWidgets?(new f({message:y.substitute({maxCount:this.fromNode.setting.maxWidgets},this.nls.addWidgetExceedMax)}),
this.loading.hide()):(q.forEach(a,function(a){b.push(this._copyWidget(a))},this),h(b).then(l.hitch(this,function(b){var c;for(c=0;c<b.length;c++)if(!b[c].success){new f({message:b[c].message});this.loading.hide();return}this.loading.hide();k.publish("widgetChoosePageOk",a,this.fromNode);this.popup.close()})))}),function(a){console.error(a.stack)})},_getOfficialSelection:function(){var a=new p,b=e(".jimu-state-selected",this.domNode);if(0===b.length)return new f({message:this.nls.emptyMessage}),a.reject({message:this.nls.emptyMessage}),
a;this.loading.show();b=q.map(b,function(a){return l.clone(a.setting)});a.resolve(b);return a},_getCustomSelection:function(){var a=[],a=this.allCustomWidgets.isVisible()?this.allCustomWidgets.getSelectedWidgetItems():this.filterCustomWidgets.getSelectedWidgetItems();return h(a.map(function(a){return A.getManifestFromItem(a).then(function(b){var c={name:b.name,label:a.title,version:b.version};x.widgetJson.addManifest2WidgetJson(c,b);c.uri=x.widgetJson.getUriFromItem(a);c.itemId=a.id;return c})}))},
_copyWidget:function(a){var b=0,c,d=[],e=x.getControllerWidgets(this.appConfig);this.appConfig.visitElement(l.hitch(this,function(c){if(0!==e.length||c.isOnScreen)c.name===a.name&&b++,d.push(c.label)}));a.icon=a.manifest.folderUrl+"images/icon.png?wab_dv\x3d"+window.deployVersion;if(0===b)a.label=a.label,c=A.copyWidgetToApp(window.appInfo.id,a);else if(0<b){c=new p;for(var f=a.label+"_"+(b+1);-1<d.indexOf(f);)b++,f=a.label+"_"+(b+1);a.label=f;c.resolve({success:!0})}return c}})})},"builder/plugins/widget-config/CustomWidgets":function(){define("dojo/_base/declare dijit/_WidgetBase dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dojo/text!./CustomWidgets.html dojo/Evented dojo/query dojo/_base/lang dojo/_base/array dojo/_base/html jimu/utils jimu/portalUtils jimu/portalUrlUtils jimu/dijit/LoadingIndicator".split(" "),
function(r,l,d,q,k,m,p,h,e,c,b,a,g){return r([l,d,q,m],{templateString:k,baseClass:"custom-widgets",query:null,nls:null,type:"App Builder Extension",portalUrl:null,hidden:!1,postMixInProperties:function(){this.nls=window.jimuNls.itemSelector},postCreate:function(){this.inherited(arguments);this.portalUrl=g.getStandardPortalUrl(this.portalUrl);this.portal=a.getPortal(this.portalUrl);this.baseQ='type:"'+this.type+'" AND typekeywords:"Widget,'+window.appInfo.appType+'"';"HTML"===window.appInfo.appType.toUpperCase()&&
(this.baseQ+=' -typekeywords:"HTML3D"');this.hidden&&this.hide()},filterLocally:function(a){p(".widget-node",this.domNode).forEach(h.hitch(this,function(b){a(b.item)?c.removeClass(b,"hidden"):c.addClass(b,"hidden")}))},queryItems:function(a){a=a||{};this.loading.show();this.clear();h.mixin(this.query,a);this.query.start=1;this.query.q=a.q?this.baseQ+" AND "+a.q:this.baseQ;return this.portal.queryItems(this.query).then(h.hitch(this,function(a){if(this.domNode)return this.domNode&&this.loading.hide(),
this.query.start=a.nextStart,this._createItemsNode(a)}),h.hitch(this,function(a){console.error(a);this.domNode&&this.loading.hide()}))},_createItemsNode:function(a){a=a.results;var b=this.type.toLowerCase();a=e.filter(a,h.hitch(this,function(a){return(a.type&&a.type.toLowerCase()||"")===b}));e.forEach(a,h.hitch(this,function(a){this._createItemNode(a)}));return a},_createItemNode:function(a){var d=c.toDom('\x3cdiv class\x3d"widget-node"\x3e\x3cdiv class\x3d"box"\x3e\x3cimg class\x3d"icon"\x3e\x3ca target\x3d"_blank" class\x3d"detail-icon"\x3e\x3c/a\x3e\x3c/div\x3e\x3cdiv class\x3d"box-selected"\x3e\x3c/div\x3e\x3cdiv class\x3d"label"\x3e\x3c/div\x3e\x3c/div\x3e');
d.item=a;p("img",d)[0].src=b.widgetJson.getFolderUrlFromItem(a)+"images/icon.png";var e=p(".label",d)[0];e.innerHTML=a.title||"";e.title=a.title||"";e=p(".detail-icon",d)[0];e.href=a.detailsPageUrl;e.title=this.nls.viewItemDetails||"View item details";c.place(d,this.list)},clear:function(){this.query={q:this.baseQ,sortField:"title",sortOrder:"asc",num:100,start:1};c.empty(this.list)},_onClick:function(a){a=a.target||a.srcElement;var d=null;if(d=c.hasClass(a,"widget-node")?a:b.getAncestorDom(a,function(a){return c.hasClass(a,
"widget-node")},this.list))"addBtn"===this.fromNode.type?c.toggleClass(d,"jimu-state-selected"):(p(".jimu-state-selected",this.domNode).removeClass("jimu-state-selected"),c.addClass(d,"jimu-state-selected"))},_onScroll:function(){this._isScrollToBottom(this.domNode)},_isScrollToBottom:function(a){return b.isScrollToBottom(a)},getSelectedWidgetItems:function(){var a=p(".widget-node.jimu-state-selected",this.domNode).filter(h.hitch(this,function(a){return!c.hasClass(a,"hidden")}));return e.map(a,h.hitch(this,
function(a){return a.item}))},isVisible:function(){return!c.hasClass(this.domNode,"hidden")},show:function(){c.removeClass(this.domNode,"hidden")},hide:function(){c.addClass(this.domNode,"hidden")}})})},"jimu/PoolControllerMixin":function(){define(["dojo/_base/declare","dojo/_base/array","jimu/PanelManager"],function(r,l,d){return r(null,{constructor:function(){this.panelManager=d.getInstance()},postCreate:function(){this.controlledWidgets||(this.controlledWidgets="all");this.controlledGroups||(this.controlledGroups=
"all")},getOpenedIds:function(){},setOpenedIds:function(d){},getConfigById:function(d){for(var k=this.getAllConfigs(),l=0;l<k.length;l++)if(k[l].id===d)return k[l]},getAllConfigs:function(){var d=[],d=d.concat(this.getWidgetConfigs(),this.getGroupConfigs()),d=l.filter(d,function(d){return d.visible});return d.sort(function(d,l){return d.index-l.index})},getAllConfigsIncludeInvisible:function(){var d=[],d=d.concat(this.getWidgetConfigs(),this.getGroupConfigs());return d.sort(function(d,l){return d.index-
l.index})},isControlled:function(d){return l.some(this.getAllConfigsIncludeInvisible(),function(k){return k.id===d})},widgetIsControlled:function(d){return l.some(this.getAllConfigsIncludeInvisible(),function(k){return k.id===d?!0:l.some(k.widgets,function(k){return k.id===d})})},getGroupConfigs:function(){var d=[];if(!this.appConfig.widgetPool)return d;this.appConfig.widgetPool.groups&&l.forEach(this.appConfig.widgetPool.groups,function(k){this.controlledGroups&&(Array.isArray(this.controlledGroups)?
-1<this.controlledGroups.indexOf(k.id)&&d.push(k):"all"===this.controlledGroups&&d.push(k))},this);return d},getWidgetConfigs:function(){var d=[];if(!this.appConfig.widgetPool)return d;this.appConfig.widgetPool.widgets&&l.forEach(this.appConfig.widgetPool.widgets,function(k){this.controlledWidgets&&(Array.isArray(this.controlledWidgets)?-1<this.controlledWidgets.indexOf(k.id)&&d.push(k):"all"===this.controlledWidgets&&d.push(k))},this);return d}})})},"jimu/PanelManager":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/html dojo/_base/fx dojo/Deferred dojo/promise/all dojo/on dojo/topic dojo/when require ./utils ./WidgetManager".split(" "),
function(r,l,d,q,k,m,p,h,e,c,b,a,g){var u,n=null;u=r(null,{constructor:function(){this.panels=[];this.widgetManager=g.getInstance();h(window,"resize",l.hitch(this,this.onWindowResize));this.activePanel=null;e.subscribe("/dnd/move/start",l.hitch(this,this._onMoveStart));e.subscribe("widgetActived",l.hitch(this,this._onWidgetActived))},showPanel:function(b){var c=new m,d=this.getPanelById(b.id+"_panel");d?("closed"===d.state&&this.openPanel(d),c.resolve(d)):p({Panel:this._loadPanelClass(b.panel.uri),
nls:this._loadThemeI18N(b.panel.uri)}).then(l.hitch(this,function(d){var e=b.id+"_panel",f=this.getPanelById(e),g={label:b.label,config:b,uri:b.panel.uri,position:b.panel.position,map:this.map,widgetManager:this.widgetManager,panelManager:this,id:e,gid:b.gid,nls:d.nls};l.mixin(g,b.panel.options);try{f=new d.Panel(g),console.log("panel ["+e+"] created.")}catch(y){console.log("create panel error: "+y+", panelId: "+e);c.reject(y);return}f.setPosition(b.panel.position);a.setVerticalCenter(f.domNode);
this.openPanel(f);h(f.domNode,"click",l.hitch(this,this._onPanelClick,f));c.resolve(f)}));return c},setMap:function(a){this.map=a;h(this.map,"resize",l.hitch(this,this.onMapResize))},closeOtherPanelsInTheSameGroup:function(a){if("string"===typeof a&&(a=this.getPanelById(a),!a))return;for(var b=0;b<this.panels.length;b++)this.panels[b].gid===a.gid&&this.panels[b].id!==a.id&&this.closePanel(this.panels[b])},closeAllPanelsInGroup:function(a){for(var b=0;b<this.panels.length;b++)this.panels[b].gid===
a&&this.closePanel(this.panels[b])},openPanel:function(a){var b=new m;if("string"===typeof a){if(a=this.getPanelById(a),!a)return b.reject(),b}else this.panels.some(function(b){return b.id===a.id})||this.panels.push(a);if(!a.started)try{a.started=!0,a.startup()}catch(v){console.error("fail to startup panel "+a.id+". "+v.stack)}if("opened"===a.state)return b.resolve(a),b;a.setState("opened");return this.playOpenPanelAnimation(a).then(l.hitch(this,function(){q.setStyle(a.domNode,"display","");a.onOpen();
this._activePanel(a);return a}))},closePanel:function(a){var b=new m;return"string"===typeof a&&(a=this.getPanelById(a),!a)||"closed"===a.state?(b.resolve(),b):this.playClosePanelAnimation(a).then(l.hitch(this,function(){this.activePanel&&this.activePanel.id===a.id&&(this.activePanel.onDeActive(),this.activePanel=null);a.setState("closed");a.onClose();a.domNode&&q.setStyle(a.domNode,"display","none")}))},minimizePanel:function(a){if("string"===typeof a&&(a=this.getPanelById(a),!a))return;"closed"===
a.state&&this.openPanel(a);a.setWindowState("minimized");try{a.onMinimize()}catch(f){console.log(console.error("fail to minimize panel "+a.id+". "+f.stack))}},maximizePanel:function(a){if("string"===typeof a&&(a=this.getPanelById(a),!a))return;"closed"===a.state&&this.openPanel(a);a.setWindowState("maximized");try{a.onMaximize()}catch(f){console.log(console.error("fail to maximize panel "+a.id+". "+f.stack))}},normalizePanel:function(a){if("string"===typeof a&&(a=this.getPanelById(a),!a))return;"closed"===
a.state&&this.openPanel(a);a.setWindowState("normal");try{a.onNormalize()}catch(f){console.log(console.error("fail to noralize panel "+a.id+". "+f.stack))}},changeWindowStateTo:function(a,b){if("string"===typeof a&&(a=this.getPanelById(a),!a))return;"normal"===b?this.normalizePanel(a):"minimized"===b?this.minimizePanel(a):"maximized"===b?this.maximizePanel(a):console.log("error state: "+b)},getPanelById:function(a){for(var b=0;b<this.panels.length;b++)if(this.panels[b].id===a)return this.panels[b]},
onWindowResize:function(){for(var a=0;a<this.panels.length;a++)"closed"!==this.panels[a].state&&"map"!==this.panels[a].position.relativeTo&&this.panels[a].resize()},onMapResize:function(){for(var a=0;a<this.panels.length;a++)"closed"!==this.panels[a].state&&"map"===this.panels[a].position.relativeTo&&this.panels[a].resize()},destroyPanel:function(a){if("string"===typeof a&&(a=this.getPanelById(a),!a))return;if(a.domNode){"closed"!==a.state&&this.closePanel(a);this._removePanel(a);try{a.destroy()}catch(f){console.log(console.error("fail to destroy panel "+
a.id+". "+f.stack))}}},destroyAllPanels:function(){var a=d.map(this.panels,function(a){return a.id});d.forEach(a,function(a){this.destroyPanel(a)},this);this.panels=[]},playOpenPanelAnimation:function(a){if("string"===typeof a&&(a=this.getPanelById(a),!a)||!a.openAnimation||0===a.animationDuration)return c();var b=new m;"string"===typeof a.openAnimation?"fadeIn"===a.openAnimation?(q.setStyle(a.domNode,{opacity:0,display:""}),k.fadeIn({node:a.domNode,duration:a.animationDuration,onEnd:function(){b.resolve()}}).play()):
b.resolve():b.resolve();return b},playClosePanelAnimation:function(a){if("string"===typeof a&&(a=this.getPanelById(a),!a)||!a.closeAnimation||0===a.animationDuration)return c();var b=new m;"string"===typeof a.closeAnimation&&("fadeOut"===a.closeAnimation?k.fadeOut({node:a.domNode,duration:a.animationDuration,onEnd:function(){b.resolve()}}).play():b.resolve());return b},getPositionOnMobile:function(a){if("string"===typeof a&&(a=this.getPanelById(a),!a))return{};var b=q.getMarginBox(window.jimuConfig.layoutId),
c=b.h/2;a.titleHeight||(a.titleHeight=35);return"maximized"===a.windowState?{left:0,right:0,top:0,bottom:0,width:"auto",height:"auto",contentHeight:b.h-a.titleHeight,borderRadiusStyle:{borderTopLeftRadius:0,borderTopRightRadius:0,borderBottomLeftRadius:0,borderBottomRightRadius:0}}:"minimized"===a.windowState?b.h>b.w?{left:0,right:0,top:"auto",bottom:0,width:"auto",height:a.titleHeight,contentHeight:0,borderRadiusStyle:{borderTopLeftRadius:"4px",borderTopRightRadius:"4px",borderBottomLeftRadius:0,
borderBottomRightRadius:0}}:{left:b.w-b.w/2,right:0,top:"auto",bottom:0,width:b.w/2,height:a.titleHeight,contentHeight:b.h,borderRadiusStyle:window.isRTL?{borderTopLeftRadius:0,borderTopRightRadius:"4px",borderBottomLeftRadius:0,borderBottomRightRadius:"4px"}:{borderTopLeftRadius:"4px",borderTopRightRadius:0,borderBottomLeftRadius:"4px",borderBottomRightRadius:0}}:b.h>b.w?{left:0,right:0,top:c,bottom:0,width:"auto",height:"auto",contentHeight:b.h-c-a.titleHeight,borderRadiusStyle:{borderTopLeftRadius:"4px",
borderTopRightRadius:"4px",borderBottomLeftRadius:0,borderBottomRightRadius:0}}:{left:b.w-b.w/2,right:0,top:0,bottom:0,width:b.w/2,height:"auto",contentHeight:b.h-c-a.titleHeight,borderRadiusStyle:window.isRTL?{borderTopLeftRadius:0,borderTopRightRadius:"4px",borderBottomLeftRadius:0,borderBottomRightRadius:"4px"}:{borderTopLeftRadius:"4px",borderTopRightRadius:0,borderBottomLeftRadius:"4px",borderBottomRightRadius:0}}},_onPanelClick:function(a){this._activePanel(a)},activatePanel:function(a){"opened"===
a.state&&this._activePanel(a)},_activePanel:function(a){if(this.activePanel){if(this.activePanel.id===a.id){this.activePanel.moveTopOnActive&&q.setStyle(this.activePanel.domNode,"zIndex",101);return}"active"===this.activePanel.state&&(this.activePanel.setState("opened"),q.setStyle(this.activePanel.domNode,"zIndex","undefined"!==typeof this.activePanel.position.zIndex?this.activePanel.position.zIndex:"auto"),this.activePanel.onDeActive())}var b=this.widgetManager.activeWidget;b&&"active"===b.state&&
b.getPanel()!==a&&(b.setState("opened"),!1===b.inPanel&&q.setStyle(b.domNode,"zIndex","undefined"!==typeof b.position.zIndex?b.position.zIndex:"auto"),b.onDeActive(),this.widgetManager.activeWidget=null);this.activePanel=a;"active"!==this.activePanel.state&&(this.activePanel.setState("active"),this.activePanel.moveTopOnActive&&q.setStyle(this.activePanel.domNode,"zIndex",101),this.activePanel.onActive())},_removePanel:function(a){var b=this.panels.indexOf(a);-1<b&&this.panels.splice(b,1);this.activePanel&&
this.activePanel.id===a.id&&(this.activePanel=null)},_onMoveStart:function(a){d.forEach(this.panels,function(b){b.domNode===a.node&&this._activePanel(b)},this)},_onWidgetActived:function(a){this.activePanel&&"active"===this.activePanel.state&&a.getPanel()!==this.activePanel&&(this.activePanel.setState("opened"),q.setStyle(this.activePanel.domNode,"zIndex","undefined"!==typeof this.activePanel.position.zIndex?this.activePanel.position.zIndex:"auto"),this.activePanel.onDeActive(),this.activePanel=null)},
_loadPanelClass:function(a){var c=new m;b([a],function(a){c.resolve(a)});return c},_loadThemeI18N:function(a){var c=new m;a.startWith("themes")?(a=a.split("/"),b(["dojo/i18n!"+(a[0]+"/"+a[1]+"/nls/strings")],function(a){c.resolve(a)})):c.resolve({});return c}});u.getInstance=function(){null===n&&(n=new u,window._panelManager=n);return n};return u})},"url:dijit/templates/Dialog.html":'\x3cdiv class\x3d"dijitDialog" role\x3d"dialog" aria-labelledby\x3d"${id}_title"\x3e\r\n\t\x3cdiv data-dojo-attach-point\x3d"titleBar" class\x3d"dijitDialogTitleBar"\x3e\r\n\t\t\x3cspan data-dojo-attach-point\x3d"titleNode" class\x3d"dijitDialogTitle" id\x3d"${id}_title"\r\n\t\t\t\trole\x3d"heading" level\x3d"1"\x3e\x3c/span\x3e\r\n\t\t\x3cspan data-dojo-attach-point\x3d"closeButtonNode" class\x3d"dijitDialogCloseIcon" data-dojo-attach-event\x3d"ondijitclick: onCancel" title\x3d"${buttonCancel}" role\x3d"button" tabindex\x3d"-1"\x3e\r\n\t\t\t\x3cspan data-dojo-attach-point\x3d"closeText" class\x3d"closeText" title\x3d"${buttonCancel}"\x3ex\x3c/span\x3e\r\n\t\t\x3c/span\x3e\r\n\t\x3c/div\x3e\r\n\t\x3cdiv data-dojo-attach-point\x3d"containerNode" class\x3d"dijitDialogPaneContent"\x3e\x3c/div\x3e\r\n\t${!actionBarTemplate}\r\n\x3c/div\x3e\r\n\r\n',
"url:dijit/form/templates/Button.html":'\x3cspan class\x3d"dijit dijitReset dijitInline" role\x3d"presentation"\r\n\t\x3e\x3cspan class\x3d"dijitReset dijitInline dijitButtonNode"\r\n\t\tdata-dojo-attach-event\x3d"ondijitclick:__onClick" role\x3d"presentation"\r\n\t\t\x3e\x3cspan class\x3d"dijitReset dijitStretch dijitButtonContents"\r\n\t\t\tdata-dojo-attach-point\x3d"titleNode,focusNode"\r\n\t\t\trole\x3d"button" aria-labelledby\x3d"${id}_label"\r\n\t\t\t\x3e\x3cspan class\x3d"dijitReset dijitInline dijitIcon" data-dojo-attach-point\x3d"iconNode"\x3e\x3c/span\r\n\t\t\t\x3e\x3cspan class\x3d"dijitReset dijitToggleButtonIconChar"\x3e\x26#x25CF;\x3c/span\r\n\t\t\t\x3e\x3cspan class\x3d"dijitReset dijitInline dijitButtonText"\r\n\t\t\t\tid\x3d"${id}_label"\r\n\t\t\t\tdata-dojo-attach-point\x3d"containerNode"\r\n\t\t\t\x3e\x3c/span\r\n\t\t\x3e\x3c/span\r\n\t\x3e\x3c/span\r\n\t\x3e\x3cinput ${!nameAttrSetting} type\x3d"${type}" value\x3d"${value}" class\x3d"dijitOffScreen"\r\n\t\tdata-dojo-attach-event\x3d"onclick:_onClick"\r\n\t\ttabIndex\x3d"-1" aria-hidden\x3d"true" data-dojo-attach-point\x3d"valueNode"\r\n/\x3e\x3c/span\x3e\r\n',
"url:dijit/form/templates/TextBox.html":'\x3cdiv class\x3d"dijit dijitReset dijitInline dijitLeft" id\x3d"widget_${id}" role\x3d"presentation"\r\n\t\x3e\x3cdiv class\x3d"dijitReset dijitInputField dijitInputContainer"\r\n\t\t\x3e\x3cinput class\x3d"dijitReset dijitInputInner" data-dojo-attach-point\x3d\'textbox,focusNode\' autocomplete\x3d"off"\r\n\t\t\t${!nameAttrSetting} type\x3d\'${type}\'\r\n\t/\x3e\x3c/div\r\n\x3e\x3c/div\x3e\r\n',"url:dijit/templates/Tooltip.html":'\x3cdiv class\x3d"dijitTooltip dijitTooltipLeft" id\x3d"dojoTooltip" data-dojo-attach-event\x3d"mouseenter:onMouseEnter,mouseleave:onMouseLeave"\r\n\t\x3e\x3cdiv class\x3d"dijitTooltipConnector" data-dojo-attach-point\x3d"connectorNode"\x3e\x3c/div\r\n\t\x3e\x3cdiv class\x3d"dijitTooltipContainer dijitTooltipContents" data-dojo-attach-point\x3d"containerNode" role\x3d\'alert\'\x3e\x3c/div\r\n\x3e\x3c/div\x3e\r\n',
"url:dijit/form/templates/ValidationTextBox.html":'\x3cdiv class\x3d"dijit dijitReset dijitInline dijitLeft"\r\n\tid\x3d"widget_${id}" role\x3d"presentation"\r\n\t\x3e\x3cdiv class\x3d\'dijitReset dijitValidationContainer\'\r\n\t\t\x3e\x3cinput class\x3d"dijitReset dijitInputField dijitValidationIcon dijitValidationInner" value\x3d"\x26#935; " type\x3d"text" tabIndex\x3d"-1" readonly\x3d"readonly" role\x3d"presentation"\r\n\t/\x3e\x3c/div\r\n\t\x3e\x3cdiv class\x3d"dijitReset dijitInputField dijitInputContainer"\r\n\t\t\x3e\x3cinput class\x3d"dijitReset dijitInputInner" data-dojo-attach-point\x3d\'textbox,focusNode\' autocomplete\x3d"off"\r\n\t\t\t${!nameAttrSetting} type\x3d\'${type}\'\r\n\t/\x3e\x3c/div\r\n\x3e\x3c/div\x3e\r\n',
"url:builder/plugins/plugins.json":'{\n  "app-actions.launch-app": {\n    "name": "app-actions.launch-app",\n    "type": "plugin",\n    "version": "2.0.1",\n    "author": "Esri R\x26D Center Beijing",\n    "description": "",\n    "copyright": "",\n    "license": "",\n    "extensions": [\n      {\n        "point": "app-config.main-app-actions",\n        "description": "",\n        "parameters": {\n          "supportAppTypes": "all",\n          "index": 1\n        },\n        "pluginName": "app-actions.launch-app"\n      }\n    ],\n    "properties": {\n      "hasUIFile": false,\n      "hasClass": true,\n      "hasLocale": true,\n      "hasStyle": true\n    }\n  },\n  "app-actions.preview-app": {\n    "name": "app-actions.preview-app",\n    "type": "plugin",\n    "version": "2.0.1",\n    "author": "Esri R\x26D Center Beijing",\n    "description": "",\n    "copyright": "",\n    "license": "",\n    "extensions": [\n      {\n        "point": "app-config.main-app-actions",\n        "description": "",\n        "parameters": {\n          "supportAppTypes": "HTML",\n          "index": 2\n        },\n        "pluginName": "app-actions.preview-app"\n      }\n    ],\n    "properties": {\n      "hasClass": true,\n      "hasLocale": true,\n      "hasStyle": true,\n      "hasUIFile": true\n    }\n  },\n  "app-actions.save-app": {\n    "name": "app-actions.save-app",\n    "type": "plugin",\n    "version": "2.0.1",\n    "author": "Esri R\x26D Center Beijing",\n    "description": "",\n    "copyright": "",\n    "license": "",\n    "extensions": [\n      {\n        "point": "app-config.main-app-actions",\n        "description": "",\n        "parameters": {\n          "supportAppTypes": "all",\n          "index": 3\n        },\n        "pluginName": "app-actions.save-app"\n      },\n      {\n        "point": "app-config.popup-app-actions",\n        "description": "",\n        "parameters": {\n          "supportAppTypes": "all",\n          "onClickAction": "_onClick",\n          "index": 1\n        },\n        "pluginName": "app-actions.save-app"\n      }\n    ],\n    "properties": {\n      "hasClass": true,\n      "hasLocale": true,\n      "hasStyle": true,\n      "hasUIFile": true\n    }\n  },\n  "app-actions.to-template-config": {\n    "name": "app-actions.to-template-config",\n    "type": "plugin",\n    "version": "2.0.1",\n    "author": "Esri R\x26D Center Beijing",\n    "description": "",\n    "copyright": "",\n    "license": "",\n    "extensions": [\n      {\n        "point": "app-config.main-app-actions",\n        "description": "",\n        "parameters": {\n          "supportAppTypes": "all",\n          "index": 1\n        },\n        "pluginName": "app-actions.to-template-config"\n      }\n    ],\n    "properties": {\n      "hasUIFile": false,\n      "hasClass": true,\n      "hasLocale": true,\n      "hasStyle": true\n    }\n  },\n  "app-config": {\n    "name": "app-config",\n    "type": "plugin",\n    "version": "2.0.1",\n    "author": "Esri R\x26D Center Beijing",\n    "description": "the first plugin that builder loads.",\n    "copyright": "",\n    "license": "",\n    "extensionPoints": {\n      "config-template": {\n        "description": "Config template",\n        "parameters": {\n          "supportAppTypes": {\n            "type": "string",\n            "required": true,\n            "name": "supportAppTypes"\n          }\n        },\n        "id": "app-config.config-template",\n        "name": "config-template",\n        "extensions": [\n          {\n            "point": "app-config.config-template",\n            "description": "",\n            "parameters": {\n              "supportAppTypes": "all"\n            },\n            "pluginName": "app-config-templateconfig"\n          }\n        ]\n      },\n      "config-part": {\n        "description": "The config part",\n        "parameters": {\n          "supportAppTypes": {\n            "type": "string",\n            "required": true,\n            "name": "supportAppTypes"\n          }\n        },\n        "id": "app-config.config-part",\n        "name": "config-part",\n        "extensions": [\n          {\n            "point": "app-config.config-part",\n            "description": "",\n            "parameters": {\n              "supportAppTypes": "all"\n            },\n            "pluginName": "app-config-configpart"\n          }\n        ]\n      },\n      "morepreview-selction-part": {\n        "description": "The more preview selection part",\n        "parameters": {\n          "supportAppTypes": {\n            "type": "string",\n            "required": true,\n            "name": "supportAppTypes"\n          }\n        },\n        "id": "app-config.morepreview-selction-part",\n        "name": "morepreview-selction-part",\n        "extensions": [\n          {\n            "point": "app-config.morepreview-selction-part",\n            "description": "",\n            "parameters": {\n              "supportAppTypes": "all"\n            },\n            "pluginName": "app-config-morepreview-selectionpart"\n          }\n        ]\n      },\n      "template-config-part": {\n        "description": "The Template config part",\n        "parameters": {\n          "supportAppTypes": {\n            "type": "string",\n            "required": true,\n            "name": "supportAppTypes"\n          }\n        },\n        "id": "app-config.template-config-part",\n        "name": "template-config-part",\n        "extensions": [\n          {\n            "point": "app-config.template-config-part",\n            "description": "",\n            "parameters": {\n              "supportAppTypes": "all"\n            },\n            "pluginName": "app-config-template-configpart"\n          }\n        ]\n      },\n      "main-app-actions": {\n        "parameters": {\n          "supportAppTypes": {\n            "type": "string",\n            "required": true,\n            "name": "supportAppTypes"\n          },\n          "index": {\n            "type": "number",\n            "required": true,\n            "description": "1 based index.",\n            "name": "index"\n          }\n        },\n        "id": "app-config.main-app-actions",\n        "name": "main-app-actions",\n        "extensions": [\n          {\n            "point": "app-config.main-app-actions",\n            "description": "",\n            "parameters": {\n              "supportAppTypes": "all",\n              "index": 1\n            },\n            "pluginName": "app-actions.launch-app"\n          },\n          {\n            "point": "app-config.main-app-actions",\n            "description": "",\n            "parameters": {\n              "supportAppTypes": "HTML",\n              "index": 2\n            },\n            "pluginName": "app-actions.preview-app"\n          },\n          {\n            "point": "app-config.main-app-actions",\n            "description": "",\n            "parameters": {\n              "supportAppTypes": "all",\n              "index": 3\n            },\n            "pluginName": "app-actions.save-app"\n          },\n          {\n            "point": "app-config.main-app-actions",\n            "description": "",\n            "parameters": {\n              "supportAppTypes": "all",\n              "index": 1\n            },\n            "pluginName": "app-actions.to-template-config"\n          }\n        ]\n      },\n      "popup-app-actions": {\n        "parameters": {\n          "onClickAction": {\n            "type": "function",\n            "name": "onClickAction"\n          },\n          "supportAppTypes": {\n            "type": "string",\n            "required": true,\n            "name": "supportAppTypes"\n          },\n          "index": {\n            "type": "number",\n            "required": true,\n            "description": "1 based index.",\n            "name": "index"\n          }\n        },\n        "id": "app-config.popup-app-actions",\n        "name": "popup-app-actions",\n        "extensions": [\n          {\n            "point": "app-config.popup-app-actions",\n            "description": "",\n            "parameters": {\n              "supportAppTypes": "all",\n              "onClickAction": "_onClick",\n              "index": 1\n            },\n            "pluginName": "app-actions.save-app"\n          },\n          {\n            "point": "app-config.popup-app-actions",\n            "description": "",\n            "parameters": {\n              "supportAppTypes": "all",\n              "onClickAction": "onClick",\n              "index": 4\n            },\n            "pluginName": "popup-actions.configmode-switch"\n          },\n          {\n            "point": "app-config.popup-app-actions",\n            "description": "",\n            "parameters": {\n              "supportAppTypes": "all",\n              "onClickAction": "onClick",\n              "index": 3\n            },\n            "pluginName": "popup-actions.popup-agoltemplate"\n          },\n          {\n            "point": "app-config.popup-app-actions",\n            "description": "",\n            "parameters": {\n              "supportAppTypes": "all",\n              "onClickAction": "onClick",\n              "index": 2\n            },\n            "pluginName": "popup-actions.popup-saveas"\n          }\n        ]\n      }\n    },\n    "extensions": [\n      {\n        "point": "startup.app-config",\n        "description": "",\n        "parameters": {\n          "supportAppTypes": "all"\n        },\n        "pluginName": "app-config"\n      }\n    ],\n    "properties": {\n      "hasLocale": false,\n      "hasClass": true,\n      "hasStyle": true,\n      "hasUIFile": true\n    }\n  },\n  "app-config-configpart": {\n    "name": "app-config-configpart",\n    "type": "plugin",\n    "version": "2.0.1",\n    "author": "Esri R\x26D Center Beijing",\n    "description": "the config part of the config page.",\n    "copyright": "",\n    "license": "",\n    "extensionPoints": {\n      "config-sections": {\n        "description": "The config page for section of full config",\n        "parameters": {\n          "label": {\n            "type": "string",\n            "required": true,\n            "name": "label"\n          },\n          "icon": {\n            "type": "url",\n            "required": true,\n            "name": "icon"\n          },\n          "selectedIcon": {\n            "type": "url",\n            "required": true,\n            "name": "selectedIcon"\n          },\n          "supportAppTypes": {\n            "type": "string",\n            "required": true,\n            "name": "supportAppTypes"\n          },\n          "republishEvents": {\n            "type": "string",\n            "required": true,\n            "description": "The events that change app config. These events will be pushed to preview window",\n            "name": "republishEvents"\n          },\n          "index": {\n            "type": "number",\n            "required": true,\n            "description": "1 based index.",\n            "name": "index"\n          }\n        },\n        "id": "app-config-configpart.config-sections",\n        "name": "config-sections",\n        "extensions": [\n          {\n            "point": "app-config-configpart.config-sections",\n            "description": "",\n            "parameters": {\n              "supportAppTypes": "all",\n              "label": "${_paramLabel}",\n              "icon": "images/icon.svg",\n              "selectedIcon": "images/selected_icon.svg",\n              "republishEvents": "appAttributeChanged,loadingPageChanged,actionTriggered,appProxyForMapChanged,appProxyForUrlChanged",\n              "index": 4\n            },\n            "pluginName": "attribute-config"\n          },\n          {\n            "point": "app-config-configpart.config-sections",\n            "description": "",\n            "parameters": {\n              "supportAppTypes": "all",\n              "label": "${_paramLabel}",\n              "icon": "images/icon.svg",\n              "selectedIcon": "images/selected_icon.svg",\n              "republishEvents": "setAppConfig,mapChanged,mapOptionsChanged,sceneViewChanged,dataSourceChanged,mapRefreshIntervalChanged",\n              "index": 2\n            },\n            "pluginName": "map-config"\n          },\n          {\n            "point": "app-config-configpart.config-sections",\n            "description": "",\n            "parameters": {\n              "supportAppTypes": "all",\n              "label": "${_paramLabel}",\n              "icon": "images/icon.svg",\n              "selectedIcon": "images/selected_icon.svg",\n              "republishEvents": "themeChanged,styleChanged,layoutChanged,sharedThemeChanged,layoutDefinitionChanged",\n              "index": 1\n            },\n            "pluginName": "theme-config"\n          },\n          {\n            "point": "app-config-configpart.config-sections",\n            "description": "",\n            "parameters": {\n              "supportAppTypes": "all",\n              "label": "${_paramLabel}",\n              "icon": "images/icon.svg",\n              "selectedIcon": "images/selected_icon.svg",\n              "republishEvents": "widgetChanged,widgetPoolChanged,openAtStartChange,actionTriggered,groupChanged,onScreenGroupsChanged",\n              "index": 3\n            },\n            "pluginName": "widget-config"\n          }\n        ]\n      }\n    },\n    "extensions": [\n      {\n        "point": "app-config.config-part",\n        "description": "",\n        "parameters": {\n          "supportAppTypes": "all"\n        },\n        "pluginName": "app-config-configpart"\n      }\n    ],\n    "properties": {\n      "hasClass": true,\n      "hasLocale": true,\n      "hasStyle": true,\n      "hasUIFile": true\n    }\n  },\n  "app-config-morepreview-selectionpart": {\n    "name": "app-config-morepreview-selectionpart",\n    "type": "plugin",\n    "version": "2.0.1",\n    "author": "Esri R\x26D Center Beijing",\n    "description": "the config part of the config page.",\n    "copyright": "",\n    "license": "",\n    "extensionPoints": {},\n    "extensions": [\n      {\n        "point": "app-config.morepreview-selction-part",\n        "description": "",\n        "parameters": {\n          "supportAppTypes": "all"\n        },\n        "pluginName": "app-config-morepreview-selectionpart"\n      }\n    ],\n    "properties": {\n      "hasClass": true,\n      "hasLocale": true,\n      "hasStyle": true,\n      "hasUIFile": true\n    }\n  },\n  "app-config-template-configpart": {\n    "name": "app-config-template-configpart",\n    "type": "plugin",\n    "version": "2.0.1",\n    "author": "Esri R\x26D Center Beijing",\n    "description": "the template config part.",\n    "copyright": "",\n    "license": "",\n    "extensionPoints": {},\n    "extensions": [\n      {\n        "point": "app-config.template-config-part",\n        "description": "",\n        "parameters": {\n          "supportAppTypes": "all"\n        },\n        "pluginName": "app-config-template-configpart"\n      }\n    ],\n    "properties": {\n      "hasClass": true,\n      "hasLocale": true,\n      "hasStyle": true,\n      "hasUIFile": true\n    }\n  },\n  "app-config-templateconfig": {\n    "name": "app-config-templateconfig",\n    "type": "plugin",\n    "version": "2.0.1",\n    "author": "Esri R\x26D Center Beijing",\n    "description": "the first plugin that builder loads.",\n    "copyright": "",\n    "license": "",\n    "extensionPoints": {},\n    "extensions": [\n      {\n        "point": "app-config.config-template",\n        "description": "",\n        "parameters": {\n          "supportAppTypes": "all"\n        },\n        "pluginName": "app-config-templateconfig"\n      }\n    ],\n    "properties": {\n      "hasClass": true,\n      "hasLocale": true,\n      "hasStyle": true,\n      "hasUIFile": true\n    }\n  },\n  "app-list": {\n    "name": "app-list",\n    "type": "plugin",\n    "version": "2.0.1",\n    "author": "Esri R\x26D Center Beijing",\n    "description": "the first plugin that builder loads.",\n    "copyright": "",\n    "license": "",\n    "extensionPoints": {},\n    "extensions": [\n      {\n        "point": "startup.app-list",\n        "description": "",\n        "pluginName": "app-list"\n      }\n    ],\n    "properties": {\n      "hasClass": true,\n      "hasLocale": true,\n      "hasStyle": true,\n      "hasUIFile": true\n    }\n  },\n  "attribute-config": {\n    "name": "attribute-config",\n    "type": "plugin",\n    "version": "2.0.1",\n    "author": "Esri R\x26D Center Beijing",\n    "description": "",\n    "copyright": "",\n    "license": "",\n    "extensions": [\n      {\n        "point": "app-config-configpart.config-sections",\n        "description": "",\n        "parameters": {\n          "supportAppTypes": "all",\n          "label": "${_paramLabel}",\n          "icon": "images/icon.svg",\n          "selectedIcon": "images/selected_icon.svg",\n          "republishEvents": "appAttributeChanged,loadingPageChanged,actionTriggered,appProxyForMapChanged,appProxyForUrlChanged",\n          "index": 4\n        },\n        "pluginName": "attribute-config"\n      }\n    ],\n    "properties": {\n      "hasClass": true,\n      "hasLocale": true,\n      "hasStyle": true,\n      "hasUIFile": true\n    }\n  },\n  "creation-entry": {\n    "name": "creation-entry",\n    "type": "plugin",\n    "version": "2.0.1",\n    "author": "Esri R\x26D Center Beijing",\n    "description": "the first plugin that builder loads.",\n    "copyright": "",\n    "license": "",\n    "extensions": [\n      {\n        "point": "startup.creation-entry",\n        "description": "",\n        "pluginName": "creation-entry"\n      }\n    ],\n    "properties": {\n      "hasClass": true,\n      "hasLocale": true,\n      "hasStyle": true,\n      "hasUIFile": true\n    }\n  },\n  "header": {\n    "name": "header",\n    "type": "plugin",\n    "version": "2.0.1",\n    "author": "Esri R\x26D Center Beijing",\n    "description": "the first plugin that builder loads.",\n    "copyright": "",\n    "license": "",\n    "extensions": [\n      {\n        "point": "startup.header",\n        "description": "",\n        "pluginName": "header"\n      }\n    ],\n    "properties": {\n      "hasClass": true,\n      "hasLocale": true,\n      "hasStyle": true,\n      "hasUIFile": true\n    }\n  },\n  "map-config": {\n    "name": "map-config",\n    "type": "plugin",\n    "version": "2.0.1",\n    "author": "Esri R\x26D Center Beijing",\n    "description": "",\n    "copyright": "",\n    "license": "",\n    "extensions": [\n      {\n        "point": "app-config-configpart.config-sections",\n        "description": "",\n        "parameters": {\n          "supportAppTypes": "all",\n          "label": "${_paramLabel}",\n          "icon": "images/icon.svg",\n          "selectedIcon": "images/selected_icon.svg",\n          "republishEvents": "setAppConfig,mapChanged,mapOptionsChanged,sceneViewChanged,dataSourceChanged,mapRefreshIntervalChanged",\n          "index": 2\n        },\n        "pluginName": "map-config"\n      }\n    ],\n    "properties": {\n      "hasClass": true,\n      "hasLocale": true,\n      "hasStyle": true,\n      "hasUIFile": true\n    }\n  },\n  "popup-actions.configmode-switch": {\n    "name": "popup-actions.configmode-switch",\n    "type": "plugin",\n    "version": "2.0.1",\n    "author": "Esri R\x26D Center Beijing",\n    "description": "",\n    "copyright": "",\n    "license": "",\n    "extensions": [\n      {\n        "point": "app-config.popup-app-actions",\n        "description": "",\n        "parameters": {\n          "supportAppTypes": "all",\n          "onClickAction": "onClick",\n          "index": 4\n        },\n        "pluginName": "popup-actions.configmode-switch"\n      }\n    ],\n    "properties": {\n      "hasClass": true,\n      "hasLocale": true,\n      "hasStyle": false,\n      "hasUIFile": false\n    }\n  },\n  "popup-actions.popup-agoltemplate": {\n    "name": "popup-actions.popup-agoltemplate",\n    "type": "plugin",\n    "version": "2.0.1",\n    "author": "Esri R\x26D Center Beijing",\n    "description": "",\n    "copyright": "",\n    "license": "",\n    "extensions": [\n      {\n        "point": "app-config.popup-app-actions",\n        "description": "",\n        "parameters": {\n          "supportAppTypes": "all",\n          "onClickAction": "onClick",\n          "index": 3\n        },\n        "pluginName": "popup-actions.popup-agoltemplate"\n      }\n    ],\n    "properties": {\n      "hasClass": true,\n      "hasLocale": true,\n      "hasStyle": true,\n      "hasUIFile": false\n    }\n  },\n  "popup-actions.popup-saveas": {\n    "name": "popup-actions.popup-saveas",\n    "type": "plugin",\n    "version": "2.0.1",\n    "author": "Esri R\x26D Center Beijing",\n    "description": "",\n    "copyright": "",\n    "license": "",\n    "extensions": [\n      {\n        "point": "app-config.popup-app-actions",\n        "description": "",\n        "parameters": {\n          "supportAppTypes": "all",\n          "onClickAction": "onClick",\n          "index": 2\n        },\n        "pluginName": "popup-actions.popup-saveas"\n      }\n    ],\n    "properties": {\n      "hasClass": true,\n      "hasLocale": true,\n      "hasStyle": false,\n      "hasUIFile": false\n    }\n  },\n  "popup-actions.popup-share": {\n    "name": "popup-actions.popup-share",\n    "type": "plugin",\n    "version": "2.0.1",\n    "author": "Esri R\x26D Center Beijing",\n    "description": "",\n    "copyright": "",\n    "license": "",\n    "extensions": [\n      {\n        "point": "",\n        "description": "",\n        "parameters": {\n          "supportAppTypes": "all",\n          "onClickAction": "onClick",\n          "index": 1,\n          "republishEvents": "SharePluginOnClickEveryone"\n        },\n        "pluginName": "popup-actions.popup-share"\n      }\n    ],\n    "properties": {\n      "hasClass": true,\n      "hasLocale": false,\n      "hasStyle": false,\n      "hasUIFile": false\n    }\n  },\n  "startup": {\n    "name": "startup",\n    "type": "plugin",\n    "version": "2.0.1",\n    "author": "Esri R\x26D Center Beijing",\n    "description": "the first plugin that builder loads.",\n    "copyright": "",\n    "license": "",\n    "extensionPoints": {\n      "app-list": {\n        "description": "the app list page.",\n        "id": "startup.app-list",\n        "name": "app-list",\n        "extensions": [\n          {\n            "point": "startup.app-list",\n            "description": "",\n            "pluginName": "app-list"\n          }\n        ]\n      },\n      "header": {\n        "description": "the header.",\n        "id": "startup.header",\n        "name": "header",\n        "extensions": [\n          {\n            "point": "startup.header",\n            "description": "",\n            "pluginName": "header"\n          }\n        ]\n      },\n      "app-config": {\n        "description": "the app config page.",\n        "parameters": {\n          "supportAppTypes": {\n            "type": "string",\n            "required": true,\n            "name": "supportAppTypes"\n          }\n        },\n        "id": "startup.app-config",\n        "name": "app-config",\n        "extensions": [\n          {\n            "point": "startup.app-config",\n            "description": "",\n            "parameters": {\n              "supportAppTypes": "all"\n            },\n            "pluginName": "app-config"\n          }\n        ]\n      },\n      "creation-entry": {\n        "description": "The create new entry point.",\n        "id": "startup.creation-entry",\n        "name": "creation-entry",\n        "extensions": [\n          {\n            "point": "startup.creation-entry",\n            "description": "",\n            "pluginName": "creation-entry"\n          }\n        ]\n      },\n      "stemapps": {\n        "description": "the stemapp.",\n        "parameters": {\n          "appType": {\n            "type": "string",\n            "required": true,\n            "name": "appType"\n          },\n          "appPath": {\n            "type": "string",\n            "description": "By default, it\'s plugin\'s folder path",\n            "name": "appPath"\n          },\n          "appVersionManager": {\n            "type": "string",\n            "description": "path relative to app path. required if app config is old.",\n            "name": "appVersionManager"\n          },\n          "index": {\n            "type": "number",\n            "required": true,\n            "description": "1 based index.",\n            "name": "index"\n          }\n        },\n        "id": "startup.stemapps",\n        "name": "stemapps",\n        "extensions": [\n          {\n            "point": "startup.stemapps",\n            "description": "",\n            "parameters": {\n              "appType": "HTML",\n              "appPath": "../../../../stemapp/",\n              "appVersionManager": "jimu.js/shared/AppVersionManager.js",\n              "index": 1\n            },\n            "pluginName": "stemapps.web2d"\n          },\n          {\n            "point": "startup.stemapps",\n            "description": "",\n            "parameters": {\n              "appType": "HTML3D",\n              "appPath": "../../../../stemapp3d/",\n              "appVersionManager": "jimu.js/shared/AppVersionManager.js",\n              "index": 2\n            },\n            "pluginName": "stemapps.web3d"\n          }\n        ]\n      }\n    },\n    "extensions": [],\n    "properties": {\n      "hasLocale": false,\n      "hasClass": true,\n      "hasStyle": true,\n      "hasUIFile": true\n    }\n  },\n  "stemapps.web2d": {\n    "name": "stemapps.web2d",\n    "type": "plugin",\n    "version": "2.0.1",\n    "author": "Esri R\x26D Center Beijing",\n    "description": "",\n    "copyright": "",\n    "license": "",\n    "extensions": [\n      {\n        "point": "startup.stemapps",\n        "description": "",\n        "parameters": {\n          "appType": "HTML",\n          "appPath": "../../../../stemapp/",\n          "appVersionManager": "jimu.js/shared/AppVersionManager.js",\n          "index": 1\n        },\n        "pluginName": "stemapps.web2d"\n      }\n    ],\n    "properties": {\n      "hasClass": false,\n      "hasLocale": true,\n      "hasStyle": true,\n      "hasUIFile": true\n    }\n  },\n  "stemapps.web3d": {\n    "name": "stemapps.web3d",\n    "type": "plugin",\n    "version": "2.0.1",\n    "author": "Esri R\x26D Center Beijing",\n    "description": "",\n    "copyright": "",\n    "license": "",\n    "extensions": [\n      {\n        "point": "startup.stemapps",\n        "description": "",\n        "parameters": {\n          "appType": "HTML3D",\n          "appPath": "../../../../stemapp3d/",\n          "appVersionManager": "jimu.js/shared/AppVersionManager.js",\n          "index": 2\n        },\n        "pluginName": "stemapps.web3d"\n      }\n    ],\n    "properties": {\n      "hasClass": false,\n      "hasLocale": true,\n      "hasStyle": true,\n      "hasUIFile": true\n    }\n  },\n  "theme-config": {\n    "name": "theme-config",\n    "type": "plugin",\n    "version": "2.0.1",\n    "author": "Esri R\x26D Center Beijing",\n    "description": "",\n    "copyright": "",\n    "license": "",\n    "extensions": [\n      {\n        "point": "app-config-configpart.config-sections",\n        "description": "",\n        "parameters": {\n          "supportAppTypes": "all",\n          "label": "${_paramLabel}",\n          "icon": "images/icon.svg",\n          "selectedIcon": "images/selected_icon.svg",\n          "republishEvents": "themeChanged,styleChanged,layoutChanged,sharedThemeChanged,layoutDefinitionChanged",\n          "index": 1\n        },\n        "pluginName": "theme-config"\n      }\n    ],\n    "properties": {\n      "hasClass": true,\n      "hasLocale": true,\n      "hasStyle": true,\n      "hasUIFile": true\n    }\n  },\n  "widget-config": {\n    "name": "widget-config",\n    "type": "plugin",\n    "version": "2.0.1",\n    "author": "Esri R\x26D Center Beijing",\n    "description": "",\n    "copyright": "",\n    "license": "",\n    "extensions": [\n      {\n        "point": "app-config-configpart.config-sections",\n        "description": "",\n        "parameters": {\n          "supportAppTypes": "all",\n          "label": "${_paramLabel}",\n          "icon": "images/icon.svg",\n          "selectedIcon": "images/selected_icon.svg",\n          "republishEvents": "widgetChanged,widgetPoolChanged,openAtStartChange,actionTriggered,groupChanged,onScreenGroupsChanged",\n          "index": 3\n        },\n        "pluginName": "widget-config"\n      }\n    ],\n    "properties": {\n      "hasClass": true,\n      "hasLocale": true,\n      "hasStyle": true,\n      "hasUIFile": true\n    }\n  }\n}\n',
"url:builder/plugins/app-actions/launch-app/css/style.css":".plugin-app-actions-launch-app{margin-top:3px; height: 47px; line-height: 47px; background-color:#F3F3F3; text-align: center; cursor: default;}.plugin-app-actions-launch-app .footer-button{background-image: url(images/icon.svg); background-position:left center; background-repeat: no-repeat; white-space: nowrap; display: inline-block; padding-left:20px; height: 100%; max-width: 100%; text-overflow: ellipsis; overflow: hidden;}.jimu-rtl .plugin-app-actions-launch-app .footer-button{padding-right:20px; padding-left:0; background-position:right center; cursor: pointer;}.plugin-app-actions-launch-app a{color: inherit; display: block; text-decoration: none; height: 47px;}.plugin-app-actions-launch-app:hover .footer-button{color:#24B5CC; background-image: url(images/hover_icon.svg);}",
"url:builder/plugins/app-actions/preview-app/Plugin.html":'\x3cdiv\x3e\r\n  \x3cdiv class\x3d"footer-button  preview-button" data-dojo-attach-point\x3d"btnPreview" title\x3d${nls.previewMore}\x3e${nls.previewMore}\x3c/div\x3e\r\n  \x3cdiv class\x3d"footer-button  config-button" style\x3d"display:none" data-dojo-attach-point\x3d"btnConfig" title\x3d${nls.back2Configure}\x3e${nls.back2Configure}\x3c/div\x3e\r\n\x3c/div\x3e',"url:builder/plugins/app-actions/preview-app/css/style.css":".plugin-app-actions-preview-app{margin-top:3px; height: 47px; line-height: 47px; background-color:#F3F3F3; text-align: center; cursor: pointer;}.plugin-app-actions-preview-app .footer-button{background-position:left center; background-repeat: no-repeat; white-space: nowrap; display: inline-block; padding-left:20px; height: 100%; max-width: 100%; text-overflow: ellipsis; overflow: hidden;}.jimu-rtl .plugin-app-actions-preview-app .footer-button{padding-right:20px; padding-left:0; background-position:right center; cursor: pointer;}.plugin-app-actions-preview-app:hover .footer-button {color:#24B5CC;}.plugin-app-actions-preview-app .footer-button.preview-button{background-image: url(images/icon.svg);}.plugin-app-actions-preview-app:hover .footer-button.preview-button{background-image: url(images/hover_icon.svg);}.plugin-app-actions-preview-app .footer-button.config-button{background-image: url(images/configure01.svg);}.jimu-rtl .plugin-app-actions-preview-app .footer-button.config-button{background-image: url(images/configure03.svg);}.plugin-app-actions-preview-app:hover .footer-button.config-button{background-image: url(images/configure02.svg);}.jimu-rtl .plugin-app-actions-preview-app:hover .footer-button.config-button{background-image: url(images/configure04.svg);}",
"url:builder/plugins/app-actions/save-app/Plugin.html":'\x3cdiv\x3e\r\n  \x3cdiv class\x3d"footer-button" title\x3d${nls.label} data-dojo-attach-point\x3d"actionNode"\x3e${nls.label}\x3c/div\x3e\r\n\x3c/div\x3e',"url:builder/plugins/app-actions/save-app/css/style.css":".plugin-app-actions-save-app{margin-top:3px; height: 47px; line-height: 47px; background-color:#F3F3F3; text-align: center; cursor: default;}.plugin-app-actions-save-app .footer-button{background-image: url(images/icon.svg); background-position:left center; background-repeat: no-repeat; white-space: nowrap; display: inline-block; padding-left:20px; height: 100%; max-width: 100%; text-overflow: ellipsis; overflow: hidden;}.jimu-rtl .plugin-app-actions-save-app .footer-button{padding-right:20px; padding-left:0; background-position:right center; cursor: pointer;}.plugin-app-actions-save-app:hover .footer-button{color:#24B5CC; background-image: url(images/hover_icon.svg);}.plugin-app-actions-save-app .footer-button.save-enable{background-image:url(images/hover_icon.svg); background-repeat: no-repeat; color: #24B5CC;}.plugin-app-actions-save-app .footer-button.save-block{color: #d2dae2; background-image: url(images/block_icon.png);}",
"url:builder/plugins/app-actions/to-template-config/css/style.css":".plugin-app-actions-to-template-config{margin-top:3px; height: 47px; line-height: 47px; background-color:#F3F3F3; text-align: center; cursor: pointer;}.plugin-app-actions-to-template-config .footer-button{background-image: url(images/icon.png); background-position:left center; background-repeat: no-repeat; white-space: nowrap; display: inline-block; padding-left:20px; height: 100%; max-width: 100%; text-overflow: ellipsis; overflow: hidden;}.jimu-rtl .plugin-app-actions-to-template-config .footer-button{padding-right:20px; padding-left:0; background-position:right center; cursor: pointer;}.plugin-app-actions-to-template-config:hover .footer-button{color:#15a4fa; background-image: url(images/hover_icon.png);}",
"url:jimu/dijit/templates/LoadingShelter.html":'\x3cdiv\x3e\r\n  \x3cdiv class\x3d"loading-container"\x3e\r\n      \x3cdiv data-dojo-attach-point\x3d"loadingNode" class\x3d"jimu-loading"\x3e\x3c/div\x3e\r\n      \x3cp data-dojo-attach-point\x3d"textNode"\x3e\x3c/p\x3e\r\n  \x3c/div\x3e\r\n\x3c/div\x3e',"url:jimu/dijit/templates/AGOLLoading.html":'\x3cdiv\x3e\r\n  \x3cdiv class\x3d"loading-container"\x3e\r\n      \x3cdiv data-dojo-attach-point\x3d"imgDiv" class\x3d"img-div"\x3e\r\n      \x3c/div\x3e\r\n      \x3cp data-dojo-attach-point\x3d"textNode"\x3e\x3c/p\x3e\r\n  \x3c/div\x3e\r\n\x3c/div\x3e',
"url:builder/plugins/app-config/Plugin.html":'\x3cdiv \x3e\r\n  \x3cdiv class\x3d"at-view-stack" data-dojo-attach-point\x3d"atViewStackNode"\x3e\r\n    \x3cdiv class\x3d"config-app-pane" data-dojo-attach-point\x3d"configAppNode"\x3e\r\n      \x3cdiv class\x3d"left-pane" data-dojo-attach-point\x3d"leftPaneNode"\x3e\r\n        \x3cdiv class\x3d"opts-viewstack" data-dojo-attach-point\x3d"optsViewStackNode"\x3e\r\n          \x3cdiv data-dojo-attach-point\x3d"configOptsPaneNode"\x3e\r\n\r\n          \x3c/div\x3e\r\n          \x3cdiv data-dojo-attach-point\x3d"morePreviewOptsPaneNode"\x3e\r\n\r\n          \x3c/div\x3e\r\n\r\n          \x3cdiv data-dojo-attach-point\x3d"templateOptsPaneNode"\x3e\r\n\r\n          \x3c/div\x3e\r\n        \x3c/div\x3e\r\n        \x3cdiv class\x3d"actions-pane" data-dojo-attach-point\x3d"actionsPaneNode"\x3e\r\n          \x3cdiv class\x3d"main-action-box" data-dojo-attach-point\x3d"mainActionBoxNode"\x3e\x3c/div\x3e\r\n          \x3cdiv class\x3d"footer-button-arrow jimu-float-leading" data-dojo-attach-point\x3d"btnArrow" data-dojo-attach-event\x3d"onclick: _onBtnArrowClick"\x3e\r\n            \x3cdiv class\x3d"foot-menu" data-dojo-attach-point\x3d"popupActionsMenu"\x3e\r\n            \x3c/div\x3e\r\n          \x3c/div\x3e\r\n        \x3c/div\x3e\r\n      \x3c/div\x3e\r\n\r\n      \x3cdiv class\x3d"right-preview-section" data-dojo-attach-point\x3d"rightPreviewSection"\x3e\r\n        \x3cdiv class\x3d"preview-config" data-dojo-attach-point\x3d"previewConfig"\x3e\r\n          \x3ciframe name\x3d"previewConfigFrame" data-dojo-attach-point\x3d"previewConfigFrameNode" style\x3d"border:none" allowfullscreen\x3d"true"\x3e\x3c/iframe\x3e\r\n        \x3c/div\x3e\r\n\r\n        \x3cdiv class\x3d"preview-more" data-dojo-attach-point\x3d"previewMore"\x3e\r\n          \x3cdiv class\x3d"preview-more-iframe-section" data-dojo-attach-point\x3d"previewMoreIframeSection"\x3e\r\n            \x3cdiv class\x3d"preview-more-iframe-container" data-dojo-attach-point\x3d"previewMoreContainer"\x3e\r\n              \x3ciframe name\x3d"previewMoreFrame" data-dojo-attach-point\x3d"previewMoreFrameNode" style\x3d"border-color:#cad1d9;" allowfullscreen\x3d"true"\x3e\x3c/iframe\x3e\r\n            \x3c/div\x3e\r\n            \x3cdiv class\x3d"description" data-dojo-attach-point\x3d"previewMoreDes"\x3e\x3c/div\x3e\r\n          \x3c/div\x3e\r\n          \x3cdiv class\x3d"screen-switch-section"\x3e\r\n            \x3cdiv class\x3d"portrait jimu-float-leading selected" data-dojo-attach-point\x3d"btnPortrait"\x3e\x3c/div\x3e\r\n            \x3cdiv class\x3d"landscape jimu-float-trailing" data-dojo-attach-point\x3d"btnLandscape"\x3e\x3c/div\x3e\r\n          \x3c/div\x3e\r\n        \x3c/div\x3e\r\n      \x3c/div\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv class\x3d"config-template-pane" data-dojo-attach-point\x3d"configTemplateNode"\x3e\x3c/div\x3e\r\n  \x3c/div\x3e\r\n\x3c/div\x3e',
"url:builder/plugins/app-config/css/style.css":".plugin-config-app .at-view-stack{width: 100%; height: 100%; position: relative;}.plugin-config-app .at-view-stack \x3e .view{position: absolute; left: 0; top: 0;}.plugin-config-app .at-view-stack \x3e .view.config-app-pane{display: block !important; visibility: hidden;}.plugin-config-app .at-view-stack \x3e .view.config-template-pane{z-index: 2;}.plugin-config-app .left-pane{font-size: 20px; width: 400px; height: 100%; position: absolute; box-shadow: 0px 0px 8px rgba(0,0,0,0.4); z-index: 2;}.plugin-config-app .left-pane \x3e .jimu-loading-shelter{background-color: rgba(0, 0, 0, 0.5);}.plugin-config-app .left-pane .opts-viewstack{position: absolute; left: 0; right: 0; top: 0; bottom: 50px;}.plugin-config-app .right-preview-section{position: absolute; left: 400px; top: 0; right: 0; height: 100%;}.plugin-config-app .right-preview-section .preview-viewstack{width:100%; height:100%;}.plugin-config-app .preview-config,.plugin-config-app .preview-more{width:100%; height:100%;}.plugin-config-app .preview-config iframe{width: 100%; height: 100%;}.plugin-config-app .preview-more{position:relative; background-color:#f3f3f3; overflow:auto;}.plugin-config-app .preview-more .preview-more-iframe-section .preview-more-iframe-container{margin-left:auto; margin-right:auto; background:#eaecee; padding:20px; border:2px solid #666; -webkit-border-radius:15px; -moz-border-radius:15px; -o-border-radius:15px; -ms-border-radius:15px; border-radius:15px; -webkit-box-shadow:0 0 25px 0 rgba(0, 0, 0, 0.9); -moz-box-shadow:0 0 25px 0 rgba(0, 0, 0, 0.9); -o-box-shadow:0 0 25px 0 rgba(0, 0, 0, 0.9); -ms-box-shadow:0 0 25px 0 rgba(0, 0, 0, 0.9); box-shadow:0 0 25px 0 rgba(0, 0, 0, 0.9);}.plugin-config-app .preview-more .preview-more-iframe-section .preview-more-iframe-container iframe{width:100%; height:100%;}.plugin-config-app .preview-more .description{display:none; text-align:center; font-size:15px; margin-top:20px;}.plugin-config-app .preview-more .screen-switch-section{position:absolute; right:12px; top:12px; height:38px;}.jimu-rtl .plugin-config-app .preview-more .screen-switch-section{right: auto; left: 12px;}.plugin-config-app .preview-more .screen-switch-section div{width:38px; height:100%; background-repeat:no-repeat; background-position:center center; cursor:pointer; background-color:#FFFFFF;}.plugin-config-app .preview-more .screen-switch-section div.selected{background-color:#F7F8F8;}.plugin-config-app .preview-more .screen-switch-section .portrait{border-top-left-radius:3px; border-bottom-left-radius:3px; background-image:url(images/portrait.png);}.plugin-config-app .preview-more .screen-switch-section .landscape{border-top-right-radius:3px; border-bottom-right-radius:3px; background-image:url(images/landscape.png);}.plugin-config-app .preview-more .screen-switch-section .portrait.selected{background-image:url(images/portrait_selected.png);}.plugin-config-app .preview-more .screen-switch-section .landscape.selected{background-image:url(images/landscape_selected.png);}.jimu-rtl .plugin-config-app .right-preview-section{left: 0; right: 400px;}.plugin-config-app .actions-pane{width: 100%; position: absolute; left: 0; right: 0; bottom: 0; height: 52px; background-color:#F3F3F3; font-size:14px;}.plugin-config-app .actions-pane .footer-button-box{height: 47px; font-family: Avenir Medium;}.plugin-config-app .actions-pane .seprate{width:1px; height: 35px; background-image:url(images/seprate.png); background-position: 0 20px; background-repeat:no-repeat;}.plugin-config-app .actions-pane .footer-button-arrow{width: 39px; height: 100%; background-image: url(images/arrow.png); background-position: 17px 25px; background-repeat: no-repeat; position: absolute; left: 360px; cursor: pointer; z-index: 10;}.jimu-rtl .plugin-config-app .actions-pane .footer-button-arrow{right: 360px; left: auto;}.plugin-config-app .actions-pane .footer-button-arrow .foot-menu{display: none; position: absolute; right: 1px; box-shadow: 0 0 4px #646464;}.jimu-rtl .plugin-config-app .actions-pane .footer-button-arrow .foot-menu{left: 1px; right: auto;}.plugin-config-app .actions-pane .footer-button-arrow .foot-menu div{display: block; height: 30px; line-height: 30px; padding-left: 25px; padding-right: 25px; cursor: pointer; white-space: nowrap; font-size: 14px; background-color: #fafafc; text-decoration: none; color: #4d4d4d;}.plugin-config-app .actions-pane .footer-button-arrow .foot-menu div:hover{background-color: #edf2f5; color: #24B5CC;}.plugin-config-app .actions-pane .footer-button-arrow .foot-menu div.disable{color: #d2dae2;}",
"url:builder/plugins/app-config-configpart/TabContainer2.html":'\x3cdiv\x3e\r\n  \x3cdiv data-dojo-attach-point\x3d"controlNode"\x3e\r\n    \x3ctable class\x3d"control-table"\x3e\r\n      \x3ctbody\x3e\r\n        \x3ctr data-dojo-attach-point\x3d"tabTr"\x3e\r\n        \x3c/tr\x3e\r\n      \x3c/tbody\x3e\r\n    \x3c/table\x3e\r\n  \x3c/div\x3e\r\n  \x3cdiv class\x3d"jimu-viewstack2" data-dojo-attach-point\x3d"containerNode"\x3e\x3c/div\x3e\r\n\x3c/div\x3e',"url:builder/plugins/app-config-configpart/Plugin.html":'\x3cdiv\x3e\r\n  \x3cdiv class\x3d"config-section" data-dojo-attach-point\x3d"configSection"\x3e\r\n    \x3cdiv class\x3d"tabs" data-dojo-attach-point\x3d"tabsNode"\x3e\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e\r\n\x3c/div\x3e\r\n',
"url:builder/plugins/app-config-configpart/css/style.css":'.plugin-appconfig-configpart{font-size: 20px; width: 400px; height: 100%; position: relative; box-shadow: 4px 0px 8px -4px rgba(0,0,0,0.4); z-index: 2;}.plugin-appconfig-configpart .config-section{width:100%; height:100%;}.jimu-tab2 .control-table{width: 100%; table-layout: fixed; background: #5E5E5E; border-collapse: collapse; font-size: 12px; text-align: center; color: #fff;}.jimu-tab2 .tab-item-div{position: relative; width: 100%; height: 80px; cursor: pointer; font-family: "Avenir Medium";}.jimu-tab2 .tab-item-div:hover{color: #fff; background-color: #444;}.jimu-tab2 .selected-tab-item-div{background-color: #24B5CC; background-size: 100% 100%; background-origin: content-box; background-repeat: no-repeat; font-family: "Avenir Medium"; color: #fff;}.jimu-tab2 .selected-tab-item-div:hover{background-color: #24B5CC;}.jimu-tab2 .tab-item-icon{display: inline-block; margin-left: auto; margin-right: auto; margin-top: 20px; margin-bottom: 6px; width: 24px; height: 24px; background-repeat: no-repeat; background-position: center center;}.jimu-tab2 .tab-item-title{width: 99%; margin: auto; white-space: pre-line; overflow: hidden; text-overflow: ellipsis; height: 16px;}.jimu-tab2 .jimu-viewstack2{background-color:#fff; position:absolute; left:0; right:0; top:80px; bottom:0; height:auto;}',
"url:builder/plugins/app-config-morepreview-selectionpart/Plugin.html":'\x3cdiv\x3e\r\n  \x3cdiv class\x3d"preview-section" data-dojo-attach-point\x3d"previewSection"\x3e\r\n    \x3cdiv class\x3d"preview-header"\x3e\r\n      \x3cdiv class\x3d"header-item size-section"\x3e\r\n        \x3ctable class\x3d"size-table"\x3e\r\n          \x3ccolgroup\x3e\r\n            \x3ccol width\x3d"25px"\x3e\x3c/col\x3e\r\n            \x3ccol width\x3d"auto"\x3e\x3c/col\x3e\r\n            \x3ccol width\x3d"10px"\x3e\x3c/col\x3e\r\n            \x3ccol width\x3d"86px"\x3e\x3c/col\x3e\r\n            \x3ccol width\x3d"20px"\x3e\x3c/col\x3e\r\n            \x3ccol width\x3d"auto"\x3e\x3c/col\x3e\r\n            \x3ccol width\x3d"10px"\x3e\x3c/col\x3e\r\n            \x3ccol width\x3d"86px"\x3e\x3c/col\x3e\r\n            \x3ccol width\x3d"25px"\x3e\x3c/col\x3e\r\n          \x3c/colgroup\x3e\r\n          \x3ctbody\x3e\r\n            \x3ctr\x3e\r\n              \x3ctd\x3e\x3c/td\x3e\r\n              \x3ctd\x3e\r\n                \x3cdiv class\x3d"width-tip jimu-ellipsis" title\x3d"${nls.width}"\x3e${nls.width}\x3c/div\x3e\r\n              \x3c/td\x3e\r\n              \x3ctd\x3e\x3c/td\x3e\r\n              \x3ctd\x3e\r\n                \x3cdiv class\x3d"pixel-div"\x3e\r\n                  \x3cinput class\x3d"jimu-float-leading" type\x3d"text" value\x3d"1024" data-dojo-attach-point\x3d"customWidth" /\x3e\r\n                  \x3cdiv class\x3d"jimu-float-leading pixel"\x3e Px \x3c/div\x3e\r\n                \x3c/div\x3e\r\n              \x3c/td\x3e\r\n              \x3ctd\x3e\x3c/td\x3e\r\n              \x3ctd\x3e\r\n                \x3cdiv class\x3d"height-tip jimu-ellipsis" title\x3d"${nls.height}"\x3e${nls.height}\x3c/div\x3e\r\n              \x3c/td\x3e\r\n              \x3ctd\x3e\x3c/td\x3e\r\n              \x3ctd\x3e\r\n                \x3cdiv class\x3d"pixel-div"\x3e\r\n                  \x3cinput class\x3d"jimu-float-leading" type\x3d"text" value\x3d"768"  data-dojo-attach-point\x3d"customHeight" /\x3e\r\n                  \x3cdiv class\x3d"jimu-float-leading pixel"\x3e Px \x3c/div\x3e\r\n                \x3c/div\x3e\r\n              \x3c/td\x3e\r\n              \x3ctd\x3e\x3c/td\x3e\r\n            \x3c/tr\x3e\r\n          \x3c/tbody\x3e\r\n        \x3c/table\x3e\r\n      \x3c/div\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv class\x3d"preview-body"\x3e\r\n      \x3cdiv class\x3d"preview-items-section"\x3e\r\n        \x3ctable\x3e\r\n          \x3ctbody data-dojo-attach-point\x3d"previewTbody"\x3e\r\n          \x3c/tbody\x3e\r\n        \x3c/table\x3e\r\n      \x3c/div\x3e\r\n      \x3cdiv class\x3d"preview-qrcode-section" \x3e\r\n        \x3cdiv class\x3d"qrcode-image jimu-float-leading" data-dojo-attach-point\x3d"qrcodeImage"\x3e\x3c/div\x3e\r\n        \x3cdiv class\x3d"qrcode-description jimu-float-leading" data-dojo-attach-point\x3d"qrcodeDescription"\x3e\x3c/div\x3e\r\n      \x3c/div\x3e\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e\r\n\x3c/div\x3e\r\n',
"url:builder/plugins/app-config-morepreview-selectionpart/css/style.css":".left-pane .plugin-appconfig-morepreview-selectionpart .preview-section{position:relative; width:100%; height:100%;}.left-pane .plugin-appconfig-morepreview-selectionpart .preview-section .preview-header{position: relative; width: 100%; height: 52px; background-color: #24B5CC;}.left-pane .plugin-appconfig-morepreview-selectionpart .preview-section .preview-header .header-item{position:absolute; top: 0; margin: auto; bottom:0;}.left-pane .plugin-appconfig-morepreview-selectionpart .preview-section .preview-header .size-section{width:100%; height: 32px; color:#444444;}.left-pane .plugin-appconfig-morepreview-selectionpart .preview-section .size-table{width: 100%; table-layout: fixed; border-collapse: collapse;}.left-pane .plugin-appconfig-morepreview-selectionpart .preview-section .size-table td *{height: 32px; line-height: 32px; text-align: center; font-size: 14px; color: #fff;}.left-pane .plugin-appconfig-morepreview-selectionpart .preview-section .size-table .width-tip{width: 100%;}.left-pane .plugin-appconfig-morepreview-selectionpart .preview-section .size-table .pixel-div{width: 110px; overflow: hidden;}.left-pane .plugin-appconfig-morepreview-selectionpart .preview-section .size-table .pixel-div input{width: 54px; color: #444444; border-style: none;}.left-pane .plugin-appconfig-morepreview-selectionpart .preview-section .size-table .pixel-div .pixel{width: 32px; text-align: center; margin: 0; color: white; background-color: #d2dae2;}.left-pane .plugin-appconfig-morepreview-selectionpart .preview-section .preview-body{position:absolute; width:100%; top: 52px; bottom:0; background-color: white;}.left-pane .plugin-appconfig-morepreview-selectionpart .preview-section .preview-body .operation-tip{font-size:14px; margin-left:22px; margin-top:28px;}.left-pane .plugin-appconfig-morepreview-selectionpart .preview-section .preview-body .preview-items-section{position:absolute; left:0; right:0; top:0; bottom:120px; overflow-x:hidden; overflow-y:auto;}.left-pane .plugin-appconfig-morepreview-selectionpart .preview-section .preview-qrcode-section{position: absolute; left: 2px; right: 2px; bottom: 0; height: 116px; border-top: 1px solid; border-color: #e3ecf2;}.left-pane .plugin-appconfig-morepreview-selectionpart .preview-section .preview-qrcode-section .qrcode-image{margin: 20px;}.left-pane .plugin-appconfig-morepreview-selectionpart .preview-section .preview-qrcode-section .qrcode-description{width: 277px; height: 100%; padding-top: 25px; font-size: 14px;}.left-pane .plugin-appconfig-morepreview-selectionpart .preview-section .preview-body .preview-items-section{padding-top: 10px;}.left-pane .plugin-appconfig-morepreview-selectionpart .preview-section .preview-body .preview-items-section table{width:370px; table-layout:fixed; margin-left: auto; margin-right: auto;}.left-pane .plugin-appconfig-morepreview-selectionpart .preview-section .preview-body .preview-items-section td{vertical-align:top; padding-top: 10px;}.left-pane .plugin-appconfig-morepreview-selectionpart .preview-section .preview-body .preview-items-section td .preview-item{margin-left: auto; margin-right: auto; width:74px;}.left-pane .plugin-appconfig-morepreview-selectionpart .preview-section .preview-body .preview-items-section td .preview-item-bg{position:relative; width:100%; height:74px; cursor:pointer; border:1px solid #ccc;}.left-pane .plugin-appconfig-morepreview-selectionpart .preview-section .preview-body .preview-items-section td .preview-item-bg.selected{border:3px solid #24B5CC;}.left-pane .plugin-appconfig-morepreview-selectionpart .preview-section .preview-body .preview-items-section td .preview-item-thumbnail{position:absolute; left:0; top:0; width:100%; height:100%; background-repeat:no-repeat; background-position:center center;}.left-pane .plugin-appconfig-morepreview-selectionpart .preview-section .preview-body .preview-items-section td .preview-selected-icon{display:none; position:absolute; left:41px; top:42px; width:30px; height:26px; background-color:rgba(0, 0, 0, 0.4); background-repeat:no-repeat; background-position:center center; background-image:url(images/check.png); -webkit-border-radius:3px; -moz-border-radius:3px; -o-border-radius:3px; -ms-border-radius:3px; border-radius:3px;}.left-pane .plugin-appconfig-morepreview-selectionpart .preview-section .iPhone6{background-image: url(images/preview/iPhone6.png);}.left-pane .plugin-appconfig-morepreview-selectionpart .preview-section .iPhone6-plus{background-image: url(images/preview/iPhone6_Plus.png);}.left-pane .plugin-appconfig-morepreview-selectionpart .preview-section .iPhone5{background-image:url(images/preview/iPhone5.png);}.left-pane .plugin-appconfig-morepreview-selectionpart .preview-section .iPhone4{background-image:url(images/preview/iPhone4.png);}.left-pane .plugin-appconfig-morepreview-selectionpart .preview-section .iPad-Air{background-image: url(images/preview/iPad_Air.png);}.left-pane .plugin-appconfig-morepreview-selectionpart .preview-section .iPad4{background-image: url(images/preview/iPad4.png);}.left-pane .plugin-appconfig-morepreview-selectionpart .preview-section .new-iPad{background-image:url(images/preview/iPad3.png);}.left-pane .plugin-appconfig-morepreview-selectionpart .preview-section .iPad-mini{background-image:url(images/preview/iPad-Mini.png);}.left-pane .plugin-appconfig-morepreview-selectionpart .preview-section .Samsung-Galaxy-S4{background-image: url(images/preview/Samsung_Galaxy_S4.png);}.left-pane .plugin-appconfig-morepreview-selectionpart .preview-section .Samsung-Note-3{background-image: url(images/preview/Samsung_Note_3.png);}.left-pane .plugin-appconfig-morepreview-selectionpart .preview-section .Nexus-5{background-image: url(images/preview/Nexus_5.png);}.left-pane .plugin-appconfig-morepreview-selectionpart .preview-section .Nexus-4{background-image: url(images/preview/Nexus_4.png);}.left-pane .plugin-appconfig-morepreview-selectionpart .preview-section .Nexus-7{background-image: url(images/preview/Nexus_7.png);}.left-pane .plugin-appconfig-morepreview-selectionpart .preview-section .htc-one{background-image: url(images/preview/HTC_One.png);}.left-pane .plugin-appconfig-morepreview-selectionpart .preview-section .xiaomi-3{background-image: url(images/preview/Xiaomi_3.png);}.left-pane .plugin-appconfig-morepreview-selectionpart .preview-section .LG-G2{background-image: url(images/preview/LG_G2.png);}.left-pane .plugin-appconfig-morepreview-selectionpart .preview-section .preview-body .preview-items-section td .preview-item-bg.selected .preview-selected-icon{display:none; left:38px;}.left-pane .plugin-appconfig-morepreview-selectionpart .preview-section .preview-body .preview-items-section td .preview-item-title{display:inline-block; width:100%; text-align:center; color:#666; font-size:12px; margin-top:10px; line-height: 13px;}",
"url:dijit/form/templates/CheckBox.html":'\x3cdiv class\x3d"dijit dijitReset dijitInline" role\x3d"presentation"\r\n\t\x3e\x3cinput\r\n\t \t${!nameAttrSetting} type\x3d"${type}" role\x3d"${type}" aria-checked\x3d"false" ${checkedAttrSetting}\r\n\t\tclass\x3d"dijitReset dijitCheckBoxInput"\r\n\t\tdata-dojo-attach-point\x3d"focusNode"\r\n\t \tdata-dojo-attach-event\x3d"ondijitclick:_onClick"\r\n/\x3e\x3c/div\x3e\r\n',"url:dijit/templates/Menu.html":'\x3ctable class\x3d"dijit dijitMenu dijitMenuPassive dijitReset dijitMenuTable" role\x3d"menu" tabIndex\x3d"${tabIndex}"\r\n\t   cellspacing\x3d"0"\x3e\r\n\t\x3ctbody class\x3d"dijitReset" data-dojo-attach-point\x3d"containerNode"\x3e\x3c/tbody\x3e\r\n\x3c/table\x3e\r\n',
"url:dijit/templates/MenuItem.html":'\x3ctr class\x3d"dijitReset" data-dojo-attach-point\x3d"focusNode" role\x3d"menuitem" tabIndex\x3d"-1"\x3e\r\n\t\x3ctd class\x3d"dijitReset dijitMenuItemIconCell" role\x3d"presentation"\x3e\r\n\t\t\x3cspan role\x3d"presentation" class\x3d"dijitInline dijitIcon dijitMenuItemIcon" data-dojo-attach-point\x3d"iconNode"\x3e\x3c/span\x3e\r\n\t\x3c/td\x3e\r\n\t\x3ctd class\x3d"dijitReset dijitMenuItemLabel" colspan\x3d"2" data-dojo-attach-point\x3d"containerNode,textDirNode"\r\n\t\trole\x3d"presentation"\x3e\x3c/td\x3e\r\n\t\x3ctd class\x3d"dijitReset dijitMenuItemAccelKey" style\x3d"display: none" data-dojo-attach-point\x3d"accelKeyNode"\x3e\x3c/td\x3e\r\n\t\x3ctd class\x3d"dijitReset dijitMenuArrowCell" role\x3d"presentation"\x3e\r\n\t\t\x3cspan data-dojo-attach-point\x3d"arrowWrapper" style\x3d"visibility: hidden"\x3e\r\n\t\t\t\x3cspan class\x3d"dijitInline dijitIcon dijitMenuExpand"\x3e\x3c/span\x3e\r\n\t\t\t\x3cspan class\x3d"dijitMenuExpandA11y"\x3e+\x3c/span\x3e\r\n\t\t\x3c/span\x3e\r\n\t\x3c/td\x3e\r\n\x3c/tr\x3e\r\n',
"url:dijit/templates/MenuSeparator.html":'\x3ctr class\x3d"dijitMenuSeparator" role\x3d"separator"\x3e\r\n\t\x3ctd class\x3d"dijitMenuSeparatorIconCell"\x3e\r\n\t\t\x3cdiv class\x3d"dijitMenuSeparatorTop"\x3e\x3c/div\x3e\r\n\t\t\x3cdiv class\x3d"dijitMenuSeparatorBottom"\x3e\x3c/div\x3e\r\n\t\x3c/td\x3e\r\n\t\x3ctd colspan\x3d"3" class\x3d"dijitMenuSeparatorLabelCell"\x3e\r\n\t\t\x3cdiv class\x3d"dijitMenuSeparatorTop dijitMenuSeparatorLabel"\x3e\x3c/div\x3e\r\n\t\t\x3cdiv class\x3d"dijitMenuSeparatorBottom"\x3e\x3c/div\x3e\r\n\t\x3c/td\x3e\r\n\x3c/tr\x3e\r\n',
"url:dijit/form/templates/Select.html":'\x3ctable class\x3d"dijit dijitReset dijitInline dijitLeft"\r\n\tdata-dojo-attach-point\x3d"_buttonNode,tableNode,focusNode,_popupStateNode" cellspacing\x3d\'0\' cellpadding\x3d\'0\'\r\n\trole\x3d"listbox" aria-haspopup\x3d"true"\r\n\t\x3e\x3ctbody role\x3d"presentation"\x3e\x3ctr role\x3d"presentation"\r\n\t\t\x3e\x3ctd class\x3d"dijitReset dijitStretch dijitButtonContents" role\x3d"presentation"\r\n\t\t\t\x3e\x3cdiv class\x3d"dijitReset dijitInputField dijitButtonText"  data-dojo-attach-point\x3d"containerNode,textDirNode" role\x3d"presentation"\x3e\x3c/div\r\n\t\t\t\x3e\x3cdiv class\x3d"dijitReset dijitValidationContainer"\r\n\t\t\t\t\x3e\x3cinput class\x3d"dijitReset dijitInputField dijitValidationIcon dijitValidationInner" value\x3d"\x26#935; " type\x3d"text" tabIndex\x3d"-1" readonly\x3d"readonly" role\x3d"presentation"\r\n\t\t\t/\x3e\x3c/div\r\n\t\t\t\x3e\x3cinput type\x3d"hidden" ${!nameAttrSetting} data-dojo-attach-point\x3d"valueNode" value\x3d"${value}" aria-hidden\x3d"true"\r\n\t\t/\x3e\x3c/td\r\n\t\t\x3e\x3ctd class\x3d"dijitReset dijitRight dijitButtonNode dijitArrowButton dijitDownArrowButton dijitArrowButtonContainer"\r\n\t\t\tdata-dojo-attach-point\x3d"titleNode" role\x3d"presentation"\r\n\t\t\t\x3e\x3cinput class\x3d"dijitReset dijitInputField dijitArrowButtonInner" value\x3d"\x26#9660; " type\x3d"text" tabIndex\x3d"-1" readonly\x3d"readonly" role\x3d"presentation"\r\n\t\t\t\t${_buttonInputDisabled}\r\n\t\t/\x3e\x3c/td\r\n\t\x3e\x3c/tr\x3e\x3c/tbody\r\n\x3e\x3c/table\x3e\r\n',
"url:esri/dijit/ColorPicker/templates/ColorPicker.html":'\x3cdiv class\x3d"${css.container}"\x3e\r\n  \x3cdiv class\x3d"${css.header}" data-dojo-attach-point\x3d"dap_header"\x3e\r\n    \x3cspan class\x3d"${css.swatchPreview} ${css.container}"\x3e\r\n      \x3cspan class\x3d"${css.swatch} ${css.swatchTransparencyBackground}"\x3e\x3c/span\x3e\r\n      \x3cspan data-dojo-attach-point\x3d"dap_previewSwatch" class\x3d"${css.swatch}"\x3e\x3c/span\x3e\r\n    \x3c/span\x3e\r\n  \x3c/div\x3e\r\n  \x3cdiv class\x3d"${css.middle}"\x3e\r\n    \x3cdiv data-dojo-attach-point\x3d"dap_paletteContainer" class\x3d"${css.palette} ${css.container}"\x3e\r\n      \x3cdiv data-dojo-attach-point\x3d"dap_primaryPalette" class\x3d"${css.palette}"\x3e\x3c/div\x3e\x3c!--\r\n      --\x3e\x3cdiv data-dojo-attach-point\x3d"dap_secondaryPalette" class\x3d"${css.palette}"\x3e\x3c/div\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv class\x3d"${css.paletteOptions}"\x3e\r\n      \x3cinput type\x3d"text" data-dojo-type\x3d"dijit/form/TextBox" data-dojo-attach-point\x3d"dap_hexInput" class\x3d"${css.hexInput}"/\x3e\r\n      \x3cinput class\x3d"${css.paletteToggle}" type\x3d"button" data-dojo-type\x3d"dijit/form/ToggleButton" data-dojo-attach-point\x3d"dap_paletteToggle" label\x3d"${labels.more}"/\x3e\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e\r\n  \x3cdiv class\x3d"${css.footer}" data-dojo-attach-point\x3d"dap_footer"\x3e\r\n    \x3cdiv class\x3d"${css.section}" data-dojo-attach-point\x3d"dap_suggestedColorSection"\x3e\r\n      \x3cdiv class\x3d"${css.label}"\x3e${labels.suggested}\x3c/div\x3e\r\n      \x3cdiv data-dojo-attach-point\x3d"dap_suggestedColorPalette" class\x3d"${css.suggested} ${css.palette} ${css.swatchRow}"\x3e\x3c/div\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv class\x3d"${css.section}" data-dojo-attach-point\x3d"dap_recentColorSection"\x3e\r\n      \x3cdiv class\x3d"${css.label}"\x3e${labels.recent}\x3c/div\x3e\r\n      \x3cdiv data-dojo-attach-point\x3d"dap_recentColorPalette" class\x3d"${css.recent} ${css.palette} ${css.swatchRow}"\x3e\x3c/div\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv class\x3d"${css.section}" data-dojo-attach-point\x3d"dap_transparencySection"\x3e\r\n      \x3cdiv data-dojo-attach-point\x3d"dap_transparencyLabel" class\x3d"${css.label}"\x3e${labels.transparency}\x3c/div\x3e\r\n      \x3cdiv class\x3d"${css.transparencySlider}"\r\n           data-dojo-attach-point\x3d"dap_transparencySlider"\r\n           data-dojo-type\x3d"esri/dijit/HorizontalSlider"\r\n           data-dojo-props\x3d"minimum: 0, maximum: 1, discreteValues: 100, labels: [\'0%\', \'50%\', \'100%\']"\x3e\r\n      \x3c/div\x3e\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e\r\n\x3c/div\x3e\r\n',
"url:dijit/form/templates/HorizontalSlider.html":'\x3ctable class\x3d"dijit dijitReset dijitSlider dijitSliderH" cellspacing\x3d"0" cellpadding\x3d"0" border\x3d"0" rules\x3d"none" data-dojo-attach-event\x3d"onkeydown:_onKeyDown, onkeyup:_onKeyUp"\r\n\trole\x3d"presentation"\r\n\t\x3e\x3ctr class\x3d"dijitReset"\r\n\t\t\x3e\x3ctd class\x3d"dijitReset" colspan\x3d"2"\x3e\x3c/td\r\n\t\t\x3e\x3ctd data-dojo-attach-point\x3d"topDecoration" class\x3d"dijitReset dijitSliderDecoration dijitSliderDecorationT dijitSliderDecorationH"\x3e\x3c/td\r\n\t\t\x3e\x3ctd class\x3d"dijitReset" colspan\x3d"2"\x3e\x3c/td\r\n\t\x3e\x3c/tr\r\n\t\x3e\x3ctr class\x3d"dijitReset"\r\n\t\t\x3e\x3ctd class\x3d"dijitReset dijitSliderButtonContainer dijitSliderButtonContainerH"\r\n\t\t\t\x3e\x3cdiv class\x3d"dijitSliderDecrementIconH" style\x3d"display:none" data-dojo-attach-point\x3d"decrementButton"\x3e\x3cspan class\x3d"dijitSliderButtonInner"\x3e-\x3c/span\x3e\x3c/div\r\n\t\t\x3e\x3c/td\r\n\t\t\x3e\x3ctd class\x3d"dijitReset"\r\n\t\t\t\x3e\x3cdiv class\x3d"dijitSliderBar dijitSliderBumper dijitSliderBumperH dijitSliderLeftBumper" data-dojo-attach-event\x3d"press:_onClkDecBumper"\x3e\x3c/div\r\n\t\t\x3e\x3c/td\r\n\t\t\x3e\x3ctd class\x3d"dijitReset"\r\n\t\t\t\x3e\x3cinput data-dojo-attach-point\x3d"valueNode" type\x3d"hidden" ${!nameAttrSetting}\r\n\t\t\t/\x3e\x3cdiv class\x3d"dijitReset dijitSliderBarContainerH" role\x3d"presentation" data-dojo-attach-point\x3d"sliderBarContainer"\r\n\t\t\t\t\x3e\x3cdiv role\x3d"presentation" data-dojo-attach-point\x3d"progressBar" class\x3d"dijitSliderBar dijitSliderBarH dijitSliderProgressBar dijitSliderProgressBarH" data-dojo-attach-event\x3d"press:_onBarClick"\r\n\t\t\t\t\t\x3e\x3cdiv class\x3d"dijitSliderMoveable dijitSliderMoveableH"\r\n\t\t\t\t\t\t\x3e\x3cdiv data-dojo-attach-point\x3d"sliderHandle,focusNode" class\x3d"dijitSliderImageHandle dijitSliderImageHandleH" data-dojo-attach-event\x3d"press:_onHandleClick" role\x3d"slider"\x3e\x3c/div\r\n\t\t\t\t\t\x3e\x3c/div\r\n\t\t\t\t\x3e\x3c/div\r\n\t\t\t\t\x3e\x3cdiv role\x3d"presentation" data-dojo-attach-point\x3d"remainingBar" class\x3d"dijitSliderBar dijitSliderBarH dijitSliderRemainingBar dijitSliderRemainingBarH" data-dojo-attach-event\x3d"press:_onBarClick"\x3e\x3c/div\r\n\t\t\t\x3e\x3c/div\r\n\t\t\x3e\x3c/td\r\n\t\t\x3e\x3ctd class\x3d"dijitReset"\r\n\t\t\t\x3e\x3cdiv class\x3d"dijitSliderBar dijitSliderBumper dijitSliderBumperH dijitSliderRightBumper" data-dojo-attach-event\x3d"press:_onClkIncBumper"\x3e\x3c/div\r\n\t\t\x3e\x3c/td\r\n\t\t\x3e\x3ctd class\x3d"dijitReset dijitSliderButtonContainer dijitSliderButtonContainerH"\r\n\t\t\t\x3e\x3cdiv class\x3d"dijitSliderIncrementIconH" style\x3d"display:none" data-dojo-attach-point\x3d"incrementButton"\x3e\x3cspan class\x3d"dijitSliderButtonInner"\x3e+\x3c/span\x3e\x3c/div\r\n\t\t\x3e\x3c/td\r\n\t\x3e\x3c/tr\r\n\t\x3e\x3ctr class\x3d"dijitReset"\r\n\t\t\x3e\x3ctd class\x3d"dijitReset" colspan\x3d"2"\x3e\x3c/td\r\n\t\t\x3e\x3ctd data-dojo-attach-point\x3d"containerNode,bottomDecoration" class\x3d"dijitReset dijitSliderDecoration dijitSliderDecorationB dijitSliderDecorationH"\x3e\x3c/td\r\n\t\t\x3e\x3ctd class\x3d"dijitReset" colspan\x3d"2"\x3e\x3c/td\r\n\t\x3e\x3c/tr\r\n\x3e\x3c/table\x3e\r\n',
"url:dijit/form/templates/DropDownButton.html":'\x3cspan class\x3d"dijit dijitReset dijitInline"\r\n\t\x3e\x3cspan class\x3d\'dijitReset dijitInline dijitButtonNode\'\r\n\t\tdata-dojo-attach-event\x3d"ondijitclick:__onClick" data-dojo-attach-point\x3d"_buttonNode"\r\n\t\t\x3e\x3cspan class\x3d"dijitReset dijitStretch dijitButtonContents"\r\n\t\t\tdata-dojo-attach-point\x3d"focusNode,titleNode,_arrowWrapperNode,_popupStateNode"\r\n\t\t\trole\x3d"button" aria-haspopup\x3d"true" aria-labelledby\x3d"${id}_label"\r\n\t\t\t\x3e\x3cspan class\x3d"dijitReset dijitInline dijitIcon"\r\n\t\t\t\tdata-dojo-attach-point\x3d"iconNode"\r\n\t\t\t\x3e\x3c/span\r\n\t\t\t\x3e\x3cspan class\x3d"dijitReset dijitInline dijitButtonText"\r\n\t\t\t\tdata-dojo-attach-point\x3d"containerNode"\r\n\t\t\t\tid\x3d"${id}_label"\r\n\t\t\t\x3e\x3c/span\r\n\t\t\t\x3e\x3cspan class\x3d"dijitReset dijitInline dijitArrowButtonInner"\x3e\x3c/span\r\n\t\t\t\x3e\x3cspan class\x3d"dijitReset dijitInline dijitArrowButtonChar"\x3e\x26#9660;\x3c/span\r\n\t\t\x3e\x3c/span\r\n\t\x3e\x3c/span\r\n\t\x3e\x3cinput ${!nameAttrSetting} type\x3d"${type}" value\x3d"${value}" class\x3d"dijitOffScreen" tabIndex\x3d"-1"\r\n\t\tdata-dojo-attach-event\x3d"onclick:_onClick" data-dojo-attach-point\x3d"valueNode" aria-hidden\x3d"true"\r\n/\x3e\x3c/span\x3e\r\n',
"url:builder/plugins/app-config-template-configpart/Plugin.html":'\x3cdiv\x3e\r\n  \x3cdiv class\x3d"header-line"\x3e\x3c/div\x3e\r\n  \x3cdiv class\x3d"head-part"\x3e\r\n    \x3cdiv class\x3d"decorator"\x3e\x3c/div\x3e\r\n    \x3cdiv class\x3d"description data-dojo-attach-point\x3d"description"" \x3e${nls.description}\x3c/div\x3e\r\n  \x3c/div\x3e\r\n  \x3cdiv class\x3d"config-part-box"\x3e\r\n    \x3cdiv class\x3d"config-part" data-dojo-attach-point\x3d"configPart"\x3e\r\n      \x3cdiv class\x3d"map-category"\x3e\r\n        \x3cdiv class\x3d"map-title" data-dojo-attach-point\x3d"mapTitle"\x3e${nls.map}\x3c/div\x3e\r\n        \x3cdiv class\x3d"select-part"\x3e\r\n          \x3cdiv class\x3d"jimu-btn select-map" data-dojo-attach-point\x3d"selectMapBtn" data-dojo-attach-event\x3d"click:_onSelectMapClick"\x3e${nls.changeWebMap}\x3c/div\x3e\r\n          \x3cdiv class\x3d"map-name" data-dojo-attach-point\x3d"mapName"\x3e\x3c/div\x3e\r\n        \x3c/div\x3e\r\n      \x3c/div\x3e\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e\r\n  \x3cdiv class\x3d"control-part" data-dojo-attach-point\x3d"controlPart"\x3e\x3c/div\x3e\r\n\x3c/div\x3e\r\n',
"url:builder/plugins/app-config-template-configpart/css/style.css":".plugin-appconfig-template-configpart {background-color: #ffffff; font-size: 12px; overflow-y: auto;}.plugin-appconfig-template-configpart .header-line {width: 100%; position: absolute; border-style: none none solid none; border-width: 1px; box-shadow: 0px 0px 6px rgba(0,0,0,0.4); border-color: rgba(0,0,0,0.0); display: none;}.plugin-appconfig-template-configpart .head-part {position: absolute; top: 0; height: 80px; background-color: #f3f3f3; width: 100%; z-index: 1;}.plugin-appconfig-template-configpart .head-part .decorator {height: 16px; background-color: #24B5CC;}.plugin-appconfig-template-configpart .head-part .description {height: 58px; padding-top: 18px; color: #666666; font-size: 14px; width: 90%; margin: 0 auto;}.plugin-appconfig-template-configpart .config-part-box {width: 100%; overflow: auto; height: 100%;}.plugin-appconfig-template-configpart .config-part {width: 90%; height: 100%; margin: 0 auto; padding-top: 80px;}.plugin-appconfig-template-configpart .config-part .map-category .map-title{border-bottom: 1px solid #eaeaea; margin: 12px 0 10px 0; font-weight: bold; font-size: 14px; color: #565656; padding-bottom: 0.3em;}.plugin-appconfig-template-configpart .config-part .map-category {overflow: hidden;}.plugin-appconfig-template-configpart .config-part .map-category .select-map{padding: 0 15px; font-size: 14px; line-height: 33px; text-align: center; color: #ffffff; float: left; max-width: 50%;}.plugin-appconfig-template-configpart .config-part .map-category .map-name{margin-top: 10px; color: #596679; font-size: 12px; max-width: 100%; white-space: nowrap; text-overflow: ellipsis; overflow: hidden; float: right; width: 50%;}",
"url:builder/dijit/template-config/templates/Template.html":'\x3cdiv\x3e\r\n\r\n    \x3cdiv class\x3d"content-part" data-dojo-attach-point\x3d"contentPart"\x3e\r\n      \x3cdiv class\x3d"tree-part jimu-float-leading" data-dojo-attach-point\x3d"treePart"\x3e\r\n        \x3cdiv class\x3d"left-part-title"\x3e${nls.appProperties}\x3c/div\x3e\r\n      \x3c/div\x3e\r\n\r\n      \x3cdiv class\x3d"right-part jimu-float-leading" data-dojo-attach-point\x3d"leftPart"\x3e\r\n        \x3cdiv class\x3d"right-part-content"\x3e\r\n          \x3cdiv class\x3d"right-part-head" \x3e\r\n            \x3cspan data-dojo-attach-point\x3d"rightPartHeadText"\x3e${nls.rightPartHead}\x3c/span\x3e\r\n            \x3cdiv class\x3d"review-json-div" data-dojo-attach-point\x3d"reviewJsonDiv" data-dojo-attach-event\x3d"onclick:_onReviewJsonDivClick" style\x3d"display:none"\x3e${nls.viewJsonCode}\x3c/div\x3e\r\n            \x3cdiv class\x3d"review-json-back-div" style\x3d"display: none" data-dojo-attach-point\x3d"reviewJsonBackDiv" data-dojo-attach-event\x3d"onclick:_onReviewJsonBackDivClick"\x3e${nls.viewJsonBack}\x3c/div\x3e\r\n          \x3c/div\x3e\r\n\r\n          \x3cdiv class\x3d"right-part-subhead"\x3e\r\n            ${nls.rightPartSubhead}\r\n          \x3c/div\x3e\r\n          \x3cdiv class\x3d"category-part" data-dojo-attach-point\x3d"categoryPart"\x3e\x3c/div\x3e\r\n          \x3cdiv class\x3d"show-json-div" data-dojo-attach-point\x3d"showJsonDiv"\x3e\r\n            \x3cdiv class\x3d"show-json-content-div" data-dojo-attach-point\x3d"showJsonContentDiv"\x3e\r\n            \x3c/div\x3e\r\n          \x3c/div\x3e\r\n        \x3c/div\x3e\r\n      \x3c/div\x3e\r\n    \x3c/div\x3e\r\n\x3c/div\x3e\r\n',
"url:builder/dijit/template-config/templates/Export.html":'\x3cdiv\x3e\r\n  \x3cp style\x3d"display:block;" class\x3d"message-div" data-dojo-attach-point\x3d"templateTitle"\x3e${nls.templateTitle}\x3c/p\x3e\r\n  \x3cp style\x3d"display:none;" class\x3d"message-div" data-dojo-attach-point\x3d"message1"\x3e\x3c/p\x3e\r\n  \x3cdiv style\x3d"display:none;" class\x3d"explain-div" data-dojo-attach-point\x3d"explain1"\x3e\x3c/div\x3e\r\n\r\n  \x3cdiv class\x3d"item-info-box" data-dojo-attach-point\x3d"itemInfoBox" \x3e\r\n  \x3c/div\x3e\r\n\x3c/div\x3e',
"url:builder/dijit/template-config/templates/ExportMessage.html":'\x3cdiv\x3e\r\n    \x3cdiv class\x3d"element resMessage" data-dojo-attach-point\x3d"resMessage"\x3e\x3c/div\x3e\r\n    \x3c!--div class\x3d"element" data-dojo-attach-point\x3d"message1"\x3e\x3c/div--\x3e\r\n    \x3cdiv class\x3d"element itemLink"\x3e\r\n      \x3cspan data-dojo-attach-point\x3d"word1" \x3e\x3c/span\x3e\r\n      \x3ca class\x3d"download-a" target\x3d"_blank" data-dojo-attach-point\x3d"itemLink"\x3e\x3c/a\x3e\r\n      \x3cspan data-dojo-attach-point\x3d"word2" \x3e\x3c/span\x3e\r\n    \x3c/div\x3e\r\n\x3c/div\x3e',
"url:builder/dijit/templates/ItemInfo.html":'\x3cdiv\x3e\r\n        \x3cdiv\x3e\r\n          \x3ctable style\x3d"width:100%" cellspacing\x3d"6"\x3e\r\n            \x3ctbody\x3e\r\n              \x3ctr\x3e\r\n                \x3ctd class\x3d"label-tr" width\x3d"10%"\x3e\r\n                  \x3clabel for\x3d"publish-webmap-name"\x3e\r\n                    ${nls.nameLabel}\r\n                  \x3c/label\x3e\r\n                \x3c/td\x3e\r\n                \x3ctd width\x3d"90%"\x3e\r\n                  \x3cdiv id\x3d"publish-webmap-name" data-dojo-type\x3d"dijit/form/TextBox" trim\x3d"true" data-dojo-attach-point\x3d"appName" maxlength\x3d"250" required\x3d"true" style\x3d"width:95%;padding:2px;"\x3e\r\n                  \x3c/div\x3e\r\n                \x3c/td\x3e\r\n              \x3c/tr\x3e\r\n\r\n              \x3ctr data-dojo-attach-point\x3d"tagsTr"\x3e\r\n                \x3ctd class\x3d"label-tr"\x3e\r\n                  \x3clabel for\x3d"publish-webmap-tags"\x3e\r\n                    ${nls.tagsLabel}\r\n                  \x3c/label\x3e\r\n                \x3c/td\x3e\r\n                \x3ctd\x3e\r\n                  \x3cdiv id\x3d"publish-webmap-tags" data-dojo-type\x3d"builder/dijit/Tags" data-dojo-attach-point\x3d"tags" style\x3d"width:95%;max-width:95%;"\x3e\x3c/div\x3e\r\n                \x3c/td\x3e\r\n              \x3c/tr\x3e\r\n\r\n              \x3ctr\x3e\r\n                \x3ctd class\x3d"label-tr" valign\x3d"top"\x3e\r\n                  \x3clabel for\x3d"publish-webmap-summary"\x3e\r\n                    ${nls.summaryLabel}\r\n                  \x3c/label\x3e\r\n                \x3c/td\x3e\r\n                \x3ctd\x3e\r\n                  \x3cdiv id\x3d"publish-webmap-summary" data-dojo-type\x3d"dijit/form/SimpleTextarea" rows\x3d\'5\' trim\x3d"true" maxlength\x3d"250" required\x3d"true" style\x3d"width:95%;max-width:95%;min-width:95%;height:200px;max-height:200px;min-height:200px;padding:2px;resize:none;"\x3e\x3c/div\x3e\r\n                \x3c/td\x3e\r\n              \x3c/tr\x3e\r\n\r\n              \x3ctr data-dojo-attach-point\x3d"thumbnailTr"\x3e\r\n                \x3ctd class\x3d"label-tr"\x3e\r\n                  \x3clabel for\x3d"publish-webmap-thumbnail"\x3e\r\n                    ${nls.thumbnailLabel}\r\n                  \x3c/label\x3e\r\n                \x3c/td\x3e\r\n                \x3ctd\x3e\r\n                  \x3cdiv class\x3d"image-chooser-base" id\x3d"publish-webmap-thumbnail" data-dojo-attach-point\x3d"imageChooserBase"\x3e\x3c/div\x3e\r\n                \x3c/td\x3e\r\n              \x3c/tr\x3e\r\n\r\n              \x3ctr data-dojo-attach-point\x3d"folderTr"\x3e\r\n                \x3ctd class\x3d"label-tr"\x3e\r\n                  \x3clabel for\x3d"publish-webmap-folder"\x3e\r\n                    ${nls.saveFolderLabel}\r\n                  \x3c/label\x3e\r\n                \x3c/td\x3e\r\n                \x3ctd\x3e\r\n                  \x3cdiv id\x3d"publish-webmap-folder" data-dojo-type\x3d"dijit/form/Select" style\x3d"width:96%;"\x3e\r\n                  \x3c/div\x3e\r\n                \x3c/td\x3e\r\n              \x3c/tr\x3e\r\n              \x3ctr data-dojo-attach-point\x3d"sharingTr"\x3e\r\n                \x3ctd\x3e\x26nbsp;\x3c/td\x3e\r\n                \x3ctd\x3e\r\n                  \x3cdiv id\x3d"publish-webmap-sharing" data-dojo-type\x3d"dijit/form/CheckBox" checked\x3e\x3c/div\x3e\r\n                  \x3clabel for\x3d"publish-webmap-sharing"\x3e${nls.shareSameLevel}\x3c/label\x3e\r\n                \x3c/td\x3e\r\n              \x3c/tr\x3e\r\n            \x3c/tbody\x3e\r\n          \x3c/table\x3e\r\n        \x3c/div\x3e\r\n\x3c/div\x3e\r\n',
"url:builder/dijit/templates/Tags.html":'\x3cdiv class\x3d"${baseClass}" style\x3d"outline:none;"\x3e\x3c/div\x3e\r\n',"url:jimu/dijit/templates/ImageChooser.html":'\x3cdiv class\x3d"jimu-image-chooser js-fileapi-wrapper"\x3e\r\n  \x3cdiv class\x3d"hint" data-dojo-attach-point\x3d"hintText"\x3e\r\n\t\t\x3cspan class\x3d"display-text" data-dojo-attach-point\x3d"displayText"\x3e\x3c/span\x3e\r\n  \x3c/div\x3e\r\n  \x3cdiv class\x3d"hint" data-dojo-attach-point\x3d"hintImage"\x3e\r\n\t\t\x3cimg class\x3d"display-image" data-dojo-attach-point\x3d"selfImg"\x3e\r\n  \x3c/div\x3e\r\n  \x3cform data-dojo-attach-point\x3d"fileForm"\x3e\r\n    \x3clabel data-dojo-attach-point\x3d"mask"\x3e\x3c/label\x3e\r\n    \x3cinput type\x3d"file" data-dojo-attach-point\x3d"fileInput"\x3e\r\n  \x3c/form\x3e\r\n\x3c/div\x3e',
"url:jimu/dijit/templates/_CropImage.html":'\x3cdiv class\x3d"jimu-crop-image"\x3e\r\n\t\x3cdiv class\x3d"crop-section" data-dojo-attach-point\x3d"cropSection"\x3e\r\n\t\t\x3cdiv class\x3d"viewer-box hide-status" data-dojo-attach-point\x3d"viewerBox"\x3e\r\n\t\t\t\x3cdiv class\x3d"viewer-content" data-dojo-attach-point\x3d"viewerContent"\x3e\r\n\t\t\t\t\x3cimg class\x3d"viewer-image hide-status" data-dojo-attach-point\x3d"viewerImage" src\x3d""\x3e\r\n\t\t\t\x3c/div\x3e\r\n\t\t\t\x3cimg class\x3d"base-image hide-status" data-dojo-attach-point\x3d"baseImage" data-dojo-attach-event\x3d"mousedown:_onViewerMouseDown,mouseup:_onViewerMouseUp"\x3e\r\n\t\t\x3c/div\x3e\r\n\t\t\x3cimg class\x3d"loading-image" data-dojo-attach-point\x3d"loadingImg" src\x3d""\x3e\r\n\t\x3c/div\x3e\r\n\t\x3cdiv class\x3d"controller hide-status" data-dojo-attach-point\x3d"zoomController"\x3e\r\n\t\t\x3cdiv class\x3d"zoom-out" data-dojo-attach-point\x3d"zoomOutBtn" data-dojo-attach-event\x3d"click:_onZoomOutClick"\x3e-\x3c/div\x3e\r\n\t\t\x3cdiv class\x3d"slider" data-dojo-attach-point\x3d"sliderNode"\x3e\r\n\t\t\t\x3cdiv class\x3d"button" data-dojo-attach-point\x3d"sliderButton" data-dojo-attach-event\x3d"mousedown:_onSliderMouseDown,mouseup:_onSliderMouseUp"\x3e\x3c/div\x3e\r\n\t\t\t\x3cdiv class\x3d"horizontal"\x3e\x3c/div\x3e\r\n\t\t\x3c/div\x3e\r\n\t\t\x3cdiv class\x3d"zoom-in" data-dojo-attach-point\x3d"zoomInBtn" data-dojo-attach-event\x3d"click:_onZoomInClick"\x3e+\x3c/div\x3e\r\n\t\x3c/div\x3e\r\n\x3c/div\x3e\r\n',
"url:builder/plugins/app-config-templateconfig/Plugin.html":'\x3cdiv \x3e\r\n  \x3cdiv class\x3d"header-line"\x3e\x3c/div\x3e\r\n  \x3cdiv class\x3d"left-part jimu-float-leading"\x3e\r\n    \x3cdiv class\x3d"config-panel" data-dojo-attach-point\x3d"configPanel"\x3e\x3c/div\x3e\r\n    \x3cdiv class\x3d"action-panel"\x3e\r\n      \r\n      \x3cdiv class\x3d"to-app-btn jimu-float-leading" title\x3d"${nls.toConfigApp}" data-dojo-attach-event\x3d"onclick:_onToAppClick" \x3e${nls.toConfigApp}\x3c/div\x3e\r\n      \x3cdiv class\x3d"save-btn jimu-float-trailing" data-dojo-attach-point\x3d"savePluginNode"\x3e\x3c/div\x3e\r\n      \x3cdiv class\x3d"separate jimu-float-trailing"\x3e\x3c/div\x3e\r\n    \x3c/div\x3e    \r\n  \x3c/div\x3e\r\n\r\n \x3cdiv class\x3d"preview-panel jimu-float-leading" \x3e\r\n    \x3cdiv class\x3d"preview-content" data-dojo-attach-point\x3d"previewPanel"\x3e\r\n    \x3c/div\x3e\r\n \x3c/div\x3e\r\n\r\n\x3c/div\x3e',
"url:builder/plugins/app-config-templateconfig/css/style.css":".plugin-config-template {background-color: #ffffff; position: relative;}.plugin-config-template .header-line{width: 100%; position: absolute; border-style: none none solid none; border-width: 1px; box-shadow: 0px 0px 6px rgba(0,0,0,0.4); border-color: rgba(0,0,0,0.0);}.plugin-config-template .left-part{width: 60%; height: 100%; position: relative; box-shadow: 0px 0px 8px rgba(0,0,0,0.4);}.plugin-config-template .config-panel{position: absolute; left: 0; right: 0; top: 0; bottom: 50px; box-shadow: 0px 0px 8px rgba(0,0,0,0.4); z-index: 2;}.plugin-config-template .action-panel{width: 100%; position: absolute; left: 0; right: 0; bottom: 0; height: 52px; background-color: #F3F3F3; font-size: 14px;}.plugin-config-template .action-panel .to-app-btn{background-image: url(../../../../stemapp/jimu.js/css/images/setting_disabled.png); height: 100%; line-height: 52px; padding-left: 50px; background-repeat: no-repeat; background-position: 25px center; cursor: pointer;}.jimu-rtl .plugin-config-template .action-panel .to-app-btn{padding-right: 50px; padding-left: auto; background-position: right 25px center;}.plugin-config-template .action-panel .to-app-btn:hover{background-image: url(../../../../stemapp/jimu.js/css/images/setting_hover.png); color: #15a4fa;}.plugin-config-template .action-panel .separate{border: 1px solid #a3a3a3; height: 20px; margin-top: 16px;}.plugin-config-template .action-panel .save-btn{margin-right: 40px; margin-left: 40px;}.plugin-config-template .preview-panel{width: 40%; height: 100%; overflow-y: auto; overflow-x: hidden; -ms-overflow-y: auto; -ms-overflow-x: hidden;}.plugin-config-template .preview-panel .preview-content{width: 80%; margin: 0 auto; min-width: 300px;}",
"url:builder/plugins/app-list/Plugin.html":'\x3cdiv\x3e\r\n  \x3c!--header\x3e\x3c--\x3e\r\n  \x3cdiv class\x3d"header" data-dojo-attach-point\x3d"header"\x3e\r\n    \x3cdiv class\x3d"navigator-box" data-dojo-attach-point\x3d"navigatorBox"\x3e\r\n      \x3c!--div class\x3d"switch-app" style\x3d"float: left; cursor: pointer; margin-right: 5px" data-dojo-attach-point\x3d"switchApps"  data-dojo-attach-event\x3d"onclick:_onSwitchToAppContent"\x3eapps\x3c/div\x3e\r\n      \x3cdiv class\x3d"switch-template" style\x3d"float: left; cursor: pointer;" data-dojo-attach-point\x3d"switchTemplates" data-dojo-attach-event\x3d"onclick:_onSwitchToTemplateContent"\x3etempaltes\x3c/div--\x3e    \r\n      \x3cdiv class\x3d"navigator" data-dojo-attach-point\x3d"navigator"\x3e\r\n        \x3cdiv class\x3d"filter-box jimu-float-leading" data-dojo-attach-point\x3d"filterBox"\x3e\r\n          \x3cdiv class\x3d"filter all selected jimu-float-leading" id\x3d"ALL" data-dojo-attach-point\x3d"filterAllBtn" data-dojo-attach-event\x3d"onclick:_filterAllBtnClick"\x3e${nls.all}\x3c/div\x3e\r\n          \x3cdiv class\x3d"filter 2d jimu-float-leading" id\x3d"HTML" data-dojo-attach-point\x3d"filter2dBtn" data-dojo-attach-event\x3d"onclick:_filter2dBtnClick"\x3e${nls.d2}\x3c/div\x3e\r\n          \x3cdiv class\x3d"filter 3d jimu-float-leading" id\x3d"HTML3D" data-dojo-attach-point\x3d"filter3dBtn" data-dojo-attach-event\x3d"onclick:_filter3dBtnClick"\x3e${nls.d3}\x3c/div\x3e\r\n        \x3c/div\x3e\r\n        \x3cdiv class\x3d"search jimu-float-trailing" data-dojo-attach-point\x3d"search"\x3e\r\n          \x3cdiv class\x3d"search-box jimu-float-leading" data-dojo-type\x3d"dijit/form/TextBox" data-dojo-attach-point\x3d"searchBox" trim\x3d"true" maxlength\x3d"250" required\x3d"true" placeholder\x3d${nls.searchPlaceholder} data-dojo-attach-event\x3d"onKeyUp:_onSearchBoxChange"\x3e\x3c/div\x3e\r\n          \x3cdiv class\x3d"search-btn jimu-float-leading" data-dojo-attach-point\x3d"searchBtn"\x3e\x3c/div\x3e\r\n        \x3c/div\x3e\r\n        \x3cdiv class\x3d"sort-box jimu-float-trailing" data-dojo-attach-point\x3d"sortBox"\x3e\r\n          \x3cdiv class\x3d"sort by-modified-time selected jimu-float-leading" id\x3d"lastUpdated" data-dojo-attach-point\x3d"sortByModifiedTimeBtn" data-dojo-attach-event\x3d"onclick:_sortByModifiedTimeBtnClick" title\x3d"${nls.sortByModifiedTime}"\x3e\x3c/div\x3e\r\n          \x3cdiv class\x3d"sort by-name jimu-float-leading" id\x3d"name" data-dojo-attach-point\x3d"sortByNameBtn"  data-dojo-attach-event\x3d"onclick:_sortByNameBtnClick" title\x3d"${nls.sortByName}"\x3e\x3c/div\x3e\r\n          \x3cdiv class\x3d"sort by-author jimu-float-leading" id\x3d"creator" data-dojo-attach-point\x3d"sortByAuthorBtn" data-dojo-attach-event\x3d"onclick:_sortByAuthorBtnClick" style\x3d"display: none" title\x3d"${nls.sortByAuthor}"\x3e\x3c/div\x3e\r\n        \x3c/div\x3e\r\n      \x3c/div\x3e\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e\r\n  \x3cdiv class\x3d"content-box" id\x3d"content-box" data-dojo-attach-point\x3d"contentBox"\x3e\r\n    \x3c!--operation\x3e\x3c--\x3e\r\n    \x3cdiv class\x3d"operation-box" data-dojo-attach-point\x3d"operationBox"\x3e\r\n      \x3cdiv class\x3d"create jimu-float-leading" data-dojo-attach-point\x3d"createNewBtn" data-dojo-attach-event\x3d"onclick:_onCreateClick" title\x3d${nls.appCreate}\x3e${nls.appCreate}\x3c/div\x3e\r\n      \x3cdiv class\x3d"import jimu-float-leading" data-dojo-attach-point\x3d"importBtn"\x3e\x3c/div\x3e\r\n      \x3cdiv class\x3d"switch-app-page-box" data-dojo-attach-point\x3d"switchAppPapgeBox"\x3e \x3c/div\x3e\r\n    \x3c/div\x3e  \r\n    \x3c!--content\x3e\x3c--\x3e\r\n    \x3cdiv class\x3d"content app-content selected" id\x3d"app-content" data-dojo-attach-point\x3d"appContent"\x3e\x3c/div\x3e\r\n    \x3cdiv class\x3d"content tempalte-content" id\x3d"template-content" data-dojo-attach-point\x3d"templateContent"\x3e\x3c/div\x3e\r\n    \x3c!--footer\x3e\x3c--\x3e\r\n    \x3cdiv class\x3d"footer" data-dojo-attach-point\x3d"footer"\x3e\r\n      \x3cdiv class\x3d"footer-text"\x3e\r\n        \x3cspan class\x3d"jimu-float-leading"\x3e\u00a9 Copyright 2016 Environmental Systems Research Institute, Inc.\x3c/span\x3e\r\n        \x3cspan class\x3d"separator jimu-float-leading"\x3e|\x3c/span\x3e\r\n        \x3ca class\x3d"jimu-float-leading" target\x3d"_blank" href\x3d"//www.esri.com/legal/privacy"\x3ePrivacy\x3c/a\x3e\r\n        \x3cspan class\x3d"separator jimu-float-leading"\x3e|\x3c/span\x3e\r\n        \x3ca class\x3d"jimu-float-leading" target\x3d"_blank" href\x3d"//www.esri.com/legal/software-license"\x3eLegal\x3c/a\x3e\r\n      \x3c/div\x3e\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e\r\n  \x3ciframe style\x3d"display:none" name\x3d"downloadTargetFrame"\x3e\x3c/iframe\x3e\r\n\x3c/div\x3e\r\n\r\n',
"url:builder/plugins/app-list/Import.html":'\x3cdiv\x3e\r\n  \x3cdiv class\x3d"actions jimu-float-trailing" data-dojo-attach-point\x3d"actionsNode"\x3e\r\n    \x3cspan class\x3d"actions-label jimu-ellipsis" title\x3d"${nls.actionsLabel}" data-dojo-attach-event\x3d"onclick:_onActionsLabelClick"\x3e${nls.actionsLabel}\x3c/span\x3e\r\n    \x3cdiv class\x3d"actions-menu" data-dojo-attach-point\x3d"actionsMenu"\x3e\r\n      \x3cdiv class\x3d"actions-menu-item item-import" data-dojo-attach-point\x3d"itemImportBtn" data-dojo-attach-event\x3d"onclick:_onMenuItemClick"\x3e\r\n        \x3cdiv class\x3d"import-button jimu-ellipsis" title\x3d"${nls.importAction}" data-dojo-attach-event\x3d"onclick:_onImportClick"\x3e${nls.importAction}\x3c/div\x3e\r\n      \x3c/div\x3e\r\n      \x3cdiv class\x3d"actions-menu-item item-upload" data-dojo-attach-event\x3d"onclick:_onMenuItemClick"\x3e\r\n        \x3cdiv class\x3d"upload-button-div"\x3e\r\n          \x3cdiv class\x3d"upload-button jimu-ellipsis" title\x3d"${nls.uploadAction}"\x3e${nls.uploadAction}\x3c/div\x3e\r\n          \x3cform enctype\x3d"multipart/form-data" encoding\x3d"multipart/form-data" title\x3d"${nls.uploadAction}" method\x3d"post" action\x3d"/webappbuilder/rest/apps/upload" data-dojo-attach-point\x3d"uploadAppFileFormNode"\x3e\r\n            \x3cinput class\x3d"file-input" title\x3d"${nls.uploadAction}" name\x3d"app" type\x3d"file" data-dojo-attach-point\x3d"appFileInputNode" data-dojo-type\x3d"dojox/form/Uploader" data-dojo-attach-event\x3d"onChange:_onAppFileChange,onError:_onAppFileUploadError,onComplete:_onAppFileUploadComplete" accept\x3d".zip" style\x3d"width:100%;height:100%;"\x3e\r\n            \x3cinput name\x3d"creator" type\x3d"text" value\x3d"1234" style\x3d"display:none;" data-dojo-attach-point\x3d"appFileCreatorInputNode"\x3e\r\n            \x3cinput name\x3d"portalUrl" type\x3d"text" style\x3d"display:none" data-dojo-attach-point\x3d"appPortalUrlInputNode"\x3e\r\n            \x3cinput name\x3d"fromList" type\x3d"text" style\x3d"display:none" data-dojo-attach-point\x3d"fromListNode"\x3e\r\n          \x3c/form\x3e\r\n        \x3c/div\x3e\r\n      \x3c/div\x3e\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e\r\n\x3c/div\x3e\r\n\r\n',
"url:jimu/dijit/templates/ItemSelector.html":'\r\n\x3cdiv\x3e\r\n\t\x3cdiv class\x3d"setting-tab-container"\x3e\r\n\t\t\x3cdiv data-dojo-attach-point\x3d"tabNode"\x3e\x3c/div\x3e\r\n\r\n\t\t\x3cdiv class\x3d"tab-content mycontent-tab" data-dojo-attach-point\x3d"mycontentTabNode"\x3e\r\n\t\t\t\x3cdiv class\x3d"tab-content-main mycontent-tab-content-main"\x3e\r\n\t\t\t\t\x3cdiv data-dojo-attach-point\x3d"mycontentSearch" data-dojo-type\x3d"jimu/dijit/Search" data-dojo-props\x3d\'searchWhenInput:false\' data-dojo-attach-event\x3d"onSearch:_onMyContentSearch" style\x3d"position:absolute;width:100%;top:0;"\x3e\x3c/div\x3e\r\n\t\t\t\t\x3cdiv data-dojo-attach-point\x3d"mycontentItemTable" data-dojo-type\x3d"jimu/dijit/_ItemTable" data-dojo-props\x3d\'types:${_itemTypes},typeKeywords:${_typeKeywords}\'style\x3d"top:50px;"\x3e\x3c/div\x3e\r\n\t\t\t\x3c/div\x3e\r\n\t\t\x3c/div\x3e\r\n\r\n\t\t\x3cdiv class\x3d"tab-content organization-tab" data-dojo-attach-point\x3d"organizationTabNode"\x3e\r\n\t\t\t\x3cdiv class\x3d"tab-content-main organization-tab-content-main"\x3e\r\n\t\t\t\t\x3cdiv data-dojo-attach-point\x3d"organizationSearch" data-dojo-type\x3d"jimu/dijit/Search" data-dojo-props\x3d\'searchWhenInput:false\' data-dojo-attach-event\x3d"onSearch:_onOrganizationSearch" style\x3d"position:absolute;width:100%;top:0;"\x3e\x3c/div\x3e\r\n\t\t\t\t\x3cdiv data-dojo-attach-point\x3d"organizationItemTable" data-dojo-type\x3d"jimu/dijit/_ItemTable" data-dojo-props\x3d\'types:${_itemTypes},typeKeywords:${_typeKeywords}\' style\x3d"top:50px;"\x3e\x3c/div\x3e\r\n\t\t\t\x3c/div\x3e\r\n\t\t\x3c/div\x3e\r\n\r\n\t\t\x3cdiv class\x3d"tab-content group-tab" data-dojo-attach-point\x3d"groupTabNode"\x3e\r\n\t\t\t\x3cdiv class\x3d"tab-content-main group-tab-content-main"\x3e\r\n\t\t\t\t\x3cdiv class\x3d"groups-section" style\x3d"position:absolute;width:100%;top:50px;" data-dojo-attach-point\x3d"groupsSection"\x3e\r\n\t\t\t\t\t\x3cspan\x3e${nls.groups}:\x3c/span\x3e\r\n\t\t\t\t\t\x3cselect class\x3d"groups-select" data-dojo-attach-point\x3d"groupsSelect"\x3e\r\n\t\t\t\t\t\t\x3coption value\x3d"nodata"\x3e${nls.noneGroups}\x3c/option\x3e\r\n\t\t\t\t\t\x3c/select\x3e\r\n\t\t\t\t\x3c/div\x3e\r\n\t\t\t\t\x3cdiv data-dojo-attach-point\x3d"groupSearch" data-dojo-type\x3d"jimu/dijit/Search" data-dojo-props\x3d\'searchWhenInput:false\' data-dojo-attach-event\x3d"onSearch:_onGroupSearch" style\x3d"position:absolute;width:100%;top:0;"\x3e\x3c/div\x3e\r\n\t\t\t\t\x3cdiv data-dojo-attach-point\x3d"groupItemTable" data-dojo-type\x3d"jimu/dijit/_ItemTable" data-dojo-props\x3d\'types:${_itemTypes},typeKeywords:${_typeKeywords}\' style\x3d"top:85px;"\x3e\x3c/div\x3e\r\n\t\t\t\x3c/div\x3e\r\n\t\t\x3c/div\x3e\r\n\r\n\t\t\x3cdiv class\x3d"tab-content public-tab" data-dojo-attach-point\x3d"publicTabNode"\x3e\r\n\t\t\t\x3cdiv class\x3d"tab-content-main public-tab-content-main"\x3e\r\n\t\t\t\t\x3cdiv data-dojo-attach-point\x3d"publicSearch" data-dojo-type\x3d"jimu/dijit/Search" data-dojo-props\x3d\'searchWhenInput:false\' data-dojo-attach-event\x3d"onSearch:_onPublicSearch" style\x3d"position:absolute;width:100%;top:0;"\x3e\x3c/div\x3e\r\n\t\t\t\t\x3cdiv class\x3d"public-search-radios"\x3e\r\n\t\t\t\t\t\x3cinput data-dojo-attach-point\x3d"portalPublicRaido" type\x3d"radio" name\x3d"publicSearchRadio" class\x3d"jimu-float-leading portal-public-radio jimu-radio-btn" /\x3e\r\n\t\t\t\t\t\x3clabel data-dojo-attach-point\x3d"portalPublicLabel" class\x3d"jimu-float-leading portal-public-label"\x3ePortal\x3c/label\x3e\r\n\t\t\t\t\t\x3cinput data-dojo-attach-point\x3d"onlinePublicRaido" type\x3d"radio" name\x3d"publicSearchRadio" class\x3d"jimu-float-leading online-public-radio jimu-radio-btn" /\x3e\r\n\t\t\t\t\t\x3clabel data-dojo-attach-point\x3d"onlinePublicLabel" class\x3d"jimu-float-leading online-public-label"\x3eArcGIS Online\x3c/label\x3e\r\n\t\t\t\t\x3c/div\x3e\r\n\t\t\t\t\x3cdiv data-dojo-attach-point\x3d"publicItemSection" class\x3d"public-item-section"\x3e\r\n\t\t\t\t\t\x3cdiv data-dojo-attach-point\x3d"publicPortalItemTable" data-dojo-type\x3d"jimu/dijit/_ItemTable" data-dojo-props\x3d\'types:${_itemTypes},typeKeywords:${_typeKeywords}\'\x3e\x3c/div\x3e\r\n\t\t\t\t\t\x3cdiv data-dojo-attach-point\x3d"publicOnlineItemTable" data-dojo-type\x3d"jimu/dijit/_ItemTable" data-dojo-props\x3d\'types:${_itemTypes},typeKeywords:${_typeKeywords}\'\x3e\x3c/div\x3e\r\n\t\t\t\t\x3c/div\x3e\r\n\t\t\t\x3c/div\x3e\r\n\t\t\x3c/div\x3e\r\n\t\x3c/div\x3e\r\n\t\x3cdiv class\x3d"signin-section" data-dojo-attach-point\x3d"signinSection" style\x3d"display:none;"\x3e\r\n\t\t\x3cdiv class\x3d"signin-tip"\x3e${nls.signInTip}\x3c/div\x3e\r\n\t\x3c/div\x3e\r\n\x3c/div\x3e',
"url:jimu/dijit/templates/TabContainer3.html":'\x3cdiv\x3e\r\n  \x3cdiv class\x3d"control-node" data-dojo-attach-point\x3d"controlNode"\x3e\r\n    \x3ctable data-dojo-attach-point\x3d"controlTable" class\x3d"control-table" cellpading\x3d"0"\x3e\r\n      \x3ctbody\x3e\r\n        \x3ctr data-dojo-attach-point\x3d"tabTr"\x3e\r\n        \x3c/tr\x3e\r\n      \x3c/tbody\x3e\r\n    \x3c/table\x3e\r\n  \x3c/div\x3e\r\n  \x3cdiv class\x3d"container-node" data-dojo-attach-point\x3d"containerNode"\x3e\x3c/div\x3e\r\n  \x3cdiv class\x3d"tab-shelter" data-dojo-attach-point\x3d"shelter"\x3e\x3c/div\x3e\r\n\x3c/div\x3e',
"url:jimu/dijit/templates/_ItemTable.html":'\x3cdiv\x3e\r\n\t\x3cdiv class\x3d"items-section all-items-section" data-dojo-attach-point\x3d"allItemsSection"\x3e\r\n\t\t\x3cdiv class\x3d"items-table-div" data-dojo-attach-point\x3d"allItemsTableDiv" data-dojo-attach-event\x3d"onscroll:_onAllItemsSectionScroll"\x3e\r\n\t\t\t\x3ctable class\x3d"items-table" cellpadding\x3d"10" data-dojo-attach-point\x3d"allItemsTable" data-dojo-attach-event\x3d"onclick:_onItemsTableClicked"\x3e\r\n\t\t\t\t\x3ctbody data-dojo-attach-point\x3d"allItemTbody"\x3e\x3c/tbody\x3e\r\n\t\t\t\x3c/table\x3e\r\n\t\t\x3c/div\x3e\r\n\t\t\x3cdiv data-dojo-type\x3d"jimu/dijit/LoadingIndicator" data-dojo-attach-point\x3d"allItemsShelter" data-dojo-props\x3d\'hidden:true\'\x3e\x3c/div\x3e\r\n\t\x3c/div\x3e\r\n\t\x3cdiv class\x3d"items-section filtered-items-section" data-dojo-attach-point\x3d"filteredItemsSection"\x3e\r\n\t\t\x3cdiv class\x3d"items-table-div" data-dojo-attach-point\x3d"filteredItemsTableDiv" data-dojo-attach-event\x3d"onscroll:_onFilteredItemsSectionScroll"\x3e\r\n\t\t\t\x3ctable class\x3d"items-table" cellpadding\x3d"10" data-dojo-attach-point\x3d"filteredItemsTable" data-dojo-attach-event\x3d"onclick:_onItemsTableClicked"\x3e\r\n\t\t\t\t\x3ctbody data-dojo-attach-point\x3d"filteredItemsTbody"\x3e\x3c/tbody\x3e\r\n\t\t\t\x3c/table\x3e\r\n\t\t\x3c/div\x3e\r\n\t\t\x3cdiv class\x3d"search-none-tip-section" data-dojo-attach-point\x3d"searchNoneTipSection" style\x3d"display:none;"\x3e\r\n\t\t\t\x3cspan class\x3d"search-none-icon jimu-icon jimu-icon-error"\x3e\x3c/span\x3e\r\n\t\t\t\x3cspan class\x3d"search-none-tip jimu-state-error-text"\x3e${nls.searchNone}\x3c/span\x3e\r\n\t\t\x3c/div\x3e\r\n\t\t\x3cdiv data-dojo-type\x3d"jimu/dijit/LoadingIndicator" data-dojo-attach-point\x3d"filteredItemShelter" data-dojo-props\x3d\'hidden:true\'\x3e\x3c/div\x3e\r\n\t\x3c/div\x3e\r\n\x3c/div\x3e',
"url:builder/dijit/templates/FullScreenPopup.html":'\x3cdiv data-dojo-attach-event\x3d"onclick:_onContainerClick"\x3e\r\n  \x3cdiv class\x3d"background" data-dojo-attach-point\x3d"background"\x3e\x3c/div\x3e\r\n  \x3cdiv class\x3d"main" data-dojo-attach-point\x3d"main"\x3e\r\n    \x3cdiv class\x3d"head" data-dojo-attach-point\x3d"head"\x3e\r\n      \x3cdiv class\x3d"head-underline"\x3e\r\n        \x3cspan class\x3d"title" data-dojo-attach-point\x3d"fullscreenPopupTitle"\x3e\x3c/span\x3e\r\n        \x3cdiv class\x3d"close" data-dojo-attach-point\x3d"fullscreenPopupClose"\r\n             data-dojo-attach-event\x3d"onclick:_onCloseClick"\x3e\x3c/div\x3e\r\n      \x3c/div\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv class\x3d"content-scroller" data-dojo-attach-point\x3d"contentScroller"\x3e\r\n      \x3cdiv class\x3d"content" data-dojo-attach-point\x3d"fullscreenPopupContent"\x3e\x3c/div\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv class\x3d"btnsContainer" data-dojo-attach-point\x3d"fullscreenPopupBtnsContainer"\x3e\r\n      \x3cdiv class\x3d"btns" data-dojo-attach-point\x3d"fullscreenPopupBtns"\x3e\x3c/div\x3e\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e\r\n\x3c/div\x3e',
"url:dojox/form/resources/Uploader.html":'\x3cspan class\x3d"dijit dijitReset dijitInline"\r\n\t\x3e\x3cspan class\x3d"dijitReset dijitInline dijitButtonNode"\r\n\t\tdata-dojo-attach-event\x3d"ondijitclick:_onClick"\r\n\t\t\x3e\x3cspan class\x3d"dijitReset dijitStretch dijitButtonContents"\r\n\t\t\tdata-dojo-attach-point\x3d"titleNode,focusNode"\r\n\t\t\trole\x3d"button" aria-labelledby\x3d"${id}_label"\r\n\t\t\t\x3e\x3cspan class\x3d"dijitReset dijitInline dijitIcon" data-dojo-attach-point\x3d"iconNode"\x3e\x3c/span\r\n\t\t\t\x3e\x3cspan class\x3d"dijitReset dijitToggleButtonIconChar"\x3e\x26#x25CF;\x3c/span\r\n\t\t\t\x3e\x3cspan class\x3d"dijitReset dijitInline dijitButtonText"\r\n\t\t\t\tid\x3d"${id}_label"\r\n\t\t\t\tdata-dojo-attach-point\x3d"containerNode"\r\n\t\t\t\x3e\x3c/span\r\n\t\t\x3e\x3c/span\r\n\t\x3e\x3c/span\r\n\t\x3e \r\n\t\x3cinput ${!nameAttrSetting} type\x3d"${type}" value\x3d"${value}" class\x3d"dijitOffScreen" tabIndex\x3d"-1" data-dojo-attach-point\x3d"valueNode" /\x3e\r\n\x3c/span\x3e\r\n',
"url:builder/plugins/app-list/AppCatalogPage.html":'\x3cdiv\x3e\r\n  \x3cdiv class\x3d"app-content" data-dojo-attach-point\x3d"appContent"\x3e\r\n    \x3cdiv class\x3d"list-section" id\x3d"list-section" data-dojo-attach-point\x3d"listSection"\x3e\r\n      \x3cdiv class\x3d"list-section-body-content" id\x3d"list-section-body-content" data-dojo-attach-point\x3d"listSectionBodyContent"\x3e\r\n        \x3ctable class\x3d"list-table" data-dojo-attach-point\x3d"listTable"\x3e\r\n          \x3ctbody data-dojo-attach-point\x3d"listTableBody"\x3e\x3c/tbody\x3e\r\n        \x3c/table\x3e\r\n      \x3c/div\x3e\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e\r\n  \x3c!--iframe style\x3d"display:none" name\x3d"downloadTargetFrame"\x3e\x3c/iframe--\x3e\r\n\x3c/div\x3e\r\n',
"url:builder/plugins/app-list/AppOperMenu.html":'\x3cdiv data-dojo-attach-event\x3d"onclick:_onMenuClick"\x3e\r\n  \x3cdiv class\x3d"up-triangle" data-dojo-attach-point\x3d"upTriangle"\x3e\x3c/div\x3e\r\n  \x3cdiv class\x3d"down-triangle" data-dojo-attach-point\x3d"downTriangle"\x3e\x3c/div\x3e\r\n\r\n  \x3cdiv class\x3d"item item-createApp-from-template" data-dojo-attach-point\x3d"createAppFromTemplate" data-dojo-attach-event\x3d"onclick:_onCreateAppFromTempalteClick"\x3e${nls.createApp}\x3c/div\x3e\r\n  \x3cdiv class\x3d"item item-editAppInfo" data-dojo-attach-point\x3d"editAppInfo" data-dojo-attach-event\x3d"onclick:_onEditClick"\x3e${nls.editAppInfo}\x3c/div\x3e\r\n  \x3cdiv class\x3d"item item-download" data-dojo-attach-point\x3d"download" data-dojo-attach-event\x3d"onclick:_onDownloadClick"\x3e\r\n    \x3ca data-dojo-attach-point\x3d"downloadLinkNode" style\x3d"display:inline-block;width:100%;height:100%;" target\x3d"downloadTargetFrame"\x3e${nls.download}\x3c/a\x3e\r\n  \x3c/div\x3e\r\n  \x3cdiv class\x3d"item item-duplicate" data-dojo-attach-point\x3d"duplicate" data-dojo-attach-event\x3d"onclick:_onDuplicateClick"\x3e${nls.duplicate}\x3c/div\x3e\r\n  \x3cdiv class\x3d"item item-remove" style\x3d"border-bottom-left-radius:5px;border-bottom-right-radius:5px;" data-dojo-attach-point\x3d"remove" data-dojo-attach-event\x3d"onclick:_onRemoveClick"\x3e${nls.deleteMenu}\x3c/div\x3e\r\n  \x3c!--div class\x3d"item item-agol-template" style\x3d"border-bottom-left-radius:5px;border-bottom-right-radius:5px;" data-dojo-attach-point\x3d"agolTemplate" data-dojo-attach-event\x3d"onclick:_onAgolTemplateClick"\x3e${nls.agolTemp}\x3c/div\x3e \r\n  \x3cdiv class\x3d"item item-qrcode" style\x3d"" data-dojo-attach-point\x3d"qrcode" data-dojo-attach-event\x3d"onclick:_onQRCodeClick"\x3eqrcodeeeeeee-nonls\x3c/div--\x3e \r\n\x3c/div\x3e\r\n',
"url:builder/dijit/templates/EditItemInfo.html":'\x3cdiv\x3e\r\n  \x3cdiv class\x3d"image-chooser-container" data-dojo-attach-point\x3d"imageChooserContainer"\x3e\r\n    \x3cdiv class\x3d"chooser-border"\x3e\r\n      \x3cdiv class\x3d"image-chooser-masker" data-dojo-attach-point\x3d"imageChooserMasker"\x3e${nls.change}\x3c/div\x3e\r\n      \x3cdiv class\x3d"image-chooser-base" id\x3d"publish-webmap-thumbnail" data-dojo-attach-point\x3d"imageChooserBase"\x3e\x3c/div\x3e\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e\r\n  \x3cdiv class\x3d"app-info-edit" data-dojo-attach-point\x3d"appInfoEdit"\x3e\r\n    \x3cdiv\x3e\r\n      \x3clabel for\x3d"publish-webmap-name"\x3e\r\n        ${nls.nameLabel}\r\n      \x3c/label\x3e\r\n      \x3cinput id\x3d"publish-webmap-name" data-dojo-type\x3d"dijit/form/TextBox" trim\x3d"true" data-dojo-attach-point\x3d"appName"\r\n             maxlength\x3d"250" required\x3d"true" placeHolder\x3d"${nls.nameLabelPlaceHolder}"\r\n             class\x3d"app-info-edit-name"\x3e\r\n      \x3c/input\x3e\r\n    \x3c/div\x3e\r\n\r\n    \x3cdiv\x3e\r\n      \x3clabel for\x3d"publish-webmap-summary"\x3e\r\n        ${nls.summaryLabel}\r\n      \x3c/label\x3e\r\n      \x3ctextarea id\x3d"publish-webmap-summary" data-dojo-type\x3d"dijit/form/SimpleTextarea" rows\x3d\'5\' trim\x3d"true"\r\n                maxlength\x3d"250" required\x3d"true" style\x3d"resize:none;" class\x3d"app-info-edit-summary"\r\n                data-dojo-attach-point\x3d"publishWebmapSummary"\x3e\x3c/textarea\x3e\r\n    \x3c/div\x3e\r\n    \x3c!--\r\n    \x3cdiv\x3e\r\n      \x3clabel for\x3d"publish-webmap-tags"\x3e\r\n        ${nls.tagsLabel}\r\n      \x3c/label\x3e\r\n      \x3cdiv id\x3d"publish-webmap-tags" data-dojo-type\x3d"builder/dijit/Tags" data-dojo-attach-point\x3d"tags"\r\n           style\x3d"width:95%;max-width:95%;"\x3e\x3c/div\x3e\r\n    \x3c/div\x3e--\x3e\r\n  \x3c/div\x3e\r\n\x3c/div\x3e\r\n',
"url:builder/plugins/app-list/CardPageWithBigThumbnail.html":'\x3cdiv\x3e\r\n\t\x3cdiv class\x3d"card-page-content" data-dojo-attach-point\x3d"cardPageContent"\x3e\x3c/div\x3e\r\n\x3c/div\x3e\r\n',"url:builder/plugins/app-list/CardPageWithSmallThumbnail.html":'\x3cdiv\x3e\r\n  \x3cdiv class\x3d"app-card-page-content" id\x3d"app-card-page-content" data-dojo-attach-point\x3d"appCardPageContent"\x3e\x3c/div\x3e\r\n\x3c/div\x3e\r\n\r\n',"url:builder/plugins/app-list/css/style.css":'.app-oper-menu {position: absolute; background-color:#354052; min-width:160px; max-width: 300px; border: 1px solid #dddddd; box-shadow: 0px 0px 6px #dddddd; z-index: 1; border-radius: 5px;}.app-oper-menu.white-style {background-color:#ffffff; box-shadow: 0 0 8px rgba(0, 0, 0, 0.2)}.app-oper-menu .item{width: 100%; height: 40px; min-height: 30px; padding-left: 20px; padding-right: 20px; border: 0px solid; color: #a0acbf; font-size: 14px; cursor: pointer; line-height: 40px; white-space: nowrap; overflow: hidden; text-overflow: ellipsis;}.app-oper-menu.white-style .item{color: #333333; border-bottom: 1px solid #e4e7e7;}.app-oper-menu .item:hover{background-color: #6f7e95; color: #ffffff;}.app-oper-menu.white-style .item:hover{background-color: #f8f9fb; color: #31aacd;}.jimu-rtl .app-oper-menu .item{padding-right: 20px; padding-left: 0px;}.app-oper-menu .item.border-top-radius{border-top-left-radius:5px; border-top-right-radius:5px;}.app-oper-menu .item.border-bottom-radius{border-bottom-left-radius:5px; border-bottom-right-radius:5px;}.app-oper-menu .item a{text-decoration: none; color: inherit;}.app-oper-menu .up-triangle{position: absolute; width: 18px; height: 11px; top: -11px; right: 20px; background: url("images/up_triangle.png");}.app-oper-menu.white-style .up-triangle{background: url("images/up_triangle_white.png"); background-repeat: no-repeat; background-position: center;}.jimu-rtl .app-oper-menu .up-triangle{left: 20px; right: auto;}.app-oper-menu .down-triangle{position: absolute; width: 18px; height: 11px; right: 20px; background: url("images/down_triangle.png"); display: none; background-repeat: no-repeat;}.app-oper-menu.white-style .down-triangle{background: url("images/down_triangle_white.png"); background-repeat: no-repeat; background-position: center;}.jimu-rtl .app-oper-menu .down-triangle{left: 20px; right: auto;}.import-app .actions{margin-right:2px; position: relative; display: inline-block; background-color: #ffffff; border-radius: 2px; border: 1px solid #31aacd; height: 40px;}.import-app .actions:hover{background-color: #f4f4f4;}.jimu-rtl .import-app .actions{margin-left:2px;}.import-app .actions-label{display: inline-block; width: 120px; margin: 0 15px; padding-right: 8px; background: url("images/v_blue.png") right no-repeat; color: #31aacd; line-height: 35px; font-size: 14px; font-weight: bold; text-align: center; cursor: pointer;}.jimu-rtl .import-app .actions-label{padding-left: 8px; padding-right: 0; background-position: left center;}.import-app .actions-menu {display: none; position: absolute; top: 41px; left: 0; z-index: 9999; background: #fff; box-shadow: 0 0 4px #646464; color: #333333; border: 1px solid #dddddd; box-shadow: 0px 0px 6px #dddddd; border-radius: 5px;}.jimu-rtl .import-app .actions-menu{left: auto; right: 0;}.import-app .actions-menu-item{position: relative; width: 250px; height: 30px; overflow: hidden; white-space: nowrap; padding: 0 25px; background-color: #ffffff; border-bottom: 1px solid #e4e7e7; border-radius: 5px; font-size: 14px;}.import-app .actions-menu-item .upload-button,.import-app .actions-menu-item .import-button {line-height: 30px; padding-left: 18px; background-repeat: no-repeat; background-position: left center;}.jimu-rtl .import-app .item-import .import-button,.jimu-rtl .import-app .item-upload .upload-button{padding-right: 18px; padding-left: 0; background-position: right center;}.import-app .item-import .import-button{background-image: url("images/clouda.png"); cursor: pointer;}.import-app .item-import:hover .import-button{background-image: url("images/cloudb.png");}.import-app .item-upload .upload-button{background-image: url("images/computera.png");}.import-app .item-upload:hover .upload-button{background-image: url("images/computerb.png");}.import-app .actions-menu-item:hover{background-color: #f8f9fb; color: #31aacd;}.import-app .upload-button-div form{position:absolute; top:0; bottom:0; width:100%; opacity:0; overflow: hidden; width: 200px; filter: Alpha(opacity\x3d0); -ms-filter: "Alpha(opacity\x3d0)";}.import-app .upload-button-div form span.dijitButtonNode{filter: Alpha(opacity\x3d0); -ms-filter: "Alpha(opacity\x3d0)";}.import-app .upload-button-div form span.dijitButton input{cursor: pointer; font-size: 20em\\9\\0 !important;}.jimu-rtl .import-app .upload-button-div form span.dijitButton input{left:-3px; right:auto !important;}.fullscreen-popup-container .content .control-node {line-height: 30px; height: 30px; width: 470px;}.fullscreen-popup-container .content .control-node .jimu-item-selector .jimu-tab3\x3e.container-node {top: 62px;}.fullscreen-popup-container .control-node .control-table {font-size: 14px; color: #999; line-height: 14px;}.fullscreen-popup-container .control-node .tab-item-td {width: 100px; padding: 0 10px; border: none;}.fullscreen-popup-container .control-node .tab-item-td:last-child {display: none;}.fullscreen-popup-container .jimu-item-selector .jimu-tab3\x3e.container-node{top:54px;}.fullscreen-popup-container .jimu-item-selector .jimu-tab3\x3e.container-node .jimu-item-table{top:40px; height: 100%;}.fullscreen-popup-container .control-node .jimu-state-active {color: #d84b28; border: none; border-bottom: 2px solid #d84b28;}.fullscreen-popup-container .container-node {min-height: 400px;}.fullscreen-popup-container .jimu-item-table .items-section {bottom:70px;}.fullscreen-popup-container .container-node .jimu-item-table .items-table-div {}.fullscreen-popup-container .container-node .tab-content .jimu-search {height: 40px; margin-top: 12px;}.fullscreen-popup-container .container-node .tab-content .jimu-search .jimu-icon-search {width: 16px; height: 16px; background: url("images/search.png") center no-repeat;}.fullscreen-popup-container .container-node .tab-content .jimu-search .jimu-icon-search:hover {background: url("images/search_selected.png") center no-repeat;}.fullscreen-popup-container .container-node .tab-content .public-item-section{top: 35px;}.fullscreen-popup-container .container-node .tab-content .jimu-item-table {margin-top: 20px;}.fullscreen-popup-container .container-node .tab-content .items-table .jimu-item-table .item-thumbnail {width: 180px; height: 120px;}.fullscreen-popup-container .container-node .tab-content .jimu-item-table .item-thumbnail:hover {border: 2px solid #0f95bc; border-radius: 0px;}.fullscreen-popup-container .container-node .tab-content .jimu-item-table .item-info{left: 180px;}.fullscreen-popup-container .container-node .tab-content .jimu-item-table .items-table td {padding-bottom: 20px;}.fullscreen-popup-container .container-node .jimu-item-table .item-thumbnail{border: 2px solid transparent;}.fullscreen-popup-container .container-node .jimu-item-table .items-table .item-border{left: 2px; top: 1px; width: 176px; height: 112px;}.jimu-rtl .fullscreen-popup-container .container-node .jimu-item-table .items-table .item-border{right: 2px; left: auto;}.fullscreen-popup-container .container-node .jimu-item-table .item-border {border: 2px solid #15a4fa;;}.fullscreen-popup-container .container-node .item-info{width:180px; height:100px; margin: 10px 30px 0 10px;}.fullscreen-popup-container .container-node .item-border {border: 3px solid #15a4fa; -webkit-border-radius: 0; -moz-border-radius: 0; -o-border-radius: 0; -ms-border-radius: 0; border-radius: 0;}.fullscreen-popup-container .container-node .item-info .item-name{font-size: 18px; font-family: "Avenir Medium"; color: #333; line-height: 18px;}.fullscreen-popup-container .container-node .item-info .item-type-owner,.fullscreen-popup-container .container-node .item-info .item-date {margin-top: 10px; font-size: 12px; color: #666; line-height: 18px; overflow:hidden;}.fullscreen-popup-container .container-node .item-info .item-date{margin-top: 8px;}.app-list-page{width: 100%; height: 100%; position: relative;}.app-list-page .separate-line {height: 47px; border-bottom: 1px solid #cfd7d7;}.app-list-page .switch-app-template {top: 16px; position: relative; max-width: 1180px; min-width: 1024px; margin: 0 auto; font-size: 16px; color: #a3a3a3; font-weight: bold;}.app-list-page .switch-app-template .switch-btn-box {position: relative; display: inline-block; margin-right: 1px;}.app-list-page .switch-app-template .switch-btn {margin-right: 8px; margin-left: 8px; cursor: pointer; min-width: 80px; text-align: center;}.app-list-page .switch-app-template .switch-btn-box:hover {color: #508dca;}.app-list-page .switch-app-template .switch-btn-box.selected {color: #508dca;}.app-list-page .switch-app-template .switch-btn-box .blue-block {position: absolute; width: 100%; height: 4px; bottom: -8px;}.app-list-page .switch-app-template .switch-btn-box:hover .blue-block{background-color: #508dca;}.app-list-page .switch-app-template .switch-btn-box.selected .blue-block{background-color: #508dca;}.app-list-page .app-content{position: relative; max-width: 1180px; min-width: 1024px; margin: 50px auto; height: 100%;}.app-list-page .head-section {display: inline-block; width: 100%; padding-bottom: 30px;}.app-list-page .head-section .textPart1{margin-top: 15px; color: #6f7a8b; font-size: 18px;}.app-list-page .head-section .textPart2{margin-top: 20px; margin-left: 3px; color: #002157; font-size: 14px;}.jimu-rtl .app-list-page .head-section .textPart2{margin-right: 3px;}.app-list-page .head-section .create-button-div{height: 50px; position: relative; left: -16px; display: inline-block; padding-top: 8px;}.jimu-rtl .app-list-page .head-section .create-button-div{right: -16px;}.app-list-page .head-section .create-button{width: 140px; height: 37px; background-color: #518dca; border: 1px solid #348599; color: #ffffff; font-size: 15px; font-weight: bold; border-radius: 4px; cursor: pointer; box-shadow: 0px 1px 2px #a0acbf;} .app-list-page .app-content .list-section{position: absolute; top: 78px; width: 100%;} .app-list-page .app-content .list-section-head {table-layout: fixed; border-spacing: 0px; background-color: #6f7e95; width: 100%; height: 49px; border-top-left-radius: 4px; border-top-right-radius: 4px; box-shadow: 1px 1px 2px #a0acbf;}.app-list-page .app-content .list-section .head-content {}.app-list-page .app-content .list-section .head-content .name{width: 270px; color: #ffffff; font-size: 14px; border: 0px solid; padding-left: 25px;}.jimu-rtl .app-list-page .app-content .list-section .head-content .name{padding-right: 25px;}.app-list-page .app-content .list-section .head-content .desc{width: 300px; color: #ffffff; font-size: 14px; border: 0px solid;}.app-list-page .app-content .list-section .head-content .time{color: #ffffff; font-size: 14px; border: 0px solid; width: 150px;}.app-list-page .app-content .list-section .head-content .modified{color: #ffffff; font-size: 14px; border: 0px solid; width: 100px; display: none;}.app-list-page .app-content .list-section .head-content .creator{color: #ffffff; font-size: 14px; border: 0px solid;} .app-list-page .app-content .list-section-body{position: absolute; top: 127px; bottom: 150px; width: 100%; overflow: hidden;}.app-list-page .app-content .list-section-body-content{max-height: 100%; border: 1px solid #a0acbf; box-shadow: 1px 1px 2px #a0acbf; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px;}.app-list-page .app-content .list-table{table-layout: fixed; border-spacing: 0px; width: 100%;}.app-list-page .app-content .list-table-item{height: 40px; background-color: #fafafa;}.app-list-page .app-content .list-table-item-add{}.app-list-page .app-content .list-table-item-mouseover{background-color: #e3ecf2;}.app-list-page .app-content .list-table-next-item-mouseover td{border-bottom: 2px solid #e3ecf2;}.app-list-page .app-content .list-table-item-dbclick{background-color: #fffce4;}.app-list-page .app-content .list-table-item .item-first-td{width: 4px; vertical-align: top;}.app-list-page .app-content .list-table-item .item-second-td{width: 16px; vertical-align: top;}.app-list-page .app-content .list-table-item .item-first-td-selected {background-color: #15a4fa;}.app-list-page .app-content .list-table-item .item-end-td{width: 4px;}.app-list-page .app-content .list-table-item .item-name-td{width: 250px; vertical-align: top; border-bottom: 2px solid #e3ecf2;}.app-list-page .app-content .list-table-item .item-name{overflow: hidden; color: #596679; font-size: 14px; border: 0px solid; width: 230px; max-height: 40px; min-height: 20px; margin-top: 10px; margin-bottom: 10px; line-height: 20px; white-space: normal; word-wrap: break-word; word-break: break-word;}.app-list-page .app-content .list-table-item .item-input-name{width: 230px; height: 30px; margin-left: 10px; margin-top: 5px; border: 1px solid #999999; background-color: #ffffff}.app-list-page .app-content .list-table-item .item-desc-td{width:300px; border-bottom: 2px solid #e3ecf2;}.app-list-page .app-content .list-table-item .item-desc{overflow: hidden; color: #596979; font-size: 14px; border: 0px solid; margin-right: 5px; width: 270px; max-height: 40px; min-height: 20px; margin-top: 10px; margin-bottom: 10px; line-height: 20px; white-space: normal; word-wrap: break-word; word-break: break-word;}.app-list-page .app-content .list-table-item .item-textarea-description{width: 285px; height: 82px; border: 1px solid #999999; resize: none; margin-top: 7px; margin-bottom: 7px;}.app-list-page .app-content .list-table-item .item-time-td{vertical-align: top; border-bottom: 2px solid #e3ecf2; width: 150px;}.app-list-page .app-content .list-table-item .item-time{color: #7989a0; font-size: 14px; border: 0px solid; cursor: default; padding-top: 10px; height: 40px;}.app-list-page .app-content .list-table-item .item-modified-td{vertical-align: top; border-bottom: 2px solid #e3ecf2; width: 100px; display: none;}.app-list-page .app-content .list-table-item .item-modified{color: #7989a0; font-size: 14px; border: 0px solid; cursor: default; padding-top: 10px;}.app-list-page .app-content .list-table-item .item-creator-td{vertical-align: top; border-bottom: 2px solid #e3ecf2; width: 83px;}.app-list-page .app-content .list-table-item .item-creator{color: #7989a0; font-size: 14px; border: 0px solid; cursor: default; padding-top: 10px;}.app-list-page .app-content .list-table-item .item-loading-td{width: 14px; max-width: 14px; border-bottom: 2px solid #e3ecf2;}.app-list-page .app-content .list-table-item .item-loading-td .loading-div{display: none; width: 14px;}.app-list-page .app-content .list-table-item .item-operations-td{vertical-align: top; border-bottom: 2px solid #e3ecf2;}.app-list-page .app-content .list-table-item .item-operations-div{border: 0px solid; width: 190px; margin: 0px 0px 0px auto; color: #A0acbf; font-size: 14px;}.jimu-rtl .app-list-page .app-content .list-table-item .item-operations-div{margin: 0px auto 0px 0px;}.app-list-page .app-content .list-table-item .item-edit{border: 0px solid; margin-right: 5px; cursor: pointer; height: 40px; width: 65px; background-image: url("images/edit_icon01.png"); background-repeat: no-repeat; background-position: center left; overflow: hidden;}.jimu-rtl .app-list-page .app-content .list-table-item .item-edit{margin-left: 5px; margin-right: auto; background-position: center right;}.app-list-page .app-content .list-table-item .item-edit:hover{background-image: url("images/edit_icon02.png"); color: #518dca !important;}.jimu-rtl .app-list-page .app-content .list-table-item .item-edit-image{}.app-list-page .app-content .list-table-item .item-edit-text{line-height: 40px; padding-left: 17px; width: 100%; overflow: hidden; white-space: nowrap; text-overflow: ellipsis;}.jimu-rtl .app-list-page .app-content .list-table-item .item-edit-text{padding-right: 17px; padding-left: 0;}.app-list-page .app-content .list-table-item .item-preview{border: 0px solid; margin-right: 0px; cursor: pointer; width: 80px; height: 40px; line-height: 40px; background-image: url("images/launch2.png"); background-repeat: no-repeat; background-position: center left; overflow: hidden;}.jimu-rtl .app-list-page .app-content .list-table-item .item-preview{margin-left: 0px; margin-right: auto; background-position: center right;}.app-list-page .app-content .list-table-item .item-preview:hover{background-image: url("images/launch3.png"); color: #518dca !important;}.app-list-page .app-content .list-table-item .item-preview a{text-decoration: none; color: inherit; display: inline-block; padding-left: 19px; white-space: nowrap; text-overflow: ellipsis; overflow: hidden; width: 100%;}.jimu-rtl .app-list-page .app-content .list-table-item .item-preview a{padding-right: 24px; padding-left: 0px;}.app-list-page .app-content .list-table-item .item-preview img{margin-top: 13px; margin-right: 5px;}.jimu-rtl .app-list-page .app-content .list-table-item .item-preview img{margin-left: 13px; margin-right: auto;}.app-list-page .app-content .list-table-item .item-more{height: 40px; width: 38px; text-align: center; cursor: pointer; background-image: url("images/moreaction_icon.png"); background-repeat: no-repeat; background-position: center center; overflow: hidden;}.app-list-page .app-content .list-table-item .item-more-selected{background-image: url("images/moreaction_icon1.png") !important;}.app-list-page .app-content .list-table-item .item-more:hover{background-image: url("images/moreaction_icon1.png");}.app-list-page .app-content .list-table-item .item-more-image{margin-top: 18px;}.app-list-page .app-menu {position: absolute; background-color:#354052; width:160px; border: 1px solid #dddddd; box-shadow: 0px 0px 6px #dddddd; z-index: 1; border-radius: 5px;}.app-list-page .app-menu .item{width: 100%; min-height: 30px; padding-left: 20px; border: 0px solid; color: #a0acbf; font-size: 14px; cursor: pointer; padding-top: 12px; padding-bottom: 12px;}.jimu-rtl .app-list-page .app-menu .item{padding-right: 20px; padding-left: 0px;}.app-list-page .app-menu .item.border-top-radius{border-top-left-radius:5px; border-top-right-radius:5px;}.app-list-page .app-menu .item.border-bottom-radius{border-bottom-left-radius:5px; border-bottom-right-radius:5px;}.app-list-page .app-menu .item a{text-decoration: none; color: inherit;}.app-list-page .app-menu .up-triangle{position: absolute; width: 18px; height: 11px; top: -10px; right: 20px; background: url("images/up_triangle.png");}.jimu-rtl .app-list-page .app-menu .up-triangle{left: 20px; right: auto;}.app-list-page .app-menu .down-triangle{position: absolute; width: 18px; height: 11px; right: 20px; background: url("images/down_triangle.png"); display: none; background-repeat: no-repeat;}.jimu-rtl .app-list-page .app-menu .down-triangle{left: 20px; right: auto;}.app-list-page .app-menu .item:hover{background-color: #6f7e95; color: #ffffff;}.edit-app-info-content {color: #4d4d4d; font-size: 14px; font-family: monospace;}.edit-app-info-content .app-thumbnail {width: 200px; height: 133px; margin-top:20px; margin-left: 30px; display: inline-block;}.edit-app-info-content .app-name {margin-left: 30px;}.edit-app-info-content .app-description {margin-left: 30px; margin-top: 20px;}.edit-app-info-content .dijitTextBox {}.edit-app-info-content .dijitTextBoxFocused {border-color: #406b9b !important; box-shadow: 0 0 0 #ffffff !important;}.edit-app-info-content .dijitTextBoxHover{background-color: #ffffff; background-image: none;}.edit-app-info-content .dijitInputField {line-height: 15px !important; padding: 0 0 0 !important;}.edit-app-info-content .dijitTextBox .dijitInputInner{height: 23px;}.edit-app-info-content .app-name .name-text-box{width: 95%; padding: 2px;}.edit-app-info-content .app-description .desc-text-area{width: 95%; max-width: 95%; min-width: 95%; height: 200px; max-height: 200px; min-height: 200px; padding: 2px; resize: none;}.dj_ie8 .app-list-page .app-content .list-section-head,.dj_ie8 .app-list-page .app-content .list-section-body-content{filter: progid:dXImageTransform.Microsoft.DropShadow(color\x3d#a0acbf,offX\x3d1,offY\x3d1,positives\x3dtrue); -ms-filter: "progid:dXImageTransform.Microsoft.DropShadow(color\x3d#a0acbf,offX\x3d1,offY\x3d1,positives\x3dtrue)";}.app-catalog-page {width: 100%; height: 100%; position: relative; overflow: hidden; background-color: #f8f9fb;}.app-catalog-page .app-content {position: relative; max-width: 1300px; min-width: 1024px; margin: 0 auto; height: 100%; min-height: 340px; padding-top: 20px; padding-left: 20px; padding-right: 20px;}.app-catalog-page .app-content .list-table {table-layout: fixed; border-spacing: 0; width: 100%;}.app-catalogs.list-table-item {}.item-td {}.app-catalog-page .app-catalogs .catalog {background-color: #fff; height: 120px; width: 100%; margin: 0 auto 10px; -moz-box-shadow: 0 0 12px rgba(0, 0, 0, .1); -webkit-box-shadow: 0 0 12px rgba(0, 0, 0, .1); box-shadow: 0 0 12px rgba(0, 0, 0, .1);}.app-catalog-page .app-catalogs .catalog .content-theme {height: 100%; width: 180px; position: relative;}.app-catalog-page .app-catalogs .catalog .content-theme .content-theme-color {width: 4px; position: absolute; left: 0; height: 100%;}.jimu-rtl .app-catalog-page .app-catalogs .catalog .content-theme .content-theme-color {right: 0;}.app-catalog-page .app-catalogs .catalog .content-theme .content-theme-icon {position: absolute; top: 0px; left: 0px; width: 100%; height: 120px; background-size: 100% 100%; background-repeat: no-repeat; background-position: center; cursor: pointer;}.app-catalog-page .app-catalogs .catalog .content-theme .content-theme-flagImg{position: absolute; width: 26px; height: 22px; bottom: 10px; left: 140px; background-position: center; background-repeat: repeat; display: block; z-index: 10;}.app-catalog-page .app-catalogs .catalog .content-theme .content-theme-flagImg-2D{background-image: url("images/flag_2d.png");}.app-catalog-page .app-catalogs .catalog .content-theme .content-theme-flagImg-3D{background-image: url("images/flag_3d.png");}.jimu-rtl .app-catalog-page .app-catalogs .catalog .content-theme .content-theme-icon {left: auto; right: 0px;} .app-catalog-page .app-catalogs .catalog .content-opers {height: 100%; width: 198px; position: relative;}.app-catalog-page .app-catalogs .catalog .content-opers:before {background-color: #e5e5e5; content: ""; position: absolute; top: 20px; width: 1px; height: 80px;}.app-catalog-page .app-catalogs .catalog .content-opers-btns {margin: 44px 0 44px 20px;}.jimu-rtl .app-catalog-page .app-catalogs .catalog .content-opers-btns {margin-left: 0; margin-right: 10px;}.app-catalog-page .app-catalogs .catalog .content-opers-btn {display: inline-block; position: relative; width: 32px; height: 32px; border: 2px solid #999; -moz-border-radius: 16px; -webkit-border-radius: 16px; border-radius: 16px; margin-right: 10px;}.app-catalog-page .app-catalogs .catalog .content-opers-btn:hover {cursor: pointer; border: 2px solid #333;}.app-catalog-page .app-catalogs .catalog .content-opers-btns-download {background: url("images/download.png") center no-repeat;}.app-catalog-page .app-catalogs .catalog .content-opers-btns-download:hover {background: url("images/download_hover.png") center no-repeat;}.app-catalog-page .app-catalogs .catalog .content-opers-btns-edit {background: url("images/edit.png") center no-repeat;}.app-catalog-page .app-catalogs .catalog .content-opers-btns-edit:hover {background: url("images/edit_hover.png") center no-repeat;}.app-catalog-page .app-catalogs .catalog .content-opers-btns-launch {background: url("images/view.png") center no-repeat;}.app-catalog-page .app-catalogs .catalog .content-opers-btns-launch:hover {background: url("images/view_hover.png") center no-repeat;}.app-catalog-page .app-catalogs .catalog .content-opers-btns-more {background: url("images/more.png") center no-repeat;}.app-catalog-page .app-catalogs .catalog .content-opers-btns-more:hover {background: url("images/more_hover.png") center no-repeat;}.app-catalog-page .app-catalogs .catalog .content-opers-btns-more.content-opers-btns-more-selected {border: 2px solid #0f95bc; background: url("images/more_selected.png") center no-repeat;}.app-catalog-page .app-catalogs .catalog .content {margin: 20px 20px 20px 30px;}.catalog-content {padding: 20px 20px 20px 200px;}.jimu-rtl .catalog-content {padding-right: 180px; padding-left: 20px;}.app-catalog-page .app-catalogs .catalog .catalog-content-head {}.app-catalog-page .app-catalogs .catalog .catalog-content-head .catalog-content-appname {left: 0px; font-family: "Avenir Medium"; font-size: 14px; color: #333; display: inline-block; max-width: 550px;}.jimu-rtl .app-catalog-page .app-catalogs .catalog .catalog-content-head .catalog-content-appname {padding-right: 20px;}.app-catalog-page .app-catalogs .catalog .catalog-content-head .catalog-content-appinfo {padding-right: 20px; font-size: 12px; display: inline-block;}.jimu-rtl .app-catalog-page .app-catalogs .catalog .catalog-content-head .catalog-content-appinfo {padding-right: 0; padding-left: 20px;}.app-catalog-page .app-catalogs .catalog .catalog-content-head .catalog-content-appinfo-time {font-family: "Avenir Light"; color: #999; padding-top: 1px;}.app-catalog-page .app-catalogs .catalog .catalog-content-head .catalog-content-appinfo-owner {font-family: "Avenir Light"; color: #999; position: relative; padding: 0 20px;}.app-catalog-page .app-catalogs .catalog .catalog-content-head .catalog-content-appinfo-owner:before {background-color: #e5e5e5; content: ""; position: absolute; top: 5px; left: 10px; width: 1px; height: 10px;}.jimu-rtl .app-catalog-page .app-catalogs .catalog .catalog-content-head .catalog-content-appinfo-owner:before {content: ""; left: 0; right: 10px;}.app-catalog-page .app-catalogs .catalog .catalog-content-head .catalog-content-appinfo-owner-tip {font-family: "Avenir Light"; color: #999; line-height: 18px; display: inline-block; vertical-align: top; padding-right: 6px;}.jimu-rtl .app-catalog-page .app-catalogs .catalog .catalog-content-head .catalog-content-appinfo-owner-tip {padding-left: 6px;}.app-catalog-page .app-catalogs .catalog .catalog-content-head .catalog-content-appinfo-owner-name{display: inline-block; max-width: 100px; padding-top: 1px; height: 18px; line-height: 18px;}.app-catalog-page .app-catalogs .catalog .catalog-content-head .catalog-content-appinfo-type {font-family: "Avenir Medium"; color: #31a6e0;}.app-catalog-page .app-catalogs .catalog .catalog-content-dis {padding: 10px 20px 0 0; font-family: "Avenir Light"; font-size: 14px; color: #333; word-wrap: break-word; word-break: break-all; overflow: hidden; height: 70px;}.app-catalog-page .app-catalogs .catalog .catalog-content-dis.place-holder-class {color: #cccccc;}.app-catalog-page .app-menu {position: absolute; background-color: #354052; width: 160px; border: 1px solid #dddddd; box-shadow: 0px 0px 6px #dddddd; z-index: 1; border-radius: 5px;}.app-catalog-page .app-menu .item {width: 100%; min-height: 30px; padding-left: 20px; border: 0px solid; color: #a0acbf; font-size: 14px; cursor: pointer; padding-top: 12px; padding-bottom: 12px;}.jimu-rtl .app-catalog-page .app-menu .item {padding-right: 20px; padding-left: 0px;}.app-catalog-page .app-menu .item.border-top-radius {border-top-left-radius: 5px; border-top-right-radius: 5px;}.app-catalog-page .app-menu .item.border-bottom-radius {border-bottom-left-radius: 5px; border-bottom-right-radius: 5px;}.app-catalog-page .app-menu .item a {text-decoration: none; color: inherit;}.app-catalog-page .app-menu .up-triangle {position: absolute; width: 18px; height: 11px; top: -10px; right: 20px; background: url("images/up_triangle.png");}.jimu-rtl .app-catalog-page .app-menu .up-triangle {left: 20px; right: auto;}.app-catalog-page .app-menu .down-triangle {position: absolute; width: 18px; height: 11px; right: 20px; background: url("images/down_triangle.png"); display: none; background-repeat: no-repeat;}.jimu-rtl .app-catalog-page .app-menu .down-triangle {left: 20px; right: auto;}.app-catalog-page .app-menu .item:hover {background-color: #6f7e95; color: #ffffff;}.app-card-page {position: relative; overflow: hidden;}.app-card-page .app-card-page-content {max-width: 1300px; min-width: 1024px; margin: 20px auto 0; overflow: hidden; padding-left: 20px; min-height: 340px;}.app-card-page .app-card-box {position: relative; width: 300px; height: 170px; margin-right: 20px; margin-bottom: 20px; background-color: #ffffff; box-shadow: 0 0 10px rgba(0, 0, 0, 0.1); border-bottom-left-radius: 4px; border-bottom-right-radius: 4px;}.app-card-page .app-card-box .card {height: 100%; width: 100%;}.app-card-page .app-card-box .app-info-card {}.app-card-page .app-card-box .app-info-card .app-style-part {width: 100%; height: 4px;}.app-card-page .app-card-box .app-info-card .app-title-part {position: relative; width: 100%; height: 125px;}.app-card-page .app-card-box .app-info-card .app-title-part .app-type-div {position: absolute; background-repeat: no-repeat; background-position: center; width: 30px; height: 20px; top: 5px; right: 5px;}.jimu-rtl .app-card-page .app-card-box .app-info-card .app-title-part .app-type-div {right: auto; left: 5px;}.app-card-page .app-card-box .app-info-card .app-title-part .app-type-2d {background-image: url("images/flag_2d.png");}.app-card-page .app-card-box .app-info-card .app-title-part .app-type-3d {background-image: url("images/flag_3d.png");}.app-card-page .app-card-box .app-info-card .app-title-part .app-title-table {width: 100%; height: 100%;}.app-card-page .app-card-box .app-info-card .app-title-part .app-icon-td {width: 110px; height: 100%;}.app-card-page .app-card-box .app-info-card .app-title-part .app-icon {width: 80px; height: 80px; border: 2px solid #e5e5e5; border-radius: 10px; display: block; background-repeat: no-repeat; background-position: center; margin-left: 20px; background-size: 100% 100%;}.app-card-page .app-card-box .app-info-card .app-title-part .app-icon.default-icon {background-size: 50px 50px;}.app-card-page .app-card-box .app-info-card .app-title-part .app-title-div {line-height: 20px; max-height: 38px; overflow: hidden; white-space: normal; word-wrap: break-word; word-break: break-word; padding-right: 10px; font-family: "Avenir Medium"; font-size: 16px; color: #333333; font-weight: bold;}.app-card-page .app-card-box .app-info-card .app-title-part .app-time-div {margin-top: 20px; color: #999999; font-size: 12px; line-height: 12px;}.app-card-page .app-card-box .app-des-card {position: absolute; width: 100%; height: 125px; top: 4px; left: 0; display: block; opacity: 0;}.app-card-page .app-card-box .app-des-card .app-des-part {width: 100%; height: 100%;}.app-card-page .app-card-box .app-des-card .app-des-part .app-name{width: 100%; height: 75px;}.app-card-page .app-card-box .app-des-card .app-des-part .app-name-div{max-height: 48px; line-height: 16px; overflow: hidden; white-space: normal; word-wrap: break-word; word-break: break-word; padding-left: 20px; padding-right: 20px; font-size: 14px; color: #333333; font-family: "Avenir Medium"; font-weight: bold;}.app-card-page .app-card-box .app-des-card .app-des-part .app-info-div{padding-left: 20px; padding-right: 20px; color: #999999; font-size: 12px; line-height: 13px; margin-top: 10px; overflow: hidden;}.app-card-page .app-card-box .app-des-card .app-des-part .app-des{width: 100%; height: 50px; overflow: hidden; line-height: 16px; font-size: 12px; color: #666666; white-space: normal; word-wrap: break-word; word-break: break-word; padding-left: 20px; padding-right: 20px;}.app-card-page .app-card-box .app-operation-part {position: relative; width: 280px; height: 41px; left: 10px; border-top: 1px solid #e5e5e5;}.jimu-rtl .app-card-page .app-card-box .app-operation-part {right: 10px; left: auto;}.app-card-page .app-card-box .app-operation {background-repeat: no-repeat; background-position: center; overflow: hidden; cursor: pointer;}.app-card-page .app-card-box .download-operation {height: 40px; width: 40px; background-image: url("images/download.png");}.app-card-page .app-card-box .download-operation:hover {background-image: url("images/download_hover.png");}.app-card-page .app-card-box .edit-operation {height: 40px; width: 40px; background-image: url("images/edit.png");}.app-card-page .app-card-box .edit-operation:hover {background-image: url("images/edit_hover.png");}.app-card-page .app-card-box .launch-operation {height: 40px; width: 40px; background-image: url("images/view.png");}.app-card-page .app-card-box .launch-operation:hover {background-image: url("images/view_hover.png");}.app-card-page .app-card-box .app-operation a{display: inline-block; width: 100%; height: 100%;}.app-card-page .app-card-box .more-operation {height: 40px; width: 40px; background-image: url("images/more.png");}.app-card-page .app-card-box .more-operation:hover {background-image: url("images/more_hover.png");}.app-card-page .app-card-box .more-operation.item-more-selected {background-image: url("images/more_selected.png");}.template-card-page {position: relative; overflow: hidden;}.template-card-page .template-card-page-content {max-width: 1300px; min-width: 1024px; margin: 20px auto 0; overflow: hidden; padding-left: 20px; min-height: 340px;}.template-card-page .template-card {position: relative; width: 300px; height: 320px; margin-right: 20px; margin-bottom: 20px; background-color: #ffffff; box-shadow: 0 0 10px rgba(0, 0, 0, 0.1); border-bottom-left-radius: 4px; border-bottom-right-radius: 4px;}.template-card-page .template-card .template-type-div {position: absolute; background-repeat: no-repeat; background-position: center; width: 30px; height: 20px; top: 5px; right: 5px;}.jimu-rtl .template-card-page .template-card .template-type-div {right: auto; left: 5px;}.template-card-page .template-card .template-type-2d {background-image: url("images/flag_2d.png");}.template-card-page .template-card .template-type-3d {background-image: url("images/flag_3d.png");}.template-card-page .template-card .thumbnail-part {width: 100%; height: 180px; background-repeat: no-repeat; background-position: center;}.template-card-page .template-card .appInfo-part {width: 100%; height: 99px;}.template-card-page .template-card .appInfo-part .template-name {width: 100%; height: 40px;}.template-card-page .template-card .appInfo-part .template-name-div {max-height: 40px; line-height: 20px; overflow: hidden; white-space: normal; word-wrap: break-word; word-break: break-word; padding-left: 20px; padding-right: 20px; font-size: 18px; color: #333333; font-family: "Avenir Medium"; font-weight: bold;}.template-card-page .template-card .appInfo-part .template-des-div {width: 100%; height: 57px; overflow: hidden; line-height: 18px; font-size: 14px; color: #666666; white-space: normal; word-wrap: break-word; word-break: break-word; padding-left: 20px; padding-right: 20px;}.template-card-page .template-card .template-operation-part {position: relative; position: relative; width: 280px; height: 41px; left: 10px; border-top: 1px solid #e5e5e5;}.jimu-rtl .template-card-page .template-card .template-operation-part {right: 10px; left: auto;}.template-card-page .template-card .template-operation {background-repeat: no-repeat; background-position: center; overflow: hidden; cursor: pointer;}.template-card-page .template-card .launch-operation {height: 40px; width: 40px; background-image: url("images/view.png");}.template-card-page .template-card .launch-operation:hover {background-image: url("images/view_hover.png");}.template-card-page .template-card .edit-operation {height: 40px; width: 40px; background-image: url("images/edit.png");}.template-card-page .template-card .edit-operation:hover {background-image: url("images/edit_hover.png");}.template-card-page .template-card .edit-operation.disable {display: none;}.template-card-page .template-card .template-operation a{display: inline-block; width: 100%; height: 100%;}.template-card-page .template-card .create-app-from-template-operation{height: 40px; width: 40px; background-image: url("images/add.png");}.template-card-page .template-card .create-app-from-template-operation:hover {background-image: url("images/add_hover.png");}.template-card-page .template-card .more-operation {height: 40px; width: 40px; background-image: url("images/more.png");}.template-card-page .template-card .more-operation:hover {background-image: url("images/more_hover.png");}.template-card-page .template-card .more-operation.item-more-selected{background-image: url("images/more_selected.png");}.template-card-page .template-card .more-operation.disable {display: none;}.card-page {position: relative; overflow: hidden;}.card-page .card-page-content {max-width: 1300px; min-width: 1024px; margin: 0px auto 0; padding-top: 20px; overflow: hidden; padding-left: 20px; min-height: 340px;}.card-page .item-card {position: relative; width: 300px; height: 350px; margin-right: 20px; margin-bottom: 20px; background-color: #ffffff; box-shadow: 0 0 10px rgba(0, 0, 0, 0.1); border-bottom-left-radius: 4px; border-bottom-right-radius: 4px;}.card-page .item-card .item-type-div {position: absolute; background-repeat: no-repeat; background-position: center; width: 30px; height: 22px; bottom: 10px; right: 5px;}.jimu-rtl .card-page .item-card .item-type-div {right: auto; left: 5px;}.card-page .item-card .item-type-2d {background-image: url("images/flag_2d.png");}.card-page .item-card .item-type-3d {background-image: url("images/flag_3d.png");}.card-page .item-card .thumbnail-part {position: relative; display: inline-block; width: 100%; height: 200px; background-repeat: no-repeat; background-position: center; background-size: 100% 100%;}.card-page .item-card .appInfo-part {width: 100%; height: 109px; overflow: hidden;}.card-page .item-card .appInfo-part .item-name {width: 100%; height: 60px;}.card-page .item-card .appInfo-part .item-name-div {max-height: 39px; line-height: 20px; overflow: hidden; white-space: normal; word-wrap: break-word; word-break: break-word; padding-left: 20px; padding-right: 20px; font-size: 14px; color: #333333; font-family: "Avenir Medium"; font-weight: bold; margin-top: 9px;}.card-page .item-card .appInfo-part .item-info-div {padding-left: 20px; padding-right: 20px; color: #999999; font-size: 12px; line-height: 13px; margin-top: 12px; margin-bottom: 9px; overflow: hidden;}.card-page .item-card .appInfo-part .item-des-div {width: 100%; overflow: hidden; line-height: 22px; font-size: 12px; color: #666666; white-space: normal; word-wrap: break-word; word-break: break-word; padding-left: 20px; padding-right: 20px;}.card-page .item-card .appInfo-part .item-des-div.place-holder-class {color: #cccccc;}.card-page .item-card .item-operation-part {position: relative; position: relative; width: 280px; height: 41px; left: 10px; border-top: 1px solid #e5e5e5;}.jimu-rtl .card-page .item-card .item-operation-part {right: 10px; left: auto;}.card-page .item-card .item-operation {background-repeat: no-repeat; background-position: center; overflow: hidden; cursor: pointer;}.card-page .item-card .launch-operation {height: 40px; width: 40px; background-image: url("images/view.png");}.card-page .item-card .launch-operation:hover {background-image: url("images/view_hover.png");}.card-page .item-card .download-operation {height: 40px; width: 40px; background-image: url("images/download.png");}.card-page .item-card .download-operation:hover {background-image: url("images/download_hover.png");}.card-page .item-card .edit-operation {height: 40px; width: 40px; background-image: url("images/edit.png");}.card-page .item-card .edit-operation:hover {background-image: url("images/edit_hover.png");}.card-page .item-card .edit-operation.disable {display: none;}.card-page .item-card .item-operation a{display: inline-block; width: 100%; height: 100%;}.card-page .item-card .create-app-from-item-operation{height: 40px; width: 40px; background-image: url("images/add.png");}.card-page .item-card .create-app-from-item-operation:hover {background-image: url("images/add_hover.png");}.card-page .item-card .more-operation {height: 40px; width: 40px; background-image: url("images/more.png");}.card-page .item-card .more-operation:hover {background-image: url("images/more_hover.png");}.card-page .item-card .more-operation.item-more-selected{background-image: url("images/more_selected.png");}.card-page .item-card .more-operation.disable {display: none;}.card-page-with-small-thumbnail {position: relative; overflow: hidden;}.card-page-with-small-thumbnail .app-card-page-content {max-width: 1300px; min-width: 1024px; margin: 0 auto 0; overflow: hidden; padding-left: 20px; padding-top: 20px; min-height: 340px;}.card-page-with-small-thumbnail .app-card-box {position: relative; width: 300px; height: 220px; margin-right: 20px; margin-bottom: 20px; background-color: #ffffff; box-shadow: 0 0 10px rgba(0, 0, 0, 0.1); border-bottom-left-radius: 4px; border-bottom-right-radius: 4px;}.card-page-with-small-thumbnail .app-card-box .card {height: 100%; width: 100%;}.card-page-with-small-thumbnail .app-card-box .app-info-card {}.card-page-with-small-thumbnail .app-card-box .app-info-card .app-title-part {position: relative; width: 100%; height: 120px;}.card-page-with-small-thumbnail .app-card-box .app-info-card .app-title-part .app-type-div {position: absolute; background-repeat: no-repeat; background-position: center; width: 30px; height: 20px; top: 5px; right: 5px;}.jimu-rtl .card-page-with-small-thumbnail .app-card-box .app-info-card .app-title-part .app-type-div {right: auto; left: 5px;}.card-page-with-small-thumbnail .app-card-box .app-info-card .app-title-part .app-type-2d {background-image: url("images/flag_2d.png");}.card-page-with-small-thumbnail .app-card-box .app-info-card .app-title-part .app-type-3d {background-image: url("images/flag_3d.png");}.card-page-with-small-thumbnail .app-card-box .app-info-card .app-title-part .app-title-table {width: 100%; height: 100%;}.card-page-with-small-thumbnail .app-card-box .app-info-card .app-title-part .app-thumbnail-td {width: 155px; height: 100%;}.card-page-with-small-thumbnail .app-card-box .app-info-card .app-title-part .app-thumbnail {width: 120px; height: 80px; border-radius: 4px; display: block; background-repeat: no-repeat; background-position: center; margin-left: 20px; background-size: 100% 100%;}.jimu-rtl .card-page-with-small-thumbnail .app-card-box .app-info-card .app-title-part .app-thumbnail {margin-left: auto; margin-right: 20px;}.card-page-with-small-thumbnail .app-card-box .app-info-card .app-title-part .app-title-td {display: inline-block;}.card-page-with-small-thumbnail .app-card-box .app-info-card .app-title-part .app-title-div {line-height: 16px; max-height: 32px; overflow: hidden; white-space: normal; word-wrap: break-word; word-break: break-word; padding-right: 10px; font-family: "Avenir Medium"; font-size: 14px; color: #333333; font-weight: bold; margin-top: 25px;}.card-page-with-small-thumbnail .app-card-box .app-info-card .app-title-part .app-time-div {color: #999999; font-size: 12px; line-height: 12px; margin-top: 14px; margin-bottom: 10px;}.card-page-with-small-thumbnail .app-card-box .app-info-card .app-title-part .app-creator-div {color: #999999; font-size: 12px; line-height: 12px;}.card-page-with-small-thumbnail .app-card-box .app-info-card .app-desc-box {position: relative; width: 100%; height: 59px;}.card-page-with-small-thumbnail .app-card-box .app-info-card .app-desc-part {width: 100%; height: 42px; overflow: hidden; line-height: 18px; font-size: 12px; color: #666666; white-space: normal; word-wrap: break-word; word-break: break-word; padding-left: 20px; padding-right: 20px; padding-top: 5px;}.card-page-with-small-thumbnail .app-card-box .app-info-card .app-desc-part.place-holder-class {color: #cccccc;}.jimu-rtl .card-page-with-small-thumbnail .app-card-box .app-info-card .app-desc-part {}.card-page-with-small-thumbnail .app-card-box .app-operation-part {position: relative; width: 280px; height: 41px; left: 10px; border-top: 1px solid #e5e5e5;}.jimu-rtl .card-page-with-small-thumbnail .app-card-box .app-operation-part {right: 10px; left: auto;}.card-page-with-small-thumbnail .app-card-box .app-operation {background-repeat: no-repeat; background-position: center; overflow: hidden; cursor: pointer;}.card-page-with-small-thumbnail .app-card-box .app-operation.disable {display: none;}.card-page-with-small-thumbnail .app-card-box .download-operation {height: 40px; width: 40px; background-image: url("images/download.png");}.card-page-with-small-thumbnail .app-card-box .download-operation:hover {background-image: url("images/download_hover.png");}.card-page-with-small-thumbnail .app-card-box .edit-operation {height: 40px; width: 40px; background-image: url("images/edit.png");}.card-page-with-small-thumbnail .app-card-box .edit-operation:hover {background-image: url("images/edit_hover.png");}.card-page-with-small-thumbnail .app-card-box .launch-operation {height: 40px; width: 40px; background-image: url("images/view.png");}.card-page-with-small-thumbnail .app-card-box .launch-operation:hover {background-image: url("images/view_hover.png");}.card-page-with-small-thumbnail .app-card-box .app-operation a{display: inline-block; width: 100%; height: 100%;}.card-page-with-small-thumbnail .app-card-box .create-app-from-item-operation{height: 40px; width: 40px; background-image: url("images/add.png");}.card-page-with-small-thumbnail .app-card-box .create-app-from-item-operation:hover {background-image: url("images/add_hover.png");}.card-page-with-small-thumbnail .app-card-box .more-operation {height: 40px; width: 40px; background-image: url("images/more.png");}.card-page-with-small-thumbnail .app-card-box .more-operation:hover {background-image: url("images/more_hover.png");}.card-page-with-small-thumbnail .app-card-box .more-operation.item-more-selected {background-image: url("images/more_selected.png");}body{background-color: white;}#main-view-stack{position: absolute; top: 40px; bottom: 0; left: 0; right: 0; height: auto; overflow: hidden; background-color: #E3ECF2;}.plugin-app-list {position: relative; background-color: #f8f9fb;}.plugin-app-list .header {width: 100%; background-color: #ffffff;}.plugin-app-list .header .navigator-box{width: 100%; height: 50px; border-bottom: 1px solid #e5e5e5;}.plugin-app-list .header .navigator{position: relative; min-width: 1024px; max-width: 1300px; padding-left: 20px; padding-right: 20px; height: 50px; margin: 0 auto;}.plugin-app-list .header .navigator .filter-box{}.plugin-app-list .header .navigator .filter{margin-right:10px; height: 50px; line-height: 50px; color: #999999; font-size: 14px; min-width: 40px; text-align: center;}.jimu-rtl .plugin-app-list .header .navigator .filter{margin-left: 10px; margin-right: auto;}.plugin-app-list .header .navigator .filter.selected{color: #d84b28; border-bottom: 2px solid #d84b28;}.plugin-app-list .header .navigator .filter:hover{color: #d84b28; cursor: pointer; border-bottom: 2px solid #d84b28;}.plugin-app-list .header .navigator .sort-box{padding-left: 20px; padding-right: 20px;}.plugin-app-list .header .navigator .sort {margin-right: 15px; height: 50px; width: 16px; background-repeat: no-repeat; background-position: center; cursor: pointer;}.plugin-app-list .header .navigator .sort-box .by-modified-time {background-image: url(images/most_recent.png);}.plugin-app-list .header .navigator .sort.by-modified-time.selected{background-image: url(images/most_recent_selected.png);}.plugin-app-list .header .navigator .sort.by-modified-time:hover{background-image: url(images/most_recent_hover.png);}.plugin-app-list .header .navigator .sort-box .by-name {background-image: url(images/by_name.png);}.plugin-app-list .header .navigator .sort.by-name.selected{background-image: url(images/by_name_selected.png);}.plugin-app-list .header .navigator .sort.by-name:hover{background-image: url(images/by_name_hover.png);}.plugin-app-list .header .navigator .sort-box .by-author {background-image: url(images/by_author.png);}.plugin-app-list .header .navigator .sort.by-author.selected{background-image: url(images/by_author_selected.png);}.plugin-app-list .header .navigator .sort.by-author:hover{background-image: url(images/by_author_hover.png);}.plugin-app-list .header .navigator .search{width: 300px; border: 1px solid #e5e5e5; border-radius: 15px; margin-top: 10px; padding-left: 5px;}.plugin-app-list .header .navigator .search .search-box{height: 30px; width: 250px; border: 0 solid; border-radius: 25px;}.plugin-app-list .header .navigator .search .search-box.dijitText{border-color: #ffffff !important; box-shadow: 0 0 0 #ffffff !important; background-image: none;}.plugin-app-list .header .navigator .search .search-box.dijitTextBoxFocused {border-color: #ffffff !important; box-shadow: 0 0 0 #ffffff !important; background-image: none;}.plugin-app-list .header .navigator .search .search-box.dijitTextBoxHover{background-color: #ffffff !important; border-color: #ffffff !important; background-image: none;}.plugin-app-list .header .navigator .search .search-box .dijitInputContainer {margin: 1px 5px;}.plugin-app-list .header .navigator .search .search-box .dijitInputInner{box-shadow: 0px 0px 0px #FFF !important;}.plugin-app-list .header .navigator .search .search-box .dijitPlaceHolder{font-style: normal;}.plugin-app-list .header .navigator .search .search-btn{width: 40px; height: 30px; background-image: url(images/search.png); background-repeat: no-repeat; background-position: center center;}.plugin-app-list .switch-app-page-box {position: absolute; right: 20px; bottom: 20px; z-index: 1;}.jimu-rtl .plugin-app-list .switch-app-page-box {left: 20px; right: auto;}.plugin-app-list .switch-app-page-box.hidden {display: none;}.plugin-app-list .switch-app-page-box .switch-app-page-btn {width: 21px; height: 21px; background-repeat: no-repeat; background-position: center center; cursor: pointer;}.plugin-app-list .switch-app-page-box .switch-app-page-btn.card-page {background-image: url(images/card.png);}.plugin-app-list .switch-app-page-box .switch-app-page-btn.card-page.selected {background-image: url(images/card_selected.png);}.plugin-app-list .switch-app-page-box .switch-app-page-btn.card-page:hover {background-image: url(images/card_hover.png);}.plugin-app-list .switch-app-page-box .switch-app-page-btn.catalog-page {background-image: url(images/catalog.png);}.plugin-app-list .switch-app-page-box .switch-app-page-btn.catalog-page.selected {background-image: url(images/catalog_selected.png);}.plugin-app-list .switch-app-page-box .switch-app-page-btn.catalog-page:hover {background-image: url(images/catalog_hover.png);}.plugin-app-list .switch-app-page-box .switch-app-page-btn.card-page2 {background-image: url(images/card.png);}.plugin-app-list .switch-app-page-box .switch-app-page-btn.card-page2.selected {background-image: url(images/card_selected.png);}.plugin-app-list .switch-app-page-box .switch-app-page-btn.card-page2:hover {background-image: url(images/card_hover.png);}.plugin-app-list .operation-box{position: relative; min-width: 1024px; max-width: 1300px; margin: 0 auto; height: 60px; padding-left: 20px; padding-right: 20px; padding-top: 20px;}.plugin-app-list .create{width: 150px; height: 40px; line-height: 40px; background-color: #31aacd; color: #ffffff; font-size: 14px; font-weight: bold; border-radius: 2px; cursor: pointer; text-align: center; margin-right: 20px;}.plugin-app-list .create:hover{background-color: #1b91b3;}.jimu-rtl .plugin-app-list .create{margin-left: 20px; margin-right: auto;}.plugin-app-list .content-box {position: absolute; left: 0; right: 0; top: 50px; bottom: 0; overflow: auto;}.plugin-app-list .content {display: none; min-height: 540px;}.plugin-app-list .content.selected{display: block;}.plugin-app-list .content .app-page-box {height: 100%; display: none;}.plugin-app-list .content .app-page-box.selected {display: block;}.plugin-app-list .footer {color: #999999; font-size: 12px; overflow: hidden; text-align: center;}.plugin-app-list .footer .footer-text {padding-left: 20px; padding-right: 20px; margin: 120px auto 30px; text-align: center; display: inline-block;}.plugin-app-list .footer .separator {margin-left: 5px; margin-right: 5px; font-weight: bold;}.plugin-app-list .footer a {text-decoration: none; color: #999999;}.plugin-app-list .empty-description-box {text-align: center; margin-top: 210px;}.plugin-app-list .empty-description-box.card-page{padding-right: 20px;}.plugin-app-list .empty-description {display: inline-block; text-align: left; color: #999999; font-size: 16px; font-family: "Avenir Medium"; line-height: 26px;}.plugin-app-list .empty-description span{color: #000000;}.fullscreen-popup-container .content .image-chooser-container{width: 150px; margin: 0 auto; padding: 30px 0; text-align: center; position: relative;}.fullscreen-popup-container .content .image-chooser-container.imageChooserTemplate{width: 300px;}.fullscreen-popup-container .content .image-chooser-container .image-chooser-masker{position: absolute; display: none; background-color: rgba(0,0,0,.8); text-align: center; font-size: 14px; color: #fff; z-index: 9999; cursor:pointer;}.fullscreen-popup-container .content .image-chooser-container.imageChooserApp .image-chooser-base{width: 150px; height: 150px; background-color: #31aacd; border-radius: 50%;}.fullscreen-popup-container .content .image-chooser-container.imageChooserApp .jimu-image-chooser{width: 80px; height: 80px; background-color: #f7fafa; border-radius: 10px; margin-top: 35px;}.fullscreen-popup-container .content .image-chooser-container .image-chooser-masker.imageChooserApp{width: 150px; height: 150px; border-radius: 50%; line-height: 150px;}.fullscreen-popup-container .content .image-chooser-container.imageChooserTemplate .image-chooser-base{width: 330px; height: 230px; border: 1px solid #ccc; border-radius: 4px; background-size: 100% 100%; padding: 10px; background-color: #fff;}.fullscreen-popup-container .content .image-chooser-container.imageChooserTemplate .jimu-image-chooser{width: 100%; height: 100%;}.fullscreen-popup-container .content .image-chooser-container .image-chooser-masker.imageChooserTemplate{width: 330px; height: 230px; line-height: 210px; border-radius: 5px;}.fullscreen-popup-container .content .app-info-edit label{display: block; font-size: 14px; color:#333;}.fullscreen-popup-container .content .app-info-edit .app-info-edit-name{height:40px; line-height: 40px; width: 100%; margin: 15px 0 30px 0;}.fullscreen-popup-container .content .app-info-edit .app-info-edit-summary{height:100px; width: 100%; margin: 15px 0 30px 0; padding: 5px 10px; font-size: 12px; font-family: "Avenir Light";}.jimu-popup.jimu-popup-in-home .jimu-btn{background-color: #31aacd;}.jimu-popup.jimu-popup-in-home .jimu-btn:hover{background-color: #1b91b3;}.jimu-popup.jimu-popup-in-home .jimu-btn.jimu-btn-vacation{background-color: #FFFFFF; border: 1px solid #31aacd; color: #31aacd;}.jimu-popup.jimu-popup-in-home .jimu-btn.jimu-btn-vacation:hover{background-color: #f4f4f4;}',
"url:builder/plugins/attribute-config/Plugin.html":'\x3cdiv class\x3d"attribute-config" \x3e\r\n  \x3cdiv data-dojo-attach-point\x3d"attributeSection"\x3e\r\n    \x3cdiv class\x3d"section jimu-float-leading header-section" data-dojo-attach-point\x3d"headerSection"\x3e\r\n      \x3cdiv class\x3d"title"\x3e\r\n        \x3cspan\x3e${nls.headerTitle}\x3c/span\x3e\r\n      \x3c/div\x3e\r\n      \x3cdiv class\x3d"action-text"\x3e${nls.headerDesc}\x3c/div\x3e\r\n\r\n      \x3cdiv data-dojo-attach-point\x3d"logoNodeDiv"\x3e\x3c/div\x3e\r\n\r\n      \x3cdiv class\x3d"titles jimu-float-leading"\x3e\r\n        \x3cdiv style\x3d"background-color:#fafafc;" class\x3d"title" data-dojo-attach-point\x3d"titleNodeDiv"\x3e\r\n          \x3cinput placeholder\x3d"${nls.title}" data-dojo-attach-point\x3d"titleNode" maxLength\x3d"100" class\x3d"styled-text"\x3e\r\n          \x3cspan class\x3d"label-editor" title\x3d"${nls.formatStyle}" data-dojo-attach-event\x3d"click:onTitleEditorClick"\x3e\x3c/span\x3e\r\n        \x3c/div\x3e\r\n        \x3cdiv style\x3d"background-color:#fafafc;" class\x3d"subtitle" data-dojo-attach-point\x3d"subtitleNodeDiv"\x3e\r\n          \x3cinput  placeholder\x3d"${nls.subtitle}" data-dojo-attach-point\x3d"subtitleNode" maxLength\x3d"100"  class\x3d"styled-text"\x3e\r\n          \x3cspan class\x3d"label-editor"  title\x3d"${nls.formatStyle}" data-dojo-attach-event\x3d"click:onSubtitleEditorClick"\x3e\x3c/span\x3e\r\n        \x3c/div\x3e\r\n      \x3c/div\x3e\r\n    \x3c/div\x3e\r\n\r\n    \x3cdiv class\x3d"section jimu-float-leading links-section" data-dojo-attach-point\x3d"linksSection"\x3e\r\n      \x3cdiv class\x3d"title"\x3e\r\n        \x3cspan\x3e${nls.linksTitle}\x3c/span\x3e\r\n      \x3c/div\x3e\r\n      \x3c!--\r\n      \x3cdiv class\x3d"attribute-content"\x3e\r\n        \x3cdiv class\x3d"list-header"\x3e\r\n          \x3cspan class\x3d"header-button add" data-dojo-attach-event\x3d"onclick: onAddLinkClick"\x3e${nls.addLink}\x3c/span\x3e\r\n          \x3cspan class\x3d"header-button edit" data-dojo-attach-event\x3d"onclick: onEditLinkClick"\x3e${nls.editLabel}\x3c/span\x3e\r\n          \x3cspan class\x3d"header-button delete" data-dojo-attach-event\x3d"onclick: onDeleteLinkClick"\x3e${nls.deleteLabel}\x3c/span\x3e\r\n        \x3c/div\x3e\r\n        \x3cdiv class\x3d"links-list" data-dojo-attach-point\x3d"linksListNode"\x3e\r\n        \x3c/div\x3e\r\n      \x3c/div\x3e\r\n      --\x3e\r\n    \x3c/div\x3e\r\n\r\n    \x3cdiv class\x3d"section jimu-float-leading appId-section" data-dojo-attach-point\x3d"appIdSection" style\x3d"display:none"\x3e\r\n      \x3cdiv class\x3d"title"\x3e\r\n        \x3cspan\x3e${nls.appIdTitle}\x3c/span\x3e\r\n      \x3c/div\x3e\r\n      \x3ca target\x3d"_blank" href\x3d"http://doc.arcgis.com/en/arcgis-online/share-maps/add-items.htm#ESRI_SECTION2_20AF85308FD548B5ADBAE28836F66D3F"\x3e${nls.appIdAbout}\x3c/a\x3e\r\n      \x3cdiv class\x3d"attribute-content"\x3e\r\n        \x3cinput type\x3d"text" placeholder\x3d"AppId" data-dojo-attach-point\x3d"appIdNode" /\x3e\r\n      \x3c/div\x3e\r\n    \x3c/div\x3e\r\n\r\n    \x3cdiv class\x3d"section jimu-float-leading" data-dojo-attach-point\x3d"useProxySection" style\x3d"display:none"\x3e\r\n      \x3cdiv class\x3d"proxy-setting" data-dojo-attach-point\x3d"useProxySetting"\x3e\x3c/div\x3e\r\n      \x3cdiv class\x3d"proxy-section" data-dojo-attach-point\x3d"proxySection"\x3e\r\n        \x3clabel class\x3d"rules-label"\x3e${nls.proxyRulesLabel}\x3c/label\x3e\r\n        \x3cdiv class\x3d"attribute-content"\x3e\r\n          \x3cdiv class\x3d"list-header"\x3e\r\n            \x3cspan class\x3d"header-button add" data-dojo-attach-event\x3d"onclick: onAddProxyRuleClick"\x3e${nls.addProxyRule}\x3c/span\x3e\r\n            \x3cspan class\x3d"header-button edit" data-dojo-attach-event\x3d"onclick: onEditProxyRuleClick"\x3e${nls.editLabel}\x3c/span\x3e\r\n            \x3cspan class\x3d"header-button delete" data-dojo-attach-event\x3d"onclick: onDeleteProxyRuleClick"\x3e${nls.deleteLabel}\x3c/span\x3e\r\n          \x3c/div\x3e\r\n          \x3cdiv class\x3d"proxy-rule-header"\x3e\r\n            \x3cdiv class\x3d"prefix"\x3e${nls.prefixHeader}\x3c/div\x3e\r\n            \x3cdiv class\x3d"proxy-url"\x3e${nls.proxyUrlHeader}\x3c/div\x3e\r\n          \x3c/div\x3e\r\n          \x3cdiv class\x3d"proxy-rule-list" data-dojo-attach-point\x3d"proxyRulesListNode"\x3e\x3c/div\x3e\r\n        \x3c/div\x3e\r\n\r\n        \x3cdiv class\x3d"always-use-proxy" data-dojo-attach-point\x3d"alwaysUseProxy"\x3e\x3c/div\x3e\r\n        \x3cdiv class\x3d"attribute-content" data-dojo-attach-point\x3d"proxyUrlSection" \x3e\r\n          \x3cinput type\x3d"text" placeholder\x3d"${nls.proxyUrl}" data-dojo-attach-point\x3d"proxyUrlNode" /\x3e\r\n        \x3c/div\x3e\r\n      \x3c/div\x3e\r\n    \x3c/div\x3e\r\n\r\n    \x3cdiv class\x3d"section jimu-float-leading section-appstate"\r\n         data-dojo-attach-point\x3d"appStateController"\x3e\r\n      \x3cdiv class\x3d"title"\x3e\r\n        \x3cspan\x3e${nls.appState}\x3c/span\x3e\r\n      \x3c/div\x3e\r\n      \x3cdiv class\x3d"action-text"\x3e\r\n        \x3cdiv class\x3d"appstate-check" data-dojo-attach-point\x3d"appStateSetting"\x3e\x3c/div\x3e\r\n      \x3c/div\x3e\r\n    \x3c/div\x3e\r\n    \x3c!-- Additional Data Sources --\x3e\r\n    \x3cdiv class\x3d"section jimu-float-leading datasources"\r\n        data-dojo-attach-event\x3d"click:_openDataSourcesPage" data-dojo-attach-point\x3d"dataSourceSection"\x3e\r\n        \x3cdiv class\x3d"title"\x3e\r\n          \x3cspan\x3e${nls.customDataSource}\x3c/span\x3e\r\n          \x3cdiv class\x3d"arrow-forward feature-action jimu-float-trailing icon-arrow-right"\x3e\x3c/div\x3e\r\n        \x3c/div\x3e\r\n        \x3cdiv class\x3d"action-text"\x3e${nls.dataSourceIntroduce}\x3c/div\x3e\r\n      \x3c/div\x3e\r\n\r\n    \x3cdiv class\x3d"section jimu-float-leading controller-loading"\r\n         data-dojo-attach-point\x3d"loadingPageController"\x3e\r\n      \x3cdiv class\x3d"title"\x3e\r\n        \x3cspan\x3e${nls.loadingPageTitle}\x3c/span\x3e\r\n        \x3cdiv class\x3d"arrow-forward feature-action jimu-float-trailing"\x3e\x3c/div\x3e\r\n      \x3c/div\x3e\r\n      \x3cdiv class\x3d"action-text"\x3e${nls.setLoadingPage}\x3c/div\x3e\r\n    \x3c/div\x3e\r\n\r\n    \x3cdiv class\x3d"section jimu-float-leading controller-appproxy"\r\n         data-dojo-attach-point\x3d"appProxyController"\x3e\r\n      \x3cdiv class\x3d"title"\x3e\r\n        \x3cspan\x3e${nls.appProxy}\x3c/span\x3e\r\n        \x3cdiv class\x3d"arrow-forward feature-action jimu-float-trailing"\x3e\x3c/div\x3e\r\n      \x3c/div\x3e\r\n      \x3cdiv class\x3d"action-text"\x3e${nls.configureAppProxy}\x3c/div\x3e\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e\r\n\r\n  \x3cdiv class\x3d"jimu-float-leading loadingpage-section"\r\n       data-dojo-attach-point\x3d"loadingPageSection" style\x3d"display:none"\x3e\r\n    \x3cdiv class\x3d"attribute-link"\x3e\r\n      \x3cdiv class\x3d"arrow-back feature-action jimu-float-leading" data-dojo-attach-point\x3d"backController"\x3e\x3c/div\x3e\r\n      \x3cspan\x3e${nls.loadingPageTitle}\x3c/span\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv class\x3d"config-part"\x3e\r\n      \x3cdiv\x3e\r\n        \x3cspan class\x3d"label"\x3e${nls.backgroudColor}\x3c/span\x3e\r\n        \x3cdiv data-dojo-attach-point\x3d"bgColorPicker"\r\n             data-dojo-type\x3d"jimu/dijit/ColorPicker" title\x3d"${nls.selectBackgoundColor}"\r\n             class\x3d"bgColor-control" class\x3d"jimu-float-trailing"\r\n             data-dojo-props\x3d"showLabel:true"\x3e\r\n        \x3c/div\x3e\r\n      \x3c/div\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv class\x3d"config-part"\x3e\r\n      \x3cdiv data-dojo-attach-point\x3d"bgCheckBoxDiv"\x3e\x3c/div\x3e\r\n      \x3cdiv data-dojo-attach-point\x3d"bgUploaderDiv" class\x3d"jimu-leading-margin2"\x3e\r\n        \x3cdiv data-dojo-attach-point\x3d"bgImageChooser"\x3e\r\n        \x3c/div\x3e\r\n      \x3c/div\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv class\x3d"config-part"\x3e\r\n      \x3cdiv data-dojo-attach-point\x3d"gifCheckBoxDiv"\x3e\x3c/div\x3e\r\n      \x3cdiv data-dojo-attach-point\x3d"gifModeSection" class\x3d"jimu-leading-margin2" style\x3d"margin-top:10px;"\x3e\r\n        \x3cinput class\x3d"jimu-radio-btn" name\x3d"gifMode" type\x3d"radio" data-dojo-attach-point\x3d"selectMode"\r\n            data-dojo-attach-event\x3d"onclick: _onSelectGifMode"/\x3e\r\n        \x3clabel\x3e${nls.selectPredefinedGif}\x3c/label\x3e\x3cbr/\x3e\r\n        \x3cdiv data-dojo-attach-point\x3d"predefinedGif" class\x3d"jimu-leading-margin2" style\x3d"display:none;"\x3e\r\n          \x3cdiv data-dojo-attach-point\x3d"gifSelect" style\x3d"margin-top:10px;"\r\n                  data-dojo-type\x3d"dijit/form/Select"\x3e\r\n            \x3cspan value\x3d"0"\x3e${nls.selectGif}\x3c/span\x3e\r\n            \x3cspan value\x3d"1"\x3e\r\n              \x3cdiv style\x3d"background:#3bb6d5;height:34px;"\x3e\r\n                \x3cimg width\x3d"58" height\x3d"29" style\x3d"margin-top:2px;" src\x3d"${folderUrl}images/loading1.gif"/\x3e\r\n              \x3c/div\x3e\r\n            \x3c/span\x3e\r\n            \x3cspan value\x3d"2"\x3e\r\n              \x3cdiv style\x3d"background:#3bb6d5;height:34px;"\x3e\r\n                \x3cimg width\x3d"58" height\x3d"10" style\x3d"margin-top:12px;" src\x3d"${folderUrl}images/loading2.gif"/\x3e\r\n              \x3c/div\x3e\r\n            \x3c/span\x3e\r\n            \x3cspan value\x3d"3"\x3e\r\n              \x3cdiv style\x3d"background:#3bb6d5;height:34px;"\x3e\r\n                \x3cimg width\x3d"32" height\x3d"32" src\x3d"${folderUrl}images/loading3.gif"/\x3e\r\n              \x3c/div\x3e\r\n            \x3c/span\x3e\r\n            \x3cspan value\x3d"4"\x3e\r\n              \x3cdiv style\x3d"background:#3bb6d5;height:34px;"\x3e\r\n                \x3cimg width\x3d"34" height\x3d"34" src\x3d"${folderUrl}images/loading4.gif"/\x3e\r\n              \x3c/div\x3e\r\n            \x3c/span\x3e\r\n          \x3c/div\x3e\r\n        \x3c/div\x3e\r\n        \x3cinput class\x3d"jimu-radio-btn" name\x3d"gifMode" type\x3d"radio" data-dojo-attach-point\x3d"uploadMode"\r\n            data-dojo-attach-event\x3d"onclick: _onUploadGifMode"\r\n            style\x3d"margin-top:10px;"/\x3e\r\n        \x3clabel\x3e${nls.uploadCustomGif}\x3c/label\x3e\x3cbr/\x3e\r\n        \x3cdiv data-dojo-attach-point\x3d"customGif" class\x3d"jimu-leading-margin2" style\x3d"display:none;"\x3e\r\n          \x3cdiv data-dojo-attach-point\x3d"gifImageChooser"\x3e\r\n          \x3c/div\x3e\r\n        \x3c/div\x3e\r\n      \x3c/div\x3e\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e\r\n\r\n  \x3cdiv class\x3d"jimu-float-leading appproxy-section"\r\n       data-dojo-attach-point\x3d"appProxySection" style\x3d"display:none"\x3e\r\n    \x3cdiv class\x3d"attribute-link"\x3e\r\n      \x3cdiv class\x3d"arrow-back feature-action jimu-float-leading" data-dojo-attach-point\x3d"backController2"\x3e\x3c/div\x3e\r\n      \x3cspan\x3e${nls.appProxy}\x3c/span\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv class\x3d"sub-section" data-dojo-attach-point\x3d"mapSection"\x3e\r\n      \x3cdiv class\x3d"title"\x3e${nls.mapLayers}\x3c/div\x3e\r\n      \x3cdiv class\x3d"note"\x3e${nls.mapLayersNote}\x3c/div\x3e\r\n      \x3cdiv class\x3d"header"\x3e\r\n        \x3cdiv class\x3d"sepeartor"\x3e\x3c/div\x3e\r\n        \x3cdiv class\x3d"row"\x3e\r\n          \x3cdiv class\x3d"col col-layername"\x3e${nls.layerName}\x3c/div\x3e\r\n          \x3cdiv class\x3d"col col-credits"\x3e${nls.consumeCredits}\x3c/div\x3e\r\n          \x3cdiv class\x3d"col col-proxy"\x3e${nls.useProxy}\x3c/div\x3e\r\n        \x3c/div\x3e\r\n        \x3cdiv class\x3d"sepeartor"\x3e\x3c/div\x3e\r\n      \x3c/div\x3e\r\n      \x3cdiv class\x3d"content" data-dojo-attach-point\x3d"mapProxyContent"\x3e\r\n      \x3c/div\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv class\x3d"sub-section double-margin" data-dojo-attach-point\x3d"urlSection"\x3e\r\n      \x3cdiv class\x3d"title"\x3e${nls.customUrls}\x3c/div\x3e\r\n      \x3cdiv class\x3d"note"\x3e${nls.customUrlsNote}\x3c/div\x3e\r\n      \x3cdiv class\x3d"add-url-btn" data-dojo-attach-point\x3d"linkEditorNode"\x3e\x3c/div\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv class\x3d"sub-section double-margin"\x3e\r\n      \x3cdiv class\x3d"title"\x3e${nls.note}\x3c/div\x3e\r\n      \x3cdiv class\x3d"note-content"\x3e\r\n        ${nls.creditsNote}\r\n      \x3c/div\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv data-dojo-attach-point\x3d"loadingNode" class\x3d"loading"\x3e\x3c/div\x3e\r\n  \x3c/div\x3e\r\n\r\n  \x3cdiv class\x3d"jimu-float-leading datasources-section" style\x3d"display:none"\x3e\r\n    \x3cdiv class\x3d"datasources-link"\x3e\r\n      \x3cdiv class\x3d"arrow-back feature-action jimu-float-leading icon-arrow-back" data-dojo-attach-point\x3d"backMapController"\r\n      data-dojo-attach-event\x3d"click:_closeDataSourcesPage"\x3e\x3c/div\x3e\r\n      \x3cspan\x3e${nls.customDataSource}\x3c/span\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv data-dojo-attach-point\x3d"additionalDataSourcesDiv" style\x3d"width: 100%;height: 100%;overflow:hidden;"\x3e\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e\r\n\r\n\x3c/div\x3e\r\n',
"url:builder/plugins/attribute-config/AttrbuteLogoChooser.html":'\x3cdiv class\x3d"jimu-float-leading jimu-trailing-margin1" data-dojo-attach-point\x3d"logoContainer"\r\n data-dojo-attach-event\x3d"onmouseenter:onMouseEnterHandler"\r\n data-dojo-attach-event\x3d"onmouseleave:onMouseLeaveHandler"\x3e\r\n  \x3cdiv data-dojo-type\x3d"jimu/dijit/ImageChooser" data-dojo-attach-point\x3d"imageChooser"\r\n  data-dojo-props\x3d"cropImage:false,showSelfImg:true,goldenWidth:30,goldenHeight:30,format:[\'image/gif\',\'image/png\',\'image/jpeg\']"\x3e\x3c/div\x3e\r\n  \x3cdiv class\x3d"add-logo" data-dojo-attach-point\x3d"addLogoNode"\x3e\r\n    \x3cdiv class\x3d"image"\x3e\x3c/div\x3e\r\n  \x3c/div\x3e\r\n\r\n  \x3cdiv class\x3d"masker-node" data-dojo-attach-point\x3d"maskerNode"\x3e\x3c/div\x3e\r\n\r\n  \x3cdiv class\x3d"remove-logo" data-dojo-attach-point\x3d"removeLogoNode" data-dojo-attach-event\x3d"onclick:onRemoveLogoHandler"\x3e\x3c/div\x3e\r\n\x3c/div\x3e',
"url:dijit/templates/TooltipDialog.html":'\x3cdiv role\x3d"alertdialog" tabIndex\x3d"-1"\x3e\r\n\t\x3cdiv class\x3d"dijitTooltipContainer" role\x3d"presentation"\x3e\r\n\t\t\x3cdiv data-dojo-attach-point\x3d"contentsNode" class\x3d"dijitTooltipContents dijitTooltipFocusNode"\x3e\r\n\t\t\t\x3cdiv data-dojo-attach-point\x3d"containerNode"\x3e\x3c/div\x3e\r\n\t\t\t${!actionBarTemplate}\r\n\t\t\x3c/div\x3e\r\n\t\x3c/div\x3e\r\n\t\x3cdiv class\x3d"dijitTooltipConnector" role\x3d"presentation" data-dojo-attach-point\x3d"connectorNode"\x3e\x3c/div\x3e\r\n\x3c/div\x3e\r\n',
"url:builder/dijit/templates/SharedThemeChooserPopup.html":'\x3cdiv class\x3d"shared-theme-chooser-popup"\x3e\r\n  \x3cdiv class\x3d"btns-container"\x3e\r\n    \x3cdiv class\x3d"btn-itmes" data-dojo-attach-point\x3d"sharedItem"\x3e\r\n      \x3cdiv class\x3d"btns jimu-float-leading" data-dojo-attach-point\x3d"shared"\x3e${nls.sharedTheme}\x3c/div\x3e\r\n      \x3cdiv class\x3d"jimu-float-trailing " data-dojo-attach-point\x3d"sharedCheck"\x3e\x3c/div\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv class\x3d"btn-itmes" data-dojo-attach-point\x3d"customItem"\x3e\r\n      \x3cdiv class\x3d"btns jimu-float-leading" data-dojo-attach-point\x3d"custom"\x3e${nls.custom}\x3c/div\x3e\r\n      \x3cdiv class\x3d"jimu-float-trailing " data-dojo-attach-point\x3d"customCheck"\x3e\x3c/div\x3e\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e\r\n\x3c/div\x3e',
"url:builder/plugins/attribute-config/CustomLogoPage.html":'\x3cdiv class\x3d"container"\x3e\r\n  \x3cdiv class\x3d"preview-container jimu-float-leading"\x3e\r\n    \x3cimg data-dojo-attach-point\x3d"image" class\x3d"image-node"/\x3e\r\n    \x3cdiv data-dojo-attach-point\x3d"noImage" class\x3d"no-image"\x3e\x3c/div\x3e\r\n  \x3c/div\x3e\r\n  \x3cdiv class\x3d"separator jimu-float-leading"\x3e\x3c/div\x3e\r\n  \x3cdiv class\x3d"setting-container jimu-float-leading"\x3e\r\n    \x3cdiv class\x3d"setting-item"\x3e\r\n      \x3cdiv class\x3d"label"\x3e${nls.image}\x3c/div\x3e\r\n      \x3cdiv class\x3d"choose-image-btn" data-dojo-attach-point\x3d"chooseImageBtn"\x3e${nls.upload}\x3c/div\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv class\x3d"setting-item"\x3e\r\n      \x3cdiv class\x3d"label"\x3e${nls.link}\x3c/div\x3e\r\n      \x3cinput type\x3d"text" class\x3d"link-text" data-dojo-type\x3d"jimu/dijit/URLInput" data-dojo-props\x3d"required:false,rest:false"\r\n        placeHolder\x3d"" data-dojo-attach-point\x3d"linkText"/\x3e\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e\r\n\x3c/div\x3e',
"url:builder/dijit/templates/LinkEditor.html":'\x3cdiv\x3e\r\n  \x3cdiv class\x3d"add-url-btn" data-dojo-attach-point\x3d"addLinkBtn"\x3e\r\n    \x3cdiv class\x3d"add-icon"\x3e\x3c/div\x3e\r\n    \x3cdiv class\x3d"text" data-dojo-attach-point\x3d"labelNode"\x3e\x3c/div\x3e\r\n  \x3c/div\x3e\r\n  \x3cdiv class\x3d"link-list" data-dojo-attach-point\x3d"linkListNode"\x3e\x3c/div\x3e\r\n\x3c/div\x3e',"url:builder/dijit/templates/LinkItemEditor.html":'\x3cdiv\x3e\r\n  \x3cdiv class\x3d"mask"\x3e\x3c/div\x3e\r\n  \x3cdiv class\x3d"content" data-dojo-attach-point\x3d"contentNode"\x3e\r\n    \x3cdiv class\x3d"input-section"\x3e\r\n      \x3cdiv class\x3d"input" data-dojo-attach-point\x3d"titleNode"\x3e\x3c/div\x3e\r\n      \x3cdiv class\x3d"input" data-dojo-attach-point\x3d"urlNode"\x3e\x3c/div\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv class\x3d"btn-section jimu-float-trailing"\x3e\r\n      \x3cdiv class\x3d"jimu-btn" data-dojo-attach-point\x3d"okBtn"\x3e${nls.ok}\x3c/div\x3e\r\n      \x3cdiv class\x3d"jimu-btn jimu-btn-vacation" data-dojo-attach-point\x3d"cancelBtn"\x3e${nls.cancel}\x3c/div\x3e\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e\r\n\x3c/div\x3e',
"url:builder/plugins/attribute-config/dataSource/AdditionalDataSources.html":'\x3cdiv\x3e\r\n  \x3cdiv class\x3d"ds-header"\x3e\r\n    \x3cspan class\x3d"ds-title ds-title-box textOverFlow" title\x3d"${nls.dataSource}"\x3e${nls.dataSource}\x3c/span\x3e\r\n    \x3cdiv class\x3d"dataSource-add-box dataSource-add margin-right-10" data-dojo-attach-point\x3d"addNewDs" data-dojo-attach-event\x3d"click:_onAddNewClick" title\x3d"addLayerOrStatistics"\x3e\r\n      \x3cdiv class\x3d"img_add"\x3e\x3c/div\x3e\r\n      \x3cdiv class\x3d"text_add textOverFlow" title\x3d"${nls.addNew}"\x3e${nls.addNew}\x3c/div\x3e\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e\r\n\r\n  \r\n\r\n  \x3cdiv data-dojo-attach-point\x3d"dsOptions" class\x3d"ds-suspension ds-options ds-options-lr jimu-float-trailing hide"\x3e\r\n    \x3cdiv nowrap class\x3d"option-item textOverFlow" data-dojo-attach-point\x3d"btnAddLayer" data-dojo-attach-event\x3d"click:_onAddNewLayerClick" title\x3d"${nls.layer}"\x3e${nls.layer}\x3c/div\x3e\r\n    \x3cdiv nowrap class\x3d"option-item textOverFlow" data-dojo-attach-point\x3d"btnAddStatistics" data-dojo-attach-event\x3d"click:_onAddNewStatisticsClick" title\x3d"${nls.statistics}"\x3e${nls.statistics}\x3c/div\x3e\r\n  \x3c/div\x3e\r\n\r\n  \x3cdiv data-dojo-attach-point\x3d\'tabelHeader\'\x3e\r\n    \x3cdiv class\x3d"table-header"\x3e\r\n      \x3cdiv class\x3d"textOverFlow" title\x3d"${nls.name}"\x3e${nls.name}\x3c/div\x3e\r\n      \x3cdiv class\x3d"textOverFlow" title\x3d"${nls.type}"\x3e${nls.type}\x3c/div\x3e\r\n      \x3cdiv\x3e\x3c/div\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv class\x3d"horizontial-line"\x3e\x3c/div\x3e\r\n  \x3c/div\x3e\r\n  \x3cdiv class\x3d"no-data-source-tip no-data-source-tip-box" data-dojo-attach-point\x3d"noDataSourceTip"\x3e\x3c/div\x3e\r\n  \x3cdiv class\x3d"sourcesList" data-dojo-attach-point\x3d"sourcesList"\x3e\r\n  \x3c/div\x3e\r\n\r\n  \x3cdiv style\x3d"margin-top: 30px;" data-dojo-attach-point\x3d"refreshIntervalDiv"\x3e\r\n  \x3c/div\x3e\r\n  \r\n\x3c/div\x3e',
"url:jimu/dijit/templates/QueryableLayerSource.html":'\x3cdiv\x3e\r\n\t\x3ctable class\x3d"radio-table" cellpadding\x3d"0" cellspacing\x3d"0"\x3e\r\n\t\t\x3ctbody\x3e\r\n\t\t\t\x3ctr\x3e\r\n\t\t\t\t\x3ctd class\x3d"map-td" nowrap\x3e\r\n\t\t\t\t\t\x3cinput class\x3d"jimu-radio-btn jimu-float-leading" data-dojo-attach-point\x3d"mapRadio" type\x3d"radio" data-dojo-attach-event\x3d"onclick: _onRadioClicked" checked /\x3e\r\n\t\t\t\t\t\x3clabel data-dojo-attach-point\x3d"mapLabel"\x3e${nls.selectFromMap}\x3c/label\x3e\r\n\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\x3ctd class\x3d"portal-td" nowrap\x3e\r\n\t\t\t\t\t\x3cinput class\x3d"jimu-radio-btn jimu-float-leading" data-dojo-attach-point\x3d"portalRadio" type\x3d"radio" data-dojo-attach-event\x3d"onclick: _onRadioClicked" /\x3e\r\n\t\t\t\t\t\x3clabel data-dojo-attach-point\x3d"portalLabel"\x3e${nls.selectFromPortal}\x3c/label\x3e\r\n\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\x3ctd class\x3d"url-td" nowrap\x3e\r\n\t\t\t\t\t\x3cinput class\x3d"jimu-radio-btn jimu-float-leading" data-dojo-attach-point\x3d"urlRadio" type\x3d"radio" data-dojo-attach-event\x3d"onclick: _onRadioClicked" /\x3e\r\n\t\t\t\t\t\x3clabel data-dojo-attach-point\x3d"urlLabel"\x3e${nls.addServiceUrl}\x3c/label\x3e\r\n\t\t\t\t\x3c/td\x3e\r\n\t\t\t\x3c/tr\x3e\r\n\t\t\x3c/tbody\x3e\r\n\t\x3c/table\x3e\r\n\t\x3cdiv class\x3d"source-content"\x3e\r\n\t\t\x3cdiv data-dojo-attach-point\x3d"operationTip" class\x3d"operation-tip"\x3e\x3c/div\x3e\r\n\t\t\x3cdiv data-dojo-attach-point\x3d"mapDijitContainer" class\x3d"dijit-container map-dijit-container" style\x3d"display:none;"\x3e\x3c/div\x3e\r\n\t\t\x3cdiv data-dojo-attach-point\x3d"portalDijitContainer" class\x3d"dijit-container portal-dijit-container" style\x3d"display:none;"\x3e\x3c/div\x3e\r\n\t\t\x3cdiv data-dojo-attach-point\x3d"urlDijitContainer" class\x3d"dijit-container url-dijit-container" style\x3d"display:none;"\x3e\x3c/div\x3e\r\n\t\x3c/div\x3e\r\n\x3c/div\x3e',
"url:jimu/dijit/templates/_TreeNode.html":'\x3cdiv class\x3d"dijitTreeNode" role\x3d"presentation"\x3e\r\n\t\x3cdiv data-dojo-attach-point\x3d"rowNode" class\x3d"dijitTreeRow" role\x3d"presentation"\x3e\r\n\t\t\x3cspan data-dojo-attach-point\x3d"expandoNode" class\x3d"dijitInline dijitTreeExpando" role\x3d"presentation"\x3e\x3c/span\x3e\r\n\t\t\x3cspan data-dojo-attach-point\x3d"expandoNodeText" class\x3d"dijitExpandoText" role\x3d"presentation"\x3e\x3c/span\x3e\r\n\t\t\x3cspan data-dojo-attach-point\x3d"contentNode" class\x3d"dijitTreeContent" role\x3d"presentation"\x3e\r\n\t\t\t\x3cspan role\x3d"presentation" class\x3d"dijitInline dijitIcon dijitTreeIcon" data-dojo-attach-point\x3d"iconNode"\x3e\x3c/span\x3e\r\n\t\t\t\x3cspan data-dojo-attach-point\x3d"labelNode,focusNode" class\x3d"dijitTreeLabel" role\x3d"treeitem" tabindex\x3d"-1" aria-selected\x3d"false"\x3e\x3c/span\x3e\r\n\t\t\x3c/span\x3e\r\n\t\x3c/div\x3e\r\n\t\x3cdiv data-dojo-attach-point\x3d"containerNode" class\x3d"dijitTreeNodeContainer" role\x3d"presentation" style\x3d"display: none;"\x3e\x3c/div\x3e\r\n\x3c/div\x3e',
"url:dijit/templates/TreeNode.html":'\x3cdiv class\x3d"dijitTreeNode" role\x3d"presentation"\r\n\t\x3e\x3cdiv data-dojo-attach-point\x3d"rowNode" class\x3d"dijitTreeRow" role\x3d"presentation"\r\n\t\t\x3e\x3cspan data-dojo-attach-point\x3d"expandoNode" class\x3d"dijitInline dijitTreeExpando" role\x3d"presentation"\x3e\x3c/span\r\n\t\t\x3e\x3cspan data-dojo-attach-point\x3d"expandoNodeText" class\x3d"dijitExpandoText" role\x3d"presentation"\x3e\x3c/span\r\n\t\t\x3e\x3cspan data-dojo-attach-point\x3d"contentNode"\r\n\t\t\tclass\x3d"dijitTreeContent" role\x3d"presentation"\x3e\r\n\t\t\t\x3cspan role\x3d"presentation" class\x3d"dijitInline dijitIcon dijitTreeIcon" data-dojo-attach-point\x3d"iconNode"\x3e\x3c/span\r\n\t\t\t\x3e\x3cspan data-dojo-attach-point\x3d"labelNode,focusNode" class\x3d"dijitTreeLabel" role\x3d"treeitem"\r\n\t\t\t\t   tabindex\x3d"-1" aria-selected\x3d"false" id\x3d"${id}_label"\x3e\x3c/span\x3e\r\n\t\t\x3c/span\r\n\t\x3e\x3c/div\x3e\r\n\t\x3cdiv data-dojo-attach-point\x3d"containerNode" class\x3d"dijitTreeNodeContainer" role\x3d"presentation"\r\n\t\t style\x3d"display: none;" aria-labelledby\x3d"${id}_label"\x3e\x3c/div\x3e\r\n\x3c/div\x3e\r\n',
"url:dijit/templates/Tree.html":'\x3cdiv role\x3d"tree"\x3e\r\n\t\x3cdiv class\x3d"dijitInline dijitTreeIndent" style\x3d"position: absolute; top: -9999px" data-dojo-attach-point\x3d"indentDetector"\x3e\x3c/div\x3e\r\n\t\x3cdiv class\x3d"dijitTreeExpando dijitTreeExpandoLoading" data-dojo-attach-point\x3d"rootLoadingIndicator"\x3e\x3c/div\x3e\r\n\t\x3cdiv data-dojo-attach-point\x3d"containerNode" class\x3d"dijitTreeContainer" role\x3d"presentation"\x3e\r\n\t\x3c/div\x3e\r\n\x3c/div\x3e\r\n',"url:jimu/dijit/templates/QueryableServiceChooserFromPortal.html":'\x3cdiv\x3e\r\n\t\x3cdiv class\x3d"selector-container" data-dojo-attach-point\x3d"selectorContainer"\x3e\x3c/div\x3e\r\n\t\x3cdiv class\x3d"service-browser-container" data-dojo-attach-point\x3d"serviceBrowserContainer"\x3e\x3c/div\x3e\r\n\t\x3cdiv class\x3d"footer"\x3e\r\n\t\t\x3cdiv class\x3d"jimu-btn jimu-float-trailing cancel jimu-btn-vacation" data-dojo-attach-point\x3d"btnCancel" data-dojo-attach-event\x3d"onclick:_onBtnCancelClicked"\x3e${nls.cancel}\x3c/div\x3e\r\n\t\t\x3cdiv class\x3d"jimu-btn jimu-float-trailing next jimu-state-disabled" data-dojo-attach-point\x3d"btnNext" data-dojo-attach-event\x3d"onclick:_onBtnNextClicked"\x3e${nls.next}\x3c/div\x3e\r\n\t\t\x3cdiv class\x3d"jimu-btn jimu-float-trailing ok jimu-state-disabled" data-dojo-attach-point\x3d"btnOk" data-dojo-attach-event\x3d"onclick:_onBtnOkClicked"\x3e${nls.ok}\x3c/div\x3e\r\n\t\t\x3cdiv class\x3d"jimu-btn jimu-float-trailing back" data-dojo-attach-point\x3d"btnBack" data-dojo-attach-event\x3d"onclick:_onBtnBackClicked"\x3e${nls.back}\x3c/div\x3e\r\n\t\x3c/div\x3e\r\n\x3c/div\x3e',
"url:jimu/dijit/templates/_BasicServiceChooserContent.html":'\x3cdiv\x3e\r\n\t\x3cdiv class\x3d"content-section"\x3e\r\n\t\t\x3ctable class\x3d"layout"\x3e\r\n\t\t\t\x3ccolgroup\x3e\r\n\t\t\t\t\x3ccol width\x3d"80px" align\x3d"right"\x3e\x3c/col\x3e\r\n\t\t\t\t\x3ccol width\x3d"auto"\x3e\x3c/col\x3e\r\n\t\t\t\t\x3ccol width\x3d"170px"\x3e\x3c/col\x3e\r\n\t\t\t\x3c/colgroup\x3e\r\n\t\t\t\x3ctbody\x3e\r\n\t\t\t\t\x3ctr\x3e\r\n\t\t\t\t\t\x3ctd class\x3d"first-td"\x3e\r\n\t\t\t\t\t\t\x3cspan\x3eURL:\x3c/span\x3e\r\n\t\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\t\x3ctd\x3e\r\n\t\t\t\t\t\t\x3cdiv data-dojo-attach-point\x3d"urlInput" data-dojo-type\x3d"jimu/dijit/URLInput" style\x3d"width:100%;"\x3e\x3c/div\x3e\r\n\t\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\t\x3ctd\x3e\r\n\t\t\t\t\t\t\x3cdiv class\x3d"jimu-btn jimu-state-disabled validate-btn jimu-float-trailing" data-dojo-attach-point\x3d"btnValidate" data-dojo-attach-event\x3d"onclick:_onBtnValidateClick"\x3e${nls.validate}\x3c/div\x3e\r\n\t\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\x3c/tr\x3e\r\n\t\t\t\t\x3ctr data-dojo-attach-point\x3d"exampleTr" class\x3d"example-tr"\x3e\r\n\t\t\t\t\t\x3ctd class\x3d"first-td" style\x3d"padding-top:5px;"\x3e\r\n\t\t\t\t\t\t\x3cspan\x3e${nls.example}:\x3c/span\x3e\r\n\t\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\t\x3ctd data-dojo-attach-point\x3d"exampleTd" colspan\x3d"2" style\x3d"padding-top:5px;font-style:italic;color:#ccc;"\x3e\r\n\t\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\x3c/tr\x3e\r\n\t\t\t\x3c/tbody\x3e\r\n\t\t\x3c/table\x3e\r\n\t\t\x3cdiv class\x3d"service-browser-container" data-dojo-attach-point\x3d"serviceBrowserContainer"\x3e\r\n\t\t\t\x3cdiv class\x3d"error-section" data-dojo-attach-point\x3d"errorSection"\x3e\r\n\t\t\t\t\x3cspan class\x3d"jimu-icon jimu-icon-error"\x3e\x3c/span\x3e\r\n\t\t\t\t\x3cspan class\x3d"error-message" data-dojo-attach-point\x3d"errorNode"\x3e\x3c/span\x3e\r\n\t\t\t\x3c/div\x3e\r\n\t\t\x3c/div\x3e\r\n\t\x3c/div\x3e\r\n\t\x3cdiv class\x3d"operations"\x3e\r\n\t\t\x3cdiv class\x3d"jimu-btn jimu-float-trailing cancel jimu-btn-vacation" data-dojo-attach-event\x3d"onclick:_onBtnCancelClick"\x3e${nls.cancel}\x3c/div\x3e\r\n\t\t\x3cdiv class\x3d"jimu-btn jimu-float-trailing jimu-state-disabled ok" data-dojo-attach-point\x3d"btnOk" data-dojo-attach-event\x3d"onclick:_onBtnOkClick"\x3e${nls.ok}\x3c/div\x3e\r\n\t\x3c/div\x3e\r\n\t\x3cdiv data-dojo-attach-point\x3d"loading" data-dojo-type\x3d"jimu/dijit/LoadingIndicator" data-dojo-props\x3d\'hidden:true\'\x3e\x3c/div\x3e\r\n\x3c/div\x3e',
"url:builder/plugins/attribute-config/dataSource/DataSourceConfig.html":'\x3cdiv\x3e\r\n  \x3cdiv class\x3d"data-source-label"\x3e${nls.dataSource}\x3c/div\x3e\r\n  \x3cdiv class\x3d"source ds-text-box marginTop5" data-dojo-attach-point\x3d"sourceUrl" data-dojo-type\x3d"dijit/form/ValidationTextBox" data-dojo-props\x3d\'required:true,trim:true,disabled:true\'\x3e\x3c/div\x3e\r\n\r\n\r\n\r\n  \x3cdiv class\x3d"marginTop20 data-source-label"\x3e${nls.name}\x3c/div\x3e\r\n  \x3cdiv class\x3d"marginTop5 ds-text-box" data-dojo-props\x3d\'required:true,trim:true\' data-dojo-type\x3d"dijit/form/ValidationTextBox" data-dojo-attach-point\x3d"sourceName"\x3e\x3c/div\x3e\r\n\r\n  \x3cdiv class\x3d"marginTop20 data-source-label"\x3e${nls.sourceFilterLabel}\x3c/div\x3e\r\n\r\n  \x3cdiv class\x3d"marginTop5 flex-ltr-start"\x3e\r\n    \x3cinput class\x3d"button" type\x3d"button" value\x3d${nls.set} data-dojo-attach-point\x3d"btnSet"/\x3e\r\n    \x3cinput class\x3d"button" type\x3d"button" value\x3d${nls.config} data-dojo-attach-point\x3d"btnConfig"/\x3e\r\n    \x3cinput class\x3d"button marginLeft15" type\x3d"button" value\x3d${nls.remove} data-dojo-attach-point\x3d"btnRemove"/\x3e\r\n    \x3cdiv data-dojo-attach-point\x3d"filterExpr" class\x3d"marginLeft10 filterExpr"\x3e\x3c/div\x3e\r\n  \x3c/div\x3e\r\n\r\n  \x3cdiv style\x3d"display: none;" class\x3d"layerOptionDiv" data-dojo-attach-point\x3d"layerOnlyOption"\x3e\r\n\r\n    \x3cdiv class\x3d"marginTop20 data-source-label"\x3e${nls.sourceFieldsLabel}\x3c/div\x3e\r\n    \x3cinput class\x3d"button visible marginTop5" type\x3d"button" value\x3d${nls.set} data-dojo-attach-event\x3d"click:_onFeaturesFieldsClick"/\x3e\r\n\r\n    \x3cdiv class\x3d"hide fieldsOption fieldsOptionDiv fields-position-lr" data-dojo-attach-point\x3d"fieldsOptionDiv"\x3e\r\n      \x3cdiv class\x3d"left-arrow transform"\x3e\x3c/div\x3e\r\n      \x3cdiv data-dojo-attach-point\x3d"fieldsOption" class\x3d"suspension"\x3e\r\n      \x3c/div\x3e\r\n    \x3c/div\x3e\r\n\r\n\r\n    \x3cdiv class\x3d"marginTop20 data-source-label"\x3e${nls.sourceRecordsLabel}\x3c/div\x3e\r\n    \x3cdiv style\x3d"margin-top: 12px;" class\x3d"flex-ltr-start"\x3e\r\n      \x3cdiv class\x3d"data-source-sub-label"\x3e${nls.number}\x3c/div\x3e\r\n      \x3cdiv class\x3d"data-source-sub-label"\x3e${nls.orbderBy}\x3c/div\x3e\r\n    \x3c/div\x3e\r\n\r\n    \x3cdiv class\x3d"marginTop5 flex-ltr-start"\x3e\r\n\r\n      \x3cdiv class\x3d"resultRecordType"\x3e\r\n        \x3cselect  data-dojo-type\x3d"dijit/form/Select" data-dojo-attach-point\x3d"resultRecordType"\x3e\r\n          \x3coption value\x3d"serviceLimitation"\x3e${nls.serviceLimitation}\x3c/option\x3e\r\n          \x3coption value\x3d"all"\x3e${nls.all}\x3c/option\x3e\r\n          \x3coption value\x3d"custom"\x3e${nls.custom}\x3c/option\x3e\r\n        \x3c/select\x3e\r\n      \x3c/div\x3e\r\n\r\n      \x3cdiv class\x3d"marginLeft5 custom-number-div"\x3e\r\n          \x3cdiv class\x3d"hide" data-dojo-attach-point\x3d"customNumberDiv"\x3e\r\n          \x3cinput type\x3d"text" class\x3d"custom-number" data-dojo-type\x3d"dijit/form/NumberTextBox" data-dojo-props\x3d\'required:true,constraints:{min:1,places:0},value:1000\' data-dojo-attach-point\x3d"customNumber"\x3e\x3c/input\x3e\r\n        \x3c/div\x3e\r\n      \x3c/div\x3e\r\n\r\n\r\n      \x3cdiv class\x3d"marginLeft20 orderByField"\x3e\r\n        \x3cselect data-dojo-type\x3d"dijit/form/Select" data-dojo-attach-point\x3d"orderFields"\x3e\x3c/select\x3e\r\n      \x3c/div\x3e\r\n      \x3cdiv class\x3d"marginLeft20 order"\x3e\r\n        \x3cdiv data-dojo-attach-point\x3d"ascBtn" class\x3d"order-btn selected textOverFlow" title\x3d"${nls.ASC}"\x3e${nls.ASC}\x3c/div\x3e\r\n        \x3cdiv data-dojo-attach-point\x3d"descBtn" style\x3d"margin-left: -1px;" class\x3d"order-btn textOverFlow" title\x3d"${nls.DESC}"\x3e${nls.DESC}\x3c/div\x3e\r\n      \x3c/div\x3e\r\n\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e\r\n\r\n  \x3cdiv style\x3d"display: none;" class\x3d"statisticsOptionDiv" data-dojo-attach-point\x3d"statisticsOnlyOption"\x3e\r\n    \x3cdiv class\x3d"marginTop20 data-source-label"\x3e${nls.statistics}\x3c/div\x3e\r\n    \x3cdiv style\x3d"margin-top: 12px;" class\x3d"flex-ltr-start"\x3e\r\n      \x3cdiv class\x3d"data-source-sub-label"\x3e${nls.groupBy}\x3c/div\x3e\r\n      \x3cdiv class\x3d"data-source-sub-label"\x3e${nls.sourceFieldsLabel}\x3c/div\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv class\x3d"marginTop5 flex-ltr-start"\x3e\r\n      \x3cdiv class\x3d"groupFields" \x3e\r\n        \x3cselect data-dojo-type\x3d"dijit/form/Select" data-dojo-attach-point\x3d"groupFields"\x3e\r\n          \x3coption value\x3d"-"\x3e-\x3c/option\x3e\r\n        \x3c/select\x3e\r\n      \x3c/div\x3e\r\n      \x3cinput class\x3d"marginLeft20 button visible" type\x3d"button" value\x3d${nls.set} data-dojo-attach-point\x3d"statisticsFields" data-dojo-attach-event\x3d"click:_onStatisticsFieldsClick"/\x3e\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e\r\n\r\n  \x3cdiv class\x3d"hide statisticsFieldsOption fieldsOptionDiv statisrics-fields-position-lr" data-dojo-attach-point\x3d"statisticsFieldsOptionDiv"\x3e\r\n      \x3cdiv class\x3d"left-arrow transform"\x3e\x3c/div\x3e\r\n      \x3cdiv data-dojo-attach-point\x3d"statisticsFieldsOption" class\x3d"suspension"\x3e\r\n      \x3c/div\x3e\r\n    \x3c/div\x3e\r\n\r\n  \x3cdiv class\x3d"data-source-label marginTop20"\x3e${nls.refreshInterval}\x3c/div\x3e\r\n  \x3cdiv class\x3d"refreshContent marginTop5"\x3e\r\n    \x3cdiv data-dojo-type\x3d"jimu/dijit/CheckBox" data-dojo-attach-point\x3d"isDynamic"\x3e\x3c/div\x3e\x3clabel class\x3d"margin-left-10 textOverFlow"\x3e${nls.refreshDataEvery}\x3c/label\x3e\r\n    \x3cinput type\x3d"text" class\x3d"timeDiv" data-dojo-type\x3d"dijit/form/NumberTextBox" data-dojo-props\x3d\'required:true,constraints:{min:0},value:0.5\' data-dojo-attach-point\x3d"refreshInterval"\x3e\x3c/input\x3e\r\n     \x3cspan\x3e${nls.refreshDataEvery_Minutes}\x3c/span\x3e\r\n  \x3c/div\x3e\r\n\r\n\t\x3cdiv class\x3d"footer"\x3e\r\n    \x3cdiv class\x3d"jimu-float-leading data-preview textOverFlow" title\x3d"${nls.preview}" data-dojo-attach-point\x3d"btnPreview" data-dojo-attach-event\x3d"click:_onPreviewClick"\x3e${nls.preview}\x3c/div\x3e\r\n    \x3cdiv class\x3d"jimu-btn jimu-float-trailing cancel" data-dojo-attach-point\x3d"btnCancel"\x3e${nls.cancel}\r\n    \x3c/div\x3e\r\n    \x3cdiv class\x3d"jimu-btn jimu-float-trailing ok jimu-trailing-margin1" data-dojo-attach-point\x3d"btnOk"\x3e${nls.ok}\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e\r\n\r\n\x3cdiv data-dojo-attach-point\x3d"loading" data-dojo-type\x3d"jimu/dijit/LoadingIndicator" data-dojo-props\x3d"hidden:true"\x3e\x3c/div\x3e\r\n\x3c/div\x3e\r\n',
"url:jimu/dijit/templates/Filter.html":'\x3cdiv\x3e\r\n\t\x3cdiv data-dojo-attach-point\x3d"contentSection" class\x3d"content-section"\x3e\r\n\t\t\x3cdiv class\x3d"add-btn-section"\x3e\r\n\t\t\t\x3cdiv data-dojo-attach-point\x3d"btnAddExp" data-dojo-attach-event\x3d"click:_onBtnAddExpClick"\r\n\t\t\t class\x3d"add-with-icon jimu-state-disabled add-expression jimu-float-leading"\x3e\r\n\t\t\t\t\x3cspan data-dojo-attach-point\x3d"iconAddExp" class\x3d"jimu-icon jimu-icon-add jimu-state-disabled"\x3e\x3c/span\x3e\r\n\t\t\t\t\x3cspan class\x3d"add-label"\x3e${nls.addAnotherExpression}\x3c/span\x3e\r\n\t\t\t\x3c/div\x3e\r\n\t\t\t\x3cdiv data-dojo-attach-point\x3d"btnAddSet" data-dojo-attach-event\x3d"click:_onBtnAddSetClick"\r\n\t\t\t class\x3d"add-with-icon jimu-state-disabled add-set jimu-float-leading"\x3e\r\n\t\t\t\t\x3cspan data-dojo-attach-point\x3d"iconAddSet" class\x3d"jimu-icon jimu-icon-add jimu-state-disabled"\x3e\x3c/span\x3e\r\n\t\t\t\t\x3cspan class\x3d"add-label"\x3e${nls.addSet}\x3c/span\x3e\r\n\t\t\t\x3c/div\x3e\r\n\t\t\x3c/div\x3e\r\n\t\t\x3cspan data-dojo-attach-point\x3d"matchMsg" style\x3d"margin-top:11px;margin-bottom:11px;display:none;"\x3e\r\n\t\t\t\x3cspan\x3e${nls.strMatchMsgPart1}\x3c/span\x3e\r\n\t\t\t\x3cselect data-dojo-attach-point\x3d"allAnySelect"\x3e\r\n\t\t\t\t\x3coption value\x3d"AND" selected\x3e${nls.all}\x3c/option\x3e\r\n\t\t\t\t\x3coption value\x3d"OR"\x3e${nls.any}\x3c/option\x3e\r\n\t\t\t\x3c/select\x3e\r\n\t\t\t\x3cspan\x3e${nls.strMatchMsgPart2}\x3c/span\x3e\r\n\t\t\x3c/span\x3e\r\n\t\t\x3cdiv class\x3d"allExpsBox" data-dojo-attach-point\x3d"allExpsBox"\x3e\r\n\t\t\x3c/div\x3e\r\n\t\x3c/div\x3e\r\n\t\x3cdiv data-dojo-attach-point\x3d"errorSection" style\x3d"display:none;"\x3e\r\n\t\t\x3cspan class\x3d"jimu-icon jimu-icon-error"\x3e\x3c/span\x3e\r\n\t\t\x3cspan data-dojo-attach-point\x3d"errorTip" class\x3d"error-tip"\x3e\x3c/span\x3e\r\n\t\x3c/div\x3e\r\n\t\x3cdiv data-dojo-attach-point\x3d"noFilterTipSection" class\x3d"no-filter-tip" style\x3d"display:none;"\x3e\x3c/div\x3e\r\n\t\x3cdiv data-dojo-attach-point\x3d"loading" data-dojo-type\x3d"jimu/dijit/LoadingIndicator" data-dojo-props\x3d"hidden:true"\x3e\x3c/div\x3e\r\n\x3c/div\x3e',
"url:dijit/templates/Calendar.html":'\x3cdiv class\x3d"dijitCalendarContainer dijitInline" role\x3d"presentation" aria-labelledby\x3d"${id}_mddb ${id}_year"\x3e\r\n\t\x3cdiv class\x3d"dijitReset dijitCalendarMonthContainer" role\x3d"presentation"\x3e\r\n\t\t\x3cdiv class\x3d\'dijitReset dijitCalendarArrow dijitCalendarDecrementArrow\' data-dojo-attach-point\x3d"decrementMonth"\x3e\r\n\t\t\t\x3cimg src\x3d"${_blankGif}" alt\x3d"" class\x3d"dijitCalendarIncrementControl dijitCalendarDecrease" role\x3d"presentation"/\x3e\r\n\t\t\t\x3cspan data-dojo-attach-point\x3d"decreaseArrowNode" class\x3d"dijitA11ySideArrow"\x3e-\x3c/span\x3e\r\n\t\t\x3c/div\x3e\r\n\t\t\x3cdiv class\x3d\'dijitReset dijitCalendarArrow dijitCalendarIncrementArrow\' data-dojo-attach-point\x3d"incrementMonth"\x3e\r\n\t\t\t\x3cimg src\x3d"${_blankGif}" alt\x3d"" class\x3d"dijitCalendarIncrementControl dijitCalendarIncrease" role\x3d"presentation"/\x3e\r\n\t\t\t\x3cspan data-dojo-attach-point\x3d"increaseArrowNode" class\x3d"dijitA11ySideArrow"\x3e+\x3c/span\x3e\r\n\t\t\x3c/div\x3e\r\n\t\t\x3cdiv data-dojo-attach-point\x3d"monthNode" class\x3d"dijitInline"\x3e\x3c/div\x3e\r\n\t\x3c/div\x3e\r\n\t\x3ctable cellspacing\x3d"0" cellpadding\x3d"0" role\x3d"grid" data-dojo-attach-point\x3d"gridNode"\x3e\r\n\t\t\x3cthead\x3e\r\n\t\t\t\x3ctr role\x3d"row"\x3e\r\n\t\t\t\t${!dayCellsHtml}\r\n\t\t\t\x3c/tr\x3e\r\n\t\t\x3c/thead\x3e\r\n\t\t\x3ctbody data-dojo-attach-point\x3d"dateRowsNode" data-dojo-attach-event\x3d"ondijitclick: _onDayClick" class\x3d"dijitReset dijitCalendarBodyContainer"\x3e\r\n\t\t\t\t${!dateRowsHtml}\r\n\t\t\x3c/tbody\x3e\r\n\t\x3c/table\x3e\r\n\t\x3cdiv class\x3d"dijitReset dijitCalendarYearContainer" role\x3d"presentation"\x3e\r\n\t\t\x3cdiv class\x3d"dijitCalendarYearLabel"\x3e\r\n\t\t\t\x3cspan data-dojo-attach-point\x3d"previousYearLabelNode" class\x3d"dijitInline dijitCalendarPreviousYear" role\x3d"button"\x3e\x3c/span\x3e\r\n\t\t\t\x3cspan data-dojo-attach-point\x3d"currentYearLabelNode" class\x3d"dijitInline dijitCalendarSelectedYear" role\x3d"button" id\x3d"${id}_year"\x3e\x3c/span\x3e\r\n\t\t\t\x3cspan data-dojo-attach-point\x3d"nextYearLabelNode" class\x3d"dijitInline dijitCalendarNextYear" role\x3d"button"\x3e\x3c/span\x3e\r\n\t\t\x3c/div\x3e\r\n\t\x3c/div\x3e\r\n\x3c/div\x3e\r\n',
"url:dijit/form/templates/DropDownBox.html":'\x3cdiv class\x3d"dijit dijitReset dijitInline dijitLeft"\r\n\tid\x3d"widget_${id}"\r\n\trole\x3d"combobox"\r\n\taria-haspopup\x3d"true"\r\n\tdata-dojo-attach-point\x3d"_popupStateNode"\r\n\t\x3e\x3cdiv class\x3d\'dijitReset dijitRight dijitButtonNode dijitArrowButton dijitDownArrowButton dijitArrowButtonContainer\'\r\n\t\tdata-dojo-attach-point\x3d"_buttonNode" role\x3d"presentation"\r\n\t\t\x3e\x3cinput class\x3d"dijitReset dijitInputField dijitArrowButtonInner" value\x3d"\x26#9660; " type\x3d"text" tabIndex\x3d"-1" readonly\x3d"readonly" role\x3d"button presentation" aria-hidden\x3d"true"\r\n\t\t\t${_buttonInputDisabled}\r\n\t/\x3e\x3c/div\r\n\t\x3e\x3cdiv class\x3d\'dijitReset dijitValidationContainer\'\r\n\t\t\x3e\x3cinput class\x3d"dijitReset dijitInputField dijitValidationIcon dijitValidationInner" value\x3d"\x26#935; " type\x3d"text" tabIndex\x3d"-1" readonly\x3d"readonly" role\x3d"presentation"\r\n\t/\x3e\x3c/div\r\n\t\x3e\x3cdiv class\x3d"dijitReset dijitInputField dijitInputContainer"\r\n\t\t\x3e\x3cinput class\x3d\'dijitReset dijitInputInner\' ${!nameAttrSetting} type\x3d"${type}" autocomplete\x3d"off"\r\n\t\t\tdata-dojo-attach-point\x3d"textbox,focusNode" role\x3d"textbox"\r\n\t/\x3e\x3c/div\r\n\x3e\x3c/div\x3e\r\n',
"url:jimu/dijit/_filter/TwoNumbersValueProvider.html":'\x3cdiv\x3e\r\n\t\x3ctable data-dojo-attach-point\x3d"numberRangeTable" style\x3d"width:100%;border-collapse:collapse;" cellpadding\x3d"0" cellspacing\x3d"0"\x3e\r\n\t\t\x3ctbody\x3e\r\n\t\t\t\x3ctr\x3e\r\n\t\t\t\t\x3ctd style\x3d"width:40%;"\x3e\r\n\t\t\t\t\t\x3cinput data-dojo-attach-point\x3d"_dijit1" data-dojo-type\x3d"dijit/form/NumberTextBox" data-dojo-attach-event\x3d"blur:_onRangeNumberBlur" data-dojo-props\x3d\'"required":false,intermediateChanges:true,constraints: {pattern: "#####0.##########"}\' style\x3d"width:100%;" /\x3e\r\n\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\x3ctd style\x3d"width:20%;text-align:center;"\x3e\r\n\t\t\t\t\t\x3cspan\x3e${nls.and}\x3c/span\x3e\r\n\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\x3ctd style\x3d"width:40%;"\x3e\r\n\t\t\t\t\t\x3cinput data-dojo-attach-point\x3d"_dijit2" data-dojo-type\x3d"dijit/form/NumberTextBox" data-dojo-attach-event\x3d"blur:_onRangeNumberBlur" data-dojo-props\x3d\'"required":false,intermediateChanges:true,constraints: {pattern: "#####0.##########"}\' style\x3d"width:100%;" /\x3e\r\n\t\t\t\t\x3c/td\x3e\r\n\t\t\t\x3c/tr\x3e\r\n\t\t\x3c/tbody\x3e\r\n\t\x3c/table\x3e\r\n\x3c/div\x3e',
"url:jimu/dijit/_filter/TwoDatesValueProvider.html":'\x3cdiv\x3e\r\n\t\x3ctable data-dojo-attach-point\x3d"dateRangeTable" style\x3d"width:100%;border-collapse:collapse;" cellpadding\x3d"0" cellspacing\x3d"0"\x3e\r\n\t\t\x3ctbody\x3e\r\n\t\t\t\x3ctr\x3e\r\n\t\t\t\t\x3ctd style\x3d"width:40%;"\x3e\r\n\t\t\t\t\t\x3cinput data-dojo-attach-point\x3d"_dijit1" data-dojo-type\x3d"dijit/form/DateTextBox" data-dojo-attach-event\x3d"change:_onRangeDateBlur" data-dojo-props\x3d\'value:new Date(),required:false,trim:true\' style\x3d"width:100%;" /\x3e\r\n\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\x3ctd style\x3d"width:20%;text-align:center;"\x3e\r\n\t\t\t\t\t\x3cspan\x3e${nls.and}\x3c/span\x3e\r\n\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\x3ctd\x3e\r\n\t\t\t\t\t\x3cinput data-dojo-attach-point\x3d"_dijit2" data-dojo-type\x3d"dijit/form/DateTextBox" data-dojo-attach-event\x3d"change:_onRangeDateBlur" data-dojo-props\x3d\'value:new Date(),required:false,trim:true\' style\x3d"width:100%;" /\x3e\r\n\t\t\t\t\x3c/td\x3e\r\n\t\t\t\x3c/tr\x3e\r\n\t\t\x3c/tbody\x3e\r\n\t\x3c/table\x3e\r\n\x3c/div\x3e',
"url:jimu/dijit/_filter/ListValueProvider.html":'\x3cdiv\x3e\r\n  \x3cdiv data-dojo-attach-point\x3d"valuesSelect" data-dojo-type\x3d"dijit/form/FilteringSelect" data-dojo-props\x3d\'searchAttr:"label",required:false,intermediateChanges:true\' style\x3d"width:100%;" data-dojo-attach-event\x3d"input:_onFilteringSelectInput"\x3e\x3c/div\x3e\r\n\x3c/div\x3e',"url:jimu/dijit/_filter/NumberListValueProvider.html":'\x3cdiv\x3e\r\n    \x3ctable data-dojo-attach-point\x3d"numberListTable" style\x3d"width:100%;border-collapse:collapse;"\r\n        cellpadding\x3d"0" cellspacing\x3d"0"\x3e\r\n        \x3ctbody\x3e\r\n            \x3ctr\x3e\r\n                \x3ctd style\x3d"width:50%;"\x3e\r\n                    \x3cinput data-dojo-attach-point\x3d"_dijit1" data-dojo-type\x3d"dijit/form/NumberTextBox"\r\n                        data-dojo-props\x3d\'"required":false,constraints:{min:0,pattern:"#####0.##########"}\'\r\n                        style\x3d"width:100%;" /\x3e\r\n                \x3c/td\x3e\r\n                \x3ctd\x3e\r\n                    \x3cselect data-dojo-attach-point\x3d"rangeSelect" data-dojo-type\x3d"dijit/form/Select"\r\n                        style\x3d"width:100%;" class\x3d"operator-select dijit-form-Select restrict-select-width"\x3e\r\n                        \x3coption value\x3d"none"\x3e${nls.none}\x3c/option\x3e\r\n                    \x3c/select\x3e\r\n                \x3c/td\x3e\r\n            \x3c/tr\x3e\r\n        \x3c/tbody\x3e\r\n    \x3c/table\x3e\r\n\x3c/div\x3e',
"url:jimu/dijit/templates/_SingleFilter.html":'\x3cdiv\x3e\r\n\t\x3ctable class\x3d"setting-table" cellpadding\x3d"0" cellspacing\x3d"0" cellpadding\x3d"10px" style\x3d"table-layout:fixed;"\x3e\r\n\t\t\x3ctbody\x3e\r\n\t\t\t\x3ctr\x3e\r\n\t\t\t\t\x3ctd class\x3d"fields-td" nowrap\x3e\r\n\t\t\t\t\t\x3cdiv data-dojo-attach-point\x3d"fieldsSelect" data-dojo-type\x3d"dijit/form/FilteringSelect" data-dojo-props\x3d\'searchAttr:"displayName",required:true,intermediateChanges:true\' class\x3d"dijit-form-FilteringSelect" style\x3d"width:100%;"\x3e\x3c/div\x3e\r\n\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\x3ctd class\x3d"operators-td" nowrap\x3e\r\n\t\t\t\t\t\x3cselect data-dojo-attach-point\x3d"operatorsSelect" data-dojo-type\x3d"dijit/form/Select" style\x3d"width:100%;" class\x3d"operator-select dijit-form-Select restrict-select-width"\x3e\r\n\t\t\t\t\t\t\x3coption value\x3d"none"\x3e${nls.none}\x3c/option\x3e\r\n\t\t\t\t\t\x3c/select\x3e\r\n\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\x3ctd class\x3d"value-td" nowrap data-dojo-attach-point\x3d"valueTd"\x3e\r\n\t\t\t\t\t\x3cdiv data-dojo-attach-point\x3d"attributeValueContainer" class\x3d"value-container"\x3e\r\n\t\t\t\t\t\t\x3cdiv class\x3d"radio-table-container"\x3e\r\n\t\t\t\t\t\t\t\x3ctable class\x3d"radio-table" cellpadding\x3d"0" cellspacing\x3d"0"\x3e\r\n\t\t\t\t\t\t\t\t\x3ctbody\x3e\r\n\t\t\t\t\t\t\t\t\t\x3ctr\x3e\r\n\t\t\t\t\t\t\t\t\t\t\x3ctd\x3e\r\n\t\t\t\t\t\t\t\t\t\t\t\x3cinput class\x3d"jimu-radio-btn" type\x3d"radio" data-dojo-attach-point\x3d"valueRadio" checked\x3d"true" disabled  title\x3d"${nls.valueTooltip}" /\x3e\r\n\t\t\t\t\t\t\t\t\t\t\t\x3clabel data-dojo-attach-point\x3d"valueLabel" title\x3d"${nls.valueTooltip}"\x3e${nls.value}\x3c/label\x3e\r\n\t\t\t\t\t\t\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\t\t\t\t\t\t\x3ctd\x3e\r\n\t\t\t\t\t\t\t\t\t\t\t\x3cinput class\x3d"jimu-radio-btn" type\x3d"radio" data-dojo-attach-point\x3d"fieldRadio" disabled title\x3d"${nls.fieldTooltip}" /\x3e\r\n\t\t\t\t\t\t\t\t\t\t\t\x3clabel data-dojo-attach-point\x3d"fieldLabel" title\x3d"${nls.fieldTooltip}"\x3e${nls.field}\x3c/label\x3e\r\n\t\t\t\t\t\t\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\t\t\t\t\t\t\x3ctd data-dojo-attach-point\x3d"uniqueTd"\x3e\r\n\t\t\t\t\t\t\t\t\t\t\t\x3cinput class\x3d"jimu-radio-btn" type\x3d"radio" data-dojo-attach-point\x3d"uniqueRadio" disabled title\x3d"${nls.uniqueValueTooltip}" /\x3e\r\n\t\t\t\t\t\t\t\t\t\t\t\x3clabel data-dojo-attach-point\x3d"uniqueLabel" title\x3d"${nls.uniqueValueTooltip}"\x3e${nls.unique}\x3c/label\x3e\r\n\t\t\t\t\t\t\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\t\t\t\t\t\x3c/tr\x3e\r\n\t\t\t\t\t\t\t\t\x3c/tbody\x3e\r\n\t\t\t\t\t\t\t\x3c/table\x3e\r\n\t\t\t\t\t\t\x3c/div\x3e\r\n\t\t\t\t\t\x3c/div\x3e\r\n\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\x3ctd class\x3d"delete-td" nowrap\x3e\r\n\t\t\t\t\t\x3cdiv class\x3d"jimu-icon jimu-icon-delete" data-dojo-attach-point\x3d"btnDelete"\r\n\t\t\t\t\t data-dojo-attach-event\x3d"click:_destroySelf"\x3e\x3c/div\x3e\r\n\t\t\t\t\x3c/td\x3e\r\n\t\t\t\x3c/tr\x3e\r\n\t\t\x3c/tbody\x3e\r\n\t\x3c/table\x3e\r\n\t\x3cdiv class\x3d"askvalues"\x3e\r\n\t\t\x3cdiv data-dojo-type\x3d"jimu/dijit/CheckBox" data-dojo-attach-point\x3d"cbxAskValues" label\x3d"${nls.askForValues}" class\x3d"jimu-trailing-margin6"\x3e\x3c/div\x3e\r\n\t\t\x3cdiv data-dojo-type\x3d"jimu/dijit/CheckBox" data-dojo-attach-point\x3d"cbxCaseSensitive" label\x3d"${nls.caseSensitive}" style\x3d"display:none;"\x3e\x3c/div\x3e\r\n\t\x3c/div\x3e\r\n\t\x3cdiv data-dojo-attach-point\x3d"promptSection" class\x3d"prompt"\x3e\r\n\t\t\x3ctable data-dojo-attach-point\x3d"promptTable" cellpadding\x3d"0" cellspacing\x3d"0" class\x3d"prompt-table" style\x3d"width:100%;"\x3e\r\n\t\t\t\x3ctbody\x3e\r\n\t\t\t\t\x3ctr\x3e\r\n\t\t\t\t\t\x3ctd class\x3d"first-td"\x3e\r\n\t\t\t\t\t\t\x3cspan\x3e${nls.prompt}\x3c/span\x3e\r\n\t\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\t\x3ctd class\x3d"second-td"\x3e\r\n\t\t\t\t\t\t\x3cdiv data-dojo-attach-point\x3d"promptTB" data-dojo-type\x3d"dijit/form/ValidationTextBox" data-dojo-props\x3d"required:true,trim:true" style\x3d"width:257px;" class\x3d"dijit-form-ValidationTextBox" \x3e\x3c/div\x3e\r\n\t\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\x3c/tr\x3e\r\n\t\t\t\t\x3ctr\x3e\r\n\t\t\t\t\t\x3ctd class\x3d"first-td"\x3e\r\n\t\t\t\t\t\t\x3cspan\x3e${nls.hint}\x3c/span\x3e\r\n\t\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\t\x3ctd class\x3d"second-td"\x3e\r\n\t\t\t\t\t\t\x3cdiv data-dojo-attach-point\x3d"hintTB" data-dojo-type\x3d"dijit/form/ValidationTextBox" data-dojo-props\x3d"trim:true" style\x3d"width:257px;" class\x3d"dijit-form-ValidationTextBox" \x3e\x3c/div\x3e\r\n\t\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\x3c/tr\x3e\r\n\t\t\t\t\x3ctr data-dojo-attach-point\x3d"cascadeTr" class\x3d"cascade-tr"\x3e\r\n\t\t\t\t\t\x3ctd class\x3d"first-td"\x3e\r\n\t\t\t\t\t\t\x3cdiv style\x3d"margin-bottom:5px;"\x3e${nls.listValues}:\x3c/div\x3e\r\n\t\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\t\x3ctd class\x3d"second-td"\x3e\r\n\t\t\t\t\t\t\x3cselect data-dojo-type\x3d"dijit/form/Select" data-dojo-attach-point\x3d"cascadeSelect" class\x3d"cascade-select restrict-select-width" style\x3d"width:100%;"\x3e\r\n\t\t\t\t\t\t\t\x3coption value\x3d"none"\x3e${nls.noneCascadeFilterTip}\x3c/option\x3e\r\n\t\t\t\t\t\t\t\x3coption value\x3d"previous"\x3e${nls.previousCascadeFilterTip}\x3c/option\x3e\r\n\t\t\t\t\t\t\t\x3coption value\x3d"all"\x3e${nls.allCascadeFilterTip}\x3c/option\x3e\r\n\t\t\t\t\t\t\x3c/select\x3e\r\n\t\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\x3c/tr\x3e\r\n\t\t\t\x3c/tbody\x3e\r\n\t\t\x3c/table\x3e\r\n\t\x3c/div\x3e\r\n\x3c/div\x3e',
"url:jimu/dijit/templates/_FilterSet.html":'\x3cdiv\x3e\r\n\t\x3ctable class\x3d"header-table" cellspacing\x3d"0" cellpadding\x3d"0"\x3e\r\n\t\t\x3ctbody\x3e\r\n\t\t\t\x3ctr\x3e\r\n\t\t\t\t\x3ctd\x3e\r\n\t\t\t\t\t\x3cdiv\x3e\r\n\t\t\t\t\t\t\x3cspan\x3e${nls.strMatchMsgPart1}\x3c/span\x3e\r\n\t\t\t\t\t\t\x3cselect data-dojo-attach-point\x3d"allAnySelect"\x3e\r\n\t\t\t\t\t\t\t\x3coption value\x3d"AND" selected\x3e${nls.all}\x3c/option\x3e\r\n\t\t\t\t\t\t\t\x3coption value\x3d"OR"\x3e${nls.any}\x3c/option\x3e\r\n\t\t\t\t\t\t\x3c/select\x3e\r\n\t\t\t\t\t\t\x3cspan\x3e${nls.strMatchMsgPart2}\x3c/span\x3e\r\n\t\t\t\t\t\x3c/div\x3e\r\n\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\x3ctd style\x3d"width:15px;padding-right:10px;"\x3e\r\n\t\t\t\t\t\x3cdiv data-dojo-attach-point\x3d"btnDelete" data-dojo-attach-event\x3d"onclick:_destroySelf"\r\n\t\t\t\t\t class\x3d"jimu-icon jimu-icon-delete"\x3e\x3c/div\x3e\r\n\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\x3ctd style\x3d"width:15px;padding-right:14px;"\x3e\r\n\t\t\t\t\t\x3cdiv data-dojo-attach-point\x3d"btnAdd" class\x3d"jimu-icon jimu-icon-add"\x3e\x3c/div\x3e\r\n\t\t\t\t\x3c/td\x3e\r\n\t\t\t\x3c/tr\x3e\r\n\t\t\x3c/tbody\x3e\r\n\t\x3c/table\x3e\r\n\t\x3cdiv data-dojo-attach-point\x3d"allExpsBox"\x3e\r\n\t\x3c/div\x3e\r\n\x3c/div\x3e',
"url:builder/plugins/attribute-config/dataSource/DataFields.html":'\x3cdiv\x3e\r\n\t\x3cdiv data-dojo-attach-point\x3d"fieldsContent" class\x3d"fields-content"\x3e\r\n\t\x3c/div\x3e\r\n\t\x3cdiv class\x3d"operation"\x3e\r\n\t\t\x3cdiv data-dojo-attach-point\x3d"btnUp" data-dojo-attach-event\x3d"onclick:_moveUp" class\x3d"jimu-icon jimu-icon-up" title\x3d"${nls.moveUp}"\x3e\x3c/div\x3e\r\n\t\t\x3cdiv data-dojo-attach-point\x3d"btnDown" data-dojo-attach-event\x3d"onclick:_moveDown" class\x3d"jimu-icon jimu-icon-down" title\x3d"${nls.moveDown}"\x3e\x3c/div\x3e\r\n\t\x3c/div\x3e\r\n\x3c/div\x3e',
"url:builder/dijit/templates/RefreshInterval.html":'\x3cdiv class\x3d"map-option refresh-option"\x3e\r\n  \x3cdiv class\x3d"option-title"\x3e${nls.setRefreshInterval}\x3c/div\x3e\r\n  \x3cp class\x3d"option-statement" style\x3d"font-family:\'Avenir Light\';"\x3e${nls.refreshTip}\x3c/p\x3e\r\n  \x3cselect data-dojo-attach-point\x3d"refreshSelect" data-dojo-type\x3d"dijit/form/Select" class\x3d"refresh-select dijit-form-Select restrict-select-width" style\x3d"width:100%; box-sizing:border-box;"\x3e\r\n    \x3coption value\x3d"defaultRefresh"\x3e${defaultRefreshTip}\x3c/option\x3e\r\n    \x3coption value\x3d"singleRefresh"\x3e${singleRefreshTip}\x3c/option\x3e\r\n  \x3c/select\x3e\r\n  \x3cdiv data-dojo-attach-point\x3d"refreshIntervalInputs" class\x3d"refresh-interval-inputs hidden"\x3e\r\n    \x3cinput data-dojo-attach-point\x3d"refreshIntervalNTB" data-dojo-type\x3d"dijit/form/NumberTextBox" data-dojo-props\x3d\'required:true,constraints:{min:0,pattern:"#####0.##########"},value:0.5\' class\x3d"jimu-float-leading" style\x3d"width:55px;" /\x3e\r\n    \x3cdiv class\x3d"minutes-text jimu-float-leading"\x3e${nls.minutes}\x3c/div\x3e\r\n  \x3c/div\x3e\r\n\x3c/div\x3e',
"url:dojox/widget/ColorPicker/ColorPicker.html":'\x3ctable class\x3d"dojoxColorPicker" dojoAttachEvent\x3d"onkeypress: _handleKey" cellpadding\x3d"0" cellspacing\x3d"0" role\x3d"presentation"\x3e\r\n\t\x3ctr\x3e\r\n\t\t\x3ctd valign\x3d"top" class\x3d"dojoxColorPickerRightPad"\x3e\r\n\t\t\t\x3cdiv class\x3d"dojoxColorPickerBox"\x3e\r\n\t\t\t\t\x3c!-- Forcing ABS in style attr due to dojo DND issue with not picking it up form the class. --\x3e\r\n\t\t\t\t\x3cimg title\x3d"${saturationPickerTitle}" alt\x3d"${saturationPickerTitle}" class\x3d"dojoxColorPickerPoint" src\x3d"${_pickerPointer}" tabIndex\x3d"0" dojoAttachPoint\x3d"cursorNode" style\x3d"position: absolute; top: 0px; left: 0px;"\x3e\r\n\t\t\t\t\x3cimg role\x3d"presentation" alt\x3d"" dojoAttachPoint\x3d"colorUnderlay" dojoAttachEvent\x3d"onclick: _setPoint, onmousedown: _stopDrag" class\x3d"dojoxColorPickerUnderlay" src\x3d"${_underlay}" ondragstart\x3d"return false"\x3e\r\n\t\t\t\x3c/div\x3e\r\n\t\t\x3c/td\x3e\r\n\t\t\x3ctd valign\x3d"top" class\x3d"dojoxColorPickerRightPad"\x3e\r\n\t\t\t\x3cdiv class\x3d"dojoxHuePicker"\x3e\r\n\t\t\t\t\x3c!-- Forcing ABS in style attr due to dojo DND issue with not picking it up form the class. --\x3e\r\n\t\t\t\t\x3cimg dojoAttachPoint\x3d"hueCursorNode" tabIndex\x3d"0" class\x3d"dojoxHuePickerPoint" title\x3d"${huePickerTitle}" alt\x3d"${huePickerTitle}" src\x3d"${_huePickerPointer}" style\x3d"position: absolute; top: 0px; left: 0px;"\x3e\r\n\t\t\t\t\x3cdiv class\x3d"dojoxHuePickerUnderlay" dojoAttachPoint\x3d"hueNode"\x3e\r\n\t\t\t\t    \x3cimg role\x3d"presentation" alt\x3d"" dojoAttachEvent\x3d"onclick: _setHuePoint, onmousedown: _stopDrag" src\x3d"${_hueUnderlay}"\x3e\r\n\t\t\t\t\x3c/div\x3e\r\n\t\t\t\x3c/div\x3e\r\n\t\t\x3c/td\x3e\r\n\t\t\x3ctd valign\x3d"top"\x3e\r\n\t\t\t\x3ctable cellpadding\x3d"0" cellspacing\x3d"0" role\x3d"presentation"\x3e\r\n\t\t\t\t\x3ctr\x3e\r\n\t\t\t\t\t\x3ctd valign\x3d"top" class\x3d"dojoxColorPickerPreviewContainer"\x3e\r\n\t\t\t\t\t\t\x3ctable cellpadding\x3d"0" cellspacing\x3d"0" role\x3d"presentation"\x3e\r\n\t\t\t\t\t\t\t\x3ctr\x3e\r\n\t\t\t\t\t\t\t\t\x3ctd valign\x3d"top" class\x3d"dojoxColorPickerRightPad"\x3e\r\n\t\t\t\t\t\t\t\t\t\x3cdiv dojoAttachPoint\x3d"previewNode" class\x3d"dojoxColorPickerPreview"\x3e\x3c/div\x3e\r\n\t\t\t\t\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\t\t\t\t\x3ctd valign\x3d"top"\x3e\r\n\t\t\t\t\t\t\t\t\t\x3cdiv dojoAttachPoint\x3d"safePreviewNode" class\x3d"dojoxColorPickerWebSafePreview"\x3e\x3c/div\x3e\r\n\t\t\t\t\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\t\t\t\x3c/tr\x3e\r\n\t\t\t\t\t\t\x3c/table\x3e\r\n\t\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\x3c/tr\x3e\r\n\t\t\t\t\x3ctr\x3e\r\n\t\t\t\t\t\x3ctd valign\x3d"bottom"\x3e\r\n\t\t\t\t\t\t\x3ctable class\x3d"dojoxColorPickerOptional" cellpadding\x3d"0" cellspacing\x3d"0" role\x3d"presentation"\x3e\r\n\t\t\t\t\t\t\t\x3ctr\x3e\r\n\t\t\t\t\t\t\t\t\x3ctd\x3e\r\n\t\t\t\t\t\t\t\t\t\x3cdiv class\x3d"dijitInline dojoxColorPickerRgb" dojoAttachPoint\x3d"rgbNode"\x3e\r\n\t\t\t\t\t\t\t\t\t\t\x3ctable cellpadding\x3d"1" cellspacing\x3d"1" role\x3d"presentation"\x3e\r\n\t\t\t\t\t\t\t\t\t\t\x3ctr\x3e\x3ctd\x3e\x3clabel for\x3d"${_uId}_r"\x3e${redLabel}\x3c/label\x3e\x3c/td\x3e\x3ctd\x3e\x3cinput id\x3d"${_uId}_r" dojoAttachPoint\x3d"Rval" size\x3d"1" dojoAttachEvent\x3d"onchange: _colorInputChange"\x3e\x3c/td\x3e\x3c/tr\x3e\r\n\t\t\t\t\t\t\t\t\t\t\x3ctr\x3e\x3ctd\x3e\x3clabel for\x3d"${_uId}_g"\x3e${greenLabel}\x3c/label\x3e\x3c/td\x3e\x3ctd\x3e\x3cinput id\x3d"${_uId}_g" dojoAttachPoint\x3d"Gval" size\x3d"1" dojoAttachEvent\x3d"onchange: _colorInputChange"\x3e\x3c/td\x3e\x3c/tr\x3e\r\n\t\t\t\t\t\t\t\t\t\t\x3ctr\x3e\x3ctd\x3e\x3clabel for\x3d"${_uId}_b"\x3e${blueLabel}\x3c/label\x3e\x3c/td\x3e\x3ctd\x3e\x3cinput id\x3d"${_uId}_b" dojoAttachPoint\x3d"Bval" size\x3d"1" dojoAttachEvent\x3d"onchange: _colorInputChange"\x3e\x3c/td\x3e\x3c/tr\x3e\r\n\t\t\t\t\t\t\t\t\t\t\x3c/table\x3e\r\n\t\t\t\t\t\t\t\t\t\x3c/div\x3e\r\n\t\t\t\t\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\t\t\t\t\x3ctd\x3e\r\n\t\t\t\t\t\t\t\t\t\x3cdiv class\x3d"dijitInline dojoxColorPickerHsv" dojoAttachPoint\x3d"hsvNode"\x3e\r\n\t\t\t\t\t\t\t\t\t\t\x3ctable cellpadding\x3d"1" cellspacing\x3d"1" role\x3d"presentation"\x3e\r\n\t\t\t\t\t\t\t\t\t\t\x3ctr\x3e\x3ctd\x3e\x3clabel for\x3d"${_uId}_h"\x3e${hueLabel}\x3c/label\x3e\x3c/td\x3e\x3ctd\x3e\x3cinput id\x3d"${_uId}_h" dojoAttachPoint\x3d"Hval"size\x3d"1" dojoAttachEvent\x3d"onchange: _colorInputChange"\x3e ${degLabel}\x3c/td\x3e\x3c/tr\x3e\r\n\t\t\t\t\t\t\t\t\t\t\x3ctr\x3e\x3ctd\x3e\x3clabel for\x3d"${_uId}_s"\x3e${saturationLabel}\x3c/label\x3e\x3c/td\x3e\x3ctd\x3e\x3cinput id\x3d"${_uId}_s" dojoAttachPoint\x3d"Sval" size\x3d"1" dojoAttachEvent\x3d"onchange: _colorInputChange"\x3e ${percentSign}\x3c/td\x3e\x3c/tr\x3e\r\n\t\t\t\t\t\t\t\t\t\t\x3ctr\x3e\x3ctd\x3e\x3clabel for\x3d"${_uId}_v"\x3e${valueLabel}\x3c/label\x3e\x3c/td\x3e\x3ctd\x3e\x3cinput id\x3d"${_uId}_v" dojoAttachPoint\x3d"Vval" size\x3d"1" dojoAttachEvent\x3d"onchange: _colorInputChange"\x3e ${percentSign}\x3c/td\x3e\x3c/tr\x3e\r\n\t\t\t\t\t\t\t\t\t\t\x3c/table\x3e\r\n\t\t\t\t\t\t\t\t\t\x3c/div\x3e\r\n\t\t\t\t\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\t\t\t\x3c/tr\x3e\r\n\t\t\t\t\t\t\t\x3ctr\x3e\r\n\t\t\t\t\t\t\t\t\x3ctd colspan\x3d"2"\x3e\r\n\t\t\t\t\t\t\t\t\t\x3cdiv class\x3d"dojoxColorPickerHex" dojoAttachPoint\x3d"hexNode" aria-live\x3d"polite"\x3e\t\r\n\t\t\t\t\t\t\t\t\t\t\x3clabel for\x3d"${_uId}_hex"\x3e\x26nbsp;${hexLabel}\x26nbsp;\x3c/label\x3e\x3cinput id\x3d"${_uId}_hex" dojoAttachPoint\x3d"hexCode, focusNode, valueNode" size\x3d"6" class\x3d"dojoxColorPickerHexCode" dojoAttachEvent\x3d"onchange: _colorInputChange"\x3e\r\n\t\t\t\t\t\t\t\t\t\x3c/div\x3e\r\n\t\t\t\t\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\t\t\t\x3c/tr\x3e\r\n\t\t\t\t\t\t\x3c/table\x3e\r\n\t\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\x3c/tr\x3e\r\n\t\t\t\x3c/table\x3e\r\n\t\t\x3c/td\x3e\r\n\t\x3c/tr\x3e\r\n\x3c/table\x3e\r\n\r\n',
"url:builder/plugins/attribute-config/css/style.css":'.attribute-config {overflow-x: hidden; overflow-y: auto; font-size: 14px;}.attribute-config .textOverFlow {white-space: nowrap; overflow: hidden; text-overflow: ellipsis;}.attribute-config .section {padding: 15px 30px;}.header-section input,.links-section input,.appId-section input,.proxy-section input {height: 30px; border: 1px solid #d2dae2; padding: 5px; margin: 0; font-size: 12px; color: #232323; width: 100%; background-color: #fafafc; font-family: "Avenir Light";}.header-section input:focus,.links-section input:focus,.appId-section input:focus,.proxy-section input:focus {border: 1px solid #15a4fa; background-color: white; color: black;}.attribute-config .header-section {border: 0 solid;}.attribute-config .header-section .header-title,.attribute-config .title {color: #596679; line-height: 1.0; display: inline-block; width: 100%;}.attribute-config .styled-text {padding-right: 30px;}.jimu-rtl .attribute-config .styled-text {padding-left: 20px; padding-right: 0;}.attribute-config .header-section .logo-container {position: relative; font-size: 10px; width: 82px; height: 82px; margin-top: 10px; cursor: pointer; background-color: #ececec;}.attribute-config .header-section .logo-container:hover {background-color: #dcdcdc;}.attribute-config .header-section .logo-container.logo {border: 1px solid #d2dae2;}.attribute-config .header-section .logo-container.no-logo {border: 1px dashed #d2dae2;}.attribute-config .header-section .logo-container .hide {display: none;}.attribute-config .header-section .logo-container .jimu-image-chooser {width: 100%;}.attribute-config .header-section .logo-container.no-logo .jimu-image-chooser {position: absolute !important; opacity: 0; -ms-filter: "Alpha(opacity\x3d0)"; filter: Alpha(opacity\x3d0);}.attribute-config .header-section .logo-container .jimu-image-chooser .hint .display-image {width: auto; height: auto; max-width: 80px; max-height: 80px; background-size: contain;}.attribute-config .header-section .logo-container .add-logo {text-align: center; margin-top: 31px; cursor: pointer;}.attribute-config .header-section .logo-container .add-logo .image {margin: auto; margin-top: 10px; background: url(images/add_header.png) no-repeat center; width: 20px; height: 20px;}.attribute-config .header-section .logo-container .add-logo .text {font-size: 12px; color: #aaaaaa; text-align: center;}.attribute-config .header-section .logo-container .masker-node {position: absolute; z-index: 200; height: 100%; width: 100%; top: 0;}.attribute-config .header-section .logo-container .remove-logo {display: none; position: absolute; width: 25px; height: 25px; right: 0; z-index: 9999; cursor: pointer; background-color: rgba(0, 0, 0, .4); background-repeat: no-repeat; background-position: center;}.attribute-config .header-section .logo-container .remove-logo {top: 0; background-image: url(images/remove_logo.png);}.attribute-config .header-section .logo-container.logo:hover .remove-logo {display: block;}.attribute-config .header-section .logo-container.logo .remove-logo:hover {background-color: rgba(0, 0, 0, .6);}.attribute-config-plugin-logo-options.remove-logo {width: 25px; height: 25px; border-radius: 4px; background-repeat: no-repeat; background-position: center; background-image: url(images/remove_logo.png); z-index: 10000000; cursor: pointer; -ms-filter: "Alpha(opacity\x3d40)"; filter: Alpha(opacity\x3d40); background-color: rgb(0, 0, 0);}.attribute-config-plugin-logo-options.remove-logo:hover {-ms-filter: "Alpha(opacity\x3d60)"; filter: Alpha(opacity\x3d60); background-color: rgb(0, 0, 0);}.attribute-config .header-section .titles {font-size: 10px; margin-top: 10px; width: calc(100% - 82px - 1em);}.attribute-config .header-section .titles input {height: 36px; background-color: white;}.attribute-config .header-section .titles .title {width: 100%; position: relative;}.attribute-config .header-section\x3e.title {width: 100%; height: 20px; position: relative;}.attribute-config .header-section .subtitle {width: 100%; height: 32px; margin-top: 10px; position: relative;}.attribute-config .header-section .label-editor {position: absolute; width: 12px; height: 12px; background: url("./images/A.png") no-repeat center; top: 12px; right: 10px; cursor: pointer; background-color: white;}.attribute-config .header-section .label-editor:hover {background: url("./images/A_hover.png") no-repeat center; background-color: #fafafc;}.jimu-rtl .attribute-config .header-section .label-editor {right: auto; left: 1px;}.format-font-style .dijitEditorIFrameContainer {position: absolute; top: 36px; left: 1px; right: 1px; bottom: 3px;}.format-font-style .dijitToolbar .dijitTextBox {width: 180px !important;}.el .format-font-style .dijitToolbar .dijitTextBox {width: 150px !important;}.pt-pt .format-font-style .dijitToolbar .dijitTextBox {width: 160px !important;}.it .format-font-style .dijitToolbar .dijitTextBox {width: 160px !important;}.format-font-style .dijitToolbar {font-size: 12px;}.appId-section .attribute-content {margin-top: 10px;}.appId-section a {color: #7EC6F8; float: right; cursor: pointer;}.proxy-section {display: none;}.attribute-config .sub-title {padding: 15px 0 10px 0;}.links-section .attribute-content {width: 340px; padding-top: 15px;}.links-section,.proxy-section {color: #a0acbf;}.attribute-config .attribute-content .links-list,.attribute-config .attribute-content .proxy-rule-list {padding-top: 10px;}.attribute-config .attribute-content .list-item.selected-item,.attribute-config .attribute-content .list-item:hover {background-color: #e3ecf2;}.attribute-config .attribute-content .list-item.selected-item .mask,.attribute-config .attribute-content .list-item:hover .mask {background-color: #e3ecf2;}.attribute-config .attribute-content .list-item {overflow: hidden; border-top-style: none; border: 1px solid #d2dae2; border-bottom-color: #eef2f5;}.attribute-config .attribute-content .list-item+.list-item {border-top-style: none;}.attribute-config .attribute-content .list-item:last-child {border-bottom-color: #dad2de;}.attribute-config .attribute-content .list-item:first-child {border-top-color: #dad2de;}.attribute-config .attribute-content .list-item .mask {width: 100%; height: 30px; color: #a0acbf; font-size: 12px; line-height: 30px; padding-left: 10px; border-width: 1px; background-color: #fafafc;}.attribute-config .attribute-content .list-item .mask:first-child {font-size: 14px;}.attribute-config .attribute-content .list-item .first,.attribute-config .attribute-content .list-item .second {height: 30px;}.proxy-rule-header {width: 100%; height: 30px; line-height: 30px; background-color: #518dca; color: white; margin: 10px 0 -10px;}.proxy-rule-header div {float: left; border-style: none; padding-left: 10px;}.attribute-content .list-item .first,.proxy-rule-header .prefix {width: 110px;}.proxy-rule-header .proxy-url {width: 228px;}.attribute-content .list-item .second {width: 228px; border-left: 1px solid #eef2f5;}.attribute-config .attribute-content .list-item .first input {border-right-style: none;}.attribute-config .attribute-content .list-header {}.attribute-config .list-header .header-button {display: inline-block; padding: 0 15px 0 19px; color: #a0acbf; cursor: default;}.attribute-config .list-header .header-button.add {color: #518dca; cursor: pointer; background: url(images/add_icon01.png) no-repeat left;}.attribute-config .list-header .header-button.add:hover {background: url(images/add_icon02.png) no-repeat left;}.attribute-config .list-header .header-button.edit {background: url(images/edit_icon01.png) no-repeat left;}.attribute-config .list-header .header-button.delete {background: url(images/delete_icon01.png) no-repeat left;}.attribute-config .list-header .highlight-button {color: #518dca; cursor: pointer;}.attribute-config .list-header .highlight-button.add {color: #518dca; background: url(images/add_icon02.png) no-repeat left;}.attribute-config .list-header .highlight-button.edit {background: url(images/edit_icon02.png) no-repeat left;}.attribute-config .list-header .highlight-button.delete {background: url(images/delete_icon02.png) no-repeat left;}.jimu-rtl .attribute-config .list-header .header-button,.jimu-rtl .attribute-config .list-header .highlight-button {background-position: right !important;}.attribute-config .section .always-use-proxy {color: #596679; cursor: pointer; display: inline-block; margin-top: 15px; margin-bottom: 6px;}.attribute-config .section .always-use-proxy .label {display: inline; float: none;}.proxy-section .rules-label {color: #596679; font-size: 12px; margin: 10px 0 12px 0; display: block; line-height: 12px;}.proxy-section .error-status {border: 1px solid #e84b4b; background-color: #fff;}.controller-loading,.controller-appproxy {cursor: pointer;}.controller-loading:hover,.datasources:hover,.controller-appproxy:hover {background: #F3F3F3;}.controller-loading .action-content {padding-top: 15px; height: 48px;}.section-appstate .action-content {padding-top: 15px;}.section-appstate .appstate-check .label {float: none !important; font-size: 12px !important; margin-left: 30px; color: #000;}.jimu-rtl .section-appstate .appstate-check .label {margin-right: 30px; margin-left: auto;}.loadingpage-section,.appproxy-section {margin-top: 25px; width: 100%; padding: 0 30px;}.appproxy-section .attribute-link,.loadingpage-section .attribute-link {text-align: center; font-family: "Avenir Medium"; font-size: 16px; color: #232323; height: 22px; width: 100%;}.loadingpage-section .config-part {margin-top: 10px; font-size: 14px; color: #7889a0; width: 300px;}.loadingpage-section .bgColor-control {height: 30px; width: 340px; margin-top: 10px; text-align: center; line-height: 30px; color: #000000;}.loadingpage-section .bgUploaderDiv {width: 300px; height: 30px;}.loadingpage-section .loading-image-chooser {width: auto; height: 30px; line-height: 30px; margin-top: 10px;}.loadingpage-section .jimu-btn {padding-top: 1px;}.loadingpage-section .config-part .label {font-family: "Avenir Medium"; font-size: 14px; color: #000000;}.loadingpage-section .config-part .jimu-checkbox .label {font-family: "Avenir Light"; font-size: 12px; color: #000000;}.loadingpage-section .config-part label {font-family: "Avenir Light"; font-size: 12px; color: #333333;}.loadingpage-section .config-part .value {font-size: 14px; color: #000000; margin-left: 15px;}.loadingpage-section .gif_select {width: 100px; height: 32px;}.section {width: 100%;}.section .title \x3e span {line-height: 20px; font-family: "Avenir Medium"; font-size: 14px; color: #232323}.section .action-text,.sub-section .note {margin-top: 5px; line-height: 16px; font-size: 12px; color: #999999;}.appproxy-section {width: 100%;}.appproxy-section .sub-section {margin-top: 20px; width: 100%;}.appproxy-section .sub-section.double-margin {margin-top: 40px;}.appproxy-section .sub-section .title {line-height: 20px; font-family: "Avenir Medium"; font-size: 14px; color: #232323;}.appproxy-section .sub-section .row {height: 16px; margin-top: 13px;}.appproxy-section .sub-section .row \x3e .col:first-child {text-align: left;}.jimu-rtl .appproxy-section .sub-section .row \x3e .col:first-child {text-align: right;}.appproxy-section .sub-section .row \x3e .col:last-child {text-align: right;}.jimu-rtl .appproxy-section .sub-section .row \x3e .col:last-child {text-align: left;}.appproxy-section .sub-section .col {width: 32%; line-height: 16px; font-family: "Avenir-Book"; font-size: 12px; color: #232323; display: inline-block; text-align: center; text-overflow: ellipsis; overflow: hidden; white-space: nowrap;}.appproxy-section .sub-section .col.credits {background: url(images/PremiumContentUserCredit16.png) no-repeat center; height: 16px;}.appproxy-section .sub-section .col .checkbox {float: right !important;}.jimu-rtl .appproxy-section .sub-section .col .checkbox {float: left !important;}.appproxy-section .sub-section .header {height: 36px; margin: 10px 0;}.appproxy-section .sub-section .header .row {height: 36px; margin: 0;}.appproxy-section .sub-section .header .row .col {color: #898989; height: 36px; line-height: 36px;}.appproxy-section .sub-section .sepeartor {width: 100%; height: 1px; background: #EFEFEF;}.appproxy-section .note-content {font-family: "Avenir Medium"; font-size: 12px; color: #232323;}.loading {background: transparent;}.attribute-config .datasources {margin-top: 15px; cursor: pointer;}.datasources-link,.datasources-section {text-align: center; font-family: "Avenir Medium"; font-size: 16px; color: #232323; height: 22px; width: 100%;}.datasources-section {margin-top: 25px; width: 100%; height: auto; padding: 0 30px;}.attribute-config .additional-data-sources {text-align: initial; height: 100%; width: 100%;}.additional-data-sources .margin-right-10 {margin-right: 10px;}.jimu-rtl .additional-data-sources .margin-right-10 {margin-left: 10px; margin-right: 0;}.additional-data-sources .no-data-source-tip {background-size: contain; background: center center no-repeat url(\'images/no-data-source-tip.svg\');}.additional-data-sources .no-data-source-tip-box {width: 100px; height: 97px; margin: 80px auto 0 auto;}.additional-data-sources .ds-header {display: flex; justify-content: space-between; align-items: center;}.additional-data-sources .ds-title-box {max-width: 200px; text-overflow: ellipsis; height: 19px; margin-top: 15px}.additional-data-sources .ds-title {font-family: "Avenir Medium"; font-size: 14px; color: #000000;}.additional-data-sources .dataSource-add-box {margin-top: 15px; display: flex; height: 26px; justify-content: space-around; align-items: center;}.additional-data-sources .dataSource-add {cursor: pointer;}.additional-data-sources .dataSource-add .img_add {width: 12px; height: 12px; padding: 0 10px; background: no-repeat center center url(./images/ds_add.svg);}.additional-data-sources .dataSource-add .img_add_hover {background: no-repeat center center url(./images/ds_add_hover.svg);}.additional-data-sources .dataSource-add .text_add {font-family: Avenir-Medium; font-size: 12px; color: #666666; letter-spacing: 0.33px; max-width: 200px; text-overflow: ellipsis;}.additional-data-sources .dataSource-add .text_add_hover {color: #0C839C;}.additional-data-sources .ds-suspension.ds-options.hide {display: none;}.additional-data-sources .ds-suspension {position: absolute; box-shadow: 0 0 8px 0 rgba(0, 0, 0, 0.30); height: 194px; width: 160px; background: #ffffff;}.additional-data-sources .ds-options-lr {right: 39px; left: :inherit;}.jimu-rtl .additional-data-sources .ds-options-lr {left: 39px; right: inherit;}.additional-data-sources .ds-options {background: #FFFFFF; box-shadow: 0 2px 4px 0 rgba(0, 0, 0, 0.50); width: 143px; padding: 5px 2px; height: 84px; margin-top: 13px; display: flex; flex-direction: column; justify-content: center; align-items: center;}.additional-data-sources .ds-options .option-item {width: 143px; height: 32px; cursor: pointer; font-family: "Avenir Medium"; font-size: 14px; color: #000000; padding: 6px 23px;}.additional-data-sources .ds-options .option-item:hover {background-color: #DDDDDD;}.additional-data-sources .table-header {margin-top: 23px; display: flex; justify-content: space-between; align-items: center;}.additional-data-sources .table-header {padding-right: 7px;}.additional-data-sources .table-header div {font-size: 12px; color: #000; font-family: \'Avenir Medium\'; font-weight: bold;}.additional-data-sources .table-header div:first-child {width: 200px;}.additional-data-sources .table-header div:nth-child(2) {width: 51px;}.additional-data-sources .table-header div:nth-child(3) {width: 30px;}.attribute-config .additional-data-sources .horizontial-line {width: 340px; height: 1px; background: #D8D8D8; margin-top: 6px;}.additional-data-sources .sourcesList {max-height: 460px; overflow-x: hidden; overflow-y: auto; display: flex; flex-direction: column; justify-content: center; align-items: center; padding-right: 7px;}.additional-data-sources .sourcesList .source-tr {display: flex; justify-content: space-between; align-items: center; height: 34px; font-size: 12px; color: #000000; width: 100%; background-repeat: no-repeat;}.additional-data-sources .sourcesList .source-tr:hover {}.additional-data-sources .sourcesList .mid-line {width: 340px; height: 1px; background: #ccc;}.additional-data-sources .sourcesList .source-tr .source-tr-name {width: 200px; cursor: default;}.additional-data-sources .sourcesList .source-tr .source-tr-type {width: 51px;}.additional-data-sources .sourcesList .source-tr .source-tr-action {display: flex; justify-content: space-between; width: 30px; cursor: pointer;}.additional-data-sources .sourcesList .source-tr .source-tr-action .hidden {display: none;}.additional-data-sources .sourcesList .source-tr .source-tr-action div {width: 10px; height: 10px;}.additional-data-sources .sourcesList .edit {cursor: pointer; background-image: url(./images/ds_edit.svg); background-position: center;}.additional-data-sources .sourcesList .edit:hover {background-image: url(./images/ds_edit_hover.svg);}.additional-data-sources .sourcesList .delete {cursor: pointer; background-image: url(./images/ds_delete.svg); background-position: center;}.additional-data-sources .sourcesList .delete:hover {background-image: url(./images/ds_delete_hover.svg);}.additional-data-sources .dijitSelect {background-color: #ffffff;}.additional-data-sources .hidden {display: none;}.data-sources-config .marginTop5 {margin-top: 5px;}.data-sources-config .marginTop15 {margin-top: 15px;}.data-sources-config .marginTop20 {margin-top: 20px;}.data-sources-config .marginLeft5 {margin-left: 5px;}.jimu-rtl .data-sources-config .marginLeft5 {margin-right: 5px; margin-left: 0;}.data-sources-config .marginLeft10 {margin-left: 10px;}.jimu-rtl .data-sources-config .marginLeft10 {margin-right: 10px; margin-left: auto;}.data-sources-config .marginLeft15 {margin-left: 15px;}.jimu-rtl .data-sources-config .marginLeft15 {margin-right: 15px; margin-left: 0;}.data-sources-config .marginLeft20 {margin-left: 20px;}.jimu-rtl .data-sources-config .marginLeft20 {margin-right: 20px; margin-left: 0;}.data-sources-config .data-source-label {font-size: 14px; color: #353535; font-family: \'Avenir Medium\';}.data-sources-config .textOverFlow {white-space: nowrap; overflow: hidden; text-overflow: ellipsis;}.data-sources-config .data-source-sub-label {font-size: 12px; color: #353535; font-family: \'Avenir Medium\'; width: 270px;}.data-sources-config .ds-text-box {width: 750px; height: 30px;}.data-sources-config .flex-ltr-start {display: flex; justify-content: flex-start; align-items: center;}.data-sources-config .order {display: flex;}.data-sources-config .order .order-btn {width: 64px; height: 30px; font-size: 12px; border: 1px solid #D7D7D7; text-align: center; padding: 8px 0; cursor: pointer;}.data-sources-config .order .selected {background: #0C839C; border: none; color: white;}.data-sources-config .filterExpr {font-size: 12px; color: #999999; white-space: nowrap;}.data-sources-config .source {font-family: Avenir-Medium; font-size: 12px; color: #353535; cursor: default; overflow: hidden; white-space: nowrap; text-overflow: ellipsis;}.data-sources-config .radio {margin-top: 3px;}.data-sources-config .refreshContent label,.data-sources-config .refreshContent span {white-space: nowrap;}.data-sources-config .refreshContent {display: flex; justify-content: flex-start; align-items: center;}.data-sources-config .margin-left-10 {margin-left: 10px;}.jimu-rtl .data-sources-config .margin-left-10 {margin-right: 10px; margin-left: 0;}.data-sources-config .timeDiv {width: 70px; margin: auto 10px;}.data-sources-config .button {cursor: pointer; display: none; width: 75px; height: 30px; font-size: 12px; color: #353535; text-align: center; background: #FFFFFF; border: 1px solid #D7D7D7;}.data-sources-config .button:hover {background: #EFEFEF;}.data-sources-config .visible {display: block;}.data-sources-config .hide {display: none !important;}.data-sources-config .layerOptionDiv .resultRecordType .dijitSelect {width: 186px; background-color: white;}.data-sources-config .layerOptionDiv .resultRecordType .dijitSelect .dijitButtonText span {max-width: 138px; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; font-size: 12px; color: #232323;}.data-sources-config .layerOptionDiv .orderByField .dijitSelect .dijitButtonText span {max-width: 193px; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; font-size: 12px; color: #232323;}.data-sources-config .layerOptionDiv .groupFields .dijitSelect .dijitButtonText span {max-width: 200px; white-space: nowrap; overflow: hidden; text-overflow: ellipsis;}.data-sources-config .layerOptionDiv .orderByField .dijitSelect,.data-sources-config .statisticsOptionDiv .groupFields .dijitSelect {width: 250px; background-color: white;}.data-sources-config .layerOptionDiv .custom-number-div,.data-sources-config .layerOptionDiv .custom-number-div .custom-number {width: 60px; height: 30px;}.data-sources-config .inlineBlock {display: inline-block;}.data-sources-config .statisticsDiv .groupFields {display: inline-block; margin-left: 20px;}.data-sources-config .footer,.data-sources-filter .footer {position: absolute; width: 100%; left: 0; right: 0; bottom: 0; height: 36px;}.data-sources-config .footer .data-preview,.data-sources-filter .footer .data-preview {width: 115px; height: 30px; border: 1px solid #D7D7D7; cursor: pointer; font-size: 14px; color: #232323; text-align: center; padding: 5px 0;}.data-sources-filter .textOverFlow {white-space: nowrap; overflow: hidden; text-overflow: ellipsis;}.data-sources-filter .filterByExtent .jimu-checkbox .label {white-space: nowrap;}.data-sources-filter .footer .data-preview:hover,.data-sources-config .footer .data-preview:hover {background: #EFEFEF;}.data-sources-filter .footer .data-preview.sample-btn {width: 160px;}.data-sources-filter .filter-label {font-family: Avenir-Medium; font-size: 14px; color: #353535;}.data-sources-filter .filterDiv {width: 100%;}.data-sources-filter .margin-left-10 {margin-left: 10px;}.jimu-rtl .data-sources-filter .margin-left-10 {margin-right: 10px; margin-left: 0;}.data-sources-filter {overflow-x: hidden; overflow-y: auto; height: 365px;}.data-sources-filter .sourcesFilterDiv {width: 100%; overflow-y: auto;}.data-sources-config .left-arrow {width: 15px; height: 28px; z-index: 1; background-image: url(images/leftArrow.svg);}.jimu-rtl .data-sources-config .left-arrow.transform {-moz-transform: scaleX(-1); -webkit-transform: scaleX(-1); -o-transform: scaleX(-1); transform: scaleX(-1); filter: FlipH;}.data-sources-config .fieldsOptionDiv {display: flex; align-items: center; position: absolute; width: 175px;}.data-sources-config .suspension {height: 194px; background: #FFFFFF; overflow-x: hidden; box-shadow: 0px 0px 8px rgba(0, 0, 0, 0.30);}.jimu-rtl .data-sources-config .fieldsOption.fields-position-lr {right: 86px; left: inherit;}.data-sources-config .fieldsOption.fields-position-lr {left: 86px; right: inherit;}.data-sources-config .fieldsOption {z-index: 300; margin-top: -118px;}.jimu-rtl .data-sources-config .statisticsFieldsOption.statisrics-fields-position-lr {right: 355px; left: inherit;}.data-sources-config .statisticsFieldsOption.statisrics-fields-position-lr {left: 355px; right: inherit;}.data-sources-config .statisticsFieldsOption {z-index: 300; margin-top: -118px;}.jimu-widget-chart-setting-data-fields {width: 100%; margin: 13px 10px 13px 20px;}.jimu-widget-chart-setting-data-fields .fields-content {width: 100%;}.jimu-widget-chart-setting-data-fields .field-item {height: 20px; line-height: 20px; font-size: 12px; margin-top: 7px;}.jimu-rtl .jimu-widget-chart-setting-data-fields .field-item input {margin-left: 6px; margin-right: 0;}.jimu-widget-chart-setting-data-fields .field-item input {margin-right: 6px; position: relative; top: -4px;}.jimu-widget-chart-setting-data-fields .field-item span {width: 100px; display: inline-block; cursor: default;}.jimu-widget-chart-setting-data-fields .operation {display: none;}.custom-logo-page {font-family: Avenir-Book; font-size: 14px; color: #000000; margin-top: 10px;}.custom-logo-page .hide {display: none;}.custom-logo-page .preview-container {width: 130px; height: 130px; position: relative;}.custom-logo-page .preview-container .image-node,.custom-logo-page .preview-container .no-image {position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%);}.custom-logo-page .preview-container .image-node {max-width: 50px; max-height: 50px; background-color: #ececec;}.custom-logo-page .preview-container .no-image {background-color: transition; white-space: nowrap;}.custom-logo-page .separator {height: 150px; width: 1px; background: #CCCCCC; margin: 0 35px; border-radius: 2px;}.custom-logo-page .setting-container .setting-item {margin: 10px;}.custom-logo-page .setting-container .setting-item .label {margin: 10px 0;}.custom-logo-page .setting-container .setting-item .link-text {width: 350px;}.custom-logo-page .setting-container .choose-image-btn {width: 100px; height: 30px; border: 1px solid #CCCCCC; text-align: center; line-height: 30px; cursor: pointer;}',
"url:builder/plugins/creation-entry/Plugin.html":"\x3cdiv\x3e\r\n\r\n\x3c/div\x3e\r\n","url:builder/plugins/creation-entry/SaveAsPage.html":'\x3cdiv\x3e\r\n  \x3cp style\x3d"display:none;" class\x3d"configureApp"\x3e${nls.savePublish}\x3c/p\x3e\r\n  \x3cp style\x3d"display:none;" class\x3d"appBuilder"\x3e${nls.appBuilderTitle}\x3c/p\x3e\r\n  \x3cp style\x3d"display:none;" class\x3d"appBuilder"\x3e${nls.appBuilderMsg}\x3c/p\x3e\r\n\r\n\r\n  \x3cdiv class\x3d"item-info-box" data-dojo-attach-point\x3d"itemInfoBox" \x3e\r\n  \x3c/div\x3e\r\n\x3c/div\x3e\r\n',
"url:builder/plugins/creation-entry/CreateNewAppPage.html":'\x3cdiv\x3e\r\n  \x3cdiv class\x3d"app-select-page" data-dojo-attach-point\x3d"appSelectPage"\x3e\r\n    \x3cdiv class\x3d"switch-btn-box-container"\x3e\r\n      \x3cdiv class\x3d"switch-btn-box"\x3e\r\n        \x3cdiv class\x3d"switch-btn all-app-btn selected" data-dojo-attach-point\x3d"allAppBtn"\r\n             data-dojo-attach-event\x3d"onclick:_onAllAppBtnClick"\x3e ${nls.all}\r\n        \x3c/div\x3e\r\n        \x3cdiv class\x3d"separate"\x3e\x3c/div\x3e\r\n        \x3cdiv class\x3d"switch-btn own-app-btn" data-dojo-attach-point\x3d"ownAppBtn"\r\n             data-dojo-attach-event\x3d"onclick:_onOwnAppBtnClick"\x3e ${nls.myTemplates}\r\n        \x3c/div\x3e\r\n      \x3c/div\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv class\x3d"app-content all-app-content" data-dojo-attach-point\x3d"allAppContent"\x3e\r\n      \x3cdiv class\x3d"app-line" data-dojo-attach-point\x3d"defaultApps"\x3e\x3c/div\x3e\r\n      \x3cdiv class\x3d"app-line" data-dojo-attach-point\x3d"othersApps"\x3e\x3c/div\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv class\x3d"app-content own-app-content" data-dojo-attach-point\x3d"ownAppContent"\x3e\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e\r\n  \x3cdiv class\x3d"app-info-page" data-dojo-attach-point\x3d"appInfoPage"\x3e\r\n    \x3cdiv class\x3d"app-info-table" data-dojo-attach-point\x3d"appInfoTable"\x3e\x3c/div\x3e\r\n  \x3c/div\x3e\r\n\x3c/div\x3e',
"url:builder/plugins/creation-entry/css/style.css":".create-app-page {border: 0px solid; position: relative; margin: 0 auto;}.create-app-page .app-select-page {min-height: 200px;}.create-app-page .app-select-page .switch-btn-box-container {height: 50px; position: relative; margin-bottom: 10px; margin-left: 10px;}.create-app-page .app-select-page .switch-btn-box {position: absolute; left: 0; top: 20px; font-size: 14px; color: #999; font-weight: bold; line-height: 20px;}.jimu-rtl .create-app-page .app-select-page .switch-btn-box {right: 0; left: auto;}.jimu-rtl .create-app-page .app-select-page .switch-btn-box {margin-right: 8px; margin-left: auto;}.create-app-page .app-select-page .switch-btn-box .switch-btn {display: inline-block; cursor: pointer; font-size: 14px; text-align: center; min-width: 40px; border-bottom: 2px solid transparent;}.create-app-page .app-select-page .switch-btn-box .switch-btn:hover {color: #d84b28;}.create-app-page .app-select-page .switch-btn-box .switch-btn.selected {color: #d84b28; border-bottom: 2px solid #d84b28; min-width: 40px; text-align: center;}.create-app-page .app-select-page .switch-btn-box .separate {display: inline-block; width: 30px;}.create-app-page .app-info-page {width: 100%; border: 0px solid; top: 70px; margin: 0 auto;}.app-select-page .app-content {overflow: hidden;}.jimu-rtl .app-select-page .app-content {margin-right: 6px; margin-left: auto;}.app-select-page .all-app-content {overflow: auto; padding: 10px;}.app-select-page .own-app-content {overflow: auto; display: none; padding: 10px;}.app-select-page .app-content .app-line {float: left; width: 100%;}.jimu-rtl .app-select-page .app-content .app-line {float: right;}.app-select-page .app-content .app-node {border: 0px solid; text-align: center; position: relative; margin-right: 14px; cursor: pointer; max-width: 182px;}.app-select-page .app-content .app-node .flag-image {position: absolute; width: 26px; height: 22px; top: 86px; right: 10px; background-position: center; background-repeat: repeat; display: block;}.app-select-page .app-content .app-node .jimu-state-active .flag-image {}.app-select-page .app-content .app-node .flag-image-2D{background-image: url(images/flag_2d.png);}.app-select-page .app-content .app-node .flag-image-3D{background-image: url(images/flag_3d.png);}.app-select-page .app-content .app-node .app-image-border-div {position: relative; width: 180px; height: 120px; border: 2px solid transparent; border-radius: 4px; -webkit-box-shadow:0 0 10px rgba(0, 0, 0, .1); -moz-box-shadow:0 0 10px rgba(0, 0, 0, .1); box-shadow: 0 0 10px rgba(0, 0, 0, .1); background-color: #fff;}.app-select-page .app-content .app-node .app-image-div {width: 120px; height: 80px; background-repeat: no-repeat; background-color: #f2f2f2; background-position: center; margin: 0 auto; margin-top: 18px; background-size: 100% 100%;}.app-select-page .app-content .app-node .jimu-state-active .app-image-selected-container {width: 180px; height: 120px; background-color: rgba(255,255,255,0.6); position: absolute;}.app-select-page .app-content .app-node .jimu-state-active .app-image-selected-icon{position: absolute; width: 24px; height: 24px; top: 10px; right: 10px; background-position: center;}.app-select-page .app-content .app-node .app-name {color: #333; max-height: 50px; min-height: 20px; padding-top: 10px; padding-bottom: 10px; height: 40px; overflow: hidden; white-space: nowrap; text-overflow: ellipsis;}.app-select-page .app-content .app-node .jimu-state-active {border: 2px solid #31aacd; border-radius: 4px;}",
"url:builder/plugins/header/Plugin.html":'\x3cdiv class\x3d"top-nav clearfix"\x3e\r\n  \x3cdiv class\x3d"switch-section" data-dojo-attach-point\x3d"switchSection"\x3e\r\n    \x3cdiv class\x3d"switch-container"\x3e\r\n      \x3cdiv class\x3d"jimu-float-leading applist-switch apps selected" data-dojo-attach-point\x3d"appSwitch"\x3e${nls.apps}\x3c/div\x3e\r\n      \x3cdiv class\x3d"jimu-float-leading applist-switch templates" data-dojo-attach-point\x3d"templateSwitch"\x3e${nls.templates}\x3c/div\x3e\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e\r\n  \x3cdiv class\x3d"dropdown left dropdown-home" data-dojo-attach-point\x3d"homeSection"\x3e\r\n    \x3ca class\x3d"dropdown-btn top-nav-title site_logo" data-dojo-attach-point\x3d"homeLabel"\x3e${nls.home}\x3c/a\x3e\r\n    \x3cdiv class\x3d"dropdown-menu" data-dojo-attach-point\x3d"homeMenu"\x3e\r\n      \x3ca class\x3d"dropdown-link" nowrap target\x3d"_self" href\x3d"#" data-dojo-attach-point\x3d"homeItem"\x3e${nls.home}\x3c/a\x3e\r\n      \x3ca class\x3d"dropdown-link" nowrap target\x3d"_self" href\x3d"#" data-dojo-attach-point\x3d"galleryItem"\x3e${nls.gallery}\x3c/a\x3e\r\n      \x3ca class\x3d"dropdown-link" nowrap target\x3d"_self" href\x3d"#" data-dojo-attach-point\x3d"mapItem"\x3e${nls.map}\x3c/a\x3e\r\n      \x3ca class\x3d"dropdown-link" nowrap target\x3d"_self" href\x3d"#" data-dojo-attach-point\x3d"sceneItem"\x3e${nls.scene}\x3c/a\x3e\r\n      \x3ca class\x3d"dropdown-link" nowrap target\x3d"_self" href\x3d"#" data-dojo-attach-point\x3d"groupsItem"\x3e${nls.groups}\x3c/a\x3e\r\n      \x3ca class\x3d"dropdown-link" nowrap target\x3d"_self" href\x3d"#" data-dojo-attach-point\x3d"contentItem"\x3e${nls.content}\x3c/a\x3e\r\n      \x3ca class\x3d"dropdown-link hidden" nowrap target\x3d"_self" href\x3d"#" data-dojo-attach-point\x3d"organizationItem"\x3e${nls.organization}\x3c/a\x3e\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e\r\n  \x3ca class\x3d"top-nav-link top-nav-logo left" data-dojo-attach-point\x3d"logoTitle"\x3e\r\n    Web AppBuilder for ArcGIS\r\n  \x3c/a\x3e\r\n\r\n  \x3ch1 class\x3d"avenir-light left text-ellipsis font-size-1 leader-1 app-name"\x3e\x3ca target\x3d"_blank" data-dojo-attach-point\x3d"appName"\x3e\x3c/a\x3e\x3c/h1\x3e\r\n\r\n  \x3cdiv class\x3d"dropdown right" data-dojo-attach-point\x3d"userSection" data-dojo-attach-event\x3d"onclick:_onUserSectionClicked"\x3e\r\n    \x3ca class\x3d"top-nav-link dropdown-btn top-nav-username text-ellipsis" data-dojo-attach-point\x3d"userInfoDom"\x3e\r\n      \x3cimg data-dojo-attach-point\x3d"userIcon" src\x3d"${folderUrl}/css/images/no-user-thumb.jpg" width\x3d"16" height\x3d"16"/\x3e\r\n      \x3cspan data-dojo-attach-point\x3d"userNameNode"\x3e\x3c/span\x3e\r\n    \x3c/a\x3e\r\n    \x3cdiv class\x3d"dropdown-menu dropdown-right text-ellipsis" data-dojo-attach-point\x3d"userMenu"\x3e\r\n      \x3ca class\x3d"dropdown-link" nowrap target\x3d"_self" data-dojo-attach-point\x3d"profileItem"\x3e\r\n        \x3cimg width\x3d"32" height\x3d"32" class\x3d"gutter-right-half gutter-left-0 content-box left" data-dojo-attach-point\x3d"profileImg" src\x3d"${folderUrl}/css/images/no-user-thumb.jpg" /\x3e\r\n        \x3cspan\x3e${nls.profile}\x3c/span\x3e\r\n        \x3cbr\x3e\r\n        \x3cspan data-dojo-attach-point\x3d"profileNameNode" class\x3d"profile-name"\x3e\x3c/span\x3e\r\n      \x3c/a\x3e\r\n      \x3ca target\x3d"_blank" data-dojo-attach-point\x3d"communityNode" class\x3d"hidden dropdown-link dropdown-link-external communityNode"\x3e\r\n        \x3cspan class\x3d"icon-ui-link-external dropdown-link-external-icon"\x3e\x3c/span\x3e ${nls.communityAndForums}\r\n      \x3c/a\x3e\r\n      \x3ca target\x3d"_blank" data-dojo-attach-point\x3d"myesriNode" class\x3d"hidden dropdown-link dropdown-link-external myesriNode"\x3e\r\n        \x3cspan class\x3d"icon-ui-link-external dropdown-link-external-icon"\x3e\x3c/span\x3e ${nls.myesri}\r\n      \x3c/a\x3e\r\n      \x3ca target\x3d"_blank" data-dojo-attach-point\x3d"trainingNode" class\x3d"hidden dropdown-link dropdown-link-external trainingNode"\x3e\r\n        \x3cspan class\x3d"icon-ui-link-external dropdown-link-external-icon"\x3e\x3c/span\x3e ${nls.training}\r\n      \x3c/a\x3e\r\n      \x3ca target\x3d"_blank" data-dojo-attach-point\x3d"switchAccountsNode" class\x3d"hidden dropdown-link"\x3e${nls.switchAccounts}\x3c/a\x3e\r\n      \x3ca target\x3d"_blank" data-dojo-attach-point\x3d"helpNode" class\x3d"dropdown-link"\x3e${nls.help}\x3c/a\x3e\r\n      \x3ca target\x3d"_blank" data-dojo-attach-point\x3d"adminHelpNode" class\x3d"hidden dropdown-link admin-guide"\x3e${nls.administratorGuide}\x3c/a\x3e\r\n      \x3ca class\x3d"sign-out dropdown-link" data-dojo-attach-point\x3d"signOutItem"\x3e${nls.signOut}\x3c/a\x3e\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e\r\n\x3c/div\x3e',
"url:builder/plugins/header/css/style.css":'.plugin-header .switch-section{position: absolute; left: 0; right: 0; height: 100%; z-index: -1;}.plugin-header.app-opened .switch-section{display: none;}.plugin-header .switch-section .switch-container{min-width: 1024px; max-width: 1260px; height: 100%; margin-left: auto; margin-right: auto; overflow: hidden;}.plugin-header.width-less1816 .switch-section .switch-container{margin-left: 280px; margin-right: 0;}.jimu-rtl .plugin-header.width-less1816 .switch-section .switch-container{margin-right: 280px; margin-left: 0;}.plugin-header .switch-section .switch-container .applist-switch{height: 100%; line-height: 60px; cursor: pointer; color: #999999; font-size: 14px;}.plugin-header .switch-section .switch-container .applist-switch.selected{color: #31aacd;}.plugin-header .switch-section .switch-container .applist-switch.apps{margin-right: 40px;}.jimu-rtl .plugin-header .switch-section .switch-container .applist-switch.apps{margin-right: 0; margin-left: 40px;}.plugin-header.clearfix:after {content: \'\'; display: table; clear: both;}.plugin-header .left {float: left;}.plugin-header .right {float: right;}.plugin-header .avenir-light {letter-spacing: 0em; font-weight: 300; font-style: normal;}.plugin-header .avenir-light b, .plugin-header .avenir-light strong {font-weight: 500;}.plugin-header .avenir-regular,.plugin-header.top-nav,.plugin-header .top-nav-link,.plugin-header .dropdown-link {letter-spacing: 0em; font-weight: 400; font-style: normal;}.plugin-header .avenir-regular b,.plugin-header.top-nav b,.plugin-header .top-nav-link b,.plugin-header .avenir-regular strong,.plugin-header.top-nav strong,.plugin-header .top-nav-link strong {font-weight: 500;}.plugin-header .dropdown-btn:after {font-family: \'CalciteWebCoreIcons\'; padding-right: 0.5166666667em; speak: none; font-style: normal; font-weight: normal; font-variant: normal; text-transform: none; line-height: 1; -webkit-font-smoothing: antialiased; -moz-osx-font-smoothing: grayscale;}.plugin-header .dropdown-btn:after {padding-right: 0; padding-left: 0.5166666667em;}.plugin-header [class^\x3d"esri-icon-"]:before,.plugin-header [class*\x3d" esri-icon-"]:before,.plugin-header [class^\x3d"icon-ui-"]:before,.plugin-header [class*\x3d" icon-ui-"]:before {font-family: \'CalciteWebCoreIcons\'; padding-right: 0.5166666667em; speak: none; font-style: normal; font-weight: normal; font-variant: normal; text-transform: none; line-height: 1; -webkit-font-smoothing: antialiased; -moz-osx-font-smoothing: grayscale;}.plugin-header .esri-icon-link-external:before,.plugin-header .icon-ui-link-external:before {content: "\\e65c";}.plugin-header .esri-icon-down-arrow:before,.plugin-header .icon-ui-down-arrow:before,.plugin-header .dropdown-btn:after {content: "\\e608";}.plugin-header .esri-icon-user:before,.plugin-header .icon-ui-user:before {content: "\\e675";}.plugin-header .esri-icon-menu:before,.plugin-header .icon-ui-menu:before {content: "\\e663";}.plugin-header .top-nav-username {max-width: 175px; margin-bottom: -4px;}@media screen and (max-width: 1080px) {.plugin-header .top-nav-username {max-width: 130px;}}.plugin-header.top-nav {font-size: 17px; background-color: white;}.plugin-header.top-nav a {text-decoration: none;}.plugin-header.top-nav .dropdown-btn:after {top: 22px;}.plugin-header.top-nav {padding: 0 .5em; overflow: visible; z-index: 100;}.plugin-header .dropdown {position: relative; display: inline-block;}.plugin-header .dropdown.is-active .dropdown-menu {pointer-events: auto; display: block;}.plugin-header .dropdown-btn:after {font-family: \'CalciteWebCoreIcons\'; padding-right: 0.5166666667em; speak: none; font-style: normal; font-weight: normal; font-variant: normal; text-transform: none; -webkit-font-smoothing: antialiased; -moz-osx-font-smoothing: grayscale;}.plugin-header .dropdown-btn:after {padding-right: 0; padding-left: 0.5166666667em;}.plugin-header .dropdown-btn {padding-right: 2em; cursor: pointer; position: relative;}.jimu-rtl .plugin-header .dropdown-btn{padding-right: 0; padding-left: 2em;}.plugin-header .dropdown-btn:after {font-size: 0.8125em; line-height: 1.55em; position: absolute; right: .75em;}.jimu-rtl .plugin-header .dropdown-btn:after{right: auto; left: 0.75em;}.plugin-header .dropdown-menu {position: absolute; left: 0; right: auto; min-width: 200px; max-width: 300px; margin-top: -12px; top: 100%; -webkit-box-shadow: 0 0 16px 0 rgba(0, 0, 0, 0.05); -moz-box-shadow: 0 0 16px 0 rgba(0, 0, 0, 0.05); box-shadow: 0 0 16px 0 rgba(0, 0, 0, 0.05); z-index: 1000; pointer-events: none; display: none;}.jimu-rtl .plugin-header .dropdown-menu {left: auto; right: 0;}.plugin-header .dropdown-menu.dropdown-right {left: auto; right: 0;}.jimu-rtl .plugin-header .dropdown-menu.dropdown-right {left: 0; right: auto;}.plugin-header .dropdown-home .dropdown-btn {padding-top: 1em;}.plugin-header .side-nav, .plugin-header .dropdown-menu {-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; padding: 0; border: 1px solid #efefef; border-top: none; background-color: white;}.plugin-header .side-nav-title {margin: 0; padding: 0.5166666667em; font-size: 0.9375em; line-height: 1.55em; background-color: #f8f8f8; border-top: 1px solid #efefef;}.plugin-header .side-nav-link, .plugin-header .dropdown-link {position: relative; display: block; -webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; padding: 0.5166666667em 1.55em 0.5166666667em 0.5166666667em; font-size: 0.875em; line-height: 1.55em; color: #6e6e6e; background-color: white; border-top: 1px solid #efefef; -webkit-transition: all 150ms linear; transition: all 150ms linear; text-decoration: none; cursor: pointer;}.plugin-header .side-nav-link:after, .plugin-header .dropdown-link:after {content: "\\00BB"; opacity: 0; position: absolute; right: 0; top: .5em; padding: 0 0.3875em; -webkit-transition: all 150ms linear; transition: all 150ms linear;}.plugin-header .side-nav-link:hover, .plugin-header .dropdown-link:hover {text-decoration: none; color: #828282;}.plugin-header .side-nav-link:hover:after, .plugin-header .dropdown-link:hover:after {opacity: 1;}.plugin-header .side-nav-link.is-active, .plugin-header .is-active.dropdown-link {background-color: #d2e9f9; font-weight: inherit !important;}.plugin-header .dropdown-link {white-space: nowrap;}.plugin-header .dropdown-link-external {padding: 0.5166666667em 2em !important;}.plugin-header .dropdown-link-external-icon {position: absolute; left: .5em;}.plugin-header.top-nav {border-bottom: 1px solid #efefef;}.plugin-header.top-nav .esri-logo {margin-top: 1em;}.plugin-header.top-nav .sign-in {padding-top: 1.55em;}.plugin-header .top-nav-title {font-size: 1em; float: left; padding-top: 15px; padding-bottom: 15px; line-height: 1.5em; color: #4c4c4c;}.plugin-header .top-nav-title:hover {color: #3b8fc4; background: url(\'./images/top-nav-ie9.gif\') repeat-x bottom left transparent; text-decoration: none;}.plugin-header .top-nav-title.icon-ui-menu:before {vertical-align: -1px; padding-right: .5em;}.plugin-header .top-nav-list {padding: 0; float: left;}.plugin-header .top-nav-list .top-nav-link + .top-nav-link {margin-left: .75em;}.plugin-header .top-nav-link {font-size: 0.9375em; line-height: 1.55em; color: #4c4c4c; padding: 19px 0; line-height: 1.5em; display: inline-block;}.plugin-header .top-nav-link:hover, .plugin-header .top-nav-link:focus {color: #3b8fc4; background: url(\'./images/top-nav-ie9.gif\') repeat-x bottom left transparent; text-decoration: none;}.plugin-header .top-nav-link:hover a, .plugin-header .top-nav-link:focus a {color: #3b8fc4;}.plugin-header .top-nav-link:focus {outline: none;}.plugin-header .top-nav-link.is-active {background: url(\'./images/top-nav-ie9.gif\') repeat-x bottom left transparent;}.plugin-header .top-nav-link a {color: #4c4c4c;}.plugin-header .top-nav-link a:hover {text-decoration: none;}.plugin-header .top-nav-link.dropdown-btn {padding-right: 1em;}.plugin-header .top-nav-link.dropdown-btn:after {right: 0;}.plugin-header .user-nav-name {padding: 0.3875em;}.plugin-header .user-nav-image {width: 1.55em; height: 1.55em; margin-right: 0.3875em; vertical-align: -0.3875em;}.plugin-header .link-blue a, .plugin-header a.link-blue {color: #3b8fc4;}.plugin-header .link-blue a:hover, .plugin-header a.link-blue:hover {color: #196fa6;}.plugin-header .link-darkest-gray a,.plugin-header a.link-darkest-gray {color: #595959;}.plugin-header .link-darkest-gray a:hover, .plugin-header a.link-darkest-gray:hover {color: #4c4c4c;}.plugin-header .text-ellipsis {white-space: nowrap; overflow: hidden; text-overflow: ellipsis;}.plugin-header .font-size--3 {font-size: 0.8125em; line-height: 1.55em;}.plugin-header .font-size--2 {font-size: 0.875em; line-height: 1.55em;}.plugin-header .font-size--1 {font-size: 0.9375em; line-height: 1.55em;}.plugin-header .font-size-0 {font-size: 1em; line-height: 1.55em;}.plugin-header .font-size-1 {font-size: 1.1875em; line-height: 1.55em;}.plugin-header .font-size-2 {font-size: 1.25em;}.plugin-header .font-size-3 {font-size: 1.484375em; line-height: 2.325em;}.plugin-header .leader-half {margin-top: 11px;}.plugin-header .trailer-half {margin-bottom: 0.775em;}.plugin-header .padding-leader-half {padding-top: 0.775em;}.plugin-header .padding-trailer-half {padding-bottom: 0.775em;}.plugin-header .leader-0 {margin-top: 0em;}.plugin-header .trailer-0 {margin-bottom: 0em;}.plugin-header .padding-leader-0 {padding-top: 0em;}.plugin-header .padding-trailer-0 {padding-bottom: 0em;}.plugin-header .leader-1 {margin-top: 14px;}.plugin-header .padding-leader-1 {padding-top: 22px;}.plugin-header .gutter-left-half {padding-left: 0.5em;}.plugin-header .gutter-right-half {padding-right: 0.5em;}.plugin-header .gutter-left-0 {padding-left: 0em;}.plugin-header .gutter-right-0 {padding-right: 0em;}.plugin-header .gutter-left-1 {padding-left: 1em;}.plugin-header .gutter-right-1 {padding-right: 1em;}.plugin-header .gutter-right-2 {padding-right: 2em;}.jimu-rtl .plugin-header .gutter-left-half {padding-left: 0; padding-right: 0.5em;}.jimu-rtl .plugin-header .gutter-right-half {padding-right: 0; padding-left: 0.5em;}.jimu-rtl .plugin-header .gutter-left-0 {padding-left: 0; padding-right: 0;}.jimu-rtl .plugin-header .gutter-right-0 {padding-left: 0; padding-right: 0;}.jimu-rtl .plugin-header .gutter-left-1 {padding-left: 0; padding-right: 1em;}.jimu-rtl .plugin-header .gutter-right-1 {padding-right: 0; padding-left: 1em;}.jimu-rtl .plugin-header .gutter-right-2 {padding-right: 0; padding-left: 2em;}.jimu-rtl .plugin-header .left {float: right;}.jimu-rtl .plugin-header .right {float: left;}.jimu-rtl .plugin-header .top-nav-title {float: right;}.jimu-rtl .plugin-header .top-nav-link {float: right;}.jimu-rtl .plugin-header .top-nav-list {float: right;}.jimu-rtl .plugin-header .top-nav-link + .top-nav-link {margin-left: 0; margin-right: .75em;}.jimu-rtl .plugin-header .gutter-left-half {padding-right: 0.5em;}.jimu-rtl .plugin-header .gutter-right-half {padding-left: 0.5em;}.jimu-rtl .plugin-header .gutter-left-0 {padding-right: 0em;}.jimu-rtl .plugin-header .gutter-right-0 {padding-left: 0em;}.jimu-rtl .plugin-header .gutter-left-1 {padding-right: 1em;}.jimu-rtl .plugin-header .gutter-right-1 {padding-left: 1em; padding-right: 0.5em;}.jimu-rtl .plugin-header .gutter-right-2 {padding-left: 2em;}.jimu-rtl .plugin-header .top-nav-link.dropdown-btn:after {left: 0; right: auto; padding-right: 0.5166666667em; padding-left: 0;}.jimu-rtl .plugin-header .top-nav-link.dropdown-btn {padding-left: 1em; padding-right: 0;}.jimu-rtl .plugin-header .side-nav-link:after, .jimu-rtl .plugin-header .dropdown-link:after {left: 0; right: auto;}.jimu-rtl .plugin-header .side-nav-link, .jimu-rtl .plugin-header .dropdown-link {padding: 0.5166666667em 0.5166666667em 0.5166666667em 2.5em;}.jimu-rtl .plugin-header [class^\x3d"icon-ui-"]:before, .jimu-rtl .plugin-header [class*\x3d" icon-ui-"]:before {padding-right: 0; padding-left: 0.5166666667em;}.jimu-rtl .plugin-header .sub-nav-link, .jimu-rtl .plugin-header a.sub-nav-link {float: right;}.jimu-rtl .plugin-header .dropdown-link-external-icon {left: auto; right: .5em;}.plugin-header.top-nav .hidden {display: none;}.plugin-header .top-nav-logo {padding-left: 36px; padding-right: 15px; background: url(images/logo.png) no-repeat left center;}.plugin-header .top-nav-logo:hover {background: url(images/logo.png) no-repeat left center;}.plugin-header.xt.app-opened .top-nav-logo{cursor: pointer;}.jimu-rtl .plugin-header .top-nav-logo {padding-left: 15px; padding-right: 36px; background: url(images/logo.png) no-repeat right center;}.jimu-rtl .plugin-header .top-nav-logo {background: url(images/logo.png) no-repeat right center;}.plugin-header .content-box {box-sizing: content-box !important;}.plugin-header .app-name {max-width: 60%;}.plugin-header .app-name a{color: black;}.plugin-header .app-name a.highlight:hover{color: #3b8fc4;}@media screen and (max-width: 960px) {.plugin-header .app-name {max-width: 40%;}}@media screen and (max-width: 720px) {.plugin-header .app-name {max-width: 30%;}}.plugin-header .top-nav-logo{position: relative; top: 1px;}.plugin-header .top-nav-username{font-size: 14px;}.plugin-header .top-nav-username img{position: relative; top: 3px;}.plugin-header .top-nav-username span{position: relative;}.plugin-header.app-not-opened{background-color: #333333;}.plugin-header.app-not-opened .top-nav-link.top-nav-logo{color: #ffffff !important;}.plugin-header.app-not-opened .switch-section .switch-container .applist-switch{color: #999999;}.plugin-header.app-not-opened .switch-section .switch-container .applist-switch.selected{color: #ffffff;}.plugin-header.app-not-opened .top-nav-link.top-nav-username{color: #999999 !important;}',
"url:builder/plugins/map-config/Plugin.html":'\x3cdiv\x3e\r\n  \x3cdiv class\x3d"map-info-section"\x3e\r\n    \x3cdiv class\x3d"map-selected-meta-data"\x3e\r\n      \x3cdiv class\x3d"thumbnail-container" data-dojo-attach-point\x3d"thumbnailContainer" data-dojo-attach-event\x3d"click:showMapSelector" title\x3d"${nls.clickChooseWebMapOrWebScene}"\x3e\r\n      \x3c/div\x3e\r\n      \x3cdiv class\x3d"detail-info"\x3e\r\n        \x3cdiv style\x3d"overflow:hidden;"\x3e\r\n          \x3cdiv data-dojo-attach-point\x3d"webItemIcon" class\x3d"web-item-icon jimu-float-leading"\x3e\x3c/div\x3e\r\n          \x3cdiv class\x3d"owner-div jimu-float-leading" style\x3d"width:140px;"\x3e\r\n            \x3cspan class\x3d"item-type" data-dojo-attach-point\x3d"webItemType"\x3e\x3c/span\x3e\r\n          \x3c/div\x3e\r\n        \x3c/div\x3e\r\n        \x3cdiv class\x3d"owner-link-div"\x3e\r\n          \x3cspan class\x3d"owner-tip"\x3e${nls.owner}\x3c/span\x3e\r\n          \x3ca class\x3d"owner-name" href\x3d"#" target\x3d"_blank" data-dojo-attach-point\x3d"ownerName"\x3e\x3c/a\x3e\r\n        \x3c/div\x3e\r\n        \x3cdiv style\x3d"margin-top:5px;color:#596679;"\x3e\r\n          \x3cspan\x3e${nls.lastModified}:\x3c/span\x3e\r\n          \x3cdiv data-dojo-attach-point\x3d"lastModified" class\x3d"last-modified"\x3e\x3c/div\x3e\r\n        \x3c/div\x3e\r\n        \x3cdiv class\x3d"webmap-details-div"\x3e\r\n          \x3ca data-dojo-attach-point\x3d"webMapDetails" href\x3d"#" target\x3d"_blank" class\x3d"webmap-details" title\x3d"${nls.moreDetails}"\x3e${nls.moreDetails}...\x3c/a\x3e\r\n        \x3c/div\x3e\r\n\r\n        \x3cdiv class\x3d"map-chooser"\x3e\r\n          \x3cdiv nowrap class\x3d"choose-map-btn" data-dojo-attach-event\x3d"click:showMapSelector"\x3e\r\n            \x3cdiv class\x3d"label" data-dojo-attach-point\x3d"chooseMapButton" title\x3d"${nls.chooseWebMapOrWebScene}"\x3e${nls.chooseWebMapOrWebScene}\x3c/div\x3e\r\n            \x3cdiv class\x3d"options jimu-float-trailing" data-dojo-attach-point\x3d"mapOptions" data-dojo-attach-event\x3d"click:showMapOptions"\x3e\x3c/div\x3e\r\n          \x3c/div\x3e\r\n          \x3cdiv data-dojo-attach-point\x3d"webMapEditOptions" class\x3d"edit-options" style\x3d"display: none;"\x3e\r\n            \x3cdiv nowrap class\x3d"option-item" data-dojo-attach-point\x3d"btnEditWebMap" data-dojo-attach-event\x3d"click:editWebMap" title\x3d"${nls.editMap}"\x3e${nls.editMap}\x3c/div\x3e\r\n            \x3cdiv nowrap class\x3d"option-item" data-dojo-attach-point\x3d"btnCreateWebMap" data-dojo-attach-event\x3d"click:createWebMap" title\x3d"${nls.createMap}"\x3e${nls.createMap}\x3c/div\x3e\r\n          \x3c/div\x3e\r\n          \x3cdiv data-dojo-attach-point\x3d"webMapOptionsMask" class\x3d"overlay-mask" data-dojo-attach-event\x3d"click:hideMapOptions" style\x3d"display: none;"\x3e\x3c/div\x3e\r\n        \x3c/div\x3e\r\n      \x3c/div\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv class\x3d"map-info-content"\x3e\r\n      \x3cdiv class\x3d"map-info-title option-title" data-dojo-attach-point\x3d"mapTitle"\x3e\x3c/div\x3e\r\n      \x3cp class\x3d"snippet" data-dojo-attach-point\x3d"snippet"\x3e\x3c/p\x3e\r\n      \x3cdiv class\x3d"map-options" data-dojo-attach-point\x3d"mapOptions2D"\x3e\r\n        \x3cdiv class\x3d"map-option extent-option"\x3e\r\n          \x3cdiv class\x3d"option-title"\x3e${nls.setInitialExtent}\x3c/div\x3e\r\n          \x3cp class\x3d"option-statement"\x3e${nls.statement}\x3c/p\x3e\r\n          \x3cspan class\x3d"jimu-btn init-ext-btn jimu-btn-vacation" data-dojo-attach-event\x3d"onclick:_useCurrentMapExtent"\x3e${nls.useCurrentExtent}\x3c/span\x3e\x3cbr\x3e\r\n          \x3cspan class\x3d"jimu-btn restore-ext-btn jimu-btn-vacation" data-dojo-attach-event\x3d"onclick:_useDefaultMapExtent"\x3e${nls.restoreInitialExtent}\x3c/span\x3e\r\n        \x3c/div\x3e\r\n        \x3cdiv class\x3d"map-option scale-option"\x3e\r\n          \x3cdiv class\x3d"option-title"\x3e${nls.scaleTitle}\x3c/div\x3e\r\n          \x3cp class\x3d"option-statement"\x3e${nls.scaleStatement}\x3c/p\x3e\r\n          \x3cspan class\x3d"jimu-btn scale-btn jimu-btn-vacation" data-dojo-attach-point\x3d"btnScale" data-dojo-attach-event\x3d"onclick:_onBtnScaleClicked"\x3e${nls.customize}...\x3c/span\x3e\r\n        \x3c/div\x3e\r\n        \x3cdiv data-dojo-type\x3d"builder/dijit/RefreshInterval" data-dojo-attach-point\x3d"refreshIntervalDijit"\x3e\x3c/div\x3e\r\n      \x3c/div\x3e\r\n      \x3cdiv class\x3d"map-options" data-dojo-attach-point\x3d"mapOptions3D"\x3e\r\n        \x3cdiv class\x3d"map-option extent-option"\x3e\r\n          \x3cdiv class\x3d"option-title"\x3e${nls.setInitialSceneState}\x3c/div\x3e\r\n          \x3cp class\x3d"option-statement"\x3e${nls.sceneStateTip}\x3c/p\x3e\r\n          \x3cspan class\x3d"jimu-btn init-ext-btn jimu-btn-vacation" title\x3d"${nls.useCurrentSceneState}" data-dojo-attach-event\x3d"onclick:_useCurrentViewpoint"\x3e${nls.useCurrentSceneState}\x3c/span\x3e\x3cbr\x3e\r\n          \x3cspan class\x3d"jimu-btn restore-ext-btn jimu-btn-vacation" title\x3d"${nls.useWebSceneDefaultState}" data-dojo-attach-event\x3d"onclick:_useDefaultViewpoint"\x3e${nls.useWebSceneDefaultState}\x3c/span\x3e\r\n        \x3c/div\x3e\r\n      \x3c/div\x3e\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e\r\n\x3c/div\x3e',
"url:builder/plugins/map-config/MapSelector.html":'\x3cdiv style\x3d"position:relative;width:100%;height:100%;"\x3e\r\n\t\x3cdiv class\x3d"map-setting-tab-container" style\x3d"width:100%;height:100%;"\x3e\r\n\t\t\x3cdiv data-dojo-attach-point\x3d"tabNode"\x3e\x3c/div\x3e\r\n\r\n\t\t\x3cdiv class\x3d"tab-content mycontent-tab" data-dojo-attach-point\x3d"mycontentTabNode"\x3e\r\n\t\t\t\x3cdiv class\x3d"tab-content-main mycontent-tab-content-main"\x3e\r\n\t\t\t\t\x3cdiv class\x3d"search-section"\x3e\r\n\t\t\t\t\t\x3cdiv data-dojo-attach-point\x3d"mycontentSearch" data-dojo-type\x3d"jimu/dijit/Search" data-dojo-props\x3d\'searchWhenInput:false\' data-dojo-attach-event\x3d"onSearch:_onMyContentSearch" class\x3d"jimu-float-leading"\x3e\x3c/div\x3e\r\n\t\t\t\t\t\x3cdiv class\x3d"refresh-icon jimu-float-trailing" data-dojo-attach-event\x3d"click:_onMyContentRefreshIconClicked"\x3e\x3c/div\x3e\r\n\t\t\t\t\t\x3cselect data-dojo-type\x3d"dijit/form/Select" data-dojo-attach-point\x3d"mycontentSelect" data-dojo-attach-event\x3d"change:_onMyContentSearch" class\x3d"jimu-float-trailing restrict-select-width"\x3e\r\n\t\t\t\t\t\t\x3coption value\x3d"modified" selected\x3d"true"\x3e${nls.mostRecent}\x3c/option\x3e\r\n\t\t\t\t\t\t\x3coption value\x3d"numviews"\x3e${nls.mostViewed}\x3c/option\x3e\r\n\t\t\t\t\t\t\x3coption value\x3d"avgrating"\x3e${nls.highestRated}\x3c/option\x3e\r\n\t\t\t\t\t\t\x3coption value\x3d"title"\x3e${nls.title}\x3c/option\x3e\r\n\t\t\t\t\t\t\x3coption value\x3d"owner"\x3e${nls.owner}\x3c/option\x3e\r\n\t\t\t\t\t\x3c/select\x3e\r\n\t\t\t\t\x3c/div\x3e\r\n\t\t\t\t\x3cdiv data-dojo-attach-point\x3d"mycontentMapTable" data-dojo-type\x3d"builder/plugins/map-config/MapTable" data-dojo-props\x3d"type:\'${type}\'"  style\x3d"top:65px;"\x3e\x3c/div\x3e\r\n\t\t\t\x3c/div\x3e\r\n\t\t\x3c/div\x3e\r\n\r\n\t\t\x3cdiv class\x3d"tab-content organization-tab" data-dojo-attach-point\x3d"organizationTabNode"\x3e\r\n\t\t\t\x3cdiv class\x3d"tab-content-main organization-tab-content-main"\x3e\r\n\t\t\t\t\x3cdiv class\x3d"search-section"\x3e\r\n\t\t\t\t\t\x3cdiv data-dojo-attach-point\x3d"organizationSearch" data-dojo-type\x3d"jimu/dijit/Search" data-dojo-props\x3d\'searchWhenInput:false\' data-dojo-attach-event\x3d"onSearch:_onOrganizationSearch" class\x3d"jimu-float-leading"\x3e\x3c/div\x3e\r\n\t\t\t\t\t\x3cdiv class\x3d"refresh-icon jimu-float-trailing" data-dojo-attach-event\x3d"click:_onOrgRefreshIconClicked"\x3e\x3c/div\x3e\r\n\t\t\t\t\t\x3cselect data-dojo-type\x3d"dijit/form/Select" data-dojo-attach-point\x3d"organizationSelect" data-dojo-attach-event\x3d"change:_onOrganizationSearch" class\x3d"jimu-float-trailing restrict-select-width"\x3e\r\n\t\t\t\t\t\t\x3coption value\x3d"modified" selected\x3d"true"\x3e${nls.mostRecent}\x3c/option\x3e\r\n\t\t\t\t\t\t\x3coption value\x3d"numviews"\x3e${nls.mostViewed}\x3c/option\x3e\r\n\t\t\t\t\t\t\x3coption value\x3d"avgrating"\x3e${nls.highestRated}\x3c/option\x3e\r\n\t\t\t\t\t\t\x3coption value\x3d"title"\x3e${nls.title}\x3c/option\x3e\r\n\t\t\t\t\t\t\x3coption value\x3d"owner"\x3e${nls.owner}\x3c/option\x3e\r\n\t\t\t\t\t\x3c/select\x3e\r\n\t\t\t\t\x3c/div\x3e\r\n\t\t\t\t\x3cdiv data-dojo-attach-point\x3d"organizationMapTable" data-dojo-type\x3d"builder/plugins/map-config/MapTable" data-dojo-props\x3d"type:\'${type}\'" style\x3d"top:65px;"\x3e\x3c/div\x3e\r\n\t\t\t\x3c/div\x3e\r\n\t\t\x3c/div\x3e\r\n\r\n\t\t\x3cdiv class\x3d"tab-content group-tab" data-dojo-attach-point\x3d"groupTabNode"\x3e\r\n\t\t\t\x3cdiv class\x3d"tab-content-main group-tab-content-main"\x3e\r\n\t\t\t\t\x3cdiv class\x3d"groups-section" style\x3d"position:absolute;width:100%;top:70px;" data-dojo-attach-point\x3d"groupsSection"\x3e\r\n\t\t\t\t\t\x3cspan\x3e${nls.groups}:\x3c/span\x3e\r\n\t\t\t\t\t\x3cselect class\x3d"groups-select" data-dojo-attach-point\x3d"groupsSelect"\x3e\r\n\t\t\t\t\t\t\x3coption value\x3d"nodata"\x3e${nls.noneGroups}\x3c/option\x3e\r\n\t\t\t\t\t\x3c/select\x3e\r\n\t\t\t\t\x3c/div\x3e\r\n\t\t\t\t\x3cdiv class\x3d"search-section" data-dojo-attach-point\x3d"groupSearchSection"\x3e\r\n\t\t\t\t\t\x3cdiv data-dojo-attach-point\x3d"groupSearch" data-dojo-type\x3d"jimu/dijit/Search" data-dojo-props\x3d\'searchWhenInput:false\' data-dojo-attach-event\x3d"onSearch:_onGroupSearch" class\x3d"jimu-float-leading"\x3e\x3c/div\x3e\r\n\t\t\t\t\t\x3cdiv class\x3d"refresh-icon jimu-float-trailing" data-dojo-attach-event\x3d"click:_onGroupRefreshIconClicked"\x3e\x3c/div\x3e\r\n\t\t\t\t\t\x3cselect data-dojo-type\x3d"dijit/form/Select" data-dojo-attach-point\x3d"groupSelect" data-dojo-attach-event\x3d"change:_onGroupSearch" class\x3d"jimu-float-trailing restrict-select-width"\x3e\r\n\t\t\t\t\t\t\x3coption value\x3d"modified" selected\x3d"true"\x3e${nls.mostRecent}\x3c/option\x3e\r\n\t\t\t\t\t\t\x3coption value\x3d"numviews"\x3e${nls.mostViewed}\x3c/option\x3e\r\n\t\t\t\t\t\t\x3coption value\x3d"avgrating"\x3e${nls.highestRated}\x3c/option\x3e\r\n\t\t\t\t\t\t\x3coption value\x3d"title"\x3e${nls.title}\x3c/option\x3e\r\n\t\t\t\t\t\t\x3coption value\x3d"owner"\x3e${nls.owner}\x3c/option\x3e\r\n\t\t\t\t\t\x3c/select\x3e\r\n\t\t\t\t\x3c/div\x3e\r\n\t\t\t\t\x3cdiv data-dojo-attach-point\x3d"groupMapTable" data-dojo-type\x3d"builder/plugins/map-config/MapTable" data-dojo-props\x3d"type:\'${type}\'" style\x3d"top:113px;"\x3e\x3c/div\x3e\r\n\t\t\t\x3c/div\x3e\r\n\t\t\x3c/div\x3e\r\n\r\n\t\t\x3cdiv class\x3d"tab-content public-tab" data-dojo-attach-point\x3d"publicTabNode"\x3e\r\n\t\t\t\x3cdiv class\x3d"tab-content-main public-tab-content-main"\x3e\r\n\t\t\t\t\x3cdiv class\x3d"search-section"\x3e\r\n\t\t\t\t\t\x3cdiv data-dojo-attach-point\x3d"publicSearch" data-dojo-type\x3d"jimu/dijit/Search" data-dojo-props\x3d\'searchWhenInput:false\' data-dojo-attach-event\x3d"onSearch:_onPublicSearch" class\x3d"jimu-float-leading"\x3e\x3c/div\x3e\r\n\t\t\t\t\t\x3cdiv class\x3d"refresh-icon jimu-float-trailing" data-dojo-attach-event\x3d"click:_onPublicRefreshIconClicked"\x3e\x3c/div\x3e\r\n\t\t\t\t\t\x3cselect data-dojo-type\x3d"dijit/form/Select" data-dojo-attach-point\x3d"publicSelect" data-dojo-attach-event\x3d"change:_onPublicSearch" class\x3d"jimu-float-trailing restrict-select-width"\x3e\r\n\t\t\t\t\t\t\x3coption value\x3d"modified"\x3e${nls.mostRecent}\x3c/option\x3e\r\n\t\t\t\t\t\t\x3coption value\x3d"numviews" selected\x3d"true"\x3e${nls.mostViewed}\x3c/option\x3e\r\n\t\t\t\t\t\t\x3coption value\x3d"avgrating"\x3e${nls.highestRated}\x3c/option\x3e\r\n\t\t\t\t\t\t\x3coption value\x3d"title"\x3e${nls.title}\x3c/option\x3e\r\n\t\t\t\t\t\t\x3coption value\x3d"owner"\x3e${nls.owner}\x3c/option\x3e\r\n\t\t\t\t\t\x3c/select\x3e\r\n\t\t\t\t\x3c/div\x3e\r\n\t\t\t\t\x3cdiv class\x3d"public-search-radios"\x3e\r\n\t\t\t\t\t\x3cinput data-dojo-attach-point\x3d"portalPublicRaido" type\x3d"radio" name\x3d"publicSearchRaido" class\x3d"jimu-float-leading portal-public-radio jimu-radio-btn" /\x3e\r\n\t\t\t\t\t\x3clabel  data-dojo-attach-point\x3d"portalNameLabel" class\x3d"jimu-float-leading portal-name"\x3ePortal\x3c/label\x3e\r\n\t\t\t\t\t\x3cinput data-dojo-attach-point\x3d"onlinePublicRaido" type\x3d"radio" name\x3d"publicSearchRaido" class\x3d"jimu-float-leading online-public-radio jimu-radio-btn" /\x3e\r\n\t\t\t\t\t\x3clabel data-dojo-attach-point\x3d"onlineNameLabel" class\x3d"jimu-float-leading online-name"\x3eArcGIS Online\x3c/label\x3e\r\n\t\t\t\t\x3c/div\x3e\r\n\t\t\t\t\x3cdiv data-dojo-attach-point\x3d"publicMapSection" class\x3d"public-map-section"\x3e\r\n\t\t\t\t\t\x3cdiv data-dojo-attach-point\x3d"publicPortalMapTable" data-dojo-type\x3d"builder/plugins/map-config/MapTable" data-dojo-props\x3d"type:\'${type}\'"\x3e\x3c/div\x3e\r\n\t\t\t\t\t\x3cdiv data-dojo-attach-point\x3d"publicOnlineMapTable" data-dojo-type\x3d"builder/plugins/map-config/MapTable" data-dojo-props\x3d"type:\'${type}\'"\x3e\x3c/div\x3e\r\n\t\t\t\t\x3c/div\x3e\r\n\t\t\t\x3c/div\x3e\r\n\t\t\x3c/div\x3e\r\n\r\n\t\x3c/div\x3e\r\n\t\x3cdiv class\x3d"signin-section hidden" data-dojo-attach-point\x3d"signinSection"\x3e\r\n\t\t\x3cdiv class\x3d"signin-tip"\x3e${nls.signInTip}\x3c/div\x3e\r\n\t\x3c/div\x3e\r\n\x3c/div\x3e',
"url:builder/plugins/map-config/MapTable.html":'\x3cdiv\x3e\r\n\t\x3cdiv class\x3d"maps-section" data-dojo-attach-point\x3d"allMapsSection"\x3e\r\n\t\t\x3cdiv class\x3d"maps-table-div" data-dojo-attach-point\x3d"allMapsTableDiv"\x3e\r\n\t\t\t\x3ctable class\x3d"maps-table" cellpadding\x3d"10" data-dojo-attach-point\x3d"allMapsTable"\x3e\r\n\t\t\t\t\x3ctbody class\x3d"maps-tbody" data-dojo-attach-point\x3d"allMapsTbody"\x3e\x3c/tbody\x3e\r\n\t\t\t\x3c/table\x3e\r\n\t\t\x3c/div\x3e\r\n\t\t\x3cdiv data-dojo-type\x3d"jimu/dijit/LoadingIndicator" data-dojo-attach-point\x3d"allMapsShelter" data-dojo-props\x3d\'hidden:true\'\x3e\x3c/div\x3e\r\n\t\x3c/div\x3e\r\n\t\x3cdiv class\x3d"maps-section hidden" data-dojo-attach-point\x3d"filteredMapsSection"\x3e\r\n\t\t\x3cdiv class\x3d"maps-table-div" data-dojo-attach-point\x3d"filteredMapsTableDiv"\x3e\r\n\t\t\t\x3ctable class\x3d"maps-table" cellpadding\x3d"10" data-dojo-attach-point\x3d"filteredMapsTable"\x3e\r\n\t\t\t\t\x3ctbody class\x3d"maps-tbody" data-dojo-attach-point\x3d"filteredMapsTbody"\x3e\x3c/tbody\x3e\r\n\t\t\t\x3c/table\x3e\r\n\t\t\x3c/div\x3e\r\n\t\t\x3cdiv class\x3d"search-none-tip-section hidden" data-dojo-attach-point\x3d"searchNoneTipSection"\x3e\r\n\t\t\t\x3cspan class\x3d"search-none-icon jimu-icon jimu-icon-error"\x3e\x3c/span\x3e\r\n\t\t\t\x3cspan class\x3d"search-none-tip"\x3e${nls.searchNone}\x3c/span\x3e\r\n\t\t\x3c/div\x3e\r\n\t\t\x3cdiv data-dojo-type\x3d"jimu/dijit/LoadingIndicator" data-dojo-attach-point\x3d"filteredMapsShelter" data-dojo-props\x3d\'hidden:true\'\x3e\x3c/div\x3e\r\n\t\x3c/div\x3e\r\n\x3c/div\x3e',
"url:builder/plugins/map-config/CustomizeScale.html":'\x3cdiv\x3e\r\n  \x3cdiv class\x3d"scale-input-div" data-dojo-attach-point\x3d"scaleInputDiv"\x3e\r\n    \x3cdiv class\x3d"add-btn jimu-float-leading" data-dojo-attach-point\x3d"btnAdd" data-dojo-attach-event\x3d"onclick:_onBtnAddClicked"\x3e+\x3c/div\x3e\r\n  \x3c/div\x3e\r\n  \x3cdiv class\x3d"operations-div"\x3e\r\n    \x3cdiv class\x3d"jimu-float-leading operation-btn delete-btn" data-dojo-attach-point\x3d"btnDelete" data-dojo-attach-event\x3d"onclick:_onBtnDeleteClicked"\x3e\r\n      \x3cspan class\x3d"jimu-float-leading icon"\x3e\x3c/span\x3e\r\n      \x3cspan class\x3d"jimu-float-leading label"\x3e${nls.deleteTip}\x3c/span\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv class\x3d"jimu-float-leading operation-btn reset-btn" data-dojo-attach-event\x3d"onclick:_onBtnResetClicked"\x3e\r\n      \x3cspan class\x3d"jimu-float-leading icon"\x3e\x3c/span\x3e\r\n      \x3cspan class\x3d"jimu-float-leading label"\x3e${nls.resetTip}\x3c/span\x3e\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e\r\n  \x3cdiv class\x3d"list" data-dojo-attach-point\x3d"listNode" data-dojo-attach-event\x3d"onclick:_onLodListClicked"\x3e\x3c/div\x3e\r\n\x3c/div\x3e',
"url:builder/plugins/map-config/css/style.css":".map-config{margin: 0; padding: 0; overflow-y: hidden;}.map-config .hidden{display: none;}.map-config .map-info-section{position:absolute; left: 20px; right: 20px; top: 20px; bottom: 0;}.map-config .big-img{position:relative; width:100%; height:240px; -webkit-border-radius:5px; -moz-border-radius:5px; -o-border-radius:5px; -ms-border-radius:5px; border-radius:5px; background:#e5e5e5;}.map-config .add-map-tip{margin-top:13px; padding-left:6px; padding-right:6px; color:#999999; font-size:12px;}.map-config .map-selected-meta-data{position: relative; width: 100%; height: 133px;}.map-config .thumbnail-container{position:absolute; left: 0; right: auto; top: 0; width:190px; height:133px; cursor: pointer;}.jimu-rtl .map-config .thumbnail-container{left: auto; right: 0;}.map-config .thumbnail-container .thumbnail{width: 100%; height: 100%; background-color:#e5e5e5; border:1px solid #d2dae2; background-repeat:no-repeat; background-position:center center; background-size:cover;}.map-config .thumbnail-container .thumbnail.default-webmap{background-image: url(images/WebMapThumbnail.png);}.map-config .thumbnail-container .thumbnail.default-webscene{background-image: url(images/WebSceneThumbnail.jpeg);}.map-config .detail-info{position: absolute; left: 200px; top: 0; right: 0; height: 100%; color: #333333; font-size: 12px;}.has-mozilla .map-config .detail-info{font-size: 12px;}.jimu-rtl .map-config .detail-info{left: 0; right: 200px;}.map-config .web-item-icon{display: inline-block; width: 16px; height: 16px; background-position: center center; background-repeat: no-repeat;}.map-config .web-item-icon.webmap{background-image: url(images/WebMapIcon.png);}.map-config .web-item-icon.webscene{background-image: url(images/WebSceneIcon.png);}.map-config .owner-div{padding-left: 5px; color: #596679;}.jimu-rtl .map-config .owner-div{padding-left: 0; padding-right: 5px;}.map-config .owner-link-div{white-space: nowrap; overflow: hidden; text-overflow: ellipsis; margin-top: 5px;}.map-config .owner-link-div .owner-name{color: #24B5CC; text-decoration: none;}.map-config .owner-link-div .owner-name:hover{text-decoration: underline;}.map-config .last-modified{white-space: nowrap; overflow: hidden; text-overflow: ellipsis;}.map-config .webmap-details-div{margin-top:5px; white-space: nowrap; overflow: hidden; text-overflow: ellipsis;}html.ar .map-config .webmap-details-div{margin-top: 0;}.map-config .webmap-details{text-decoration: none; color: #24B5CC;}.map-config .webmap-details:hover{text-decoration: underline;}.map-config .map-info-content{position: absolute; width: 100%; left: 0; right: 0; top: 143px; bottom: 0; overflow: auto;}.map-config .snippet{max-height:115px; overflow: hidden; text-overflow: ellipsis; margin-top: 10px; font-size:12px; color: #666;}.map-config .map-options{display: none;}.map-config .map-options.enabled{display: block;}.map-config .extent-option{margin-top: 33px;}.map-config .option-title{font-size: 14px; color: #000; font-family: 'Avenir Medium';}.map-config .option-statement{font-size: 12px; color: #999; margin-top: 9px;}.map-config .init-ext-btn{margin-top:10px;}.map-config .restore-ext-btn{margin-top:10px;}.map-config .scale-option{margin-top: 38px;}.map-config .scale-btn{margin-top: 10px;}.map-config .refresh-interval{margin-top: 38px; margin-bottom: 30px;}.map-config .map-chooser{position: absolute; left: 0; bottom: 0; width: 100%;}.map-config .overlay-mask{position: fixed; width: 100%; height: 100%; left: 0; top: 0; z-index: 119;}.map-config .edit-options{box-shadow: 0 0 16px rgba(160,160,160,0.4); background-color: white; z-index: 120; width: 160px; position: absolute; left: 0; top: 36px;}.jimu-rtl .map-config .edit-options{left: auto; right: 0;}.map-config .edit-options \x3e .option-item{width: 100%; height: 36px; cursor: pointer; line-height: 36px; font-size: 14px; white-space:nowrap; overflow:hidden; text-align: left; text-overflow: ellipsis; background-color: #24B5CC; color: #ffffff; border-top: 2px solid #ffffff; padding: 0 10px;}.jimu-rtl .map-config .edit-options \x3e .option-item{text-align: right;}.map-config .edit-options \x3e .option-item:hover{background-color: #0090A7;}.map-config .choose-map-btn{width: 160px; height: 36px; overflow:hidden; text-align: center; background-color: #24B5CC; cursor: pointer;}.map-config .choose-map-btn .label{display: inline-block; line-height: 36px; text-overflow: ellipsis; white-space:nowrap; font-size: 14px; color: #ffffff; max-width: 140px; padding: 0 5px; overflow: hidden;}.map-config .choose-map-btn .label:hover{background-color: #0090A7;}.map-config .choose-map-btn .options{display: inline-block; height: 36px; background: url('images/v-White.png') no-repeat center; width: 20px; border-left: 1px solid rgba(255, 255, 255, 0.3);}.map-config .choose-map-btn .options:hover{background-color: #0090A7;}.jimu-rtl .map-config .choose-map-btn .options{border-left: none; border-right: 1px solid rgba(255, 255, 255, 0.3);}.map-config .jimu-btn{padding: 0 15px; font-size: 14px; line-height: 34px; text-align: center; max-width: 100%;}.map-config .jimu-btn.jimu-btn-vacation:hover{background-color: #0090A7; color: white; border-color: #0090A7;}.map-config .jimu-btn.jimu-btn-vacation.jimu-state-disabled{background: #E0E0E0; color: #666;}.map-config .map-info-title{margin-top:10px;}.map-config .option-title.map-info-title{font-size: 12px;}.map-config .set-extent-tip{color:#999999; font-size:12px;}.map-config .description{position:absolute; top:420px; bottom:0; width:100%; overflow:auto; color:#999999; font-size:12px;}.map-table{position:absolute; width: 100%; top:0; bottom: 0; height: auto;}.map-table .maps-section{position: absolute; width: 100%; top: 0; bottom: 0;}.map-table .maps-table-div{width: 100%; height: 100%; overflow-x:hidden; overflow-y:auto;}.map-table .maps-table{width: 100%; table-layout: fixed; border-collapse: collapse;}.map-table .maps-table td{vertical-align:top;}.map-table .map-item-div{width:176px; padding:3px;}.map-table .map-item-div .map-item-bg{position:relative; width:100%; height:118px; text-align:center; color:#999999; font-size:13px;}.map-table .map-item-div .map-item-bg .map-item-thumbnail{position:absolute; left:0; top:0; width:100%; height:100%; background-repeat:no-repeat; background-position:center center; border:1px solid #d2dae2; background-size:cover;}.jimu-rtl .map-table .map-item-div .map-item-bg .map-item-thumbnail{left: auto; right: 0;}.map-table .map-item-div .map-item-bg.selected .map-item-thumbnail{border:3px solid #24B5CC; -webkit-box-sizing:content-box; -moz-box-sizing:content-box; -ms-box-sizing:content-box; -o-box-sizing:content-box; box-sizing:content-box;}.map-table .map-item-div .map-item-bg .map-item-detail-icon{display: none; position:absolute; right:7px; bottom:7px; width:15px; height:15px; background-color:rgba(0, 0, 0, 0.4); background-repeat:no-repeat; background-position:center center; background-image:url(images/info.png); -webkit-border-radius:3px; -moz-border-radius:3px; -o-border-radius:3px; -ms-border-radius:3px; border-radius:3px; cursor:pointer;}.jimu-rtl .map-table .map-item-div .map-item-bg .map-item-detail-icon{right: auto; left: 7px;}.map-table .map-item-div .map-item-bg:hover .map-item-detail-icon{display: block;}.map-table .map-item-div .map-item-title{display:inline-block; width:100%; max-height: 31px; text-align:center; color:#596679; font-size:13px; margin-top: 10px; overflow: hidden; word-wrap: break-word;}.map-table .search-none-tip-section .search-none-icon{margin-left:5px;}.jimu-rtl .map-table .search-none-tip-section .search-none-icon{margin-left: 0; margin-right: 5px;}.map-table .search-none-tip-section .search-none-tip{font-size:13px; color:#ff0000; margin-left:10px;}.jimu-rtl .map-table .search-none-tip-section .search-none-tip{margin-left: 0; margin-right: 10px;}.map-selector .hidden{display: none;}.map-selector .jimu-tab3{height: 100%;}.map-selector .jimu-tab3\x3e.container-node{position:absolute; width:100%; left:0; right:0; top:60px; bottom:0;}.map-selector .jimu-tab3 .tab-item-div{height: 48px; line-height: 48px;}.map-selector .tab-content{position: relative;}.map-selector .tab-content .tab-content-main{position: absolute; width: 100%; top:0; bottom:0;}.map-selector .search-section{position:absolute; width:100%; height:45px; top: 15px; font-size: 12px;}.map-selector .search-section .jimu-search{width: 81%;}.map-selector .search-section .dijitSelect{box-sizing: border-box;}.map-selector .refresh-icon{width: 16px; height: 16px; cursor: pointer; background: url(images/reset1.png) center center no-repeat; margin-top: 12px; margin-left: 7px;}.jimu-rtl .map-selector .refresh-icon{margin-left: auto; margin-right: 7px;}.map-selector .search-section .restrict-select-width{position: relative; width: 146px; top: 5px;}.map-selector .public-search-radios{position:absolute; width:100%; top:75px; height: 20px; line-height:1em; font-size: 14px;}.map-selector .public-search-radios \x3e *{vertical-align: middle; line-height: 18px;}.map-selector .public-search-radios span{display: inline-block;}.map-selector .public-search-radios .portal-public-radio{margin-right: 10px;}.jimu-rtl .map-selector .public-search-radios .portal-public-radio{margin-right: 0; margin-left: 10px;}.map-selector .public-search-radios .portal-name{margin-right: 28px;}.jimu-rtl .map-selector .public-search-radios .portal-name{margin-right: 0; margin-left: 28px;}.map-selector .public-search-radios .online-public-radio{margin-right: 10px;}.jimu-rtl .map-selector .public-search-radios .online-public-radio{margin-right: 0; margin-left: 10px;}.map-selector .public-map-section{position:absolute; width:100%; top:100px; bottom:0;}.map-selector .signin-section{position: absolute; top:75px; width:100%;}.map-selector .signin-section .signin-tip{width:100%; color:#d6d6d6; font-size:13px;}.map-selector .groups-section{font-size: 14px;}.map-selector .groups-section .groups-select{height: 30px; padding: 0 5px;}.mapconfig-customize-scale{width: 100%; height: 100%;}.mapconfig-customize-scale .scale-input-div{position:relative; height:30px;}.mapconfig-customize-scale .add-btn{width: 30px; height: 100%; line-height: 30px; color: #ffffff; font-size: 28px; text-align: center; vertical-align: center; cursor: default; background-color: #d2dae2;}.claro .mapconfig-customize-scale .scale-input-div .dijitNumberTextBox input.dijitInputInner{text-align: left;}.jimu-rtl .claro .mapconfig-customize-scale .scale-input-div .dijitNumberTextBox input.dijitInputInner{text-align: right;}.mapconfig-customize-scale .scale-input-div:hover .add-btn{background-color: #24B5CC;}.mapconfig-customize-scale .operations-div{height: 24px; margin-top: 13px; margin-bottom: 2px;}.mapconfig-customize-scale .operation-btn{display: inline-block; overflow: hidden; height: 24px; cursor: default; font-size: 13px;}.mapconfig-customize-scale .operation-btn .icon{width: 14px; height: 100%; background-repeat: no-repeat; background-position: center center;}.mapconfig-customize-scale .delete-btn{color: #a0acbf; cursor: default;}.mapconfig-customize-scale .delete-btn.enabled-operation{color: #518dca; cursor: pointer;}.mapconfig-customize-scale .delete-btn .icon{background-image: url(images/delete1.png);}.mapconfig-customize-scale .delete-btn.enabled-operation .icon{background-image: url(images/delete2.png);}.mapconfig-customize-scale .reset-btn .icon{background-image: url(images/reset2.png);}.mapconfig-customize-scale .reset-btn{margin-left: 15px; color: #24B5CC; cursor: pointer;}.jimu-rtl .mapconfig-customize-scale .reset-btn{margin-left: 0; margin-right: 15px;}.mapconfig-customize-scale .operation-btn .label{height: 100%; line-height: 24px; vertical-align: middle; margin-left: 7px;}.jimu-rtl .mapconfig-customize-scale .operation-btn .label{margin-left: 0; margin-right: 7px;}.mapconfig-customize-scale .list{width: 100%; height: 395px; border: 1px solid #dfe4ea; background-color: #fafafc; color: #7989a0; font-size: 14px; overflow: auto;}.mapconfig-customize-scale .list .lod-item{height: 30px; line-height: 30px; padding-left: 10px; cursor: default; border-bottom: 1px solid #f2f4f7;}.mapconfig-customize-scale .list .lod-item.selected{background-color: #e3ecf2; color: #596670;}.embed-mapviewer-content {width: 100%; height: 100%; position: relative;}.embed-mapviewer-content .load-container {float: left; position: absolute; overflow: hidden; bottom: 60px; right: 20px;}.embed-mapviewer-content .load-container .loader {font-size: 20px; width: 1.5em; height: 1.5em; border-radius: 50%; position: relative; text-indent: -9999em;}",
"url:builder/plugins/popup-actions/popup-agoltemplate/css/style.css":".plugin-app-actions-template-popup .template-popup-content {height: 100%;}.plugin-app-actions-template-popup .template-popup-content .config-part {width: 70%; height: 100%;}.plugin-app-actions-template-popup .template-popup-content .privew-part-box {height: 100%; width: 30%; padding: 10px 0 10px 0;}.plugin-app-actions-template-popup .template-popup-content .privew-part-inset-box {height: 100%; width: 100%; box-shadow: 0px 0px 8px rgba(0,0,0,0.4) inset; overflow-y: auto; overflow-x: hidden; -ms-overflow-y: auto; -ms-overflow-x: hidden;}.plugin-app-actions-template-popup .template-popup-content .privew-part {width: 90%; height: 100%; min-width: 275px; max-width: 500px; margin: 0 auto;}.plugin-app-actions-template-popup-for-xt .button-container {overflow: visible;}.plugin-app-actions-template-popup-for-xt .export-btn {position: relative; overflow: visible;}.plugin-app-actions-template-popup-for-xt .export-draw-box {position: absolute; height: 60px; background-color: #cccccc; top: -61px; left: 0; cursor: default; background: #fff; box-shadow: 0 0 4px #646464; color: #7989a0; text-align: left; max-width: 270px; overflow: hidden;}.jimu-rtl .plugin-app-actions-template-popup-for-xt .export-draw-box {right: 0; left: auto;}.plugin-app-actions-template-popup-for-xt .export-draw-box.export-draw-box-hiden{display: none;}.plugin-app-actions-template-popup-for-xt .export-draw-box .export-draw-box-btn{cursor: pointer; height: 30px; padding-left: 20px; padding-right: 20px;}.plugin-app-actions-template-popup-for-xt .export-draw-box .export-draw-box-btn:hover{background: #edf2f5; color: #15a4fa;}.plugin-app-actions-template-popup-for-xt .export-draw-box .export-draw-box-btn.export-draw-box-btn-disable{color: #d2dae2;}",
"url:jimu/dijit/templates/ShareOptions.html":'\x3cdiv class\x3d"shareOptions"\x3e\r\n  \x3cdiv class\x3d"shareOptionsWrapper"\x3e\r\n    \x3cdiv class\x3d"subTitle"\x3e${nls.shareMap}\x3c/div\x3e\r\n    \x3cdiv class\x3d"tips"\x3e${nls.shareMapTips}\x3c/div\x3e\r\n    \x3cdiv id\x3d"share-everyone-check_div" class\x3d"shareOptionItems" data-dojo-attach-point\x3d"share-everyone-check_div"\x3e\r\n      \x3cinput id\x3d"share-everyone-check" data-dojo-attach-point\x3d"shareEveryoneCheck" data-dojo-type\x3d"dijit/form/CheckBox" type\x3d"checkbox"/\x3e\r\n      \x3clabel id\x3d"share-everyone-check-label" for\x3d"share-everyone-check" class\x3d"labels"\x3e${nls.everyone}\x3c/label\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv id\x3d"share-account-check_div" class\x3d"shareOptionItems displaynone" data-dojo-attach-point\x3d"share-account-check_div"\x3e\r\n      \x3cinput id\x3d"share-account-check" data-dojo-attach-point\x3d"share-account-check" data-dojo-type\x3d"dijit/form/CheckBox" type\x3d"checkbox"/\x3e\r\n      \x3clabel id\x3d"share-account-check-label" for\x3d"share-account-check" class\x3d"labels"\x3e\x3c/label\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv id\x3d"share-groups-div" class\x3d"shareOptionItems displaynone" data-dojo-attach-point\x3d"share-groups-div"\x3e\r\n      \x3cinput id\x3d"share-groups-check" data-dojo-attach-point\x3d"shareGroupsCheck" data-dojo-type\x3d"dijit/form/CheckBox" type\x3d"checkbox"/\x3e\r\n      \x3clabel id\x3d"share-groups-check-label" for\x3d"share-groups-check" class\x3d"labels"\x3e${nls.theseGroups}\x3c/label\x3e\r\n      \x3cdiv class\x3d"share-groups-wrapper"\x3e\r\n        \x3cdiv data-dojo-type\x3d"dijit/layout/BorderContainer" gutters\x3d"false" design\x3d"headline" class\x3d"borderContainer"\x3e\r\n          \x3cdiv id\x3d"share-groups-list" class\x3d"share-groups-list" dojotype\x3d"dijit.layout.ContentPane" region\x3d"middle" splitter\x3d"false"\x3e\x3c/div\x3e\r\n        \x3c/div\x3e\r\n      \x3c/div\x3e\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e\r\n\x3c/div\x3e\r\n',
"url:jimu/dijit/templates/ShareLink.html":'\x3cdiv class\x3d"shareLink"\x3e\r\n  \x3cdiv class\x3d"shareLinkOptionsWrapper displaynone"\x3e\r\n    \x3cdiv data-dojo-attach-point\x3d"backBtn" class\x3d"backBtn"\x3e\x3c/div\x3e\r\n    \x3cdiv class\x3d"linkOptionsTitle"\x3e${nls.linkOptions}\x3c/div\x3e\r\n    \x3cdiv class\x3d"subTitle"\x3e${nls.linkOptionsUrlParameters}\x3c/div\x3e\r\n    \x3cform data-id\x3d"shareOptionsRadios" data-dojo-attach-point\x3d"shareOptionsRadios"\x3e\r\n      \x3cfieldset\x3e\r\n        \x3cdiv class\x3d"optionsRow"\x3e\r\n          \x3cinput data-dojo-attach-point\x3d"currentMapExtent" class\x3d"shareRadios jimu-float-leading jimu-radio-btn" type\x3d"radio" name\x3d"radios" data-id\x3d"currentMapExtent" data-dojo-type\x3d"dijit.form.RadioButton" data-dojo-props\x3d\'checked:true\' checked\x3e\r\n          \x3cdiv class\x3d"labels" data-forid\x3d"currentMapExtent"\x3e${nls.currentMapExtent}\x3c/div\x3e\r\n        \x3c/div\x3e\r\n        \x3cdiv class\x3d"optionsRow" data-dojo-attach-point\x3d"chooseCenterWithLevelRow"\x3e\r\n          \x3cinput data-dojo-attach-point\x3d"chooseCenterWithLevel" class\x3d"shareRadios jimu-float-leading jimu-radio-btn" type\x3d"radio" name\x3d"radios" data-id\x3d"chooseCenterWithLevel" data-dojo-type\x3d"dijit.form.RadioButton"\x3e\r\n          \x3cdiv class\x3d"labels" data-forid\x3d"chooseCenterWithLevel"\x3e${nls.chooseCenterWithLevel}\x3c/div\x3e\r\n          \x3cdiv class\x3d"optionsMore chooseCenterWithLevel_optionsMore"\x3e\r\n            \x3cdiv data-dojo-attach-point\x3d"chooseCenterWithLevel_marker" class\x3d"markers"\x3e\x3c/div\x3e\r\n            \x3cselect data-dojo-attach-point\x3d"chooseCenterWithLevel_levels" class\x3d"shareSelects" style\x3d"display: none !important;" data-dojo-type\x3d"dijit/form/Select"\x3e\x3c/select\x3e\r\n          \x3c/div\x3e\r\n        \x3c/div\x3e\r\n        \x3cdiv class\x3d"optionsRow"\x3e\r\n          \x3cinput data-dojo-attach-point\x3d"chooseCenterWithScale" class\x3d"shareRadios jimu-float-leading jimu-radio-btn" type\x3d"radio" name\x3d"radios" data-id\x3d"chooseCenterWithScale" data-dojo-type\x3d"dijit.form.RadioButton"\x3e\r\n          \x3cdiv class\x3d"labels"\x3e${nls.chooseCenterWithScale}\x3c/div\x3e\r\n          \x3cdiv class\x3d"optionsMore chooseCenterWithScale_optionsMore"\x3e\r\n            \x3cdiv data-dojo-attach-point\x3d"chooseCenterWithScale_marker" class\x3d"markers"\x3e\x3c/div\x3e\r\n            \x3cselect data-dojo-attach-point\x3d"chooseCenterWithScale_scales" class\x3d"shareSelects" style\x3d"display: none !important;" data-dojo-type\x3d"dijit/form/Select"\x3e\x3c/select\x3e\r\n          \x3c/div\x3e\r\n        \x3c/div\x3e\r\n\r\n        \x3cdiv class\x3d"optionsRow" data-dojo-attach-point\x3d"findLocationRow"\x3e\r\n          \x3cinput data-dojo-attach-point\x3d"findLocation" class\x3d"shareRadios jimu-float-leading jimu-radio-btn" type\x3d"radio" name\x3d"radios" data-id\x3d"findLocation" data-dojo-type\x3d"dijit.form.RadioButton"\x3e\r\n          \x3cdiv class\x3d"labels"\x3e${nls.findLocation}\x3c/div\x3e\r\n          \x3cdiv class\x3d"optionsMore findLocation_optionsMore"\x3e\r\n            \x3cdiv class\x3d"moreOptions"\x3e\r\n              \x3cinput data-dojo-attach-point\x3d"findLocation_input" data-dojo-type\x3d"dijit.form.TextBox" placeholder\x3d"${nls.findLocation_inputPlaceholder}"\x3e\r\n            \x3c/div\x3e\r\n          \x3c/div\x3e\r\n        \x3c/div\x3e\r\n        \x3cdiv class\x3d"optionsRow"\x3e\r\n          \x3cinput data-dojo-attach-point\x3d"queryFeature" class\x3d"shareRadios jimu-float-leading jimu-radio-btn" type\x3d"radio" name\x3d"radios" data-id\x3d"queryFeature" data-dojo-type\x3d"dijit.form.RadioButton"\x3e\r\n          \x3cdiv class\x3d"labels"\x3e${nls.queryFeature}\x3c/div\x3e\r\n          \x3cdiv class\x3d"optionsMore queryFeature_optionsMore"\x3e\r\n            \x3cdiv class\x3d"moreOptions"\x3e\r\n              \x3cdiv data-dojo-attach-point\x3d"queryFeature_layer" name\x3d"queryFeature_layer" class\x3d"queryFeature_layer"\x3e\x3c/div\x3e\r\n              \x3cselect data-dojo-attach-point\x3d"queryFeature_field" name\x3d"queryFeature_field" data-dojo-type\x3d"dijit/form/Select"\x3e\x3c/select\x3e\r\n              \x3cselect data-dojo-attach-point\x3d"queryFeature_value" name\x3d"queryFeature_value" data-dojo-type\x3d"dijit/form/Select"\x3e\x3c/select\x3e\r\n            \x3c/div\x3e\r\n          \x3c/div\x3e\r\n        \x3c/div\x3e\r\n        \x3cdiv class\x3d"optionsRow"\x3e\r\n          \x3cinput data-dojo-attach-point\x3d"addMarker" class\x3d"shareRadios jimu-float-leading jimu-radio-btn" type\x3d"radio" name\x3d"radios" data-id\x3d"addMarker" data-dojo-type\x3d"dijit.form.RadioButton"\x3e\r\n          \x3cdiv class\x3d"labels"\x3e${nls.addMarker}\x3c/div\x3e\r\n          \x3cdiv class\x3d"optionsMore addMarker_optionsMore"\x3e\r\n            \x3cdiv data-dojo-attach-point\x3d"addMarker_marker" class\x3d"markers"\x3e\x3c/div\x3e\r\n            \x3cdiv class\x3d"moreOptions addMarker_moreOptions"\x3e\r\n              \x3cdiv class\x3d"moreOptionsRow"\x3e\r\n                \x3clabel\x3e${nls.WKID}\x3c/label\x3e\r\n                \x3cinput data-dojo-attach-point\x3d"addMarker_spatialReference" name\x3d"spatialReference" data-dojo-type\x3d"dijit.form.TextBox"\x3e\r\n              \x3c/div\x3e\r\n              \x3cdiv class\x3d"moreOptionsRow"\x3e\r\n                \x3clabel\x3e${nls.popupTitle}\x3c/label\x3e\r\n                \x3cinput data-dojo-attach-point\x3d"addMarker_title" data-dojo-type\x3d"dijit.form.TextBox" placeholder\x3d"${nls.addMarker_titlePlaceholder}"\x3e\r\n              \x3c/div\x3e\r\n              \x3cdiv class\x3d"moreOptionsRow"\x3e\r\n                \x3clabel\x3e${nls.symbol}\x3c/label\x3e\r\n                \x3cinput data-dojo-attach-point\x3d"addMarker_symbolURL" data-dojo-type\x3d"dijit.form.TextBox" placeholder\x3d"${nls.addMarker_symbolURL}"\x3e\r\n              \x3c/div\x3e\r\n              \x3cdiv class\x3d"moreOptionsRow"\x3e\r\n                \x3clabel\x3e${nls.label}\x3c/label\x3e\r\n                \x3cinput data-dojo-attach-point\x3d"addMarker_label" data-dojo-type\x3d"dijit.form.TextBox" placeholder\x3d"${nls.addMarker_label}"\x3e\r\n              \x3c/div\x3e\r\n              \x3cdiv class\x3d"moreOptionsRow displaynone"\x3e\r\n                \x3clabel\x3e${nls.zoomLevel}\x3c/label\x3e\r\n                \x3cdiv class\x3d"table-for-select"\x3e\r\n                  \x3cselect data-dojo-attach-point\x3d"addMarker_level" name\x3d"addMarker_level" data-dojo-type\x3d"dijit/form/Select"\x3e\x3c/select\x3e\r\n                \x3c/div\x3e\r\n              \x3c/div\x3e\r\n            \x3c/div\x3e\r\n          \x3c/div\x3e\r\n        \x3c/div\x3e\r\n      \x3c/fieldset\x3e\r\n    \x3c/form\x3e\r\n\r\n    \x3cfieldset\x3e\r\n      \x3cdiv class\x3d"optionsRow shareClearFix"\x3e\r\n        \x3cinput data-id\x3d"share-options-overwirteMobileLayout" data-dojo-attach-point\x3d"overwirteMobileLayout" class\x3d"shareCheckBoxes jimu-float-leading" data-dojo-type\x3d"dijit.form.CheckBox" type\x3d"checkbox"\x3e\r\n        \x3cdiv class\x3d"labels"\x3e${nls.overwirteMobileLayout}\x3c/div\x3e\r\n        \x3cdiv class\x3d"optionsMore share-options-overwirteMobileLayout_optionsMore"\x3e\r\n          \x3cinput type\x3d"text" data-dojo-type\x3d"dijit/form/NumberTextBox" required\x3d"true"\r\n                 data-dojo-attach-point\x3d"mobileLayout" data-dojo-props\x3d\'style:{width:"100px"}, constraints:{min:300}\'/\x3e\r\n        \x3c/div\x3e\r\n      \x3c/div\x3e\r\n      \x3cdiv class\x3d"optionsRow shareClearFix"\x3e\r\n        \x3cinput data-id\x3d"share-options-language" data-dojo-attach-point\x3d"setlanguage" class\x3d"shareCheckBoxes jimu-float-leading" data-dojo-type\x3d"dijit.form.CheckBox" type\x3d"checkbox"\x3e\r\n        \x3cdiv class\x3d"labels"\x3e${nls.language}\x3c/div\x3e\r\n        \x3cdiv class\x3d"optionsMore share-options-language_optionsMore"\x3e\r\n          \x3cselect data-dojo-attach-point\x3d"setlanguage_languages" class\x3d"shareSelects" style\x3d"display:inline-block;" data-dojo-type\x3d"dijit/form/Select"\x3e\x3c/select\x3e\r\n        \x3c/div\x3e\r\n      \x3c/div\x3e\r\n      \x3cdiv class\x3d"optionsRow shareClearFix"\x3e\r\n        \x3cinput data-id\x3d"share-options-auth" data-dojo-attach-point\x3d"auth" class\x3d"shareCheckBoxes jimu-float-leading" data-dojo-type\x3d"dijit.form.CheckBox" type\x3d"checkbox"\x3e\r\n        \x3cdiv class\x3d"labels"\x3e${nls.auth}\x3c/div\x3e\r\n        \x3cdiv  class\x3d"optionsMore share-options-auth_optionsMore"\x3e\r\n          \x3cinput data-dojo-attach-point\x3d"authtoken" data-dojo-type\x3d"dijit/form/ValidationTextBox" data-dojo-props\x3d\'required:true\'/\x3e\r\n        \x3c/div\x3e\r\n      \x3c/div\x3e\r\n      \x3cdiv class\x3d"optionsRow shareClearFix"\x3e\r\n        \x3cdiv class\x3d"subTitle"\x3e${nls.linkPreview}\x3c/div\x3e\r\n        \x3cdiv data-dojo-attach-point\x3d"preview" class\x3d"preview inputsText" data-dojo-type\x3d"dijit/form/SimpleTextarea" data-dojo-props\x3d\'required:true,readOnly:true\'\x3e\x3c/div\x3e\r\n      \x3c/div\x3e\r\n    \x3c/fieldset\x3e\r\n  \x3c/div\x3e\r\n\r\n  \x3cdiv class\x3d"shareUrlsWrapper"\x3e\r\n    \x3cdiv data-dojo-attach-point\x3d"Text"\x3e\x3c/div\x3e\r\n    \x3cdiv class\x3d"linkShare" data-dojo-attach-point\x3d"LinkShareContainer"\x3e\r\n      \x3cdiv data-dojo-attach-point\x3d"LinkText" class\x3d"subTitle linkToApp"\x3e${nls.shareLinkText}\x3c/div\x3e\r\n      \x3cinput data-dojo-attach-point\x3d"_linkUrlTextBox" class\x3d"shareLinkUrl inputsText" data-dojo-type\x3d"dijit/form/TextBox" data-dojo-props\x3d\'required:true,readOnly:true\'/\x3e\r\n      \x3cdiv class\x3d"shareClearFix"\x3e\r\n        \x3cspan class\x3d"optionsText jimu-float-leading" data-dojo-attach-point\x3d"linkOptions"\x3e${nls.linkOptions}\x3c/span\x3e\r\n        \x3cdiv class\x3d"shareLinkIcons jimu-float-trailing" data-dojo-attach-point\x3d"socialNetworkLinks"\x3e\r\n          \x3cdiv class\x3d"socialNetworkIcons email" data-dojo-attach-event\x3d"click:_toEmail" data-dojo-attach-point\x3d"emailShare" title\x3d"${nls.email}"\x3e\x3c/div\x3e\r\n          \x3cdiv class\x3d"socialNetworkIcons facebook" data-dojo-attach-event\x3d"click:_toFacebook" data-dojo-attach-point\x3d"FacebookShare" title\x3d"${nls.facebook}"\x3e\x3c/div\x3e\r\n          \x3cdiv class\x3d"socialNetworkIcons twitter" data-dojo-attach-event\x3d"click:_toTwitter" data-dojo-attach-point\x3d"TwitterShare" title\x3d"${nls.twitter}"\x3e\x3c/div\x3e\r\n          \x3cdiv class\x3d"socialNetworkIcons googlePlus" data-dojo-attach-point\x3d"googlePlusShare" title\x3d"${nls.googlePlus}"\x3e\x3c/div\x3e\r\n        \x3c/div\x3e\r\n      \x3c/div\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv class\x3d"embedShare" data-dojo-attach-point\x3d"EmbedShareContainer"\x3e\r\n      \x3cdiv data-dojo-attach-point\x3d"embedText" class\x3d"subTitle"\x3e${nls.embed}\x3c/div\x3e\r\n      \x3cinput data-dojo-attach-point\x3d"_embedCodeTextArea" class\x3d"shareEmbedCode inputsText" data-dojo-type\x3d"dijit/form/SimpleTextarea" data-dojo-props\x3d\'required:true,readOnly:true\'/\x3e\r\n      \x3cdiv class\x3d"moreOptions" data-dojo-attach-event\x3d"click:_moreOptionsExpandCollapse"\x3e\r\n        \x3cdiv class\x3d"moreOptionsIcon" data-dojo-attach-point\x3d"MoreOptionsIcon"\x3e\x3c/div\x3e\r\n        \x3cdiv class\x3d"optionsText"\x3e${nls.more}\x3c/div\x3e\r\n      \x3c/div\x3e\r\n      \x3cdiv data-dojo-attach-point\x3d"MoreOptionsContainer" class\x3d"moreOptionsContainer inputsText displaynone"\x3e\r\n        \x3cdiv class\x3d"sizeSelect" data-dojo-attach-point\x3d"SizeSelect"\x3e\x3c/div\x3e\r\n        \x3cdiv class\x3d"customSize disable" data-dojo-attach-point\x3d"CustomSizeContainer"\x3e\r\n          \x3cdiv class\x3d"timesConnector"\x3eX\x3c/div\x3e\r\n        \x3c/div\x3e\r\n      \x3c/div\x3e\r\n    \x3c/div\x3e\r\n\r\n    \x3cdiv class\x3d"shareTips" data-dojo-attach-point\x3d"shareTips"\x3e\r\n      \x3c!--\x3cdiv class\x3d"infoIcon"\x3e\x3c/div\x3e--\x3e\r\n      \x3cdiv data-dojo-attach-point\x3d"shareTipsText" class\x3d"shareTipsText"\x3e${nls.shareToWebTips}\x3c/div\x3e\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e\r\n\x3c/div\x3e\r\n',
"url:jimu/dijit/templates/LayerChooserFromMapWithDropbox.html":'\x3cdiv\x3e\r\n  \x3ctable data-dojo-attach-event\x3d"onclick: _onDropDownClick"\x3e\r\n    \x3ccolgroup\x3e\r\n      \x3ccol width\x3d"10px"\x3e\x3c/col\x3e\r\n      \x3ccol width\x3d"auto"\x3e\x3c/col\x3e\r\n      \x3ccol width\x3d"30px"\x3e\x3c/col\x3e\r\n    \x3c/colgroup\x3e\r\n    \x3ctbody\x3e\r\n      \x3ctr\x3e\r\n        \x3ctd\x3e\x3c/td\x3e\r\n        \x3ctd\x3e\r\n          \x3cdiv class\x3d"layer-name jimu-ellipsis" data-dojo-attach-point\x3d"layerNameNode"\x3e\x3c/div\x3e\r\n        \x3c/td\x3e\r\n        \x3ctd\x3e\r\n          \x3cdiv class\x3d"drop-select jimu-float-trailing" data-dojo-attach-point\x3d"dropArrowNode"\x3e\r\n            \x3cdiv class\x3d"jimu-icon jimu-icon-down-arrow-8"\x3e\x3c/div\x3e\r\n        \x3c/div\x3e\r\n        \x3c/td\x3e\r\n      \x3c/tr\x3e\r\n    \x3c/tbody\x3e\r\n  \x3c/table\x3e\r\n\x3c/div\x3e\r\n',
"url:builder/plugins/startup/Plugin.html":'\x3cdiv\x3e\r\n  \x3cdiv class\x3d"header" data-dojo-attach-point\x3d"headerNode"\x3e\x3c/div\x3e\r\n  \x3cdiv data-dojo-attach-point\x3d"viewStackNode"\x3e\x3c/div\x3e\r\n\x3c/div\x3e\r\n',"url:builder/plugins/startup/css/style.css":".plugin-startup\x3e.jimu-viewstack{position: absolute; top: 61px; bottom: 0; left: 0; right: 0; height: auto; overflow: hidden; background-color: #f3f3f3;}.plugin-startup .image-404{position: absolute; top: 50%; margin-top: -80px; left: 50%; margin-left: -238px;}",
"url:builder/plugins/theme-config/Plugin.html":'\x3cdiv\x3e\r\n  \x3cdiv class\x3d"theme-list" data-dojo-attach-point\x3d"themeList"\x3e\r\n    \x3cdiv class\x3d"theme-title"\x3e\x3c/div\x3e\r\n  \x3c/div\x3e\r\n  \x3cdiv class\x3d"separate-line"\x3e\x3c/div\x3e\r\n  \x3cdiv class\x3d"style-list" data-dojo-attach-point\x3d"styleList"\x3e\r\n    \x3c!--div class\x3d"style-text"\x3e${nls.styleTitle}\x3c/div--\x3e\r\n  \x3c/div\x3e\r\n  \x3cdiv class\x3d"layout-list" data-dojo-attach-point\x3d"layoutList"\x3e\x3c/div\x3e\r\n  \x3cdiv class\x3d"theme-loading-cover" style\x3d"display:none" data-dojo-attach-point\x3d"themeCoverNode"\x3e\x3c/div\x3e\r\n\x3c/div\x3e\r\n',
"url:jimu/dijit/templates/ColorRecords.html":'\x3cdiv\x3e\r\n\t\x3cdiv class\x3d"dijitInline dijitColorPalette" role\x3d"grid"\x3e\r\n\t\t\x3ctable data-dojo-attach-point\x3d"paletteTableNode" class\x3d"dijitPaletteTable" cellspacing\x3d"0" cellpadding\x3d"0" role\x3d"presentation"\x3e\r\n\t\t\t\x3ctbody data-dojo-attach-point\x3d"gridNode"\x3e\r\n\t\t\t\t\x3ctr tabindex\x3d"0" role\x3d"row" data-dojo-attach-point\x3d"container"\x3e\r\n\r\n\t\t\t\t\x3c/tr\x3e\r\n\t\t\t\x3c/tbody\x3e\r\n\t\t\x3c/table\x3e\r\n\t\x3c/div\x3e\r\n\x3c/div\x3e',
"url:builder/plugins/theme-config/css/style.css":".plugin-theme-config{overflow: auto; position: relative;}.plugin-theme-config .section {}.plugin-theme-config .theme-section{}.plugin-theme-config .theme-list{overflow: auto; display: none; padding-left: 30px; padding-right: 14px; border: 0px solid;}.jimu-rtl .plugin-theme-config .theme-list{padding-left: 14px; padding-right: 30px;}.plugin-theme-config .theme-title{margin-top: 20px; margin-left: 18px; font-size: 14px; color: #015574;}.plugin-theme-config .theme-catalog{border: 0px solid; display: none; overflow: hidden;}.plugin-theme-config .catalog-theme-content-div{border: 0px solid; width: 33.333%; height: 114px; overflow: hidden;}.plugin-theme-config .catalog-theme-div{position: relative; width: 106px; height: 78px; cursor: pointer; border: 2px solid #ffffff;}.plugin-theme-config .catalog-theme-div:hover{border-color: #24B5CC;}.plugin-theme-config .catalog-theme-selected {border-color: #24B5CC;}.plugin-theme-config .catalog-theme-img-box-div{width: 102px; height: 74px; border: 1px solid #ddd;}.plugin-theme-config .catalog-theme-img-box-div:hover{border: 1px solid #ffffff;}.plugin-theme-config .catalog-theme-img-box-div.selected{border: 1px solid #ffffff;}.plugin-theme-config .catalog-theme-img-div{text-align: center; width: 84px; height: 56px; display: block; margin-top: 8px; margin-left: auto; margin-right: auto;}.plugin-theme-config .catalog-theme-img{text-align: center; width: 84px; height: 56px;}.plugin-theme-config .catalog-theme-name-div{border: 0px solid; width: 106px; overflow: hidden; text-align: center; padding-top: 5px; font-size: 12px; color: #333; cursor: default; text-overflow: ellipsis; line-height: 17px;}.plugin-theme-config .theme-cl-selected-div{position: absolute; left: 21px; top: 21px; width: 40px; height: 34px; border: 0px solid; text-align: center; display: none; background-color: rgba(0, 0, 0, 0.65);}.plugin-theme-config .theme-cl-selected-img{margin-top: 10px;}.plugin-theme-config .separate-line{margin-left: 10px; margin-right: 10px; border-top: 1px solid #ddd;}.plugin-theme-config .style-list{border: 0px solid; padding-right: 30px; padding-left: 30px;}.plugin-theme-config .style-section{border: 0px solid; overflow: auto;}.plugin-theme-config .style-text{margin-top: 20px; margin-bottom: 15px; font-size: 14px; font-family: \"Avenir Medium\"}.plugin-theme-config .style-color-content{}.plugin-theme-config .style-div{position: relative; width: 25%; height: 30px; margin-bottom: 12px; cursor: pointer; padding: 4px; background-clip: content-box; border: 2px solid rgba(0,0,0,0);}.plugin-theme-config .style-div:hover{border: 2px solid #24B5CC;}.plugin-theme-config .style-image{}.plugin-theme-config .style-selected{border: 2px solid #24B5CC;}.plugin-theme-config .style-selected-div{position: absolute; top: 0px; left: 0px; width: 100%; height: 100%; background-color: rgba(0, 0, 0, 0.65); text-align: center; display: none;}.plugin-theme-config .layout-list{border: 0px solid;}.plugin-theme-config .layout-section{border: 0px solid; overflow: hidden; margin-top: 28px; padding-left: 30px; position: relative;}.plugin-theme-config .layout-section .layout-action{position: absolute; top: 0; right: 30px; font-size: 12px; cursor: pointer; color: #666;}.plugin-theme-config .layout-section .layout-action span{display: inline-block; vertical-align: middle; margin-left: 8px;}.jimu-rtl .plugin-theme-config .layout-section .layout-action{left: 30px; right: auto;}.jimu-rtl .plugin-theme-config .layout-section .layout-action span{margin-left: auto; margin-right: 8px;}.plugin-theme-config .layout-section .layout-action:hover{color: #12A1B8;}.plugin-theme-config .layout-section .layout-action .modify-icon{font-family: 'feature actions';}.plugin-theme-config .layout-section .layout-action .modify-icon:before{content: '\\e90e';}.jimu-rtl .plugin-theme-config .layout-section{padding-right: 30px; padding-left: auto;}.plugin-theme-config .layout-text{margin-bottom: 16px; font-size: 14px; font-family: \"Avenir Medium\"}.plugin-theme-config .layout-out-div{position: relative; margin-bottom: 15px; width: 33%;}.plugin-theme-config .layout-box-div{width: 106px; height: 80px; border: 2px solid #ffffff;}.plugin-theme-config .layout-box-div:hover{border: 2px solid #24B5CC;}.plugin-theme-config .layout-box-selected{border: 2px solid #24B5CC;}.plugin-theme-config .layout-div{width: 102px; height: 76px; border: 1px solid #ddd; text-align: center; cursor: pointer;}.plugin-theme-config .layout-div:hover{border: 1px solid #ffffff;}.plugin-theme-config .layout-selected{border: 1px solid #ffffff;}.plugin-theme-config .layout-image{width: 80px; height: 54px; margin-top: 10px;}.plugin-theme-config .layout-selected-div{position: absolute; left: 28px; top: 24px; width: 40px; height: 34px; border: 0px solid; text-align: center; padding-top: 6px; display: none; background-color: rgba(0, 0, 0, 0.65);}.plugin-theme-config .layout-selected-img{}.plugin-theme-config .theme-loading-cover{position: absolute; z-index: 999; left: 0; right: 0; top: 0; bottom: 0; background-color: rgba(0, 0, 0, 0.3);}.plugin-theme-config .style-div .color-label{margin-top: -8px;}.plugin-theme-config .jimu-color-picker{border-radius: 0;}",
"url:builder/plugins/widget-config/WidgetSettingPage.html":'\x3cdiv class\x3d"widget-setting-page"\x3e\r\n  \x3cdiv class\x3d"section common-setting" data-dojo-attach-point\x3d"commonSettingNode"\x3e\r\n    \x3cdiv class\x3d"basic"\x3e\r\n      \x3cdiv class\x3d"icon jimu-float-leading"\x3e\r\n        \x3cimg class\x3d"real-icon"  data-dojo-attach-point\x3d"iconNode"\x3e\r\n      \x3c/div\x3e\r\n      \x3cdiv class\x3d"right jimu-float-trailing jimu-leading-margin1"\x3e\r\n        \x3cinput data-dojo-type\x3d"dijit/form/ValidationTextBox" data-dojo-attach-point\x3d"labelNode" placeholder\x3d"${nls.widgetLabel}" required\x3d"true" class\x3d"widget-setting-input"\x3e\r\n        \x3cdiv class\x3d"right-foot" data-dojo-attach-point\x3d"rightFooterNode"\x3e\r\n          \x3cdiv class\x3d"image-container"\x3e\r\n            \x3cdiv data-dojo-attach-point\x3d"imageChooserPlaceholder"\x3e\x3c/div\x3e\r\n            \x3c!-- \x3cspan nowrap class\x3d"change-icon" data-dojo-attach-point\x3d"changeNode"\x3e${nls.changeIcon}\x3c/span\x3e --\x3e\r\n            \x3ca class\x3d"help-link jimu-float-trailing" target\x3d"_blank" data-dojo-attach-point\x3d"helpNode"\x3e${nls.more}\x3c/a\x3e\r\n          \x3c/div\x3e\r\n        \x3c/div\x3e\r\n      \x3c/div\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv class\x3d"layout"\x3e\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e\r\n  \x3cdiv class\x3d"section widget-setting" data-dojo-attach-point\x3d"widgetSettingNode"\x3e\x3c/div\x3e\r\n\x3c/div\x3e',
"url:builder/plugins/widget-config/GroupSettingPage.html":'\x3cdiv\x3e\r\n  \x3cdiv class\x3d"label-div"\x3e\r\n    \x3cspan\x3e${nls.label}\x3c/span\x3e\r\n    \x3cinput class\x3d"jimu-input" data-dojo-attach-point\x3d"labelNode"\x3e\x3c/input\x3e\r\n  \x3c/div\x3e\r\n\x3c/div\x3e\r\n',"url:builder/plugins/widget-config/WidgetChoosePage.html":'\x3cdiv class\x3d"widget-choose-page"\x3e\r\n  \x3cdiv data-dojo-attach-point\x3d"officialSection" class\x3d"official-section"\x3e\r\n    \x3cdiv class\x3d"section search" data-dojo-attach-point\x3d"searchSectionNode"\x3e\r\n      \x3cdiv data-dojo-attach-point\x3d"searchInputNode"\x3e\x3c/div\x3e\r\n      \x3cdiv class\x3d"list widget-list" data-dojo-attach-point\x3d"widgetListNode"\x3e\x3c/div\x3e\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e\r\n  \x3cdiv data-dojo-attach-point\x3d"customSection" class\x3d"custom-section"\x3e\r\n    \x3cdiv data-dojo-attach-point\x3d"customSearchInputNode"\x3e\x3c/div\x3e\r\n  \x3c/div\x3e\r\n\x3c/div\x3e',
"url:builder/plugins/widget-config/CustomWidgets.html":'\x3cdiv data-dojo-attach-event\x3d"onscroll:_onScroll"\x3e\r\n\t\x3cdiv data-dojo-attach-point\x3d"list" class\x3d"list widget-list" data-dojo-attach-event\x3d"onclick:_onClick"\x3e\x3c/div\x3e\r\n\t\x3cdiv data-dojo-type\x3d"jimu/dijit/LoadingIndicator" data-dojo-attach-point\x3d"loading" data-dojo-props\x3d\'hidden:true\'\x3e\x3c/div\x3e\r\n\x3c/div\x3e',"url:builder/plugins/widget-config/Plugin.html":'\x3cdiv\x3e\r\n  \x3cdiv class\x3d"preload-widgets-list" data-dojo-attach-point\x3d"preloadWidgetsNode"\x3e\r\n    \x3cdiv class\x3d"controller-widgets-list" data-dojo-attach-point\x3d"controllerWidgetsNode"\x3e\x3c/div\x3e\r\n\r\n    \x3chr  data-dojo-attach-point\x3d"onScreenGroupsHline"\x3e\r\n    \x3cdiv class\x3d"onscreen-groups-list-wrapper"\x3e\r\n      \x3cdiv class\x3d"onscreen-groups-list" data-dojo-attach-point\x3d"onScreenGroupsListNode"\x3e\x3c/div\x3e\r\n\r\n      \x3cdiv class\x3d"group-exceed-max-error jimu-state-error" data-dojo-attach-point\x3d"groupExceedMaxErrorNode"\x3e\r\n        \x3cspan class\x3d"jimu-icon jimu-icon-alert"\x3e\x3c/span\x3e\r\n        \x3cspan data-dojo-attach-point\x3d"groupExceedMaxErrorStringNode"\x3e\x3c/span\x3e\r\n      \x3c/div\x3e\r\n    \x3c/div\x3e\r\n\r\n    \x3chr  data-dojo-attach-point\x3d"notRemoveableOnScreenWidgetsHline"\x3e\r\n    \x3cdiv class\x3d"not-removeable-onscreen-widgets-list" data-dojo-attach-point\x3d"notRemoveableOnScreenWidgetsListNode"\x3e\x3c/div\x3e\r\n\r\n    \x3chr  data-dojo-attach-point\x3d"removeableOnScreenWidgetsHline"\x3e\r\n    \x3cdiv class\x3d"removeable-onscreen-widgets-list" data-dojo-attach-point\x3d"removeableOnScreenWidgetsListNode"\x3e\x3c/div\x3e\r\n\r\n  \x3c/div\x3e\r\n  \x3cdiv class\x3d"pool-widgets-list" data-dojo-attach-point\x3d"poolWidgetsNode"\x3e\r\n    \x3cdiv class\x3d"widgets-link" data-dojo-attach-point\x3d"backWidgetsNode" data-dojo-attach-event\x3d"onclick: _onBackWidgetsClick"\x3e\r\n      \x3cdiv data-dojo-attach-point\x3d"backArrowNode" class\x3d"jimu-float-leading feature-action icon-arrow-back"\x3e\x3c/div\x3e\r\n      \x26nbsp;\r\n      ${nls.widgets}\r\n    \x3c/div\x3e\r\n    \x3cdiv class\x3d"widget-pool-title" data-dojo-attach-point\x3d"poolTitleNode"\x3e${nls.setControlledWidgetsBy}\x3cspan data-dojo-attach-point\x3d"controllerLabelNode"\x3e\x3c/span\x3e\x3c/div\x3e\r\n    \x3cdiv class\x3d"widget-pool-list-wrapper"\x3e\x3cdiv class\x3d"widget-pool-list" data-dojo-attach-point\x3d"poolWidgetsListNode"\x3e\x3c/div\x3e\x3c/div\x3e\r\n    \x3cdiv class\x3d"offpanel-group-error jimu-state-error" data-dojo-attach-point\x3d"offPanelToGroupErrorNode"\x3e\r\n      \x3cspan class\x3d"jimu-icon jimu-icon-alert"\x3e\x3c/span\x3e\r\n      \x3cspan\x3e${nls.offPanelToGroupError}\x3c/span\x3e\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e\r\n\x3c/div\x3e',
"url:builder/plugins/widget-config/css/style.css":'.json-editor{width: 100%; height: 100%; position: relative;}.app-widgets{width: 100%; height: 100%;}.app-widgets\x3e.jimu-viewstack{width: 100%; height: 100%;}.app-widgets .preload-widgets-list, .app-widgets .pool-widgets-list{position: relative; width: 100%; height: 100%; padding: 10px 0px; -ms-overflow-x: hidden; -ms-overflow-y: auto; overflow-x: hidden; overflow-y: auto;}.app-widgets .preload-widgets-list hr{margin: 10px 15px -5px 15px; border: none; border-top: 1px solid #ddd;}.app-widgets .controller-widget{position: relative; height: 118px; padding-top: 20px;}.app-widgets .controller-widget:hover{background-color: #F3F3F3;}.app-widgets .controller-widget .action-node{position: absolute; left: 96px; top: 20px; height: 74px; right: 0; line-height: 74px; cursor: pointer; font-size: 14px;}.app-widgets .controller-widget .action-node .action-text{white-space: nowrap; text-overflow: ellipsis; overflow: hidden; width: 230px; font-family: "Avenir Medium"}.app-widgets .controller-widget .action-node .action-arrow{margin-top: 30px;}.app-widgets .not-removeable-onscreen-widgets-list,.app-widgets .removeable-onscreen-widgets-list,.app-widgets .onscreen-groups-list-wrapper{position: relative; left: 15px; right: 0; margin-top: 20px;}.app-widgets .widget-pool-list-wrapper{position: absolute; top: 95px; left: 15px; right: 0; bottom: 0; overflow-x: hidden; overflow-y: auto;}.app-widgets .widget-pool-list-wrapper .widget-pool-list{width: 100%; height: 100%;}.app-widgets .onscreen-groups-list-wrapper .onscreen-groups-list{width: 100%; height: 100%;}.app-widgets .jimu-state-error{position: absolute; z-index: 1; left: 0; top: 42px; height: 30px; line-height: 30px; width: 100%; padding: 0 10px; filter:alpha(opacity\x3d0); opacity: 0; display: none;}.app-widgets .group-exceed-max-error{z-index: 5; top: 0;}.app-widgets .widgets-link{font-size: 14px; margin-left: 30px; cursor: pointer; font-family: "Avenir Medium"; margin-top: 20px; color: #333;}.app-widgets .widgets-link:hover{color: black;}.app-widgets .widget-pool-title{margin-top: 15px; font-size: 12px; color: #999; margin-left: 30px;}.app-widgets .moveable{position: absolute; font-size: 12px; float: left; z-index: 3;}.app-widgets .moveable.dojoMoveItem{z-index: 4;}.app-widgets .moveable .box{position: relative; border: 1px solid #80C6D1; background-color: #80C6D1; width: 112px; height: 112px; overflow: hidden; cursor: pointer;}.app-widgets .preload-widgets-list .moveable.group-node .box{background-color: #80C6D1; border: 1px solid #80C6D1;}.app-widgets .preload-widgets-list .moveable.group-node .box:hover{}.app-widgets .preload-widgets-list .moveable.placeholder .box{background-color: #bbb; border: 1px solid #bbb;}.app-widgets .preload-widgets-list .moveable.placeholder .box:hover{background-color: #aaa;}.app-widgets .moveable.node-active .box{border: 3px solid #15a4fa;}.app-widgets .moveable .box.jimu-state-active{border: 2px solid red;}.app-widgets .moveable .label{text-align: center; width: 100%; height: 30px; margin-top: 6px; overflow: hidden; white-space: nowrap; text-overflow: ellipsis; color: #333;}.app-widgets .moveable .edit-btn{position: absolute; background-color: #000; background-color: rgba(0, 0, 0, 0.3); background-image: url(images/edit_widget.png); background-repeat: no-repeat; background-position: center;}.app-widgets .moveable .open-at-start-btn{position: absolute; border-radius: 6px; border: 2px solid white;}.app-widgets .moveable .open-at-start-btn.active{background-color: #336666; filter:alpha(opacity\x3d100); opacity: 1;}.app-widgets .moveable .open-at-start-btn.deactive{filter:alpha(opacity\x3d50); opacity: 0.5;}.app-widgets .moveable .drop-btn{position: absolute; background-color: #000; background-color: rgba(0, 0, 0, 0.3); background-image: url(images/delete_widget.png); background-repeat: no-repeat; background-position: center;}.app-widgets .moveable .switch-btn{position: absolute; border-radius: 2px; background: url(images/eye_open.png) no-repeat center center;}.app-widgets .moveable .small-add-btn{position: absolute; background-color: #000; background-color: rgba(0, 0, 0, 0.3); background-repeat: no-repeat; background-position: center; background-image: url(images/small_add.png);}.app-widgets .moveable.hide .switch-btn{background-image: url(images/eye_close.png);}.app-widgets .moveable.hide{opacity: 0.5;}.app-widgets .moveable .edit-btn:hover, .app-widgets .moveable .drop-btn:hover, .app-widgets .moveable .small-add-btn:hover{background-color: rgba(0, 0, 0, 0.6);}.app-widgets .moveable .open-at-start-btn:hover{filter:alpha(opacity\x3d100); opacity: 1;}.app-widgets .moveable .switch-btn:hover{background-image: url(images/eye_open_hover.png);}.app-widgets .moveable.hide .switch-btn:hover{background-image: url(images/eye_close_hover.png);}.app-widgets .moveable .switch-btn:hover{background-color: rgba(0, 0, 0, 0.6);}.app-widgets .node-shadow{position: absolute; border: 1px dashed;}.app-widgets .node-margin{position: absolute; z-index: 2;}.app-widgets .node-margin-active{background: red;}.app-widgets .add-widget-node{position: absolute; font-size: 12px; float: left;}.app-widgets .add-widget-node .box{background-color: #fafafc; border: 1px dashed #d2dae2; color: #596679;}.app-widgets .add-widget-node .box:hover{background-color: #eaeaea;}.app-widgets .add-widget-node img{width: 20px; height: 20px; display: block; margin: 27px;}.app-widgets .empty-node .box{opacity: 0; cursor: normal;}.app-widgets .empty-node-active .box{opacity: 0.4;}.app-widgets .widget-node .placeholder,.app-widgets .group-node .placeholder{overflow: hidden;}.app-widgets .widget-node .placeholder-inner,.app-widgets .group-node .placeholder-inner{text-align: center; color: white; font-size: 14px;}.app-widgets .group-node .placeholder-inner {border: 1px solid white; width: 32px !important; height: 32px !important; line-height: 32px !important; border-radius: 16px !important; margin: 0 !important;}.app-widgets .group-node .small{float: left;}.app-widgets .group-node .add-button{width: 20px; height: 20px; margin: auto; display: block; margin-top: 25px;}.app-widgets .widget-group-panel{position: absolute; background-color: #E3ECF2;}.app-widgets .group-triangle{position: absolute; width: 0px; height: 0px; top: -8px; border-left: 8px solid transparent; border-right: 8px solid transparent; border-bottom: 8px solid #E3ECF2;}.widget-setting-popup .content{overflow-y: hidden;}.widget-setting-page{width: 100%; height: 100%;}.widget-setting-page .common-setting{height: 74px; margin-bottom: 20px;}.widget-setting-page .common-setting .basic{overflow: hidden;}.widget-setting-page .common-setting .label input{width: 224px; height: 32px;}.widget-setting-page .opts-section{padding: 5px;}.widget-setting-page .common-setting .icon{background-color: #80C6D1; border: 1px solid #80C6D1; width: 74px; height: 74px; display: inline-block;}.widget-setting-page .common-setting .icon img{width: 40px; height: 40px; margin: 17px;}.widget-setting-page .common-setting .right{font-size: 10px; width: 875px; display: inline-block;}.widget-setting-page .common-setting .right .widget-setting-input{width: 100%; color: black; display: block; background-color: #fafafc;}.widget-setting-page .image-container{overflow:hidden; min-width: 100px; width: 100%; display: inline-block; position: relative; height: 30px; margin-top: 14px;}.widget-setting-page .image-container .help-link{color: #24B5CC; display:none;}.widget-setting-page .image-container .help-link:hover{color: #0090A7;}.widget-setting-page .jimu-image-chooser{height: 30px; padding: 0;}.widget-setting-page .common-setting .right .change-icon{white-space:nowrap; color: white; cursor: pointer; display: inline-block; background-color: #518dca; text-align: center; vertical-align: middle; height: 30px; line-height: 30px; padding-left: 6px; padding-right: 6px; box-shadow: 0 0 2px gray; position: relative;}.widget-setting-page .common-setting .right .disable-change-icon{background-color: #a0acbf; cursor: default;}.widget-setting-page .common-setting .right .more{float: right; color: #15a4fa; display: inline-block; margin-top: 20px;}.widget-setting-page .common-setting .right-foot{position: relative; font-size: 14px;}.widget-setting-page .common-setting .right .state{font-size: 14px; margin-top: 10px;}.widget-setting-page .widget-setting{overflow-x: hidden; overflow-y: auto; position: relative;}.widget-setting-page .widget-default-setting{width: 100%; height: 100%;}.widget-setting-page .opts-section{height: 50px;}.widget-setting-page .opts-section .jimu-btn{width: 182px; height: 40px; margin-left: 8px;}.widget-setting-page .noconfig-info{font-size: 16px; position: absolute; left: 50%; top: 50%; margin-left: -100px;}.widget-choose-page{width: 100%; height: 100%;}.widget-choose-page \x3e .jimu-tab3 \x3e .container-node{height: 635px; overflow: hidden;}.widget-choose-page .jimu-item-selector .setting-tab-container{height: 98%; margin-top: 2%;}.widget-choose-page .jimu-search{margin: 10px 0;}.widget-choose-page .jimu-search .jimu-input{font-size: 12px;}.widget-choose-page .widget-node{width: 78px; height: 118px; margin: 10px 8px 0 0px; float: left; font-size: 12px; cursor: pointer; position: relative;}.widget-choose-page .widget-node .box{position: relative; border: 1px solid #80C6D1; background-color: #80C6D1; width: 78px; height: 78px; overflow: hidden;}.widget-choose-page .widget-node .box-selected{position: absolute; width: 16px; height: 16px; left: 5px; top: 5px; display: none; background: url(images/checked.svg);}.widget-choose-page .widget-node.jimu-state-selected .box-selected{display: block;}.widget-choose-page .widget-node .icon{width: 32px; height: 32px; display: block; margin: auto; margin-top: 23px;}.widget-choose-page .widget-node .label{text-align: center; width: 100%; height: 30px; margin-top: 10px; overflow: hidden; white-space: nowrap; text-overflow: ellipsis;}.widget-choose-page .search{width: 100%; overflow-x: hidden; overflow-y: hidden;}.widget-choose-page .list{height: 100%; margin-right: -10px; padding-left: 1px; overflow-y: auto; width: 965px;}.widget-choose-page .opts-section{overflow: hidden; margin-top: 10px;}.widget-choose-page .opts-section .jimu-btn{width: 182px; height: 40px; margin-left: 8px;}.widget-choose-page .custom-section{position: relative;}.widget-choose-page .custom-widgets{display: block; position: absolute; width: 100%; left: 0; right: 0; top: 50px; bottom: 0;}.widget-choose-page .hidden{display: none;}.widget-choose-page .custom-widgets .detail-icon{display: none; position: absolute; right: 7px; bottom: 7px; width: 15px; height: 15px; background-color: rgba(0, 0, 0, 0.4); background-repeat: no-repeat; background-image: url(images/info.png); border-radius: 3px; cursor: pointer;}.jimu-rtl .widget-choose-page .custom-widgets .detail-icon{right: auto; left: 7px;}.widget-choose-page .custom-widgets .widget-node .box:hover .detail-icon{display: block;} .group-setting-page {margin: 20px 10px; font-size: 16px;}.group-setting-page .label-div input{margin-left: 10px; color: #000000;}.jimu-rtl .app-widgets .controller-widget .action-node{right: 96px; left: 0;}.jimu-rtl .widget-choose-page .widget-node{margin: 10px 0 0 8px; float: right;}.jimu-rtl .widget-choose-page .list{margin-right: 0; padding-left: 0; overflow-x: hidden;}.jimu-rtl .app-widgets .widgets-link{margin-left: auto; margin-right: 30px;}.jimu-rtl .app-widgets .widget-pool-title{margin-left: auto; margin-right: 30px;}.jimu-rtl .app-widgets .not-removeable-onscreen-widgets-list,.jimu-rtl .app-widgets .removeable-onscreen-widgets-list,.jimu-rtl .app-widgets .onscreen-groups-list-wrapper,.jimu-rtl .app-widgets .widget-pool-list-wrapper{right: 15px; left: 0;}.jimu-rtl .widget-choose-page .widget-node .box-selected{right: 5px; left: auto;}.dj_ie8 .app-widgets .empty-node .box {-ms-filter: "Alpha(opacity\x3d0)"; filter: Alpha(opacity\x3d0);}.dj_ie8 .app-widgets .moveable .edit-btn{-ms-filter: "Alpha(opacity\x3d30)"; filter: Alpha(opacity\x3d30);}.dj_ie8 .app-widgets .moveable .edit-btn:hover{-ms-filter: "Alpha(opacity\x3d60)"; filter: Alpha(opacity\x3d60);}.dj_ie8 .app-widgets .moveable.hide {-ms-filter: "Alpha(opacity\x3d50)"; filter: Alpha(opacity\x3d50);}.widget-choose-page.hide-custom-widgets .jimu-tab3{height: 100%;}.widget-choose-page.hide-custom-widgets .jimu-tab3 .control-node{display: none;}.widget-choose-page.hide-custom-widgets .jimu-tab3 .jimu-viewstack{height: 100%;}',
"*now":function(r){r(['dojo/i18n!*preload*builder/nls/main*["ar","bs","cs","da","de","en","el","es","et","fi","fr","he","hi","hr","id","it","ja","ko","lt","lv","nb","nl","pl","pt-br","pt-pt","ro","ru","sr","sv","th","tr","zh-cn","vi","zh-hk","zh-tw","ROOT"]'])}}});
define("dojo/_base/config dojo/_base/html dojo/_base/lang dojo/_base/array dojo/promise/all dojo/Deferred dojo/cookie dojo/topic dojo/json dojo/request/script jimu/utils jimu/portalUrlUtils jimu/portalUtils jimu/dijit/Message jimu/DataSourceManager ./tokenUtils ./utils ./PluginManager require esri/request esri/IdentityManager dojo/text!./plugins/plugins.json dojo/i18n!./nls/builder".split(" "),function(r,l,d,q,k,m,p,h,e,c,b,a,g,u,n,t,f,v,x,w,z,A,y){function B(b){l.setStyle("pre-main-page","display",
"none");l.setStyle("main-page","display","block");window.portalUrl=b.portalUrl;t.setPortalUrl(window.portalUrl);var c=a.getSharingUrl(window.portalUrl);z.checkSignInStatus(c).then(function(){E(b)},function(){if(window.isXT)t.xtGetCredentialFromCookie(window.portalUrl)&&E(b);else{var c=a.getPortalSignInUrlFromLocation(),d=encodeURIComponent(window.location.href);window.location.href=c+"?returnUrl\x3d"+d}})}function C(a){l.create("div",{className:"app-error",innerHTML:a},document.body)}function E(c){var e=
"";!window.isXT&&window.queryObject&&(window.queryObject.id&&!/^(stemapp|stemapp3d)$/gi.test(window.queryObject.id)?e=window.queryObject.id:window.queryObject.appid&&(e=window.queryObject.appid));var h=G(),n=F(),q=J(e),u=function(){t.signOutAll();if(window.isXT)window.location.href=window.location.href;else{var b=a.getPortalSignInUrlFromLocation(),c=encodeURIComponent(window.location.href);window.location.href=b+"?returnUrl\x3d"+c}};k([h,n,q]).then(d.hitch(this,function(h){var n=h[1],q=h[2];h[0]&&
n?"string"===typeof q?(t.signOutAll(),C(q)):N(e).then(function(e){if(e){var h=g.getPortal(window.portalUrl);e=h.loadSelfInfo();var n=D(window.portalUrl),q;k([e,n]).then(function(a){q=a[0];window.portalSelf=q;window.isXT?a=f.checkProtocolAndUpdateSigninInfo(q,c):(a=new m,a.resolve({success:!0}));return a}).then(function(e){if(e.success){var g=q.user&&q.user.culture||q.culture||r.locale;g&&(g=g.toLowerCase());e=null;!window.queryObject.locale&&b.isLocaleChanged(r.locale,g)&&(p("wab_locale",g),e=window.location.href);
window.isXT&&/[\?|\&](action=)(.+)/gi.test(window.location.href)&&(e||(e=window.location.href),e=f.removeActionFromUrl(e));g="https:"===window.location.protocol;if(q.allSSL||g)window.portalUrl=c.portalUrl=a.setHttpsProtocol(c.portalUrl);h.portalUrl=window.portalUrl;var k=0===window.portalUrl.toLowerCase().indexOf("https:");!g&&k&&(e||(e=window.location.href),e=e.replace(/^http:/i,"https:"));e?window.location.href=e:(e=K.startup,e.options={signinInfo:c},v.getInstance(K).loadPlugin(e).then(d.hitch(this,
function(a){a.placeAt(l.byId("main-page"));a.startup()})))}else console.log("Update signin info error.")})}else C(window.jimuNls.noEditPrivileges),t.signOutAll()}):u()}),u)}function D(b){var c=a.getSharingUrl(b),e=new m;w({url:c,content:{f:"json"},handleAs:"json",callbackParamName:"callback",preventCache:!0}).then(d.hitch(this,function(c){window.portalVersion=c.currentVersion;a.isOnline(b)?window.isPortalSupport3D=!0:window.isPortalSupport3D=0<=g.comparePortalVersion(window.portalVersion,"3.7");e.resolve()}),
d.hitch(this,function(a){console.error(a);e.reject(a)}));return e}function F(){var b=new m,e=t.getPortalCredential(window.portalUrl);e&&e.token?(e=a.getPortalSelfInfoUrl(window.portalUrl)+"?f\x3djson\x26token\x3d"+e.token,e=a.setHttpsProtocol(e),c.get(e,{handleAs:"json",jsonp:"callback",timeout:6E4}).then(d.hitch(this,function(a){a&&!a.error?b.resolve(!0):b.resolve(!1)}),d.hitch(this,function(a){console.error(a);b.reject(a)}))):b.resolve(!1);return b}function G(){var a=new m;window.isXT?g.getPortal(window.portalUrl).getUser().then(function(b){if(b)if("1"===
b.level||1===b.level)var c=new u({message:window.builderNls.userLevelTip,buttons:[{label:window.jimuNls.common.ok,onClick:d.hitch(this,function(){a.resolve(!1);c.close()})}]});else a.resolve(!0);else a.resolve(!1)},function(b){a.reject(b)}):a.resolve(!0);return a}function J(a){var b=new m;window.isXT?b.resolve(!0):a?g.getPortal(window.portalUrl).getItemById(a).then(function(a){403===a.httpCode&&"GWM_0003"===a.messageCode?b.resolve(a.message):b.resolve(!0)},function(a){a&&403===a.httpCode&&"GWM_0003"===
a.messageCode?b.resolve(a.message):b.reject(a)}):b.resolve(!0);return b}function N(){var a=new m;if(window.isXT)a.resolve(!0);else return g.getPortal(window.portalUrl).getUser().then(function(a){return a?a.canCreateItem():!1});return a}function M(a,c){q.forEach(c,function(c){var d=K[c.pluginName],e;for(e in c.parameters)if(e===a.name){var f=c.parameters[e];b.url.isAbsolute(f)||(c.parameters[e]=d.folderUrl+f)}})}function L(a){var c=new m;if(!a.parameters||null===e.stringify(a.parameters).match(/\$\{(\w)+\}/g))return c.resolve(!0),
c;var d=K[a.pluginName];v.getInstance().loadPluginI18n(d).then(function(d){a.parameters=b.replacePlaceHolder(a.parameters,d);c.resolve(!0)});return c}var K=e.parse(A);window.builderNls=y;window.pluginsMeta=K;n.getInstance();"function"!==typeof p.getAll&&(p.getAll=function(a){var b=[];(a=p(a))&&b.push(a);return b});jimuConfig.layoutId=jimuConfig.mainPageId;h.subscribe("switchToMainPage",function(a){var c=f.removeActionFromUrl(window.location.href);b.changeLocation(c);B(a)});(function(){for(var a in K){var b=
K[a];b.amdFolder="builder/plugins/"+a.replace(/\./g,"/")+"/";b.folderUrl=x.toUrl(b.amdFolder);b.uri=b.amdFolder+"Plugin"}a=[];for(var c in K){var b=K[c],d;for(d in b.extensionPoints){var e=b.extensionPoints[d],f;for(f in e.parameters){var g=e.parameters[f];"url"===g.type&&M(g,e.extensions)}if(e.extensions)for(g=0;g<e.extensions.length;g++)a.push(L(e.extensions[g]))}}return k(a)})().then(function(){l.setStyle("main-loading","display","none");window.isXT?x(["./xtMain"]):h.publish("switchToMainPage",
{portalUrl:a.getPortalUrlFromLocation()})})});