// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See http://js.arcgis.com/3.15/esri/copyright.txt and http://www.arcgis.com/apps/webappbuilder/copyright.txt for details.
//>>built
define(["dojo/_base/array","dojo/Deferred","jimu/portalUtils"],function(g,k,n){function l(b){return g.some(p,function(a){return-1<b.search(a)})}function m(b){return g.some(q,function(a){return-1<b.search(a)})}function r(b){var a=new k;if(b){var e=[],f={},d;g.forEach(b.operationalLayers,function(a){var b,c;b=a.url;c=document.createElement("a");c.href=b;b=l(c.host);c=m(c.host);if(b||c)f[a.url]?(d=f[a.url],d.title=d.title+", "+(a.title||a.name)):(d={sourceUrl:a.url,title:a.title||a.name,premium:b,consumeCredits:c,
useProxy:!1},e.push(d),f[a.url]=d)});a.resolve(e)}else a.resolve([]);return a}var p=[/traffic\w*\.arcgis\.com/i,/landsat\w*\.arcgis\.com/i,/elevation\w*\.arcgis\.com/i,/geoenrich\w*\.arcgis\.com/i,/hydro\w*\.arcgis\.com/i,/naip\w*\.arcgis\.com/i,/livefeeds\w*\.arcgis\.com/i,/demographics\w*\.arcgis\.com/i,/landscape\w*\.arcgis\.com/i,/historical\w*\.arcgis\.com/i,/earthobs\w*\.arcgis\.com/i],q=[/demographics\w*\.arcgis\.com/i,/geoenrich\w*\.arcgis\.com/i,/route\w*\.arcgis\.com/i,/logistics\w*\.arcgis\.com/i,
/analysis\w*\.arcgis\.com/i,/elevation\w*\.arcgis\.com/i],h={queryForSecureServicesInMap:function(b,a){try{return n.getPortal(b).getItemData(a).then(function(a){return r(a)},function(){return[]})}catch(f){var e=new k;e.resolve([]);return e}}};h.isPremium=l;h.consumesCredits=m;return h});