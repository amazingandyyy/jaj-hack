// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See http://js.arcgis.com/3.15/esri/copyright.txt and http://www.arcgis.com/apps/webappbuilder/copyright.txt for details.
//>>built
require({cache:{"url:builder/plugins/map-config/MapTable.html":'\x3cdiv\x3e\r\n\t\x3cdiv class\x3d"maps-section" data-dojo-attach-point\x3d"allMapsSection"\x3e\r\n\t\t\x3cdiv class\x3d"maps-table-div" data-dojo-attach-point\x3d"allMapsTableDiv"\x3e\r\n\t\t\t\x3ctable class\x3d"maps-table" cellpadding\x3d"10" data-dojo-attach-point\x3d"allMapsTable"\x3e\r\n\t\t\t\t\x3ctbody class\x3d"maps-tbody" data-dojo-attach-point\x3d"allMapsTbody"\x3e\x3c/tbody\x3e\r\n\t\t\t\x3c/table\x3e\r\n\t\t\x3c/div\x3e\r\n\t\t\x3cdiv data-dojo-type\x3d"jimu/dijit/LoadingIndicator" data-dojo-attach-point\x3d"allMapsShelter" data-dojo-props\x3d\'hidden:true\'\x3e\x3c/div\x3e\r\n\t\x3c/div\x3e\r\n\t\x3cdiv class\x3d"maps-section hidden" data-dojo-attach-point\x3d"filteredMapsSection"\x3e\r\n\t\t\x3cdiv class\x3d"maps-table-div" data-dojo-attach-point\x3d"filteredMapsTableDiv"\x3e\r\n\t\t\t\x3ctable class\x3d"maps-table" cellpadding\x3d"10" data-dojo-attach-point\x3d"filteredMapsTable"\x3e\r\n\t\t\t\t\x3ctbody class\x3d"maps-tbody" data-dojo-attach-point\x3d"filteredMapsTbody"\x3e\x3c/tbody\x3e\r\n\t\t\t\x3c/table\x3e\r\n\t\t\x3c/div\x3e\r\n\t\t\x3cdiv class\x3d"search-none-tip-section hidden" data-dojo-attach-point\x3d"searchNoneTipSection"\x3e\r\n\t\t\t\x3cspan class\x3d"search-none-icon jimu-icon jimu-icon-error"\x3e\x3c/span\x3e\r\n\t\t\t\x3cspan class\x3d"search-none-tip"\x3e${nls.searchNone}\x3c/span\x3e\r\n\t\t\x3c/div\x3e\r\n\t\t\x3cdiv data-dojo-type\x3d"jimu/dijit/LoadingIndicator" data-dojo-attach-point\x3d"filteredMapsShelter" data-dojo-props\x3d\'hidden:true\'\x3e\x3c/div\x3e\r\n\t\x3c/div\x3e\r\n\x3c/div\x3e'}});
define("dojo/_base/declare dijit/_WidgetBase dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dojo/text!./MapTable.html dojo/Evented dojo/_base/lang dojo/_base/array dojo/_base/html dojo/_base/Deferred dojo/query dojo/on jimu/utils builder/portalUtils jimu/portalUrlUtils jimu/dijit/LoadingIndicator dojo/i18n!./nls/strings".split(" "),function(u,v,w,x,y,z,f,A,b,D,e,q,r,t,B,E,C){return u([v,w,x,z],{templateString:y,baseClass:"map-table",query:null,filteredQuery:null,portalUrl:null,hidden:!1,nls:null,
originalSelectedId:null,type:"",postMixInProperties:function(){this.nls=C},postCreate:function(){this.inherited(arguments);(this.hidden=!0===this.hidden)&&this.hide();this.portalUrl&&(this.portalUrl=B.getStandardPortalUrl(this.portalUrl));this.own(q(this.allMapsTableDiv,"scroll",f.hitch(this,this._onAllMapsSectionScroll)));this.own(q(this.filteredMapsTableDiv,"scroll",f.hitch(this,this._onFilteredMapsSectionScroll)));this._showAllMapsSection();this.searchAllMaps()},show:function(){b.removeClass(this.domNode,
"hidden")},hide:function(){b.addClass(this.domNode,"hidden")},searchAllMaps:function(a){this._showAllMapsSection();a&&(this.query=f.clone(a),this.query.start=1,this.clearAllMapsSection());this.portalUrl&&this.query&&0<this.query.start&&(this.allMapsShelter.show(),t.getPortal(this.portalUrl).queryItems(this.query).then(f.hitch(this,function(a){this.domNode&&(this.allMapsShelter.hide(),this.query.start=a.nextStart,this._createMapItems(a,this.allMapsTbody))}),f.hitch(this,function(a){console.error(a);
this.domNode&&this.allMapsShelter.hide()})))},searchFilteredMaps:function(a){this._showFilterMapsSection();a&&(this.filteredQuery=f.clone(a),this.filteredQuery.start=1,this.clearFilteredMapsSection());this.portalUrl&&this.filteredQuery&&0<this.filteredQuery.start&&(this.filteredMapsShelter.show(),t.getPortal(this.portalUrl).queryItems(this.filteredQuery).then(f.hitch(this,function(b){this.domNode&&(this._showFilterMapsSection(),a&&this.clearFilteredMapsSection(),this.filteredQuery.start=b.nextStart,
this._createMapItems(b,this.filteredMapsTbody),this._filterMapCallback())}),f.hitch(this,function(a){console.error(a);this.domNode&&this._filterMapCallback()})))},_filterMapCallback:function(){this.filteredMapsShelter.hide();0<this._getWebMapCount(this.filteredMapsTbody)?(b.removeClass(this.filteredMapsTableDiv,"hidden"),b.addClass(this.searchNoneTipSection,"hidden")):(b.addClass(this.filteredMapsTableDiv,"hidden"),b.removeClass(this.searchNoneTipSection,"hidden"))},clear:function(){this.clearAllMapsSection();
this.clearFilteredMapsSection()},clearAllMapsSection:function(){b.empty(this.allMapsTbody)},clearFilteredMapsSection:function(){b.empty(this.filteredMapsTbody)},showAllMapsSection:function(a){this._showAllMapsSection();a&&this.searchAllMaps(a)},_showAllMapsSection:function(){b.removeClass(this.allMapsSection,"hidden");b.addClass(this.filteredMapsSection,"hidden")},showFilterMapsSection:function(a){this._showFilterMapsSection();a&&this.searchFilteredMaps(a)},_showFilterMapsSection:function(){b.addClass(this.allMapsSection,
"hidden");b.removeClass(this.filteredMapsSection,"hidden");b.removeClass(this.filteredMapsTableDiv,"hidden");b.addClass(this.searchNoneTipSection,"hidden")},_onAllMapsSectionScroll:function(){this._isScrollToBottom(this.allMapsTableDiv)&&this.searchAllMaps()},_onFilteredMapsSectionScroll:function(){this._isScrollToBottom(this.filteredMapsTableDiv)&&this.searchFilteredMaps()},_isScrollToBottom:function(a){return r.isScrollToBottom(a)},_createMapItems:function(a,d){var g=A.filter(a.results,f.hitch(this,
function(a){return a.type.toLowerCase()===this.type.toLowerCase()}));if(0!==g.length){var m={},c,h=e("td.empty",d),k;if(0<h.length){var n=Math.min(g.length,h.length),l=g.splice(0,n);for(k=0;k<n;k++){var p=h[k];c=this._createMapItem(l[k]);m[c.item.id]=c;b.place(c,p);b.removeClass(p,"empty")}}if(0!==g.length){h=Math.ceil(g.length/5);for(k=0;k<h;k++)for(c=b.toDom("\x3ctr\x3e\x3ctd\x3e\x3c/td\x3e\x3ctd\x3e\x3c/td\x3e\x3ctd\x3e\x3c/td\x3e\x3ctd\x3e\x3c/td\x3e\x3ctd\x3e\x3c/td\x3e\x3c/tr\x3e"),b.place(c,
d),n=e("td",c),l=0;l<n.length;l++)p=n[l],(c=g[5*k+l])?(c=this._createMapItem(c),m[c.item.id]=c,b.place(c,p)):b.addClass(p,"empty");!this.getSelectedMapItem()&&this.appConfig&&this.appConfig.map.itemId&&(c=m[this.appConfig.itemId])&&(g=e(".map-item-bg",c),b.addClass(g,"selected"))}}},_getWebMapCount:function(a){return e(".map-item-div",a).length},_createMapItem:function(a){var d=b.toDom("\x3cdiv class\x3d'map-item-div'\x3e\x3cdiv class\x3d'map-item-bg'\x3e\x3cdiv class\x3d'map-item-thumbnail jimu-auto-vertical'\x3e\x3cdiv class\x3d'none-thumbnail-tip jimu-auto-vertical-content'\x3e\x3c/div\x3e\x3c/div\x3e\x3ca target\x3d'_blank' class\x3d'map-item-detail-icon'\x3e\x3c/a\x3e\x3c/div\x3e\x3cspan class\x3d'map-item-title'\x3e\x3c/span\x3e\x3c/div\x3e"),
g=e(".map-item-bg",d)[0],m=e(".map-item-thumbnail",d)[0],c=e(".map-item-title",d)[0],h=e(".map-item-detail-icon",d)[0];e(".none-thumbnail-tip",d);h.href=a.detailsPageUrl;h.title=this.nls.viewItemDetails||"";d.item=a;h=a.thumbnailUrl||r.getDefaultWebMapThumbnail();b.setStyle(m,"backgroundImage","url("+h+")");this.own(q(g,"click",f.hitch(this,this._onMapItemBgClick)));c.innerHTML=a.title;c.title=a.title;return d},unselect:function(){e(".map-item-bg",this.domNode).removeClass("selected")},_onMapItemBgClick:function(a){a=
a.target||a.srcElement;var d=null;b.hasClass(a,"map-item-thumbnail")?d=a.parentNode:b.hasClass(a,"none-thumbnail-tip")&&(d=a.parentNode.parentNode);d&&b.hasClass(d,"map-item-bg")&&(this.unselect(),b.addClass(d,"selected"),this.emit("select",{mapTable:this,selectedNode:d}))},getSelectedMapItem:function(){var a=null,b=e(".map-item-bg.selected",this.domNode);0<b.length&&(a=b[0].parentNode.item);return a}})});